From 49e5e377669c29a11b6c759f5417ef64c68c8b6c Mon Sep 17 00:00:00 2001
From: Salvo Giangreco <giangrecosalvo9@gmail.com>
Date: Sat, 30 Aug 2025 15:50:08 +0200
Subject: [PATCH] Disable HW mDNIe

---
 .../AccessibilityManagerService$2.smali       | 133 ++----
 ...nagerService$AODStateContentObserver.smali |  49 +-
 .../AccessibilityManagerService.smali         | 266 ++---------
 .../display/SemMdnieManagerService.smali      | 452 +++---------------
 .../custom/KnoxCustomManagerService.smali     | 249 ++--------
 5 files changed, 203 insertions(+), 946 deletions(-)

diff --git a/smali/com/android/server/accessibility/AccessibilityManagerService$2.smali b/smali/com/android/server/accessibility/AccessibilityManagerService$2.smali
index efc6008f7..59a0caa69 100644
--- a/smali/com/android/server/accessibility/AccessibilityManagerService$2.smali
+++ b/smali/com/android/server/accessibility/AccessibilityManagerService$2.smali
@@ -79,28 +79,14 @@
     goto :goto_0
 
     :cond_1
-    iget-object p2, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
+    iget-object p1, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
 
-    invoke-static {p2}, Lcom/android/server/accessibility/AccessibilityManagerService;->-$$Nest$menableColorLens(Lcom/android/server/accessibility/AccessibilityManagerService;)V
+    invoke-static {p1}, Lcom/android/server/accessibility/AccessibilityManagerService;->-$$Nest$menableColorLens(Lcom/android/server/accessibility/AccessibilityManagerService;)V
 
     :goto_0
-    iget-object p2, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
-
-    invoke-static {p2}, Lcom/android/server/accessibility/AccessibilityManagerService;->-$$Nest$menableColorRelumino(Lcom/android/server/accessibility/AccessibilityManagerService;)V
-
-    iget-object p2, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
-
-    iget-object p2, p2, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {p2}, Lcom/android/internal/accessibility/util/AccessibilityUtils;->isInDesktopWindowing(Landroid/content/Context;)Z
-
-    move-result p2
-
-    if-nez p2, :cond_7
-
     iget-object p0, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
 
-    invoke-static {p1, p0}, Lcom/android/server/accessibility/AccessibilityManagerService;->-$$Nest$msetColorAdjustment(Landroid/content/Context;Lcom/android/server/accessibility/AccessibilityManagerService;)V
+    invoke-static {p0}, Lcom/android/server/accessibility/AccessibilityManagerService;->-$$Nest$menableColorRelumino(Lcom/android/server/accessibility/AccessibilityManagerService;)V
 
     goto/16 :goto_2
 
@@ -111,7 +97,7 @@
 
     move-result p2
 
-    if-eqz p2, :cond_7
+    if-eqz p2, :cond_6
 
     iget-object p2, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
 
@@ -275,24 +261,9 @@
     invoke-virtual {p2, v2, v4, v0, v1}, Landroid/content/ContentResolver;->registerContentObserver(Landroid/net/Uri;ZLandroid/database/ContentObserver;I)V
 
     :cond_4
-    iget-object p2, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
-
-    iget-object p2, p2, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {p2}, Lcom/android/internal/accessibility/util/AccessibilityUtils;->isInDesktopWindowing(Landroid/content/Context;)Z
-
-    move-result p2
-
-    if-nez p2, :cond_5
-
-    iget-object p2, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
-
-    invoke-static {p1, p2}, Lcom/android/server/accessibility/AccessibilityManagerService;->-$$Nest$msetColorAdjustment(Landroid/content/Context;Lcom/android/server/accessibility/AccessibilityManagerService;)V
-
-    :cond_5
     sget-boolean p2, Landroid/view/accessibility/A11yRune;->A11Y_COLOR_BOOL_SUPPORT_COLOR_FILTER_MDNIE_HW:Z
 
-    if-eqz p2, :cond_6
+    if-eqz p2, :cond_5
 
     iget-object p2, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
 
@@ -300,7 +271,7 @@
 
     goto :goto_1
 
-    :cond_6
+    :cond_5
     iget-object p1, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
 
     invoke-static {p1}, Lcom/android/server/accessibility/AccessibilityManagerService;->-$$Nest$menableColorLens(Lcom/android/server/accessibility/AccessibilityManagerService;)V
@@ -310,7 +281,7 @@
 
     invoke-static {p0}, Lcom/android/server/accessibility/AccessibilityManagerService;->-$$Nest$menableColorRelumino(Lcom/android/server/accessibility/AccessibilityManagerService;)V
 
-    :cond_7
+    :cond_6
     :goto_2
     return-void
 
@@ -334,7 +305,7 @@
 
     move-result v6
 
-    if-eqz v6, :cond_8
+    if-eqz v6, :cond_7
 
     iget-object v6, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
 
@@ -362,7 +333,7 @@
 
     invoke-virtual {v6, v9, v7, v8, p1}, Lcom/android/server/accessibility/AccessibilityTraceManager;->logTrace(Ljava/lang/String;JLjava/lang/String;)V
 
-    :cond_8
+    :cond_7
     invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
     move-result-object p1
@@ -373,7 +344,7 @@
 
     move-result v6
 
-    if-eqz v6, :cond_9
+    if-eqz v6, :cond_8
 
     iget-object p0, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
 
@@ -389,14 +360,14 @@
 
     goto/16 :goto_c
 
-    :cond_9
+    :cond_8
     const-string/jumbo v6, "android.intent.action.USER_UNLOCKED"
 
     invoke-virtual {v6, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v6
 
-    if-eqz v6, :cond_b
+    if-eqz v6, :cond_a
 
     iget-object p0, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
 
@@ -419,7 +390,7 @@
 
     iget p2, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mCurrentUserId:I
 
-    if-ne p1, p2, :cond_a
+    if-ne p1, p2, :cond_9
 
     invoke-virtual {p0, p2}, Lcom/android/server/accessibility/AccessibilityManagerService;->getUserStateLocked(I)Lcom/android/server/accessibility/AccessibilityUserState;
 
@@ -434,7 +405,7 @@
 
     goto :goto_4
 
-    :cond_a
+    :cond_9
     :goto_3
     monitor-exit v6
 
@@ -447,14 +418,14 @@
 
     throw p0
 
-    :cond_b
+    :cond_a
     const-string/jumbo v6, "android.intent.action.USER_REMOVED"
 
     invoke-virtual {v6, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v6
 
-    if-eqz v6, :cond_c
+    if-eqz v6, :cond_b
 
     iget-object p0, p0, Lcom/android/server/accessibility/AccessibilityManagerService$2;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
 
@@ -468,14 +439,14 @@
 
     goto/16 :goto_c
 
-    :cond_c
+    :cond_b
     const-string/jumbo v6, "android.os.action.SETTING_RESTORED"
 
     invoke-virtual {v6, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result p1
 
-    if-eqz p1, :cond_1c
+    if-eqz p1, :cond_1b
 
     const-string/jumbo p1, "setting_name"
 
@@ -483,11 +454,11 @@
 
     move-result-object p1
 
-    if-nez p1, :cond_d
+    if-nez p1, :cond_c
 
     goto/16 :goto_c
 
-    :cond_d
+    :cond_c
     const-string/jumbo v6, "previous_value"
 
     invoke-virtual {p2, v6}, Landroid/content/Intent;->getStringExtra(Ljava/lang/String;)Ljava/lang/String;
@@ -528,11 +499,11 @@
 
     move-result v0
 
-    if-nez v0, :cond_e
+    if-nez v0, :cond_d
 
     goto :goto_5
 
-    :cond_e
+    :cond_d
     const/4 v0, 0x5
 
     goto :goto_6
@@ -544,11 +515,11 @@
 
     move-result v0
 
-    if-nez v0, :cond_f
+    if-nez v0, :cond_e
 
     goto :goto_5
 
-    :cond_f
+    :cond_e
     move v0, v3
 
     goto :goto_6
@@ -560,7 +531,7 @@
 
     move-result v9
 
-    if-nez v9, :cond_13
+    if-nez v9, :cond_12
 
     goto :goto_5
 
@@ -571,11 +542,11 @@
 
     move-result v0
 
-    if-nez v0, :cond_10
+    if-nez v0, :cond_f
 
     goto :goto_5
 
-    :cond_10
+    :cond_f
     move v0, v2
 
     goto :goto_6
@@ -587,11 +558,11 @@
 
     move-result v0
 
-    if-nez v0, :cond_11
+    if-nez v0, :cond_10
 
     goto :goto_5
 
-    :cond_11
+    :cond_10
     move v0, v5
 
     goto :goto_6
@@ -603,14 +574,14 @@
 
     move-result v0
 
-    if-nez v0, :cond_12
+    if-nez v0, :cond_11
 
     goto :goto_5
 
-    :cond_12
+    :cond_11
     move v0, v4
 
-    :cond_13
+    :cond_12
     :goto_6
     packed-switch v0, :pswitch_data_1
 
@@ -681,7 +652,7 @@
 
     and-int/lit8 v1, p1, 0xc
 
-    if-nez v1, :cond_1b
+    if-nez v1, :cond_1a
 
     iget-object v1, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mLock:Ljava/lang/Object;
 
@@ -692,7 +663,7 @@
 
     move-result-object v6
 
-    if-ne p1, v2, :cond_14
+    if-ne p1, v2, :cond_13
 
     new-instance v8, Landroid/util/ArraySet;
 
@@ -713,13 +684,13 @@
 
     goto/16 :goto_b
 
-    :cond_14
+    :cond_13
     invoke-virtual {v6, p1}, Lcom/android/server/accessibility/AccessibilityUserState;->getShortcutTargetsLocked(I)Ljava/util/LinkedHashSet;
 
     move-result-object v8
 
     :goto_7
-    if-ne p1, v2, :cond_19
+    if-ne p1, v2, :cond_18
 
     iget-object v2, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
 
@@ -733,19 +704,19 @@
 
     move-result v9
 
-    if-eqz v9, :cond_15
+    if-eqz v9, :cond_14
 
     const/4 v9, 0x0
 
     goto :goto_8
 
-    :cond_15
+    :cond_14
     invoke-static {v2}, Landroid/content/ComponentName;->unflattenFromString(Ljava/lang/String;)Landroid/content/ComponentName;
 
     move-result-object v9
 
     :goto_8
-    if-eqz v9, :cond_16
+    if-eqz v9, :cond_15
 
     invoke-interface {v8}, Ljava/util/Set;->stream()Ljava/util/stream/Stream;
 
@@ -767,13 +738,13 @@
 
     move-result v10
 
-    if-nez v10, :cond_16
+    if-nez v10, :cond_15
 
     move v10, v5
 
     goto :goto_9
 
-    :cond_16
+    :cond_15
     move v10, v4
 
     :goto_9
@@ -783,9 +754,9 @@
 
     invoke-virtual {p0, v7, v11, v8, v5}, Lcom/android/server/accessibility/AccessibilityManagerService;->readColonDelimitedStringToSet(Ljava/lang/String;Ljava/util/function/Function;Ljava/util/Set;Z)V
 
-    if-eqz v10, :cond_18
+    if-eqz v10, :cond_17
 
-    if-eqz v9, :cond_17
+    if-eqz v9, :cond_16
 
     invoke-interface {v8}, Ljava/util/Set;->stream()Ljava/util/stream/Stream;
 
@@ -807,17 +778,17 @@
 
     move-result v3
 
-    if-eqz v3, :cond_17
+    if-eqz v3, :cond_16
 
     move v3, v5
 
     goto :goto_a
 
-    :cond_17
+    :cond_16
     move v3, v4
 
     :goto_a
-    if-eqz v3, :cond_18
+    if-eqz v3, :cond_17
 
     const-string v3, "AccessibilityManagerService"
 
@@ -841,25 +812,25 @@
 
     invoke-interface {v8, p2}, Ljava/util/Set;->removeIf(Ljava/util/function/Predicate;)Z
 
-    :cond_18
+    :cond_17
     invoke-interface {v8}, Ljava/util/Set;->isEmpty()Z
 
     move-result p2
 
-    if-eqz p2, :cond_1a
+    if-eqz p2, :cond_19
 
     monitor-exit v1
 
     goto :goto_c
 
-    :cond_19
+    :cond_18
     new-instance p2, Lcom/android/server/accessibility/AccessibilityManagerService$$ExternalSyntheticLambda7;
 
     invoke-direct {p2, v5}, Lcom/android/server/accessibility/AccessibilityManagerService$$ExternalSyntheticLambda7;-><init>(I)V
 
     invoke-virtual {p0, v7, p2, v8, v5}, Lcom/android/server/accessibility/AccessibilityManagerService;->readColonDelimitedStringToSet(Ljava/lang/String;Ljava/util/function/Function;Ljava/util/Set;Z)V
 
-    :cond_1a
+    :cond_19
     invoke-virtual {v6, p1, v8}, Lcom/android/server/accessibility/AccessibilityUserState;->updateShortcutTargetsLocked(ILjava/util/Set;)Z
 
     invoke-static {p1}, Lcom/android/internal/accessibility/util/ShortcutUtils;->convertToKey(I)Ljava/lang/String;
@@ -889,7 +860,7 @@
 
     throw p0
 
-    :cond_1b
+    :cond_1a
     new-instance p0, Ljava/lang/IllegalArgumentException;
 
     const-string/jumbo p1, "Tap shortcuts are not supported."
@@ -898,7 +869,7 @@
 
     throw p0
 
-    :cond_1c
+    :cond_1b
     :goto_c
     return-void
 
diff --git a/smali/com/android/server/accessibility/AccessibilityManagerService$AODStateContentObserver.smali b/smali/com/android/server/accessibility/AccessibilityManagerService$AODStateContentObserver.smali
index c132f25ed..bfab60bff 100644
--- a/smali/com/android/server/accessibility/AccessibilityManagerService$AODStateContentObserver.smali
+++ b/smali/com/android/server/accessibility/AccessibilityManagerService$AODStateContentObserver.smali
@@ -83,7 +83,7 @@
 
 # virtual methods
 .method public final onChange(Z)V
-    .locals 5
+    .locals 6
 
     iget v0, p0, Lcom/android/server/accessibility/AccessibilityManagerService$AODStateContentObserver;->$r8$classId:I
 
@@ -245,6 +245,28 @@
     move v1, v3
 
     :goto_0
+    iget-object v4, p0, Lcom/android/server/accessibility/AccessibilityManagerService$AODStateContentObserver;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
+
+    iget-object v4, v4, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
+
+    invoke-virtual {v4}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v4
+
+    const-string/jumbo v5, "accessibility_display_inversion_enabled"
+
+    invoke-static {v4, v5, v3, p1}, Landroid/provider/Settings$Secure;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
+
+    move-result v4
+
+    if-eqz v4, :cond_2
+
+    goto :goto_1
+
+    :cond_2
+    move v2, v3
+
+    :goto_1
     iget-object p0, p0, Lcom/android/server/accessibility/AccessibilityManagerService$AODStateContentObserver;->this$0:Lcom/android/server/accessibility/AccessibilityManagerService;
 
     iget-object p0, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
@@ -253,34 +275,39 @@
 
     move-result-object p0
 
-    const-string/jumbo v4, "accessibility_display_inversion_enabled"
+    const-string/jumbo v4, "aod_show_state"
 
-    invoke-static {p0, v4, v3, p1}, Landroid/provider/Settings$Secure;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
+    invoke-static {p0, v4, v3, p1}, Landroid/provider/Settings$System;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
 
     move-result p0
 
-    if-eqz p0, :cond_2
+    if-eqz p0, :cond_3
+
+    if-eqz v2, :cond_3
 
+    goto :goto_2
+
+    :cond_3
     move v3, v2
 
-    :cond_2
-    if-nez v1, :cond_4
+    :goto_2
+    if-nez v1, :cond_5
 
-    if-eqz v3, :cond_3
+    if-eqz v3, :cond_4
 
     sget-object p0, Lcom/android/server/accessibility/AccessibilityManagerService;->MATRIX_INVERT_COLOR:[F
 
-    goto :goto_1
+    goto :goto_3
 
-    :cond_3
+    :cond_4
     const/4 p0, 0x0
 
-    :goto_1
+    :goto_3
     const/16 p1, 0x12c
 
     invoke-virtual {v0, p1, p0}, Lcom/android/server/display/color/DisplayTransformManager;->setColorMatrix(I[F)V
 
-    :cond_4
+    :cond_5
     return-void
 
     :pswitch_3
diff --git a/smali/com/android/server/accessibility/AccessibilityManagerService.smali b/smali/com/android/server/accessibility/AccessibilityManagerService.smali
index c50ee3767..59fd3dd1f 100644
--- a/smali/com/android/server/accessibility/AccessibilityManagerService.smali
+++ b/smali/com/android/server/accessibility/AccessibilityManagerService.smali
@@ -1026,100 +1026,6 @@
     return-void
 .end method
 
-.method public static -$$Nest$msetColorAdjustment(Landroid/content/Context;Lcom/android/server/accessibility/AccessibilityManagerService;)V
-    .locals 6
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "color_blind"
-
-    const/4 v2, 0x0
-
-    const/4 v3, -0x2
-
-    invoke-static {v0, v1, v2, v3}, Landroid/provider/Settings$System;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
-
-    move-result v0
-
-    const/4 v1, 0x1
-
-    if-ne v0, v1, :cond_0
-
-    move v0, v1
-
-    goto :goto_0
-
-    :cond_0
-    move v0, v2
-
-    :goto_0
-    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object p0
-
-    const-string/jumbo v4, "color_adjustment_type"
-
-    const/4 v5, 0x2
-
-    invoke-static {p0, v4, v5, v3}, Landroid/provider/Settings$Secure;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
-
-    move-result p0
-
-    if-nez p0, :cond_2
-
-    if-eqz v0, :cond_1
-
-    const/4 p0, 0x4
-
-    invoke-virtual {p1, p0, v1}, Lcom/android/server/accessibility/AccessibilityManagerService;->semSetMdnieAccessibilityMode(IZ)Z
-
-    return-void
-
-    :cond_1
-    invoke-virtual {p1, v1, v2}, Lcom/android/server/accessibility/AccessibilityManagerService;->semSetMdnieAccessibilityMode(IZ)Z
-
-    return-void
-
-    :cond_2
-    iget-object p0, p1, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object p0
-
-    const-string/jumbo v4, "color_blind_user_parameter"
-
-    const/4 v5, 0x0
-
-    invoke-static {p0, v4, v5, v3}, Landroid/provider/Settings$Secure;->getFloatForUser(Landroid/content/ContentResolver;Ljava/lang/String;FI)F
-
-    move-result p0
-
-    const/high16 v3, 0x41200000    # 10.0f
-
-    mul-float/2addr p0, v3
-
-    invoke-virtual {p1, v1, v2}, Lcom/android/server/accessibility/AccessibilityManagerService;->semSetMdnieAccessibilityMode(IZ)Z
-
-    :try_start_0
-    invoke-virtual {p1, v0, p0}, Lcom/android/server/accessibility/AccessibilityManagerService;->semSetColorBlind(ZF)Z
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-void
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
-
-    return-void
-.end method
-
 .method static constructor <clinit>()V
     .locals 2
 
@@ -17575,15 +17481,15 @@
 .end method
 
 .method public final semToggleDarkScreenMode()V
-    .locals 7
+    .locals 4
 
     invoke-virtual {p0}, Landroid/view/accessibility/IAccessibilityManager$Stub;->semToggleDarkScreenMode_enforcePermission()V
 
-    const-string/jumbo v0, "semToggleDarkScreenMode()"
+    const-string v0, "AccessibilityManagerService"
 
-    const-string v1, "AccessibilityManagerService"
+    const-string/jumbo v1, "semToggleDarkScreenMode()"
 
-    invoke-static {v1, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-virtual {p0}, Lcom/android/server/accessibility/AccessibilityManagerService;->isScreenReaderEnabled()Z
 
@@ -17595,200 +17501,88 @@
 
     if-nez v0, :cond_0
 
-    goto/16 :goto_2
+    return-void
 
     :cond_0
     iget-boolean v0, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mCurtainModeIsRunning:Z
 
-    const/4 v2, 0x1
-
-    xor-int/2addr v0, v2
+    xor-int/lit8 v0, v0, 0x1
 
     iput-boolean v0, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mCurtainModeIsRunning:Z
 
     iget-object v0, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
 
-    const v3, 0x1040da6
+    const v1, 0x1040da6
 
-    invoke-virtual {v0, v3}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+    invoke-virtual {v0, v1}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
     move-result-object v0
 
-    iget-boolean v3, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mCurtainModeIsRunning:Z
+    iget-boolean v1, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mCurtainModeIsRunning:Z
 
-    if-eqz v3, :cond_1
+    if-eqz v1, :cond_1
 
-    iget-object v3, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
+    iget-object v1, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
 
-    const v4, 0x1040da5
+    const v2, 0x1040da5
 
     filled-new-array {v0}, [Ljava/lang/Object;
 
     move-result-object v0
 
-    invoke-virtual {v3, v4, v0}, Landroid/content/Context;->getString(I[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-virtual {v1, v2, v0}, Landroid/content/Context;->getString(I[Ljava/lang/Object;)Ljava/lang/String;
 
     move-result-object v0
 
     goto :goto_0
 
     :cond_1
-    iget-object v3, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
+    iget-object v1, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
 
-    const v4, 0x1040da4
+    const v2, 0x1040da4
 
     filled-new-array {v0}, [Ljava/lang/Object;
 
     move-result-object v0
 
-    invoke-virtual {v3, v4, v0}, Landroid/content/Context;->getString(I[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-virtual {v1, v2, v0}, Landroid/content/Context;->getString(I[Ljava/lang/Object;)Ljava/lang/String;
 
     move-result-object v0
 
     :goto_0
-    iget-object v3, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v3}, Landroid/view/accessibility/AccessibilityManager;->getInstance(Landroid/content/Context;)Landroid/view/accessibility/AccessibilityManager;
-
-    move-result-object v3
-
-    const/16 v4, 0x20
-
-    invoke-static {v4}, Landroid/view/accessibility/AccessibilityEvent;->obtain(I)Landroid/view/accessibility/AccessibilityEvent;
-
-    move-result-object v4
-
-    invoke-virtual {v4}, Landroid/view/accessibility/AccessibilityEvent;->getText()Ljava/util/List;
-
-    move-result-object v5
-
-    invoke-interface {v5, v0}, Ljava/util/List;->add(Ljava/lang/Object;)Z
-
-    if-eqz v3, :cond_2
-
-    invoke-virtual {v3, v4}, Landroid/view/accessibility/AccessibilityManager;->sendAccessibilityEvent(Landroid/view/accessibility/AccessibilityEvent;)V
-
-    :cond_2
-    iget-object v0, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v3, "mDNIe"
-
-    invoke-virtual {v0, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/samsung/android/hardware/display/SemMdnieManager;
-
-    if-nez v0, :cond_3
-
-    const-string/jumbo p0, "SemMdnieManager is null."
-
-    invoke-static {v1, p0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-
-    :cond_3
-    iget-boolean v1, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mCurtainModeIsRunning:Z
-
-    invoke-virtual {v0, v1}, Lcom/samsung/android/hardware/display/SemMdnieManager;->setmDNIeScreenCurtain(Z)Z
-
-    iget-boolean v1, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mCurtainModeIsRunning:Z
-
-    if-nez v1, :cond_8
-
     iget-object v1, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    invoke-static {v1}, Landroid/view/accessibility/AccessibilityManager;->getInstance(Landroid/content/Context;)Landroid/view/accessibility/AccessibilityManager;
 
     move-result-object v1
 
-    const-string/jumbo v3, "color_blind"
-
-    const/4 v4, 0x0
-
-    const/4 v5, -0x2
-
-    invoke-static {v1, v3, v4, v5}, Landroid/provider/Settings$System;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
-
-    move-result v1
+    const/16 v2, 0x20
 
-    if-ne v1, v2, :cond_4
-
-    move v1, v2
+    invoke-static {v2}, Landroid/view/accessibility/AccessibilityEvent;->obtain(I)Landroid/view/accessibility/AccessibilityEvent;
 
-    goto :goto_1
-
-    :cond_4
-    move v1, v4
-
-    :goto_1
-    iget-object v3, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
+    move-result-object v2
 
-    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    invoke-virtual {v2}, Landroid/view/accessibility/AccessibilityEvent;->getText()Ljava/util/List;
 
     move-result-object v3
 
-    const-string/jumbo v6, "greyscale_mode"
-
-    invoke-static {v3, v6, v4, v5}, Landroid/provider/Settings$System;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
-
-    move-result v3
-
-    if-ne v3, v2, :cond_5
+    invoke-interface {v3, v0}, Ljava/util/List;->add(Ljava/lang/Object;)Z
 
-    move v4, v2
-
-    :cond_5
-    iget-object v3, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v3}, Lcom/samsung/android/emergencymode/SemEmergencyManager;->isEmergencyMode(Landroid/content/Context;)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_6
-
-    goto :goto_2
-
-    :cond_6
-    if-eqz v4, :cond_7
-
-    const/4 p0, 0x4
-
-    invoke-virtual {v0, p0, v2}, Lcom/samsung/android/hardware/display/SemMdnieManager;->setmDNIeAccessibilityMode(IZ)Z
-
-    return-void
-
-    :cond_7
-    if-eqz v1, :cond_8
-
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "color_blind_user_parameter"
-
-    const/4 v3, 0x0
+    if-eqz v1, :cond_2
 
-    invoke-static {v0, v1, v3, v5}, Landroid/provider/Settings$Secure;->getFloatForUser(Landroid/content/ContentResolver;Ljava/lang/String;FI)F
+    invoke-virtual {v1, v2}, Landroid/view/accessibility/AccessibilityManager;->sendAccessibilityEvent(Landroid/view/accessibility/AccessibilityEvent;)V
 
-    move-result v0
+    :cond_2
+    iget-object p0, p0, Lcom/android/server/accessibility/AccessibilityManagerService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {p0, v2, v0}, Lcom/android/server/accessibility/AccessibilityManagerService;->semSetColorBlind(ZF)Z
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
+    const-string/jumbo v0, "mDNIe"
 
-    return-void
+    invoke-virtual {p0, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
 
-    :catch_0
-    move-exception p0
+    move-result-object p0
 
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
+    check-cast p0, Lcom/samsung/android/hardware/display/SemMdnieManager;
 
-    :cond_8
-    :goto_2
     return-void
 .end method
 
diff --git a/smali_classes2/com/samsung/android/hardware/display/SemMdnieManagerService.smali b/smali_classes2/com/samsung/android/hardware/display/SemMdnieManagerService.smali
index 6af0ec708..a5d488f0e 100644
--- a/smali_classes2/com/samsung/android/hardware/display/SemMdnieManagerService.smali
+++ b/smali_classes2/com/samsung/android/hardware/display/SemMdnieManagerService.smali
@@ -36,8 +36,6 @@
 
 .field public final mContext:Landroid/content/Context;
 
-.field public mCurtainModeIsRunning:Z
-
 .field public final mDisplayAiqeManager:Lcom/samsung/android/displayaiqe/DisplayAiqeManager;
 
 .field public final mDisplayListener:Lcom/samsung/android/hardware/display/SemMdnieManagerService$1;
@@ -805,8 +803,6 @@
 
     iput-boolean v5, v0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mNightModeBlock:Z
 
-    iput-boolean v2, v0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mCurtainModeIsRunning:Z
-
     iput-boolean v2, v0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mNightMode:Z
 
     iput-boolean v2, v0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mAdaptiveBlueLightFilterSupported:Z
@@ -1809,153 +1805,6 @@
     return p0
 .end method
 
-.method public static sysfsWrite_CB(ILjava/lang/String;[I)Z
-    .locals 4
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-static {p0}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string p0, " "
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const/4 v1, 0x0
-
-    aget v2, p2, v1
-
-    invoke-static {v2, v0, p0}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/StringBuilder;Ljava/lang/String;)V
-
-    const/4 v2, 0x1
-
-    aget v3, p2, v2
-
-    invoke-static {v3, v0, p0}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/StringBuilder;Ljava/lang/String;)V
-
-    const/4 v3, 0x2
-
-    aget v3, p2, v3
-
-    invoke-static {v3, v0, p0}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/StringBuilder;Ljava/lang/String;)V
-
-    const/4 v3, 0x3
-
-    aget v3, p2, v3
-
-    invoke-static {v3, v0, p0}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/StringBuilder;Ljava/lang/String;)V
-
-    const/4 v3, 0x4
-
-    aget v3, p2, v3
-
-    invoke-static {v3, v0, p0}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/StringBuilder;Ljava/lang/String;)V
-
-    const/4 v3, 0x5
-
-    aget v3, p2, v3
-
-    invoke-static {v3, v0, p0}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/StringBuilder;Ljava/lang/String;)V
-
-    const/4 v3, 0x6
-
-    aget v3, p2, v3
-
-    invoke-static {v3, v0, p0}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/StringBuilder;Ljava/lang/String;)V
-
-    const/4 v3, 0x7
-
-    aget v3, p2, v3
-
-    invoke-static {v3, v0, p0}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/StringBuilder;Ljava/lang/String;)V
-
-    const/16 p0, 0x8
-
-    aget p0, p2, p0
-
-    invoke-static {v0, p0}, Landroid/hardware/audio/common/V2_0/AudioChannelMask$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;I)Ljava/lang/String;
-
-    move-result-object p0
-
-    const/4 p2, 0x0
-
-    :try_start_0
-    new-instance v0, Ljava/io/FileOutputStream;
-
-    new-instance v3, Ljava/io/File;
-
-    invoke-direct {v3, p1}, Ljava/io/File;-><init>(Ljava/lang/String;)V
-
-    invoke-direct {v0, v3}, Ljava/io/FileOutputStream;-><init>(Ljava/io/File;)V
-    :try_end_0
-    .catch Ljava/io/FileNotFoundException; {:try_start_0 .. :try_end_0} :catch_2
-    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_1
-
-    :try_start_1
-    const-string/jumbo p1, "UTF-8"
-
-    invoke-static {p1}, Ljava/nio/charset/Charset;->forName(Ljava/lang/String;)Ljava/nio/charset/Charset;
-
-    move-result-object p1
-
-    invoke-virtual {p0, p1}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
-
-    move-result-object p0
-
-    invoke-virtual {v0, p0}, Ljava/io/FileOutputStream;->write([B)V
-
-    invoke-virtual {v0}, Ljava/io/FileOutputStream;->close()V
-    :try_end_1
-    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0
-
-    return v2
-
-    :catch_0
-    move-exception p0
-
-    move-object p2, v0
-
-    goto :goto_0
-
-    :catch_1
-    move-exception p0
-
-    goto :goto_0
-
-    :catch_2
-    move-exception p0
-
-    :try_start_2
-    invoke-virtual {p0}, Ljava/io/FileNotFoundException;->printStackTrace()V
-    :try_end_2
-    .catch Ljava/io/IOException; {:try_start_2 .. :try_end_2} :catch_1
-
-    goto :goto_1
-
-    :goto_0
-    invoke-virtual {p0}, Ljava/io/IOException;->printStackTrace()V
-
-    :try_start_3
-    invoke-virtual {p2}, Ljava/io/FileOutputStream;->close()V
-    :try_end_3
-    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_3
-
-    goto :goto_1
-
-    :catch_3
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :goto_1
-    return v1
-.end method
-
 
 # virtual methods
 .method public final afpcDataApply()Z
@@ -3921,221 +3770,75 @@
 .end method
 
 .method public final setmDNIeAccessibilityMode(IZ)Z
-    .locals 3
-
-    iget-object v0, p0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v1, "com.samsung.android.permission.CHANGE_DISPLAY_COLOR"
-
-    const-string/jumbo v2, "setmDNIeAccessibilityMode"
-
-    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "setmDNIeAccessibilityMode("
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v1, ", "
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string v1, ")"
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "SemMdnieManagerService"
-
-    invoke-static {v1, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-boolean p0, p0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mCurtainModeIsRunning:Z
-
-    const/4 v0, 0x0
-
-    if-nez p0, :cond_6
-
-    const/16 p0, 0xa
-
-    if-eq p1, p0, :cond_5
-
-    const-string p0, "/sys/class/mdnie/mdnie1/accessibility"
-
-    invoke-static {p0}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;)Z
-
-    move-result v1
-
-    const-string v2, "/sys/class/mdnie/mdnie/accessibility"
-
-    if-eqz v1, :cond_3
-
-    if-eqz p2, :cond_0
-
-    move v1, p1
-
-    goto :goto_0
-
-    :cond_0
-    move v1, v0
-
-    :goto_0
-    invoke-static {v1, v2}, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->sysfsWrite(ILjava/lang/String;)Z
-
-    move-result v1
+    .locals 2
 
-    if-eqz v1, :cond_2
+    iget-object p0, p0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mContext:Landroid/content/Context;
 
-    if-eqz p2, :cond_1
+    const-string/jumbo v0, "com.samsung.android.permission.CHANGE_DISPLAY_COLOR"
 
-    goto :goto_1
+    const-string/jumbo v1, "setmDNIeAccessibilityMode"
 
-    :cond_1
-    move p1, v0
+    invoke-virtual {p0, v0, v1}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V
 
-    :goto_1
-    invoke-static {p1, p0}, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->sysfsWrite(ILjava/lang/String;)Z
+    new-instance p0, Ljava/lang/StringBuilder;
 
-    move-result p0
+    const-string/jumbo v0, "setmDNIeAccessibilityMode("
 
-    if-eqz p0, :cond_2
+    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    const/4 p0, 0x1
+    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    return p0
-
-    :cond_2
-    return v0
+    const-string p1, ", "
 
-    :cond_3
-    if-eqz p2, :cond_4
+    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    goto :goto_2
+    invoke-virtual {p0, p2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    :cond_4
-    move p1, v0
+    const-string p1, ")"
 
-    :goto_2
-    invoke-static {p1, v2}, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->sysfsWrite(ILjava/lang/String;)Z
+    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result p0
+    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    return p0
+    move-result-object p0
 
-    :cond_5
-    const-string p0, "/sys/class/backlight/panel/weakness_hbm_comp"
+    const-string/jumbo p1, "SemMdnieManagerService"
 
-    invoke-static {p2, p0}, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->sysfsWrite(ILjava/lang/String;)Z
+    invoke-static {p1, p0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result p0
+    const/4 p0, 0x0
 
     return p0
-
-    :cond_6
-    return v0
 .end method
 
 .method public final setmDNIeColorBlind(Z[I)Z
-    .locals 4
-
-    iget-object v0, p0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v1, "com.samsung.android.permission.CHANGE_DISPLAY_COLOR"
-
-    const-string/jumbo v2, "setmDNIeColorBlind"
-
-    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "setmDNIeColorBlind ("
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string v1, ")"
-
-    const-string/jumbo v2, "SemMdnieManagerService"
-
-    invoke-static {v0, v1, v2}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-boolean p0, p0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mCurtainModeIsRunning:Z
-
-    const/4 v0, 0x0
-
-    if-nez p0, :cond_5
-
-    const-string p0, "/sys/class/mdnie/mdnie1/accessibility"
-
-    invoke-static {p0}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;)Z
-
-    move-result v1
-
-    const-string v2, "/sys/class/mdnie/mdnie/accessibility"
-
-    const/4 v3, 0x2
-
-    if-eqz v1, :cond_3
-
-    if-eqz p1, :cond_0
-
-    move v1, v3
-
-    goto :goto_0
-
-    :cond_0
-    move v1, v0
-
-    :goto_0
-    invoke-static {v1, v2, p2}, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->sysfsWrite_CB(ILjava/lang/String;[I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_2
-
-    if-eqz p1, :cond_1
+    .locals 1
 
-    goto :goto_1
+    iget-object p0, p0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mContext:Landroid/content/Context;
 
-    :cond_1
-    move v3, v0
+    const-string/jumbo p2, "com.samsung.android.permission.CHANGE_DISPLAY_COLOR"
 
-    :goto_1
-    invoke-static {v3, p0, p2}, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->sysfsWrite_CB(ILjava/lang/String;[I)Z
+    const-string/jumbo v0, "setmDNIeColorBlind"
 
-    move-result p0
+    invoke-virtual {p0, p2, v0}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V
 
-    if-eqz p0, :cond_2
+    new-instance p0, Ljava/lang/StringBuilder;
 
-    const/4 p0, 0x1
+    const-string/jumbo p2, "setmDNIeColorBlind ("
 
-    return p0
+    invoke-direct {p0, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    :cond_2
-    return v0
+    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    :cond_3
-    if-eqz p1, :cond_4
+    const-string p1, ")"
 
-    move v0, v3
+    const-string/jumbo p2, "SemMdnieManagerService"
 
-    :cond_4
-    invoke-static {v0, v2, p2}, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->sysfsWrite_CB(ILjava/lang/String;[I)Z
+    invoke-static {p0, p1, p2}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
 
-    move-result p0
+    const/4 p0, 0x0
 
     return p0
-
-    :cond_5
-    return v0
 .end method
 
 .method public final setmDNIeEmergencyMode(Z)Z
@@ -4209,102 +3912,59 @@
 .end method
 
 .method public final setmDNIeNegative(Z)Z
-    .locals 3
-
-    iget-object v0, p0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v1, "com.samsung.android.permission.CHANGE_DISPLAY_COLOR"
-
-    const-string/jumbo v2, "setmDNIeNegative"
-
-    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "setmDNIeNegative ("
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string v1, ")"
-
-    const-string/jumbo v2, "SemMdnieManagerService"
-
-    invoke-static {v0, v1, v2}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-boolean p0, p0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mCurtainModeIsRunning:Z
-
-    const/4 v0, 0x0
-
-    if-nez p0, :cond_2
-
-    const-string p0, "/sys/class/mdnie/mdnie1/accessibility"
-
-    invoke-static {p0}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;)Z
-
-    move-result v1
-
-    const-string v2, "/sys/class/mdnie/mdnie/accessibility"
+    .locals 2
 
-    if-eqz v1, :cond_1
+    iget-object p0, p0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mContext:Landroid/content/Context;
 
-    invoke-static {p1, v2}, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->sysfsWrite(ILjava/lang/String;)Z
+    const-string/jumbo v0, "com.samsung.android.permission.CHANGE_DISPLAY_COLOR"
 
-    move-result v1
+    const-string/jumbo v1, "setmDNIeNegative"
 
-    if-eqz v1, :cond_0
+    invoke-virtual {p0, v0, v1}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V
 
-    invoke-static {p1, p0}, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->sysfsWrite(ILjava/lang/String;)Z
+    new-instance p0, Ljava/lang/StringBuilder;
 
-    move-result p0
+    const-string/jumbo v0, "setmDNIeNegative ("
 
-    if-eqz p0, :cond_0
+    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    const/4 p0, 0x1
+    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    return p0
+    const-string p1, ")"
 
-    :cond_0
-    return v0
+    const-string/jumbo v0, "SemMdnieManagerService"
 
-    :cond_1
-    invoke-static {p1, v2}, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->sysfsWrite(ILjava/lang/String;)Z
+    invoke-static {p0, p1, v0}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
 
-    move-result p0
+    const/4 p0, 0x0
 
     return p0
-
-    :cond_2
-    return v0
 .end method
 
 .method public final setmDNIeScreenCurtain(Z)Z
     .locals 4
 
-    iget-object v0, p0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v1, "com.samsung.android.permission.CHANGE_DISPLAY_COLOR"
+    iget-object p0, p0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mContext:Landroid/content/Context;
 
-    const-string/jumbo v2, "setmDNIeScreenCurtain"
+    const-string/jumbo v0, "com.samsung.android.permission.CHANGE_DISPLAY_COLOR"
 
-    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V
+    const-string/jumbo v1, "setmDNIeScreenCurtain"
 
-    new-instance v0, Ljava/lang/StringBuilder;
+    invoke-virtual {p0, v0, v1}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V
 
-    const-string/jumbo v1, "setmDNIeScreenCurtain ("
+    new-instance p0, Ljava/lang/StringBuilder;
 
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    const-string/jumbo v0, "setmDNIeScreenCurtain ("
 
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    const-string v1, ")"
+    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    const-string/jumbo v2, "SemMdnieManagerService"
+    const-string v0, ")"
 
-    invoke-static {v0, v1, v2}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
+    const-string/jumbo v1, "SemMdnieManagerService"
 
-    iput-boolean p1, p0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mCurtainModeIsRunning:Z
+    invoke-static {p0, v0, v1}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
 
     const/4 p0, 0x0
 
diff --git a/smali_classes2/com/samsung/android/knox/custom/KnoxCustomManagerService.smali b/smali_classes2/com/samsung/android/knox/custom/KnoxCustomManagerService.smali
index 9bf7e32d5..854481d2b 100644
--- a/smali_classes2/com/samsung/android/knox/custom/KnoxCustomManagerService.smali
+++ b/smali_classes2/com/samsung/android/knox/custom/KnoxCustomManagerService.smali
@@ -27517,60 +27517,51 @@
 .end method
 
 .method public final synthetic lambda$setLcdBacklightState$71(Z)Ljava/lang/Integer;
-    .locals 3
+    .locals 2
     .annotation system Ldalvik/annotation/Throws;
         value = {
             Ljava/lang/Exception;
         }
     .end annotation
 
-    const/4 v0, 0x0
+    const/4 v0, -0x1
 
     invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v0
 
-    const/4 v1, -0x1
-
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
     :try_start_0
-    sget-boolean v2, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->forceLcdBacklightOffEnabled:Z
+    sget-boolean v1, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->forceLcdBacklightOffEnabled:Z
 
-    if-eq p1, v2, :cond_0
+    if-eq p1, v1, :cond_0
 
     invoke-virtual {p0}, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->setScreenCurtainDirect()I
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1
 
-    :try_start_1
-    sput-boolean p1, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->forceLcdBacklightOffEnabled:Z
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
+    const/4 p1, -0x6
 
-    return-object v0
+    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    :catch_0
-    move-exception p1
+    move-result-object p0
 
-    goto :goto_1
+    return-object p0
 
-    :goto_0
-    move-object v0, v1
+    :catch_0
+    move-exception p1
 
-    goto :goto_1
+    goto :goto_0
 
     :cond_0
-    return-object v0
+    const/4 p1, 0x0
 
-    :catch_1
-    move-exception p1
+    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    goto :goto_0
+    move-result-object p0
+    :try_end_0
+    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
 
-    :goto_1
+    return-object p0
+
+    :goto_0
     iput-object p1, p0, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->mPersistenceCause:Ljava/lang/Exception;
 
     return-object v0
@@ -49683,213 +49674,27 @@
 .end method
 
 .method public final setScreenCurtainDirect()I
-    .locals 9
+    .locals 1
 
     iget-boolean v0, p0, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->mKnoxCustomCurtainModeIsRunning:Z
 
-    const/4 v1, 0x1
-
-    xor-int/2addr v0, v1
+    xor-int/lit8 v0, v0, 0x1
 
     iput-boolean v0, p0, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->mKnoxCustomCurtainModeIsRunning:Z
 
-    iget-object v0, p0, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v2, "mDNIe"
-
-    invoke-virtual {v0, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/samsung/android/hardware/display/SemMdnieManager;
-
-    iget-boolean v2, p0, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->mKnoxCustomCurtainModeIsRunning:Z
-
-    const/4 v3, 0x0
-
-    if-eqz v2, :cond_0
-
-    invoke-virtual {v0, v2}, Lcom/samsung/android/hardware/display/SemMdnieManager;->setmDNIeScreenCurtain(Z)Z
-
-    goto/16 :goto_4
-
-    :cond_0
-    iget-object v2, p0, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object v2
-
-    const-string/jumbo v4, "high_contrast"
-
-    const/4 v5, -0x2
-
-    invoke-static {v2, v4, v3, v5}, Landroid/provider/Settings$System;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
-
-    move-result v2
-
-    if-ne v2, v1, :cond_1
-
-    move v2, v1
-
-    goto :goto_0
-
-    :cond_1
-    move v2, v3
-
-    :goto_0
-    iget-object v4, p0, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v4}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object v4
-
-    const-string/jumbo v6, "color_blind"
-
-    invoke-static {v4, v6, v3, v5}, Landroid/provider/Settings$System;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
-
-    move-result v4
-
-    if-ne v4, v1, :cond_2
-
-    move v4, v1
-
-    goto :goto_1
-
-    :cond_2
-    move v4, v3
-
-    :goto_1
-    iget-object v6, p0, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v6}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object v6
-
-    const-string/jumbo v7, "greyscale_mode"
-
-    invoke-static {v6, v7, v3, v5}, Landroid/provider/Settings$System;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
-
-    move-result v6
-
-    if-ne v6, v1, :cond_3
-
-    move v6, v1
-
-    goto :goto_2
-
-    :cond_3
-    move v6, v3
-
-    :goto_2
-    iget-object v7, p0, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v7}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object v7
-
-    const-string/jumbo v8, "powersaving_switch"
-
-    invoke-static {v7, v8, v3, v5}, Landroid/provider/Settings$System;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
-
-    move-result v5
-
-    if-ne v5, v1, :cond_4
-
-    move v5, v1
-
-    goto :goto_3
-
-    :cond_4
-    move v5, v3
-
-    :goto_3
-    if-eqz v2, :cond_5
-
-    if-eqz v6, :cond_5
-
-    const/4 p0, 0x5
-
-    invoke-virtual {v0, p0, v1}, Lcom/samsung/android/hardware/display/SemMdnieManager;->setmDNIeAccessibilityMode(IZ)Z
-
-    goto :goto_4
-
-    :cond_5
-    if-eqz v5, :cond_6
-
-    const/16 p0, 0x9
-
-    :try_start_0
-    new-array p0, p0, [I
-
-    fill-array-data p0, :array_0
-
-    invoke-virtual {v0, v1, p0}, Lcom/samsung/android/hardware/display/SemMdnieManager;->setmDNIeColorBlind(Z[I)Z
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_4
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    goto :goto_4
-
-    :cond_6
-    if-eqz v6, :cond_7
-
-    const/4 p0, 0x4
-
-    invoke-virtual {v0, p0, v1}, Lcom/samsung/android/hardware/display/SemMdnieManager;->setmDNIeAccessibilityMode(IZ)Z
-
-    goto :goto_4
-
-    :cond_7
-    if-eqz v2, :cond_8
-
-    invoke-virtual {v0, v1}, Lcom/samsung/android/hardware/display/SemMdnieManager;->setmDNIeNegative(Z)Z
-
-    goto :goto_4
-
-    :cond_8
-    if-eqz v4, :cond_9
-
-    new-instance v0, Landroid/content/Intent;
-
-    const-string/jumbo v1, "com.samsung.android.app.colorblind.ACTION_COLORBLIND_SWITCH_ON"
-
-    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V
-
     iget-object p0, p0, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->mContext:Landroid/content/Context;
 
-    sget-object v1, Landroid/os/UserHandle;->ALL:Landroid/os/UserHandle;
-
-    invoke-virtual {p0, v0, v1}, Landroid/content/Context;->sendBroadcastAsUser(Landroid/content/Intent;Landroid/os/UserHandle;)V
+    const-string/jumbo v0, "mDNIe"
 
-    goto :goto_4
+    invoke-virtual {p0, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
 
-    :cond_9
-    iget-boolean p0, p0, Lcom/samsung/android/knox/custom/KnoxCustomManagerService;->mKnoxCustomCurtainModeIsRunning:Z
+    move-result-object p0
 
-    invoke-virtual {v0, p0}, Lcom/samsung/android/hardware/display/SemMdnieManager;->setmDNIeScreenCurtain(Z)Z
+    check-cast p0, Lcom/samsung/android/hardware/display/SemMdnieManager;
 
-    :goto_4
-    return v3
+    const/4 p0, -0x6
 
-    :array_0
-    .array-data 4
-        0x4cb3
-        0x4cb3
-        0x4cb3
-        0x9669
-        0x9669
-        0x9669
-        0x1de2
-        0x1de2
-        0x1de2
-    .end array-data
+    return p0
 .end method
 
 .method public final setScreenOffOnHomeLongPressState(Z)I
-- 
2.51.0

