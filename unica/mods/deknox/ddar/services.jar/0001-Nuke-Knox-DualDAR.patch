From 604084d1768a6b20cc3faead94cbe4495b9ab5c1 Mon Sep 17 00:00:00 2001
From: Salvo Giangreco <giangrecosalvo9@gmail.com>
Date: Sat, 30 Aug 2025 13:18:53 +0200
Subject: [PATCH] Nuke Knox DualDAR

UN1CA: this patch is not complete! Please check unica/mods/deknox/customize.sh for more info.
---
 .../server/am/ActivityManagerService.smali    | 1528 +++--
 .../server/am/DualDarUserController.smali     |   72 -
 smali/com/android/server/am/ProcessList.smali | 1036 ++--
 ...Controller$$ExternalSyntheticLambda2.smali |  135 +-
 ...Controller$$ExternalSyntheticLambda4.smali |   71 +-
 .../android/server/am/UserController.smali    |  333 +-
 .../DevicePolicyManagerService.smali          | 1751 ++----
 .../DualDarProvisioningHelper$1.smali         |  424 --
 .../DualDarProvisioningHelper$5.smali         |   60 -
 .../DualDarProvisioningHelper.smali           |  297 +-
 .../EnterpriseDeviceManagerServiceImpl.smali  |  585 +-
 .../container/KnoxMUMContainerPolicy$2.smali  |   68 +-
 .../container/KnoxMUMContainerPolicy.smali    |  118 -
 .../enterprise/dualdar/DualDARPolicy.smali    |  324 +-
 .../enterprise/security/PasswordPolicy.smali  |  156 +-
 ...gerService$$ExternalSyntheticLambda0.smali |  507 +-
 ...gerService$$ExternalSyntheticLambda1.smali |   93 -
 .../knox/dar/DarManagerService$Injector.smali |    8 +-
 .../server/knox/dar/DarManagerService.smali   |  748 +--
 .../com/android/server/knox/dar/DarUtil.smali |  131 -
 .../knox/dar/EnterprisePartitionManager.smali |  550 --
 .../dar/ddar/DDLog$CountingOutputStream.smali |  106 -
 .../server/knox/dar/ddar/DDLog$Logger$1.smali |   45 -
 .../server/knox/dar/ddar/DDLog$Logger$2.smali |  110 -
 .../server/knox/dar/ddar/DDLog$Logger.smali   |  774 +--
 .../knox/dar/ddar/DDLog$LoggerProxy.smali     |   60 -
 .../android/server/knox/dar/ddar/DDLog.smali  |   84 +-
 .../dar/ddar/DualDarDoPolicyChecker.smali     |   67 -
 ...anagerImpl$$ExternalSyntheticLambda0.smali |   44 -
 ...anagerImpl$$ExternalSyntheticLambda1.smali |   50 -
 .../dar/ddar/core/DualDarDoManagerImpl.smali  |  154 -
 ...anagerImpl$$ExternalSyntheticLambda0.smali |   60 -
 ...anagerImpl$$ExternalSyntheticLambda2.smali |   36 -
 .../core/DualDarManagerImpl$Injector.smali    |   19 -
 ...nagerImpl$LicenseExpiryAlarmListener.smali |   80 -
 .../dar/ddar/core/DualDarManagerImpl.smali    |  622 --
 .../dar/ddar/core/DualDarManagerProxy.smali   |  463 --
 ...StateMachineImpl$StateChangeListener.smali |    3 -
 .../knox/dar/ddar/fsm/StateMachineImpl.smali  |  207 -
 .../knox/dar/ddar/fsm/StateMachineProxy.smali |  843 ---
 .../nativedaemon/DualDARDaemonProxy$1.smali   |   68 -
 ...DARDaemonProxy$ClearUserDataObserver.smali |   43 -
 .../nativedaemon/DualDARDaemonProxy.smali     | 3079 ----------
 ...onConnector$ResponseQueue$PendingCmd.smali |   35 -
 ...DualDarDaemonConnector$ResponseQueue.smali |  334 --
 .../nativedaemon/DualDarDaemonConnector.smali | 1278 ----
 .../ddar/nativedaemon/NativeDaemonEvent.smali |  514 --
 ...omnService$$ExternalSyntheticLambda1.smali |  137 -
 .../dar/ddar/proxy/DualDARComnService$1.smali |  115 +-
 .../dar/ddar/proxy/DualDARComnService$3.smali |  153 +-
 .../dar/ddar/proxy/DualDARComnService$4.smali |    6 +-
 .../dar/ddar/proxy/DualDARComnService.smali   |  476 +-
 ...tformProxy$$ExternalSyntheticLambda0.smali |  223 -
 ...tformProxy$$ExternalSyntheticLambda1.smali |  124 -
 .../dar/ddar/proxy/DualDARPlatformProxy.smali |  259 -
 .../dar/ddar/proxy/ProxyAgentWrapper$1.smali  |   24 +-
 .../dar/ddar/proxy/SystemProxyAgent.smali     |   26 +-
 .../knox/dar/ddar/ta/TAProxy$TAInfo.smali     |   17 -
 .../server/knox/dar/ddar/ta/TAProxy.smali     | 1012 ----
 .../server/knox/dar/ddar/ta/TZNative.smali    |  229 -
 .../android/server/knox/dar/sdp/SDPLog.smali  |  110 +-
 ...gsService$$ExternalSyntheticLambda10.smali |  361 ++
 ...gsService$$ExternalSyntheticLambda11.smali |  355 +-
 ...gsService$$ExternalSyntheticLambda12.smali |  344 +-
 ...gsService$$ExternalSyntheticLambda13.smali |  518 +-
 ...gsService$$ExternalSyntheticLambda14.smali |  532 --
 ...sService$$ExternalSyntheticLambda20.smali} |   14 +-
 ...ngsService$$ExternalSyntheticLambda4.smali |   74 +-
 ...ngsService$$ExternalSyntheticLambda5.smali |   47 +
 ...ngsService$$ExternalSyntheticLambda6.smali |   67 +-
 ...ngsService$$ExternalSyntheticLambda7.smali |   74 +-
 ...ngsService$$ExternalSyntheticLambda8.smali |  114 -
 .../locksettings/LockSettingsService$2.smali  |   31 +-
 .../locksettings/LockSettingsService$3.smali  |  473 +-
 .../locksettings/LockSettingsService$4.smali  |    4 +-
 .../LockSettingsService$DarLockSettings.smali |  204 +-
 ...kSettingsService$DualDarLockSettings.smali |    3 +
 .../LockSettingsService$Injector$1.smali      | 1809 +-----
 .../LockSettingsService$Lifecycle.smali       |  121 +-
 .../LockSettingsService$LocalService.smali    |   14 +-
 .../locksettings/LockSettingsService.smali    | 5331 ++++++-----------
 .../locksettings/LockSettingsStorage.smali    |   93 +-
 .../server/locksettings/SP800Derive.smali     |  122 -
 ...ticPasswordManager$SyntheticPassword.smali |   97 +-
 .../SyntheticPasswordManager.smali            |  249 -
 .../android/server/pm/ComputerEngine.smali    |  222 +-
 .../server/pm/PersonaManagerService$2.smali   |  215 +-
 ...viceHelper$$ExternalSyntheticLambda0.smali |  169 -
 ...viceHelper$$ExternalSyntheticLambda2.smali |   62 -
 ...viceHelper$$ExternalSyntheticLambda3.smali |   44 -
 ...viceHelper$$ExternalSyntheticLambda4.smali |   24 -
 .../server/pm/PersonaServiceHelper.smali      |  572 --
 .../server/pm/UserManagerInternal.smali       |    3 -
 .../pm/UserManagerService$LocalService.smali  |  143 +-
 .../server/pm/UserManagerService.smali        | 2454 +++-----
 .../server/trust/TrustManagerService$3.smali  |  238 +-
 .../server/trust/TrustManagerService$4.smali  |   16 +-
 .../server/trust/TrustManagerService.smali    |  465 +-
 .../tlc/ddar/ISehDdar$Stub$Proxy.smali        |   20 -
 .../hardware/tlc/ddar/ISehDdar$Stub.smali     |   10 -
 .../samsung/hardware/tlc/ddar/ISehDdar.smali  |   30 -
 101 files changed, 7159 insertions(+), 29663 deletions(-)
 delete mode 100644 smali/com/android/server/am/DualDarUserController.smali
 delete mode 100644 smali/com/android/server/devicepolicy/DualDarProvisioningHelper$1.smali
 delete mode 100644 smali/com/android/server/devicepolicy/DualDarProvisioningHelper$5.smali
 delete mode 100644 smali/com/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/DDLog$CountingOutputStream.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/DDLog$Logger$1.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/DDLog$Logger$2.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/DDLog$LoggerProxy.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/DualDarDoPolicyChecker.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda0.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/core/DualDarDoManagerImpl.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/core/DualDarManagerProxy.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/fsm/StateMachineImpl$StateChangeListener.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/fsm/StateMachineImpl.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/fsm/StateMachineProxy.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$1.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$$ExternalSyntheticLambda1.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda0.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda1.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/ta/TAProxy$TAInfo.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/ta/TAProxy.smali
 delete mode 100644 smali/com/android/server/knox/dar/ddar/ta/TZNative.smali
 create mode 100644 smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10.smali
 delete mode 100644 smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14.smali
 rename smali/com/android/server/locksettings/{LockSettingsService$$ExternalSyntheticLambda21.smali => LockSettingsService$$ExternalSyntheticLambda20.smali} (84%)
 create mode 100644 smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5.smali
 delete mode 100644 smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8.smali
 create mode 100644 smali/com/android/server/locksettings/LockSettingsService$DualDarLockSettings.smali
 delete mode 100644 smali/com/android/server/locksettings/SP800Derive.smali
 delete mode 100644 smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0.smali
 delete mode 100644 smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2.smali
 delete mode 100644 smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3.smali
 delete mode 100644 smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4.smali
 delete mode 100644 smali_classes2/vendor/samsung/hardware/tlc/ddar/ISehDdar$Stub$Proxy.smali
 delete mode 100644 smali_classes2/vendor/samsung/hardware/tlc/ddar/ISehDdar$Stub.smali
 delete mode 100644 smali_classes2/vendor/samsung/hardware/tlc/ddar/ISehDdar.smali

diff --git a/smali/com/android/server/am/ActivityManagerService.smali b/smali/com/android/server/am/ActivityManagerService.smali
index 5fd472f46..b879c75ba 100644
--- a/smali/com/android/server/am/ActivityManagerService.smali
+++ b/smali/com/android/server/am/ActivityManagerService.smali
@@ -32957,88 +32957,88 @@
 .end method
 
 .method public final finishBooting()V
-    .locals 22
+    .locals 26
 
     move-object/from16 v1, p0
 
     const/4 v0, 0x5
 
-    const/4 v2, 0x2
-
-    const/4 v3, 0x1
+    const/4 v2, 0x1
 
-    new-instance v4, Lcom/android/server/utils/TimingsTraceAndSlog;
+    new-instance v3, Lcom/android/server/utils/TimingsTraceAndSlog;
 
-    const-string v5, "ActivityManagerTiming"
+    const-string v4, "ActivityManagerTiming"
 
-    const-wide/16 v6, 0x40
+    const-wide/16 v5, 0x40
 
-    invoke-direct {v4, v6, v7, v5}, Lcom/android/server/utils/TimingsTraceAndSlog;-><init>(JLjava/lang/String;)V
+    invoke-direct {v3, v5, v6, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;-><init>(JLjava/lang/String;)V
 
-    const-string v5, "FinishBooting"
+    const-string v4, "FinishBooting"
 
-    invoke-virtual {v4, v5}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+    invoke-virtual {v3, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
-    const-string/jumbo v5, "finishBooting"
+    const-string/jumbo v4, "finishBooting"
 
-    const-string/jumbo v6, "NULL"
+    const-string/jumbo v5, "NULL"
 
-    const/4 v7, 0x0
+    const/4 v6, 0x0
 
-    const/4 v8, -0x1
+    const/4 v7, -0x1
 
-    invoke-static {v7, v8, v7, v5, v6}, Lcom/android/server/am/EventLogTags;->writeBootProgressAmsState(IIILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {v6, v7, v6, v4, v5}, Lcom/android/server/am/EventLogTags;->writeBootProgressAmsState(IIILjava/lang/String;Ljava/lang/String;)V
 
-    const-class v5, Lcom/android/server/am/ProcessCpusetController;
+    const-class v4, Lcom/android/server/am/ProcessCpusetController;
 
-    monitor-enter v5
+    monitor-enter v4
 
     :try_start_0
-    sget-object v6, Lcom/android/server/am/ProcessCpusetController;->mController:Lcom/android/server/am/ProcessCpusetController;
+    sget-object v5, Lcom/android/server/am/ProcessCpusetController;->mController:Lcom/android/server/am/ProcessCpusetController;
 
-    if-nez v6, :cond_0
+    if-nez v5, :cond_0
 
-    new-instance v6, Lcom/android/server/am/ProcessCpusetController;
+    new-instance v5, Lcom/android/server/am/ProcessCpusetController;
 
-    invoke-direct {v6, v1}, Lcom/android/server/am/ProcessCpusetController;-><init>(Lcom/android/server/am/ActivityManagerService;)V
+    invoke-direct {v5, v1}, Lcom/android/server/am/ProcessCpusetController;-><init>(Lcom/android/server/am/ActivityManagerService;)V
 
-    sput-object v6, Lcom/android/server/am/ProcessCpusetController;->mController:Lcom/android/server/am/ProcessCpusetController;
+    sput-object v5, Lcom/android/server/am/ProcessCpusetController;->mController:Lcom/android/server/am/ProcessCpusetController;
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    monitor-exit v5
+    monitor-exit v4
 
     goto :goto_0
 
     :catchall_0
     move-exception v0
 
-    goto/16 :goto_18
+    goto/16 :goto_13
 
     :cond_0
-    monitor-exit v5
+    monitor-exit v4
 
     :goto_0
-    sget-object v5, Lcom/android/server/am/ProcessCpusetController;->mController:Lcom/android/server/am/ProcessCpusetController;
+    sget-object v4, Lcom/android/server/am/ProcessCpusetController;->mController:Lcom/android/server/am/ProcessCpusetController;
 
-    iput-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mProcessCpusetController:Lcom/android/server/am/ProcessCpusetController;
+    iput-object v4, v1, Lcom/android/server/am/ActivityManagerService;->mProcessCpusetController:Lcom/android/server/am/ProcessCpusetController;
 
     invoke-static {}, Lcom/android/server/am/ActivityManagerService;->boostPriorityForLockedSection()V
 
     monitor-enter p0
 
     :try_start_1
-    iget-boolean v5, v1, Lcom/android/server/am/ActivityManagerService;->mBootAnimationComplete:Z
+    iget-boolean v4, v1, Lcom/android/server/am/ActivityManagerService;->mBootAnimationComplete:Z
 
-    if-nez v5, :cond_1
+    const/4 v11, 0x2
 
-    iput-boolean v3, v1, Lcom/android/server/am/ActivityManagerService;->mCallFinishBooting:Z
+    if-nez v4, :cond_1
+
+    iput-boolean v2, v1, Lcom/android/server/am/ActivityManagerService;->mCallFinishBooting:Z
 
     const-string/jumbo v0, "finishBooting"
 
-    const-string/jumbo v3, "mBootAnimationComplete is not ready"
+    const-string/jumbo v2, "mBootAnimationComplete is not ready"
 
-    invoke-static {v7, v8, v2, v0, v3}, Lcom/android/server/am/EventLogTags;->writeBootProgressAmsState(IIILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {v6, v7, v11, v0, v2}, Lcom/android/server/am/EventLogTags;->writeBootProgressAmsState(IIILjava/lang/String;Ljava/lang/String;)V
 
     monitor-exit p0
     :try_end_1
@@ -33051,11 +33051,11 @@
     :catchall_1
     move-exception v0
 
-    goto/16 :goto_17
+    goto/16 :goto_12
 
     :cond_1
     :try_start_2
-    iput-boolean v7, v1, Lcom/android/server/am/ActivityManagerService;->mCallFinishBooting:Z
+    iput-boolean v6, v1, Lcom/android/server/am/ActivityManagerService;->mCallFinishBooting:Z
 
     monitor-exit p0
     :try_end_2
@@ -33063,110 +33063,110 @@
 
     invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
 
-    sget-object v5, Landroid/os/Process;->ZYGOTE_PROCESS:Landroid/os/ZygoteProcess;
+    sget-object v4, Landroid/os/Process;->ZYGOTE_PROCESS:Landroid/os/ZygoteProcess;
 
-    invoke-virtual {v5}, Landroid/os/ZygoteProcess;->bootCompleted()V
+    invoke-virtual {v4}, Landroid/os/ZygoteProcess;->bootCompleted()V
 
     invoke-static {}, Ldalvik/system/VMRuntime;->bootCompleted()V
 
-    new-instance v5, Landroid/content/IntentFilter;
+    new-instance v4, Landroid/content/IntentFilter;
 
-    invoke-direct {v5}, Landroid/content/IntentFilter;-><init>()V
+    invoke-direct {v4}, Landroid/content/IntentFilter;-><init>()V
 
-    const-string/jumbo v6, "android.intent.action.QUERY_PACKAGE_RESTART"
+    const-string/jumbo v5, "android.intent.action.QUERY_PACKAGE_RESTART"
 
-    invoke-virtual {v5, v6}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
+    invoke-virtual {v4, v5}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
 
-    const-string/jumbo v6, "package"
+    const-string/jumbo v5, "package"
 
-    invoke-virtual {v5, v6}, Landroid/content/IntentFilter;->addDataScheme(Ljava/lang/String;)V
+    invoke-virtual {v4, v5}, Landroid/content/IntentFilter;->addDataScheme(Ljava/lang/String;)V
 
-    iget-object v6, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
+    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    new-instance v9, Lcom/android/server/am/ActivityManagerService$9;
+    new-instance v8, Lcom/android/server/am/ActivityManagerService$9;
 
-    invoke-direct {v9, v1, v7}, Lcom/android/server/am/ActivityManagerService$9;-><init>(Lcom/android/server/am/ActivityManagerService;I)V
+    invoke-direct {v8, v1, v6}, Lcom/android/server/am/ActivityManagerService$9;-><init>(Lcom/android/server/am/ActivityManagerService;I)V
 
-    invoke-virtual {v6, v9, v5}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
+    invoke-virtual {v5, v8, v4}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
 
     :try_start_3
-    const-string v5, "ActivityManager"
+    const-string v4, "ActivityManager"
 
-    const-string v6, "About to commit checkpoint"
+    const-string v5, "About to commit checkpoint"
 
-    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-static {}, Lcom/android/internal/content/InstallLocationUtils;->getStorageManager()Landroid/os/storage/IStorageManager;
 
-    move-result-object v5
+    move-result-object v4
 
-    invoke-interface {v5}, Landroid/os/storage/IStorageManager;->commitChanges()V
+    invoke-interface {v4}, Landroid/os/storage/IStorageManager;->commitChanges()V
     :try_end_3
     .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_0
 
     goto :goto_1
 
     :catch_0
-    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mInjector:Lcom/android/server/am/ActivityManagerService$Injector;
+    iget-object v4, v1, Lcom/android/server/am/ActivityManagerService;->mInjector:Lcom/android/server/am/ActivityManagerService$Injector;
 
-    iget-object v5, v5, Lcom/android/server/am/ActivityManagerService$Injector;->mContext:Landroid/content/Context;
+    iget-object v4, v4, Lcom/android/server/am/ActivityManagerService$Injector;->mContext:Landroid/content/Context;
 
-    const-string/jumbo v6, "power"
+    const-string/jumbo v5, "power"
 
-    invoke-virtual {v5, v6}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
+    invoke-virtual {v4, v5}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v4
 
-    check-cast v5, Landroid/os/PowerManager;
+    check-cast v4, Landroid/os/PowerManager;
 
-    const-string v6, "Checkpoint commit failed"
+    const-string v5, "Checkpoint commit failed"
 
-    invoke-virtual {v5, v6}, Landroid/os/PowerManager;->reboot(Ljava/lang/String;)V
+    invoke-virtual {v4, v5}, Landroid/os/PowerManager;->reboot(Ljava/lang/String;)V
 
     :goto_1
-    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mDynamicHiddenApp:Lcom/android/server/am/DynamicHiddenApp;
+    iget-object v4, v1, Lcom/android/server/am/ActivityManagerService;->mDynamicHiddenApp:Lcom/android/server/am/DynamicHiddenApp;
 
-    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    sget v6, Lcom/android/server/bgslotmanager/CameraKillModeManager;->CAMERA_DHA_VER:I
+    sget v5, Lcom/android/server/bgslotmanager/CameraKillModeManager;->CAMERA_DHA_VER:I
 
-    sget-object v6, Lcom/android/server/bgslotmanager/CameraKillModeManager$CameraKillModeManagerLazyHolder;->INSTANCE:Lcom/android/server/bgslotmanager/CameraKillModeManager;
+    sget-object v5, Lcom/android/server/bgslotmanager/CameraKillModeManager$CameraKillModeManagerLazyHolder;->INSTANCE:Lcom/android/server/bgslotmanager/CameraKillModeManager;
 
-    iput-object v6, v5, Lcom/android/server/am/DynamicHiddenApp;->mCameraKillModeManager:Lcom/android/server/bgslotmanager/CameraKillModeManager;
+    iput-object v5, v4, Lcom/android/server/am/DynamicHiddenApp;->mCameraKillModeManager:Lcom/android/server/bgslotmanager/CameraKillModeManager;
 
-    iget-object v9, v5, Lcom/android/server/am/DynamicHiddenApp;->mContext:Landroid/content/Context;
+    iget-object v8, v4, Lcom/android/server/am/DynamicHiddenApp;->mContext:Landroid/content/Context;
 
-    iget-object v10, v5, Lcom/android/server/am/DynamicHiddenApp;->mAm:Lcom/android/server/am/ActivityManagerService;
+    iget-object v9, v4, Lcom/android/server/am/DynamicHiddenApp;->mAm:Lcom/android/server/am/ActivityManagerService;
 
-    iget-object v10, v10, Lcom/android/server/am/ActivityManagerService;->mHandler:Lcom/android/server/am/ActivityManagerService$UiHandler;
+    iget-object v9, v9, Lcom/android/server/am/ActivityManagerService;->mHandler:Lcom/android/server/am/ActivityManagerService$UiHandler;
 
-    invoke-virtual {v6}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    sget-boolean v11, Lcom/android/server/bgslotmanager/CameraKillModeManager$CameraKillModeManagerLazyHolder;->isinitClass:Z
+    sget-boolean v10, Lcom/android/server/bgslotmanager/CameraKillModeManager$CameraKillModeManagerLazyHolder;->isinitClass:Z
 
-    iget-object v12, v5, Lcom/android/server/am/DynamicHiddenApp;->mBGSlotManager:Lcom/android/server/bgslotmanager/BGSlotManager;
+    iget-object v12, v4, Lcom/android/server/am/DynamicHiddenApp;->mBGSlotManager:Lcom/android/server/bgslotmanager/BGSlotManager;
 
-    if-nez v11, :cond_7
+    if-nez v10, :cond_7
 
-    iput-object v5, v6, Lcom/android/server/bgslotmanager/CameraKillModeManager;->mDynamicHiddenApp:Lcom/android/server/am/DynamicHiddenApp;
+    iput-object v4, v5, Lcom/android/server/bgslotmanager/CameraKillModeManager;->mDynamicHiddenApp:Lcom/android/server/am/DynamicHiddenApp;
 
-    iget-object v11, v5, Lcom/android/server/am/DynamicHiddenApp;->mInfo:Lcom/android/server/bgslotmanager/MemInfoGetter;
+    iget-object v10, v4, Lcom/android/server/am/DynamicHiddenApp;->mInfo:Lcom/android/server/bgslotmanager/MemInfoGetter;
 
-    iput-object v11, v6, Lcom/android/server/bgslotmanager/CameraKillModeManager;->mInfo:Lcom/android/server/bgslotmanager/MemInfoGetter;
+    iput-object v10, v5, Lcom/android/server/bgslotmanager/CameraKillModeManager;->mInfo:Lcom/android/server/bgslotmanager/MemInfoGetter;
 
-    iput-object v12, v6, Lcom/android/server/bgslotmanager/CameraKillModeManager;->mBGSlotManager:Lcom/android/server/bgslotmanager/BGSlotManager;
+    iput-object v12, v5, Lcom/android/server/bgslotmanager/CameraKillModeManager;->mBGSlotManager:Lcom/android/server/bgslotmanager/BGSlotManager;
 
-    sget v11, Lcom/android/server/bgslotmanager/CameraKillModeManager;->CAMERA_DHA_VER:I
+    sget v10, Lcom/android/server/bgslotmanager/CameraKillModeManager;->CAMERA_DHA_VER:I
 
-    if-lez v11, :cond_3
+    if-lez v10, :cond_3
 
-    iget-object v11, v5, Lcom/android/server/am/DynamicHiddenApp;->mProcessList:Lcom/android/server/am/ProcessList;
+    iget-object v10, v4, Lcom/android/server/am/DynamicHiddenApp;->mProcessList:Lcom/android/server/am/ProcessList;
 
-    if-eqz v11, :cond_2
+    if-eqz v10, :cond_2
 
     const/16 v15, 0x3e7
 
-    invoke-virtual {v11, v15}, Lcom/android/server/am/ProcessList;->getMemLevel(I)J
+    invoke-virtual {v10, v15}, Lcom/android/server/am/ProcessList;->getMemLevel(I)J
 
     move-result-wide v15
 
@@ -33178,44 +33178,44 @@
     const-wide/16 v13, 0x0
 
     :goto_2
-    long-to-float v11, v13
+    long-to-float v10, v13
 
-    iput v11, v6, Lcom/android/server/bgslotmanager/CameraKillModeManager;->mMinFreeMax:F
+    iput v10, v5, Lcom/android/server/bgslotmanager/CameraKillModeManager;->mMinFreeMax:F
 
     :cond_3
-    sget v11, Lcom/android/server/bgslotmanager/CameraKillModeManager;->CAMERA_DHA_VER:I
+    sget v10, Lcom/android/server/bgslotmanager/CameraKillModeManager;->CAMERA_DHA_VER:I
 
-    if-le v11, v3, :cond_5
+    if-le v10, v2, :cond_5
 
-    const/16 v11, 0x63
+    const/16 v10, 0x63
 
-    invoke-static {v11, v7, v7}, Lcom/android/server/am/DynamicHiddenApp;->setLmkdCameraKillBoost(III)V
+    invoke-static {v10, v6, v6}, Lcom/android/server/am/DynamicHiddenApp;->setLmkdCameraKillBoost(III)V
 
-    move v11, v7
+    move v10, v6
 
     :goto_3
     sget-object v13, Lcom/android/server/am/BGProtectManager;->LMKD_CAM_CLIENT_EXCEPT_ARRAY:[Ljava/lang/String;
 
     array-length v14, v13
 
-    if-ge v11, v14, :cond_4
+    if-ge v10, v14, :cond_4
 
-    iget-object v14, v6, Lcom/android/server/bgslotmanager/CameraKillModeManager;->dha_cameraclientexcept_map:Ljava/util/HashMap;
+    iget-object v14, v5, Lcom/android/server/bgslotmanager/CameraKillModeManager;->dha_cameraclientexcept_map:Ljava/util/HashMap;
 
-    aget-object v13, v13, v11
+    aget-object v13, v13, v10
 
-    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v15
 
     invoke-virtual {v14, v13, v15}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
 
-    add-int/2addr v11, v3
+    add-int/2addr v10, v2
 
     goto :goto_3
 
     :cond_4
-    iget-object v11, v6, Lcom/android/server/bgslotmanager/CameraKillModeManager;->dha_camera_map:Ljava/util/LinkedHashMap;
+    iget-object v10, v5, Lcom/android/server/bgslotmanager/CameraKillModeManager;->dha_camera_map:Ljava/util/LinkedHashMap;
 
     const-string/jumbo v13, "Y29tLnNlYy5hbmRyb2lkLmFwcC5jYW1lcmE="
 
@@ -33223,570 +33223,438 @@
 
     move-result-object v13
 
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v14
 
-    invoke-virtual {v11, v13, v14}, Ljava/util/LinkedHashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {v10, v13, v14}, Ljava/util/LinkedHashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
 
     :cond_5
-    const-string/jumbo v11, "camera"
+    const-string/jumbo v10, "camera"
 
-    invoke-virtual {v9, v11}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
+    invoke-virtual {v8, v10}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
 
-    move-result-object v9
+    move-result-object v8
 
-    check-cast v9, Landroid/hardware/camera2/CameraManager;
+    check-cast v8, Landroid/hardware/camera2/CameraManager;
 
-    iput-object v9, v6, Lcom/android/server/bgslotmanager/CameraKillModeManager;->mCameraManager:Landroid/hardware/camera2/CameraManager;
+    iput-object v8, v5, Lcom/android/server/bgslotmanager/CameraKillModeManager;->mCameraManager:Landroid/hardware/camera2/CameraManager;
 
-    if-eqz v9, :cond_6
+    if-eqz v8, :cond_6
 
-    invoke-virtual {v9, v6}, Landroid/hardware/camera2/CameraManager;->unregisterSemCameraDeviceStateCallback(Landroid/hardware/camera2/CameraManager$SemCameraDeviceStateCallback;)V
+    invoke-virtual {v8, v5}, Landroid/hardware/camera2/CameraManager;->unregisterSemCameraDeviceStateCallback(Landroid/hardware/camera2/CameraManager$SemCameraDeviceStateCallback;)V
 
-    iget-object v9, v6, Lcom/android/server/bgslotmanager/CameraKillModeManager;->mCameraManager:Landroid/hardware/camera2/CameraManager;
+    iget-object v8, v5, Lcom/android/server/bgslotmanager/CameraKillModeManager;->mCameraManager:Landroid/hardware/camera2/CameraManager;
 
-    invoke-virtual {v9, v6, v10}, Landroid/hardware/camera2/CameraManager;->registerSemCameraDeviceStateCallback(Landroid/hardware/camera2/CameraManager$SemCameraDeviceStateCallback;Landroid/os/Handler;)V
+    invoke-virtual {v8, v5, v9}, Landroid/hardware/camera2/CameraManager;->registerSemCameraDeviceStateCallback(Landroid/hardware/camera2/CameraManager$SemCameraDeviceStateCallback;Landroid/os/Handler;)V
 
     :cond_6
-    sput-boolean v3, Lcom/android/server/bgslotmanager/CameraKillModeManager$CameraKillModeManagerLazyHolder;->isinitClass:Z
+    sput-boolean v2, Lcom/android/server/bgslotmanager/CameraKillModeManager$CameraKillModeManagerLazyHolder;->isinitClass:Z
 
     :cond_7
-    iget-object v6, v5, Lcom/android/server/am/DynamicHiddenApp;->mBGProtectManager:Lcom/android/server/am/BGProtectManager;
+    iget-object v5, v4, Lcom/android/server/am/DynamicHiddenApp;->mBGProtectManager:Lcom/android/server/am/BGProtectManager;
 
-    invoke-virtual {v6}, Lcom/android/server/am/BGProtectManager;->initBGProtectManagerPostBoot()V
+    invoke-virtual {v5}, Lcom/android/server/am/BGProtectManager;->initBGProtectManagerPostBoot()V
 
     invoke-virtual {v12}, Lcom/android/server/bgslotmanager/BGSlotManager;->setBonusMaxCachedAppsPerSwap()V
 
-    const/16 v6, 0x12
+    const/16 v5, 0x12
 
-    invoke-static {v6, v3}, Lcom/android/server/am/ProcessList;->setLmkdParameter(II)V
+    invoke-static {v5, v2}, Lcom/android/server/am/ProcessList;->setLmkdParameter(II)V
 
-    new-instance v6, Landroid/content/IntentFilter;
+    new-instance v5, Landroid/content/IntentFilter;
 
-    invoke-direct {v6}, Landroid/content/IntentFilter;-><init>()V
+    invoke-direct {v5}, Landroid/content/IntentFilter;-><init>()V
 
-    const-string/jumbo v9, "com.android.server.am.BROADCAST_DHA_DEBUG_ON"
+    const-string/jumbo v8, "com.android.server.am.BROADCAST_DHA_DEBUG_ON"
 
-    invoke-virtual {v6, v9}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
+    invoke-virtual {v5, v8}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
 
-    const-string/jumbo v9, "com.android.server.am.BROADCAST_SET_DHA_PARAMETER"
+    const-string/jumbo v8, "com.android.server.am.BROADCAST_SET_DHA_PARAMETER"
 
-    const-string/jumbo v10, "com.android.server.am.BROADCAST_SET_LMKD_PARAMETER_INTENT"
+    const-string/jumbo v9, "com.android.server.am.BROADCAST_SET_LMKD_PARAMETER_INTENT"
 
-    const-string/jumbo v11, "android.intent.action.DOCK_EVENT"
+    const-string/jumbo v10, "android.intent.action.DOCK_EVENT"
 
     const-string/jumbo v12, "com.samsung.android.homehub.action.DEFAULT_HOME_CHANGE"
 
-    invoke-static {v6, v9, v10, v11, v12}, Lcom/android/server/am/ActivityManagerService$$ExternalSyntheticOutline0;->m(Landroid/content/IntentFilter;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v9, v5, Lcom/android/server/am/DynamicHiddenApp;->mContext:Landroid/content/Context;
-
-    new-instance v10, Lcom/android/server/am/DynamicHiddenApp$1;
-
-    invoke-direct {v10, v5}, Lcom/android/server/am/DynamicHiddenApp$1;-><init>(Lcom/android/server/am/DynamicHiddenApp;)V
+    invoke-static {v5, v8, v9, v10, v12}, Lcom/android/server/am/ActivityManagerService$$ExternalSyntheticOutline0;->m(Landroid/content/IntentFilter;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
 
-    invoke-virtual {v9, v10, v6, v2}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
+    iget-object v8, v4, Lcom/android/server/am/DynamicHiddenApp;->mContext:Landroid/content/Context;
 
-    const-string v5, "DynamicHiddenApp_BGSlotManager"
+    new-instance v9, Lcom/android/server/am/DynamicHiddenApp$1;
 
-    const-string/jumbo v6, "Message send attempt to delay increasing max empty"
+    invoke-direct {v9, v4}, Lcom/android/server/am/DynamicHiddenApp$1;-><init>(Lcom/android/server/am/DynamicHiddenApp;)V
 
-    invoke-static {v5, v6}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-virtual {v8, v9, v5, v11}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
 
-    sget-object v5, Lcom/android/server/bgslotmanager/BGSlotManager;->BGHandler:Lcom/android/server/bgslotmanager/BGSlotManager$BgSlotManagerHandler;
+    const-string v4, "DynamicHiddenApp_BGSlotManager"
 
-    sget-wide v9, Lcom/android/server/am/DynamicHiddenApp;->mTotalMemMb:J
+    const-string/jumbo v5, "Message send attempt to delay increasing max empty"
 
-    long-to-int v6, v9
+    invoke-static {v4, v5}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {v5, v3, v6, v7}, Landroid/os/Handler;->obtainMessage(III)Landroid/os/Message;
+    sget-object v4, Lcom/android/server/bgslotmanager/BGSlotManager;->BGHandler:Lcom/android/server/bgslotmanager/BGSlotManager$BgSlotManagerHandler;
 
-    move-result-object v6
+    sget-wide v8, Lcom/android/server/am/DynamicHiddenApp;->mTotalMemMb:J
 
-    const-wide/32 v9, 0x927c0
+    long-to-int v5, v8
 
-    invoke-virtual {v5, v6, v9, v10}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z
+    invoke-virtual {v4, v2, v5, v6}, Landroid/os/Handler;->obtainMessage(III)Landroid/os/Message;
 
-    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mSystemServiceManager:Lcom/android/server/SystemServiceManager;
+    move-result-object v5
 
-    const/16 v6, 0x3e8
+    const-wide/32 v8, 0x927c0
 
-    invoke-virtual {v5, v4, v6}, Lcom/android/server/SystemServiceManager;->startBootPhase(Lcom/android/server/utils/TimingsTraceAndSlog;I)V
+    invoke-virtual {v4, v5, v8, v9}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z
 
-    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mActivityTaskManager:Lcom/android/server/wm/ActivityTaskManagerService;
+    iget-object v4, v1, Lcom/android/server/am/ActivityManagerService;->mSystemServiceManager:Lcom/android/server/SystemServiceManager;
 
-    iget-object v6, v5, Lcom/android/server/wm/ActivityTaskManagerService;->mContext:Landroid/content/Context;
+    const/16 v5, 0x3e8
 
-    invoke-static {v6, v5}, Lcom/android/server/wm/ActivityManagerPerformance;->getBooster(Landroid/content/Context;Lcom/android/server/wm/ActivityTaskManagerService;)Lcom/android/server/wm/ActivityManagerPerformance;
+    invoke-virtual {v4, v3, v5}, Lcom/android/server/SystemServiceManager;->startBootPhase(Lcom/android/server/utils/TimingsTraceAndSlog;I)V
 
-    move-result-object v6
+    iget-object v4, v1, Lcom/android/server/am/ActivityManagerService;->mActivityTaskManager:Lcom/android/server/wm/ActivityTaskManagerService;
 
-    iput-object v6, v5, Lcom/android/server/wm/ActivityTaskManagerService;->mAMBooster:Lcom/android/server/wm/ActivityManagerPerformance;
+    iget-object v5, v4, Lcom/android/server/wm/ActivityTaskManagerService;->mContext:Landroid/content/Context;
 
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
+    invoke-static {v5, v4}, Lcom/android/server/wm/ActivityManagerPerformance;->getBooster(Landroid/content/Context;Lcom/android/server/wm/ActivityTaskManagerService;)Lcom/android/server/wm/ActivityManagerPerformance;
 
-    move-result v5
+    move-result-object v5
 
-    if-eqz v5, :cond_d
+    iput-object v5, v4, Lcom/android/server/wm/ActivityTaskManagerService;->mAMBooster:Lcom/android/server/wm/ActivityManagerPerformance;
 
     invoke-static {}, Lcom/android/server/am/ActivityManagerService;->boostPriorityForLockedSection()V
 
     monitor-enter p0
 
     :try_start_4
-    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;
-
-    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I
+    iget-object v4, v1, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;
 
-    move-result v5
+    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I
 
-    if-lez v5, :cond_9
+    move-result v4
 
-    new-instance v6, Ljava/util/ArrayList;
+    if-lez v4, :cond_9
 
-    iget-object v9, v1, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;
+    new-instance v5, Ljava/util/ArrayList;
 
-    invoke-direct {v6, v9}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
+    iget-object v8, v1, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;
 
-    move v9, v7
+    invoke-direct {v5, v8}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
 
-    move v10, v9
+    move v15, v6
 
     :goto_4
-    if-ge v9, v5, :cond_a
+    if-ge v15, v4, :cond_9
 
-    const-string/jumbo v11, "com.samsung.android.knox.containercore"
+    invoke-virtual {v5, v15}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
-    invoke-virtual {v6, v9}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    move-result-object v8
 
-    move-result-object v12
+    check-cast v8, Lcom/android/server/am/ProcessRecord;
 
-    check-cast v12, Lcom/android/server/am/ProcessRecord;
+    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->mWindowProcessController:Lcom/android/server/wm/WindowProcessController;
 
-    iget-object v12, v12, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;
+    invoke-virtual {v8}, Lcom/android/server/wm/ConfigurationContainer;->getConfiguration()Landroid/content/res/Configuration;
 
-    invoke-virtual {v11, v12}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    move-result-object v8
 
-    move-result v11
+    invoke-virtual {v8}, Landroid/content/res/Configuration;->getLocales()Landroid/os/LocaleList;
 
-    if-eqz v11, :cond_8
+    move-result-object v8
 
-    iget-object v10, v1, Lcom/android/server/am/ActivityManagerService;->mProcessList:Lcom/android/server/am/ProcessList;
+    invoke-virtual {v8}, Landroid/os/LocaleList;->isEmpty()Z
 
-    invoke-virtual {v6, v9}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    move-result v8
 
-    move-result-object v11
+    if-eqz v8, :cond_8
 
-    check-cast v11, Lcom/android/server/am/ProcessRecord;
+    const-string v8, "ActivityManager"
 
-    new-instance v12, Lcom/android/server/am/HostingRecord;
+    new-instance v9, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v13, "on-hold"
+    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-direct {v12, v13}, Lcom/android/server/am/HostingRecord;-><init>(Ljava/lang/String;)V
+    const-string/jumbo v10, "Proc "
 
-    invoke-virtual {v10, v11, v12, v2}, Lcom/android/server/am/ProcessList;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HostingRecord;I)V
+    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move v10, v3
+    invoke-virtual {v5, v15}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
-    goto :goto_5
+    move-result-object v10
 
-    :catchall_2
-    move-exception v0
+    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
 
-    goto :goto_7
+    const-string/jumbo v10, "has empty locales now, updating it with newly updated configuration."
 
-    :cond_8
-    :goto_5
-    add-int/2addr v9, v3
+    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    goto :goto_4
+    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    :cond_9
-    move v10, v7
+    move-result-object v9
 
-    :cond_a
-    monitor-exit p0
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_2
+    invoke-static {v8, v9}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
+    invoke-virtual {v5, v15}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
-    if-eqz v10, :cond_d
+    move-result-object v8
 
-    const-class v5, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManagerInternal;
+    check-cast v8, Lcom/android/server/am/ProcessRecord;
 
-    invoke-static {v5}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
+    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->mWindowProcessController:Lcom/android/server/wm/WindowProcessController;
 
-    move-result-object v5
+    iget-object v9, v8, Lcom/android/server/wm/WindowProcessController;->mAtm:Lcom/android/server/wm/ActivityTaskManagerService;
 
-    check-cast v5, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManagerInternal;
+    invoke-virtual {v9}, Lcom/android/server/wm/ActivityTaskManagerService;->getGlobalConfiguration()Landroid/content/res/Configuration;
 
-    if-nez v5, :cond_b
+    move-result-object v9
 
-    goto :goto_6
+    invoke-virtual {v8, v9}, Lcom/android/server/wm/WindowProcessController;->onConfigurationChanged(Landroid/content/res/Configuration;)V
 
-    :cond_b
-    const-string v6, "KNOXCORE_PROXY_AGENT"
+    goto :goto_5
 
-    invoke-virtual {v5, v6}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManagerInternal;->ensureProxyAgentBindingIfRequired(Ljava/lang/String;)V
+    :catchall_2
+    move-exception v0
 
-    iget-object v6, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
+    goto/16 :goto_11
 
-    invoke-static {v6}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
+    :cond_8
+    :goto_5
+    iget-object v8, v1, Lcom/android/server/am/ActivityManagerService;->mProcessList:Lcom/android/server/am/ProcessList;
 
-    move-result-object v6
+    invoke-virtual {v5, v15}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
-    invoke-virtual {v6, v7}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getClientPackage(I)Ljava/lang/String;
+    move-result-object v9
 
-    move-result-object v6
+    check-cast v9, Lcom/android/server/am/ProcessRecord;
 
-    if-eqz v6, :cond_c
+    new-instance v10, Lcom/android/server/am/HostingRecord;
 
-    invoke-virtual {v5, v6}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManagerInternal;->ensureProxyAgentBindingIfRequired(Ljava/lang/String;)V
+    const-string/jumbo v12, "on-hold"
 
-    :cond_c
-    :goto_6
-    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
+    invoke-direct {v10, v12}, Lcom/android/server/am/HostingRecord;-><init>(Ljava/lang/String;)V
 
-    invoke-static {v5}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
+    const/4 v12, 0x0
 
-    move-result-object v5
+    const/4 v13, 0x0
 
-    invoke-virtual {v5}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->ensureDataUnlockedIfRequired()V
+    const/4 v14, 0x0
 
-    goto :goto_8
+    const-wide/16 v6, 0x0
 
-    :goto_7
-    :try_start_5
-    monitor-exit p0
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_2
+    invoke-virtual/range {v8 .. v14}, Lcom/android/server/am/ProcessList;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HostingRecord;IZZLjava/lang/String;)Z
 
-    invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
+    add-int/2addr v15, v2
 
-    throw v0
+    const/4 v6, 0x0
 
-    :cond_d
-    :goto_8
-    invoke-static {}, Lcom/android/server/am/ActivityManagerService;->boostPriorityForLockedSection()V
+    const/4 v7, -0x1
 
-    monitor-enter p0
+    goto :goto_4
 
-    :try_start_6
-    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;
+    :cond_9
+    const-wide/16 v6, 0x0
 
-    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I
+    iget v4, v1, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I
 
-    move-result v5
+    if-ne v4, v2, :cond_a
 
-    if-lez v5, :cond_f
+    monitor-exit p0
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_2
 
-    new-instance v6, Ljava/util/ArrayList;
+    invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
 
-    iget-object v9, v1, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;
+    return-void
 
-    invoke-direct {v6, v9}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
+    :cond_a
+    :try_start_5
+    iget-object v4, v1, Lcom/android/server/am/ActivityManagerService;->mHandler:Lcom/android/server/am/ActivityManagerService$UiHandler;
 
-    move v9, v7
+    const/16 v5, 0x1b
 
-    :goto_9
-    if-ge v9, v5, :cond_f
+    invoke-virtual {v4, v5}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;
 
-    invoke-virtual {v6, v9}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    move-result-object v4
 
-    move-result-object v10
+    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mHandler:Lcom/android/server/am/ActivityManagerService$UiHandler;
 
-    check-cast v10, Lcom/android/server/am/ProcessRecord;
+    iget-object v8, v1, Lcom/android/server/am/ActivityManagerService;->mConstants:Lcom/android/server/am/ActivityManagerConstants;
 
-    iget-object v10, v10, Lcom/android/server/am/ProcessRecord;->mWindowProcessController:Lcom/android/server/wm/WindowProcessController;
+    iget-wide v8, v8, Lcom/android/server/am/ActivityManagerConstants;->POWER_CHECK_INTERVAL:J
 
-    invoke-virtual {v10}, Lcom/android/server/wm/ConfigurationContainer;->getConfiguration()Landroid/content/res/Configuration;
+    invoke-virtual {v5, v4, v8, v9}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z
 
-    move-result-object v10
+    const-string/jumbo v4, "sys.boot_completed"
 
-    invoke-virtual {v10}, Landroid/content/res/Configuration;->getLocales()Landroid/os/LocaleList;
+    const-string v5, "1"
 
-    move-result-object v10
+    invoke-static {v4, v5}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
 
-    invoke-virtual {v10}, Landroid/os/LocaleList;->isEmpty()Z
+    const-string/jumbo v4, "dev.bootcomplete"
 
-    move-result v10
+    const-string v5, "1"
 
-    if-eqz v10, :cond_e
+    invoke-static {v4, v5}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
 
-    const-string v10, "ActivityManager"
+    const/4 v4, 0x4
 
-    new-instance v11, Ljava/lang/StringBuilder;
+    invoke-static {v4}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
 
-    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V
+    move-result-object v5
 
-    const-string/jumbo v12, "Proc "
+    const/16 v8, 0x9
 
-    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v5, v8}, Ljava/nio/ByteBuffer;->putInt(I)Ljava/nio/ByteBuffer;
 
-    invoke-virtual {v6, v9}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    const/4 v8, 0x0
 
-    move-result-object v12
+    invoke-static {v5, v8}, Lcom/android/server/am/ProcessList;->writeLmkd(Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)Z
 
-    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mUserController:Lcom/android/server/am/UserController;
 
-    const-string/jumbo v12, "has empty locales now, updating it with newly updated configuration."
+    new-instance v9, Lcom/android/server/am/ActivityManagerService$10;
 
-    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-direct {v9, v1}, Lcom/android/server/am/ActivityManagerService$10;-><init>(Lcom/android/server/am/ActivityManagerService;)V
 
-    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v5, v9}, Lcom/android/server/am/UserController;->onBootComplete(Lcom/android/server/am/ActivityManagerService$10;)V
 
-    move-result-object v11
+    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mUserController:Lcom/android/server/am/UserController;
 
-    invoke-static {v10, v11}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v6, v9}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    invoke-static {}, Lcom/android/server/FgThread;->getHandler()Landroid/os/Handler;
 
-    move-result-object v10
+    move-result-object v9
 
-    check-cast v10, Lcom/android/server/am/ProcessRecord;
+    new-instance v10, Lcom/android/server/am/UserController$$ExternalSyntheticLambda13;
 
-    iget-object v10, v10, Lcom/android/server/am/ProcessRecord;->mWindowProcessController:Lcom/android/server/wm/WindowProcessController;
+    invoke-direct {v10, v5, v2}, Lcom/android/server/am/UserController$$ExternalSyntheticLambda13;-><init>(Lcom/android/server/am/UserController;I)V
 
-    iget-object v11, v10, Lcom/android/server/wm/WindowProcessController;->mAtm:Lcom/android/server/wm/ActivityTaskManagerService;
+    invoke-virtual {v9, v10}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    invoke-virtual {v11}, Lcom/android/server/wm/ActivityTaskManagerService;->getGlobalConfiguration()Landroid/content/res/Configuration;
+    sget-boolean v5, Lcom/samsung/android/rune/CoreRune;->MNO_TMO_DEVICE_REPORTING:Z
 
-    move-result-object v11
+    if-eqz v5, :cond_b
 
-    invoke-virtual {v10, v11}, Lcom/android/server/wm/WindowProcessController;->onConfigurationChanged(Landroid/content/res/Configuration;)V
+    const-string v5, "ActivityManager"
 
-    goto :goto_a
+    const-string/jumbo v9, "TMO finishBooting"
 
-    :catchall_3
-    move-exception v0
+    invoke-static {v5, v9}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto/16 :goto_16
+    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    :cond_e
-    :goto_a
-    iget-object v10, v1, Lcom/android/server/am/ActivityManagerService;->mProcessList:Lcom/android/server/am/ProcessList;
+    invoke-static {v5}, Lcom/sec/tmodiagnostics/DeviceReportingSecurityChecker;->enable(Landroid/content/Context;)V
 
-    invoke-virtual {v6, v9}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mProcessList:Lcom/android/server/am/ProcessList;
 
-    move-result-object v11
+    iget-object v5, v5, Lcom/android/server/am/ProcessList;->mProcessNames:Lcom/android/server/am/ProcessList$MyProcessMap;
 
-    check-cast v11, Lcom/android/server/am/ProcessRecord;
+    iget-object v9, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    new-instance v12, Lcom/android/server/am/HostingRecord;
+    invoke-static {v9, v5}, Lcom/android/server/am/AppStateBroadcaster;->enableIntentBroadcast(Landroid/content/Context;Lcom/android/internal/app/ProcessMap;)V
 
-    const-string/jumbo v13, "on-hold"
+    :cond_b
+    monitor-exit p0
+    :try_end_5
+    .catchall {:try_start_5 .. :try_end_5} :catchall_2
 
-    invoke-direct {v12, v13}, Lcom/android/server/am/HostingRecord;-><init>(Ljava/lang/String;)V
+    invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
 
-    invoke-virtual {v10, v11, v12, v2}, Lcom/android/server/am/ProcessList;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HostingRecord;I)V
+    const-string/jumbo v5, "init.svc.console"
 
-    add-int/2addr v9, v3
+    invoke-static {v5}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    goto :goto_9
+    move-result-object v5
 
-    :cond_f
-    iget v5, v1, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I
+    const-string/jumbo v9, "running"
 
-    if-ne v5, v3, :cond_10
+    invoke-virtual {v5, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    monitor-exit p0
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_3
+    move-result v5
 
-    invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
+    const v9, 0x106001c
 
-    return-void
+    const v10, 0x1080bef
 
-    :cond_10
-    :try_start_7
-    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mHandler:Lcom/android/server/am/ActivityManagerService$UiHandler;
+    if-nez v5, :cond_c
 
-    const/16 v6, 0x1b
+    goto :goto_6
 
-    invoke-virtual {v5, v6}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;
+    :cond_c
+    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    move-result-object v5
+    const v12, 0x104040a
 
-    iget-object v6, v1, Lcom/android/server/am/ActivityManagerService;->mHandler:Lcom/android/server/am/ActivityManagerService$UiHandler;
+    invoke-virtual {v5, v12}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
-    iget-object v9, v1, Lcom/android/server/am/ActivityManagerService;->mConstants:Lcom/android/server/am/ActivityManagerConstants;
+    move-result-object v5
 
-    iget-wide v9, v9, Lcom/android/server/am/ActivityManagerConstants;->POWER_CHECK_INTERVAL:J
+    iget-object v12, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v6, v5, v9, v10}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z
+    const v13, 0x1040409
 
-    const-string/jumbo v5, "sys.boot_completed"
+    invoke-virtual {v12, v13}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
-    const-string v6, "1"
+    move-result-object v12
 
-    invoke-static {v5, v6}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
+    new-instance v13, Landroid/app/Notification$Builder;
 
-    const-string/jumbo v5, "dev.bootcomplete"
+    iget-object v14, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    const-string v6, "1"
+    const-string v15, "DEVELOPER"
 
-    invoke-static {v5, v6}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-direct {v13, v14, v15}, Landroid/app/Notification$Builder;-><init>(Landroid/content/Context;Ljava/lang/String;)V
 
-    const/4 v5, 0x4
+    invoke-virtual {v13, v10}, Landroid/app/Notification$Builder;->setSmallIcon(I)Landroid/app/Notification$Builder;
 
-    invoke-static {v5}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
+    move-result-object v13
 
-    move-result-object v6
+    invoke-virtual {v13, v6, v7}, Landroid/app/Notification$Builder;->setWhen(J)Landroid/app/Notification$Builder;
 
-    const/16 v9, 0x9
+    move-result-object v13
 
-    invoke-virtual {v6, v9}, Ljava/nio/ByteBuffer;->putInt(I)Ljava/nio/ByteBuffer;
+    invoke-virtual {v13, v2}, Landroid/app/Notification$Builder;->setOngoing(Z)Landroid/app/Notification$Builder;
 
-    const/4 v9, 0x0
+    move-result-object v13
 
-    invoke-static {v6, v9}, Lcom/android/server/am/ProcessList;->writeLmkd(Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)Z
+    invoke-virtual {v13, v5}, Landroid/app/Notification$Builder;->setTicker(Ljava/lang/CharSequence;)Landroid/app/Notification$Builder;
 
-    iget-object v6, v1, Lcom/android/server/am/ActivityManagerService;->mUserController:Lcom/android/server/am/UserController;
+    move-result-object v13
 
-    new-instance v10, Lcom/android/server/am/ActivityManagerService$10;
+    const/4 v14, 0x0
 
-    invoke-direct {v10, v1}, Lcom/android/server/am/ActivityManagerService$10;-><init>(Lcom/android/server/am/ActivityManagerService;)V
+    invoke-virtual {v13, v14}, Landroid/app/Notification$Builder;->setDefaults(I)Landroid/app/Notification$Builder;
 
-    invoke-virtual {v6, v10}, Lcom/android/server/am/UserController;->onBootComplete(Lcom/android/server/am/ActivityManagerService$10;)V
+    move-result-object v13
 
-    iget-object v6, v1, Lcom/android/server/am/ActivityManagerService;->mUserController:Lcom/android/server/am/UserController;
+    iget-object v14, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v6}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v14, v9}, Landroid/content/Context;->getColor(I)I
 
-    invoke-static {}, Lcom/android/server/FgThread;->getHandler()Landroid/os/Handler;
+    move-result v14
 
-    move-result-object v10
+    invoke-virtual {v13, v14}, Landroid/app/Notification$Builder;->setColor(I)Landroid/app/Notification$Builder;
 
-    new-instance v11, Lcom/android/server/am/UserController$$ExternalSyntheticLambda13;
+    move-result-object v13
 
-    invoke-direct {v11, v6, v3}, Lcom/android/server/am/UserController$$ExternalSyntheticLambda13;-><init>(Lcom/android/server/am/UserController;I)V
+    invoke-virtual {v13, v5}, Landroid/app/Notification$Builder;->setContentTitle(Ljava/lang/CharSequence;)Landroid/app/Notification$Builder;
 
-    invoke-virtual {v10, v11}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
-
-    sget-boolean v6, Lcom/samsung/android/rune/CoreRune;->MNO_TMO_DEVICE_REPORTING:Z
-
-    if-eqz v6, :cond_11
-
-    const-string v6, "ActivityManager"
-
-    const-string/jumbo v10, "TMO finishBooting"
-
-    invoke-static {v6, v10}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v6, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v6}, Lcom/sec/tmodiagnostics/DeviceReportingSecurityChecker;->enable(Landroid/content/Context;)V
-
-    iget-object v6, v1, Lcom/android/server/am/ActivityManagerService;->mProcessList:Lcom/android/server/am/ProcessList;
-
-    iget-object v6, v6, Lcom/android/server/am/ProcessList;->mProcessNames:Lcom/android/server/am/ProcessList$MyProcessMap;
-
-    iget-object v10, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v10, v6}, Lcom/android/server/am/AppStateBroadcaster;->enableIntentBroadcast(Landroid/content/Context;Lcom/android/internal/app/ProcessMap;)V
-
-    :cond_11
-    monitor-exit p0
-    :try_end_7
-    .catchall {:try_start_7 .. :try_end_7} :catchall_3
-
-    invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
-
-    const-string/jumbo v6, "init.svc.console"
-
-    invoke-static {v6}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v6
-
-    const-string/jumbo v10, "running"
-
-    invoke-virtual {v6, v10}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v6
-
-    const v10, 0x106001c
-
-    const v11, 0x1080bef
-
-    if-nez v6, :cond_12
-
-    goto :goto_b
-
-    :cond_12
-    iget-object v6, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    const v12, 0x104040a
-
-    invoke-virtual {v6, v12}, Landroid/content/Context;->getString(I)Ljava/lang/String;
-
-    move-result-object v6
-
-    iget-object v12, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    const v13, 0x1040409
-
-    invoke-virtual {v12, v13}, Landroid/content/Context;->getString(I)Ljava/lang/String;
-
-    move-result-object v12
-
-    new-instance v13, Landroid/app/Notification$Builder;
-
-    iget-object v14, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    const-string v15, "DEVELOPER"
-
-    invoke-direct {v13, v14, v15}, Landroid/app/Notification$Builder;-><init>(Landroid/content/Context;Ljava/lang/String;)V
-
-    invoke-virtual {v13, v11}, Landroid/app/Notification$Builder;->setSmallIcon(I)Landroid/app/Notification$Builder;
-
-    move-result-object v13
-
-    const-wide/16 v14, 0x0
-
-    invoke-virtual {v13, v14, v15}, Landroid/app/Notification$Builder;->setWhen(J)Landroid/app/Notification$Builder;
-
-    move-result-object v13
-
-    invoke-virtual {v13, v3}, Landroid/app/Notification$Builder;->setOngoing(Z)Landroid/app/Notification$Builder;
-
-    move-result-object v13
-
-    invoke-virtual {v13, v6}, Landroid/app/Notification$Builder;->setTicker(Ljava/lang/CharSequence;)Landroid/app/Notification$Builder;
-
-    move-result-object v13
-
-    invoke-virtual {v13, v7}, Landroid/app/Notification$Builder;->setDefaults(I)Landroid/app/Notification$Builder;
-
-    move-result-object v13
-
-    iget-object v14, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v14, v10}, Landroid/content/Context;->getColor(I)I
-
-    move-result v14
-
-    invoke-virtual {v13, v14}, Landroid/app/Notification$Builder;->setColor(I)Landroid/app/Notification$Builder;
-
-    move-result-object v13
-
-    invoke-virtual {v13, v6}, Landroid/app/Notification$Builder;->setContentTitle(Ljava/lang/CharSequence;)Landroid/app/Notification$Builder;
-
-    move-result-object v6
+    move-result-object v5
 
-    invoke-virtual {v6, v12}, Landroid/app/Notification$Builder;->setContentText(Ljava/lang/CharSequence;)Landroid/app/Notification$Builder;
+    invoke-virtual {v5, v12}, Landroid/app/Notification$Builder;->setContentText(Ljava/lang/CharSequence;)Landroid/app/Notification$Builder;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-virtual {v6, v3}, Landroid/app/Notification$Builder;->setVisibility(I)Landroid/app/Notification$Builder;
+    invoke-virtual {v5, v2}, Landroid/app/Notification$Builder;->setVisibility(I)Landroid/app/Notification$Builder;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-virtual {v6}, Landroid/app/Notification$Builder;->build()Landroid/app/Notification;
+    invoke-virtual {v5}, Landroid/app/Notification$Builder;->build()Landroid/app/Notification;
 
-    move-result-object v6
+    move-result-object v5
 
     iget-object v12, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
@@ -33802,57 +33670,59 @@
 
     sget-object v14, Landroid/os/UserHandle;->ALL:Landroid/os/UserHandle;
 
-    invoke-virtual {v12, v9, v13, v6, v14}, Landroid/app/NotificationManager;->notifyAsUser(Ljava/lang/String;ILandroid/app/Notification;Landroid/os/UserHandle;)V
+    invoke-virtual {v12, v8, v13, v5, v14}, Landroid/app/NotificationManager;->notifyAsUser(Ljava/lang/String;ILandroid/app/Notification;Landroid/os/UserHandle;)V
 
-    :goto_b
-    const-string/jumbo v6, "arm64.memtag.bootctl"
+    :goto_6
+    const-string/jumbo v5, "arm64.memtag.bootctl"
 
-    invoke-static {v6}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+    invoke-static {v5}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v5
 
     const-string v12, ","
 
-    invoke-virtual {v6, v12}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;
+    invoke-virtual {v5, v12}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-static {v6}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
+    invoke-static {v5}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
 
-    move-result-object v6
+    move-result-object v5
 
     const-string/jumbo v12, "memtag"
 
-    invoke-interface {v6, v12}, Ljava/util/List;->contains(Ljava/lang/Object;)Z
+    invoke-interface {v5, v12}, Ljava/util/List;->contains(Ljava/lang/Object;)Z
 
-    move-result v6
+    move-result v5
 
-    if-nez v6, :cond_14
+    if-nez v5, :cond_e
 
-    const-string/jumbo v6, "ro.arm64.memtag.bootctl_supported"
+    const-string/jumbo v5, "ro.arm64.memtag.bootctl_supported"
 
-    invoke-static {v6, v7}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z
+    const/4 v14, 0x0
 
-    move-result v6
+    invoke-static {v5, v14}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z
 
-    if-eqz v6, :cond_14
+    move-result v5
+
+    if-eqz v5, :cond_e
 
     invoke-static {}, Lcom/android/internal/os/Zygote;->nativeSupportsMemoryTagging()Z
 
-    move-result v6
+    move-result v5
 
-    if-nez v6, :cond_13
+    if-nez v5, :cond_d
 
-    goto :goto_c
+    goto :goto_7
 
-    :cond_13
-    iget-object v6, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
+    :cond_d
+    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
     const v12, 0x1040902
 
-    invoke-virtual {v6, v12}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+    invoke-virtual {v5, v12}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v5
 
     iget-object v12, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
@@ -33870,561 +33740,581 @@
 
     invoke-direct {v13, v14, v15}, Landroid/app/Notification$Builder;-><init>(Landroid/content/Context;Ljava/lang/String;)V
 
-    invoke-virtual {v13, v11}, Landroid/app/Notification$Builder;->setSmallIcon(I)Landroid/app/Notification$Builder;
+    invoke-virtual {v13, v10}, Landroid/app/Notification$Builder;->setSmallIcon(I)Landroid/app/Notification$Builder;
 
-    move-result-object v11
+    move-result-object v10
 
-    invoke-virtual {v11, v3}, Landroid/app/Notification$Builder;->setOngoing(Z)Landroid/app/Notification$Builder;
+    invoke-virtual {v10, v2}, Landroid/app/Notification$Builder;->setOngoing(Z)Landroid/app/Notification$Builder;
 
-    move-result-object v11
+    move-result-object v10
 
-    invoke-virtual {v11, v6}, Landroid/app/Notification$Builder;->setTicker(Ljava/lang/CharSequence;)Landroid/app/Notification$Builder;
+    invoke-virtual {v10, v5}, Landroid/app/Notification$Builder;->setTicker(Ljava/lang/CharSequence;)Landroid/app/Notification$Builder;
 
-    move-result-object v11
+    move-result-object v10
 
-    invoke-virtual {v11, v7}, Landroid/app/Notification$Builder;->setDefaults(I)Landroid/app/Notification$Builder;
+    const/4 v14, 0x0
 
-    move-result-object v11
+    invoke-virtual {v10, v14}, Landroid/app/Notification$Builder;->setDefaults(I)Landroid/app/Notification$Builder;
+
+    move-result-object v10
 
     iget-object v13, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v13, v10}, Landroid/content/Context;->getColor(I)I
+    invoke-virtual {v13, v9}, Landroid/content/Context;->getColor(I)I
 
-    move-result v10
+    move-result v9
 
-    invoke-virtual {v11, v10}, Landroid/app/Notification$Builder;->setColor(I)Landroid/app/Notification$Builder;
+    invoke-virtual {v10, v9}, Landroid/app/Notification$Builder;->setColor(I)Landroid/app/Notification$Builder;
 
-    move-result-object v10
+    move-result-object v9
 
-    invoke-virtual {v10, v6}, Landroid/app/Notification$Builder;->setContentTitle(Ljava/lang/CharSequence;)Landroid/app/Notification$Builder;
+    invoke-virtual {v9, v5}, Landroid/app/Notification$Builder;->setContentTitle(Ljava/lang/CharSequence;)Landroid/app/Notification$Builder;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-virtual {v6, v12}, Landroid/app/Notification$Builder;->setContentText(Ljava/lang/CharSequence;)Landroid/app/Notification$Builder;
+    invoke-virtual {v5, v12}, Landroid/app/Notification$Builder;->setContentText(Ljava/lang/CharSequence;)Landroid/app/Notification$Builder;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-virtual {v6, v3}, Landroid/app/Notification$Builder;->setVisibility(I)Landroid/app/Notification$Builder;
+    invoke-virtual {v5, v2}, Landroid/app/Notification$Builder;->setVisibility(I)Landroid/app/Notification$Builder;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-virtual {v6}, Landroid/app/Notification$Builder;->build()Landroid/app/Notification;
+    invoke-virtual {v5}, Landroid/app/Notification$Builder;->build()Landroid/app/Notification;
 
-    move-result-object v6
+    move-result-object v5
 
-    iget-object v10, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
+    iget-object v9, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    const-class v11, Landroid/app/NotificationManager;
+    const-class v10, Landroid/app/NotificationManager;
 
-    invoke-virtual {v10, v11}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
+    invoke-virtual {v9, v10}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
 
-    move-result-object v10
+    move-result-object v9
 
-    check-cast v10, Landroid/app/NotificationManager;
+    check-cast v9, Landroid/app/NotificationManager;
 
-    const/16 v11, 0x45
+    const/16 v10, 0x45
 
     sget-object v12, Landroid/os/UserHandle;->ALL:Landroid/os/UserHandle;
 
-    invoke-virtual {v10, v9, v11, v6, v12}, Landroid/app/NotificationManager;->notifyAsUser(Ljava/lang/String;ILandroid/app/Notification;Landroid/os/UserHandle;)V
+    invoke-virtual {v9, v8, v10, v5, v12}, Landroid/app/NotificationManager;->notifyAsUser(Ljava/lang/String;ILandroid/app/Notification;Landroid/os/UserHandle;)V
 
-    :cond_14
-    :goto_c
+    :cond_e
+    :goto_7
     invoke-static {}, Landroid/os/Looper;->getMainLooper()Landroid/os/Looper;
 
-    move-result-object v6
+    move-result-object v5
 
-    if-eqz v6, :cond_15
+    if-eqz v5, :cond_f
 
     invoke-static {}, Landroid/os/Looper;->getMainLooper()Landroid/os/Looper;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-virtual {v6}, Landroid/os/Looper;->setPerfLogEnable()V
+    invoke-virtual {v5}, Landroid/os/Looper;->setPerfLogEnable()V
 
-    :cond_15
-    sget-boolean v6, Lcom/android/server/am/MARsPolicyManager;->MARs_ENABLE:Z
+    :cond_f
+    sget-boolean v5, Lcom/android/server/am/MARsPolicyManager;->MARs_ENABLE:Z
 
-    sget-object v6, Lcom/android/server/am/MARsPolicyManager$MARsPolicyManagerHolder;->INSTANCE:Lcom/android/server/am/MARsPolicyManager;
+    sget-object v5, Lcom/android/server/am/MARsPolicyManager$MARsPolicyManagerHolder;->INSTANCE:Lcom/android/server/am/MARsPolicyManager;
 
-    invoke-virtual {v6}, Lcom/android/server/am/MARsPolicyManager;->postInit()V
+    invoke-virtual {v5}, Lcom/android/server/am/MARsPolicyManager;->postInit()V
 
-    sget-boolean v6, Lcom/android/server/am/FreecessController;->IS_MINIMIZE_OLAF_LOCK:Z
+    sget-boolean v5, Lcom/android/server/am/FreecessController;->IS_MINIMIZE_OLAF_LOCK:Z
 
-    sget-object v6, Lcom/android/server/am/FreecessController$FreecessControllerHolder;->INSTANCE:Lcom/android/server/am/FreecessController;
+    sget-object v5, Lcom/android/server/am/FreecessController$FreecessControllerHolder;->INSTANCE:Lcom/android/server/am/FreecessController;
 
-    iget-object v10, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
+    iget-object v9, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    iput-object v10, v6, Lcom/android/server/am/FreecessController;->mContext:Landroid/content/Context;
+    iput-object v9, v5, Lcom/android/server/am/FreecessController;->mContext:Landroid/content/Context;
 
-    iput-object v1, v6, Lcom/android/server/am/FreecessController;->mAm:Lcom/android/server/am/ActivityManagerService;
+    iput-object v1, v5, Lcom/android/server/am/FreecessController;->mAm:Lcom/android/server/am/ActivityManagerService;
 
-    invoke-virtual {v6, v7}, Lcom/android/server/am/FreecessController;->setScreenOnFreecessEnabled(Z)V
+    const/4 v14, 0x0
 
-    iput-boolean v7, v6, Lcom/android/server/am/FreecessController;->FREECESS_ENHANCEMENT:Z
+    invoke-virtual {v5, v14}, Lcom/android/server/am/FreecessController;->setScreenOnFreecessEnabled(Z)V
 
-    iput-boolean v7, v6, Lcom/android/server/am/FreecessController;->mIsOLAFEnabled:Z
+    iput-boolean v14, v5, Lcom/android/server/am/FreecessController;->FREECESS_ENHANCEMENT:Z
 
-    iput-boolean v7, v6, Lcom/android/server/am/FreecessController;->mIsFreecessEnable:Z
+    iput-boolean v14, v5, Lcom/android/server/am/FreecessController;->mIsOLAFEnabled:Z
 
-    iget v11, v6, Lcom/android/server/am/FreecessController;->mConfigFreecess:I
+    iput-boolean v14, v5, Lcom/android/server/am/FreecessController;->mIsFreecessEnable:Z
 
-    if-ne v11, v5, :cond_16
+    iget v10, v5, Lcom/android/server/am/FreecessController;->mConfigFreecess:I
 
-    sget-object v5, Lcom/android/server/am/FreecessHandler$FreecessHandlerHolder;->INSTANCE:Lcom/android/server/am/FreecessHandler;
+    if-ne v10, v4, :cond_10
 
-    new-instance v11, Lcom/android/server/am/FreecessHandler$NetLinkReceiverThread;
+    sget-object v4, Lcom/android/server/am/FreecessHandler$FreecessHandlerHolder;->INSTANCE:Lcom/android/server/am/FreecessHandler;
+
+    new-instance v10, Lcom/android/server/am/FreecessHandler$NetLinkReceiverThread;
 
     const-string v12, "Freecess_NLRCT"
 
-    invoke-direct {v11, v12}, Ljava/lang/Thread;-><init>(Ljava/lang/String;)V
+    invoke-direct {v10, v12}, Ljava/lang/Thread;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v11}, Ljava/lang/Thread;->start()V
+    invoke-virtual {v10}, Ljava/lang/Thread;->start()V
 
-    new-instance v11, Lcom/android/server/am/FreecessHandler$FreecessThread;
+    new-instance v10, Lcom/android/server/am/FreecessHandler$FreecessThread;
 
     const-string v12, "Freecess_BT"
 
-    invoke-direct {v11, v12, v7, v3}, Lcom/android/server/am/FreecessHandler$FreecessThread;-><init>(Ljava/lang/String;II)V
+    const/4 v14, 0x0
+
+    invoke-direct {v10, v12, v14, v2}, Lcom/android/server/am/FreecessHandler$FreecessThread;-><init>(Ljava/lang/String;II)V
 
-    invoke-virtual {v11}, Landroid/os/HandlerThread;->start()V
+    invoke-virtual {v10}, Landroid/os/HandlerThread;->start()V
 
     invoke-static {}, Landroid/bluetooth/BluetoothAdapter;->getDefaultAdapter()Landroid/bluetooth/BluetoothAdapter;
 
-    move-result-object v11
+    move-result-object v10
 
-    iput-object v11, v5, Lcom/android/server/am/FreecessHandler;->mBluetoothAdapter:Landroid/bluetooth/BluetoothAdapter;
+    iput-object v10, v4, Lcom/android/server/am/FreecessHandler;->mBluetoothAdapter:Landroid/bluetooth/BluetoothAdapter;
 
-    new-instance v5, Lcom/android/server/am/FreecessHandler$FreecessThread;
+    new-instance v4, Lcom/android/server/am/FreecessHandler$FreecessThread;
 
-    const-string v11, "Freecess_HAMSL"
+    const-string v10, "Freecess_HAMSL"
 
-    invoke-direct {v5, v11, v7, v2}, Lcom/android/server/am/FreecessHandler$FreecessThread;-><init>(Ljava/lang/String;II)V
+    const/4 v12, 0x2
 
-    invoke-virtual {v5}, Landroid/os/HandlerThread;->start()V
+    invoke-direct {v4, v10, v14, v12}, Lcom/android/server/am/FreecessHandler$FreecessThread;-><init>(Ljava/lang/String;II)V
 
-    :cond_16
-    const-string/jumbo v5, "camera"
+    invoke-virtual {v4}, Landroid/os/HandlerThread;->start()V
 
-    invoke-virtual {v10, v5}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
+    :cond_10
+    const-string/jumbo v4, "camera"
 
-    move-result-object v5
+    invoke-virtual {v9, v4}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
 
-    check-cast v5, Landroid/hardware/camera2/CameraManager;
+    move-result-object v4
 
-    if-eqz v5, :cond_17
+    check-cast v4, Landroid/hardware/camera2/CameraManager;
 
-    iget-object v6, v6, Lcom/android/server/am/FreecessController;->mCameraDeviceStateCallback:Lcom/android/server/am/FreecessController$1;
+    if-eqz v4, :cond_11
 
-    sget-object v10, Lcom/android/server/am/FreecessHandler$FreecessHandlerHolder;->INSTANCE:Lcom/android/server/am/FreecessHandler;
+    iget-object v5, v5, Lcom/android/server/am/FreecessController;->mCameraDeviceStateCallback:Lcom/android/server/am/FreecessController$1;
 
-    iget-object v10, v10, Lcom/android/server/am/FreecessHandler;->mMainHandler:Lcom/android/server/am/FreecessHandler$MainHandler;
+    sget-object v9, Lcom/android/server/am/FreecessHandler$FreecessHandlerHolder;->INSTANCE:Lcom/android/server/am/FreecessHandler;
 
-    invoke-virtual {v5, v6, v10}, Landroid/hardware/camera2/CameraManager;->registerSemCameraDeviceStateCallback(Landroid/hardware/camera2/CameraManager$SemCameraDeviceStateCallback;Landroid/os/Handler;)V
+    iget-object v9, v9, Lcom/android/server/am/FreecessHandler;->mMainHandler:Lcom/android/server/am/FreecessHandler$MainHandler;
 
-    :cond_17
-    invoke-static {}, Lcom/android/server/chimera/ppn/PerProcessNandswap;->getInstance()Lcom/android/server/chimera/ppn/PerProcessNandswap;
+    invoke-virtual {v4, v5, v9}, Landroid/hardware/camera2/CameraManager;->registerSemCameraDeviceStateCallback(Landroid/hardware/camera2/CameraManager$SemCameraDeviceStateCallback;Landroid/os/Handler;)V
 
-    move-result-object v5
+    :cond_11
+    invoke-static {}, Lcom/android/server/chimera/ppn/PerProcessNandswap;->getInstance()Lcom/android/server/chimera/ppn/PerProcessNandswap;
 
-    monitor-enter v5
+    move-result-object v4
 
-    :try_start_8
-    iget-wide v10, v5, Lcom/android/server/chimera/ppn/PerProcessNandswap;->mBootCompleteUptimeMillis:J
+    monitor-enter v4
 
-    const-wide/16 v15, 0x0
+    :try_start_6
+    iget-wide v9, v4, Lcom/android/server/chimera/ppn/PerProcessNandswap;->mBootCompleteUptimeMillis:J
 
-    cmp-long v6, v10, v15
+    cmp-long v5, v9, v6
 
-    if-gtz v6, :cond_18
+    if-gtz v5, :cond_12
 
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
 
-    move-result-wide v10
+    move-result-wide v5
 
-    iput-wide v10, v5, Lcom/android/server/chimera/ppn/PerProcessNandswap;->mBootCompleteUptimeMillis:J
-    :try_end_8
-    .catchall {:try_start_8 .. :try_end_8} :catchall_4
+    iput-wide v5, v4, Lcom/android/server/chimera/ppn/PerProcessNandswap;->mBootCompleteUptimeMillis:J
+    :try_end_6
+    .catchall {:try_start_6 .. :try_end_6} :catchall_3
 
-    goto :goto_d
+    goto :goto_8
 
-    :catchall_4
+    :catchall_3
     move-exception v0
 
-    goto/16 :goto_15
+    goto/16 :goto_10
 
-    :cond_18
-    :goto_d
-    monitor-exit v5
+    :cond_12
+    :goto_8
+    monitor-exit v4
 
-    sget-object v5, Lcom/android/server/am/PDSController;->PDSLock:Lcom/android/server/am/PDSController$Lock;
+    sget-object v4, Lcom/android/server/am/PDSController;->PDSLock:Lcom/android/server/am/PDSController$Lock;
 
-    sget-object v5, Lcom/android/server/am/PDSController$PDSControllerHolder;->INSTANCE:Lcom/android/server/am/PDSController;
+    sget-object v4, Lcom/android/server/am/PDSController$PDSControllerHolder;->INSTANCE:Lcom/android/server/am/PDSController;
 
-    iget-object v6, v5, Lcom/android/server/am/PDSController;->mContext:Landroid/content/Context;
+    iget-object v5, v4, Lcom/android/server/am/PDSController;->mContext:Landroid/content/Context;
 
-    const-string/jumbo v10, "com.samsung.android.uds"
+    const-string/jumbo v6, "com.samsung.android.uds"
 
-    invoke-virtual {v6}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+    invoke-virtual {v5}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
 
-    move-result-object v6
+    move-result-object v5
 
-    const/16 v11, 0x80
+    const/16 v7, 0x80
 
-    :try_start_9
-    invoke-virtual {v6, v10, v11}, Landroid/content/pm/PackageManager;->getPackageInfo(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;
-    :try_end_9
-    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_9 .. :try_end_9} :catch_1
+    :try_start_7
+    invoke-virtual {v5, v6, v7}, Landroid/content/pm/PackageManager;->getPackageInfo(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;
+    :try_end_7
+    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_7 .. :try_end_7} :catch_1
 
-    move v6, v3
+    move v5, v2
 
-    goto :goto_e
+    goto :goto_9
 
     :catch_1
-    move v6, v7
+    const/4 v5, 0x0
 
-    :goto_e
-    new-instance v10, Lcom/android/server/am/PDSController$Policy;
+    :goto_9
+    new-instance v6, Lcom/android/server/am/PDSController$Policy;
 
-    const-string/jumbo v11, "udspolicy"
+    const-string/jumbo v7, "udspolicy"
 
-    invoke-direct {v10, v0, v11, v6}, Lcom/android/server/am/PDSController$Policy;-><init>(ILjava/lang/String;Z)V
+    invoke-direct {v6, v0, v7, v5}, Lcom/android/server/am/PDSController$Policy;-><init>(ILjava/lang/String;Z)V
 
-    iput-object v10, v5, Lcom/android/server/am/PDSController;->udsPolicy:Lcom/android/server/am/PDSController$Policy;
+    iput-object v6, v4, Lcom/android/server/am/PDSController;->udsPolicy:Lcom/android/server/am/PDSController$Policy;
 
-    new-instance v6, Lcom/android/server/am/PDSController$Policy;
+    new-instance v5, Lcom/android/server/am/PDSController$Policy;
 
-    const-string/jumbo v10, "mpsmpolicy"
+    const-string/jumbo v6, "mpsmpolicy"
 
-    const/16 v11, 0xa
+    const/16 v7, 0xa
 
-    invoke-direct {v6, v11, v10, v3}, Lcom/android/server/am/PDSController$Policy;-><init>(ILjava/lang/String;Z)V
+    invoke-direct {v5, v7, v6, v2}, Lcom/android/server/am/PDSController$Policy;-><init>(ILjava/lang/String;Z)V
 
-    iput-object v6, v5, Lcom/android/server/am/PDSController;->mpsmPolicy:Lcom/android/server/am/PDSController$Policy;
+    iput-object v5, v4, Lcom/android/server/am/PDSController;->mpsmPolicy:Lcom/android/server/am/PDSController$Policy;
 
-    iput-boolean v3, v5, Lcom/android/server/am/PDSController;->mIsPDSEnable:Z
+    iput-boolean v2, v4, Lcom/android/server/am/PDSController;->mIsPDSEnable:Z
 
-    sget-object v6, Lcom/android/server/am/pds/PDSTrigger$PDSTriggerHolder;->INSTANCE:Lcom/android/server/am/pds/PDSTrigger;
+    sget-object v5, Lcom/android/server/am/pds/PDSTrigger$PDSTriggerHolder;->INSTANCE:Lcom/android/server/am/pds/PDSTrigger;
 
-    invoke-virtual {v6}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v10, "registerUDSReceiver"
+    const-string/jumbo v6, "registerUDSReceiver"
 
-    const-string/jumbo v11, "PDSTrigger"
+    const-string/jumbo v7, "PDSTrigger"
 
-    invoke-static {v11, v10}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v7, v6}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    new-instance v10, Landroid/content/IntentFilter;
+    new-instance v6, Landroid/content/IntentFilter;
 
-    invoke-direct {v10}, Landroid/content/IntentFilter;-><init>()V
+    invoke-direct {v6}, Landroid/content/IntentFilter;-><init>()V
 
-    const-string/jumbo v12, "com.android.server.am.MARS_TRIGGER_UDS_POLICY"
+    const-string/jumbo v9, "com.android.server.am.MARS_TRIGGER_UDS_POLICY"
 
-    invoke-virtual {v10, v12}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
+    invoke-virtual {v6, v9}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
 
-    const-string/jumbo v12, "com.android.server.am.MARS_CANCEL_UDS_POLICY"
+    const-string/jumbo v9, "com.android.server.am.MARS_CANCEL_UDS_POLICY"
 
-    invoke-virtual {v10, v12}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
+    invoke-virtual {v6, v9}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
 
-    iget-object v12, v6, Lcom/android/server/am/pds/PDSTrigger;->mContext:Landroid/content/Context;
+    iget-object v9, v5, Lcom/android/server/am/pds/PDSTrigger;->mContext:Landroid/content/Context;
 
-    iget-object v13, v6, Lcom/android/server/am/pds/PDSTrigger;->mPolicyUDSIntentReceiver:Lcom/android/server/am/pds/PDSTrigger$1;
+    iget-object v10, v5, Lcom/android/server/am/pds/PDSTrigger;->mPolicyUDSIntentReceiver:Lcom/android/server/am/pds/PDSTrigger$1;
 
-    invoke-virtual {v12, v13, v10, v2}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
+    invoke-virtual {v9, v10, v6, v11}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
 
-    iget-object v10, v5, Lcom/android/server/am/PDSController;->mpsmPolicy:Lcom/android/server/am/PDSController$Policy;
+    iget-object v6, v4, Lcom/android/server/am/PDSController;->mpsmPolicy:Lcom/android/server/am/PDSController$Policy;
 
-    if-eqz v10, :cond_19
+    if-eqz v6, :cond_13
 
-    iget-boolean v10, v10, Lcom/android/server/am/PDSController$Policy;->enabled:Z
+    iget-boolean v6, v6, Lcom/android/server/am/PDSController$Policy;->enabled:Z
 
-    if-eqz v10, :cond_19
+    if-eqz v6, :cond_13
 
-    const-string/jumbo v10, "registerMPSMReceiver"
+    const-string/jumbo v6, "registerMPSMReceiver"
 
-    invoke-static {v11, v10}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v7, v6}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    new-instance v10, Landroid/content/IntentFilter;
+    new-instance v6, Landroid/content/IntentFilter;
 
-    invoke-direct {v10}, Landroid/content/IntentFilter;-><init>()V
+    invoke-direct {v6}, Landroid/content/IntentFilter;-><init>()V
 
-    const-string/jumbo v11, "com.android.server.am.MARS_TRIGGER_MPSM_POLICY"
+    const-string/jumbo v7, "com.android.server.am.MARS_TRIGGER_MPSM_POLICY"
 
-    invoke-virtual {v10, v11}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
+    invoke-virtual {v6, v7}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
 
-    const-string/jumbo v11, "com.android.server.am.MARS_CANCEL_MPSM_POLICY"
+    const-string/jumbo v7, "com.android.server.am.MARS_CANCEL_MPSM_POLICY"
 
-    invoke-virtual {v10, v11}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
+    invoke-virtual {v6, v7}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
 
-    iget-object v11, v6, Lcom/android/server/am/pds/PDSTrigger;->mContext:Landroid/content/Context;
+    iget-object v7, v5, Lcom/android/server/am/pds/PDSTrigger;->mContext:Landroid/content/Context;
 
-    iget-object v12, v6, Lcom/android/server/am/pds/PDSTrigger;->mPolicyMPSMIntentReceiver:Lcom/android/server/am/pds/PDSTrigger$1;
+    iget-object v9, v5, Lcom/android/server/am/pds/PDSTrigger;->mPolicyMPSMIntentReceiver:Lcom/android/server/am/pds/PDSTrigger$1;
 
-    invoke-virtual {v11, v12, v10, v2}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
+    invoke-virtual {v7, v9, v6, v11}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
 
-    :cond_19
-    sget-boolean v10, Lcom/android/server/am/PDSController;->DEBUG_ENG:Z
+    :cond_13
+    sget-boolean v6, Lcom/android/server/am/PDSController;->DEBUG_ENG:Z
 
-    if-eqz v10, :cond_1a
+    if-eqz v6, :cond_14
 
-    iget-object v10, v5, Lcom/android/server/am/PDSController;->udsPolicy:Lcom/android/server/am/PDSController$Policy;
+    iget-object v6, v4, Lcom/android/server/am/PDSController;->udsPolicy:Lcom/android/server/am/PDSController$Policy;
 
-    if-eqz v10, :cond_1a
+    if-eqz v6, :cond_14
 
-    iget-object v10, v5, Lcom/android/server/am/PDSController;->mpsmPolicy:Lcom/android/server/am/PDSController$Policy;
+    iget-object v6, v4, Lcom/android/server/am/PDSController;->mpsmPolicy:Lcom/android/server/am/PDSController$Policy;
 
-    if-eqz v10, :cond_1a
+    if-eqz v6, :cond_14
 
-    new-instance v10, Ljava/lang/StringBuilder;
+    new-instance v6, Ljava/lang/StringBuilder;
 
-    const-string v11, ", UD = "
+    const-string v7, ", UD = "
 
-    invoke-direct {v10, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget-object v11, v5, Lcom/android/server/am/PDSController;->udsPolicy:Lcom/android/server/am/PDSController$Policy;
+    iget-object v7, v4, Lcom/android/server/am/PDSController;->udsPolicy:Lcom/android/server/am/PDSController$Policy;
 
-    iget-boolean v11, v11, Lcom/android/server/am/PDSController$Policy;->enabled:Z
+    iget-boolean v7, v7, Lcom/android/server/am/PDSController$Policy;->enabled:Z
 
-    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    const-string v11, ", MP = "
+    const-string v7, ", MP = "
 
-    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-object v11, v5, Lcom/android/server/am/PDSController;->mpsmPolicy:Lcom/android/server/am/PDSController$Policy;
+    iget-object v7, v4, Lcom/android/server/am/PDSController;->mpsmPolicy:Lcom/android/server/am/PDSController$Policy;
 
-    iget-boolean v11, v11, Lcom/android/server/am/PDSController$Policy;->enabled:Z
+    iget-boolean v7, v7, Lcom/android/server/am/PDSController$Policy;->enabled:Z
 
-    const-string/jumbo v12, "PDSController"
+    const-string/jumbo v9, "PDSController"
 
-    invoke-static {v12, v10, v11}, Lcom/android/server/accessibility/ProxyManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/StringBuilder;Z)V
+    invoke-static {v9, v6, v7}, Lcom/android/server/accessibility/ProxyManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/StringBuilder;Z)V
 
-    :cond_1a
-    sget-boolean v10, Lcom/android/server/am/PDSController;->DEBUG_MID:Z
+    :cond_14
+    sget-boolean v6, Lcom/android/server/am/PDSController;->DEBUG_MID:Z
 
-    if-nez v10, :cond_1b
+    if-nez v6, :cond_15
 
-    sget-boolean v10, Lcom/android/server/am/PDSController;->DEBUG_HIGH:Z
+    sget-boolean v6, Lcom/android/server/am/PDSController;->DEBUG_HIGH:Z
 
-    if-nez v10, :cond_1b
+    if-nez v6, :cond_15
 
-    new-instance v10, Lcom/android/server/am/mars/HistoryBuffer;
+    new-instance v6, Lcom/android/server/am/mars/HistoryBuffer;
 
-    invoke-direct {v10}, Lcom/android/server/am/mars/HistoryBuffer;-><init>()V
+    invoke-direct {v6}, Lcom/android/server/am/mars/HistoryBuffer;-><init>()V
 
-    iput-object v10, v5, Lcom/android/server/am/PDSController;->mHistoryBufferArray:Lcom/android/server/am/mars/HistoryBuffer;
+    iput-object v6, v4, Lcom/android/server/am/PDSController;->mHistoryBufferArray:Lcom/android/server/am/mars/HistoryBuffer;
 
-    :cond_1b
-    iget-boolean v5, v6, Lcom/android/server/am/pds/PDSTrigger;->mReceiverRegistered:Z
+    :cond_15
+    iget-boolean v4, v5, Lcom/android/server/am/pds/PDSTrigger;->mReceiverRegistered:Z
 
-    if-eqz v5, :cond_1c
+    if-eqz v4, :cond_16
 
-    goto :goto_f
+    goto :goto_a
 
-    :cond_1c
-    iget-object v5, v6, Lcom/android/server/am/pds/PDSTrigger;->mAlarm:Landroid/app/AlarmManager;
+    :cond_16
+    iget-object v4, v5, Lcom/android/server/am/pds/PDSTrigger;->mAlarm:Landroid/app/AlarmManager;
 
-    if-nez v5, :cond_1d
+    if-nez v4, :cond_17
 
-    iget-object v5, v6, Lcom/android/server/am/pds/PDSTrigger;->mContext:Landroid/content/Context;
+    iget-object v4, v5, Lcom/android/server/am/pds/PDSTrigger;->mContext:Landroid/content/Context;
 
-    const-string/jumbo v10, "alarm"
+    const-string/jumbo v6, "alarm"
 
-    invoke-virtual {v5, v10}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
+    invoke-virtual {v4, v6}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v4
 
-    check-cast v5, Landroid/app/AlarmManager;
+    check-cast v4, Landroid/app/AlarmManager;
 
-    iput-object v5, v6, Lcom/android/server/am/pds/PDSTrigger;->mAlarm:Landroid/app/AlarmManager;
+    iput-object v4, v5, Lcom/android/server/am/pds/PDSTrigger;->mAlarm:Landroid/app/AlarmManager;
 
-    :cond_1d
-    const-string/jumbo v5, "android.intent.action.SCREEN_ON"
+    :cond_17
+    const-string/jumbo v4, "android.intent.action.SCREEN_ON"
 
-    const-string/jumbo v10, "android.intent.action.SCREEN_OFF"
+    const-string/jumbo v6, "android.intent.action.SCREEN_OFF"
 
-    invoke-static {v5, v10}, Lcom/android/server/DirEncryptServiceHelper$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
+    invoke-static {v4, v6}, Lcom/android/server/DirEncryptServiceHelper$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
 
-    move-result-object v5
+    move-result-object v4
 
-    iget-object v10, v6, Lcom/android/server/am/pds/PDSTrigger;->mContext:Landroid/content/Context;
+    iget-object v6, v5, Lcom/android/server/am/pds/PDSTrigger;->mContext:Landroid/content/Context;
 
-    iget-object v11, v6, Lcom/android/server/am/pds/PDSTrigger;->mIntentReceiver:Lcom/android/server/am/pds/PDSTrigger$1;
+    iget-object v7, v5, Lcom/android/server/am/pds/PDSTrigger;->mIntentReceiver:Lcom/android/server/am/pds/PDSTrigger$1;
 
-    invoke-virtual {v10, v11, v5}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
+    invoke-virtual {v6, v7, v4}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
 
-    new-instance v5, Landroid/content/IntentFilter;
+    new-instance v4, Landroid/content/IntentFilter;
 
-    invoke-direct {v5}, Landroid/content/IntentFilter;-><init>()V
+    invoke-direct {v4}, Landroid/content/IntentFilter;-><init>()V
 
-    const-string v10, "FIRST_ALARM_TRIGGER_ACTION"
+    const-string v6, "FIRST_ALARM_TRIGGER_ACTION"
 
-    invoke-virtual {v5, v10}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
+    invoke-virtual {v4, v6}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
 
-    iget-object v10, v6, Lcom/android/server/am/pds/PDSTrigger;->mContext:Landroid/content/Context;
+    iget-object v6, v5, Lcom/android/server/am/pds/PDSTrigger;->mContext:Landroid/content/Context;
 
-    iget-object v11, v6, Lcom/android/server/am/pds/PDSTrigger;->mPolicyIntentReceiver:Lcom/android/server/am/pds/PDSTrigger$1;
+    iget-object v7, v5, Lcom/android/server/am/pds/PDSTrigger;->mPolicyIntentReceiver:Lcom/android/server/am/pds/PDSTrigger$1;
 
-    invoke-virtual {v10, v11, v5}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
+    invoke-virtual {v6, v7, v4}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
 
-    new-instance v14, Landroid/content/IntentFilter;
+    new-instance v4, Landroid/content/IntentFilter;
 
-    invoke-direct {v14}, Landroid/content/IntentFilter;-><init>()V
+    invoke-direct {v4}, Landroid/content/IntentFilter;-><init>()V
 
-    const-string/jumbo v5, "com.samsung.android.server.am.ACTION_UI_TRIGGER_POLICY"
+    const-string/jumbo v6, "com.samsung.android.server.am.ACTION_UI_TRIGGER_POLICY"
 
-    invoke-virtual {v14, v5}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
+    invoke-virtual {v4, v6}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
 
-    iget-object v12, v6, Lcom/android/server/am/pds/PDSTrigger;->mContext:Landroid/content/Context;
+    iget-object v6, v5, Lcom/android/server/am/pds/PDSTrigger;->mContext:Landroid/content/Context;
 
-    iget-object v13, v6, Lcom/android/server/am/pds/PDSTrigger;->mPolicyIntentReceiver:Lcom/android/server/am/pds/PDSTrigger$1;
+    iget-object v7, v5, Lcom/android/server/am/pds/PDSTrigger;->mPolicyIntentReceiver:Lcom/android/server/am/pds/PDSTrigger$1;
 
-    const-string/jumbo v15, "android.permission.WRITE_SECURE_SETTINGS"
+    const-string/jumbo v23, "android.permission.WRITE_SECURE_SETTINGS"
 
-    const/16 v16, 0x0
+    const/16 v24, 0x0
 
-    const/16 v17, 0x2
+    const/16 v25, 0x2
 
-    invoke-virtual/range {v12 .. v17}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;Ljava/lang/String;Landroid/os/Handler;I)Landroid/content/Intent;
+    move-object/from16 v22, v4
 
-    iput-boolean v3, v6, Lcom/android/server/am/pds/PDSTrigger;->mReceiverRegistered:Z
+    move-object/from16 v20, v6
 
-    :goto_f
-    const-string v5, "ActivityManager"
+    move-object/from16 v21, v7
 
-    const-string v6, "!@Boot: bootcomplete"
+    invoke-virtual/range {v20 .. v25}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;Ljava/lang/String;Landroid/os/Handler;I)Landroid/content/Intent;
 
-    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+    iput-boolean v2, v5, Lcom/android/server/am/pds/PDSTrigger;->mReceiverRegistered:Z
 
-    const-string v5, "ActivityManager"
+    :goto_a
+    const-string v4, "ActivityManager"
 
-    const-string v6, "!@Boot_EBS_F: bootcomplete"
+    const-string v5, "!@Boot: bootcomplete"
 
-    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    new-instance v5, Lcom/android/server/am/ActivityManagerService$11;
+    const-string v4, "ActivityManager"
 
-    invoke-direct {v5, v1}, Lcom/android/server/am/ActivityManagerService$11;-><init>(Lcom/android/server/am/ActivityManagerService;)V
+    const-string v5, "!@Boot_EBS_F: bootcomplete"
 
-    invoke-virtual {v5}, Landroid/os/CountDownTimer;->start()Landroid/os/CountDownTimer;
+    invoke-static {v4, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mDynamicHiddenApp:Lcom/android/server/am/DynamicHiddenApp;
+    new-instance v4, Lcom/android/server/am/ActivityManagerService$11;
 
-    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-direct {v4, v1}, Lcom/android/server/am/ActivityManagerService$11;-><init>(Lcom/android/server/am/ActivityManagerService;)V
 
-    sget-boolean v6, Lcom/android/server/bgslotmanager/CustomEFKManager;->BOOTING_EFK_BOOST_ENABLE:Z
+    invoke-virtual {v4}, Landroid/os/CountDownTimer;->start()Landroid/os/CountDownTimer;
 
-    iget-object v10, v5, Lcom/android/server/am/DynamicHiddenApp;->mCustomEFKManager:Lcom/android/server/bgslotmanager/CustomEFKManager;
+    iget-object v4, v1, Lcom/android/server/am/ActivityManagerService;->mDynamicHiddenApp:Lcom/android/server/am/DynamicHiddenApp;
 
-    if-nez v6, :cond_1e
+    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v10}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    sget-boolean v5, Lcom/android/server/bgslotmanager/CustomEFKManager;->BOOTING_EFK_BOOST_ENABLE:Z
 
-    goto :goto_10
+    iget-object v6, v4, Lcom/android/server/am/DynamicHiddenApp;->mCustomEFKManager:Lcom/android/server/bgslotmanager/CustomEFKManager;
 
-    :cond_1e
-    iget v6, v10, Lcom/android/server/bgslotmanager/CustomEFKManager;->origin_EFK:I
+    if-nez v5, :cond_18
 
-    if-eq v6, v8, :cond_1f
+    invoke-virtual {v6}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    iget v11, v10, Lcom/android/server/bgslotmanager/CustomEFKManager;->v_bonusEFKWhileBoot:I
+    goto :goto_b
 
-    add-int/2addr v6, v11
+    :cond_18
+    iget v5, v6, Lcom/android/server/bgslotmanager/CustomEFKManager;->origin_EFK:I
 
-    invoke-static {v6}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
+    const/4 v7, -0x1
 
-    move-result-object v6
+    if-eq v5, v7, :cond_19
 
-    sget v11, Lcom/android/server/bgslotmanager/BgAppPropManager;->TOTAL_MEMORY_2ND:I
+    iget v7, v6, Lcom/android/server/bgslotmanager/CustomEFKManager;->v_bonusEFKWhileBoot:I
 
-    const-string/jumbo v11, "sys.sysctl.extra_free_kbytes"
+    add-int/2addr v5, v7
 
-    invoke-static {v11, v6}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v5}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
 
-    :cond_1f
-    new-instance v6, Lcom/android/server/bgslotmanager/CustomEFKManager$1;
+    move-result-object v5
 
-    invoke-direct {v6, v10}, Lcom/android/server/bgslotmanager/CustomEFKManager$1;-><init>(Lcom/android/server/bgslotmanager/CustomEFKManager;)V
+    sget v7, Lcom/android/server/bgslotmanager/BgAppPropManager;->TOTAL_MEMORY_2ND:I
 
-    invoke-virtual {v6}, Landroid/os/CountDownTimer;->start()Landroid/os/CountDownTimer;
+    const-string/jumbo v7, "sys.sysctl.extra_free_kbytes"
 
-    :goto_10
-    iget-object v5, v5, Lcom/android/server/am/DynamicHiddenApp;->mBGSlotManager:Lcom/android/server/bgslotmanager/BGSlotManager;
+    invoke-static {v7, v5}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
 
-    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    :cond_19
+    new-instance v5, Lcom/android/server/bgslotmanager/CustomEFKManager$1;
 
-    new-instance v6, Lcom/android/server/bgslotmanager/BGSlotManager$1;
+    invoke-direct {v5, v6}, Lcom/android/server/bgslotmanager/CustomEFKManager$1;-><init>(Lcom/android/server/bgslotmanager/CustomEFKManager;)V
 
-    invoke-direct {v6, v5}, Lcom/android/server/bgslotmanager/BGSlotManager$1;-><init>(Lcom/android/server/bgslotmanager/BGSlotManager;)V
+    invoke-virtual {v5}, Landroid/os/CountDownTimer;->start()Landroid/os/CountDownTimer;
 
-    invoke-virtual {v6}, Landroid/os/CountDownTimer;->start()Landroid/os/CountDownTimer;
+    :goto_b
+    iget-object v4, v4, Lcom/android/server/am/DynamicHiddenApp;->mBGSlotManager:Lcom/android/server/bgslotmanager/BGSlotManager;
 
-    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
+    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v5}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    new-instance v5, Lcom/android/server/bgslotmanager/BGSlotManager$1;
 
-    move-result-object v5
+    invoke-direct {v5, v4}, Lcom/android/server/bgslotmanager/BGSlotManager$1;-><init>(Lcom/android/server/bgslotmanager/BGSlotManager;)V
 
-    const-string/jumbo v6, "sem_sp_edition_flipfont_changed"
+    invoke-virtual {v5}, Landroid/os/CountDownTimer;->start()Landroid/os/CountDownTimer;
 
-    invoke-static {v5, v6, v7}, Landroid/provider/Settings$Secure;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I
+    iget-object v4, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    move-result v5
+    invoke-virtual {v4}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
 
-    if-ne v5, v3, :cond_20
+    move-result-object v4
 
-    goto :goto_11
+    const-string/jumbo v5, "sem_sp_edition_flipfont_changed"
 
-    :cond_20
-    new-instance v5, Lcom/samsung/android/fontutil/FlipFontOptimizer;
+    const/4 v14, 0x0
 
-    invoke-direct {v5}, Lcom/samsung/android/fontutil/FlipFontOptimizer;-><init>()V
+    invoke-static {v4, v5, v14}, Landroid/provider/Settings$Secure;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I
 
-    iget-object v6, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
+    move-result v4
 
-    invoke-virtual {v5, v6}, Lcom/samsung/android/fontutil/FlipFontOptimizer;->setFlipfont(Landroid/content/Context;)V
+    if-ne v4, v2, :cond_1a
+
+    goto :goto_c
+
+    :cond_1a
+    new-instance v4, Lcom/samsung/android/fontutil/FlipFontOptimizer;
+
+    invoke-direct {v4}, Lcom/samsung/android/fontutil/FlipFontOptimizer;-><init>()V
 
     iget-object v5, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v5}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    invoke-virtual {v4, v5}, Lcom/samsung/android/fontutil/FlipFontOptimizer;->setFlipfont(Landroid/content/Context;)V
 
-    move-result-object v5
+    iget-object v4, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
+
+    invoke-virtual {v4}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
 
-    const-string/jumbo v6, "sem_sp_edition_flipfont_changed"
+    move-result-object v4
 
-    invoke-static {v5, v6, v3}, Landroid/provider/Settings$Secure;->putInt(Landroid/content/ContentResolver;Ljava/lang/String;I)Z
+    const-string/jumbo v5, "sem_sp_edition_flipfont_changed"
 
-    :goto_11
-    const-string/jumbo v3, "finishBooting"
+    invoke-static {v4, v5, v2}, Landroid/provider/Settings$Secure;->putInt(Landroid/content/ContentResolver;Ljava/lang/String;I)Z
 
-    const-string/jumbo v5, "NULL"
+    :goto_c
+    const-string/jumbo v2, "finishBooting"
 
-    invoke-static {v7, v8, v2, v3, v5}, Lcom/android/server/am/EventLogTags;->writeBootProgressAmsState(IIILjava/lang/String;Ljava/lang/String;)V
+    const-string/jumbo v4, "NULL"
+
+    const/4 v7, -0x1
+
+    const/4 v14, 0x0
+
+    invoke-static {v14, v7, v11, v2, v4}, Lcom/android/server/am/EventLogTags;->writeBootProgressAmsState(IIILjava/lang/String;Ljava/lang/String;)V
 
     iget-object v2, v1, Lcom/android/server/am/ActivityManagerService;->mHandler:Lcom/android/server/am/ActivityManagerService$UiHandler;
 
-    new-instance v3, Lcom/android/server/am/ActivityManagerService$$ExternalSyntheticLambda8;
+    new-instance v4, Lcom/android/server/am/ActivityManagerService$$ExternalSyntheticLambda8;
 
-    invoke-direct {v3, v1, v7}, Lcom/android/server/am/ActivityManagerService$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/am/ActivityManagerService;I)V
+    invoke-direct {v4, v1, v14}, Lcom/android/server/am/ActivityManagerService$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/am/ActivityManagerService;I)V
 
-    invoke-virtual {v2, v3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+    invoke-virtual {v2, v4}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
     sget-boolean v2, Lcom/samsung/android/rune/CoreRune;->FW_APPLOCK:Z
 
-    if-eqz v2, :cond_21
+    if-eqz v2, :cond_1b
 
     iget-object v2, v1, Lcom/android/server/am/ActivityManagerService;->mHandler:Lcom/android/server/am/ActivityManagerService$UiHandler;
 
-    new-instance v3, Lcom/android/server/am/ActivityManagerService$$ExternalSyntheticLambda8;
+    new-instance v4, Lcom/android/server/am/ActivityManagerService$$ExternalSyntheticLambda8;
 
-    invoke-direct {v3, v1, v0}, Lcom/android/server/am/ActivityManagerService$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/am/ActivityManagerService;I)V
+    invoke-direct {v4, v1, v0}, Lcom/android/server/am/ActivityManagerService$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/am/ActivityManagerService;I)V
 
-    invoke-virtual {v2, v3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+    invoke-virtual {v2, v4}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    :cond_21
+    :cond_1b
     iget-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    :try_start_a
+    :try_start_8
     sput-object v0, Lcom/android/server/am/Pageboost;->mContext:Landroid/content/Context;
 
     sput-object v1, Lcom/android/server/am/Pageboost;->mActivityManagerService:Lcom/android/server/am/ActivityManagerService;
@@ -34433,58 +34323,58 @@
 
     move-result v0
 
-    if-nez v0, :cond_22
+    if-nez v0, :cond_1c
 
-    const/4 v10, 0x1
+    const/4 v9, 0x1
 
-    const/4 v15, 0x0
+    const/4 v14, 0x0
+
+    const/4 v10, -0x1
 
     const/4 v11, -0x1
 
     const/4 v12, -0x1
 
-    const/4 v13, -0x1
-
-    const/16 v14, 0x1388
+    const/16 v13, 0x1388
 
-    invoke-static/range {v10 .. v15}, Lcom/android/server/am/Pageboost;->sendMessage(IIIIILjava/lang/String;)V
+    invoke-static/range {v9 .. v14}, Lcom/android/server/am/Pageboost;->sendMessage(IIIIILjava/lang/String;)V
 
-    :cond_22
+    :cond_1c
     sget-boolean v0, Lcom/android/server/am/Pageboost;->BOOTFILE_ENABLED:Z
 
-    if-eqz v0, :cond_23
+    if-eqz v0, :cond_1d
 
-    const/16 v10, 0x17
+    const/16 v9, 0x17
 
-    const/4 v15, 0x0
+    const/4 v14, 0x0
+
+    const/4 v10, -0x1
 
     const/4 v11, -0x1
 
     const/4 v12, -0x1
 
-    const/4 v13, -0x1
-
-    const/4 v14, 0x0
-
-    invoke-static/range {v10 .. v15}, Lcom/android/server/am/Pageboost;->sendMessage(IIIIILjava/lang/String;)V
+    const/4 v13, 0x0
 
-    const/16 v16, 0x18
+    invoke-static/range {v9 .. v14}, Lcom/android/server/am/Pageboost;->sendMessage(IIIIILjava/lang/String;)V
 
-    const/16 v21, 0x0
+    const/16 v17, 0x18
 
-    const/16 v17, -0x1
+    const/16 v22, 0x0
 
     const/16 v18, -0x1
 
     const/16 v19, -0x1
 
-    const v20, 0x927c0
+    const/16 v20, -0x1
 
-    invoke-static/range {v16 .. v21}, Lcom/android/server/am/Pageboost;->sendMessage(IIIIILjava/lang/String;)V
-    :try_end_a
-    .catch Ljava/lang/Exception; {:try_start_a .. :try_end_a} :catch_2
+    const v21, 0x927c0
 
-    goto :goto_12
+    invoke-static/range {v17 .. v22}, Lcom/android/server/am/Pageboost;->sendMessage(IIIIILjava/lang/String;)V
+    :try_end_8
+    .catch Ljava/lang/Exception; {:try_start_8 .. :try_end_8} :catch_2
+
+    goto :goto_d
 
     :catch_2
     const-string/jumbo v0, "Pageboost"
@@ -34493,67 +34383,67 @@
 
     invoke-static {v0, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_23
-    :goto_12
+    :cond_1d
+    :goto_d
     const-string/jumbo v0, "Pageboost"
 
-    :try_start_b
+    :try_start_9
     invoke-static {}, Lcom/android/server/am/Pageboost;->isPageboostMinimized()Z
 
     move-result v2
 
-    if-eqz v2, :cond_24
+    if-eqz v2, :cond_1e
 
-    goto :goto_13
+    goto :goto_e
 
-    :cond_24
+    :cond_1e
     const-string/jumbo v2, "Update Packages"
 
     invoke-static {v0, v2}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/4 v10, 0x4
+    const/4 v9, 0x4
 
-    const/4 v15, 0x0
+    const/4 v14, 0x0
+
+    const/4 v10, -0x1
 
     const/4 v11, -0x1
 
     const/4 v12, -0x1
 
-    const/4 v13, -0x1
-
-    const/16 v14, 0x2710
+    const/16 v13, 0x2710
 
-    invoke-static/range {v10 .. v15}, Lcom/android/server/am/Pageboost;->sendMessage(IIIIILjava/lang/String;)V
-    :try_end_b
-    .catch Ljava/lang/Exception; {:try_start_b .. :try_end_b} :catch_3
+    invoke-static/range {v9 .. v14}, Lcom/android/server/am/Pageboost;->sendMessage(IIIIILjava/lang/String;)V
+    :try_end_9
+    .catch Ljava/lang/Exception; {:try_start_9 .. :try_end_9} :catch_3
 
-    goto :goto_13
+    goto :goto_e
 
     :catch_3
     const-string/jumbo v2, "failed to updatePackages by exception"
 
     invoke-static {v0, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_13
+    :goto_e
     iget-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mKillPolicyManager:Lcom/android/server/am/KillPolicyManager;
 
-    if-eqz v0, :cond_27
+    if-eqz v0, :cond_21
 
     iget-object v1, v0, Lcom/android/server/am/KillPolicyManager;->mContext:Landroid/content/Context;
 
-    if-eqz v1, :cond_26
+    if-eqz v1, :cond_20
 
     const-string/jumbo v1, "com.android.server.am.BROADCAST_SET_KPM_POLICY"
 
     const-string/jumbo v2, "com.android.server.am.BROADCAST_SET_KPM_DEBUG"
 
-    const-string/jumbo v3, "com.android.server.am.BROADCAST_SET_KPM_STATE"
+    const-string/jumbo v4, "com.android.server.am.BROADCAST_SET_KPM_STATE"
 
     const-string/jumbo v5, "com.android.server.am.BROADCAST_SET_KPM_ONOFF"
 
     const-string/jumbo v6, "com.sec.server.am.BROADCAST_SET_PMM_DMABUF_LEAK_DETECTOR_SOURCE"
 
-    invoke-static {v1, v2, v3, v5, v6}, Lcom/android/server/VpnManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
+    invoke-static {v1, v2, v4, v5, v6}, Lcom/android/server/VpnManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
 
     move-result-object v1
 
@@ -34561,28 +34451,28 @@
 
     iget-object v0, v0, Lcom/android/server/am/KillPolicyManager;->policyBroadcastReceiver:Lcom/android/server/am/KillPolicyManager$1;
 
-    sget-object v3, Lcom/android/server/am/KillPolicyManager;->brHandler:Landroid/os/Handler;
+    sget-object v4, Lcom/android/server/am/KillPolicyManager;->brHandler:Landroid/os/Handler;
 
-    invoke-virtual {v2, v0, v1, v9, v3}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;Ljava/lang/String;Landroid/os/Handler;)Landroid/content/Intent;
+    invoke-virtual {v2, v0, v1, v8, v4}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;Ljava/lang/String;Landroid/os/Handler;)Landroid/content/Intent;
 
     sget-object v0, Lcom/android/server/am/pmm/PersonalizedMemoryManager$LazyHolder;->INSTANCE:Lcom/android/server/am/pmm/PersonalizedMemoryManager;
 
     iget-object v1, v0, Lcom/android/server/am/pmm/PersonalizedMemoryManager;->mContext:Landroid/content/Context;
 
-    if-nez v1, :cond_25
+    if-nez v1, :cond_1f
 
-    goto :goto_14
+    goto :goto_f
 
-    :cond_25
+    :cond_1f
     new-instance v1, Lcom/android/server/am/pmm/PersonalizedMemoryManager$OnDeviceAIChangeObserver;
 
     iget-object v2, v0, Lcom/android/server/am/pmm/PersonalizedMemoryManager;->mContext:Landroid/content/Context;
 
-    new-instance v3, Landroid/os/Handler;
+    new-instance v4, Landroid/os/Handler;
 
-    invoke-direct {v3}, Landroid/os/Handler;-><init>()V
+    invoke-direct {v4}, Landroid/os/Handler;-><init>()V
 
-    invoke-direct {v1, v3}, Landroid/database/ContentObserver;-><init>(Landroid/os/Handler;)V
+    invoke-direct {v1, v4}, Landroid/database/ContentObserver;-><init>(Landroid/os/Handler;)V
 
     iput-object v2, v1, Lcom/android/server/am/pmm/PersonalizedMemoryManager$OnDeviceAIChangeObserver;->mContext:Landroid/content/Context;
 
@@ -34590,9 +34480,11 @@
 
     move-result-object v2
 
-    const-string/jumbo v3, "prevent_online_processing"
+    const-string/jumbo v4, "prevent_online_processing"
+
+    const/4 v14, 0x0
 
-    invoke-static {v2, v3, v7}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I
+    invoke-static {v2, v4, v14}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I
 
     iget-object v2, v0, Lcom/android/server/am/pmm/PersonalizedMemoryManager;->mDmaBufLeakDetector:Lcom/android/server/am/pmm/DmaBufLeakDetector;
 
@@ -34614,56 +34506,56 @@
 
     iget-object v0, v0, Lcom/android/server/am/pmm/PersonalizedMemoryManager;->mChangeObserver:Lcom/android/server/am/pmm/PersonalizedMemoryManager$OnDeviceAIChangeObserver;
 
-    invoke-virtual {v1, v2, v7, v0}, Landroid/content/ContentResolver;->registerContentObserver(Landroid/net/Uri;ZLandroid/database/ContentObserver;)V
+    invoke-virtual {v1, v2, v14, v0}, Landroid/content/ContentResolver;->registerContentObserver(Landroid/net/Uri;ZLandroid/database/ContentObserver;)V
 
-    goto :goto_14
+    goto :goto_f
 
-    :cond_26
+    :cond_20
     const-string v0, "ActivityManager_kpm"
 
     const-string v1, " KPMregisterReceiver failed due to mContext being null"
 
     invoke-static {v0, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_27
-    :goto_14
-    invoke-virtual {v4}, Landroid/util/TimingsTraceLog;->traceEnd()V
+    :cond_21
+    :goto_f
+    invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
     return-void
 
-    :goto_15
-    :try_start_c
-    monitor-exit v5
-    :try_end_c
-    .catchall {:try_start_c .. :try_end_c} :catchall_4
+    :goto_10
+    :try_start_a
+    monitor-exit v4
+    :try_end_a
+    .catchall {:try_start_a .. :try_end_a} :catchall_3
 
     throw v0
 
-    :goto_16
-    :try_start_d
+    :goto_11
+    :try_start_b
     monitor-exit p0
-    :try_end_d
-    .catchall {:try_start_d .. :try_end_d} :catchall_3
+    :try_end_b
+    .catchall {:try_start_b .. :try_end_b} :catchall_2
 
     invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
 
     throw v0
 
-    :goto_17
-    :try_start_e
+    :goto_12
+    :try_start_c
     monitor-exit p0
-    :try_end_e
-    .catchall {:try_start_e .. :try_end_e} :catchall_1
+    :try_end_c
+    .catchall {:try_start_c .. :try_end_c} :catchall_1
 
     invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
 
     throw v0
 
-    :goto_18
-    :try_start_f
-    monitor-exit v5
-    :try_end_f
-    .catchall {:try_start_f .. :try_end_f} :catchall_0
+    :goto_13
+    :try_start_d
+    monitor-exit v4
+    :try_end_d
+    .catchall {:try_start_d .. :try_end_d} :catchall_0
 
     throw v0
 .end method
diff --git a/smali/com/android/server/am/DualDarUserController.smali b/smali/com/android/server/am/DualDarUserController.smali
deleted file mode 100644
index fca7d9106..000000000
--- a/smali/com/android/server/am/DualDarUserController.smali
+++ /dev/null
@@ -1,72 +0,0 @@
-.class public final Lcom/android/server/am/DualDarUserController;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# static fields
-.field public static volatile mInstance:Lcom/android/server/am/DualDarUserController;
-
-
-# instance fields
-.field public final mInjector:Lcom/android/server/am/UserController$Injector;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/am/UserController$Injector;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/am/DualDarUserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    return-void
-.end method
-
-.method public static getInstance(Lcom/android/server/am/UserController$Injector;)Lcom/android/server/am/DualDarUserController;
-    .locals 2
-
-    sget-object v0, Lcom/android/server/am/DualDarUserController;->mInstance:Lcom/android/server/am/DualDarUserController;
-
-    if-nez v0, :cond_1
-
-    const-class v0, Lcom/android/server/am/DualDarUserController;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/am/DualDarUserController;->mInstance:Lcom/android/server/am/DualDarUserController;
-
-    if-nez v1, :cond_0
-
-    new-instance v1, Lcom/android/server/am/DualDarUserController;
-
-    invoke-direct {v1, p0}, Lcom/android/server/am/DualDarUserController;-><init>(Lcom/android/server/am/UserController$Injector;)V
-
-    sput-object v1, Lcom/android/server/am/DualDarUserController;->mInstance:Lcom/android/server/am/DualDarUserController;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    :goto_0
-    monitor-exit v0
-
-    goto :goto_2
-
-    :goto_1
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-
-    :cond_1
-    :goto_2
-    sget-object p0, Lcom/android/server/am/DualDarUserController;->mInstance:Lcom/android/server/am/DualDarUserController;
-
-    return-object p0
-.end method
diff --git a/smali/com/android/server/am/ProcessList.smali b/smali/com/android/server/am/ProcessList.smali
index a96d769e4..9d6a351a7 100644
--- a/smali/com/android/server/am/ProcessList.smali
+++ b/smali/com/android/server/am/ProcessList.smali
@@ -14375,28 +14375,6 @@
     return-object v15
 .end method
 
-.method public final startProcessLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HostingRecord;I)V
-    .locals 7
-
-    const/4 v4, 0x0
-
-    const/4 v5, 0x0
-
-    const/4 v6, 0x0
-
-    move-object v0, p0
-
-    move-object v1, p1
-
-    move-object v2, p2
-
-    move v3, p3
-
-    invoke-virtual/range {v0 .. v6}, Lcom/android/server/am/ProcessList;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HostingRecord;IZZLjava/lang/String;)Z
-
-    return-void
-.end method
-
 .method public final startProcessLocked(Lcom/android/server/am/HostingRecord;Lcom/android/server/am/ProcessRecord;I[IIIILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;JJ)Z
     .locals 15
 
@@ -14922,7 +14900,7 @@
 .end method
 
 .method public final startProcessLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HostingRecord;IZZLjava/lang/String;)Z
-    .locals 26
+    .locals 25
 
     move-object/from16 v2, p0
 
@@ -14930,19 +14908,17 @@
 
     move-object/from16 v3, p2
 
-    const/4 v1, 0x0
+    const/4 v1, 0x1
 
-    const/4 v5, 0x1
+    const-string v5, "ActivityManager"
 
     const-string v6, "1"
 
-    const-string v7, "ActivityManager"
-
-    iget-boolean v8, v4, Lcom/android/server/am/ProcessRecord;->mPendingStart:Z
+    iget-boolean v7, v4, Lcom/android/server/am/ProcessRecord;->mPendingStart:Z
 
-    if-eqz v8, :cond_0
+    if-eqz v7, :cond_0
 
-    return v5
+    return v1
 
     :cond_0
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
@@ -14953,75 +14929,77 @@
 
     move-result-wide v16
 
-    iget v8, v4, Lcom/android/server/am/ProcessRecord;->mPid:I
+    iget v7, v4, Lcom/android/server/am/ProcessRecord;->mPid:I
 
-    if-lez v8, :cond_1
+    const/4 v8, 0x0
+
+    if-lez v7, :cond_1
 
     sget v9, Lcom/android/server/am/ActivityManagerService;->MY_PID:I
 
-    if-eq v8, v9, :cond_1
+    if-eq v7, v9, :cond_1
 
-    const-string/jumbo v8, "startProcess: removing from pids map"
+    const-string/jumbo v7, "startProcess: removing from pids map"
 
-    invoke-static {v14, v15, v8}, Lcom/android/server/am/ProcessList;->checkSlow(JLjava/lang/String;)V
+    invoke-static {v14, v15, v7}, Lcom/android/server/am/ProcessList;->checkSlow(JLjava/lang/String;)V
 
-    iget-object v8, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
+    iget-object v7, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
     iget v9, v4, Lcom/android/server/am/ProcessRecord;->mPid:I
 
-    invoke-virtual {v8, v9, v4}, Lcom/android/server/am/ActivityManagerService;->removePidLocked(ILcom/android/server/am/ProcessRecord;)Z
+    invoke-virtual {v7, v9, v4}, Lcom/android/server/am/ActivityManagerService;->removePidLocked(ILcom/android/server/am/ProcessRecord;)Z
 
-    iput-boolean v1, v4, Lcom/android/server/am/ProcessRecord;->mBindMountPending:Z
+    iput-boolean v8, v4, Lcom/android/server/am/ProcessRecord;->mBindMountPending:Z
 
-    iget-object v8, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
+    iget-object v7, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    iget-object v8, v8, Lcom/android/server/am/ActivityManagerService;->mHandler:Lcom/android/server/am/ActivityManagerService$UiHandler;
+    iget-object v7, v7, Lcom/android/server/am/ActivityManagerService;->mHandler:Lcom/android/server/am/ActivityManagerService$UiHandler;
 
     const/16 v9, 0x14
 
-    invoke-virtual {v8, v9, v4}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
+    invoke-virtual {v7, v9, v4}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
 
-    const-string/jumbo v8, "startProcess: done removing from pids map"
+    const-string/jumbo v7, "startProcess: done removing from pids map"
 
-    invoke-static {v14, v15, v8}, Lcom/android/server/am/ProcessList;->checkSlow(JLjava/lang/String;)V
+    invoke-static {v14, v15, v7}, Lcom/android/server/am/ProcessList;->checkSlow(JLjava/lang/String;)V
 
-    invoke-virtual {v4, v1}, Lcom/android/server/am/ProcessRecord;->setPid(I)V
+    invoke-virtual {v4, v8}, Lcom/android/server/am/ProcessRecord;->setPid(I)V
 
-    const-wide/16 v8, 0x0
+    const-wide/16 v9, 0x0
 
-    iput-wide v8, v4, Lcom/android/server/am/ProcessRecord;->mStartSeq:J
+    iput-wide v9, v4, Lcom/android/server/am/ProcessRecord;->mStartSeq:J
 
     :cond_1
     invoke-virtual {v4}, Lcom/android/server/am/ProcessRecord;->unlinkDeathRecipient()V
 
-    iput v1, v4, Lcom/android/server/am/ProcessRecord;->mDyingPid:I
+    iput v8, v4, Lcom/android/server/am/ProcessRecord;->mDyingPid:I
 
-    iget-object v8, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
+    iget-object v7, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    iget-object v8, v8, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;
+    iget-object v7, v7, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;
 
-    invoke-virtual {v8, v4}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z
+    invoke-virtual {v7, v4}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z
 
-    const-string/jumbo v8, "startProcess: starting to update cpu stats"
+    const-string/jumbo v7, "startProcess: starting to update cpu stats"
 
-    invoke-static {v14, v15, v8}, Lcom/android/server/am/ProcessList;->checkSlow(JLjava/lang/String;)V
+    invoke-static {v14, v15, v7}, Lcom/android/server/am/ProcessList;->checkSlow(JLjava/lang/String;)V
 
-    iget-object v8, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
+    iget-object v7, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    invoke-virtual {v8}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V
+    invoke-virtual {v7}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V
 
-    const-string/jumbo v8, "startProcess: done updating cpu stats"
+    const-string/jumbo v7, "startProcess: done updating cpu stats"
 
-    invoke-static {v14, v15, v8}, Lcom/android/server/am/ProcessList;->checkSlow(JLjava/lang/String;)V
+    invoke-static {v14, v15, v7}, Lcom/android/server/am/ProcessList;->checkSlow(JLjava/lang/String;)V
 
     :try_start_0
-    iget v8, v4, Lcom/android/server/am/ProcessRecord;->uid:I
+    iget v7, v4, Lcom/android/server/am/ProcessRecord;->uid:I
 
-    invoke-static {v8}, Landroid/os/UserHandle;->getUserId(I)I
+    invoke-static {v7}, Landroid/os/UserHandle;->getUserId(I)I
 
-    move-result v8
+    move-result v7
     :try_end_0
-    .catch Ljava/lang/RuntimeException; {:try_start_0 .. :try_end_0} :catch_0
+    .catch Ljava/lang/RuntimeException; {:try_start_0 .. :try_end_0} :catch_6
 
     :try_start_1
     invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
@@ -15032,19 +15010,19 @@
 
     iget-object v10, v10, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    invoke-interface {v9, v10, v8}, Landroid/content/pm/IPackageManager;->checkPackageStartable(Ljava/lang/String;I)V
+    invoke-interface {v9, v10, v7}, Landroid/content/pm/IPackageManager;->checkPackageStartable(Ljava/lang/String;I)V
     :try_end_1
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_5
-    .catch Ljava/lang/RuntimeException; {:try_start_1 .. :try_end_1} :catch_0
+    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_9
+    .catch Ljava/lang/RuntimeException; {:try_start_1 .. :try_end_1} :catch_6
 
     :try_start_2
     iget v9, v4, Lcom/android/server/am/ProcessRecord;->uid:I
 
     iget-boolean v10, v4, Lcom/android/server/am/ProcessRecord;->isolated:Z
     :try_end_2
-    .catch Ljava/lang/RuntimeException; {:try_start_2 .. :try_end_2} :catch_0
+    .catch Ljava/lang/RuntimeException; {:try_start_2 .. :try_end_2} :catch_6
 
-    if-nez v10, :cond_6
+    if-nez v10, :cond_7
 
     :try_start_3
     const-string/jumbo v10, "startProcess: getting gids from package manager"
@@ -15060,15 +15038,9 @@
     iget-object v12, v12, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
     iget v13, v4, Lcom/android/server/am/ProcessRecord;->userId:I
-    :try_end_3
-    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_3
-    .catch Ljava/lang/RuntimeException; {:try_start_3 .. :try_end_3} :catch_2
-
-    move/from16 v19, v1
 
     const-wide/32 v0, 0x10000000
 
-    :try_start_4
     invoke-interface {v10, v12, v0, v1, v13}, Landroid/content/pm/IPackageManager;->getPackageGids(Ljava/lang/String;JI)[I
 
     move-result-object v0
@@ -15106,47 +15078,55 @@
     if-eqz v13, :cond_2
 
     const-string/jumbo v13, "android.permission.INSTALL_PACKAGES"
+    :try_end_3
+    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_3
+    .catch Ljava/lang/RuntimeException; {:try_start_3 .. :try_end_3} :catch_2
 
-    iget-object v11, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    move/from16 v20, v8
 
-    iget-object v11, v11, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+    :try_start_4
+    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    invoke-interface {v10, v13, v11, v8}, Landroid/content/pm/IPackageManager;->checkPermission(Ljava/lang/String;Ljava/lang/String;I)I
+    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    move-result v8
+    invoke-interface {v10, v13, v8, v7}, Landroid/content/pm/IPackageManager;->checkPermission(Ljava/lang/String;Ljava/lang/String;I)I
 
-    if-nez v8, :cond_2
+    move-result v7
 
-    new-instance v8, Ljava/lang/StringBuilder;
+    if-nez v7, :cond_3
 
-    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V
+    new-instance v7, Ljava/lang/StringBuilder;
 
-    iget-object v10, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V
 
-    iget-object v10, v10, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    invoke-virtual {v8, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    const-string v10, " is exempt from freezer"
+    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v8, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    const-string v8, " is exempt from freezer"
 
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v8
+    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v7
+
+    invoke-static {v5, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {v7, v8}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+    iget-object v7, v4, Lcom/android/server/am/ProcessRecord;->mOptRecord:Lcom/android/server/am/ProcessCachedOptimizerRecord;
 
-    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->mOptRecord:Lcom/android/server/am/ProcessCachedOptimizerRecord;
+    const/4 v8, 0x1
 
-    iput-boolean v5, v8, Lcom/android/server/am/ProcessCachedOptimizerRecord;->mFreezeExempt:Z
+    iput-boolean v8, v7, Lcom/android/server/am/ProcessCachedOptimizerRecord;->mFreezeExempt:Z
 
     goto :goto_1
 
     :goto_0
-    move-object v1, v7
+    move-object v1, v5
 
-    goto/16 :goto_19
+    goto/16 :goto_1a
 
     :catch_0
     move-exception v0
@@ -15158,149 +15138,150 @@
 
     goto/16 :goto_4
 
+    :catch_2
+    move-exception v0
+
+    move/from16 v20, v8
+
+    goto :goto_0
+
+    :catch_3
+    move-exception v0
+
+    move/from16 v20, v8
+
+    goto/16 :goto_4
+
     :cond_2
+    move/from16 v20, v8
+
+    :cond_3
     :goto_1
-    sget-boolean v8, Lcom/android/server/am/MARsPolicyManager;->MARs_ENABLE:Z
+    sget-boolean v7, Lcom/android/server/am/MARsPolicyManager;->MARs_ENABLE:Z
 
-    sget-object v8, Lcom/android/server/am/MARsPolicyManager$MARsPolicyManagerHolder;->INSTANCE:Lcom/android/server/am/MARsPolicyManager;
+    sget-object v7, Lcom/android/server/am/MARsPolicyManager$MARsPolicyManagerHolder;->INSTANCE:Lcom/android/server/am/MARsPolicyManager;
 
-    invoke-virtual {v8}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v7}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     invoke-static {v4}, Lcom/android/server/am/MARsPolicyManager;->checkFreezerExempt(Lcom/android/server/am/ProcessRecord;)Z
 
-    move-result v8
+    move-result v7
 
-    if-eqz v8, :cond_3
+    if-eqz v7, :cond_4
 
-    new-instance v8, Ljava/lang/StringBuilder;
+    new-instance v7, Ljava/lang/StringBuilder;
 
-    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V
 
-    iget-object v10, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    iget-object v10, v10, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    invoke-virtual {v8, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string v10, " is exempt from freezer by list"
+    const-string v8, " is exempt from freezer by list"
 
-    invoke-virtual {v8, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v8
+    move-result-object v7
+
+    invoke-static {v5, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {v7, v8}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+    iget-object v7, v4, Lcom/android/server/am/ProcessRecord;->mOptRecord:Lcom/android/server/am/ProcessCachedOptimizerRecord;
 
-    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->mOptRecord:Lcom/android/server/am/ProcessCachedOptimizerRecord;
+    const/4 v8, 0x1
 
-    iput-boolean v5, v8, Lcom/android/server/am/ProcessCachedOptimizerRecord;->mFreezeExempt:Z
+    iput-boolean v8, v7, Lcom/android/server/am/ProcessCachedOptimizerRecord;->mFreezeExempt:Z
     :try_end_4
     .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_1
     .catch Ljava/lang/RuntimeException; {:try_start_4 .. :try_end_4} :catch_0
 
-    :cond_3
+    :cond_4
     :try_start_5
-    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->processInfo:Landroid/content/pm/ProcessInfo;
+    iget-object v7, v4, Lcom/android/server/am/ProcessRecord;->processInfo:Landroid/content/pm/ProcessInfo;
 
-    if-eqz v8, :cond_5
+    if-eqz v7, :cond_6
 
-    iget-object v8, v8, Landroid/content/pm/ProcessInfo;->deniedPermissions:Landroid/util/ArraySet;
+    iget-object v7, v7, Landroid/content/pm/ProcessInfo;->deniedPermissions:Landroid/util/ArraySet;
 
-    if-eqz v8, :cond_5
+    if-eqz v7, :cond_6
 
-    invoke-virtual {v8}, Landroid/util/ArraySet;->size()I
+    invoke-virtual {v7}, Landroid/util/ArraySet;->size()I
 
-    move-result v8
+    move-result v7
+
+    const/16 v19, 0x1
 
-    sub-int/2addr v8, v5
+    add-int/lit8 v7, v7, -0x1
 
     :goto_2
-    if-ltz v8, :cond_5
+    if-ltz v7, :cond_6
 
-    iget-object v10, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
+    iget-object v8, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    iget-object v10, v10, Lcom/android/server/am/ActivityManagerService;->mPackageManagerInt:Landroid/content/pm/PackageManagerInternal;
+    iget-object v8, v8, Lcom/android/server/am/ActivityManagerService;->mPackageManagerInt:Landroid/content/pm/PackageManagerInternal;
 
-    iget-object v11, v4, Lcom/android/server/am/ProcessRecord;->processInfo:Landroid/content/pm/ProcessInfo;
+    iget-object v10, v4, Lcom/android/server/am/ProcessRecord;->processInfo:Landroid/content/pm/ProcessInfo;
 
-    iget-object v11, v11, Landroid/content/pm/ProcessInfo;->deniedPermissions:Landroid/util/ArraySet;
+    iget-object v10, v10, Landroid/content/pm/ProcessInfo;->deniedPermissions:Landroid/util/ArraySet;
 
-    invoke-virtual {v11, v8}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;
+    invoke-virtual {v10, v7}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;
 
-    move-result-object v11
+    move-result-object v10
 
-    check-cast v11, Ljava/lang/String;
+    check-cast v10, Ljava/lang/String;
 
     iget v13, v4, Lcom/android/server/am/ProcessRecord;->userId:I
 
-    check-cast v10, Lcom/android/server/pm/PackageManagerService$PackageManagerInternalImpl;
+    check-cast v8, Lcom/android/server/pm/PackageManagerService$PackageManagerInternalImpl;
 
-    iget-object v10, v10, Lcom/android/server/pm/PackageManagerService$PackageManagerInternalImpl;->this$0:Lcom/android/server/pm/PackageManagerService;
+    iget-object v8, v8, Lcom/android/server/pm/PackageManagerService$PackageManagerInternalImpl;->this$0:Lcom/android/server/pm/PackageManagerService;
 
-    iget-object v10, v10, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerService$PermissionManagerServiceInternalImpl;
+    iget-object v8, v8, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerService$PermissionManagerServiceInternalImpl;
 
-    iget-object v10, v10, Lcom/android/server/pm/permission/PermissionManagerService$PermissionManagerServiceInternalImpl;->this$0:Lcom/android/server/pm/permission/PermissionManagerService;
+    iget-object v8, v8, Lcom/android/server/pm/permission/PermissionManagerService$PermissionManagerServiceInternalImpl;->this$0:Lcom/android/server/pm/permission/PermissionManagerService;
 
-    iget-object v10, v10, Lcom/android/server/pm/permission/PermissionManagerService;->mPermissionManagerServiceImpl:Lcom/android/server/pm/permission/PermissionManagerServiceInterface;
+    iget-object v8, v8, Lcom/android/server/pm/permission/PermissionManagerService;->mPermissionManagerServiceImpl:Lcom/android/server/pm/permission/PermissionManagerServiceInterface;
 
-    invoke-interface {v10, v13, v11}, Lcom/android/server/pm/permission/PermissionManagerServiceInterface;->getPermissionGids(ILjava/lang/String;)[I
+    invoke-interface {v8, v13, v10}, Lcom/android/server/pm/permission/PermissionManagerServiceInterface;->getPermissionGids(ILjava/lang/String;)[I
 
-    move-result-object v10
+    move-result-object v8
 
-    if-eqz v10, :cond_4
+    if-eqz v8, :cond_5
 
-    array-length v11, v10
+    array-length v10, v8
 
-    move/from16 v13, v19
+    move/from16 v13, v20
 
     :goto_3
-    if-ge v13, v11, :cond_4
+    if-ge v13, v10, :cond_5
 
-    move/from16 v21, v5
+    aget v11, v8, v13
 
-    aget v5, v10, v13
-
-    invoke-static {v0, v5}, Lcom/android/internal/util/ArrayUtils;->removeInt([II)[I
+    invoke-static {v0, v11}, Lcom/android/internal/util/ArrayUtils;->removeInt([II)[I
 
     move-result-object v0
 
-    add-int/lit8 v13, v13, 0x1
+    const/16 v19, 0x1
 
-    move/from16 v5, v21
+    add-int/lit8 v13, v13, 0x1
 
     goto :goto_3
 
-    :cond_4
-    move/from16 v21, v5
-
-    add-int/lit8 v8, v8, -0x1
-
-    move/from16 v5, v21
+    :cond_5
+    add-int/lit8 v7, v7, -0x1
 
     goto :goto_2
 
-    :cond_5
-    move/from16 v21, v5
-
+    :cond_6
     invoke-static {v12, v9, v1, v0}, Lcom/android/server/am/ProcessList;->computeGidsForProcess(IIZ[I)[I
 
     move-result-object v0
 
     goto :goto_5
 
-    :catch_2
-    move-exception v0
-
-    move/from16 v19, v1
-
-    goto/16 :goto_0
-
-    :catch_3
-    move-exception v0
-
-    move/from16 v19, v1
-
     :goto_4
     invoke-virtual {v0}, Landroid/os/RemoteException;->rethrowAsRuntimeException()Ljava/lang/RuntimeException;
 
@@ -15308,12 +15289,10 @@
 
     throw v0
 
-    :cond_6
-    move/from16 v19, v1
-
-    move/from16 v21, v5
+    :cond_7
+    move/from16 v20, v8
 
-    move/from16 v12, v19
+    move/from16 v12, v20
 
     const/4 v0, 0x0
 
@@ -15326,41 +15305,41 @@
 
     iget-object v1, v4, Lcom/android/server/am/ProcessRecord;->mWindowProcessController:Lcom/android/server/wm/WindowProcessController;
 
-    iget-object v5, v1, Lcom/android/server/wm/WindowProcessController;->mAtm:Lcom/android/server/wm/ActivityTaskManagerService;
+    iget-object v7, v1, Lcom/android/server/wm/WindowProcessController;->mAtm:Lcom/android/server/wm/ActivityTaskManagerService;
 
-    iget v8, v5, Lcom/android/server/wm/ActivityTaskManagerService;->mFactoryTest:I
+    iget v8, v7, Lcom/android/server/wm/ActivityTaskManagerService;->mFactoryTest:I
 
-    if-nez v8, :cond_7
+    if-nez v8, :cond_8
 
     goto :goto_7
 
-    :cond_7
-    move/from16 v10, v21
+    :cond_8
+    const/4 v10, 0x1
 
-    if-ne v8, v10, :cond_8
+    if-ne v8, v10, :cond_9
 
-    iget-object v5, v5, Lcom/android/server/wm/ActivityTaskManagerService;->mTopComponent:Landroid/content/ComponentName;
+    iget-object v7, v7, Lcom/android/server/wm/ActivityTaskManagerService;->mTopComponent:Landroid/content/ComponentName;
 
-    if-eqz v5, :cond_8
+    if-eqz v7, :cond_9
 
     iget-object v10, v1, Lcom/android/server/wm/WindowProcessController;->mName:Ljava/lang/String;
 
-    invoke-virtual {v5}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
+    invoke-virtual {v7}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v7
 
-    invoke-virtual {v10, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v10, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v5
+    move-result v7
 
-    if-eqz v5, :cond_8
+    if-eqz v7, :cond_9
 
     goto :goto_6
 
-    :cond_8
-    const/4 v5, 0x2
+    :cond_9
+    const/4 v7, 0x2
 
-    if-ne v8, v5, :cond_9
+    if-ne v8, v7, :cond_a
 
     iget-object v1, v1, Lcom/android/server/wm/WindowProcessController;->mInfo:Landroid/content/pm/ApplicationInfo;
 
@@ -15368,18 +15347,13 @@
 
     and-int/lit8 v1, v1, 0x10
 
-    if-eqz v1, :cond_9
+    if-eqz v1, :cond_a
 
     :goto_6
-    move/from16 v5, v19
-
-    goto :goto_8
+    move/from16 v9, v20
 
-    :cond_9
+    :cond_a
     :goto_7
-    move v5, v9
-
-    :goto_8
     iget-object v1, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
     iget v1, v1, Landroid/content/pm/ApplicationInfo;->flags:I
@@ -15388,37 +15362,37 @@
 
     and-int/lit8 v1, v1, 0x2
 
-    if-eqz v1, :cond_a
+    if-eqz v1, :cond_b
 
     const/4 v1, 0x1
 
-    goto :goto_9
+    goto :goto_8
 
-    :cond_a
-    move/from16 v1, v19
+    :cond_b
+    move/from16 v1, v20
 
-    :goto_9
-    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    :goto_8
+    iget-object v7, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    invoke-virtual {v8}, Landroid/content/pm/ApplicationInfo;->isProfileableByShell()Z
+    invoke-virtual {v7}, Landroid/content/pm/ApplicationInfo;->isProfileableByShell()Z
 
-    move-result v8
+    move-result v7
 
-    iget-object v9, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    invoke-virtual {v9}, Landroid/content/pm/ApplicationInfo;->isProfileable()Z
+    invoke-virtual {v8}, Landroid/content/pm/ApplicationInfo;->isProfileable()Z
 
-    move-result v9
+    move-result v8
 
     iget-boolean v10, v4, Lcom/android/server/am/ProcessRecord;->isSdkSandbox:Z
 
-    if-eqz v10, :cond_c
+    if-eqz v10, :cond_d
 
     invoke-virtual {v4}, Lcom/android/server/am/ProcessRecord;->getClientInfoForSdkSandbox()Landroid/content/pm/ApplicationInfo;
 
     move-result-object v10
 
-    if-eqz v10, :cond_c
+    if-eqz v10, :cond_d
 
     iget v11, v10, Landroid/content/pm/ApplicationInfo;->flags:I
 
@@ -15426,32 +15400,32 @@
 
     and-int/lit8 v11, v11, 0x2
 
-    if-eqz v11, :cond_b
+    if-eqz v11, :cond_c
 
     const/4 v11, 0x1
 
-    goto :goto_a
+    goto :goto_9
 
-    :cond_b
-    move/from16 v11, v19
+    :cond_c
+    move/from16 v11, v20
 
-    :goto_a
+    :goto_9
     or-int/2addr v1, v11
 
     invoke-virtual {v10}, Landroid/content/pm/ApplicationInfo;->isProfileableByShell()Z
 
     move-result v11
 
-    or-int/2addr v8, v11
+    or-int/2addr v7, v11
 
     invoke-virtual {v10}, Landroid/content/pm/ApplicationInfo;->isProfileable()Z
 
     move-result v10
 
-    or-int/2addr v9, v10
+    or-int/2addr v8, v10
 
-    :cond_c
-    if-eqz v1, :cond_e
+    :cond_d
+    if-eqz v1, :cond_f
 
     iget-object v10, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
@@ -15469,7 +15443,7 @@
 
     move-result v10
 
-    if-nez v10, :cond_d
+    if-nez v10, :cond_e
 
     new-instance v10, Ljava/lang/StringBuilder;
 
@@ -15485,215 +15459,215 @@
 
     move-result-object v10
 
-    invoke-static {v7, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
     const v10, 0x2000303
 
-    goto :goto_b
+    goto :goto_a
 
-    :cond_d
+    :cond_e
     const v10, 0x2000103
 
-    goto :goto_b
+    goto :goto_a
 
-    :cond_e
-    move/from16 v10, v19
+    :cond_f
+    move/from16 v10, v20
 
-    :goto_b
+    :goto_a
     iget-object v11, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
     iget v11, v11, Landroid/content/pm/ApplicationInfo;->flags:I
 
     and-int/lit16 v11, v11, 0x4000
 
-    if-nez v11, :cond_f
+    if-nez v11, :cond_10
 
     iget-object v11, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
     iget-boolean v11, v11, Lcom/android/server/am/ActivityManagerService;->mSafeMode:Z
 
-    if-eqz v11, :cond_10
+    if-eqz v11, :cond_11
 
-    :cond_f
+    :cond_10
     or-int/lit8 v10, v10, 0x8
 
-    :cond_10
-    if-eqz v8, :cond_11
+    :cond_11
+    if-eqz v7, :cond_12
 
-    const v8, 0x8000
+    const v7, 0x8000
 
-    or-int/2addr v10, v8
+    or-int/2addr v10, v7
 
-    :cond_11
-    if-eqz v9, :cond_12
+    :cond_12
+    if-eqz v8, :cond_13
 
-    const/high16 v8, 0x1000000
+    const/high16 v7, 0x1000000
 
-    or-int/2addr v10, v8
+    or-int/2addr v10, v7
 
-    :cond_12
-    const-string/jumbo v8, "debug.checkjni"
+    :cond_13
+    const-string/jumbo v7, "debug.checkjni"
 
-    invoke-static {v8}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+    invoke-static {v7}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v8
+    move-result-object v7
 
-    invoke-virtual {v6, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v6, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v8
+    move-result v7
 
-    if-eqz v8, :cond_13
+    if-eqz v7, :cond_14
 
     const/16 v18, 0x2
 
     or-int/lit8 v10, v10, 0x2
 
-    :cond_13
-    const-string/jumbo v8, "debug.generate-debug-info"
+    :cond_14
+    const-string/jumbo v7, "debug.generate-debug-info"
 
-    invoke-static {v8}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+    invoke-static {v7}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v8
+    move-result-object v7
 
-    invoke-virtual {v6, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v6, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v9
+    move-result v8
     :try_end_5
     .catch Ljava/lang/RuntimeException; {:try_start_5 .. :try_end_5} :catch_0
 
     const-string/jumbo v11, "true"
 
-    if-nez v9, :cond_14
+    if-nez v8, :cond_15
 
     :try_start_6
-    invoke-virtual {v11, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v11, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v8
+    move-result v7
 
-    if-eqz v8, :cond_15
+    if-eqz v7, :cond_16
 
-    :cond_14
+    :cond_15
     or-int/lit8 v10, v10, 0x20
 
-    :cond_15
-    const-string/jumbo v8, "dalvik.vm.minidebuginfo"
+    :cond_16
+    const-string/jumbo v7, "dalvik.vm.minidebuginfo"
 
-    invoke-static {v8}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+    invoke-static {v7}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v8
+    move-result-object v7
 
-    invoke-virtual {v6, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v6, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v9
+    move-result v8
 
-    if-nez v9, :cond_16
+    if-nez v8, :cond_17
 
-    invoke-virtual {v11, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v11, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v8
+    move-result v7
 
-    if-eqz v8, :cond_17
+    if-eqz v7, :cond_18
 
-    :cond_16
+    :cond_17
     or-int/lit16 v10, v10, 0x800
 
-    :cond_17
-    const-string/jumbo v8, "debug.jni.logging"
+    :cond_18
+    const-string/jumbo v7, "debug.jni.logging"
 
-    invoke-static {v8}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+    invoke-static {v7}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v8
+    move-result-object v7
 
-    invoke-virtual {v6, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v6, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v8
+    move-result v7
 
-    if-eqz v8, :cond_18
+    if-eqz v7, :cond_19
 
     or-int/lit8 v10, v10, 0x10
 
-    :cond_18
-    const-string/jumbo v8, "debug.assert"
+    :cond_19
+    const-string/jumbo v7, "debug.assert"
 
-    invoke-static {v8}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+    invoke-static {v7}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v8
+    move-result-object v7
 
-    invoke-virtual {v6, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v6, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v8
+    move-result v7
 
-    if-eqz v8, :cond_19
+    if-eqz v7, :cond_1a
 
     or-int/lit8 v10, v10, 0x4
 
-    :cond_19
-    const-string/jumbo v8, "debug.ignoreappsignalhandler"
+    :cond_1a
+    const-string/jumbo v7, "debug.ignoreappsignalhandler"
 
-    invoke-static {v8}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+    invoke-static {v7}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v8
+    move-result-object v7
 
-    invoke-virtual {v6, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v6, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v6
 
-    if-eqz v6, :cond_1a
+    if-eqz v6, :cond_1b
 
     const/high16 v6, 0x20000
 
     or-int/2addr v10, v6
 
-    :cond_1a
+    :cond_1b
     iget-object v6, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
     iget-object v6, v6, Lcom/android/server/am/ActivityManagerService;->mNativeDebuggingApp:Ljava/lang/String;
 
-    if-eqz v6, :cond_1b
+    if-eqz v6, :cond_1c
 
-    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;
+    iget-object v7, v4, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;
 
-    invoke-virtual {v6, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v6, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v6
 
-    if-eqz v6, :cond_1b
+    if-eqz v6, :cond_1c
 
     or-int/lit16 v10, v10, 0xe0
 
     iget-object v6, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    const/4 v8, 0x0
+    const/4 v7, 0x0
 
-    iput-object v8, v6, Lcom/android/server/am/ActivityManagerService;->mNativeDebuggingApp:Ljava/lang/String;
+    iput-object v7, v6, Lcom/android/server/am/ActivityManagerService;->mNativeDebuggingApp:Ljava/lang/String;
 
-    goto :goto_c
+    goto :goto_b
 
-    :cond_1b
-    const/4 v8, 0x0
+    :cond_1c
+    const/4 v7, 0x0
 
-    :goto_c
+    :goto_b
     iget-object v6, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
     invoke-virtual {v6}, Landroid/content/pm/ApplicationInfo;->isEmbeddedDexUsed()Z
 
     move-result v6
 
-    if-nez v6, :cond_1c
+    if-nez v6, :cond_1d
 
     iget-object v6, v4, Lcom/android/server/am/ProcessRecord;->processInfo:Landroid/content/pm/ProcessInfo;
 
-    if-eqz v6, :cond_1d
+    if-eqz v6, :cond_1e
 
     iget-boolean v6, v6, Landroid/content/pm/ProcessInfo;->useEmbeddedDex:Z
 
-    if-eqz v6, :cond_1d
+    if-eqz v6, :cond_1e
 
-    :cond_1c
+    :cond_1d
     or-int/lit16 v10, v10, 0x400
 
-    :cond_1d
-    if-nez p4, :cond_1f
+    :cond_1e
+    if-nez p4, :cond_20
 
     iget-object v6, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
@@ -15701,17 +15675,17 @@
 
     iget-boolean v6, v6, Lcom/android/server/am/ActivityManagerService$HiddenApiSettings;->mBlacklistDisabled:Z
 
-    if-nez v6, :cond_1f
+    if-nez v6, :cond_20
 
     iget-object v6, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    iget-object v9, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
+    iget-object v8, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    iget-object v9, v9, Lcom/android/server/am/ActivityManagerService;->mHiddenApiBlacklist:Lcom/android/server/am/ActivityManagerService$HiddenApiSettings;
+    iget-object v8, v8, Lcom/android/server/am/ActivityManagerService;->mHiddenApiBlacklist:Lcom/android/server/am/ActivityManagerService$HiddenApiSettings;
 
-    iget v9, v9, Lcom/android/server/am/ActivityManagerService$HiddenApiSettings;->mPolicy:I
+    iget v8, v8, Lcom/android/server/am/ActivityManagerService$HiddenApiSettings;->mPolicy:I
 
-    invoke-virtual {v6, v9}, Landroid/content/pm/ApplicationInfo;->maybeUpdateHiddenApiEnforcementPolicy(I)V
+    invoke-virtual {v6, v8}, Landroid/content/pm/ApplicationInfo;->maybeUpdateHiddenApiEnforcementPolicy(I)V
 
     iget-object v6, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
@@ -15719,25 +15693,25 @@
 
     move-result v6
 
-    sget v9, Lcom/android/internal/os/Zygote;->API_ENFORCEMENT_POLICY_SHIFT:I
+    sget v8, Lcom/android/internal/os/Zygote;->API_ENFORCEMENT_POLICY_SHIFT:I
 
-    shl-int v9, v6, v9
+    shl-int v8, v6, v8
 
-    and-int/lit16 v11, v9, 0x3000
+    and-int/lit16 v11, v8, 0x3000
 
-    if-ne v11, v9, :cond_1e
+    if-ne v11, v8, :cond_1f
 
-    or-int/2addr v10, v9
+    or-int/2addr v10, v8
 
-    if-eqz p5, :cond_1f
+    if-eqz p5, :cond_20
 
     const/high16 v6, 0x40000
 
     or-int/2addr v10, v6
 
-    goto :goto_d
+    goto :goto_c
 
-    :cond_1e
+    :cond_1f
     new-instance v0, Ljava/lang/IllegalStateException;
 
     new-instance v1, Ljava/lang/StringBuilder;
@@ -15758,46 +15732,46 @@
 
     throw v0
 
-    :cond_1f
-    :goto_d
+    :cond_20
+    :goto_c
     const-string/jumbo v6, "persist.device_config.runtime_native.use_app_image_startup_cache"
 
-    const-string v9, ""
+    const-string v8, ""
 
-    invoke-static {v6, v9}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
+    invoke-static {v6, v8}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
 
     move-result-object v6
 
     invoke-static {v6}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
 
-    move-result v9
+    move-result v8
 
-    if-nez v9, :cond_20
+    if-nez v8, :cond_21
 
-    const-string/jumbo v9, "false"
+    const-string/jumbo v8, "false"
 
-    invoke-virtual {v6, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v6, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v6
 
-    if-nez v6, :cond_20
+    if-nez v6, :cond_21
 
     const/high16 v6, 0x10000
 
     or-int/2addr v10, v6
 
-    :cond_20
+    :cond_21
     sget v6, Landroid/system/OsConstants;->_SC_PAGESIZE:I
 
     invoke-static {v6}, Landroid/system/Os;->sysconf(I)J
 
-    move-result-wide v22
+    move-result-wide v21
 
-    const-wide/16 v24, 0x4000
+    const-wide/16 v23, 0x4000
 
-    cmp-long v6, v22, v24
+    cmp-long v6, v21, v23
 
-    if-nez v6, :cond_21
+    if-nez v6, :cond_22
 
     iget-object v6, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
@@ -15807,22 +15781,22 @@
 
     move-result-object v6
 
-    iget-object v9, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    iget-object v9, v9, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    invoke-virtual {v6, v9}, Landroid/content/pm/PackageManager;->isPageSizeCompatEnabled(Ljava/lang/String;)Z
+    invoke-virtual {v6, v8}, Landroid/content/pm/PackageManager;->isPageSizeCompatEnabled(Ljava/lang/String;)Z
 
     move-result v6
 
-    if-eqz v6, :cond_21
+    if-eqz v6, :cond_22
 
     const/high16 v6, 0x4000000
 
     or-int/2addr v10, v6
 
-    :cond_21
-    if-eqz v1, :cond_23
+    :cond_22
+    if-eqz v1, :cond_24
 
     new-instance v1, Ljava/lang/StringBuilder;
 
@@ -15849,240 +15823,288 @@
     .catch Ljava/lang/RuntimeException; {:try_start_6 .. :try_end_6} :catch_0
 
     :try_start_7
-    new-instance v9, Ljava/io/File;
+    new-instance v8, Ljava/io/File;
 
-    invoke-direct {v9, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V
+    invoke-direct {v8, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v9}, Ljava/io/File;->exists()Z
+    invoke-virtual {v8}, Ljava/io/File;->exists()Z
 
-    move-result v9
+    move-result v8
 
-    if-eqz v9, :cond_22
+    if-eqz v8, :cond_23
 
-    new-instance v9, Ljava/lang/StringBuilder;
+    new-instance v8, Ljava/lang/StringBuilder;
 
-    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V
 
     const-string v11, "/system/bin/logwrapper "
 
-    invoke-virtual {v9, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v8, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v9, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v8, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object v1
     :try_end_7
     .catchall {:try_start_7 .. :try_end_7} :catchall_0
 
-    goto :goto_e
+    goto :goto_d
 
     :catchall_0
     move-exception v0
 
-    goto :goto_f
+    goto :goto_e
 
-    :cond_22
-    move-object v1, v8
+    :cond_23
+    move-object v1, v7
 
-    :goto_e
+    :goto_d
     :try_start_8
     invoke-static {v6}, Landroid/os/StrictMode;->setThreadPolicy(Landroid/os/StrictMode$ThreadPolicy;)V
 
     move-object v13, v1
 
-    goto :goto_10
+    goto :goto_f
 
-    :goto_f
+    :goto_e
     invoke-static {v6}, Landroid/os/StrictMode;->setThreadPolicy(Landroid/os/StrictMode$ThreadPolicy;)V
 
     throw v0
 
-    :cond_23
-    move-object v13, v8
+    :cond_24
+    move-object v13, v7
 
-    :goto_10
-    if-eqz p6, :cond_24
+    :goto_f
+    if-eqz p6, :cond_25
 
     move-object/from16 v1, p6
 
-    goto :goto_11
+    goto :goto_10
 
-    :cond_24
+    :cond_25
     iget-object v1, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
     iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;
 
-    :goto_11
-    if-nez v1, :cond_25
+    :goto_10
+    if-nez v1, :cond_26
 
     sget-object v1, Landroid/os/Build;->SUPPORTED_ABIS:[Ljava/lang/String;
 
-    aget-object v1, v1, v19
+    aget-object v1, v1, v20
 
-    :cond_25
+    :cond_26
     move-object v11, v1
 
     iget-object v1, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
     iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;
 
-    if-eqz v1, :cond_26
+    if-eqz v1, :cond_27
 
     invoke-static {v11}, Ldalvik/system/VMRuntime;->getInstructionSet(Ljava/lang/String;)Ljava/lang/String;
 
     move-result-object v1
 
-    goto :goto_12
+    goto :goto_11
 
-    :cond_26
-    move-object v1, v8
+    :cond_27
+    move-object v1, v7
 
-    :goto_12
+    :goto_11
     iget v6, v4, Lcom/android/server/am/ProcessRecord;->uid:I
 
     invoke-static {v6}, Landroid/os/UserHandle;->getUserId(I)I
 
     move-result v6
+    :try_end_8
+    .catch Ljava/lang/RuntimeException; {:try_start_8 .. :try_end_8} :catch_0
 
-    const/16 v9, 0x4d
+    const/16 v8, 0x4d
 
-    if-ne v6, v9, :cond_2a
+    if-ne v6, v8, :cond_2b
 
+    :try_start_9
     iget-object v6, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    :try_end_9
+    .catch Ljava/lang/RuntimeException; {:try_start_9 .. :try_end_9} :catch_5
 
-    sget-object v9, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;->LOG_DIR:Ljava/io/File;
+    :try_start_a
+    sget-object v8, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;->LOG_DIR:Ljava/io/File;
 
-    if-nez v6, :cond_27
+    if-nez v6, :cond_28
 
-    :goto_13
-    move/from16 v6, v19
+    :goto_12
+    move/from16 v6, v20
 
-    goto :goto_14
+    goto :goto_13
 
-    :cond_27
-    const-string/jumbo v9, "com.samsung.android.app.mobiledoctor"
+    :cond_28
+    const-string/jumbo v8, "com.samsung.android.app.mobiledoctor"
 
-    iget-object v8, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+    iget-object v7, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    invoke-virtual {v9, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v8, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v8
+    move-result v7
 
-    if-nez v8, :cond_28
+    if-nez v7, :cond_29
 
-    goto :goto_13
+    goto :goto_12
 
-    :cond_28
-    const-class v8, Landroid/content/pm/PackageManagerInternal;
+    :cond_29
+    const-class v7, Landroid/content/pm/PackageManagerInternal;
 
-    invoke-static {v8}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
+    invoke-static {v7}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
 
-    move-result-object v8
+    move-result-object v7
 
-    check-cast v8, Landroid/content/pm/PackageManagerInternal;
+    check-cast v7, Landroid/content/pm/PackageManagerInternal;
 
     iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    invoke-virtual {v8, v6}, Landroid/content/pm/PackageManagerInternal;->isPlatformSigned(Ljava/lang/String;)Z
+    invoke-virtual {v7, v6}, Landroid/content/pm/PackageManagerInternal;->isPlatformSigned(Ljava/lang/String;)Z
 
     move-result v6
 
-    :goto_14
-    if-eqz v6, :cond_2a
+    :goto_13
+    if-eqz v6, :cond_2b
 
-    if-nez v0, :cond_29
+    if-nez v0, :cond_2a
 
-    const/16 v20, 0x0
+    move/from16 v8, v20
 
-    goto :goto_15
+    const/16 v21, 0x0
 
-    :cond_29
+    goto :goto_14
+
+    :cond_2a
     array-length v6, v0
 
-    const/16 v21, 0x1
+    const/16 v19, 0x1
 
     add-int/lit8 v6, v6, 0x1
 
     new-array v6, v6, [I
 
-    array-length v8, v0
+    array-length v7, v0
+    :try_end_a
+    .catch Ljava/lang/RuntimeException; {:try_start_a .. :try_end_a} :catch_4
 
-    move/from16 v9, v19
+    move/from16 v8, v20
 
-    invoke-static {v0, v9, v6, v9, v8}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
+    :try_start_b
+    invoke-static {v0, v8, v6, v8, v7}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
 
     array-length v0, v0
 
-    const-string/jumbo v8, "radio"
+    const-string/jumbo v7, "radio"
 
-    invoke-static {v8}, Landroid/os/Process;->getGidForName(Ljava/lang/String;)I
+    invoke-static {v7}, Landroid/os/Process;->getGidForName(Ljava/lang/String;)I
 
-    move-result v8
+    move-result v7
 
-    aput v8, v6, v0
+    aput v7, v6, v0
 
-    move-object/from16 v20, v6
+    move-object/from16 v21, v6
+
+    :goto_14
+    move-object/from16 v6, v21
+
+    goto :goto_17
+
+    :catch_4
+    move-exception v0
+
+    move/from16 v8, v20
 
     :goto_15
-    move-object/from16 v0, v20
+    move-object v1, v5
 
-    :cond_2a
-    iput-object v0, v4, Lcom/android/server/am/ProcessRecord;->mGids:[I
+    move/from16 v20, v8
+
+    goto/16 :goto_1a
+
+    :cond_2b
+    move/from16 v8, v20
+
+    goto :goto_16
+
+    :catch_5
+    move-exception v0
+
+    move/from16 v8, v20
+
+    goto/16 :goto_0
+
+    :goto_16
+    move-object v6, v0
+
+    :goto_17
+    iput-object v6, v4, Lcom/android/server/am/ProcessRecord;->mGids:[I
 
     iput-object v11, v4, Lcom/android/server/am/ProcessRecord;->mRequiredAbi:Ljava/lang/String;
 
-    iget-object v6, v4, Lcom/android/server/am/ProcessRecord;->mWindowProcessController:Lcom/android/server/wm/WindowProcessController;
+    iget-object v0, v4, Lcom/android/server/am/ProcessRecord;->mWindowProcessController:Lcom/android/server/wm/WindowProcessController;
 
-    iput-object v11, v6, Lcom/android/server/wm/WindowProcessController;->mRequiredAbi:Ljava/lang/String;
+    iput-object v11, v0, Lcom/android/server/wm/WindowProcessController;->mRequiredAbi:Ljava/lang/String;
 
     iput-object v1, v4, Lcom/android/server/am/ProcessRecord;->mInstructionSet:Ljava/lang/String;
 
-    iget-object v6, v3, Lcom/android/server/am/HostingRecord;->mDefiningPackageName:Ljava/lang/String;
+    iget-object v0, v3, Lcom/android/server/am/HostingRecord;->mDefiningPackageName:Ljava/lang/String;
 
-    if-eqz v6, :cond_2b
+    if-eqz v0, :cond_2c
 
-    new-instance v6, Landroid/content/pm/ApplicationInfo;
+    new-instance v0, Landroid/content/pm/ApplicationInfo;
 
-    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    iget-object v7, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    invoke-direct {v6, v8}, Landroid/content/pm/ApplicationInfo;-><init>(Landroid/content/pm/ApplicationInfo;)V
+    invoke-direct {v0, v7}, Landroid/content/pm/ApplicationInfo;-><init>(Landroid/content/pm/ApplicationInfo;)V
 
-    iget-object v8, v3, Lcom/android/server/am/HostingRecord;->mDefiningPackageName:Ljava/lang/String;
+    iget-object v7, v3, Lcom/android/server/am/HostingRecord;->mDefiningPackageName:Ljava/lang/String;
 
-    iput-object v8, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+    iput-object v7, v0, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    iput v5, v6, Landroid/content/pm/ApplicationInfo;->uid:I
+    iput v9, v0, Landroid/content/pm/ApplicationInfo;->uid:I
 
-    goto :goto_16
+    goto :goto_18
 
-    :cond_2b
-    iget-object v6, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    :catch_6
+    move-exception v0
 
-    :goto_16
-    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->processInfo:Landroid/content/pm/ProcessInfo;
+    goto :goto_15
 
-    iget-object v9, v2, Lcom/android/server/am/ProcessList;->mPlatformCompat:Lcom/android/server/compat/PlatformCompat;
+    :cond_2c
+    iget-object v0, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    invoke-static {v6, v8, v1, v9}, Lcom/android/internal/os/Zygote;->getMemorySafetyRuntimeFlags(Landroid/content/pm/ApplicationInfo;Landroid/content/pm/ProcessInfo;Ljava/lang/String;Lcom/android/internal/compat/IPlatformCompat;)I
+    :goto_18
+    iget-object v7, v4, Lcom/android/server/am/ProcessRecord;->processInfo:Landroid/content/pm/ProcessInfo;
+    :try_end_b
+    .catch Ljava/lang/RuntimeException; {:try_start_b .. :try_end_b} :catch_6
 
-    move-result v6
+    :try_start_c
+    iget-object v8, v2, Lcom/android/server/am/ProcessList;->mPlatformCompat:Lcom/android/server/compat/PlatformCompat;
 
-    or-int/2addr v6, v10
+    invoke-static {v0, v7, v1, v8}, Lcom/android/internal/os/Zygote;->getMemorySafetyRuntimeFlags(Landroid/content/pm/ApplicationInfo;Landroid/content/pm/ProcessInfo;Ljava/lang/String;Lcom/android/internal/compat/IPlatformCompat;)I
 
-    iget-object v8, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    move-result v0
 
-    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->seInfoUser:Ljava/lang/String;
+    or-int v7, v10, v0
 
-    invoke-static {v8}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
+    iget-object v0, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    move-result v8
+    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->seInfoUser:Ljava/lang/String;
 
-    if-eqz v8, :cond_2c
+    invoke-static {v0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
 
-    const-string/jumbo v8, "SELinux tag not defined"
+    move-result v0
+
+    if-eqz v0, :cond_2d
+
+    const-string/jumbo v0, "SELinux tag not defined"
 
-    new-instance v9, Ljava/lang/IllegalStateException;
+    new-instance v8, Ljava/lang/IllegalStateException;
 
     new-instance v10, Ljava/lang/StringBuilder;
 
@@ -16116,173 +16138,71 @@
 
     move-result-object v1
 
-    invoke-direct {v9, v1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
-
-    invoke-static {v7, v8, v9}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    goto :goto_17
-
-    :cond_2c
-    move-object/from16 v18, v1
-
-    :goto_17
-    invoke-virtual/range {p0 .. p1}, Lcom/android/server/am/ProcessList;->updateSeInfo(Lcom/android/server/am/ProcessRecord;)Ljava/lang/String;
-
-    move-result-object v10
-
-    iget v1, v4, Lcom/android/server/am/ProcessRecord;->userId:I
-
-    invoke-static {v1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_2e
-
-    iget v1, v4, Lcom/android/server/am/ProcessRecord;->userId:I
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARPolicyService()Ljava/util/Optional;
-
-    move-result-object v8
-
-    new-instance v9, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;
-
-    const/4 v3, 0x0
-
-    invoke-direct {v9, v1, v3}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;-><init>(II)V
-
-    invoke-virtual {v8, v9}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object v1
-
-    sget-object v3, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {v1, v3}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Ljava/lang/Boolean;
-
-    invoke-virtual {v1}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_2e
+    invoke-direct {v8, v1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
 
-    iget-object v1, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
+    invoke-static {v5, v0, v8}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    iget-object v1, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    iget-object v3, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
-
-    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
-
-    iget v8, v4, Lcom/android/server/am/ProcessRecord;->userId:I
-
-    invoke-static {v1, v3, v8}, Lcom/android/server/pm/PersonaServiceHelper;->isPackageAllowlistedForDEAccessForDualDAR(Landroid/content/Context;Ljava/lang/String;I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_2e
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v3, "DE Restriction for package "
-
-    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget-object v3, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
-
-    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
-
-    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v7, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    goto :goto_19
 
-    if-nez v0, :cond_2d
+    :catch_7
+    move-exception v0
 
-    const/4 v1, 0x1
+    move-object v1, v5
 
-    new-array v0, v1, [I
+    const/16 v20, 0x0
 
-    goto :goto_18
+    goto :goto_1a
 
     :cond_2d
-    const/4 v1, 0x1
-
-    array-length v3, v0
-
-    add-int/2addr v3, v1
-
-    new-array v3, v3, [I
-
-    array-length v8, v0
-
-    const/4 v9, 0x0
-
-    invoke-static {v0, v9, v3, v9, v8}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
-
-    move-object v0, v3
-
-    :goto_18
-    array-length v3, v0
-
-    sub-int/2addr v3, v1
-
-    const/16 v1, 0x14b4
-
-    aput v1, v0, v3
+    move-object/from16 v18, v1
 
-    iput-object v0, v4, Lcom/android/server/am/ProcessRecord;->mGids:[I
-    :try_end_8
-    .catch Ljava/lang/RuntimeException; {:try_start_8 .. :try_end_8} :catch_0
+    :goto_19
+    invoke-virtual/range {p0 .. p1}, Lcom/android/server/am/ProcessList;->updateSeInfo(Lcom/android/server/am/ProcessRecord;)Ljava/lang/String;
 
-    :cond_2e
-    move-object/from16 v3, p2
+    move-result-object v10
+    :try_end_c
+    .catch Ljava/lang/RuntimeException; {:try_start_c .. :try_end_c} :catch_7
 
     move/from16 v8, p3
 
-    move-object v1, v7
+    move-object v1, v5
+
+    move v5, v9
 
     move v9, v12
 
     move-object/from16 v12, v18
 
-    move v7, v6
-
-    move-object v6, v0
+    const/16 v20, 0x0
 
-    :try_start_9
+    :try_start_d
     invoke-virtual/range {v2 .. v17}, Lcom/android/server/am/ProcessList;->startProcessLocked(Lcom/android/server/am/HostingRecord;Lcom/android/server/am/ProcessRecord;I[IIIILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;JJ)Z
 
     move-result v0
 
     return v0
 
-    :catch_4
+    :catch_8
     move-exception v0
 
-    goto :goto_19
+    goto :goto_1a
 
-    :catch_5
+    :catch_9
     move-exception v0
 
-    move-object v1, v7
+    move-object v1, v5
+
+    move/from16 v20, v8
 
     invoke-virtual {v0}, Landroid/os/RemoteException;->rethrowAsRuntimeException()Ljava/lang/RuntimeException;
 
     move-result-object v0
 
     throw v0
-    :try_end_9
-    .catch Ljava/lang/RuntimeException; {:try_start_9 .. :try_end_9} :catch_4
+    :try_end_d
+    .catch Ljava/lang/RuntimeException; {:try_start_d .. :try_end_d} :catch_8
 
-    :goto_19
+    :goto_1a
     new-instance v3, Ljava/lang/StringBuilder;
 
     const-string v5, "Failure starting process "
@@ -16329,9 +16249,7 @@
 
     invoke-virtual/range {v4 .. v13}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZZZILjava/lang/String;)Z
 
-    const/16 v19, 0x0
-
-    return v19
+    return v20
 .end method
 
 .method public final updateClientActivitiesOrderingLSP(Lcom/android/server/am/ProcessRecord;III)V
diff --git a/smali/com/android/server/am/UserController$$ExternalSyntheticLambda2.smali b/smali/com/android/server/am/UserController$$ExternalSyntheticLambda2.smali
index e001f693e..8144c9757 100644
--- a/smali/com/android/server/am/UserController$$ExternalSyntheticLambda2.smali
+++ b/smali/com/android/server/am/UserController$$ExternalSyntheticLambda2.smali
@@ -155,7 +155,7 @@
 
     invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    goto :goto_0
+    goto/16 :goto_1
 
     :cond_0
     iget v2, p0, Lcom/android/server/am/UserState;->state:I
@@ -192,8 +192,97 @@
 
     move-result-object v3
 
-    invoke-virtual {v3, v1}, Lcom/android/server/pm/UserManagerService;->onBeforeUnlockUser(I)V
+    invoke-virtual {v3, v1}, Lcom/android/server/pm/UserManagerService;->getUserInfo(I)Landroid/content/pm/UserInfo;
+
+    move-result-object v4
+
+    const/4 v6, 0x2
+
+    if-nez v4, :cond_1
+
+    goto :goto_0
+
+    :cond_1
+    sget-object v7, Landroid/content/pm/PackagePartitions;->FINGERPRINT:Ljava/lang/String;
+
+    iget-object v8, v4, Landroid/content/pm/UserInfo;->lastLoggedInFingerprint:Ljava/lang/String;
+
+    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v7
+
+    xor-int/2addr v7, v5
+
+    new-instance v8, Lcom/android/server/utils/TimingsTraceAndSlog;
+
+    invoke-direct {v8}, Lcom/android/server/utils/TimingsTraceAndSlog;-><init>()V
+
+    new-instance v9, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v10, "prepareUserData-"
+
+    invoke-direct {v9, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v9, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v9
+
+    invoke-virtual {v8, v9}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+
+    iget-object v9, v3, Lcom/android/server/pm/UserManagerService;->mUserDataPreparer:Lcom/android/server/pm/UserDataPreparer;
+
+    invoke-virtual {v9, v6, v4}, Lcom/android/server/pm/UserDataPreparer;->prepareUserData(ILandroid/content/pm/UserInfo;)V
+
+    invoke-virtual {v8}, Landroid/util/TimingsTraceLog;->traceEnd()V
+
+    const-class v4, Landroid/os/storage/StorageManagerInternal;
+
+    invoke-static {v4}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object v4
+
+    check-cast v4, Landroid/os/storage/StorageManagerInternal;
+
+    invoke-virtual {v4, v1}, Landroid/os/storage/StorageManagerInternal;->markCeStoragePrepared(I)V
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v9, "reconcileAppsData-"
+
+    invoke-direct {v4, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual {v8, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+
+    iget-object v4, v3, Lcom/android/server/pm/UserManagerService;->mPmInternal:Landroid/content/pm/PackageManagerInternal;
+
+    if-nez v4, :cond_2
+
+    const-class v4, Landroid/content/pm/PackageManagerInternal;
+
+    invoke-static {v4}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object v4
+
+    check-cast v4, Landroid/content/pm/PackageManagerInternal;
+
+    iput-object v4, v3, Lcom/android/server/pm/UserManagerService;->mPmInternal:Landroid/content/pm/PackageManagerInternal;
+
+    :cond_2
+    iget-object v3, v3, Lcom/android/server/pm/UserManagerService;->mPmInternal:Landroid/content/pm/PackageManagerInternal;
 
+    invoke-virtual {v3, v1, v6, v7}, Landroid/content/pm/PackageManagerInternal;->reconcileAppsData(IIZ)V
+
+    invoke-virtual {v8}, Landroid/util/TimingsTraceLog;->traceEnd()V
+
+    :goto_0
     invoke-virtual {v2}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
     iget v2, p0, Lcom/android/server/am/UserState;->state:I
@@ -208,27 +297,25 @@
 
     monitor-enter v2
 
-    const/4 v3, 0x2
-
     :try_start_0
-    invoke-virtual {p0, v5, v3}, Lcom/android/server/am/UserState;->setState(II)Z
+    invoke-virtual {p0, v5, v6}, Lcom/android/server/am/UserState;->setState(II)Z
 
     move-result v3
 
-    if-nez v3, :cond_1
+    if-nez v3, :cond_3
 
     monitor-exit v2
 
-    goto :goto_0
+    goto :goto_1
 
     :catchall_0
     move-exception v0
 
     move-object p0, v0
 
-    goto :goto_1
+    goto :goto_2
 
-    :cond_1
+    :cond_3
     monitor-exit v2
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
@@ -275,10 +362,10 @@
 
     invoke-static {v1, p0, v5, v0, v2}, Lcom/android/server/am/UserController;->showEventLog(IIILjava/lang/String;Ljava/lang/String;)V
 
-    :goto_0
+    :goto_1
     return-void
 
-    :goto_1
+    :goto_2
     :try_start_1
     monitor-exit v2
     :try_end_1
@@ -308,7 +395,7 @@
 
     move-result-object v4
 
-    if-eqz v4, :cond_2
+    if-eqz v4, :cond_4
 
     const-string p0, "ActivityManager"
 
@@ -318,16 +405,16 @@
 
     monitor-exit v3
 
-    goto :goto_3
+    goto :goto_4
 
     :catchall_1
     move-exception v0
 
     move-object p0, v0
 
-    goto :goto_4
+    goto :goto_5
 
-    :cond_2
+    :cond_4
     monitor-exit v3
     :try_end_2
     .catchall {:try_start_2 .. :try_end_2} :catchall_1
@@ -365,19 +452,19 @@
     :try_end_3
     .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0
 
-    if-nez p0, :cond_3
+    if-nez p0, :cond_5
 
-    goto :goto_3
+    goto :goto_4
 
-    :cond_3
+    :cond_5
     const/4 v0, 0x0
 
-    :goto_2
+    :goto_3
     invoke-interface {p0}, Ljava/util/List;->size()I
 
     move-result v2
 
-    if-ge v0, v2, :cond_4
+    if-ge v0, v2, :cond_6
 
     invoke-interface {p0, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
@@ -401,10 +488,10 @@
 
     add-int/lit8 v0, v0, 0x1
 
-    goto :goto_2
+    goto :goto_3
 
-    :cond_4
-    :goto_3
+    :cond_6
+    :goto_4
     return-void
 
     :catch_0
@@ -418,7 +505,7 @@
 
     throw p0
 
-    :goto_4
+    :goto_5
     :try_start_4
     monitor-exit v3
     :try_end_4
diff --git a/smali/com/android/server/am/UserController$$ExternalSyntheticLambda4.smali b/smali/com/android/server/am/UserController$$ExternalSyntheticLambda4.smali
index 7a3dcd7ea..bee98cca9 100644
--- a/smali/com/android/server/am/UserController$$ExternalSyntheticLambda4.smali
+++ b/smali/com/android/server/am/UserController$$ExternalSyntheticLambda4.smali
@@ -599,48 +599,11 @@
 
     invoke-virtual {v5, v9}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    invoke-static {v12}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_e
-
-    invoke-static {v12}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncrypted(I)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_e
-
-    invoke-virtual {v2}, Landroid/content/pm/UserInfo;->isInitialized()Z
-
-    move-result v4
-
-    if-eqz v4, :cond_e
-
-    iget-object v4, v1, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    invoke-static {v4}, Lcom/android/server/am/DualDarUserController;->getInstance(Lcom/android/server/am/UserController$Injector;)Lcom/android/server/am/DualDarUserController;
-
-    move-result-object v4
-
-    iget-object v4, v4, Lcom/android/server/am/DualDarUserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    iget-object v4, v4, Lcom/android/server/am/UserController$Injector;->mService:Lcom/android/server/am/ActivityManagerService;
-
-    iget-object v4, v4, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v4}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v4
-
-    invoke-virtual {v4, v12}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onUserStart(I)V
-
-    :cond_e
     const-string/jumbo v4, "sendMessages"
 
     invoke-virtual {v8, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
-    if-eqz v11, :cond_f
+    if-eqz v11, :cond_e
 
     iget-object v4, v1, Lcom/android/server/am/UserController;->mHandler:Landroid/os/Handler;
 
@@ -690,23 +653,23 @@
 
     goto :goto_7
 
-    :cond_f
+    :cond_e
     move-object/from16 p0, v8
 
     :goto_7
     iget-boolean v2, v2, Landroid/content/pm/UserInfo;->preCreated:Z
 
-    if-eqz v2, :cond_10
+    if-eqz v2, :cond_f
 
     const/4 v4, 0x0
 
     goto :goto_8
 
-    :cond_10
+    :cond_f
     move v4, v10
 
     :goto_8
-    if-nez v12, :cond_11
+    if-nez v12, :cond_10
 
     iget-object v2, v1, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
 
@@ -716,27 +679,27 @@
 
     move-result v2
 
-    if-eqz v2, :cond_11
+    if-eqz v2, :cond_10
 
     const/4 v9, 0x1
 
     goto :goto_9
 
-    :cond_11
+    :cond_10
     const/4 v9, 0x0
 
     :goto_9
-    if-nez v4, :cond_12
+    if-nez v4, :cond_11
 
-    if-eqz v9, :cond_13
+    if-eqz v9, :cond_12
 
-    :cond_12
+    :cond_11
     invoke-virtual {v1, v12, v6, v0}, Lcom/android/server/am/UserController;->sendUserStartedBroadcast(III)V
 
-    :cond_13
+    :cond_12
     invoke-virtual/range {p0 .. p0}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
-    if-eqz v11, :cond_14
+    if-eqz v11, :cond_13
 
     const-string/jumbo v2, "moveUserToForeground"
 
@@ -750,7 +713,7 @@
 
     goto :goto_a
 
-    :cond_14
+    :cond_13
     move-object/from16 v3, p0
 
     const-string/jumbo v2, "finishUserBoot"
@@ -764,16 +727,16 @@
     invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
     :goto_a
-    if-nez v4, :cond_16
+    if-nez v4, :cond_15
 
-    if-eqz v9, :cond_15
+    if-eqz v9, :cond_14
 
     goto :goto_b
 
-    :cond_15
+    :cond_14
     return-void
 
-    :cond_16
+    :cond_15
     :goto_b
     const-string/jumbo v2, "sendRestartBroadcast"
 
diff --git a/smali/com/android/server/am/UserController.smali b/smali/com/android/server/am/UserController.smali
index 174dffdb7..0d679da87 100644
--- a/smali/com/android/server/am/UserController.smali
+++ b/smali/com/android/server/am/UserController.smali
@@ -1767,7 +1767,7 @@
     :catchall_0
     move-exception p0
 
-    goto/16 :goto_4
+    goto/16 :goto_2
 
     :cond_0
     monitor-exit v1
@@ -1903,9 +1903,9 @@
 
     invoke-virtual {v2, v5, v0, v4}, Landroid/os/Handler;->obtainMessage(III)Landroid/os/Message;
 
-    move-result-object v5
+    move-result-object v4
 
-    invoke-virtual {v2, v5}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z
+    invoke-virtual {v2, v4}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z
 
     iget-boolean v2, p0, Lcom/android/server/am/UserController;->mAllowUserUnlocking:Z
 
@@ -1918,9 +1918,9 @@
 
     const-string/jumbo v2, "finishUserBoot"
 
-    const-string/jumbo v5, "send LOCKED BOOT COMPLETED"
+    const-string/jumbo v4, "send LOCKED BOOT COMPLETED"
 
-    invoke-static {v0, p2, v1, v2, v5}, Lcom/android/server/am/UserController;->showEventLog(IIILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {v0, p2, v1, v2, v4}, Lcom/android/server/am/UserController;->showEventLog(IIILjava/lang/String;Ljava/lang/String;)V
 
     :cond_4
     iget-object p2, p0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
@@ -1937,7 +1937,7 @@
 
     invoke-virtual {p0, v0}, Lcom/android/server/am/UserController;->maybeUnlockUser(I)V
 
-    goto/16 :goto_3
+    goto :goto_1
 
     :cond_5
     iget v1, p2, Landroid/content/pm/UserInfo;->id:I
@@ -1946,7 +1946,7 @@
 
     move-result v1
 
-    if-eqz v1, :cond_e
+    if-eqz v1, :cond_6
 
     const-string v1, "ActivityManager"
 
@@ -1958,285 +1958,25 @@
 
     move-result-object v2
 
-    iget v3, p2, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v3, "): attempting unlock because parent is unlocked"
-
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v1, v2}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {v0}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_d
-
-    iget-object v1, p0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    invoke-static {v1}, Lcom/android/server/am/DualDarUserController;->getInstance(Lcom/android/server/am/UserController$Injector;)Lcom/android/server/am/DualDarUserController;
-
-    move-result-object v1
-
     iget p2, p2, Landroid/content/pm/UserInfo;->id:I
 
-    iget-object v1, v1, Lcom/android/server/am/DualDarUserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    iget-object v2, v1, Lcom/android/server/am/UserController$Injector;->mService:Lcom/android/server/am/ActivityManagerService;
-
-    iget-object v2, v2, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    const-class v3, Landroid/app/KeyguardManager;
-
-    invoke-virtual {v2, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Landroid/app/KeyguardManager;
-
-    new-array v3, v4, [Ljava/lang/Object;
-
-    const-string/jumbo v5, "fetchOuterLayerKey()"
-
-    const-string v6, "DualDAR::DualDarUserController"
-
-    invoke-static {v6, v5, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const/4 v3, 0x0
-
-    :try_start_2
-    iget-object v5, v1, Lcom/android/server/am/UserController$Injector;->mService:Lcom/android/server/am/ActivityManagerService;
-
-    iget-object v5, v5, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v5}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v5
-
-    invoke-virtual {v5, v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->fetchOuterLayerKey(I)[B
-
-    move-result-object v5
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_1
-
-    goto :goto_1
-
-    :catch_1
-    move-exception v5
-
-    new-instance v7, Ljava/lang/StringBuilder;
-
-    const-string v8, "Exception in fetchOuterLayerKey() : "
-
-    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v5}, Ljava/lang/Exception;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    new-array v7, v4, [Ljava/lang/Object;
-
-    invoke-static {v6, v5, v7}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    move-object v5, v3
-
-    :goto_1
-    if-eqz v5, :cond_b
-
-    const-string/jumbo p2, "Trying to unlock DualDAR user after userStart "
-
-    invoke-static {v0, p2}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p2
-
-    new-array v5, v4, [Ljava/lang/Object;
-
-    invoke-static {v6, p2, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    sget-object p2, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->getCurrentState(I)Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    move-result-object v5
-
-    sget-object v7, Lcom/samsung/android/knox/dar/ddar/fsm/State;->DEVICE_UNLOCK_DATA_UNLOCK:Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    if-ne v5, v7, :cond_6
-
-    const-string/jumbo p2, "Password2Auth has already been completed for: "
-
-    invoke-static {v0, p2}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p2
-
-    new-array v1, v4, [Ljava/lang/Object;
-
-    invoke-static {v6, p2, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    sget-object p2, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    goto :goto_2
-
-    :cond_6
-    invoke-virtual {v2, v0}, Landroid/app/KeyguardManager;->isDeviceSecure(I)Z
-
-    move-result v2
-
-    if-nez v2, :cond_9
-
-    const-string v2, "Do Password2Auth with null credential for: "
-
-    invoke-static {v0, v2}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v2
-
-    new-array v5, v4, [Ljava/lang/Object;
-
-    invoke-static {v6, v2, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-array v2, v4, [Ljava/lang/Object;
-
-    const-string/jumbo v5, "onPassword2Auth()"
-
-    invoke-static {v6, v5, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-static {v0}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v2
-
-    if-nez v2, :cond_7
-
-    const-string/jumbo p2, "User is not DualDAR eligible. so no need to verify DualDAR Passwords"
-
-    invoke-static {v0, p2}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p2
-
-    new-array v1, v4, [Ljava/lang/Object;
-
-    invoke-static {v6, p2, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    sget-object p2, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    goto :goto_2
-
-    :cond_7
-    iget-object v1, v1, Lcom/android/server/am/UserController$Injector;->mService:Lcom/android/server/am/ActivityManagerService;
-
-    iget-object v1, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v1
-
-    invoke-virtual {v1, v0, v3}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Auth(I[B)Z
-
-    move-result v1
-
-    if-nez v1, :cond_8
-
-    const-string v1, "Authentication Failure by dual dar client"
-
-    new-array v2, v4, [Ljava/lang/Object;
-
-    invoke-static {v6, v1, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto :goto_2
-
-    :cond_8
-    const-string/jumbo p2, "onPassword2Auth completed successfully"
-
-    new-array v1, v4, [Ljava/lang/Object;
-
-    invoke-static {v6, p2, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    sget-object p2, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v0, p2}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    sget-object p2, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    :cond_9
-    :goto_2
-    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    if-ne p2, v1, :cond_a
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result p2
+    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    if-nez p2, :cond_a
+    const-string p2, "): attempting unlock because parent is unlocked"
 
-    const-string/jumbo p2, "fetch outer layer key and unlock DualDAR user "
+    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-static {v0, p2}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object p2
 
-    new-array v1, v4, [Ljava/lang/Object;
-
-    invoke-static {v6, p2, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0, v0}, Lcom/android/server/am/UserController;->maybeUnlockUser(I)V
-
-    goto :goto_3
-
-    :cond_a
-    const-string p0, "Default Authentication Failure by DualDAR client"
-
-    new-array p2, v4, [Ljava/lang/Object;
-
-    invoke-static {v6, p0, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto :goto_3
-
-    :cond_b
-    invoke-virtual {v2, p2}, Landroid/app/KeyguardManager;->isDeviceLocked(I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_c
-
-    const-string/jumbo p0, "This should theoretically never happen. Failed to unlock DualDAR user: "
-
-    const-string p2, " something went wrong while fetching OLK event though user0 is unlocked."
-
-    invoke-static {v0, p0, p2}, Lcom/android/server/BinaryTransparencyService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p2, v4, [Ljava/lang/Object;
-
-    invoke-static {v6, p0, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_c
-    const-string p0, "Device is still locked. Do not unlock DualDAR user, yet"
-
-    new-array p2, v4, [Ljava/lang/Object;
-
-    invoke-static {v6, p0, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto :goto_3
+    invoke-static {v1, p2}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_d
     invoke-virtual {p0, v0}, Lcom/android/server/am/UserController;->maybeUnlockUser(I)V
 
-    goto :goto_3
+    goto :goto_1
 
-    :cond_e
+    :cond_6
     const-string p0, "ActivityManager"
 
     const-string/jumbo v1, "User "
@@ -2261,7 +2001,7 @@
 
     invoke-static {p0, p2}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_3
+    :goto_1
     iget p0, p1, Lcom/android/server/am/UserState;->state:I
 
     const-string/jumbo p1, "finishUserBoot"
@@ -2274,11 +2014,11 @@
 
     return-void
 
-    :goto_4
-    :try_start_3
+    :goto_2
+    :try_start_2
     monitor-exit v1
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
     throw p0
 .end method
@@ -2924,11 +2664,11 @@
     goto :goto_6
 
     :cond_d
-    iget-object v3, v0, Lcom/android/server/am/UserController;->mPendingUserStarts:Ljava/util/List;
+    iget-object v0, v0, Lcom/android/server/am/UserController;->mPendingUserStarts:Ljava/util/List;
 
-    check-cast v3, Ljava/util/ArrayList;
+    check-cast v0, Ljava/util/ArrayList;
 
-    invoke-virtual {v3, v2}, Ljava/util/ArrayList;->removeAll(Ljava/util/Collection;)Z
+    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->removeAll(Ljava/util/Collection;)Z
 
     monitor-exit v1
 
@@ -2978,37 +2718,12 @@
 
     if-eqz v1, :cond_f
 
-    iget-object v2, v0, Lcom/android/server/am/UserController;->mHandler:Landroid/os/Handler;
+    iget-object v0, v0, Lcom/android/server/am/UserController;->mHandler:Landroid/os/Handler;
 
-    invoke-virtual {v2, v7, v1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
+    invoke-virtual {v0, v7, v1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
 
     :cond_f
     :goto_7
-    invoke-static {v4}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_10
-
-    iget-object v0, v0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    invoke-static {v0}, Lcom/android/server/am/DualDarUserController;->getInstance(Lcom/android/server/am/UserController$Injector;)Lcom/android/server/am/DualDarUserController;
-
-    move-result-object v0
-
-    iget-object v0, v0, Lcom/android/server/am/DualDarUserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    iget-object v0, v0, Lcom/android/server/am/UserController$Injector;->mService:Lcom/android/server/am/ActivityManagerService;
-
-    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v0
-
-    invoke-virtual {v0, v4}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onUserStopped(I)V
-
-    :cond_10
     return-void
 
     :goto_8
diff --git a/smali/com/android/server/devicepolicy/DevicePolicyManagerService.smali b/smali/com/android/server/devicepolicy/DevicePolicyManagerService.smali
index 6798bf57a..afdd74077 100644
--- a/smali/com/android/server/devicepolicy/DevicePolicyManagerService.smali
+++ b/smali/com/android/server/devicepolicy/DevicePolicyManagerService.smali
@@ -4902,20 +4902,16 @@
 
     invoke-static {}, Landroid/app/admin/DevicePolicyManager;->invalidateBinderCaches()V
 
-    iget-object v0, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mUserManagerInternal:Lcom/android/server/pm/UserManagerInternal;
-
-    new-instance v3, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
+    new-instance v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
 
-    iget-object v4, v2, Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;->mContext:Landroid/content/Context;
+    iget-object v2, v2, Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;->mContext:Landroid/content/Context;
 
-    invoke-direct {v3, v4, v0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;-><init>(Landroid/content/Context;Lcom/android/server/pm/UserManagerInternal;)V
+    invoke-direct {v0, v2}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;-><init>(Landroid/content/Context;)V
 
-    iput-object v3, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mDualDarProvisioningHelper:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
+    iput-object v0, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mDualDarProvisioningHelper:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
 
     new-instance v0, Lcom/android/server/devicepolicy/UCMProvisioningHelper;
 
-    iget-object v2, v2, Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;->mContext:Landroid/content/Context;
-
     invoke-direct {v0, v2}, Lcom/android/server/devicepolicy/UCMProvisioningHelper;-><init>(Landroid/content/Context;)V
 
     iput-object v0, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mUCMProvisioningHelper:Lcom/android/server/devicepolicy/UCMProvisioningHelper;
@@ -13337,48 +13333,8 @@
 
     iget-object p0, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mDualDarProvisioningHelper:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
 
-    iget-object v1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v2
-
-    invoke-static {v1, v2}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object p1
-
-    invoke-static {p0, p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARNativeCrypto(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_3
-
-    const p0, 0x2000040
-
-    :goto_3
-    move v7, p0
-
-    goto :goto_4
-
-    :cond_3
-    const p0, 0x4000040
-
-    goto :goto_3
-
-    :cond_4
-    const/16 p0, 0x40
-
-    goto :goto_3
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :goto_4
     invoke-interface {v0}, Ljava/util/Set;->size()I
 
     move-result p0
@@ -13395,6 +13351,8 @@
 
     const-string/jumbo v6, "android.os.usertype.profile.MANAGED"
 
+    const/16 v7, 0x40
+
     move v8, p2
 
     invoke-virtual/range {v4 .. v9}, Landroid/os/UserManager;->createProfileForUserEvenWhenDisallowed(Ljava/lang/String;Ljava/lang/String;II[Ljava/lang/String;)Landroid/content/pm/UserInfo;
@@ -16489,572 +16447,333 @@
 .end method
 
 .method public final finalizeCreateManagedProfileInternal(Landroid/app/admin/ManagedProfileProvisioningParams;Landroid/os/UserHandle;)V
-    .locals 20
-
-    move-object/from16 v1, p0
-
-    const/4 v2, 0x0
-
-    const/4 v3, 0x1
-
-    invoke-virtual/range {p2 .. p2}, Landroid/os/UserHandle;->getIdentifier()I
-
-    move-result v4
-
-    iget-object v6, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mDualDarProvisioningHelper:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object v0, v6, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v5
-
-    invoke-static {v0, v5}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v0
-
-    const/4 v12, 0x2
-
-    if-eqz v0, :cond_3
-
-    new-instance v9, Ljava/lang/Object;
-
-    invoke-direct {v9}, Ljava/lang/Object;-><init>()V
-
-    new-array v10, v3, [Z
-
-    aput-boolean v2, v10, v2
-
-    new-array v7, v3, [Z
-
-    new-array v8, v3, [I
-
-    new-instance v5, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;
-
-    const/4 v11, 0x1
-
-    invoke-direct/range {v5 .. v11}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;-><init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[ZI)V
-
-    const-string/jumbo v0, "com.android.dualdar.completed.provisioning_success"
-
-    const-string/jumbo v11, "com.android.dualdar.completed.cancelled"
-
-    const-string/jumbo v13, "com.android.dualdar.completed.error"
-
-    invoke-static {v0, v11, v13}, Lcom/android/server/alarm/GmsAlarmManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
-
-    move-result-object v0
-
-    iget-object v11, v6, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v11, v5, v0, v12}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
-
-    monitor-enter v9
-
-    :try_start_0
-    const-string v0, "DualDarProvisioningHelper"
-
-    const-string/jumbo v5, "Starting Knox DUAL DAR DualDar Completed Service"
-
-    invoke-static {v0, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v0, Landroid/content/Intent;
-
-    invoke-direct {v0}, Landroid/content/Intent;-><init>()V
-
-    new-instance v5, Landroid/content/ComponentName;
-
-    const-string/jumbo v11, "com.samsung.android.knox.containercore"
-
-    const-string/jumbo v13, "com.samsung.android.knox.containercore.provisioning.DualDarCompletedService"
-
-    invoke-direct {v5, v11, v13}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v0, v5}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
-
-    const-string/jumbo v5, "android.intent.extra.user_handle"
-
-    invoke-virtual {v0, v5, v4}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    const-string v5, "DUAL_DAR_PARAMS"
-
-    iget-object v11, v6, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v13
-
-    invoke-static {v11, v13}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARConfigParams(Landroid/content/Context;Landroid/os/PersistableBundle;)Landroid/os/Bundle;
-
-    move-result-object v11
-
-    invoke-virtual {v0, v5, v11}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Bundle;)Landroid/content/Intent;
-
-    const-string v5, "DualDARServiceEventFlag"
-
-    const/16 v11, 0x1f4
-
-    invoke-virtual {v0, v5, v11}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getProfileAdminComponentName()Landroid/content/ComponentName;
-
-    move-result-object v5
-
-    const-string v11, "DUAL_DAR_ADMIN_PACKAGE"
-
-    invoke-virtual {v5}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-virtual {v0, v11, v5}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
-
-    const-string v5, "DUAL_DAR_INTENT_PROVISIONING"
-
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v11
-
-    invoke-static {v11}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARIntentProvisioned(Landroid/os/PersistableBundle;)Z
-
-    move-result v11
-
-    invoke-virtual {v0, v5, v11}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    const-string v5, "DUAL_DAR_IS_WPCOD"
-
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->isOrganizationOwnedProvisioning()Z
-
-    move-result v11
-
-    invoke-virtual {v0, v5, v11}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    iget-object v5, v6, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v11
-
-    invoke-static {v5, v11}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARNativeCrypto(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v5
-
-    if-eqz v5, :cond_0
-
-    const-string v5, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v11, 0x2000000
-
-    invoke-virtual {v0, v5, v11}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    goto :goto_3
-
-    :catch_0
-    move-exception v0
-
-    goto :goto_2
-
-    :cond_0
-    const-string v5, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v11, 0x4000000
-
-    invoke-virtual {v0, v5, v11}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    :goto_0
-    invoke-virtual {v6, v0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->startProvisionService(Landroid/content/Intent;)V
-
-    :goto_1
-    aget-boolean v0, v10, v2
-
-    if-nez v0, :cond_1
-
-    invoke-virtual {v9}, Ljava/lang/Object;->wait()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_1
-
-    :goto_2
-    :try_start_1
-    const-string v5, "DualDarProvisioningHelper"
-
-    new-instance v6, Ljava/lang/StringBuilder;
-
-    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v10, "Error during onCreateAndProvisionManagedProfileCompleted"
-
-    invoke-virtual {v6, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v5, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_1
-    monitor-exit v9
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    aget-boolean v0, v7, v2
-
-    if-eqz v0, :cond_2
-
-    goto :goto_4
-
-    :cond_2
-    new-instance v0, Landroid/os/ServiceSpecificException;
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "onCreateAndProvisionManagedProfileCompleted failed with result: "
-
-    invoke-direct {v1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    aget v2, v8, v2
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    .locals 13
 
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    const/4 v0, 0x1
 
-    move-result-object v1
+    const/4 v1, 0x0
 
-    invoke-direct {v0, v12, v1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
+    invoke-virtual {p2}, Landroid/os/UserHandle;->getIdentifier()I
 
-    throw v0
+    move-result v2
 
-    :goto_3
-    :try_start_2
-    monitor-exit v9
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+    iget-object v3, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mDualDarProvisioningHelper:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
 
-    throw v0
+    invoke-virtual {v3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :cond_3
-    :goto_4
-    iget-object v14, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mUCMProvisioningHelper:Lcom/android/server/devicepolicy/UCMProvisioningHelper;
+    iget-object v5, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mUCMProvisioningHelper:Lcom/android/server/devicepolicy/UCMProvisioningHelper;
 
-    invoke-virtual {v14}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string v5, " package "
+    const-string v3, " package "
 
-    const-string/jumbo v0, "UCMProvisioningHelper"
+    const-string/jumbo v4, "UCMProvisioningHelper"
 
     const-string/jumbo v6, "onCreateAndProvisioningManagedProfileCompletedForUCM"
 
-    invoke-static {v0, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-object v0, v14, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->mContext:Landroid/content/Context;
+    iget-object v4, v5, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->mContext:Landroid/content/Context;
 
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
+    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
 
     move-result-object v6
 
-    invoke-static {v0, v6}, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->isUCMConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
+    invoke-static {v4, v6}, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->isUCMConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
 
-    move-result v0
-
-    if-eqz v0, :cond_7
-
-    new-instance v17, Ljava/lang/Object;
+    move-result v4
 
-    invoke-direct/range {v17 .. v17}, Ljava/lang/Object;-><init>()V
+    if-eqz v4, :cond_3
 
-    new-array v6, v3, [Z
+    new-instance v8, Ljava/lang/Object;
 
-    aput-boolean v2, v6, v2
+    invoke-direct {v8}, Ljava/lang/Object;-><init>()V
 
-    new-array v15, v3, [Z
+    new-array v9, v0, [Z
 
-    new-array v3, v3, [I
+    aput-boolean v1, v9, v1
 
-    new-instance v13, Lcom/android/server/devicepolicy/UCMProvisioningHelper$1;
+    new-array v6, v0, [Z
 
-    const/16 v19, 0x1
+    new-array v7, v0, [I
 
-    move-object/from16 v16, v3
+    new-instance v4, Lcom/android/server/devicepolicy/UCMProvisioningHelper$1;
 
-    move-object/from16 v18, v6
+    const/4 v10, 0x1
 
-    invoke-direct/range {v13 .. v19}, Lcom/android/server/devicepolicy/UCMProvisioningHelper$1;-><init>(Lcom/android/server/devicepolicy/UCMProvisioningHelper;[Z[ILjava/lang/Object;[ZI)V
+    invoke-direct/range {v4 .. v10}, Lcom/android/server/devicepolicy/UCMProvisioningHelper$1;-><init>(Lcom/android/server/devicepolicy/UCMProvisioningHelper;[Z[ILjava/lang/Object;[ZI)V
 
     const-string/jumbo v0, "com.samsung.android.knox.ucm.action.UCM_COMPLETED_PROVISIONING_SUCCESS"
 
-    const-string/jumbo v3, "com.samsung.android.knox.ucm.action.UCM_COMPLETED_PROVISIONING_CANCELLED"
+    const-string/jumbo v10, "com.samsung.android.knox.ucm.action.UCM_COMPLETED_PROVISIONING_CANCELLED"
 
-    const-string/jumbo v6, "com.samsung.android.knox.ucm.action.UCM_COMPLETED_PROVISIONING_ERROR"
+    const-string/jumbo v11, "com.samsung.android.knox.ucm.action.UCM_COMPLETED_PROVISIONING_ERROR"
 
-    invoke-static {v0, v3, v6}, Lcom/android/server/alarm/GmsAlarmManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
+    invoke-static {v0, v10, v11}, Lcom/android/server/alarm/GmsAlarmManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
 
     move-result-object v0
 
-    iget-object v3, v14, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->mContext:Landroid/content/Context;
+    iget-object v10, v5, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v3, v13, v0, v12}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
+    const/4 v11, 0x2
 
-    monitor-enter v17
+    invoke-virtual {v10, v4, v0, v11}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
 
-    :try_start_3
+    monitor-enter v8
+
+    :try_start_0
     const-string/jumbo v0, "UCMProvisioningHelper"
 
-    const-string/jumbo v3, "Starting Knox UCM Completed Service"
+    const-string/jumbo v4, "Starting Knox UCM Completed Service"
 
-    invoke-static {v0, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    new-instance v3, Landroid/content/Intent;
+    new-instance v4, Landroid/content/Intent;
 
-    invoke-direct {v3}, Landroid/content/Intent;-><init>()V
+    invoke-direct {v4}, Landroid/content/Intent;-><init>()V
 
     new-instance v0, Landroid/content/ComponentName;
 
-    const-string/jumbo v6, "com.samsung.android.knox.containercore"
+    const-string/jumbo v10, "com.samsung.android.knox.containercore"
 
-    const-string/jumbo v7, "com.samsung.android.knox.containercore.provisioning.UCMCompletedService"
+    const-string/jumbo v12, "com.samsung.android.knox.containercore.provisioning.UCMCompletedService"
 
-    invoke-direct {v0, v6, v7}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-direct {v0, v10, v12}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
 
-    invoke-virtual {v3, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
+    invoke-virtual {v4, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
 
     const-string/jumbo v0, "android.intent.extra.user_handle"
 
-    invoke-virtual {v3, v0, v4}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
+    invoke-virtual {v4, v0, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
 
     const-string/jumbo v0, "UCM_DAR_PARAMS"
 
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
+    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
 
-    move-result-object v4
+    move-result-object v2
 
-    invoke-static {v4}, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->getUCMConfigParams(Landroid/os/PersistableBundle;)Landroid/os/Bundle;
+    invoke-static {v2}, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->getUCMConfigParams(Landroid/os/PersistableBundle;)Landroid/os/Bundle;
 
-    move-result-object v4
+    move-result-object v2
 
-    invoke-virtual {v3, v0, v4}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Bundle;)Landroid/content/Intent;
-    :try_end_3
-    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    invoke-virtual {v4, v0, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Bundle;)Landroid/content/Intent;
+    :try_end_0
+    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_2
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    const/4 v4, 0x0
+    const/4 v2, 0x0
 
-    :try_start_4
+    :try_start_1
     const-string/jumbo v0, "UCM_DAR_PARAMS"
 
-    invoke-virtual {v3, v0}, Landroid/content/Intent;->getBundleExtra(Ljava/lang/String;)Landroid/os/Bundle;
+    invoke-virtual {v4, v0}, Landroid/content/Intent;->getBundleExtra(Ljava/lang/String;)Landroid/os/Bundle;
 
     move-result-object v0
 
-    const-string/jumbo v6, "ucm-config-client-package"
+    const-string/jumbo v10, "ucm-config-client-package"
 
-    invoke-virtual {v0, v6}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
+    invoke-virtual {v0, v10}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v6
-    :try_end_4
-    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_2
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
+    move-result-object v10
+    :try_end_1
+    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :try_start_5
+    :try_start_2
     const-string/jumbo v0, "UCM_DAR_PARAMS"
 
-    invoke-virtual {v3, v0}, Landroid/content/Intent;->getBundleExtra(Ljava/lang/String;)Landroid/os/Bundle;
+    invoke-virtual {v4, v0}, Landroid/content/Intent;->getBundleExtra(Ljava/lang/String;)Landroid/os/Bundle;
 
     move-result-object v0
 
-    const-string/jumbo v7, "ucm-config-client-location"
+    const-string/jumbo v12, "ucm-config-client-location"
 
-    invoke-virtual {v0, v7}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
+    invoke-virtual {v0, v12}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v4
-    :try_end_5
-    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_1
-    .catchall {:try_start_5 .. :try_end_5} :catchall_1
+    move-result-object v2
+    :try_end_2
+    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0
+    .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    goto :goto_6
+    goto :goto_1
 
-    :catchall_1
+    :catchall_0
     move-exception v0
 
-    goto/16 :goto_9
+    move-object p0, v0
 
-    :catch_1
+    goto/16 :goto_4
+
+    :catch_0
     move-exception v0
 
-    goto :goto_5
+    goto :goto_0
 
-    :catch_2
+    :catch_1
     move-exception v0
 
-    move-object v6, v4
+    move-object v10, v2
 
-    :goto_5
-    :try_start_6
+    :goto_0
+    :try_start_3
     invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
 
-    :goto_6
+    :goto_1
     const-string/jumbo v0, "UCMProvisioningHelper"
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    new-instance v12, Ljava/lang/StringBuilder;
 
-    invoke-direct {v7, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v12, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v12, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string v5, " URLlocation "
+    const-string v3, " URLlocation "
 
-    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v12, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v12, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v2
 
-    invoke-static {v0, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-object v0, v14, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->mContext:Landroid/content/Context;
+    iget-object v0, v5, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->mContext:Landroid/content/Context;
 
-    iget-object v4, v14, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->connection:Lcom/android/server/devicepolicy/UCMProvisioningHelper$3;
+    iget-object v2, v5, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->connection:Lcom/android/server/devicepolicy/UCMProvisioningHelper$3;
 
-    const/16 v5, 0x41
+    const/16 v3, 0x41
 
-    invoke-virtual {v0, v3, v4, v5}, Landroid/content/Context;->bindService(Landroid/content/Intent;Landroid/content/ServiceConnection;I)Z
+    invoke-virtual {v0, v4, v2, v3}, Landroid/content/Context;->bindService(Landroid/content/Intent;Landroid/content/ServiceConnection;I)Z
 
     move-result v0
 
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_0
 
-    :goto_7
-    aget-boolean v0, v18, v2
+    :goto_2
+    aget-boolean v0, v9, v1
 
-    if-nez v0, :cond_5
+    if-nez v0, :cond_1
 
-    invoke-virtual/range {v17 .. v17}, Ljava/lang/Object;->wait()V
+    invoke-virtual {v8}, Ljava/lang/Object;->wait()V
 
-    goto :goto_7
+    goto :goto_2
 
-    :catch_3
+    :catch_2
     move-exception v0
 
-    goto :goto_8
+    goto :goto_3
 
-    :cond_4
+    :cond_0
     new-instance v0, Ljava/lang/Exception;
 
-    const-string/jumbo v3, "startProvisionService : failed to startService."
+    const-string/jumbo v2, "startProvisionService : failed to startService."
 
-    invoke-direct {v0, v3}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v2}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
 
     throw v0
-    :try_end_6
-    .catch Ljava/lang/Exception; {:try_start_6 .. :try_end_6} :catch_3
-    .catchall {:try_start_6 .. :try_end_6} :catchall_1
+    :try_end_3
+    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_2
+    .catchall {:try_start_3 .. :try_end_3} :catchall_0
 
-    :goto_8
-    :try_start_7
-    const-string/jumbo v3, "UCMProvisioningHelper"
+    :goto_3
+    :try_start_4
+    const-string/jumbo v2, "UCMProvisioningHelper"
 
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v3, Ljava/lang/StringBuilder;
 
-    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
 
-    const-string v5, "Error during onCreateAndProvisionManagedProfileCompleted"
+    const-string v4, "Error during onCreateAndProvisionManagedProfileCompleted"
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object v0
 
-    invoke-static {v3, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_5
-    monitor-exit v17
-    :try_end_7
-    .catchall {:try_start_7 .. :try_end_7} :catchall_1
+    :cond_1
+    monitor-exit v8
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_0
 
-    aget-boolean v0, v15, v2
+    aget-boolean v0, v6, v1
 
-    if-eqz v0, :cond_6
+    if-eqz v0, :cond_2
 
-    goto :goto_a
+    goto :goto_5
 
-    :cond_6
-    new-instance v0, Landroid/os/ServiceSpecificException;
+    :cond_2
+    new-instance p0, Landroid/os/ServiceSpecificException;
 
-    new-instance v1, Ljava/lang/StringBuilder;
+    new-instance p1, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v3, "onCreateAndProvisionManagedProfileCompleted failed with result: "
+    const-string/jumbo p2, "onCreateAndProvisionManagedProfileCompleted failed with result: "
 
-    invoke-direct {v1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    aget v2, v16, v2
+    aget p2, v7, v1
 
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v1
+    move-result-object p1
 
-    invoke-direct {v0, v12, v1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
+    invoke-direct {p0, v11, p1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
 
-    throw v0
+    throw p0
 
-    :goto_9
-    :try_start_8
-    monitor-exit v17
-    :try_end_8
-    .catchall {:try_start_8 .. :try_end_8} :catchall_1
+    :goto_4
+    :try_start_5
+    monitor-exit v8
+    :try_end_5
+    .catchall {:try_start_5 .. :try_end_5} :catchall_0
 
-    throw v0
+    throw p0
 
-    :cond_7
-    :goto_a
-    invoke-virtual/range {p2 .. p2}, Landroid/os/UserHandle;->getIdentifier()I
+    :cond_3
+    :goto_5
+    invoke-virtual {p2}, Landroid/os/UserHandle;->getIdentifier()I
 
-    move-result v0
+    move-result p2
 
-    const-string/jumbo v2, "android.app.action.PROVISION_MANAGED_PROFILE"
+    const-string/jumbo v0, "android.app.action.PROVISION_MANAGED_PROFILE"
 
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->isLeaveAllSystemAppsEnabled()Z
+    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->isLeaveAllSystemAppsEnabled()Z
 
-    move-result v3
+    move-result p1
 
-    invoke-virtual {v1, v0, v2, v3}, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->sendProvisioningCompletedBroadcast(ILjava/lang/String;Z)V
+    invoke-virtual {p0, p2, v0, p1}, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->sendProvisioningCompletedBroadcast(ILjava/lang/String;Z)V
 
-    iget-object v0, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mInjector:Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;
+    iget-object p1, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mInjector:Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;
 
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     invoke-static {}, Lcom/samsung/android/knox/container/KnoxContainerManager;->getProvisioningState()Landroid/os/Bundle;
 
-    move-result-object v0
+    move-result-object p1
 
-    iget-object v2, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mInjector:Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;
+    iget-object p2, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mInjector:Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;
 
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const/16 v2, 0xa
+    const/16 p2, 0xa
 
-    const-string/jumbo v3, "state"
+    const-string/jumbo v0, "state"
 
-    invoke-virtual {v0, v3, v2}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
+    invoke-virtual {p1, v0, p2}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
 
-    iget-object v1, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mInjector:Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;
+    iget-object p0, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mInjector:Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v0}, Lcom/samsung/android/knox/container/KnoxContainerManager;->updateProvisioningState(Landroid/os/Bundle;)Z
+    invoke-static {p1}, Lcom/samsung/android/knox/container/KnoxContainerManager;->updateProvisioningState(Landroid/os/Bundle;)Z
 
     return-void
 .end method
@@ -46292,524 +46011,312 @@
 .end method
 
 .method public final onCreateAndProvisionManagedProfileStarted(Landroid/app/admin/ManagedProfileProvisioningParams;)V
-    .locals 19
-
-    move-object/from16 v1, p0
+    .locals 11
 
-    const/4 v2, 0x0
+    const/4 v1, 0x0
 
-    const/4 v3, 0x1
+    const/4 v2, 0x1
 
-    iget-object v5, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mDualDarProvisioningHelper:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
+    iget-object v0, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mDualDarProvisioningHelper:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
 
-    iget-object v0, v5, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
+    iget-object v0, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
 
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
+    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
 
-    move-result-object v4
+    move-result-object v3
 
-    invoke-static {v0, v4}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
+    invoke-static {v0, v3}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
 
     move-result v0
 
-    const/4 v11, 0x2
-
-    if-eqz v0, :cond_3
-
-    new-instance v8, Ljava/lang/Object;
-
-    invoke-direct {v8}, Ljava/lang/Object;-><init>()V
-
-    new-array v9, v3, [Z
-
-    aput-boolean v2, v9, v2
-
-    new-array v6, v3, [Z
-
-    new-array v7, v3, [I
-
-    new-instance v4, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;
-
-    const/4 v10, 0x0
-
-    invoke-direct/range {v4 .. v10}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;-><init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[ZI)V
-
-    const-string/jumbo v0, "com.android.dualdar.started.provisioning_success"
-
-    const-string/jumbo v10, "com.android.dualdar.started.cancelled"
-
-    const-string/jumbo v12, "com.android.dualdar.started.error"
-
-    invoke-static {v0, v10, v12}, Lcom/android/server/alarm/GmsAlarmManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
-
-    move-result-object v0
-
-    iget-object v10, v5, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v10, v4, v0, v11}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
-
-    monitor-enter v8
-
-    :try_start_0
-    const-string v0, "DualDarProvisioningHelper"
-
-    const-string/jumbo v4, "Starting Knox DUAL DAR DualDar Started Service"
-
-    invoke-static {v0, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v0, Landroid/content/Intent;
-
-    invoke-direct {v0}, Landroid/content/Intent;-><init>()V
-
-    new-instance v4, Landroid/content/ComponentName;
-
-    const-string/jumbo v10, "com.samsung.android.knox.containercore"
-
-    const-string/jumbo v12, "com.samsung.android.knox.containercore.provisioning.DualDarStartedService"
-
-    invoke-direct {v4, v10, v12}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v0, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
-
-    const-string v4, "DUAL_DAR_PARAMS"
-
-    iget-object v10, v5, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v12
-
-    invoke-static {v10, v12}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARConfigParams(Landroid/content/Context;Landroid/os/PersistableBundle;)Landroid/os/Bundle;
-
-    move-result-object v10
-
-    invoke-virtual {v0, v4, v10}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Bundle;)Landroid/content/Intent;
-
-    const-string v4, "DualDARServiceEventFlag"
-
-    const/16 v10, 0x1f4
-
-    invoke-virtual {v0, v4, v10}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getProfileAdminComponentName()Landroid/content/ComponentName;
-
-    move-result-object v4
-
-    const-string v10, "DUAL_DAR_ADMIN_PACKAGE"
-
-    invoke-virtual {v4}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {v0, v10, v4}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
-
-    const-string v4, "DUAL_DAR_INTENT_PROVISIONING"
-
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v10
-
-    invoke-static {v10}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARIntentProvisioned(Landroid/os/PersistableBundle;)Z
-
-    move-result v10
-
-    invoke-virtual {v0, v4, v10}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    const-string v4, "DUAL_DAR_IS_WPCOD"
-
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->isOrganizationOwnedProvisioning()Z
-
-    move-result v10
-
-    invoke-virtual {v0, v4, v10}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    iget-object v4, v5, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v10
-
-    invoke-static {v4, v10}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARNativeCrypto(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_0
-
-    const-string v4, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v10, 0x2000000
-
-    invoke-virtual {v0, v4, v10}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    goto :goto_3
-
-    :catch_0
-    move-exception v0
-
-    goto :goto_2
-
-    :cond_0
-    const-string v4, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v10, 0x4000000
-
-    invoke-virtual {v0, v4, v10}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    :goto_0
-    invoke-virtual {v5, v0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->startProvisionService(Landroid/content/Intent;)V
-
-    :goto_1
-    aget-boolean v0, v9, v2
-
-    if-nez v0, :cond_1
-
-    invoke-virtual {v8}, Ljava/lang/Object;->wait()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_1
-
-    :goto_2
-    :try_start_1
-    const-string v4, "DualDarProvisioningHelper"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v9, "Error during onCreateAndProvisionManagedProfileStarted"
-
-    invoke-virtual {v5, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_1
-    monitor-exit v8
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    aget-boolean v0, v6, v2
-
-    if-eqz v0, :cond_2
-
-    goto :goto_4
-
-    :cond_2
-    new-instance v0, Landroid/os/ServiceSpecificException;
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v4, "onCreateAndProvisionManagedProfileStarted failed with result: "
-
-    invoke-direct {v1, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    aget v2, v7, v2
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-direct {v0, v3, v1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
-
-    throw v0
-
-    :goto_3
-    :try_start_2
-    monitor-exit v8
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw v0
+    if-nez v0, :cond_4
 
-    :cond_3
-    :goto_4
-    iget-object v13, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mUCMProvisioningHelper:Lcom/android/server/devicepolicy/UCMProvisioningHelper;
+    iget-object v4, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mUCMProvisioningHelper:Lcom/android/server/devicepolicy/UCMProvisioningHelper;
 
-    invoke-virtual {v13}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string v1, " package "
+    const-string p0, " package "
 
     const-string/jumbo v0, "UCMProvisioningHelper"
 
-    const-string/jumbo v4, "onCreateAndProvisioningManagedProfileStartedForUCM"
+    const-string/jumbo v3, "onCreateAndProvisioningManagedProfileStartedForUCM"
 
-    invoke-static {v0, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-object v0, v13, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->mContext:Landroid/content/Context;
+    iget-object v0, v4, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->mContext:Landroid/content/Context;
 
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
+    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
 
-    move-result-object v4
+    move-result-object v3
 
-    invoke-static {v0, v4}, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->isUCMConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
+    invoke-static {v0, v3}, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->isUCMConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
 
     move-result v0
 
-    if-eqz v0, :cond_7
-
-    new-instance v16, Ljava/lang/Object;
+    if-eqz v0, :cond_3
 
-    invoke-direct/range {v16 .. v16}, Ljava/lang/Object;-><init>()V
+    new-instance v7, Ljava/lang/Object;
 
-    new-array v4, v3, [Z
+    invoke-direct {v7}, Ljava/lang/Object;-><init>()V
 
-    aput-boolean v2, v4, v2
+    new-array v8, v2, [Z
 
-    new-array v14, v3, [Z
+    aput-boolean v1, v8, v1
 
-    new-array v15, v3, [I
+    new-array v5, v2, [Z
 
-    new-instance v12, Lcom/android/server/devicepolicy/UCMProvisioningHelper$1;
+    new-array v6, v2, [I
 
-    const/16 v18, 0x0
+    new-instance v3, Lcom/android/server/devicepolicy/UCMProvisioningHelper$1;
 
-    move-object/from16 v17, v4
+    const/4 v9, 0x0
 
-    invoke-direct/range {v12 .. v18}, Lcom/android/server/devicepolicy/UCMProvisioningHelper$1;-><init>(Lcom/android/server/devicepolicy/UCMProvisioningHelper;[Z[ILjava/lang/Object;[ZI)V
+    invoke-direct/range {v3 .. v9}, Lcom/android/server/devicepolicy/UCMProvisioningHelper$1;-><init>(Lcom/android/server/devicepolicy/UCMProvisioningHelper;[Z[ILjava/lang/Object;[ZI)V
 
     const-string/jumbo v0, "com.samsung.android.knox.ucm.action.UCM_STARTED_PROVISIONING_SUCCESS"
 
-    const-string/jumbo v4, "com.samsung.android.knox.ucm.action.UCM_STARTED_PROVISIONING_CANCELLED"
+    const-string/jumbo v9, "com.samsung.android.knox.ucm.action.UCM_STARTED_PROVISIONING_CANCELLED"
 
-    const-string/jumbo v5, "com.samsung.android.knox.ucm.action.UCM_STARTED_PROVISIONING_ERROR"
+    const-string/jumbo v10, "com.samsung.android.knox.ucm.action.UCM_STARTED_PROVISIONING_ERROR"
 
-    invoke-static {v0, v4, v5}, Lcom/android/server/alarm/GmsAlarmManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
+    invoke-static {v0, v9, v10}, Lcom/android/server/alarm/GmsAlarmManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
 
     move-result-object v0
 
-    iget-object v4, v13, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->mContext:Landroid/content/Context;
+    iget-object v9, v4, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v4, v12, v0, v11}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
+    const/4 v10, 0x2
 
-    monitor-enter v16
+    invoke-virtual {v9, v3, v0, v10}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
 
-    :try_start_3
+    monitor-enter v7
+
+    :try_start_0
     const-string/jumbo v0, "UCMProvisioningHelper"
 
-    const-string/jumbo v4, "Starting Knox UCM Started Service"
+    const-string/jumbo v3, "Starting Knox UCM Started Service"
 
-    invoke-static {v0, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    new-instance v4, Landroid/content/Intent;
+    new-instance v3, Landroid/content/Intent;
 
-    invoke-direct {v4}, Landroid/content/Intent;-><init>()V
+    invoke-direct {v3}, Landroid/content/Intent;-><init>()V
 
     new-instance v0, Landroid/content/ComponentName;
 
-    const-string/jumbo v5, "com.samsung.android.knox.containercore"
+    const-string/jumbo v9, "com.samsung.android.knox.containercore"
 
-    const-string/jumbo v6, "com.samsung.android.knox.containercore.provisioning.UCMStartedService"
+    const-string/jumbo v10, "com.samsung.android.knox.containercore.provisioning.UCMStartedService"
 
-    invoke-direct {v0, v5, v6}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-direct {v0, v9, v10}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
 
-    invoke-virtual {v4, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
+    invoke-virtual {v3, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
 
     const-string/jumbo v0, "UCM_DAR_PARAMS"
 
-    invoke-virtual/range {p1 .. p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
+    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
 
-    move-result-object v5
+    move-result-object p1
 
-    invoke-static {v5}, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->getUCMConfigParams(Landroid/os/PersistableBundle;)Landroid/os/Bundle;
+    invoke-static {p1}, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->getUCMConfigParams(Landroid/os/PersistableBundle;)Landroid/os/Bundle;
 
-    move-result-object v5
+    move-result-object p1
 
-    invoke-virtual {v4, v0, v5}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Bundle;)Landroid/content/Intent;
-    :try_end_3
-    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    invoke-virtual {v3, v0, p1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Bundle;)Landroid/content/Intent;
+    :try_end_0
+    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_2
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    const/4 v5, 0x0
+    const/4 p1, 0x0
 
-    :try_start_4
+    :try_start_1
     const-string/jumbo v0, "UCM_DAR_PARAMS"
 
-    invoke-virtual {v4, v0}, Landroid/content/Intent;->getBundleExtra(Ljava/lang/String;)Landroid/os/Bundle;
+    invoke-virtual {v3, v0}, Landroid/content/Intent;->getBundleExtra(Ljava/lang/String;)Landroid/os/Bundle;
 
     move-result-object v0
 
-    const-string/jumbo v6, "ucm-config-client-package"
+    const-string/jumbo v9, "ucm-config-client-package"
 
-    invoke-virtual {v0, v6}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
+    invoke-virtual {v0, v9}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v6
-    :try_end_4
-    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_2
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
+    move-result-object v9
+    :try_end_1
+    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :try_start_5
+    :try_start_2
     const-string/jumbo v0, "UCM_DAR_PARAMS"
 
-    invoke-virtual {v4, v0}, Landroid/content/Intent;->getBundleExtra(Ljava/lang/String;)Landroid/os/Bundle;
+    invoke-virtual {v3, v0}, Landroid/content/Intent;->getBundleExtra(Ljava/lang/String;)Landroid/os/Bundle;
 
     move-result-object v0
 
-    const-string/jumbo v7, "ucm-config-client-location"
+    const-string/jumbo v10, "ucm-config-client-location"
 
-    invoke-virtual {v0, v7}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
+    invoke-virtual {v0, v10}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v5
-    :try_end_5
-    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_1
-    .catchall {:try_start_5 .. :try_end_5} :catchall_1
+    move-result-object p1
+    :try_end_2
+    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0
+    .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    goto :goto_6
+    goto :goto_1
 
-    :catchall_1
+    :catchall_0
     move-exception v0
 
-    goto/16 :goto_9
+    move-object p0, v0
 
-    :catch_1
+    goto/16 :goto_4
+
+    :catch_0
     move-exception v0
 
-    goto :goto_5
+    goto :goto_0
 
-    :catch_2
+    :catch_1
     move-exception v0
 
-    move-object v6, v5
+    move-object v9, p1
 
-    :goto_5
-    :try_start_6
+    :goto_0
+    :try_start_3
     invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
 
-    :goto_6
+    :goto_1
     const-string/jumbo v0, "UCMProvisioningHelper"
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    new-instance v10, Ljava/lang/StringBuilder;
 
-    invoke-direct {v7, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v10, p0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string v1, " URLlocation "
+    const-string p0, " URLlocation "
 
-    invoke-virtual {v7, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v1
+    move-result-object p0
 
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-object v0, v13, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->mContext:Landroid/content/Context;
+    iget-object p0, v4, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->mContext:Landroid/content/Context;
 
-    iget-object v1, v13, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->connection:Lcom/android/server/devicepolicy/UCMProvisioningHelper$3;
+    iget-object p1, v4, Lcom/android/server/devicepolicy/UCMProvisioningHelper;->connection:Lcom/android/server/devicepolicy/UCMProvisioningHelper$3;
 
-    const/16 v5, 0x41
+    const/16 v0, 0x41
 
-    invoke-virtual {v0, v4, v1, v5}, Landroid/content/Context;->bindService(Landroid/content/Intent;Landroid/content/ServiceConnection;I)Z
+    invoke-virtual {p0, v3, p1, v0}, Landroid/content/Context;->bindService(Landroid/content/Intent;Landroid/content/ServiceConnection;I)Z
 
-    move-result v0
+    move-result p0
 
-    if-eqz v0, :cond_4
+    if-eqz p0, :cond_0
 
-    :goto_7
-    aget-boolean v0, v17, v2
+    :goto_2
+    aget-boolean p0, v8, v1
 
-    if-nez v0, :cond_5
+    if-nez p0, :cond_1
 
-    invoke-virtual/range {v16 .. v16}, Ljava/lang/Object;->wait()V
+    invoke-virtual {v7}, Ljava/lang/Object;->wait()V
 
-    goto :goto_7
+    goto :goto_2
 
-    :catch_3
+    :catch_2
     move-exception v0
 
-    goto :goto_8
+    move-object p0, v0
 
-    :cond_4
-    new-instance v0, Ljava/lang/Exception;
+    goto :goto_3
 
-    const-string/jumbo v1, "startProvisionService : failed to startService."
+    :cond_0
+    new-instance p0, Ljava/lang/Exception;
 
-    invoke-direct {v0, v1}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
+    const-string/jumbo p1, "startProvisionService : failed to startService."
 
-    throw v0
-    :try_end_6
-    .catch Ljava/lang/Exception; {:try_start_6 .. :try_end_6} :catch_3
-    .catchall {:try_start_6 .. :try_end_6} :catchall_1
+    invoke-direct {p0, p1}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
 
-    :goto_8
-    :try_start_7
-    const-string/jumbo v1, "UCMProvisioningHelper"
+    throw p0
+    :try_end_3
+    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_2
+    .catchall {:try_start_3 .. :try_end_3} :catchall_0
 
-    new-instance v4, Ljava/lang/StringBuilder;
+    :goto_3
+    :try_start_4
+    const-string/jumbo p1, "UCMProvisioningHelper"
 
-    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    const-string v5, "Error during onCreateAndProvisionManagedProfileStarted"
+    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    const-string v3, "Error during onCreateAndProvisionManagedProfileStarted"
 
-    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
 
-    move-result-object v0
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    move-result-object p0
 
-    :cond_5
-    monitor-exit v16
-    :try_end_7
-    .catchall {:try_start_7 .. :try_end_7} :catchall_1
+    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    :cond_1
+    monitor-exit v7
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_0
 
-    aget-boolean v0, v14, v2
+    aget-boolean p0, v5, v1
 
-    if-eqz v0, :cond_6
+    if-eqz p0, :cond_2
 
-    goto :goto_a
+    goto :goto_5
 
-    :cond_6
-    new-instance v0, Landroid/os/ServiceSpecificException;
+    :cond_2
+    new-instance p0, Landroid/os/ServiceSpecificException;
 
-    new-instance v1, Ljava/lang/StringBuilder;
+    new-instance p1, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v4, "onCreateAndProvisionManagedProfileStarted failed with result: "
+    const-string/jumbo v0, "onCreateAndProvisionManagedProfileStarted failed with result: "
 
-    invoke-direct {v1, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    aget v2, v15, v2
+    aget v0, v6, v1
 
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v1
+    move-result-object p1
 
-    invoke-direct {v0, v3, v1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
+    invoke-direct {p0, v2, p1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
 
-    throw v0
+    throw p0
 
-    :goto_9
-    :try_start_8
-    monitor-exit v16
-    :try_end_8
-    .catchall {:try_start_8 .. :try_end_8} :catchall_1
+    :goto_4
+    :try_start_5
+    monitor-exit v7
+    :try_end_5
+    .catchall {:try_start_5 .. :try_end_5} :catchall_0
 
-    throw v0
+    throw p0
 
-    :cond_7
-    :goto_a
+    :cond_3
+    :goto_5
     return-void
+
+    :cond_4
+    new-instance p0, Landroid/os/ServiceSpecificException;
+
+    const-string/jumbo p1, "onCreateAndProvisionManagedProfileStarted failed : not support dualdar"
+
+    invoke-direct {p0, v2, p1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
+
+    throw p0
 .end method
 
 .method public final onLockSettingsReady()V
@@ -47218,540 +46725,35 @@
     throw p0
 .end method
 
-.method public final onProvisionFullyManagedDeviceCompleted(Landroid/app/admin/FullyManagedDeviceProvisioningParams;)V
-    .locals 10
-
-    const/4 v0, 0x1
-
-    const/4 v1, 0x0
-
-    iget-object v3, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mDualDarProvisioningHelper:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object p0, v3, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v2
-
-    invoke-static {p0, v2}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_3
-
-    new-instance v6, Ljava/lang/Object;
-
-    invoke-direct {v6}, Ljava/lang/Object;-><init>()V
-
-    new-array v7, v0, [Z
-
-    aput-boolean v1, v7, v1
-
-    new-array v4, v0, [Z
-
-    new-array v5, v0, [I
-
-    new-instance v2, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;
-
-    const/4 v8, 0x3
-
-    invoke-direct/range {v2 .. v8}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;-><init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[ZI)V
-
-    const-string/jumbo p0, "com.android.dualdar.completed.provisioning_success"
-
-    const-string/jumbo v8, "com.android.dualdar.completed.cancelled"
-
-    const-string/jumbo v9, "com.android.dualdar.completed.error"
-
-    invoke-static {p0, v8, v9}, Lcom/android/server/alarm/GmsAlarmManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
-
-    move-result-object p0
-
-    iget-object v8, v3, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    const/4 v9, 0x2
-
-    invoke-virtual {v8, v2, p0, v9}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
-
-    monitor-enter v6
-
-    :try_start_0
-    const-string p0, "DualDarProvisioningHelper"
-
-    const-string/jumbo v2, "Starting Knox DUAL DAR DualDar Completed Service"
-
-    invoke-static {p0, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance p0, Landroid/content/Intent;
-
-    invoke-direct {p0}, Landroid/content/Intent;-><init>()V
-
-    new-instance v2, Landroid/content/ComponentName;
-
-    const-string/jumbo v8, "com.samsung.android.knox.containercore"
-
-    const-string/jumbo v9, "com.samsung.android.knox.containercore.provisioning.DualDarCompletedService"
-
-    invoke-direct {v2, v8, v9}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p0, v2}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
-
-    const-string/jumbo v2, "android.intent.extra.user_handle"
-
-    invoke-static {}, Landroid/os/UserHandle;->myUserId()I
-
-    move-result v8
-
-    invoke-virtual {p0, v2, v8}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    const-string v2, "DUAL_DAR_PARAMS"
-
-    iget-object v8, v3, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v9
-
-    invoke-static {v8, v9}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARConfigParams(Landroid/content/Context;Landroid/os/PersistableBundle;)Landroid/os/Bundle;
-
-    move-result-object v8
-
-    invoke-virtual {p0, v2, v8}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Bundle;)Landroid/content/Intent;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getDeviceAdminComponentName()Landroid/content/ComponentName;
-
-    move-result-object v2
-
-    const-string v8, "DUAL_DAR_ADMIN_PACKAGE"
-
-    invoke-virtual {v2}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {p0, v8, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
-
-    const-string v2, "DUAL_DAR_INTENT_PROVISIONING"
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v8
-
-    invoke-static {v8}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARIntentProvisioned(Landroid/os/PersistableBundle;)Z
-
-    move-result v8
-
-    invoke-virtual {p0, v2, v8}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    const-string v2, "DUAL_DAR_IS_MANAGED_DEVICE"
-
-    invoke-virtual {p0, v2, v0}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    iget-object v0, v3, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object p1
-
-    invoke-static {v0, p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARNativeCrypto(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    const-string p1, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v0, 0x2000000
-
-    invoke-virtual {p0, p1, v0}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_3
-
-    :catch_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_2
-
-    :cond_0
-    const-string p1, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v0, 0x4000000
-
-    invoke-virtual {p0, p1, v0}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    :goto_0
-    invoke-virtual {v3, p0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->startProvisionService(Landroid/content/Intent;)V
-
-    :goto_1
-    aget-boolean p0, v7, v1
-
-    if-nez p0, :cond_1
-
-    invoke-virtual {v6}, Ljava/lang/Object;->wait()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_1
-
-    :goto_2
-    :try_start_1
-    const-string p1, "DualDarProvisioningHelper"
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "Error during onProvisionFullyManagedDeviceCompleted"
-
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_1
-    monitor-exit v6
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    aget-boolean p0, v4, v1
-
-    if-eqz p0, :cond_2
-
-    goto :goto_4
-
-    :cond_2
-    new-instance p0, Landroid/os/ServiceSpecificException;
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "onProvisionFullyManagedDeviceCompleted failed with result: "
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    aget v0, v5, v1
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    const/4 v0, 0x7
-
-    invoke-direct {p0, v0, p1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
-
-    throw p0
-
-    :goto_3
-    :try_start_2
-    monitor-exit v6
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :cond_3
-    :goto_4
-    return-void
-.end method
-
 .method public final onProvisionFullyManagedDeviceStarted(Landroid/app/admin/FullyManagedDeviceProvisioningParams;)V
-    .locals 10
-
-    const/4 v1, 0x1
-
-    const/4 v2, 0x0
-
-    iget-object v4, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mDualDarProvisioningHelper:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object p0, v4, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v0
-
-    invoke-static {p0, v0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_4
-
-    new-instance v7, Ljava/lang/Object;
-
-    invoke-direct {v7}, Ljava/lang/Object;-><init>()V
-
-    new-array v8, v1, [Z
-
-    aput-boolean v2, v8, v2
-
-    new-array v5, v1, [Z
-
-    new-array v6, v1, [I
-
-    new-instance v3, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;
-
-    const/4 v9, 0x2
-
-    invoke-direct/range {v3 .. v9}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;-><init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[ZI)V
-
-    const-string/jumbo p0, "com.android.dualdar.started.provisioning_success"
-
-    const-string/jumbo v0, "com.android.dualdar.started.cancelled"
-
-    const-string/jumbo v9, "com.android.dualdar.started.error"
-
-    invoke-static {p0, v0, v9}, Lcom/android/server/alarm/GmsAlarmManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
-
-    move-result-object p0
-
-    iget-object v0, v4, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    const/4 v9, 0x2
-
-    invoke-virtual {v0, v3, p0, v9}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;I)Landroid/content/Intent;
-
-    monitor-enter v7
-
-    :try_start_0
-    const-string p0, "DualDarProvisioningHelper"
-
-    const-string/jumbo v0, "Starting Knox DUAL DAR DualDar Started Service"
-
-    invoke-static {p0, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance p0, Landroid/content/Intent;
-
-    invoke-direct {p0}, Landroid/content/Intent;-><init>()V
-
-    new-instance v0, Landroid/content/ComponentName;
-
-    const-string/jumbo v3, "com.samsung.android.knox.containercore"
-
-    const-string/jumbo v9, "com.samsung.android.knox.containercore.provisioning.DualDarStartedService"
-
-    invoke-direct {v0, v3, v9}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p0, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
-
-    const-string/jumbo v0, "android.intent.extra.user_handle"
-
-    invoke-static {}, Landroid/os/UserHandle;->myUserId()I
-
-    move-result v3
-
-    invoke-virtual {p0, v0, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    const-string v0, "DUAL_DAR_PARAMS"
-
-    iget-object v3, v4, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v9
-
-    invoke-static {v3, v9}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARConfigParams(Landroid/content/Context;Landroid/os/PersistableBundle;)Landroid/os/Bundle;
-
-    move-result-object v3
-
-    invoke-virtual {p0, v0, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Bundle;)Landroid/content/Intent;
-
-    const-string v0, "DualDARServiceEventFlag"
-
-    const/16 v3, 0x1f4
-
-    invoke-virtual {p0, v0, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getDeviceAdminComponentName()Landroid/content/ComponentName;
-
-    move-result-object v0
-
-    const-string v3, "DUAL_DAR_ADMIN_PACKAGE"
-
-    invoke-virtual {v0}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {p0, v3, v0}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
-
-    const-string v0, "DUAL_DAR_INTENT_PROVISIONING"
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v3
-
-    invoke-static {v3}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARIntentProvisioned(Landroid/os/PersistableBundle;)Z
-
-    move-result v3
-
-    invoke-virtual {p0, v0, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    const-string v0, "DUAL_DAR_IS_MANAGED_DEVICE"
+    .locals 1
 
-    invoke-virtual {p0, v0, v1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
+    iget-object p0, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mDualDarProvisioningHelper:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
 
-    iget-object v0, v4, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
+    iget-object p0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
 
     invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
 
     move-result-object p1
 
-    invoke-static {v0, p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARNativeCrypto(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    const-string p1, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v0, 0x2000000
-
-    invoke-virtual {p0, p1, v0}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_4
-
-    :catch_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_2
-
-    :cond_0
-    const-string p1, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v0, 0x4000000
-
-    invoke-virtual {p0, p1, v0}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    :goto_0
-    iget-object p1, v4, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mUserManagerInternal:Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-virtual {p1, v2, v0}, Lcom/android/server/pm/UserManagerInternal;->setDualDarInfo(II)Z
-
-    move-result p1
-
-    if-nez p1, :cond_1
-
-    const-string p1, "DualDarProvisioningHelper"
-
-    const-string v0, "Failed to set dualdar crypto type to UserInfo"
-
-    invoke-static {p1, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    aput-boolean v2, v5, v2
-
-    const-string p1, "ERROR_CODE"
-
-    const/4 v0, 0x5
-
-    invoke-virtual {p0, p1, v0}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
+    invoke-static {p0, p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
 
     move-result p0
 
-    aput p0, v6, v2
-
-    goto :goto_3
-
-    :cond_1
-    invoke-virtual {v4, p0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->startProvisionService(Landroid/content/Intent;)V
-
-    :goto_1
-    aget-boolean p0, v8, v2
-
-    if-nez p0, :cond_2
-
-    invoke-virtual {v7}, Ljava/lang/Object;->wait()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_1
-
-    :goto_2
-    :try_start_1
-    const-string p1, "DualDarProvisioningHelper"
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v3, "Error during onProvisionFullyManagedDeviceStarted"
-
-    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_2
-    :goto_3
-    monitor-exit v7
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    aget-boolean p0, v5, v2
-
-    if-eqz p0, :cond_3
+    if-nez p0, :cond_0
 
-    goto :goto_5
+    return-void
 
-    :cond_3
+    :cond_0
     new-instance p0, Landroid/os/ServiceSpecificException;
 
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "onProvisionFullyManagedDeviceStarted failed with result: "
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    aget v0, v6, v2
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-direct {p0, v1, p1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
+    const/4 p1, 0x1
 
-    throw p0
+    const-string/jumbo v0, "onProvisionFullyManagedDeviceStarted failed : not support dualdar managed device"
 
-    :goto_4
-    :try_start_2
-    monitor-exit v7
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+    invoke-direct {p0, p1, v0}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
 
     throw p0
-
-    :cond_4
-    :goto_5
-    return-void
 .end method
 
 .method public final onShellCommand(Ljava/io/FileDescriptor;Ljava/io/FileDescriptor;Ljava/io/FileDescriptor;[Ljava/lang/String;Landroid/os/ShellCallback;Landroid/os/ResultReceiver;)V
@@ -48328,7 +47330,9 @@
 
     invoke-virtual {p0, v5, v1}, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->setDemoDeviceStateUnchecked(IZ)V
 
-    invoke-virtual {p0, p1}, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->onProvisionFullyManagedDeviceCompleted(Landroid/app/admin/FullyManagedDeviceProvisioningParams;)V
+    iget-object v1, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mDualDarProvisioningHelper:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
+
+    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->isLeaveAllSystemAppsEnabled()Z
 
@@ -49771,7 +48775,7 @@
 .end method
 
 .method public final removeNonRequiredAppsForManagedDevice(ILandroid/content/ComponentName;Z)Z
-    .locals 6
+    .locals 5
 
     if-eqz p3, :cond_0
 
@@ -49853,43 +48857,8 @@
     :cond_3
     iget-object p3, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mInjector:Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;
 
-    iget-object v2, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mContext:Landroid/content/Context;
-
     invoke-virtual {p3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result p3
-
-    if-eqz p3, :cond_4
-
-    new-instance p3, Ljava/util/HashSet;
-
-    invoke-direct {p3}, Ljava/util/HashSet;-><init>()V
-
-    invoke-static {v2}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
-
-    move-result-object v2
-
-    invoke-virtual {v2, p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getClientPackage(I)Ljava/lang/String;
-
-    move-result-object v2
-
-    if-eqz v2, :cond_4
-
-    const-string v3, "DualDar client pkg "
-
-    const-string v4, " should not be deleted during Managed Device Provisioning"
-
-    const-string v5, "DevicePolicyManager::KnoxUtils"
-
-    invoke-static {v3, v2, v4, v5}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p3, v2}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z
-
-    invoke-interface {p2, p3}, Ljava/util/Set;->removeAll(Ljava/util/Collection;)Z
-
-    :cond_4
     :try_start_0
     iget-object p3, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mInjector:Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;
 
@@ -49928,7 +48897,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_5
+    if-eqz v2, :cond_4
 
     invoke-interface {p2}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -49968,7 +48937,7 @@
 
     goto :goto_3
 
-    :cond_5
+    :cond_4
     const-string/jumbo p0, "Waiting for non required apps to be deleted"
 
     invoke-static {v1, p0}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;)I
@@ -49986,11 +48955,11 @@
 
     move-result p1
 
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_6
 
     iget-boolean p1, p3, Lcom/android/server/devicepolicy/NonRequiredPackageDeleteObserver;->mFailed:Z
 
-    if-nez p1, :cond_6
+    if-nez p1, :cond_5
 
     const-string p1, "All non-required system apps with launcher icon, and all disallowed apps have been uninstalled."
 
@@ -50003,7 +48972,7 @@
 
     goto :goto_5
 
-    :cond_6
+    :cond_5
     :goto_4
     iget-boolean p0, p3, Lcom/android/server/devicepolicy/NonRequiredPackageDeleteObserver;->mFailed:Z
 
@@ -50011,7 +48980,7 @@
 
     goto :goto_6
 
-    :cond_7
+    :cond_6
     const-string/jumbo p1, "Waiting time elapsed before all package deletion finished"
 
     invoke-static {v1, p1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
@@ -52444,30 +51413,6 @@
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mInjector:Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mInjector:Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_5
-
-    const-string p0, "DevicePolicyManager"
-
-    const-string p1, "Failed to reset password due to constraint violation: password null does not meet DualDAR on Device Owner Enabled"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    monitor-exit v2
-
-    goto/16 :goto_e
-
     :cond_5
     invoke-static {v3, v4, p1}, Landroid/app/admin/PasswordMetrics;->validateCredential(Landroid/app/admin/PasswordMetrics;ILcom/android/internal/widget/LockscreenCredential;)Ljava/util/List;
 
diff --git a/smali/com/android/server/devicepolicy/DualDarProvisioningHelper$1.smali b/smali/com/android/server/devicepolicy/DualDarProvisioningHelper$1.smali
deleted file mode 100644
index 5ea7b20b9..000000000
--- a/smali/com/android/server/devicepolicy/DualDarProvisioningHelper$1.smali
+++ /dev/null
@@ -1,424 +0,0 @@
-.class public final Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;
-.super Landroid/content/BroadcastReceiver;
-.source "SourceFile"
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-.field public final synthetic val$errorCode:[I
-
-.field public final synthetic val$finished:[Z
-
-.field public final synthetic val$mutex:Ljava/lang/Object;
-
-.field public final synthetic val$success:[Z
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[ZI)V
-    .locals 0
-
-    iput p6, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->$r8$classId:I
-
-    iput-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iput-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$success:[Z
-
-    iput-object p3, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$errorCode:[I
-
-    iput-object p4, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$mutex:Ljava/lang/Object;
-
-    iput-object p5, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$finished:[Z
-
-    invoke-direct {p0}, Landroid/content/BroadcastReceiver;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final onReceive(Landroid/content/Context;Landroid/content/Intent;)V
-    .locals 4
-
-    iget p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->$r8$classId:I
-
-    packed-switch p1, :pswitch_data_0
-
-    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string v0, "DualDarProvisioningHelper"
-
-    const-string v1, "DualDAR Managed Device Completed Service onReceived is called: "
-
-    invoke-static {v1, p1, v0}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object v0, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v0, p0}, Landroid/content/Context;->unregisterReceiver(Landroid/content/BroadcastReceiver;)V
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object v1, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    iget-object v0, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->connection:Lcom/android/server/devicepolicy/DualDarProvisioningHelper$5;
-
-    invoke-virtual {v1, v0}, Landroid/content/Context;->unbindService(Landroid/content/ServiceConnection;)V
-
-    const-string/jumbo v0, "com.android.dualdar.completed.provisioning_success"
-
-    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    const/4 v0, 0x1
-
-    const/4 v1, 0x0
-
-    if-eqz p1, :cond_0
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$success:[Z
-
-    aput-boolean v0, p1, v1
-
-    goto :goto_0
-
-    :cond_0
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$success:[Z
-
-    aput-boolean v1, p1, v1
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$errorCode:[I
-
-    const-string v2, "ERROR_CODE"
-
-    const/4 v3, 0x5
-
-    invoke-virtual {p2, v2, v3}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
-
-    move-result p2
-
-    aput p2, p1, v1
-
-    :goto_0
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$mutex:Ljava/lang/Object;
-
-    monitor-enter p1
-
-    :try_start_0
-    iget-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$finished:[Z
-
-    aput-boolean v0, p2, v1
-
-    iget-object p0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$mutex:Ljava/lang/Object;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->notify()V
-
-    monitor-exit p1
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit p1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-
-    :pswitch_0
-    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string v0, "DualDarProvisioningHelper"
-
-    const-string v1, "DualDAR Managed Device Started Service onReceived is called: "
-
-    invoke-static {v1, p1, v0}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object v0, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v0, p0}, Landroid/content/Context;->unregisterReceiver(Landroid/content/BroadcastReceiver;)V
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object v1, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    iget-object v0, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->connection:Lcom/android/server/devicepolicy/DualDarProvisioningHelper$5;
-
-    invoke-virtual {v1, v0}, Landroid/content/Context;->unbindService(Landroid/content/ServiceConnection;)V
-
-    const-string/jumbo v0, "com.android.dualdar.started.provisioning_success"
-
-    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    const/4 v0, 0x1
-
-    const/4 v1, 0x0
-
-    if-eqz p1, :cond_1
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$success:[Z
-
-    aput-boolean v0, p1, v1
-
-    goto :goto_1
-
-    :cond_1
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$success:[Z
-
-    aput-boolean v1, p1, v1
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$errorCode:[I
-
-    const-string v2, "ERROR_CODE"
-
-    const/4 v3, 0x5
-
-    invoke-virtual {p2, v2, v3}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
-
-    move-result p2
-
-    aput p2, p1, v1
-
-    :goto_1
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$mutex:Ljava/lang/Object;
-
-    monitor-enter p1
-
-    :try_start_1
-    iget-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$finished:[Z
-
-    aput-boolean v0, p2, v1
-
-    iget-object p0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$mutex:Ljava/lang/Object;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->notify()V
-
-    monitor-exit p1
-
-    return-void
-
-    :catchall_1
-    move-exception p0
-
-    monitor-exit p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    throw p0
-
-    :pswitch_1
-    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string v0, "DualDarProvisioningHelper"
-
-    const-string v1, "DualDAR Managed Profile Completed Service onReceived is called: "
-
-    invoke-static {v1, p1, v0}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object v0, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v0, p0}, Landroid/content/Context;->unregisterReceiver(Landroid/content/BroadcastReceiver;)V
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object v1, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    iget-object v0, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->connection:Lcom/android/server/devicepolicy/DualDarProvisioningHelper$5;
-
-    invoke-virtual {v1, v0}, Landroid/content/Context;->unbindService(Landroid/content/ServiceConnection;)V
-
-    const-string/jumbo v0, "com.android.dualdar.completed.provisioning_success"
-
-    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    const/4 v1, 0x1
-
-    const/4 v2, 0x0
-
-    if-eqz v0, :cond_2
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$success:[Z
-
-    aput-boolean v1, p1, v2
-
-    goto :goto_2
-
-    :cond_2
-    const-string/jumbo v0, "com.android.dualdar.completed.cancelled"
-
-    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_3
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$success:[Z
-
-    aput-boolean v1, p1, v2
-
-    const-string p1, "DualDarProvisioningHelper"
-
-    const-string p2, "DualDAR is not enabled. dualdar completed provisinoing cacelled."
-
-    invoke-static {p1, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_2
-
-    :cond_3
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$success:[Z
-
-    aput-boolean v2, p1, v2
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$errorCode:[I
-
-    const-string v0, "ERROR_CODE"
-
-    const/4 v3, 0x5
-
-    invoke-virtual {p2, v0, v3}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
-
-    move-result p2
-
-    aput p2, p1, v2
-
-    :goto_2
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$mutex:Ljava/lang/Object;
-
-    monitor-enter p1
-
-    :try_start_2
-    iget-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$finished:[Z
-
-    aput-boolean v1, p2, v2
-
-    iget-object p0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$mutex:Ljava/lang/Object;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->notify()V
-
-    monitor-exit p1
-
-    return-void
-
-    :catchall_2
-    move-exception p0
-
-    monitor-exit p1
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_2
-
-    throw p0
-
-    :pswitch_2
-    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string v0, "DualDarProvisioningHelper"
-
-    const-string v1, "DualDAR Managed Profile Started Service onReceived is called: "
-
-    invoke-static {v1, p1, v0}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object v0, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v0, p0}, Landroid/content/Context;->unregisterReceiver(Landroid/content/BroadcastReceiver;)V
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object v1, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    iget-object v0, v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->connection:Lcom/android/server/devicepolicy/DualDarProvisioningHelper$5;
-
-    invoke-virtual {v1, v0}, Landroid/content/Context;->unbindService(Landroid/content/ServiceConnection;)V
-
-    const-string/jumbo v0, "com.android.dualdar.started.provisioning_success"
-
-    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    const/4 v0, 0x1
-
-    const/4 v1, 0x0
-
-    if-eqz p1, :cond_4
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$success:[Z
-
-    aput-boolean v0, p1, v1
-
-    goto :goto_3
-
-    :cond_4
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$success:[Z
-
-    aput-boolean v1, p1, v1
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$errorCode:[I
-
-    const-string v2, "ERROR_CODE"
-
-    const/4 v3, 0x5
-
-    invoke-virtual {p2, v2, v3}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
-
-    move-result p2
-
-    aput p2, p1, v1
-
-    :goto_3
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$mutex:Ljava/lang/Object;
-
-    monitor-enter p1
-
-    :try_start_3
-    iget-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$finished:[Z
-
-    aput-boolean v0, p2, v1
-
-    iget-object p0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$mutex:Ljava/lang/Object;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->notify()V
-
-    monitor-exit p1
-
-    return-void
-
-    :catchall_3
-    move-exception p0
-
-    monitor-exit p1
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_3
-
-    throw p0
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_2
-        :pswitch_1
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/devicepolicy/DualDarProvisioningHelper$5.smali b/smali/com/android/server/devicepolicy/DualDarProvisioningHelper$5.smali
deleted file mode 100644
index 5ed420291..000000000
--- a/smali/com/android/server/devicepolicy/DualDarProvisioningHelper$5.smali
+++ /dev/null
@@ -1,60 +0,0 @@
-.class public final Lcom/android/server/devicepolicy/DualDarProvisioningHelper$5;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Landroid/content/ServiceConnection;
-
-
-# virtual methods
-.method public final onServiceConnected(Landroid/content/ComponentName;Landroid/os/IBinder;)V
-    .locals 0
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p2, "Service connected!! : "
-
-    invoke-direct {p0, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1}, Landroid/content/ComponentName;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string p1, "DualDarProvisioningHelper"
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-.end method
-
-.method public final onServiceDisconnected(Landroid/content/ComponentName;)V
-    .locals 1
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "Service disconnected!! : "
-
-    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1}, Landroid/content/ComponentName;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string p1, "DualDarProvisioningHelper"
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-.end method
diff --git a/smali/com/android/server/devicepolicy/DualDarProvisioningHelper.smali b/smali/com/android/server/devicepolicy/DualDarProvisioningHelper.smali
index 4d038fa4f..e7d71cd3a 100644
--- a/smali/com/android/server/devicepolicy/DualDarProvisioningHelper.smali
+++ b/smali/com/android/server/devicepolicy/DualDarProvisioningHelper.smali
@@ -4,164 +4,20 @@
 
 
 # instance fields
-.field public final connection:Lcom/android/server/devicepolicy/DualDarProvisioningHelper$5;
-
 .field public final mContext:Landroid/content/Context;
 
-.field public final mUserManagerInternal:Lcom/android/server/pm/UserManagerInternal;
-
 
 # direct methods
-.method public constructor <init>(Landroid/content/Context;Lcom/android/server/pm/UserManagerInternal;)V
-    .locals 1
+.method public constructor <init>(Landroid/content/Context;)V
+    .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    new-instance v0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$5;
-
-    invoke-direct {v0}, Ljava/lang/Object;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->connection:Lcom/android/server/devicepolicy/DualDarProvisioningHelper$5;
-
     iput-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
 
-    iput-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mUserManagerInternal:Lcom/android/server/pm/UserManagerInternal;
-
     return-void
 .end method
 
-.method public static getDualDARConfigParams(Landroid/content/Context;Landroid/os/PersistableBundle;)Landroid/os/Bundle;
-    .locals 8
-
-    if-eqz p1, :cond_0
-
-    invoke-static {p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARIntentProvisioned(Landroid/os/PersistableBundle;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    new-instance p0, Landroid/os/Bundle;
-
-    invoke-direct {p0, p1}, Landroid/os/Bundle;-><init>(Landroid/os/PersistableBundle;)V
-
-    invoke-virtual {p0}, Landroid/os/Bundle;->deepCopy()Landroid/os/Bundle;
-
-    move-result-object p0
-
-    return-object p0
-
-    :cond_0
-    invoke-static {p0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARProfile(Landroid/content/Context;)Landroid/os/Bundle;
-
-    move-result-object p0
-
-    const/4 p1, 0x0
-
-    if-nez p0, :cond_1
-
-    return-object p1
-
-    :cond_1
-    const-string/jumbo v0, "dualdar-config-client-package"
-
-    invoke-virtual {p0, v0}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    const-string/jumbo v2, "dualdar-config-client-signature"
-
-    invoke-virtual {p0, v2}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v3
-
-    const-string/jumbo v4, "dualdar-config-client-location"
-
-    invoke-virtual {p0, v4}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    new-instance v5, Landroid/os/Bundle;
-
-    invoke-direct {v5}, Landroid/os/Bundle;-><init>()V
-
-    const-string/jumbo v6, "dualdar-config"
-
-    const/4 v7, 0x1
-
-    invoke-virtual {v5, v6, v7}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    const-string/jumbo v6, "default"
-
-    invoke-virtual {v6, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v7
-
-    if-eqz v7, :cond_2
-
-    move-object v7, p1
-
-    goto :goto_0
-
-    :cond_2
-    move-object v7, v1
-
-    :goto_0
-    invoke-virtual {v5, v0, v7}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v6, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    move-object v3, p1
-
-    :cond_3
-    invoke-virtual {v5, v2, v3}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v6, p0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    goto :goto_1
-
-    :cond_4
-    move-object p1, p0
-
-    :goto_1
-    invoke-virtual {v5, v4, p1}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-object v5
-.end method
-
-.method public static getDualDARProfile(Landroid/content/Context;)Landroid/os/Bundle;
-    .locals 1
-
-    const-string/jumbo v0, "persona"
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/samsung/android/knox/SemPersonaManager;
-
-    if-eqz p0, :cond_0
-
-    invoke-virtual {p0}, Lcom/samsung/android/knox/SemPersonaManager;->getDualDARProfile()Landroid/os/Bundle;
-
-    move-result-object p0
-
-    return-object p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
-
 .method public static isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
     .locals 3
 
@@ -186,157 +42,36 @@
     return v0
 
     :cond_0
-    invoke-static {p0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARProfile(Landroid/content/Context;)Landroid/os/Bundle;
+    const-string/jumbo p1, "persona"
+
+    invoke-virtual {p0, p1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
 
     move-result-object p0
 
+    check-cast p0, Lcom/samsung/android/knox/SemPersonaManager;
+
     if-eqz p0, :cond_1
 
-    const-string/jumbo p0, "isDualDARConfigured from preset params"
+    invoke-virtual {p0}, Lcom/samsung/android/knox/SemPersonaManager;->getDualDARProfile()Landroid/os/Bundle;
 
-    invoke-static {v1, p0}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;)I
+    move-result-object p0
 
-    return v0
+    goto :goto_0
 
     :cond_1
     const/4 p0, 0x0
 
-    return p0
-.end method
-
-.method public static isDualDARIntentProvisioned(Landroid/os/PersistableBundle;)Z
-    .locals 1
-
-    if-eqz p0, :cond_0
-
-    const-string/jumbo v0, "dualdar-config"
-
-    invoke-virtual {p0, v0}, Landroid/os/PersistableBundle;->getBoolean(Ljava/lang/String;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const-string p0, "DualDarProvisioningHelper"
-
-    const-string/jumbo v0, "isDualDARIntentProvisioned from provisioning params"
-
-    invoke-static {p0, v0}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public static isDualDARNativeCrypto(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-    .locals 5
-
-    const/4 v0, 0x0
-
-    const-string/jumbo v1, "dualdar-config-client-package"
-
-    const-string v2, "DualDarProvisioningHelper"
-
-    if-eqz p1, :cond_0
-
-    invoke-virtual {p1, v1}, Landroid/os/PersistableBundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-static {v3}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result v3
-
-    if-nez v3, :cond_0
-
-    const-string p0, "Custom crypto from provisioning params"
-
-    invoke-static {v2, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v0
-
-    :cond_0
-    const/4 v3, 0x1
-
-    if-eqz p1, :cond_1
-
-    const-string/jumbo v4, "dualdar-config"
-
-    invoke-virtual {p1, v4}, Landroid/os/PersistableBundle;->getBoolean(Ljava/lang/String;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_1
-
-    const-string/jumbo p0, "native crypto from provisioning params"
-
-    invoke-static {v2, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v3
-
-    :cond_1
-    invoke-static {p0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARProfile(Landroid/content/Context;)Landroid/os/Bundle;
-
-    move-result-object p1
-
-    if-eqz p1, :cond_2
-
-    invoke-static {p0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARProfile(Landroid/content/Context;)Landroid/os/Bundle;
-
-    move-result-object p0
-
-    invoke-virtual {p0, v1}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string/jumbo p1, "default"
-
-    invoke-virtual {p1, p0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p0
-
+    :goto_0
     if-eqz p0, :cond_2
 
-    const-string/jumbo p0, "isDualDARNativeCrypto from preset params"
-
-    invoke-static {v2, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    const-string/jumbo p0, "isDualDARConfigured from preset params"
 
-    return v3
+    invoke-static {v1, p0}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_2
     return v0
-.end method
-
-
-# virtual methods
-.method public final startProvisionService(Landroid/content/Intent;)V
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    iget-object p0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->connection:Lcom/android/server/devicepolicy/DualDarProvisioningHelper$5;
-
-    const/16 v1, 0x41
-
-    invoke-virtual {v0, p1, p0, v1}, Landroid/content/Context;->bindService(Landroid/content/Intent;Landroid/content/ServiceConnection;I)Z
 
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    return-void
-
-    :cond_0
-    new-instance p0, Ljava/lang/Exception;
-
-    const-string/jumbo p1, "startProvisionService : failed to startService."
-
-    invoke-direct {p0, p1}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
+    :cond_2
+    const/4 p0, 0x0
 
-    throw p0
+    return p0
 .end method
diff --git a/smali/com/android/server/enterprise/EnterpriseDeviceManagerServiceImpl.smali b/smali/com/android/server/enterprise/EnterpriseDeviceManagerServiceImpl.smali
index a8e02ef66..fdfedca73 100644
--- a/smali/com/android/server/enterprise/EnterpriseDeviceManagerServiceImpl.smali
+++ b/smali/com/android/server/enterprise/EnterpriseDeviceManagerServiceImpl.smali
@@ -4445,89 +4445,75 @@
 .end method
 
 .method public final createDeferredServices()V
-    .locals 12
-
-    const-string/jumbo v0, "knox_adapter_service"
+    .locals 11
 
-    const-string/jumbo v1, "phone_restriction_policy"
+    const-string/jumbo v0, "phone_restriction_policy"
 
-    const-string/jumbo v2, "wifi_policy"
+    const-string/jumbo v1, "wifi_policy"
 
-    iget-boolean v3, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mDeferredServicesCreated:Z
+    iget-boolean v2, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mDeferredServicesCreated:Z
 
-    const-string v4, "EnterpriseDeviceManagerService"
+    const-string v3, "EnterpriseDeviceManagerService"
 
-    if-eqz v3, :cond_0
+    if-eqz v2, :cond_0
 
     const-string/jumbo p0, "createDeferredServices() : Skip to create"
 
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v3, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return-void
 
     :cond_0
-    const-string/jumbo v3, "createDeferredServices() : Adding services ... "
+    const-string/jumbo v2, "createDeferredServices() : Adding services ... "
 
-    invoke-static {v4, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/4 v3, 0x1
+    const/4 v2, 0x1
 
-    const/4 v5, -0x1
+    const/4 v4, -0x1
 
-    const/4 v6, 0x0
+    const/4 v5, 0x0
 
     :try_start_0
-    sget-object v7, Lcom/android/server/enterprise/EnterpriseService;->sLazyServiceList:Ljava/util/List;
+    sget-object v6, Lcom/android/server/enterprise/EnterpriseService;->sLazyServiceList:Ljava/util/List;
 
-    check-cast v7, Ljava/util/ArrayList;
+    check-cast v6, Ljava/util/ArrayList;
 
-    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I
+    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I
 
-    move-result v8
+    move-result v7
 
-    const/4 v9, 0x0
+    const/4 v8, 0x0
 
     :goto_0
-    if-ge v9, v8, :cond_1
+    if-ge v8, v7, :cond_1
 
-    invoke-virtual {v7, v9}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    invoke-virtual {v6, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
-    move-result-object v10
+    move-result-object v9
 
-    add-int/lit8 v9, v9, 0x1
+    add-int/lit8 v8, v8, 0x1
 
-    check-cast v10, Ljava/lang/String;
+    check-cast v9, Ljava/lang/String;
 
-    invoke-static {v10}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
+    invoke-static {v9}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
 
-    invoke-static {v10}, Lcom/android/server/enterprise/EnterpriseService;->getPolicyService(Ljava/lang/String;)Ljava/lang/Object;
+    invoke-static {v9}, Lcom/android/server/enterprise/EnterpriseService;->getPolicyService(Ljava/lang/String;)Ljava/lang/Object;
 
-    move-result-object v10
+    move-result-object v9
 
-    check-cast v10, Lcom/android/server/enterprise/EnterpriseServiceCallback;
+    check-cast v9, Lcom/android/server/enterprise/EnterpriseServiceCallback;
 
-    move-object v11, v10
+    move-object v10, v9
 
-    check-cast v11, Landroid/os/IBinder;
+    check-cast v10, Landroid/os/IBinder;
 
-    invoke-virtual {v10}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v9}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     goto :goto_0
 
     :cond_1
-    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
-
-    invoke-static {v2}, Lcom/android/server/enterprise/EnterpriseService;->getPolicyService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v8
-
-    check-cast v8, Lcom/android/server/enterprise/EnterpriseServiceCallback;
-
-    invoke-virtual {v7}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v8, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
-
-    iget-object v2, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    iget-object v6, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
     invoke-static {v1}, Lcom/android/server/enterprise/EnterpriseService;->getPolicyService(Ljava/lang/String;)Ljava/lang/Object;
 
@@ -4535,465 +4521,436 @@
 
     check-cast v7, Lcom/android/server/enterprise/EnterpriseServiceCallback;
 
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v6}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     invoke-static {v7, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
     iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    const-string/jumbo v2, "device_info"
-
-    new-instance v7, Lcom/android/server/enterprise/device/DeviceInfo;
-
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
-
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/device/DeviceInfo;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
-
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
-
-    const-string/jumbo v2, "license_log_service"
-
-    new-instance v7, Lcom/android/server/enterprise/license/LicenseLogService;
+    invoke-static {v0}, Lcom/android/server/enterprise/EnterpriseService;->getPolicyService(Ljava/lang/String;)Ljava/lang/Object;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    move-result-object v6
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/license/LicenseLogService;-><init>(Landroid/content/Context;)V
+    check-cast v6, Lcom/android/server/enterprise/EnterpriseServiceCallback;
 
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-static {v6, v0}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
-
-    const-string/jumbo v2, "auditlog"
-
-    new-instance v7, Lcom/android/server/enterprise/auditlog/AuditLogService;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "device_info"
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/auditlog/AuditLogService;-><init>(Landroid/content/Context;)V
+    new-instance v6, Lcom/android/server/enterprise/device/DeviceInfo;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/device/DeviceInfo;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "eas_account_policy"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/email/ExchangeAccountPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "license_log_service"
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/email/ExchangeAccountPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v6, Lcom/android/server/enterprise/license/LicenseLogService;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/license/LicenseLogService;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "email_account_policy"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/email/EmailAccountPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "auditlog"
 
-    invoke-direct {v7}, Lcom/samsung/android/knox/accounts/IEmailAccountPolicy$Stub;-><init>()V
+    new-instance v6, Lcom/android/server/enterprise/auditlog/AuditLogService;
 
-    iput-object v6, v7, Lcom/android/server/enterprise/email/EmailAccountPolicy;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iput v5, v7, Lcom/android/server/enterprise/email/EmailAccountPolicy;->preCallingUid:I
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/auditlog/AuditLogService;-><init>(Landroid/content/Context;)V
 
-    iput-object v6, v7, Lcom/android/server/enterprise/email/EmailAccountPolicy;->mEdmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    iput-object v8, v7, Lcom/android/server/enterprise/email/EmailAccountPolicy;->mContext:Landroid/content/Context;
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v9, Lcom/android/server/enterprise/storage/EdmStorageProvider;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    invoke-direct {v9, v8}, Lcom/android/server/enterprise/storage/EdmStorageProviderBase;-><init>(Landroid/content/Context;)V
+    const-string/jumbo v1, "eas_account_policy"
 
-    iput-object v9, v7, Lcom/android/server/enterprise/email/EmailAccountPolicy;->mEdmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
+    new-instance v6, Lcom/android/server/enterprise/email/ExchangeAccountPolicy;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/email/ExchangeAccountPolicy;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "location_policy"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/location/LocationPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "email_account_policy"
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/location/LocationPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v6, Lcom/android/server/enterprise/email/EmailAccountPolicy;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6}, Lcom/samsung/android/knox/accounts/IEmailAccountPolicy$Stub;-><init>()V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    iput-object v5, v6, Lcom/android/server/enterprise/email/EmailAccountPolicy;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
 
-    const-string/jumbo v2, "misc_policy"
+    iput v4, v6, Lcom/android/server/enterprise/email/EmailAccountPolicy;->preCallingUid:I
 
-    new-instance v7, Lcom/android/server/enterprise/general/MiscPolicy;
+    iput-object v5, v6, Lcom/android/server/enterprise/email/EmailAccountPolicy;->mEdmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    iput-object v7, v6, Lcom/android/server/enterprise/email/EmailAccountPolicy;->mContext:Landroid/content/Context;
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/general/MiscPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v8, Lcom/android/server/enterprise/storage/EdmStorageProvider;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-direct {v8, v7}, Lcom/android/server/enterprise/storage/EdmStorageProviderBase;-><init>(Landroid/content/Context;)V
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    iput-object v8, v6, Lcom/android/server/enterprise/email/EmailAccountPolicy;->mEdmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "vpn_policy"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "location_policy"
 
-    invoke-direct {v7}, Lcom/samsung/android/knox/net/vpn/IVpnInfoPolicy$Stub;-><init>()V
+    new-instance v6, Lcom/android/server/enterprise/location/LocationPolicy;
 
-    iput-object v6, v7, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iput-object v6, v7, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;->mEDMStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/location/LocationPolicy;-><init>(Landroid/content/Context;)V
 
-    iput-object v6, v7, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;->mVpnManager:Landroid/net/VpnManager;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    iput-object v8, v7, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;->mContext:Landroid/content/Context;
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v9, Lcom/android/server/enterprise/storage/EdmStorageProvider;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    invoke-direct {v9, v8}, Lcom/android/server/enterprise/storage/EdmStorageProviderBase;-><init>(Landroid/content/Context;)V
+    const-string/jumbo v1, "misc_policy"
 
-    iput-object v9, v7, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;->mEDMStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
+    new-instance v6, Lcom/android/server/enterprise/general/MiscPolicy;
 
-    invoke-static {}, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;->retrieveVpnListFromStorage()Ljava/util/ArrayList;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    move-result-object v8
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/general/MiscPolicy;-><init>(Landroid/content/Context;)V
 
-    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addLazySystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    const-string/jumbo v1, "vpn_policy"
 
-    const-string/jumbo v2, "security_policy"
+    new-instance v6, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;
 
-    new-instance v7, Lcom/android/server/enterprise/security/SecurityPolicy;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    invoke-direct {v6}, Lcom/samsung/android/knox/net/vpn/IVpnInfoPolicy$Stub;-><init>()V
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/security/SecurityPolicy;-><init>(Landroid/content/Context;)V
+    iput-object v5, v6, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iput-object v5, v6, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;->mEDMStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    iput-object v5, v6, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;->mVpnManager:Landroid/net/VpnManager;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    iput-object v7, v6, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;->mContext:Landroid/content/Context;
 
-    const-string/jumbo v2, "roaming_policy"
+    new-instance v8, Lcom/android/server/enterprise/storage/EdmStorageProvider;
 
-    new-instance v7, Lcom/android/server/enterprise/restriction/RoamingPolicy;
+    invoke-direct {v8, v7}, Lcom/android/server/enterprise/storage/EdmStorageProviderBase;-><init>(Landroid/content/Context;)V
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    iput-object v8, v6, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;->mEDMStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/restriction/RoamingPolicy;-><init>(Landroid/content/Context;)V
+    invoke-static {}, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;->retrieveVpnListFromStorage()Ljava/util/ArrayList;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    move-result-object v7
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "bluetooth_policy"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addLazySystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/bluetooth/BluetoothPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "security_policy"
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/bluetooth/BluetoothPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v6, Lcom/android/server/enterprise/security/SecurityPolicy;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/security/SecurityPolicy;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "email_policy"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/email/EmailPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "roaming_policy"
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/email/EmailPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v6, Lcom/android/server/enterprise/restriction/RoamingPolicy;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/restriction/RoamingPolicy;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "firewall"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/firewall/Firewall;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "bluetooth_policy"
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/firewall/Firewall;-><init>(Landroid/content/Context;)V
+    new-instance v6, Lcom/android/server/enterprise/bluetooth/BluetoothPolicy;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/bluetooth/BluetoothPolicy;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "certificate_policy"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/certificate/CertificatePolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "email_policy"
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/certificate/CertificatePolicy;-><init>(Landroid/content/Context;)V
+    new-instance v6, Lcom/android/server/enterprise/email/EmailPolicy;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/email/EmailPolicy;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "apn_settings_policy"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "firewall"
 
-    invoke-direct {v7}, Lcom/samsung/android/knox/net/apn/IApnSettingsPolicy$Stub;-><init>()V
+    new-instance v6, Lcom/android/server/enterprise/firewall/Firewall;
 
-    iput-object v6, v7, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    sget v9, Lcom/samsung/android/knox/KnoxInternalFeature;->KNOX_CONFIG_MDM_VERSION:I
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/firewall/Firewall;-><init>(Landroid/content/Context;)V
 
-    iput v9, v7, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;->mMDMConfigVersion:I
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    new-instance v9, Ljava/util/HashMap;
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    invoke-direct {v9}, Ljava/util/HashMap;-><init>()V
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iput-object v9, v7, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;->mPendingGetApnList:Ljava/util/HashMap;
+    const-string/jumbo v1, "certificate_policy"
 
-    iput-object v8, v7, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;->mContext:Landroid/content/Context;
+    new-instance v6, Lcom/android/server/enterprise/certificate/CertificatePolicy;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/certificate/CertificatePolicy;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "browser_policy"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/browser/BrowserPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "apn_settings_policy"
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/browser/BrowserPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v6, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6}, Lcom/samsung/android/knox/net/apn/IApnSettingsPolicy$Stub;-><init>()V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    iput-object v5, v6, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
 
-    const-string/jumbo v2, "date_time_policy"
+    sget v8, Lcom/samsung/android/knox/KnoxInternalFeature;->KNOX_CONFIG_MDM_VERSION:I
 
-    new-instance v7, Lcom/android/server/enterprise/datetime/DateTimePolicy;
+    iput v8, v6, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;->mMDMConfigVersion:I
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    new-instance v8, Ljava/util/HashMap;
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/datetime/DateTimePolicy;-><init>(Landroid/content/Context;)V
+    invoke-direct {v8}, Ljava/util/HashMap;-><init>()V
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iput-object v8, v6, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;->mPendingGetApnList:Ljava/util/HashMap;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    iput-object v7, v6, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "kioskmode"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/kioskmode/KioskModeService;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "browser_policy"
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/kioskmode/KioskModeService;-><init>(Landroid/content/Context;)V
+    new-instance v6, Lcom/android/server/enterprise/browser/BrowserPolicy;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/browser/BrowserPolicy;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "ldap_account_policy"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/email/LDAPAccountPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "date_time_policy"
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/email/LDAPAccountPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v6, Lcom/android/server/enterprise/datetime/DateTimePolicy;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/datetime/DateTimePolicy;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "lockscreen_overlay"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/lso/LSOService;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "kioskmode"
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/lso/LSOService;-><init>(Landroid/content/Context;)V
+    new-instance v6, Lcom/android/server/enterprise/kioskmode/KioskModeService;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/kioskmode/KioskModeService;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "geofencing"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/geofencing/GeofenceService;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "ldap_account_policy"
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/geofencing/GeofenceService;-><init>(Landroid/content/Context;)V
+    new-instance v6, Lcom/android/server/enterprise/email/LDAPAccountPolicy;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/email/LDAPAccountPolicy;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "device_account_policy"
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    new-instance v7, Lcom/android/server/enterprise/security/DeviceAccountPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "lockscreen_overlay"
 
-    invoke-direct {v7}, Lcom/samsung/android/knox/accounts/IDeviceAccountPolicy$Stub;-><init>()V
+    new-instance v6, Lcom/android/server/enterprise/lso/LSOService;
 
-    iput-object v6, v7, Lcom/android/server/enterprise/security/DeviceAccountPolicy;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iput-object v8, v7, Lcom/android/server/enterprise/security/DeviceAccountPolicy;->mContext:Landroid/content/Context;
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/lso/LSOService;-><init>(Landroid/content/Context;)V
 
-    new-instance v9, Lcom/android/server/enterprise/storage/EdmStorageProvider;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-direct {v9, v8}, Lcom/android/server/enterprise/storage/EdmStorageProviderBase;-><init>(Landroid/content/Context;)V
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    iput-object v9, v7, Lcom/android/server/enterprise/security/DeviceAccountPolicy;->mEdmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    const-string/jumbo v1, "geofencing"
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    new-instance v6, Lcom/android/server/enterprise/geofencing/GeofenceService;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    const-string/jumbo v2, "multi_user_manager_service"
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/geofencing/GeofenceService;-><init>(Landroid/content/Context;)V
 
-    new-instance v7, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    invoke-direct {v7}, Lcom/samsung/android/knox/multiuser/IMultiUserManager$Stub;-><init>()V
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iput-object v6, v7, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
+    const-string/jumbo v1, "device_account_policy"
 
-    iput-object v8, v7, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;->mContext:Landroid/content/Context;
+    new-instance v6, Lcom/android/server/enterprise/security/DeviceAccountPolicy;
 
-    new-instance v9, Lcom/android/server/enterprise/storage/EdmStorageProvider;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-direct {v9, v8}, Lcom/android/server/enterprise/storage/EdmStorageProviderBase;-><init>(Landroid/content/Context;)V
+    invoke-direct {v6}, Lcom/samsung/android/knox/accounts/IDeviceAccountPolicy$Stub;-><init>()V
 
-    iput-object v9, v7, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;->mEdmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
+    iput-object v5, v6, Lcom/android/server/enterprise/security/DeviceAccountPolicy;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
 
-    const-string/jumbo v9, "user"
+    iput-object v7, v6, Lcom/android/server/enterprise/security/DeviceAccountPolicy;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v8, v9}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
+    new-instance v8, Lcom/android/server/enterprise/storage/EdmStorageProvider;
 
-    move-result-object v8
+    invoke-direct {v8, v7}, Lcom/android/server/enterprise/storage/EdmStorageProviderBase;-><init>(Landroid/content/Context;)V
 
-    check-cast v8, Landroid/os/UserManager;
+    iput-object v8, v6, Lcom/android/server/enterprise/security/DeviceAccountPolicy;->mEdmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
 
-    iput-object v8, v7, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;->mUserManager:Landroid/os/UserManager;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    const-string/jumbo v1, "multi_user_manager_service"
 
-    const-string/jumbo v2, "dex_policy"
+    new-instance v6, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;
 
-    new-instance v7, Lcom/android/server/enterprise/dex/DexPolicy;
+    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v8, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    invoke-direct {v6}, Lcom/samsung/android/knox/multiuser/IMultiUserManager$Stub;-><init>()V
 
-    invoke-direct {v7, v8}, Lcom/android/server/enterprise/dex/DexPolicy;-><init>(Landroid/content/Context;)V
+    iput-object v5, v6, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iput-object v7, v6, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;->mContext:Landroid/content/Context;
 
-    invoke-static {v7, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    new-instance v8, Lcom/android/server/enterprise/storage/EdmStorageProvider;
 
-    invoke-static {v0}, Lcom/android/server/enterprise/EnterpriseService;->getPolicyService(Ljava/lang/String;)Ljava/lang/Object;
+    invoke-direct {v8, v7}, Lcom/android/server/enterprise/storage/EdmStorageProviderBase;-><init>(Landroid/content/Context;)V
 
-    move-result-object v1
+    iput-object v8, v6, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;->mEdmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
 
-    if-nez v1, :cond_2
+    const-string/jumbo v8, "user"
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-virtual {v7, v8}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
 
-    new-instance v2, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
+    move-result-object v7
 
-    iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    check-cast v7, Landroid/os/UserManager;
 
-    invoke-direct {v2, v7}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;-><init>(Landroid/content/Context;)V
+    iput-object v7, v6, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;->mUserManager:Landroid/os/UserManager;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v2, v0}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
     iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    const-string v1, "DualDARPolicy"
+    const-string/jumbo v1, "dex_policy"
 
-    new-instance v2, Lcom/android/server/enterprise/dualdar/DualDARPolicy;
+    new-instance v6, Lcom/android/server/enterprise/dex/DexPolicy;
 
     iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-direct {v2, v7}, Lcom/android/server/enterprise/dualdar/DualDARPolicy;-><init>(Landroid/content/Context;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/dex/DexPolicy;-><init>(Landroid/content/Context;)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v2, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    goto :goto_1
-
-    :catchall_0
-    move-exception v0
-
-    goto :goto_2
-
-    :cond_2
-    :goto_1
     new-instance v0, Lcom/samsung/android/knox/ContextInfo;
 
     invoke-direct {v0}, Lcom/samsung/android/knox/ContextInfo;-><init>()V
@@ -5008,17 +4965,17 @@
 
     move-result v1
 
-    const/16 v2, 0x18
+    const/16 v6, 0x18
 
-    if-lt v1, v2, :cond_3
+    if-lt v1, v6, :cond_2
 
     new-instance v1, Ljava/lang/StringBuilder;
 
     invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
 
-    const-string/jumbo v2, "ThreatDefenseService - knoxSdkVersion : "
+    const-string/jumbo v6, "ThreatDefenseService - knoxSdkVersion : "
 
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v0}, Lcom/samsung/android/knox/EdmConstants$EnterpriseKnoxSdkVersion;->ordinal()I
 
@@ -5030,48 +4987,56 @@
 
     move-result-object v0
 
-    invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v3, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
     const-string/jumbo v1, "threat_defense_service"
 
-    new-instance v2, Lcom/android/server/enterprise/threatdefense/ThreatDefenseService;
+    new-instance v6, Lcom/android/server/enterprise/threatdefense/ThreatDefenseService;
 
     iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-direct {v2, v7}, Lcom/android/server/enterprise/threatdefense/ThreatDefenseService;-><init>(Landroid/content/Context;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/threatdefense/ThreatDefenseService;-><init>(Landroid/content/Context;)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v2, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
-    :cond_3
+    goto :goto_1
+
+    :catchall_0
+    move-exception v0
+
+    goto :goto_2
+
+    :cond_2
+    :goto_1
     iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
     const-string/jumbo v1, "knoxnap"
 
-    new-instance v2, Lcom/android/server/enterprise/nap/NetworkAnalyticsService;
+    new-instance v6, Lcom/android/server/enterprise/nap/NetworkAnalyticsService;
 
     iget-object v7, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-direct {v2, v7}, Lcom/android/server/enterprise/nap/NetworkAnalyticsService;-><init>(Landroid/content/Context;)V
+    invoke-direct {v6, v7}, Lcom/android/server/enterprise/nap/NetworkAnalyticsService;-><init>(Landroid/content/Context;)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v2, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addLazySystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
+    invoke-static {v6, v1}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addLazySystemService(Lcom/android/server/enterprise/EnterpriseServiceCallback;Ljava/lang/String;)V
 
     const-string/jumbo v0, "knox ztna service started"
 
-    invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v3, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
     new-instance v1, Lcom/android/server/enterprise/filter/KnoxNetworkFilterService;
 
-    iget-object v2, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    iget-object v6, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-direct {v1, v2}, Lcom/android/server/enterprise/filter/KnoxNetworkFilterService;-><init>(Landroid/content/Context;)V
+    invoke-direct {v1, v6}, Lcom/android/server/enterprise/filter/KnoxNetworkFilterService;-><init>(Landroid/content/Context;)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -5091,7 +5056,7 @@
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v0, v3, v1}, Lcom/android/server/enterprise/plm/common/PlmMessage;->obtain(Landroid/os/Handler;ILjava/lang/Object;)Landroid/os/Message;
+    invoke-static {v0, v2, v1}, Lcom/android/server/enterprise/plm/common/PlmMessage;->obtain(Landroid/os/Handler;ILjava/lang/Object;)Landroid/os/Message;
 
     move-result-object v1
 
@@ -5104,9 +5069,9 @@
     :goto_2
     new-instance v1, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v2, "addServices() : Failure creating Policy services"
+    const-string/jumbo v6, "addServices() : Failure creating Policy services"
 
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v1, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
     invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
 
@@ -5114,12 +5079,12 @@
 
     move-result-object v1
 
-    invoke-static {v4, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v3, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-virtual {v0}, Ljava/lang/Throwable;->printStackTrace()V
 
     :goto_3
-    iput-boolean v3, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mDeferredServicesCreated:Z
+    iput-boolean v2, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mDeferredServicesCreated:Z
 
     invoke-virtual {p0}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->setMediators()V
 
@@ -5131,7 +5096,7 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mMonitor:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$MyPackageMonitor;
 
-    if-nez v0, :cond_4
+    if-nez v0, :cond_3
 
     new-instance v0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$MyPackageMonitor;
 
@@ -5143,11 +5108,11 @@
 
     new-instance v1, Landroid/os/UserHandle;
 
-    invoke-direct {v1, v5}, Landroid/os/UserHandle;-><init>(I)V
+    invoke-direct {v1, v4}, Landroid/os/UserHandle;-><init>(I)V
 
-    invoke-virtual {v0, p0, v6, v1, v3}, Lcom/android/internal/content/PackageMonitor;->register(Landroid/content/Context;Landroid/os/Looper;Landroid/os/UserHandle;Z)V
+    invoke-virtual {v0, p0, v5, v1, v2}, Lcom/android/internal/content/PackageMonitor;->register(Landroid/content/Context;Landroid/os/Looper;Landroid/os/UserHandle;Z)V
 
-    :cond_4
+    :cond_3
     invoke-static {}, Lcom/android/server/enterprise/EnterpriseService;->getPolicyServices()Ljava/util/Map;
 
     move-result-object p0
@@ -5162,13 +5127,13 @@
 
     move-result-object p0
 
-    :cond_5
+    :cond_4
     :goto_4
     invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
 
     move-result v0
 
-    if-eqz v0, :cond_6
+    if-eqz v0, :cond_5
 
     invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -5186,7 +5151,7 @@
 
     move-result v1
 
-    if-eqz v1, :cond_5
+    if-eqz v1, :cond_4
 
     invoke-interface {v0}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
 
@@ -5198,7 +5163,7 @@
 
     goto :goto_4
 
-    :cond_6
+    :cond_5
     return-void
 .end method
 
diff --git a/smali/com/android/server/enterprise/container/KnoxMUMContainerPolicy$2.smali b/smali/com/android/server/enterprise/container/KnoxMUMContainerPolicy$2.smali
index 5474d9ace..d5cf8b89a 100644
--- a/smali/com/android/server/enterprise/container/KnoxMUMContainerPolicy$2.smali
+++ b/smali/com/android/server/enterprise/container/KnoxMUMContainerPolicy$2.smali
@@ -394,7 +394,7 @@
 .end method
 
 .method public final onDeviceOwnerLicenseActivated(Landroid/content/Context;Landroid/os/Bundle;)V
-    .locals 3
+    .locals 2
 
     sget-object p1, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
 
@@ -410,13 +410,7 @@
 
     iget-object p2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$2;->this$0:Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;
 
-    invoke-static {p2}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->-$$Nest$misDualDarLicenseLockedCase(Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;)Z
-
-    move-result p2
-
-    const/4 v0, 0x0
-
-    if-nez p2, :cond_1
+    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     iget-object p0, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$2;->this$0:Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;
 
@@ -428,6 +422,8 @@
 
     move-result p0
 
+    const/4 p2, 0x0
+
     if-eqz p0, :cond_0
 
     invoke-static {}, Lcom/samsung/android/knox/SemPersonaManager;->getUCMDAREncryption()Z
@@ -437,15 +433,14 @@
     goto :goto_0
 
     :cond_0
-    move p0, v0
+    move p0, p2
 
     :goto_0
-    if-eqz p0, :cond_2
+    if-eqz p0, :cond_1
 
-    :cond_1
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v1
+    move-result-wide v0
 
     :try_start_0
     sget-object p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
@@ -454,12 +449,12 @@
 
     move-result-object p0
 
-    invoke-virtual {p0, v0, v0, v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->setAdminLockEnabled(IZZ)V
+    invoke-virtual {p0, p2, p2, p2}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->setAdminLockEnabled(IZZ)V
     :try_end_0
     .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return-void
 
@@ -480,15 +475,18 @@
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :cond_2
-    return-void
+    goto :goto_2
 
     :goto_1
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw p0
+
+    :cond_1
+    :goto_2
+    return-void
 .end method
 
 .method public final onDeviceOwnerLicenseExpired(Landroid/content/Context;Landroid/os/Bundle;)V
@@ -504,13 +502,7 @@
 
     iget-object p2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$2;->this$0:Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;
 
-    invoke-static {p2}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->-$$Nest$misDualDarLicenseLockedCase(Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;)Z
-
-    move-result p2
-
-    const/4 v0, 0x0
-
-    if-nez p2, :cond_1
+    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     iget-object p0, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$2;->this$0:Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;
 
@@ -522,6 +514,8 @@
 
     move-result p0
 
+    const/4 p2, 0x0
+
     if-eqz p0, :cond_0
 
     invoke-static {}, Lcom/samsung/android/knox/SemPersonaManager;->getUCMDAREncryption()Z
@@ -531,15 +525,14 @@
     goto :goto_0
 
     :cond_0
-    move p0, v0
+    move p0, p2
 
     :goto_0
-    if-eqz p0, :cond_2
+    if-eqz p0, :cond_1
 
-    :cond_1
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v1
+    move-result-wide v0
 
     :try_start_0
     sget-object p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
@@ -548,14 +541,14 @@
 
     move-result-object p0
 
-    const/4 p2, 0x1
+    const/4 v2, 0x1
 
-    invoke-virtual {p0, v0, p2, p2}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->setAdminLockEnabled(IZZ)V
+    invoke-virtual {p0, p2, v2, v2}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->setAdminLockEnabled(IZZ)V
     :try_end_0
     .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return-void
 
@@ -576,13 +569,16 @@
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :cond_2
-    return-void
+    goto :goto_2
 
     :goto_1
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw p0
+
+    :cond_1
+    :goto_2
+    return-void
 .end method
diff --git a/smali/com/android/server/enterprise/container/KnoxMUMContainerPolicy.smali b/smali/com/android/server/enterprise/container/KnoxMUMContainerPolicy.smali
index 4b5baa5ce..5fa963750 100644
--- a/smali/com/android/server/enterprise/container/KnoxMUMContainerPolicy.smali
+++ b/smali/com/android/server/enterprise/container/KnoxMUMContainerPolicy.smali
@@ -73,124 +73,6 @@
 
 
 # direct methods
-.method public static -$$Nest$misDualDarLicenseLockedCase(Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;)Z
-    .locals 4
-
-    invoke-virtual {p0}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->getUserManagerService()Landroid/os/UserManager;
-
-    move-result-object v0
-
-    const/4 v1, 0x0
-
-    invoke-virtual {v0, v1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Landroid/content/pm/UserInfo;->isAdminLocked()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto :goto_1
-
-    :cond_0
-    invoke-static {v1}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    invoke-static {v1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    invoke-virtual {p0}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->getDevicePolicyService()Landroid/app/admin/DevicePolicyManager;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Landroid/app/admin/DevicePolicyManager;->isOrganizationOwnedDeviceWithManagedProfile()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    invoke-virtual {p0}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->getUserManagerService()Landroid/os/UserManager;
-
-    move-result-object v0
-
-    invoke-virtual {v0, v1}, Landroid/os/UserManager;->getProfiles(I)Ljava/util/List;
-
-    move-result-object v0
-
-    invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v0
-
-    :cond_2
-    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_3
-
-    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Landroid/content/pm/UserInfo;
-
-    invoke-virtual {v2}, Landroid/content/pm/UserInfo;->getUserHandle()Landroid/os/UserHandle;
-
-    move-result-object v2
-
-    invoke-virtual {v2}, Landroid/os/UserHandle;->getIdentifier()I
-
-    move-result v2
-
-    invoke-static {v2}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_2
-
-    invoke-static {v2}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_2
-
-    invoke-virtual {p0}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->getDevicePolicyService()Landroid/app/admin/DevicePolicyManager;
-
-    move-result-object v2
-
-    if-eqz v2, :cond_2
-
-    invoke-virtual {p0}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->getDevicePolicyService()Landroid/app/admin/DevicePolicyManager;
-
-    move-result-object v2
-
-    invoke-virtual {v2}, Landroid/app/admin/DevicePolicyManager;->isOrganizationOwnedDeviceWithManagedProfile()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_2
-
-    :goto_0
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_3
-    :goto_1
-    return v1
-.end method
-
 .method public static -$$Nest$mnotifyDOPremiumActivation(Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;)V
     .locals 2
 
diff --git a/smali/com/android/server/enterprise/dualdar/DualDARPolicy.smali b/smali/com/android/server/enterprise/dualdar/DualDARPolicy.smali
index 6d343016c..03c4421d1 100644
--- a/smali/com/android/server/enterprise/dualdar/DualDARPolicy.smali
+++ b/smali/com/android/server/enterprise/dualdar/DualDARPolicy.smali
@@ -6,10 +6,6 @@
 .implements Lcom/android/server/enterprise/EnterpriseServiceCallback;
 
 
-# static fields
-.field public static final synthetic $r8$clinit:I
-
-
 # instance fields
 .field public final context:Landroid/content/Context;
 
@@ -2072,7 +2068,7 @@
 .end method
 
 .method public final setConfig(Lcom/samsung/android/knox/ContextInfo;Landroid/os/Bundle;)I
-    .locals 20
+    .locals 21
 
     move-object/from16 v1, p0
 
@@ -2137,7 +2133,7 @@
 
     const-string v8, "DUAL_DAR"
 
-    if-eqz v7, :cond_9
+    if-eqz v7, :cond_a
 
     new-instance v7, Ljava/util/ArrayList;
 
@@ -2236,43 +2232,103 @@
 
     move-result-wide v13
 
-    if-eqz v12, :cond_6
+    if-eqz v12, :cond_7
 
     array-length v0, v12
 
-    if-eqz v0, :cond_6
+    if-eqz v0, :cond_7
 
     array-length v15, v12
 
     move v5, v4
 
     :goto_2
-    if-ge v5, v15, :cond_6
+    if-ge v5, v15, :cond_7
 
     aget-object v16, v12, v5
 
-    iget v0, v3, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
+    iget v4, v3, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
+
+    move/from16 v17, v5
 
     invoke-virtual/range {v16 .. v16}, Lcom/samsung/android/knox/AppIdentity;->getPackageName()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v5
 
-    invoke-static {v0, v4}, Lcom/android/server/pm/PersonaServiceHelper;->isSystemApp(ILjava/lang/String;)Z
+    sget-object v0, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
 
-    move-result v0
+    :try_start_0
+    invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
 
-    if-eqz v0, :cond_5
+    move-result-object v0
+    :try_end_0
+    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1
+
+    move-object/from16 v18, v12
+
+    move-wide/from16 v19, v13
+
+    const-wide/16 v12, 0x80
+
+    :try_start_1
+    invoke-interface {v0, v5, v12, v13, v4}, Landroid/content/pm/IPackageManager;->getApplicationInfo(Ljava/lang/String;JI)Landroid/content/pm/ApplicationInfo;
+
+    move-result-object v0
+
+    if-nez v0, :cond_4
+
+    goto :goto_4
 
     :cond_4
-    move/from16 v17, v5
+    iget v0, v0, Landroid/content/pm/ApplicationInfo;->flags:I
+    :try_end_1
+    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
 
-    move-object/from16 v18, v9
+    and-int/lit16 v0, v0, 0x81
 
-    move-object/from16 v19, v11
+    if-eqz v0, :cond_5
 
     goto :goto_5
 
+    :catch_0
+    move-exception v0
+
+    goto :goto_3
+
+    :catch_1
+    move-exception v0
+
+    move-object/from16 v18, v12
+
+    move-wide/from16 v19, v13
+
+    :goto_3
+    new-instance v12, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v13, "Unable to check is System App for: "
+
+    invoke-direct {v12, v13}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v12, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    const-string v5, " in user: "
+
+    invoke-virtual {v12, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    const-string/jumbo v5, "PersonaServiceHelper"
+
+    invoke-static {v5, v4}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
+
     :cond_5
+    :goto_4
     invoke-virtual/range {v16 .. v16}, Lcom/samsung/android/knox/AppIdentity;->getPackageName()Ljava/lang/String;
 
     move-result-object v0
@@ -2281,7 +2337,7 @@
 
     move-result v0
 
-    if-nez v0, :cond_4
+    if-nez v0, :cond_6
 
     invoke-virtual/range {v16 .. v16}, Lcom/samsung/android/knox/AppIdentity;->getPackageName()Ljava/lang/String;
 
@@ -2291,9 +2347,9 @@
 
     move-result v0
 
-    if-nez v0, :cond_4
+    if-nez v0, :cond_6
 
-    :try_start_0
+    :try_start_2
     invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;
 
     move-result-object v0
@@ -2301,54 +2357,22 @@
     invoke-virtual/range {v16 .. v16}, Lcom/samsung/android/knox/AppIdentity;->getPackageName()Ljava/lang/String;
 
     move-result-object v4
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_2
-
-    move/from16 v17, v5
 
-    :try_start_1
     iget v5, v3, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1
 
-    move-object/from16 v18, v9
-
-    const/4 v9, 0x0
-
-    move-object/from16 v19, v11
+    const/4 v12, 0x0
 
-    const/4 v11, 0x0
+    const/4 v13, 0x0
 
-    :try_start_2
-    invoke-interface {v0, v4, v11, v9, v5}, Landroid/app/IActivityManager;->clearApplicationUserData(Ljava/lang/String;ZLandroid/content/pm/IPackageDataObserver;I)Z
+    invoke-interface {v0, v4, v13, v12, v5}, Landroid/app/IActivityManager;->clearApplicationUserData(Ljava/lang/String;ZLandroid/content/pm/IPackageDataObserver;I)Z
     :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0
+    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_2
 
     goto :goto_5
 
-    :catch_0
-    move-exception v0
-
-    goto :goto_4
-
-    :catch_1
-    move-exception v0
-
-    :goto_3
-    move-object/from16 v18, v9
-
-    move-object/from16 v19, v11
-
-    goto :goto_4
-
     :catch_2
     move-exception v0
 
-    move/from16 v17, v5
-
-    goto :goto_3
-
-    :goto_4
     invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
 
     new-instance v0, Ljava/lang/StringBuilder;
@@ -2375,25 +2399,28 @@
 
     move-result-object v0
 
-    const/4 v11, 0x0
+    const/4 v13, 0x0
 
-    new-array v4, v11, [Ljava/lang/Object;
+    new-array v4, v13, [Ljava/lang/Object;
 
     invoke-static {v6, v0, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
+    :cond_6
     :goto_5
     add-int/lit8 v5, v17, 0x1
 
-    move-object/from16 v9, v18
+    move-object/from16 v12, v18
 
-    move-object/from16 v11, v19
+    move-wide/from16 v13, v19
 
     const/4 v4, 0x0
 
-    goto :goto_2
+    goto/16 :goto_2
 
-    :cond_6
-    invoke-static {v13, v14}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :cond_7
+    move-wide/from16 v19, v13
+
+    invoke-static/range {v19 .. v20}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     invoke-virtual {v7, v10}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z
 
@@ -2413,9 +2440,9 @@
 
     move-result-object v0
 
-    const/4 v11, 0x0
+    const/4 v13, 0x0
 
-    new-array v4, v11, [Ljava/lang/Object;
+    new-array v4, v13, [Ljava/lang/Object;
 
     invoke-static {v6, v0, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
@@ -2449,13 +2476,13 @@
 
     move-result v0
 
-    if-eqz v0, :cond_7
+    if-eqz v0, :cond_8
 
     const-string/jumbo v4, "successfully changed whitelist packages for datalock state"
 
-    const/4 v11, 0x0
+    const/4 v13, 0x0
 
-    new-array v5, v11, [Ljava/lang/Object;
+    new-array v5, v13, [Ljava/lang/Object;
 
     invoke-static {v6, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
@@ -2465,32 +2492,32 @@
 
     goto :goto_6
 
-    :cond_7
-    const/4 v11, 0x0
+    :cond_8
+    const/4 v13, 0x0
 
     const-string/jumbo v4, "failed to write new whitelist packages to persistent storage"
 
-    new-array v5, v11, [Ljava/lang/Object;
+    new-array v5, v13, [Ljava/lang/Object;
 
     invoke-static {v6, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     :goto_6
-    if-eqz v0, :cond_8
+    if-eqz v0, :cond_9
 
     const/4 v0, 0x0
 
     goto :goto_7
 
-    :cond_8
+    :cond_9
     const/4 v0, -0x2
 
     :goto_7
-    move v11, v0
+    move v13, v0
 
     goto :goto_8
 
-    :cond_9
-    const/4 v11, 0x0
+    :cond_a
+    const/4 v13, 0x0
 
     :goto_8
     const-string/jumbo v0, "dualdar-config-datalock-timeout"
@@ -2501,7 +2528,7 @@
 
     const-string v5, ""
 
-    if-eqz v4, :cond_10
+    if-eqz v4, :cond_11
 
     invoke-virtual {v2, v0}, Landroid/os/Bundle;->getLong(Ljava/lang/String;)J
 
@@ -2513,14 +2540,14 @@
 
     move-result v4
 
-    if-eqz v4, :cond_a
+    if-eqz v4, :cond_b
 
-    const-wide/32 v12, 0x493e0
+    const-wide/32 v11, 0x493e0
 
     goto :goto_9
 
-    :cond_a
-    const-wide/32 v12, 0xea60
+    :cond_b
+    const-wide/32 v11, 0xea60
 
     :goto_9
     const-string/jumbo v4, "setDataLockTimeout called, dataLockTimeout: "
@@ -2535,24 +2562,24 @@
 
     invoke-static {v6, v4, v14}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    cmp-long v4, v9, v12
+    cmp-long v4, v9, v11
 
-    if-ltz v4, :cond_b
+    if-ltz v4, :cond_c
 
     const-wide v14, 0x7fffffffffffffffL
 
     cmp-long v4, v9, v14
 
-    if-ltz v4, :cond_c
+    if-ltz v4, :cond_d
 
-    :cond_b
+    :cond_c
     const-wide/16 v14, -0x1
 
     cmp-long v4, v9, v14
 
-    if-nez v4, :cond_f
+    if-nez v4, :cond_10
 
-    :cond_c
+    :cond_d
     new-instance v4, Landroid/content/ContentValues;
 
     invoke-direct {v4}, Landroid/content/ContentValues;-><init>()V
@@ -2581,7 +2608,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_d
+    if-eqz v4, :cond_e
 
     const-string/jumbo v7, "successfully changed datalock timeout"
 
@@ -2597,7 +2624,7 @@
 
     goto :goto_a
 
-    :cond_d
+    :cond_e
     const/4 v9, 0x0
 
     const-string/jumbo v7, "failed to write new datalock timeout to persistent storage"
@@ -2607,24 +2634,24 @@
     invoke-static {v6, v7, v10}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     :goto_a
-    if-eqz v4, :cond_e
+    if-eqz v4, :cond_f
 
     goto :goto_c
 
-    :cond_e
+    :cond_f
     :goto_b
     const/4 v4, -0x1
 
     goto :goto_d
 
-    :cond_f
+    :cond_10
     new-instance v4, Ljava/lang/StringBuilder;
 
     const-string/jumbo v7, "setDataLockTimeout Invalid datalock timeout. It should be in range ["
 
     invoke-direct {v4, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v4, v12, v13}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
+    invoke-virtual {v4, v11, v12}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
 
     const-string v7, ", 9223372036854775807] ms"
 
@@ -2642,7 +2669,7 @@
 
     goto :goto_b
 
-    :cond_10
+    :cond_11
     :goto_c
     const/4 v4, 0x0
 
@@ -2653,7 +2680,7 @@
 
     move-result v9
 
-    if-eqz v9, :cond_13
+    if-eqz v9, :cond_14
 
     invoke-virtual {v2, v7}, Landroid/os/Bundle;->getBoolean(Ljava/lang/String;)Z
 
@@ -2661,9 +2688,9 @@
 
     new-instance v10, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v12, "setDeRestriction called, deRestriction: "
+    const-string/jumbo v11, "setDeRestriction called, deRestriction: "
 
-    invoke-direct {v10, v12}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v10, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
     invoke-virtual {v10, v9}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
@@ -2671,11 +2698,11 @@
 
     move-result-object v10
 
-    const/4 v12, 0x0
+    const/4 v11, 0x0
 
-    new-array v13, v12, [Ljava/lang/Object;
+    new-array v12, v11, [Ljava/lang/Object;
 
-    invoke-static {v6, v10, v13}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v6, v10, v12}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     new-instance v10, Landroid/content/ContentValues;
 
@@ -2685,27 +2712,27 @@
 
     move-result-object v9
 
-    const-string/jumbo v12, "deRestriction"
+    const-string/jumbo v11, "deRestriction"
 
-    invoke-virtual {v10, v12, v9}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V
+    invoke-virtual {v10, v11, v9}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V
 
     iget-object v9, v1, Lcom/android/server/enterprise/dualdar/DualDARPolicy;->edmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
 
-    iget v12, v3, Lcom/samsung/android/knox/ContextInfo;->mCallerUid:I
+    iget v11, v3, Lcom/samsung/android/knox/ContextInfo;->mCallerUid:I
 
-    iget v13, v3, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
+    iget v12, v3, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
 
-    invoke-virtual {v9, v12, v13, v8, v10}, Lcom/android/server/enterprise/storage/EdmStorageProviderBase;->putValues(IILjava/lang/String;Landroid/content/ContentValues;)Z
+    invoke-virtual {v9, v11, v12, v8, v10}, Lcom/android/server/enterprise/storage/EdmStorageProviderBase;->putValues(IILjava/lang/String;Landroid/content/ContentValues;)Z
 
     move-result v8
 
-    if-eqz v8, :cond_11
+    if-eqz v8, :cond_12
 
     const-string/jumbo v9, "Successfully changed DE restriction config"
 
-    const/4 v12, 0x0
+    const/4 v11, 0x0
 
-    new-array v10, v12, [Ljava/lang/Object;
+    new-array v10, v11, [Ljava/lang/Object;
 
     invoke-static {v6, v9, v10}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
@@ -2715,37 +2742,37 @@
 
     goto :goto_e
 
-    :cond_11
-    const/4 v12, 0x0
+    :cond_12
+    const/4 v11, 0x0
 
     const-string v9, "Failed to write new DE restriction config"
 
-    new-array v10, v12, [Ljava/lang/Object;
+    new-array v10, v11, [Ljava/lang/Object;
 
     invoke-static {v6, v9, v10}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     :goto_e
-    if-eqz v8, :cond_12
+    if-eqz v8, :cond_13
 
     goto :goto_f
 
-    :cond_12
+    :cond_13
     const/4 v6, -0x3
 
     goto :goto_10
 
-    :cond_13
+    :cond_14
     :goto_f
     const/4 v6, 0x0
 
     :goto_10
-    if-eqz v11, :cond_14
+    if-eqz v13, :cond_15
 
-    if-eqz v4, :cond_14
+    if-eqz v4, :cond_15
 
-    if-nez v6, :cond_15
+    if-nez v6, :cond_16
 
-    :cond_14
+    :cond_15
     iget v8, v3, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
 
     iget-object v9, v1, Lcom/android/server/enterprise/dualdar/DualDARPolicy;->edmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
@@ -2756,7 +2783,7 @@
 
     invoke-virtual {v1, v9, v8}, Lcom/android/server/enterprise/dualdar/DualDARPolicy;->refreshConfig(II)V
 
-    :cond_15
+    :cond_16
     iget v1, v3, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
 
     invoke-static {v1}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
@@ -2781,11 +2808,11 @@
 
     move-result-object v10
 
-    if-nez v10, :cond_16
+    if-nez v10, :cond_17
 
     move-object v10, v5
 
-    :cond_16
+    :cond_17
     invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     const-string v10, ",  Lock Timeout :"
@@ -2794,9 +2821,9 @@
 
     invoke-virtual {v2, v0}, Landroid/os/Bundle;->getLong(Ljava/lang/String;)J
 
-    move-result-wide v12
+    move-result-wide v10
 
-    invoke-virtual {v9, v12, v13}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
+    invoke-virtual {v9, v10, v11}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
 
     const-string v10, ",  Device Encryption storage access restriction: "
 
@@ -2818,13 +2845,13 @@
 
     move-result-object v9
 
-    const/4 v12, 0x0
+    const/4 v11, 0x0
 
-    new-array v10, v12, [Ljava/lang/Object;
+    new-array v10, v11, [Ljava/lang/Object;
 
-    const-string v13, "DualDARPolicy:DualDARAnalytics"
+    const-string v12, "DualDARPolicy:DualDARAnalytics"
 
-    invoke-static {v13, v9, v10}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v12, v9, v10}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -2834,11 +2861,11 @@
 
     move-result-object v9
 
-    if-nez v9, :cond_17
+    if-nez v9, :cond_18
 
     goto :goto_11
 
-    :cond_17
+    :cond_18
     move-object v5, v9
 
     :goto_11
@@ -2866,29 +2893,29 @@
 
     invoke-static {v1, v2, v0}, Landroid/sec/enterprise/auditlog/AuditLog;->logEventAsUser(II[Ljava/lang/Object;)V
 
-    if-nez v11, :cond_18
+    if-nez v13, :cond_19
 
-    if-nez v4, :cond_18
+    if-nez v4, :cond_19
 
-    if-nez v6, :cond_18
+    if-nez v6, :cond_19
 
-    move v4, v12
+    move v4, v11
 
     goto :goto_12
 
-    :cond_18
-    if-eqz v11, :cond_19
+    :cond_19
+    if-eqz v13, :cond_1a
 
-    move v4, v11
+    move v4, v13
 
     goto :goto_12
 
-    :cond_19
-    if-eqz v4, :cond_1a
+    :cond_1a
+    if-eqz v4, :cond_1b
 
     goto :goto_12
 
-    :cond_1a
+    :cond_1b
     move v4, v6
 
     :goto_12
@@ -3028,24 +3055,9 @@
 .end method
 
 .method public final systemReady()V
-    .locals 2
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARUser()I
-
-    move-result v0
-
-    const/4 v1, -0x1
-
-    if-eq v0, v1, :cond_0
-
-    iget-object v1, p0, Lcom/android/server/enterprise/dualdar/DualDARPolicy;->edmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
-
-    invoke-virtual {v1, v0}, Lcom/android/server/enterprise/storage/EdmStorageProviderBase;->getMUMContainerOwnerUid(I)I
-
-    move-result v1
+    .locals 0
 
-    invoke-virtual {p0, v1, v0}, Lcom/android/server/enterprise/dualdar/DualDARPolicy;->refreshConfig(II)V
+    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getUserManager()Lcom/android/server/pm/UserManagerService;
 
-    :cond_0
     return-void
 .end method
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy.smali b/smali/com/android/server/enterprise/security/PasswordPolicy.smali
index debddedfc..4876f5d08 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy.smali
@@ -5262,34 +5262,10 @@
 .end method
 
 .method public final isChangeRequestedForInner()I
-    .locals 2
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
+    .locals 1
 
     const/4 v0, -0x1
 
-    goto :goto_0
-
-    :cond_0
-    new-instance v0, Lcom/android/internal/widget/LockPatternUtils;
-
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-direct {v0, v1}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {v0}, Lcom/android/internal/widget/LockPatternUtils;->getLockPatternUtilForDualDarDo()Lcom/android/internal/widget/LockPatternUtils$LockPatternUtilForDualDarDo;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Lcom/android/internal/widget/LockPatternUtils$LockPatternUtilForDualDarDo;->getInnerAuthUserForDo()I
-
-    move-result v0
-
-    :goto_0
     invoke-virtual {p0, v0}, Lcom/android/server/enterprise/security/PasswordPolicy;->isChangeRequestedAsUserFromDb(I)I
 
     move-result p0
@@ -8798,7 +8774,7 @@
 .end method
 
 .method public final declared-synchronized setPwdChangeRequestedForInner(I)Z
-    .locals 5
+    .locals 4
 
     monitor-enter p0
 
@@ -8816,49 +8792,25 @@
 
     move-result-object v2
 
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v3
-
-    if-nez v3, :cond_0
-
     const/4 v3, -0x1
 
-    goto :goto_0
-
-    :cond_0
-    new-instance v3, Lcom/android/internal/widget/LockPatternUtils;
-
-    iget-object v4, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-direct {v3, v4}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {v3}, Lcom/android/internal/widget/LockPatternUtils;->getLockPatternUtilForDualDarDo()Lcom/android/internal/widget/LockPatternUtils$LockPatternUtilForDualDarDo;
-
-    move-result-object v3
-
-    invoke-virtual {v3}, Lcom/android/internal/widget/LockPatternUtils$LockPatternUtilForDualDarDo;->getInnerAuthUserForDo()I
-
-    move-result v3
-
-    :goto_0
     invoke-virtual {v0, v3, v1, v2}, Lcom/android/server/enterprise/storage/EdmStorageProviderBase;->putGenericValueAsUser(ILjava/lang/String;Ljava/lang/String;)Z
 
     move-result v0
 
-    if-nez p1, :cond_1
+    if-nez p1, :cond_0
 
     invoke-virtual {p0, p1}, Lcom/android/server/enterprise/security/PasswordPolicy;->setHomeAndRecentKey(I)V
     :try_end_1
     .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    goto :goto_1
+    goto :goto_0
 
     :catchall_0
     move-exception p1
 
-    goto :goto_2
+    goto :goto_1
 
     :catch_0
     move-exception p1
@@ -8870,13 +8822,13 @@
 
     const/4 v0, 0x0
 
-    :cond_1
-    :goto_1
+    :cond_0
+    :goto_0
     monitor-exit p0
 
     return v0
 
-    :goto_2
+    :goto_1
     :try_start_3
     monitor-exit p0
     :try_end_3
@@ -8886,7 +8838,7 @@
 .end method
 
 .method public final declared-synchronized setPwdChangeRequestedForUser(II)Z
-    .locals 7
+    .locals 6
 
     monitor-enter p0
 
@@ -8910,25 +8862,11 @@
 
     move-result v1
 
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v2
-
-    const/4 v3, 0x1
-
-    if-eqz v2, :cond_1
-
-    if-ne p1, v3, :cond_1
-
-    if-eqz v1, :cond_0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/enterprise/security/PasswordPolicy;->setPwdChangeRequestedForInner(I)Z
-
-    move-result v1
+    iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
 
-    if-eqz v1, :cond_0
+    if-nez v2, :cond_0
 
-    move v1, v3
+    invoke-virtual {p0}, Lcom/android/server/enterprise/security/PasswordPolicy;->getEDM$28()Lcom/samsung/android/knox/EnterpriseDeviceManager;
 
     goto :goto_0
 
@@ -8943,77 +8881,63 @@
     goto :goto_1
 
     :cond_0
-    move v1, v0
-
-    :cond_1
     :goto_0
-    iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
-
-    if-nez v2, :cond_2
-
-    invoke-virtual {p0}, Lcom/android/server/enterprise/security/PasswordPolicy;->getEDM$28()Lcom/samsung/android/knox/EnterpriseDeviceManager;
-
-    :cond_2
-    if-eqz v1, :cond_4
+    if-eqz v1, :cond_2
 
     invoke-virtual {p0, p2}, Lcom/android/server/enterprise/security/PasswordPolicy;->isChangeRequestedAsUserFromDb(I)I
 
     move-result v2
 
-    iget-object v4, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mPolicyCache:Lcom/android/server/enterprise/security/PasswordPolicyCache;
+    iget-object v3, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mPolicyCache:Lcom/android/server/enterprise/security/PasswordPolicyCache;
 
-    invoke-virtual {v4, p2, v2}, Lcom/android/server/enterprise/security/PasswordPolicyCache;->setChangeRequestedAsUser(II)V
+    invoke-virtual {v3, p2, v2}, Lcom/android/server/enterprise/security/PasswordPolicyCache;->setChangeRequestedAsUser(II)V
 
-    iget-object v4, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
+    iget-object v3, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v5, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
+    new-instance v4, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
 
-    const/4 v6, 0x2
+    const/4 v5, 0x2
 
-    invoke-direct {v5, p0, p2, v2, v6}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
+    invoke-direct {v4, p0, p2, v2, v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
 
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v5}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
+    invoke-static {v4}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
 
-    if-nez p2, :cond_4
+    if-nez p2, :cond_2
 
-    if-eqz p1, :cond_3
+    if-eqz p1, :cond_1
 
     const/4 v2, -0x1
 
-    if-ne p1, v2, :cond_4
-
-    :cond_3
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v2
-
-    if-nez v2, :cond_4
+    if-ne p1, v2, :cond_2
 
+    :cond_1
     invoke-virtual {p0, p1}, Lcom/android/server/enterprise/security/PasswordPolicy;->setHomeAndRecentKey(I)V
 
-    :cond_4
-    const/4 v2, 0x2
+    :cond_2
+    const/4 v2, 0x1
 
-    if-eq p1, v3, :cond_5
+    const/4 v3, 0x2
 
-    if-eq p1, v2, :cond_5
+    if-eq p1, v2, :cond_3
 
-    const/4 v3, -0x3
+    if-eq p1, v3, :cond_3
 
-    if-ne p1, v3, :cond_6
+    const/4 v2, -0x3
 
-    :cond_5
+    if-ne p1, v2, :cond_4
+
+    :cond_3
     new-instance p1, Lcom/android/internal/widget/LockPatternUtils;
 
-    iget-object v3, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
+    iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
-    invoke-direct {p1, v3}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
+    invoke-direct {p1, v2}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
 
-    invoke-virtual {p1, v2, p2}, Lcom/android/internal/widget/LockPatternUtils;->requireStrongAuth(II)V
+    invoke-virtual {p1, v3, p2}, Lcom/android/internal/widget/LockPatternUtils;->requireStrongAuth(II)V
 
-    :cond_6
+    :cond_4
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mEDM:Lcom/samsung/android/knox/EnterpriseDeviceManager;
 
     invoke-virtual {p1}, Lcom/samsung/android/knox/EnterpriseDeviceManager;->getRestrictionPolicy()Lcom/samsung/android/knox/restriction/RestrictionPolicy;
@@ -9024,7 +8948,7 @@
 
     move-result p1
 
-    if-nez p1, :cond_7
+    if-nez p1, :cond_5
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
@@ -9041,7 +8965,7 @@
     .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :cond_7
+    :cond_5
     move v0, v1
 
     goto :goto_2
diff --git a/smali/com/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0.smali b/smali/com/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0.smali
index 6f077e937..0c0e7f1c1 100644
--- a/smali/com/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0.smali
+++ b/smali/com/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0.smali
@@ -3,527 +3,34 @@
 .source "SourceFile"
 
 # interfaces
-.implements Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;
+.implements Lcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;
 
 
 # instance fields
 .field public final synthetic f$0:Lcom/android/server/knox/dar/DarManagerService;
 
-.field public final synthetic f$2:Ljava/io/PrintWriter;
-
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/knox/dar/DarManagerService;Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
+.method public synthetic constructor <init>(Lcom/android/server/knox/dar/DarManagerService;)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
     iput-object p1, p0, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;->f$0:Lcom/android/server/knox/dar/DarManagerService;
 
-    iput-object p3, p0, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;->f$2:Ljava/io/PrintWriter;
-
     return-void
 .end method
 
 
 # virtual methods
-.method public final runOrThrow()V
-    .locals 13
-
-    const/4 v0, 0x0
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;->f$0:Lcom/android/server/knox/dar/DarManagerService;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;->f$2:Ljava/io/PrintWriter;
-
-    iget-object v2, v1, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object v1, v1, Lcom/android/server/knox/dar/DarManagerService;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v3, Landroid/util/IndentingPrintWriter;
-
-    invoke-direct {v3, p0}, Landroid/util/IndentingPrintWriter;-><init>(Ljava/io/Writer;)V
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string v4, "DUALDAR Supported Version: "
-
-    invoke-direct {p0, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-static {}, Lcom/samsung/android/knox/ddar/DualDARPolicy;->getDualDARVersion()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {p0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {v3, p0}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    iget-object p0, v2, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {v4, v0}, Lcom/android/internal/widget/LockPatternUtils;->isDeviceOwner(I)Z
-
-    move-result v4
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v5
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARUser()I
-
-    move-result v6
-
-    const/4 v7, 0x1
-
-    const/4 v8, -0x1
-
-    const-string v9, "Credential Type: "
-
-    const-string v10, ""
-
-    if-eq v6, v8, :cond_8
-
-    new-instance v11, Ljava/lang/StringBuilder;
-
-    const-string v12, "DUALDAR user: "
-
-    invoke-direct {v11, v12}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v11, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v11
-
-    invoke-virtual {v3, v11}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    const-string v11, "DUALDAR TYPE: "
-
-    invoke-virtual {v3, v11}, Landroid/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
-
-    invoke-static {v6}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARType(I)I
-
-    move-result v11
-
-    if-eq v11, v8, :cond_3
-
-    if-eqz v11, :cond_2
-
-    if-eq v11, v7, :cond_1
-
-    const/4 v8, 0x2
-
-    if-eq v11, v8, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const-string v8, "DUALDAR_TYPE_DO_ONLY"
-
-    invoke-virtual {v3, v8}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_1
-    const-string v8, "DUALDAR_TYPE_DO_PO"
-
-    invoke-virtual {v3, v8}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_2
-    const-string v8, "DUALDAR_TYPE_PO_ONLY"
-
-    invoke-virtual {v3, v8}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_3
-    const-string v8, "DUALDAR_TYPE_NONE"
-
-    invoke-virtual {v3, v8}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    :goto_0
-    const-string v8, "DUALDAR CRYPTO TYPE: "
-
-    invoke-virtual {v3, v8}, Landroid/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
-
-    invoke-static {v6}, Lcom/samsung/android/knox/SemPersonaManager;->isDualDARNativeCrypto(I)Z
-
-    move-result v8
-
-    if-eqz v8, :cond_4
-
-    const-string/jumbo v8, "Native"
-
-    invoke-virtual {v3, v8}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    goto :goto_1
-
-    :cond_4
-    invoke-static {v1}, Lcom/samsung/android/knox/dar/ddar/DualDarCache;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarCache;
-
-    move-result-object v8
-
-    const-string v11, "KEY_CLIENT_PACKAGE_NAME"
-
-    invoke-virtual {v8, v6, v11}, Lcom/samsung/android/knox/dar/ddar/DualDarCache;->get(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v8
-
-    new-instance v11, Ljava/lang/StringBuilder;
-
-    const-string v12, "Custom - "
-
-    invoke-direct {v11, v12}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v11, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-virtual {v3, v8}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    :goto_1
-    const-string/jumbo v8, "device_policy"
-
-    invoke-virtual {v1, v8}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Landroid/app/admin/DevicePolicyManager;
-
-    if-eqz v1, :cond_6
-
-    if-nez v6, :cond_5
-
-    invoke-virtual {v1}, Landroid/app/admin/DevicePolicyManager;->getDeviceOwner()Ljava/lang/String;
-
-    move-result-object v1
-
-    goto :goto_2
-
-    :cond_5
-    invoke-virtual {v1, v6}, Landroid/app/admin/DevicePolicyManager;->getProfileOwnerNameAsUser(I)Ljava/lang/String;
-
-    move-result-object v1
-
-    goto :goto_2
-
-    :cond_6
-    move-object v1, v10
-
-    :goto_2
-    new-instance v8, Ljava/lang/StringBuilder;
-
-    const-string v11, "Admin Package: "
-
-    invoke-direct {v8, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v8, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {v3, v1}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    invoke-virtual {v3}, Landroid/util/IndentingPrintWriter;->increaseIndent()Landroid/util/IndentingPrintWriter;
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v8, "isDERestrictionEnforced: "
-
-    invoke-direct {v1, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARPolicyService()Ljava/util/Optional;
-
-    move-result-object v8
-
-    new-instance v11, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;
-
-    invoke-direct {v11, v6, v0}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;-><init>(II)V
-
-    invoke-virtual {v8, v11}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object v8
-
-    sget-object v11, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {v8, v11}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v8
-
-    check-cast v8, Ljava/lang/Boolean;
-
-    invoke-virtual {v8}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result v8
-
-    invoke-virtual {v1, v8}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {v3, v1}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    if-eqz v6, :cond_7
-
-    invoke-virtual {v3}, Landroid/util/IndentingPrintWriter;->increaseIndent()Landroid/util/IndentingPrintWriter;
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {v1, v6}, Lcom/android/internal/widget/LockPatternUtils;->getCredentialTypeForUser(I)I
-
-    move-result v1
-
-    new-instance v6, Ljava/lang/StringBuilder;
-
-    invoke-direct {v6, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {v3, v1}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    invoke-virtual {v3}, Landroid/util/IndentingPrintWriter;->decreaseIndent()Landroid/util/IndentingPrintWriter;
-
-    :cond_7
-    invoke-virtual {v3}, Landroid/util/IndentingPrintWriter;->decreaseIndent()Landroid/util/IndentingPrintWriter;
-
-    :cond_8
-    if-eqz v4, :cond_a
-
-    invoke-virtual {v3, v10}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    const-string v1, "Device Owner enabled"
-
-    invoke-virtual {v3, v1}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    if-eqz v5, :cond_9
-
-    const-string v1, "Enabled"
-
-    goto :goto_3
-
-    :cond_9
-    const-string/jumbo v1, "Not enabled"
-
-    :goto_3
-    const-string v4, "DualDAR at DO: "
-
-    invoke-virtual {v4, v1}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {v3, v1}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    :cond_a
-    if-eqz v5, :cond_d
-
-    invoke-virtual {v3, v10}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARPolicyService()Ljava/util/Optional;
-
-    move-result-object v1
-
-    new-instance v4, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3;
-
-    invoke-direct {v4}, Ljava/lang/Object;-><init>()V
-
-    invoke-virtual {v1, v4}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object v1
-
-    new-instance v4, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;
-
-    invoke-direct {v4}, Ljava/lang/Object;-><init>()V
-
-    invoke-virtual {v1, v4}, Ljava/util/Optional;->orElseGet(Ljava/util/function/Supplier;)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Landroid/os/Bundle;
-
-    if-eqz v1, :cond_b
-
-    const-string/jumbo v4, "dualdar-config-datalock-timeout"
-
-    invoke-virtual {v1, v4}, Landroid/os/Bundle;->getLong(Ljava/lang/String;)J
-
-    move-result-wide v4
-
-    sget v1, Lcom/android/server/enterprise/dualdar/DualDARPolicy;->$r8$clinit:I
-
-    const-wide/32 v10, 0x493e0
-
-    cmp-long v1, v4, v10
-
-    if-ltz v1, :cond_b
-
-    goto :goto_4
-
-    :cond_b
-    move v7, v0
-
-    :goto_4
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string v4, "Data Lock Timeout : "
-
-    invoke-direct {v1, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {v3, v1}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    invoke-virtual {v3}, Landroid/util/IndentingPrintWriter;->increaseIndent()Landroid/util/IndentingPrintWriter;
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->getCurrentState(I)Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    move-result-object v1
-
-    if-eqz v1, :cond_c
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "State - "
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1}, Lcom/samsung/android/knox/dar/ddar/fsm/State;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {v3, v1}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    :cond_c
-    const-string/jumbo v1, "Outer Auth User 0"
-
-    invoke-virtual {v3, v1}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    invoke-virtual {v3}, Landroid/util/IndentingPrintWriter;->increaseIndent()Landroid/util/IndentingPrintWriter;
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {v1, v0}, Lcom/android/internal/widget/LockPatternUtils;->getCredentialTypeForUser(I)I
-
-    move-result v1
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    invoke-direct {v4, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/DarUtil;->credentialTypeToString(I)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {v3, v1}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    invoke-virtual {v3}, Landroid/util/IndentingPrintWriter;->decreaseIndent()Landroid/util/IndentingPrintWriter;
-
-    invoke-virtual {v2, v0}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
-
-    move-result v0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {p0, v0}, Lcom/android/internal/widget/LockPatternUtils;->getCredentialTypeForUser(I)I
-
-    move-result p0
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string v4, "Inner Auth User "
-
-    invoke-direct {v1, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v3, v0}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    invoke-virtual {v3}, Landroid/util/IndentingPrintWriter;->increaseIndent()Landroid/util/IndentingPrintWriter;
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/DarUtil;->credentialTypeToString(I)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {v3, p0}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string v0, "Has Token Set: "
-
-    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-boolean v0, v2, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    const-string/jumbo v1, "Password Minimum Length: "
-
-    invoke-static {p0, v0, v3, v1}, Lcom/android/server/devicepolicy/DeviceStateCacheImpl$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLandroid/util/IndentingPrintWriter;Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    move-result-object p0
-
-    invoke-virtual {v2}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getPasswordMinimumLengthForInner()I
-
-    move-result v0
-
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {v3, p0}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+.method public final onEscrowTokenActivated(JI)V
+    .locals 0
 
-    invoke-virtual {v3}, Landroid/util/IndentingPrintWriter;->decreaseIndent()Landroid/util/IndentingPrintWriter;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;->f$0:Lcom/android/server/knox/dar/DarManagerService;
 
-    invoke-virtual {v3}, Landroid/util/IndentingPrintWriter;->decreaseIndent()Landroid/util/IndentingPrintWriter;
+    sget-object p1, Lcom/android/server/knox/dar/DarManagerService;->NULL_USER:Landroid/content/pm/UserInfo;
 
-    :cond_d
-    invoke-virtual {v3}, Landroid/util/IndentingPrintWriter;->println()V
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     return-void
 .end method
diff --git a/smali/com/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1.smali b/smali/com/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1.smali
deleted file mode 100644
index 4b18c79c0..000000000
--- a/smali/com/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1.smali
+++ /dev/null
@@ -1,93 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Lcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;
-
-
-# instance fields
-.field public final synthetic f$0:Lcom/android/server/knox/dar/DarManagerService;
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/knox/dar/DarManagerService;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/knox/dar/DarManagerService;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final onEscrowTokenActivated(JI)V
-    .locals 2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/knox/dar/DarManagerService;
-
-    sget-object v0, Lcom/android/server/knox/dar/DarManagerService;->NULL_USER:Landroid/content/pm/UserInfo;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    const/4 v0, 0x0
-
-    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
-
-    move-result v1
-
-    if-ne v1, p3, :cond_0
-
-    invoke-static {p1, p2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object p1
-
-    invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p2
-
-    filled-new-array {p1, p2}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    const-string/jumbo p2, "Token(%x) activated for user %d"
-
-    invoke-static {p2, p1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string p2, "DualDarManagerImpl"
-
-    invoke-static {p2, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-boolean p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    if-eqz p1, :cond_0
-
-    iput-boolean v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    new-instance p1, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;
-
-    invoke-direct {p1, p0}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;)V
-
-    invoke-static {p1}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
-
-    :cond_0
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/DarManagerService$Injector.smali b/smali/com/android/server/knox/dar/DarManagerService$Injector.smali
index ab110a9ef..8121d5906 100644
--- a/smali/com/android/server/knox/dar/DarManagerService$Injector.smali
+++ b/smali/com/android/server/knox/dar/DarManagerService$Injector.smali
@@ -8,9 +8,7 @@
 
 .field public final mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
 
-.field public mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-.field public mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;
+.field public mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;
 
 .field public final mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
@@ -37,9 +35,7 @@
 
     const/4 p1, 0x0
 
-    iput-object p1, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
+    iput-object p1, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;
 
     return-void
 .end method
diff --git a/smali/com/android/server/knox/dar/DarManagerService.smali b/smali/com/android/server/knox/dar/DarManagerService.smali
index a33441302..b2cb8b638 100644
--- a/smali/com/android/server/knox/dar/DarManagerService.smali
+++ b/smali/com/android/server/knox/dar/DarManagerService.smali
@@ -14,11 +14,9 @@
 
 .field public mDarHandler:Lcom/android/server/knox/dar/DarManagerService$DarHandler;
 
-.field public final mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
 .field public final mEndpointMonitorImpl:Lcom/android/server/knox/zt/devicetrust/EndpointMonitorImpl;
 
-.field public final mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;
+.field public final mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;
 
 .field public final mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
@@ -65,11 +63,11 @@
 
     iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDarHandler:Lcom/android/server/knox/dar/DarManagerService$DarHandler;
 
-    new-instance v0, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;
+    new-instance v0, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;
 
-    invoke-direct {v0, p0}, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/knox/dar/DarManagerService;)V
+    invoke-direct {v0, p0}, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/knox/dar/DarManagerService;)V
 
-    iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;
+    iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;
 
     new-instance v1, Lcom/android/server/knox/dar/DarManagerService$1;
 
@@ -150,7 +148,7 @@
 
     iput-object v2, p0, Lcom/android/server/knox/dar/DarManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    iput-object v0, p1, Lcom/android/server/knox/dar/DarManagerService$Injector;->mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;
+    iput-object v0, p1, Lcom/android/server/knox/dar/DarManagerService$Injector;->mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;
 
     invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->systemReady()V
 
@@ -160,18 +158,6 @@
 
     iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
 
-    new-instance v0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-direct {v0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;-><init>(Lcom/android/server/knox/dar/DarManagerService$Injector;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    const-string p1, "DarManagerService_DUAL_DAR"
-
-    const-string/jumbo v0, "prepare DualDAR DO Service"
-
-    invoke-static {p1, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
-
     const-class p1, Landroid/app/ActivityManagerInternal;
 
     invoke-static {p1}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
@@ -372,62 +358,8 @@
 
 # virtual methods
 .method public final addBlockedClearablePackages(ILjava/lang/String;)V
-    .locals 3
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v0, "addBlockedClearablePackages"
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    const-string/jumbo v0, "pkg_blocked_clearable"
-
-    invoke-virtual {p0, p1, v0}, Lcom/android/server/knox/dar/DarDatabaseCache;->getInternal(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    const-string/jumbo v2, "empty"
-
-    if-eqz v1, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    move-object v1, v2
-
-    :goto_0
-    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    if-nez v2, :cond_1
-
-    const-string v2, ","
-
-    invoke-static {v1, v2, p2}, Lcom/android/server/AnyMotionDetector$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-virtual {p0, p1, v0, p2}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :cond_1
-    invoke-virtual {p0, p1, v0, p2}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
+    .locals 0
 
-    :cond_2
     return-void
 .end method
 
@@ -577,115 +509,76 @@
 .end method
 
 .method public final clearResetPasswordToken(I)Z
-    .locals 6
+    .locals 4
 
     invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
 
     move-result v0
 
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_2
+    if-eqz v0, :cond_1
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
 
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    new-instance v2, Ljava/lang/StringBuilder;
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    const-string v3, "Clear Reset password token for user "
+    const-string v1, "Clear Reset password token for user "
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object v0
 
-    const-string/jumbo v3, "VirtualLockImpl"
+    const-string/jumbo v1, "VirtualLockImpl"
 
-    invoke-static {v3, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     invoke-static {p1}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
 
-    move-result v2
-
-    if-nez v2, :cond_0
+    move-result v0
 
-    move v0, v1
+    if-nez v0, :cond_0
 
     goto :goto_0
 
     :cond_0
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v2
+    move-result-wide v0
 
     :try_start_0
-    iget-object v4, v0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
+    iget-object v2, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
 
-    invoke-virtual {v4, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->getLong(I)J
+    invoke-virtual {v2, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->getLong(I)J
 
-    move-result-wide v4
+    move-result-wide v2
 
-    invoke-virtual {v0, p1, v4, v5}, Lcom/android/server/knox/dar/VirtualLockImpl;->clearResetPasswordTokenInternal(IJ)Z
+    invoke-virtual {p0, p1, v2, v3}, Lcom/android/server/knox/dar/VirtualLockImpl;->clearResetPasswordTokenInternal(IJ)Z
 
-    move-result v0
+    move-result p0
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    :goto_0
-    if-eqz v0, :cond_1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_1
-
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
-
-    move-result v2
-
-    if-ne v2, p1, :cond_1
-
-    iget-boolean p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    if-eqz p1, :cond_1
-
-    iput-boolean v1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    new-instance p1, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;
-
-    invoke-direct {p1, p0}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;)V
-
-    invoke-static {p1}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :cond_1
-    return v0
+    return p0
 
     :catchall_0
     move-exception p0
 
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw p0
 
-    :cond_2
-    return v1
+    :cond_1
+    :goto_0
+    const/4 p0, 0x0
+
+    return p0
 .end method
 
 .method public final createEncPkgDir(ILjava/lang/String;)I
@@ -761,47 +654,26 @@
 .method public final dump(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
     .locals 3
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mContext:Landroid/content/Context;
+    iget-object p1, p0, Lcom/android/server/knox/dar/DarManagerService;->mContext:Landroid/content/Context;
 
-    const-string v1, "DarManagerService"
+    const-string v0, "DarManagerService"
 
-    invoke-static {v0, v1, p2}, Lcom/android/internal/util/DumpUtils;->checkDumpPermission(Landroid/content/Context;Ljava/lang/String;Ljava/io/PrintWriter;)Z
+    invoke-static {p1, v0, p2}, Lcom/android/internal/util/DumpUtils;->checkDumpPermission(Landroid/content/Context;Ljava/lang/String;Ljava/io/PrintWriter;)Z
 
-    move-result v0
+    move-result p1
 
-    if-nez v0, :cond_0
+    if-nez p1, :cond_0
 
     goto/16 :goto_7
 
     :cond_0
     invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    const-string/jumbo v0, "dualdar_dump"
-
-    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    new-instance v1, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;
-
-    invoke-direct {v1, p0, p1, p2, p3}, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/knox/dar/DarManagerService;Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v1}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
-
-    :cond_1
-    if-eqz p3, :cond_8
+    if-eqz p3, :cond_7
 
     array-length p0, p3
 
-    if-lez p0, :cond_8
+    if-lez p0, :cond_7
 
     invoke-static {p3}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
 
@@ -813,7 +685,7 @@
 
     move-result p0
 
-    if-nez p0, :cond_2
+    if-nez p0, :cond_1
 
     invoke-static {p3}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
 
@@ -825,9 +697,9 @@
 
     move-result p0
 
-    if-eqz p0, :cond_8
+    if-eqz p0, :cond_7
 
-    :cond_2
+    :cond_1
     const-string/jumbo p0, "sdplog_dump"
 
     invoke-virtual {p2, p0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
@@ -850,7 +722,7 @@
 
     const-string/jumbo p3, "SDPLogFile"
 
-    if-nez p1, :cond_3
+    if-nez p1, :cond_2
 
     const-string p0, "Failed to dump: Maybe target file is already being used..."
 
@@ -862,7 +734,7 @@
 
     goto :goto_6
 
-    :cond_3
+    :cond_2
     const/4 p1, 0x0
 
     :try_start_0
@@ -894,13 +766,13 @@
 
     move-result-object p3
 
-    if-eqz p3, :cond_5
+    if-eqz p3, :cond_4
 
     add-int/lit8 v1, p0, 0x1
 
     const/16 v2, 0x1770
 
-    if-lt p0, v2, :cond_4
+    if-lt p0, v2, :cond_3
 
     const-string p1, "Dump line count reached to the limit: 6000"
 
@@ -911,7 +783,7 @@
 
     goto :goto_2
 
-    :cond_4
+    :cond_3
     invoke-virtual {p2, p3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
     :try_end_2
     .catchall {:try_start_2 .. :try_end_2} :catchall_0
@@ -920,7 +792,7 @@
 
     goto :goto_0
 
-    :cond_5
+    :cond_4
     :goto_1
     :try_start_3
     invoke-virtual {v0}, Ljava/io/RandomAccessFile;->close()V
@@ -952,11 +824,11 @@
 
     move-result-object p1
 
-    if-eqz p1, :cond_6
+    if-eqz p1, :cond_5
 
     invoke-static {p3, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_6
+    :cond_5
     new-instance p0, Ljava/io/IOException;
 
     invoke-direct {p0, p1}, Ljava/io/IOException;-><init>(Ljava/lang/String;)V
@@ -994,11 +866,11 @@
 
     invoke-virtual {p0}, Ljava/util/concurrent/locks/ReentrantLock;->unlock()V
 
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_6
 
     invoke-virtual {p2, p1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
 
-    :cond_7
+    :cond_6
     invoke-virtual {p2}, Ljava/io/PrintWriter;->println()V
 
     :goto_6
@@ -1006,7 +878,7 @@
 
     invoke-virtual {p2, p0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
 
-    :cond_8
+    :cond_7
     :goto_7
     return-void
 .end method
@@ -1096,72 +968,8 @@
 .end method
 
 .method public final getBlockedClearablePackages(I)Ljava/util/List;
-    .locals 3
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v1, "getBlockedClearablePackages"
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
-
-    new-instance v1, Ljava/util/ArrayList;
-
-    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V
-
-    const-string/jumbo v2, "pkg_blocked_clearable"
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    invoke-virtual {v0, p1, v2}, Lcom/android/server/knox/dar/DarDatabaseCache;->getInternal(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo v0, "empty"
-
-    if-eqz p1, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    move-object p1, v0
-
-    :goto_0
-    invoke-virtual {p1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    const-string v0, ","
-
-    invoke-virtual {p1, v0}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p1}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
-
-    move-result-object p1
-
-    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z
-
-    :cond_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mNonClearablePackages:Ljava/util/List;
-
-    invoke-virtual {v1, p0}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z
-
-    return-object v1
+    .locals 0
 
-    :cond_2
     const/4 p0, 0x0
 
     return-object p0
@@ -1178,139 +986,32 @@
 .end method
 
 .method public final getInnerAuthUserId(I)I
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
-
-    move-result p0
-
-    return p0
+    .locals 0
 
-    :cond_0
     const/16 p0, -0x2710
 
     return p0
 .end method
 
 .method public final getMainUserId(I)I
-    .locals 2
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    const/16 v1, -0x2710
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    const-string/jumbo v0, "ddar.inner.main.userid"
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    :try_start_0
-    invoke-virtual {p0, p1, v0}, Lcom/android/server/knox/dar/DarDatabaseCache;->getInternal(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    invoke-static {p0}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
+    .locals 0
 
-    move-result p0
-    :try_end_0
-    .catch Ljava/lang/NumberFormatException; {:try_start_0 .. :try_end_0} :catch_0
+    const/16 p0, -0x2710
 
     return p0
-
-    :catch_0
-    :cond_0
-    return v1
 .end method
 
 .method public final getPackageListForDualDarPolicy(Ljava/lang/String;)Ljava/util/List;
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p0, "getPackageListForDualDarPolicy"
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
-
-    :try_start_0
-    invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    invoke-interface {p0, p1}, Landroid/content/pm/IPackageManager;->getPackageListForDualDarPolicy(Ljava/lang/String;)Ljava/util/List;
-
-    move-result-object p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-object p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :cond_0
-    new-instance p0, Ljava/util/ArrayList;
-
-    invoke-direct {p0}, Ljava/util/ArrayList;-><init>()V
-
-    return-object p0
+    .locals 0
 
-    :cond_1
     const/4 p0, 0x0
 
     return-object p0
 .end method
 
 .method public final getPasswordMinimumLengthForInner()I
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getPasswordMinimumLengthForInner()I
-
-    move-result p0
-
-    return p0
+    .locals 0
 
-    :cond_0
     const/4 p0, 0x0
 
     return p0
@@ -1821,23 +1522,6 @@
     throw v0
 .end method
 
-.method public final isDualDarDoSupported()Z
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
 .method public final isEmTokenAllowed()Z
     .locals 2
 
@@ -1879,84 +1563,11 @@
 .end method
 
 .method public final isInnerAuthRequired(I)Z
-    .locals 5
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    goto :goto_1
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    iget-object v2, v0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mContext:Landroid/content/Context;
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
-
-    move-result-object v2
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getDualDARLockstate()Z
-
-    move-result v2
-
-    const-string/jumbo v3, "isInnerLayerLockedState - result : "
-
-    const-string v4, "DualDarManagerImpl"
-
-    invoke-static {v3, v4, v2}, Lcom/android/server/accessibility/AccessibilityManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Z)V
-
-    if-eqz v2, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    iget-boolean v2, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    if-nez v2, :cond_2
-
-    goto :goto_1
-
-    :cond_2
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
-
-    move-result p1
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {v0, p1}, Lcom/android/internal/widget/LockPatternUtils;->hasPendingEscrowToken(I)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_3
+    .locals 0
 
-    :goto_0
-    const/4 p0, 0x1
+    const/4 p0, 0x0
 
     return p0
-
-    :cond_3
-    iput-boolean v1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    :cond_4
-    :goto_1
-    return v1
 .end method
 
 .method public final isKnoxKeyInstallable()Z
@@ -2831,119 +2442,22 @@
 .end method
 
 .method public final setDualDarInfo(II)Z
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p0, "setDualDarInfo"
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
-
-    const-class p0, Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/pm/UserManagerInternal;
-
-    if-eqz v0, :cond_0
-
-    invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/pm/UserManagerInternal;->setDualDarInfo(II)Z
-
-    move-result p0
-
-    return p0
+    .locals 0
 
-    :cond_0
     const/4 p0, 0x0
 
     return p0
 .end method
 
 .method public final setInnerAuthUserId(II)V
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v0, "setInnerAuthUserId"
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo v0, "ddar.inner.auth.userid"
-
-    invoke-virtual {p0, p2, v0, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
+    .locals 0
 
-    :cond_0
     return-void
 .end method
 
 .method public final setMainUserId(II)V
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v0, "setMainUserId"
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo v0, "ddar.inner.main.userid"
-
-    invoke-virtual {p0, p2, v0, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
+    .locals 0
 
-    :cond_0
     return-void
 .end method
 
@@ -2958,7 +2472,7 @@
 .end method
 
 .method public final setResetPasswordToken([BI)Z
-    .locals 10
+    .locals 7
 
     invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
 
@@ -2966,144 +2480,97 @@
 
     const/4 v1, 0x0
 
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_3
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
 
-    const-string/jumbo v2, "vl.rst.token.handle"
+    const-string/jumbo v0, "vl.rst.token.handle"
 
-    iget-object v3, v0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
+    iget-object v2, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
 
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v3, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v5, "Set reset password token for user "
+    const-string/jumbo v4, "Set reset password token for user "
 
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v3, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v3
 
-    const-string/jumbo v5, "VirtualLockImpl"
+    const-string/jumbo v4, "VirtualLockImpl"
 
-    invoke-static {v5, v4}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v4, v3}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     invoke-static {p2}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
 
-    move-result v4
-
-    const/4 v5, 0x1
-
-    if-nez v4, :cond_0
+    move-result v3
 
-    move p1, v1
+    if-nez v3, :cond_0
 
-    goto :goto_1
+    goto :goto_0
 
     :cond_0
-    if-eqz p1, :cond_3
+    if-eqz p1, :cond_2
 
-    array-length v4, p1
+    array-length v3, p1
 
-    const/16 v6, 0x20
+    const/16 v4, 0x20
 
-    if-lt v4, v6, :cond_3
+    if-lt v3, v4, :cond_2
 
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v6
+    move-result-wide v3
 
     :try_start_0
-    invoke-virtual {v3, p2}, Lcom/android/server/knox/dar/DarDatabaseCache;->getLong(I)J
+    invoke-virtual {v2, p2}, Lcom/android/server/knox/dar/DarDatabaseCache;->getLong(I)J
 
-    move-result-wide v8
+    move-result-wide v5
 
-    invoke-virtual {v0, p2, v8, v9}, Lcom/android/server/knox/dar/VirtualLockImpl;->clearResetPasswordTokenInternal(IJ)Z
+    invoke-virtual {p0, p2, v5, v6}, Lcom/android/server/knox/dar/VirtualLockImpl;->clearResetPasswordTokenInternal(IJ)Z
 
-    iget-object v4, v0, Lcom/android/server/knox/dar/VirtualLockImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
+    iget-object v5, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    iget-object v0, v0, Lcom/android/server/knox/dar/VirtualLockImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
+    iget-object p0, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;
 
-    invoke-virtual {v4, p1, p2, v0}, Lcom/android/internal/widget/LockPatternUtils;->addEscrowToken([BILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
+    invoke-virtual {v5, p1, p2, p0}, Lcom/android/internal/widget/LockPatternUtils;->addEscrowToken([BILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
 
-    move-result-wide v8
+    move-result-wide p0
 
-    invoke-static {v8, v9}, Ljava/lang/String;->valueOf(J)Ljava/lang/String;
+    invoke-static {p0, p1}, Ljava/lang/String;->valueOf(J)Ljava/lang/String;
 
-    move-result-object p1
+    move-result-object v5
 
-    invoke-virtual {v3, p2, v2, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-virtual {v2, p2, v0, v5}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    const-wide/16 v2, 0x0
-
-    cmp-long p1, v8, v2
+    const-wide/16 v5, 0x0
 
-    if-eqz p1, :cond_1
+    cmp-long p0, p0, v5
 
-    move p1, v5
+    if-eqz p0, :cond_1
 
-    goto :goto_0
+    const/4 v1, 0x1
 
     :cond_1
-    move p1, v1
-
-    :goto_0
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    :goto_1
-    if-eqz p1, :cond_2
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
-
-    move-result v0
-
-    if-ne v0, p2, :cond_2
-
-    iget-boolean p2, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    if-nez p2, :cond_2
-
-    iput-boolean v5, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    new-instance p2, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;
-
-    invoke-direct {p2, p0}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;)V
-
-    invoke-static {p2}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
+    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :cond_2
-    return p1
+    return v1
 
     :catchall_0
     move-exception p0
 
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw p0
 
-    :cond_3
+    :cond_2
     new-instance p0, Ljava/lang/IllegalArgumentException;
 
     const-string/jumbo p1, "token must be at least 32-byte long"
@@ -3112,7 +2579,8 @@
 
     throw p0
 
-    :cond_4
+    :cond_3
+    :goto_0
     return v1
 .end method
 
diff --git a/smali/com/android/server/knox/dar/DarUtil.smali b/smali/com/android/server/knox/dar/DarUtil.smali
index 05d69054b..b58d93a11 100644
--- a/smali/com/android/server/knox/dar/DarUtil.smali
+++ b/smali/com/android/server/knox/dar/DarUtil.smali
@@ -4,137 +4,6 @@
 
 
 # direct methods
-.method public static credentialTypeToString(I)Ljava/lang/String;
-    .locals 1
-
-    const/4 v0, -0x1
-
-    if-eq p0, v0, :cond_3
-
-    const/4 v0, 0x1
-
-    if-eq p0, v0, :cond_2
-
-    const/4 v0, 0x3
-
-    if-eq p0, v0, :cond_1
-
-    const/4 v0, 0x4
-
-    if-eq p0, v0, :cond_0
-
-    const-string/jumbo v0, "Unknown "
-
-    invoke-static {p0, v0}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    return-object p0
-
-    :cond_0
-    const-string/jumbo p0, "Password"
-
-    return-object p0
-
-    :cond_1
-    const-string/jumbo p0, "Pin"
-
-    return-object p0
-
-    :cond_2
-    const-string/jumbo p0, "Pattern"
-
-    return-object p0
-
-    :cond_3
-    const-string/jumbo p0, "None"
-
-    return-object p0
-.end method
-
-.method public static isDaemonRunning()Z
-    .locals 6
-
-    const-string v0, "DARUtil"
-
-    const-string/jumbo v1, "init.svc."
-
-    const-string/jumbo v2, "dualdard"
-
-    invoke-virtual {v1, v2}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v2
-
-    const/4 v4, 0x0
-
-    :try_start_0
-    invoke-static {v1}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    if-eqz v1, :cond_1
-
-    invoke-virtual {v1}, Ljava/lang/String;->isEmpty()Z
-
-    move-result v5
-
-    if-eqz v5, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const-string/jumbo v0, "running"
-
-    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v4
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception v0
-
-    goto :goto_3
-
-    :catch_0
-    move-exception v0
-
-    goto :goto_2
-
-    :cond_1
-    :goto_0
-    const-string/jumbo v1, "isDaemonRunning() - Service not found"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :goto_1
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return v4
-
-    :goto_2
-    :try_start_1
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return v4
-
-    :goto_3
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw v0
-.end method
-
 .method public static isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
     .locals 4
 
diff --git a/smali/com/android/server/knox/dar/EnterprisePartitionManager.smali b/smali/com/android/server/knox/dar/EnterprisePartitionManager.smali
index a850e70fc..ef4729570 100644
--- a/smali/com/android/server/knox/dar/EnterprisePartitionManager.smali
+++ b/smali/com/android/server/knox/dar/EnterprisePartitionManager.smali
@@ -20,8 +20,6 @@
 
 .field public final mSessionIdDstPath:Ljava/util/Hashtable;
 
-.field public notAppliedPaths:Ljava/util/List;
-
 
 # direct methods
 .method static constructor <clinit>()V
@@ -87,8 +85,6 @@
 
     iput-object v0, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mSessionIdDstPath:Ljava/util/Hashtable;
 
-    iput-object v0, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->notAppliedPaths:Ljava/util/List;
-
     iput-object p1, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mInjector:Lcom/android/server/knox/dar/EnterprisePartitionManager$Injector;
 
     iget-object p1, p1, Lcom/android/server/knox/dar/EnterprisePartitionManager$Injector;->mContext:Landroid/content/Context;
@@ -109,78 +105,6 @@
     return-void
 .end method
 
-.method public static getDualDARLockstate()Z
-    .locals 2
-
-    const-string v0, "EnterprisePartitionManager"
-
-    const-string/jumbo v1, "getDualDARLockstate"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    sget-object v0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mInstallLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mPackageTasker:Lcom/android/server/pm/Installer;
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-    :try_end_0
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_0 .. :try_end_0} :catch_1
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :try_start_1
-    iget-object v1, v1, Lcom/android/server/pm/Installer;->mInstalld:Landroid/os/IInstalld;
-
-    invoke-interface {v1}, Landroid/os/IInstalld;->getDualDARLockstate()Z
-
-    move-result v1
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    return v1
-
-    :catchall_0
-    move-exception v1
-
-    goto :goto_0
-
-    :catch_0
-    move-exception v1
-
-    :try_start_3
-    invoke-static {v1}, Lcom/android/server/pm/Installer$InstallerException;->from(Ljava/lang/Exception;)V
-
-    const/4 v1, 0x0
-
-    throw v1
-    :try_end_3
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_3 .. :try_end_3} :catch_1
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :catch_1
-    :try_start_4
-    monitor-exit v0
-
-    const/4 v0, 0x0
-
-    return v0
-
-    :goto_0
-    monitor-exit v0
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    throw v1
-.end method
-
 .method public static declared-synchronized getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
     .locals 3
 
@@ -229,186 +153,6 @@
     throw p0
 .end method
 
-.method public static setDualDARPolicyDir(IILjava/lang/String;)Z
-    .locals 4
-
-    const-string v0, "EnterprisePartitionManager"
-
-    const-string/jumbo v1, "setDualDARPolicyDir(user:"
-
-    const-string v2, " flags:"
-
-    const-string v3, " path:"
-
-    invoke-static {p0, p1, v1, v2, v3}, Lcom/android/internal/util/jobs/ArrayUtils$$ExternalSyntheticOutline0;->m(IILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    move-result-object v1
-
-    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v2, ")"
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    sget-object v0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mInstallLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mPackageTasker:Lcom/android/server/pm/Installer;
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-    :try_end_0
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_0 .. :try_end_0} :catch_1
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :try_start_1
-    iget-object v1, v1, Lcom/android/server/pm/Installer;->mInstalld:Landroid/os/IInstalld;
-
-    invoke-interface {v1, p0, p1, p2}, Landroid/os/IInstalld;->setDualDARPolicyDir(IILjava/lang/String;)Z
-
-    move-result p0
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    :try_start_3
-    invoke-static {p0}, Lcom/android/server/pm/Installer$InstallerException;->from(Ljava/lang/Exception;)V
-
-    const/4 p0, 0x0
-
-    throw p0
-    :try_end_3
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_3 .. :try_end_3} :catch_1
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :catch_1
-    :try_start_4
-    monitor-exit v0
-
-    const/4 p0, 0x0
-
-    return p0
-
-    :goto_0
-    monitor-exit v0
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    throw p0
-.end method
-
-.method public static setDualDARPolicyDirRecursively(IILjava/lang/String;)Z
-    .locals 4
-
-    const-string v0, "EnterprisePartitionManager"
-
-    const-string/jumbo v1, "setDualDARPolicyDirRecursively(user:"
-
-    const-string v2, " flags:"
-
-    const-string v3, " path:"
-
-    invoke-static {p0, p1, v1, v2, v3}, Lcom/android/internal/util/jobs/ArrayUtils$$ExternalSyntheticOutline0;->m(IILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    move-result-object v1
-
-    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v2, ")"
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    sget-object v0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mInstallLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mPackageTasker:Lcom/android/server/pm/Installer;
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-    :try_end_0
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_0 .. :try_end_0} :catch_1
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :try_start_1
-    iget-object v1, v1, Lcom/android/server/pm/Installer;->mInstalld:Landroid/os/IInstalld;
-
-    invoke-interface {v1, p0, p1, p2}, Landroid/os/IInstalld;->setDualDARPolicyDirRecursively(IILjava/lang/String;)Z
-
-    move-result p0
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    :try_start_3
-    invoke-static {p0}, Lcom/android/server/pm/Installer$InstallerException;->from(Ljava/lang/Exception;)V
-
-    const/4 p0, 0x0
-
-    throw p0
-    :try_end_3
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_3 .. :try_end_3} :catch_1
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :catch_1
-    :try_start_4
-    monitor-exit v0
-
-    const/4 p0, 0x0
-
-    return p0
-
-    :goto_0
-    monitor-exit v0
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    throw p0
-.end method
-
 .method public static setInstaller(Lcom/android/server/pm/Installer;Ljava/lang/Object;)V
     .locals 1
 
@@ -658,300 +402,6 @@
     return p0
 .end method
 
-.method public final hasDualDARPolicyRecursively(Ljava/lang/String;Ljava/util/List;)Z
-    .locals 7
-
-    const-string v0, "EnterprisePartitionManager"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "hasDualDARPolicyRecursively(path:"
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v2, ")"
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->notAppliedPaths:Ljava/util/List;
-
-    if-nez v0, :cond_0
-
-    new-instance v0, Ljava/util/ArrayList;
-
-    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->notAppliedPaths:Ljava/util/List;
-
-    goto :goto_1
-
-    :catch_0
-    move-exception v0
-
-    goto :goto_0
-
-    :cond_0
-    check-cast v0, Ljava/util/ArrayList;
-
-    invoke-virtual {v0}, Ljava/util/ArrayList;->clear()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_1
-
-    :goto_0
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :goto_1
-    sget-object v0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mInstallLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    const/4 v1, 0x0
-
-    :try_start_1
-    sget-object v2, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mPackageTasker:Lcom/android/server/pm/Installer;
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->notAppliedPaths:Ljava/util/List;
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-    :try_end_1
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_1 .. :try_end_1} :catch_2
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    :try_start_2
-    iget-object v2, v2, Lcom/android/server/pm/Installer;->mInstalld:Landroid/os/IInstalld;
-
-    invoke-interface {v2, p1, v3}, Landroid/os/IInstalld;->hasDualDARPolicyRecursively(Ljava/lang/String;Ljava/util/List;)Z
-
-    move-result p1
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    :try_start_3
-    iget-object v2, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->notAppliedPaths:Ljava/util/List;
-
-    check-cast v2, Ljava/util/ArrayList;
-
-    invoke-virtual {v2}, Ljava/util/ArrayList;->isEmpty()Z
-
-    move-result v2
-
-    if-nez v2, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->notAppliedPaths:Ljava/util/List;
-
-    check-cast p0, Ljava/util/ArrayList;
-
-    invoke-virtual {p0}, Ljava/util/ArrayList;->size()I
-
-    move-result v2
-
-    :goto_2
-    if-ge v1, v2, :cond_1
-
-    invoke-virtual {p0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v3
-
-    add-int/lit8 v1, v1, 0x1
-
-    check-cast v3, Ljava/lang/String;
-
-    const-string v4, "EnterprisePartitionManager"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v6, "Policy not applied paths : "
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v4, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    move-object v4, p2
-
-    check-cast v4, Ljava/util/ArrayList;
-
-    invoke-virtual {v4, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_2
-
-    :catchall_0
-    move-exception p0
-
-    goto/16 :goto_5
-
-    :cond_1
-    monitor-exit v0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    return p1
-
-    :catch_1
-    move-exception p1
-
-    :try_start_4
-    invoke-static {p1}, Lcom/android/server/pm/Installer$InstallerException;->from(Ljava/lang/Exception;)V
-
-    const/4 p1, 0x0
-
-    throw p1
-    :try_end_4
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_4 .. :try_end_4} :catch_2
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
-
-    :catchall_1
-    move-exception p1
-
-    :try_start_5
-    iget-object v2, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->notAppliedPaths:Ljava/util/List;
-
-    check-cast v2, Ljava/util/ArrayList;
-
-    invoke-virtual {v2}, Ljava/util/ArrayList;->isEmpty()Z
-
-    move-result v2
-
-    if-nez v2, :cond_2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->notAppliedPaths:Ljava/util/List;
-
-    check-cast p0, Ljava/util/ArrayList;
-
-    invoke-virtual {p0}, Ljava/util/ArrayList;->size()I
-
-    move-result v2
-
-    :goto_3
-    if-ge v1, v2, :cond_2
-
-    invoke-virtual {p0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v3
-
-    add-int/lit8 v1, v1, 0x1
-
-    check-cast v3, Ljava/lang/String;
-
-    const-string v4, "EnterprisePartitionManager"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v6, "Policy not applied paths : "
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v4, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    move-object v4, p2
-
-    check-cast v4, Ljava/util/ArrayList;
-
-    invoke-virtual {v4, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_3
-
-    :cond_2
-    throw p1
-
-    :catch_2
-    iget-object p1, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->notAppliedPaths:Ljava/util/List;
-
-    check-cast p1, Ljava/util/ArrayList;
-
-    invoke-virtual {p1}, Ljava/util/ArrayList;->isEmpty()Z
-
-    move-result p1
-
-    if-nez p1, :cond_3
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->notAppliedPaths:Ljava/util/List;
-
-    check-cast p0, Ljava/util/ArrayList;
-
-    invoke-virtual {p0}, Ljava/util/ArrayList;->size()I
-
-    move-result p1
-
-    move v2, v1
-
-    :goto_4
-    if-ge v2, p1, :cond_3
-
-    invoke-virtual {p0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v3
-
-    add-int/lit8 v2, v2, 0x1
-
-    check-cast v3, Ljava/lang/String;
-
-    const-string v4, "EnterprisePartitionManager"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v6, "Policy not applied paths : "
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v4, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    move-object v4, p2
-
-    check-cast v4, Ljava/util/ArrayList;
-
-    invoke-virtual {v4, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_4
-
-    :cond_3
-    monitor-exit v0
-
-    return v1
-
-    :goto_5
-    monitor-exit v0
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_0
-
-    throw p0
-.end method
-
 .method public final isUserUnlocked(I)Z
     .locals 7
 
diff --git a/smali/com/android/server/knox/dar/ddar/DDLog$CountingOutputStream.smali b/smali/com/android/server/knox/dar/ddar/DDLog$CountingOutputStream.smali
deleted file mode 100644
index b11c8e723..000000000
--- a/smali/com/android/server/knox/dar/ddar/DDLog$CountingOutputStream.smali
+++ /dev/null
@@ -1,106 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;
-.super Ljava/io/FilterOutputStream;
-.source "SourceFile"
-
-
-# instance fields
-.field public count:J
-
-
-# virtual methods
-.method public final declared-synchronized close()V
-    .locals 1
-
-    monitor-enter p0
-
-    :try_start_0
-    iget-object v0, p0, Ljava/io/FilterOutputStream;->out:Ljava/io/OutputStream;
-
-    invoke-virtual {v0}, Ljava/io/OutputStream;->close()V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit p0
-
-    return-void
-
-    :catchall_0
-    move-exception v0
-
-    :try_start_1
-    monitor-exit p0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw v0
-.end method
-
-.method public final declared-synchronized write(I)V
-    .locals 4
-
-    monitor-enter p0
-
-    :try_start_0
-    iget-object v0, p0, Ljava/io/FilterOutputStream;->out:Ljava/io/OutputStream;
-
-    invoke-virtual {v0, p1}, Ljava/io/OutputStream;->write(I)V
-
-    iget-wide v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;->count:J
-
-    const-wide/16 v2, 0x1
-
-    add-long/2addr v0, v2
-
-    iput-wide v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;->count:J
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit p0
-
-    return-void
-
-    :catchall_0
-    move-exception p1
-
-    :try_start_1
-    monitor-exit p0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p1
-.end method
-
-.method public final declared-synchronized write([BII)V
-    .locals 2
-
-    monitor-enter p0
-
-    :try_start_0
-    iget-object v0, p0, Ljava/io/FilterOutputStream;->out:Ljava/io/OutputStream;
-
-    invoke-virtual {v0, p1, p2, p3}, Ljava/io/OutputStream;->write([BII)V
-
-    iget-wide p1, p0, Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;->count:J
-
-    int-to-long v0, p3
-
-    add-long/2addr p1, v0
-
-    iput-wide p1, p0, Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;->count:J
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit p0
-
-    return-void
-
-    :catchall_0
-    move-exception p1
-
-    :try_start_1
-    monitor-exit p0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p1
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/DDLog$Logger$1.smali b/smali/com/android/server/knox/dar/ddar/DDLog$Logger$1.smali
deleted file mode 100644
index bbb0d86d0..000000000
--- a/smali/com/android/server/knox/dar/ddar/DDLog$Logger$1.smali
+++ /dev/null
@@ -1,45 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/DDLog$Logger$1;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/io/FilenameFilter;
-
-
-# virtual methods
-.method public final accept(Ljava/io/File;Ljava/lang/String;)Z
-    .locals 0
-
-    const-string/jumbo p0, "ddar_fw_log"
-
-    invoke-virtual {p2, p0}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const-string p0, ".txt"
-
-    invoke-virtual {p2, p0}, Ljava/lang/String;->endsWith(Ljava/lang/String;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const-string/jumbo p0, "ddar_fw_log.txt"
-
-    invoke-virtual {p2, p0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z
-
-    move-result p0
-
-    if-nez p0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/DDLog$Logger$2.smali b/smali/com/android/server/knox/dar/ddar/DDLog$Logger$2.smali
deleted file mode 100644
index 52aaac337..000000000
--- a/smali/com/android/server/knox/dar/ddar/DDLog$Logger$2.smali
+++ /dev/null
@@ -1,110 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;
-.super Ljava/lang/Thread;
-.source "SourceFile"
-
-
-# instance fields
-.field public final synthetic this$0:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/ddar/DDLog$Logger;)V
-    .locals 0
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;->this$0:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    const-string/jumbo p1, "Log Worker"
-
-    invoke-direct {p0, p1}, Ljava/lang/Thread;-><init>(Ljava/lang/String;)V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final run()V
-    .locals 4
-
-    const-string v0, "DualDAR:DDLog:Logger"
-
-    const-string v1, "DDAR Logger started running"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;->this$0:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    iget-boolean v2, v1, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->loggerRunning:Z
-
-    if-eqz v2, :cond_1
-
-    :try_start_0
-    iget-object v1, v1, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->storeQ:Ljava/util/concurrent/BlockingQueue;
-
-    check-cast v1, Ljava/util/concurrent/LinkedBlockingQueue;
-
-    invoke-virtual {v1}, Ljava/util/concurrent/LinkedBlockingQueue;->size()I
-
-    move-result v1
-
-    if-nez v1, :cond_0
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;->this$0:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    iget-object v1, v1, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->fos:Ljava/io/OutputStreamWriter;
-
-    if-eqz v1, :cond_0
-
-    invoke-virtual {v1}, Ljava/io/OutputStreamWriter;->flush()V
-
-    goto :goto_1
-
-    :catch_0
-    move-exception v1
-
-    goto :goto_2
-
-    :cond_0
-    :goto_1
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;->this$0:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    iget-object v1, v1, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->storeQ:Ljava/util/concurrent/BlockingQueue;
-
-    check-cast v1, Ljava/util/concurrent/LinkedBlockingQueue;
-
-    invoke-virtual {v1}, Ljava/util/concurrent/LinkedBlockingQueue;->take()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Ljava/lang/String;
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;->this$0:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    invoke-static {v2, v1}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->-$$Nest$mrealStore(Lcom/android/server/knox/dar/ddar/DDLog$Logger;Ljava/lang/String;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :goto_2
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string v3, "Caught exception in log worker: "
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v0, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V
-
-    goto :goto_0
-
-    :cond_1
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/DDLog$Logger.smali b/smali/com/android/server/knox/dar/ddar/DDLog$Logger.smali
index 2494f3d70..a7b86e09f 100644
--- a/smali/com/android/server/knox/dar/ddar/DDLog$Logger.smali
+++ b/smali/com/android/server/knox/dar/ddar/DDLog$Logger.smali
@@ -1,775 +1,3 @@
-.class public final Lcom/android/server/knox/dar/ddar/DDLog$Logger;
+.class public abstract Lcom/android/server/knox/dar/ddar/DDLog$Logger;
 .super Ljava/lang/Object;
 .source "SourceFile"
-
-
-# static fields
-.field public static mInstance:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-
-# instance fields
-.field public cos:Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;
-
-.field public currentFile:Ljava/io/File;
-
-.field public fos:Ljava/io/OutputStreamWriter;
-
-.field public final logWorker:Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;
-
-.field public loggerRunning:Z
-
-.field public final storageDir:Ljava/io/File;
-
-.field public final storeQ:Ljava/util/concurrent/BlockingQueue;
-
-
-# direct methods
-.method public static -$$Nest$mrealStore(Lcom/android/server/knox/dar/ddar/DDLog$Logger;Ljava/lang/String;)V
-    .locals 7
-
-    const-string v0, "\' is larger than 4194304 bytes. Rotating file."
-
-    const-string v1, "File \'"
-
-    monitor-enter p0
-
-    :try_start_0
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    if-nez v2, :cond_1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->openCurrentFile()V
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    if-eqz v2, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    new-instance p1, Ljava/lang/IllegalStateException;
-
-    const-string/jumbo v0, "No current file set in realStore!"
-
-    invoke-direct {p1, v0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
-
-    throw p1
-
-    :catchall_0
-    move-exception p1
-
-    goto :goto_3
-
-    :catch_0
-    move-exception p1
-
-    goto :goto_1
-
-    :cond_1
-    :goto_0
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->cos:Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;
-
-    monitor-enter v2
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :try_start_1
-    iget-wide v3, v2, Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;->count:J
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    :try_start_2
-    monitor-exit v2
-
-    const-wide/32 v5, 0x400000
-
-    cmp-long v2, v3, v5
-
-    if-lez v2, :cond_2
-
-    const-string v2, "DualDAR:DDLog:Logger"
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    invoke-virtual {v1}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->roll()V
-
-    :cond_2
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->fos:Ljava/io/OutputStreamWriter;
-
-    invoke-virtual {v0, p1}, Ljava/io/OutputStreamWriter;->write(Ljava/lang/String;)V
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    goto :goto_2
-
-    :catchall_1
-    move-exception p1
-
-    :try_start_3
-    monitor-exit v2
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    :try_start_4
-    throw p1
-    :try_end_4
-    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_0
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    :goto_1
-    :try_start_5
-    const-string v0, "DualDAR:DDLog:Logger"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "Caught exception while writing to stream! "
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p1}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_0
-
-    :goto_2
-    monitor-exit p0
-
-    return-void
-
-    :goto_3
-    :try_start_6
-    monitor-exit p0
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_0
-
-    throw p1
-.end method
-
-.method public constructor <init>()V
-    .locals 2
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    new-instance v0, Ljava/util/concurrent/LinkedBlockingQueue;
-
-    invoke-direct {v0}, Ljava/util/concurrent/LinkedBlockingQueue;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->storeQ:Ljava/util/concurrent/BlockingQueue;
-
-    new-instance v0, Ljava/io/File;
-
-    const-string v1, "/data/log"
-
-    invoke-direct {v0, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->storageDir:Ljava/io/File;
-
-    const/4 v0, 0x0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->cos:Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->fos:Ljava/io/OutputStreamWriter;
-
-    const/4 v0, 0x0
-
-    iput-boolean v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->loggerRunning:Z
-
-    new-instance v0, Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;
-
-    invoke-direct {v0, p0}, Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;-><init>(Lcom/android/server/knox/dar/ddar/DDLog$Logger;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->logWorker:Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;
-
-    return-void
-.end method
-
-.method public static enqueLog(Ljava/lang/String;)V
-    .locals 5
-
-    const-class v0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v0
-
-    if-nez v1, :cond_0
-
-    const-string v0, ""
-
-    invoke-static {v0, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-
-    :cond_0
-    iget-boolean v0, v1, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->loggerRunning:Z
-
-    if-nez v0, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    :try_start_1
-    iget-object v0, v1, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->storeQ:Ljava/util/concurrent/BlockingQueue;
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J
-
-    move-result-wide v2
-
-    new-instance v4, Ljava/util/Date;
-
-    invoke-direct {v4, v2, v3}, Ljava/util/Date;-><init>(J)V
-
-    new-instance v2, Ljava/text/SimpleDateFormat;
-
-    const-string/jumbo v3, "MM-dd HH:mm:ss.SSS"
-
-    invoke-direct {v2, v3}, Ljava/text/SimpleDateFormat;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, v4}, Ljava/text/Format;->format(Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v2, " "
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-interface {v0, p0}, Ljava/util/concurrent/BlockingQueue;->add(Ljava/lang/Object;)Z
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-
-    return-void
-
-    :catch_0
-    move-exception p0
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string v1, "Caught exception while adding to store queue! "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string v1, "DualDAR:DDLog:Logger"
-
-    invoke-static {v1, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :goto_0
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-.end method
-
-
-# virtual methods
-.method public final cleanupBackupFiles()V
-    .locals 4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->storageDir:Ljava/io/File;
-
-    new-instance v0, Lcom/android/server/knox/dar/ddar/DDLog$Logger$1;
-
-    invoke-direct {v0}, Ljava/lang/Object;-><init>()V
-
-    invoke-virtual {p0, v0}, Ljava/io/File;->listFiles(Ljava/io/FilenameFilter;)[Ljava/io/File;
-
-    move-result-object p0
-
-    const/4 v0, 0x0
-
-    :goto_0
-    array-length v1, p0
-
-    if-ge v0, v1, :cond_1
-
-    aget-object v1, p0, v0
-
-    invoke-virtual {v1}, Ljava/io/File;->delete()Z
-
-    move-result v1
-
-    const-string v2, "DualDAR:DDLog:Logger"
-
-    if-nez v1, :cond_0
-
-    aget-object v1, p0, v0
-
-    filled-new-array {v1}, [Ljava/lang/Object;
-
-    move-result-object v1
-
-    const-string v3, "Failed to delete file: %s"
-
-    invoke-static {v3, v1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v2, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_0
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "Log File "
-
-    invoke-direct {v1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    aget-object v3, p0, v0
-
-    invoke-virtual {v3}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "is removed as next backup log file is ready"
-
-    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v2, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    add-int/lit8 v0, v0, 0x1
-
-    goto :goto_0
-
-    :cond_1
-    return-void
-.end method
-
-.method public final moveCurrentToBackup()V
-    .locals 3
-
-    new-instance v0, Ljava/text/SimpleDateFormat;
-
-    const-string v1, "-yyyy-MM-dd-HH-mm-ss"
-
-    invoke-direct {v0, v1}, Ljava/text/SimpleDateFormat;-><init>(Ljava/lang/String;)V
-
-    new-instance v1, Ljava/util/Date;
-
-    invoke-direct {v1}, Ljava/util/Date;-><init>()V
-
-    invoke-virtual {v0, v1}, Ljava/text/SimpleDateFormat;->format(Ljava/util/Date;)Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "ddar_fw_log"
-
-    const-string v2, ".txt"
-
-    invoke-static {v1, v0, v2}, Lcom/android/internal/util/jobs/XmlUtils$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    new-instance v1, Ljava/io/File;
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->storageDir:Ljava/io/File;
-
-    invoke-direct {v1, v2, v0}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "Rename Log File "
-
-    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    invoke-virtual {v2}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v2, " to "
-
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string v2, "DualDAR:DDLog:Logger"
-
-    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    invoke-virtual {v0, v1}, Ljava/io/File;->renameTo(Ljava/io/File;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    filled-new-array {p0, v1}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string v0, "Failed to renameTo file: %s to %s"
-
-    invoke-static {v0, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v2, p0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_0
-    return-void
-.end method
-
-.method public final openCurrentFile()V
-    .locals 5
-
-    new-instance v0, Ljava/io/File;
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->storageDir:Ljava/io/File;
-
-    const-string/jumbo v2, "ddar_fw_log.txt"
-
-    invoke-direct {v0, v1, v2}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    invoke-virtual {v0}, Ljava/io/File;->exists()Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    invoke-virtual {v0}, Ljava/io/File;->createNewFile()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    new-instance v0, Ljava/io/IOException;
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string v2, "Cannot create file "
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    invoke-virtual {p0}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-direct {v0, p0}, Ljava/io/IOException;-><init>(Ljava/lang/String;)V
-
-    throw v0
-
-    :cond_1
-    :goto_0
-    const-string v0, "DualDAR:DDLog:Logger"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "Opened Existing or New Log file "
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    invoke-virtual {v2}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v2, " of length "
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    invoke-virtual {v2}, Ljava/io/File;->length()J
-
-    move-result-wide v2
-
-    invoke-virtual {v1, v2, v3}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v0, Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;
-
-    new-instance v1, Ljava/io/BufferedOutputStream;
-
-    new-instance v2, Ljava/io/FileOutputStream;
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    const/4 v4, 0x1
-
-    invoke-direct {v2, v3, v4}, Ljava/io/FileOutputStream;-><init>(Ljava/io/File;Z)V
-
-    invoke-direct {v1, v2}, Ljava/io/BufferedOutputStream;-><init>(Ljava/io/OutputStream;)V
-
-    invoke-direct {v0, v1}, Ljava/io/FilterOutputStream;-><init>(Ljava/io/OutputStream;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->cos:Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    invoke-virtual {v1}, Ljava/io/File;->length()J
-
-    move-result-wide v1
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-wide v3, v0, Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;->count:J
-
-    add-long/2addr v3, v1
-
-    iput-wide v3, v0, Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;->count:J
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v0
-
-    new-instance v0, Ljava/io/OutputStreamWriter;
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->cos:Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;
-
-    const-string/jumbo v2, "UTF-8"
-
-    invoke-static {v2}, Ljava/nio/charset/Charset;->forName(Ljava/lang/String;)Ljava/nio/charset/Charset;
-
-    move-result-object v2
-
-    invoke-direct {v0, v1, v2}, Ljava/io/OutputStreamWriter;-><init>(Ljava/io/OutputStream;Ljava/nio/charset/Charset;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->fos:Ljava/io/OutputStreamWriter;
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-.method public final roll()V
-    .locals 3
-
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->fos:Ljava/io/OutputStreamWriter;
-    :try_end_0
-    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_1
-
-    if-nez v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    :try_start_1
-    invoke-virtual {v0}, Ljava/io/OutputStreamWriter;->flush()V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->fos:Ljava/io/OutputStreamWriter;
-
-    invoke-virtual {v0}, Ljava/io/OutputStreamWriter;->close()V
-
-    const/4 v0, 0x0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->fos:Ljava/io/OutputStreamWriter;
-    :try_end_1
-    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception v0
-
-    :try_start_2
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string v2, "Caught exception while closing stream! "
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    const-string v2, "DualDAR:DDLog:Logger"
-
-    invoke-static {v2, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v0}, Ljava/io/IOException;->printStackTrace()V
-
-    :goto_0
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->cleanupBackupFiles()V
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->moveCurrentToBackup()V
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->openCurrentFile()V
-    :try_end_2
-    .catch Ljava/io/IOException; {:try_start_2 .. :try_end_2} :catch_1
-
-    return-void
-
-    :catch_1
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/io/IOException;->printStackTrace()V
-
-    return-void
-.end method
-
-.method public final start()V
-    .locals 3
-
-    const/4 v0, 0x1
-
-    iput-boolean v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->loggerRunning:Z
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->logWorker:Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;
-
-    invoke-virtual {v1, v0}, Ljava/lang/Thread;->setDaemon(Z)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->logWorker:Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;
-
-    invoke-virtual {p0}, Ljava/lang/Thread;->start()V
-
-    const-string/jumbo p0, "ro.build.PDA"
-
-    const-string/jumbo v0, "Unknown"
-
-    invoke-static {p0, v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    const/16 v0, 0x5f
-
-    invoke-virtual {p0, v0}, Ljava/lang/String;->indexOf(I)I
-
-    move-result v1
-
-    const/4 v2, -0x1
-
-    if-eq v1, v2, :cond_0
-
-    const/4 v1, 0x0
-
-    invoke-virtual {p0, v0}, Ljava/lang/String;->indexOf(I)I
-
-    move-result v0
-
-    invoke-virtual {p0, v1, v0}, Ljava/lang/String;->substring(II)Ljava/lang/String;
-
-    move-result-object p0
-
-    :cond_0
-    filled-new-array {p0}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string v0, "DDAR Logging Started [DeviceVersion : %s]%n"
-
-    invoke-static {v0, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->enqueLog(Ljava/lang/String;)V
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/DDLog$LoggerProxy.smali b/smali/com/android/server/knox/dar/ddar/DDLog$LoggerProxy.smali
deleted file mode 100644
index b79fa407d..000000000
--- a/smali/com/android/server/knox/dar/ddar/DDLog$LoggerProxy.smali
+++ /dev/null
@@ -1,60 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-.super Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;
-.source "SourceFile"
-
-
-# static fields
-.field public static mInstance:Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-
-
-# virtual methods
-.method public final onMessage(ILjava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
-    .locals 1
-
-    :try_start_0
-    new-instance p0, Landroid/os/Bundle;
-
-    invoke-direct {p0}, Landroid/os/Bundle;-><init>()V
-
-    invoke-virtual {p2}, Ljava/lang/String;->hashCode()I
-
-    move-result p1
-
-    const v0, 0x6d6d3bb2
-
-    if-eq p1, v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const-string p1, "LOG_MSG_COMMAND"
-
-    invoke-virtual {p2, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_1
-
-    const-string p1, "LOG_MSG"
-
-    invoke-virtual {p3, p1}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->enqueLog(Ljava/lang/String;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    :cond_1
-    :goto_0
-    return-object p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/DDLog.smali b/smali/com/android/server/knox/dar/ddar/DDLog.smali
index 9f29b1353..e5f29d8e9 100644
--- a/smali/com/android/server/knox/dar/ddar/DDLog.smali
+++ b/smali/com/android/server/knox/dar/ddar/DDLog.smali
@@ -31,7 +31,15 @@
 
     move-result-object p2
 
-    invoke-static {p2}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->enqueLog(Ljava/lang/String;)V
+    const-class v0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;
+
+    monitor-enter v0
+
+    monitor-exit v0
+
+    const-string v0, ""
+
+    invoke-static {v0, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
@@ -65,7 +73,15 @@
 
     move-result-object p2
 
-    invoke-static {p2}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->enqueLog(Ljava/lang/String;)V
+    const-class v0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;
+
+    monitor-enter v0
+
+    monitor-exit v0
+
+    const-string v0, ""
+
+    invoke-static {v0, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
@@ -128,70 +144,34 @@
     return-object v0
 .end method
 
-.method public static varargs i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    .locals 1
-
-    invoke-static {p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p1
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {p2, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v0, ": "
-
-    invoke-virtual {p2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v0, "\n"
+.method public static varargs i(Ljava/lang/String;[Ljava/lang/Object;)V
+    .locals 2
 
-    invoke-virtual {p2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    const-string v0, "DualDARComnService"
 
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-static {p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object p2
-
-    invoke-static {p2}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->enqueLog(Ljava/lang/String;)V
-
-    invoke-static {p0, p1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+    move-result-object p0
 
-    return-void
-.end method
+    const-string p1, "DualDARComnService: "
 
-.method public static varargs v(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    .locals 1
+    const-string v1, "\n"
 
-    invoke-static {p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {p1, p0, v1}, Lcom/android/internal/util/jobs/XmlUtils$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
 
     move-result-object p1
 
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {p2, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v0, ": "
-
-    invoke-virtual {p2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    const-class v1, Lcom/android/server/knox/dar/ddar/DDLog$Logger;
 
-    const-string v0, "\n"
+    monitor-enter v1
 
-    invoke-virtual {p2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    monitor-exit v1
 
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    const-string v1, ""
 
-    move-result-object p2
-
-    invoke-static {p2}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->enqueLog(Ljava/lang/String;)V
+    invoke-static {v1, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, p0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
     return-void
 .end method
diff --git a/smali/com/android/server/knox/dar/ddar/DualDarDoPolicyChecker.smali b/smali/com/android/server/knox/dar/ddar/DualDarDoPolicyChecker.smali
deleted file mode 100644
index 49ad4937c..000000000
--- a/smali/com/android/server/knox/dar/ddar/DualDarDoPolicyChecker.smali
+++ /dev/null
@@ -1,67 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# static fields
-.field public static sContext:Landroid/content/Context;
-
-.field public static sInstance:Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;
-
-
-# instance fields
-.field public skippedPackages:Ljava/util/List;
-
-
-# direct methods
-.method public static declared-synchronized getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;
-    .locals 2
-
-    const-class v0, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;
-
-    monitor-enter v0
-
-    :try_start_0
-    sput-object p0, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;->sContext:Landroid/content/Context;
-
-    sget-object p0, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;->sInstance:Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;
-
-    if-nez p0, :cond_0
-
-    new-instance p0, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    new-instance v1, Ljava/util/ArrayList;
-
-    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;->skippedPackages:Ljava/util/List;
-
-    sput-object p0, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;->sInstance:Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    :goto_0
-    sget-object p0, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;->sInstance:Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v0
-
-    return-object p0
-
-    :goto_1
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda0.smali b/smali/com/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda0.smali
deleted file mode 100644
index 5085ac740..000000000
--- a/smali/com/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda0.smali
+++ /dev/null
@@ -1,44 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda0;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 0
-
-    check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    :try_start_0
-    new-instance p0, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-direct {p0}, Lcom/samsung/android/knox/ContextInfo;-><init>()V
-
-    invoke-interface {p1, p0}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getPasswordMinimumLengthForInner(Lcom/samsung/android/knox/ContextInfo;)I
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-object p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    const/4 p0, 0x0
-
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    return-object p0
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1.smali b/smali/com/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1.smali
deleted file mode 100644
index 845d26c40..000000000
--- a/smali/com/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1.smali
+++ /dev/null
@@ -1,50 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;
-
-
-# instance fields
-.field public final synthetic f$0:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final runOrThrow()V
-    .locals 2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v0, Landroid/content/Intent;
-
-    const-string/jumbo v1, "android.app.action.DEVICE_POLICY_MANAGER_STATE_CHANGED"
-
-    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V
-
-    const/high16 v1, 0x40000000    # 2.0f
-
-    invoke-virtual {v0, v1}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->sendBroadcast(Landroid/content/Intent;)V
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/core/DualDarDoManagerImpl.smali b/smali/com/android/server/knox/dar/ddar/core/DualDarDoManagerImpl.smali
deleted file mode 100644
index 60b898530..000000000
--- a/smali/com/android/server/knox/dar/ddar/core/DualDarDoManagerImpl.smali
+++ /dev/null
@@ -1,154 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public mHasTokenSetForInner:Z
-
-.field public final mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-.field public final mNonClearablePackages:Ljava/util/List;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/DarManagerService$Injector;)V
-    .locals 8
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    const/4 v0, 0x0
-
-    iput-boolean v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    new-instance v0, Ljava/util/ArrayList;
-
-    const-string/jumbo v4, "com.google.android.providers.media.module"
-
-    const-string/jumbo v5, "com.google.android.apps.work.clouddpc"
-
-    const-string/jumbo v1, "com.android.settings"
-
-    const-string/jumbo v2, "com.google.android.gms"
-
-    const-string/jumbo v3, "com.samsung.android.knox.containercore"
-
-    const-string/jumbo v6, "com.samsung.sec.android.application.csc"
-
-    const-string/jumbo v7, "com.google.android.webview"
-
-    filled-new-array/range {v1 .. v7}, [Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v1}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
-
-    move-result-object v1
-
-    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mNonClearablePackages:Ljava/util/List;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final getInnerAuthUserId(I)I
-    .locals 1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    const-string/jumbo v0, "ddar.inner.auth.userid"
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    :try_start_0
-    invoke-virtual {p0, p1, v0}, Lcom/android/server/knox/dar/DarDatabaseCache;->getInternal(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    invoke-static {p0}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
-
-    move-result p0
-    :try_end_0
-    .catch Ljava/lang/NumberFormatException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return p0
-
-    :catch_0
-    :cond_0
-    const/16 p0, -0x2710
-
-    return p0
-.end method
-
-.method public final getPasswordMinimumLengthForInner()I
-    .locals 2
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    if-nez v0, :cond_0
-
-    const-string v0, "DualDARPolicy"
-
-    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/samsung/android/knox/ddar/IDualDARPolicy$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    move-result-object v0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda0;
-
-    invoke-direct {v0}, Ljava/lang/Object;-><init>()V
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Ljava/lang/Integer;
-
-    invoke-virtual {p0}, Ljava/lang/Integer;->intValue()I
-
-    move-result p0
-
-    return p0
-
-    :cond_1
-    return v1
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0.smali b/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0.smali
deleted file mode 100644
index 10e01341e..000000000
--- a/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0.smali
+++ /dev/null
@@ -1,60 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Consumer;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:Ljava/lang/String;
-
-
-# direct methods
-.method public synthetic constructor <init>(Ljava/lang/String;I)V
-    .locals 0
-
-    iput p2, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0;->$r8$classId:I
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0;->f$0:Ljava/lang/String;
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 1
-
-    iget v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0;->$r8$classId:I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0;->f$0:Ljava/lang/String;
-
-    check-cast p1, Lcom/android/server/knox/dar/DarManagerService;
-
-    packed-switch v0, :pswitch_data_0
-
-    const/4 v0, 0x0
-
-    invoke-virtual {p1, v0, p0}, Lcom/android/server/knox/dar/DarManagerService;->addBlockedClearablePackages(ILjava/lang/String;)V
-
-    return-void
-
-    :pswitch_0
-    const/4 v0, 0x0
-
-    invoke-virtual {p1, v0, p0}, Lcom/android/server/knox/dar/DarManagerService;->addBlockedClearablePackages(ILjava/lang/String;)V
-
-    return-void
-
-    nop
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2.smali b/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2.smali
deleted file mode 100644
index 6a46f6f0f..000000000
--- a/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2.smali
+++ /dev/null
@@ -1,36 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/lang/Runnable;
-
-
-# instance fields
-.field public final synthetic f$0:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2;->f$0:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final run()V
-    .locals 1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2;->f$0:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    const/4 v0, 0x0
-
-    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->handleDataLock(I)V
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector.smali b/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector.smali
deleted file mode 100644
index 34b2eea64..000000000
--- a/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector.smali
+++ /dev/null
@@ -1,19 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public final mContext:Landroid/content/Context;
-
-
-# direct methods
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;->mContext:Landroid/content/Context;
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener.smali b/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener.smali
deleted file mode 100644
index b6f2ca6db..000000000
--- a/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener.smali
+++ /dev/null
@@ -1,80 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Landroid/app/AlarmManager$OnAlarmListener;
-
-
-# instance fields
-.field public final mContext:Landroid/content/Context;
-
-.field public final mUserId:I
-
-
-# direct methods
-.method public constructor <init>(Landroid/content/Context;I)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener;->mContext:Landroid/content/Context;
-
-    iput p2, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener;->mUserId:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final onAlarm()V
-    .locals 4
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "LicenseExpiryAlarmListener onAlarm() "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget v1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener;->mUserId:I
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v1, 0x0
-
-    new-array v1, v1, [Ljava/lang/Object;
-
-    const-string v2, "DualDarManagerImpl"
-
-    invoke-static {v2, v0, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-instance v0, Landroid/os/Bundle;
-
-    invoke-direct {v0}, Landroid/os/Bundle;-><init>()V
-
-    const-string/jumbo v1, "user_id"
-
-    iget v2, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener;->mUserId:I
-
-    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManager;
-
-    move-result-object p0
-
-    const-string v1, "EXPIRE_TRIAL_PERIOD_TIME"
-
-    const-string v2, "KNOXCORE_PROXY_AGENT"
-
-    const-string v3, "DUALDAR_CONTROLLER_SERVICE"
-
-    invoke-virtual {p0, v2, v3, v1, v0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManager;->relayMessage(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl.smali b/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl.smali
deleted file mode 100644
index ba7228ba8..000000000
--- a/smali/com/android/server/knox/dar/ddar/core/DualDarManagerImpl.smali
+++ /dev/null
@@ -1,622 +0,0 @@
-.class public Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# static fields
-.field public static delayDataLockOnceForDeviceOwner:Z = false
-
-
-# instance fields
-.field public final hardResetTask:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2;
-
-.field public final mAlarmManager:Landroid/app/AlarmManager;
-
-.field public final mContext:Landroid/content/Context;
-
-.field public final mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-.field public final mHandler:Landroid/os/Handler;
-
-.field public final mInjector:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;
-
-.field public final mLicenseExpiryAlarmListenerForUser:Landroid/util/ArrayMap;
-
-.field public final mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-.field public final mVirtualLockUtils:Lcom/samsung/android/knox/dar/VirtualLockUtils;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;)V
-    .locals 2
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    new-instance v0, Landroid/util/ArrayMap;
-
-    invoke-direct {v0}, Landroid/util/ArrayMap;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mLicenseExpiryAlarmListenerForUser:Landroid/util/ArrayMap;
-
-    new-instance v0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2;
-
-    invoke-direct {v0, p0}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->hardResetTask:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mInjector:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;
-
-    iget-object v0, p1, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;->mContext:Landroid/content/Context;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mContext:Landroid/content/Context;
-
-    new-instance v1, Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-direct {v1, v0}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    new-instance v1, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-direct {v1, v0}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;-><init>(Landroid/content/Context;)V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    new-instance v0, Lcom/samsung/android/knox/dar/VirtualLockUtils;
-
-    invoke-direct {v0}, Lcom/samsung/android/knox/dar/VirtualLockUtils;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mVirtualLockUtils:Lcom/samsung/android/knox/dar/VirtualLockUtils;
-
-    iget-object p1, p1, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;->mContext:Landroid/content/Context;
-
-    const-class v0, Landroid/app/AlarmManager;
-
-    invoke-virtual {p1, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Landroid/app/AlarmManager;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mAlarmManager:Landroid/app/AlarmManager;
-
-    const-string p1, "DualDarManagerImpl"
-
-    invoke-static {p1}, Lcom/android/server/KnoxCaptureInputFilter$$ExternalSyntheticOutline0;->m(Ljava/lang/String;)Landroid/os/HandlerThread;
-
-    move-result-object p1
-
-    new-instance v0, Landroid/os/Handler;
-
-    invoke-virtual {p1}, Landroid/os/HandlerThread;->getLooper()Landroid/os/Looper;
-
-    move-result-object p1
-
-    invoke-direct {v0, p1}, Landroid/os/Handler;-><init>(Landroid/os/Looper;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mHandler:Landroid/os/Handler;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final handleClearDualDarTrialExpiryTimer(Landroid/os/Bundle;)Z
-    .locals 5
-
-    const-string/jumbo v0, "user_id"
-
-    invoke-virtual {p1, v0}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p1
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mLicenseExpiryAlarmListenerForUser:Landroid/util/ArrayMap;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    invoke-virtual {v0, v1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener;
-
-    const/4 v1, 0x0
-
-    if-nez v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const-string/jumbo v2, "handleRemoveLicenseExpiryTimer cancelled alarm successful for user : "
-
-    invoke-static {p1, v2}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v2
-
-    new-array v3, v1, [Ljava/lang/Object;
-
-    const-string v4, "DualDarManagerImpl"
-
-    invoke-static {v4, v2, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mLicenseExpiryAlarmListenerForUser:Landroid/util/ArrayMap;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mInjector:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v2
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mAlarmManager:Landroid/app/AlarmManager;
-
-    invoke-virtual {p0, v0}, Landroid/app/AlarmManager;->cancel(Landroid/app/AlarmManager$OnAlarmListener;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :catch_0
-    move-exception p0
-
-    :try_start_1
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    :goto_0
-    return v1
-
-    :goto_1
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
-.method public final handleDataLock(I)V
-    .locals 8
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_0
-
-    return-void
-
-    :cond_0
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mInjector:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v2, "power"
-
-    invoke-virtual {p1, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Landroid/os/PowerManager;
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v3, "telecom"
-
-    invoke-virtual {v2, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Landroid/telecom/TelecomManager;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mHandler:Landroid/os/Handler;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->hardResetTask:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2;
-
-    const-wide/32 v4, 0xea60
-
-    const/4 v6, 0x0
-
-    const-string v7, "DualDarManagerImpl"
-
-    if-eqz v2, :cond_1
-
-    :try_start_1
-    invoke-virtual {v2}, Landroid/telecom/TelecomManager;->isInCall()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_1
-
-    const-string/jumbo p1, "User is on the phone now. Check in 60 seconds again."
-
-    new-array v2, v6, [Ljava/lang/Object;
-
-    invoke-static {v7, p1, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {v3, p0, v4, v5}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_1
-    if-eqz p1, :cond_2
-
-    invoke-virtual {p1}, Landroid/os/PowerManager;->isInteractive()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_2
-
-    sget-boolean v2, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->delayDataLockOnceForDeviceOwner:Z
-
-    if-nez v2, :cond_2
-
-    const-string/jumbo p1, "User is interactive now. Delay once for 60 seconds."
-
-    new-array v2, v6, [Ljava/lang/Object;
-
-    invoke-static {v7, p1, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const/4 p1, 0x1
-
-    sput-boolean p1, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->delayDataLockOnceForDeviceOwner:Z
-
-    invoke-virtual {v3, p0, v4, v5}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
-
-    goto :goto_0
-
-    :cond_2
-    if-eqz p1, :cond_3
-
-    const-string/jumbo p0, "Perform hard reboot when datalock in DO case"
-
-    new-array v2, v6, [Ljava/lang/Object;
-
-    invoke-static {v7, p0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const-string/jumbo p0, "data lock timeout for dualdar"
-
-    invoke-virtual {p1, p0}, Landroid/os/PowerManager;->reboot(Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_3
-    const-string p0, "Failed to get PowerManager"
-
-    new-array p1, v6, [Ljava/lang/Object;
-
-    invoke-static {v7, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :goto_0
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :goto_1
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
-.method public final handleDeviceOwnerProvisioning(Landroid/os/Bundle;)Z
-    .locals 6
-
-    const-string v0, "DualDarManagerImpl"
-
-    const-string/jumbo v1, "handleDeviceOwnerProvisioning"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string v0, "1"
-
-    const-string/jumbo v1, "persist.sys.dualdar.do"
-
-    invoke-static {v1, v0}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
-
-    if-nez p1, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const-string v0, "DUAL_DAR_ADMIN_PACKAGE"
-
-    invoke-virtual {p1, v0}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v2, "dualdar-config-client-package"
-
-    invoke-virtual {p1, v2}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result v2
-
-    const-string/jumbo v3, "dar"
-
-    if-nez v2, :cond_1
-
-    invoke-static {v3}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/server/knox/dar/DarManagerService;
-
-    invoke-static {v2}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object v2
-
-    new-instance v4, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0;
-
-    const/4 v5, 0x0
-
-    invoke-direct {v4, v0, v5}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0;-><init>(Ljava/lang/String;I)V
-
-    invoke-virtual {v2, v4}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    :cond_1
-    invoke-static {p1}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_2
-
-    invoke-static {v3}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/knox/dar/DarManagerService;
-
-    invoke-static {v0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object v0
-
-    new-instance v2, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0;
-
-    const/4 v3, 0x1
-
-    invoke-direct {v2, p1, v3}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda0;-><init>(Ljava/lang/String;I)V
-
-    invoke-virtual {v0, v2}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    :cond_2
-    :goto_0
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mContext:Landroid/content/Context;
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p1
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->handleDeviceOwnerProvisioning()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_4
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v1, "trust"
-
-    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/app/trust/TrustManager;
-
-    const/4 v1, 0x0
-
-    invoke-virtual {v0, v1, v1}, Landroid/app/trust/TrustManager;->setDeviceLockedForUser(IZ)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mVirtualLockUtils:Lcom/samsung/android/knox/dar/VirtualLockUtils;
-
-    invoke-virtual {v0}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->reserveUserIdForSystem()I
-
-    move-result v0
-
-    const/16 v2, -0x2710
-
-    if-eq v0, v2, :cond_3
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {v2, v1, v0}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->setMainUserId(II)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {p0, v0, v1}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->setInnerAuthUserId(II)V
-
-    :cond_3
-    return p1
-
-    :cond_4
-    const-string p0, "0"
-
-    invoke-static {v1, p0}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
-
-    return p1
-.end method
-
-.method public final handleScheduleDualDarTrialExpiryTimer(Landroid/os/Bundle;)Z
-    .locals 6
-
-    const-string/jumbo v0, "user_id"
-
-    invoke-virtual {p1, v0}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v0
-
-    const-string/jumbo v1, "TRIAL_SCHEDULED_TIME"
-
-    invoke-virtual {p1, v1}, Landroid/os/Bundle;->getLong(Ljava/lang/String;)J
-
-    move-result-wide v1
-
-    const-string v3, "IS_CREATION"
-
-    invoke-virtual {p1, v3}, Landroid/os/Bundle;->getBoolean(Ljava/lang/String;)Z
-
-    move-result p1
-
-    const-string v3, "DualDarManagerImpl"
-
-    const/4 v4, 0x0
-
-    if-eqz p1, :cond_0
-
-    const-string/jumbo p1, "setting alarm for license expiry, isCreation = true"
-
-    new-array v4, v4, [Ljava/lang/Object;
-
-    invoke-static {v3, p1, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0, v0, v1, v2}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->scheduleDualDarTrialExpiryTimer(IJ)Z
-
-    move-result p0
-
-    return p0
-
-    :cond_0
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mLicenseExpiryAlarmListenerForUser:Landroid/util/ArrayMap;
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v5
-
-    invoke-virtual {p1, v5}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener;
-
-    if-nez p1, :cond_1
-
-    const-string/jumbo p1, "setting alarm for license expiry, isCreation = false"
-
-    new-array v4, v4, [Ljava/lang/Object;
-
-    invoke-static {v3, p1, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0, v0, v1, v2}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->scheduleDualDarTrialExpiryTimer(IJ)Z
-
-    move-result p0
-
-    return p0
-
-    :cond_1
-    return v4
-.end method
-
-.method public final scheduleDualDarTrialExpiryTimer(IJ)Z
-    .locals 9
-
-    new-instance v5, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mContext:Landroid/content/Context;
-
-    invoke-direct {v5, v0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$LicenseExpiryAlarmListener;-><init>(Landroid/content/Context;I)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mLicenseExpiryAlarmListenerForUser:Landroid/util/ArrayMap;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    invoke-virtual {v0, p1, v5}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mInjector:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v7
-
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mAlarmManager:Landroid/app/AlarmManager;
-
-    const-string/jumbo v4, "LicenseNotificationHandler.LicenseLockForUser"
-
-    const/4 v6, 0x0
-
-    const/4 v1, 0x2
-
-    move-wide v2, p2
-
-    invoke-virtual/range {v0 .. v6}, Landroid/app/AlarmManager;->setExact(IJLjava/lang/String;Landroid/app/AlarmManager$OnAlarmListener;Landroid/os/Handler;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception v0
-
-    move-object p0, v0
-
-    :try_start_1
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    const/4 p0, 0x0
-
-    return p0
-
-    :goto_0
-    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/core/DualDarManagerProxy.smali b/smali/com/android/server/knox/dar/ddar/core/DualDarManagerProxy.smali
deleted file mode 100644
index 75d736dca..000000000
--- a/smali/com/android/server/knox/dar/ddar/core/DualDarManagerProxy.smali
+++ /dev/null
@@ -1,463 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-.super Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;
-.source "SourceFile"
-
-
-# static fields
-.field public static sInstance:Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-
-
-# instance fields
-.field public mDualDarManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-
-# direct methods
-.method public static enforceCallingUser(I)V
-    .locals 2
-
-    invoke-static {p0}, Landroid/os/UserHandle;->getAppId(I)I
-
-    move-result v0
-
-    const/16 v1, 0x1482
-
-    if-eq v0, v1, :cond_2
-
-    invoke-static {p0}, Landroid/os/UserHandle;->getAppId(I)I
-
-    move-result v0
-
-    const/16 v1, 0x3e8
-
-    if-ne v0, v1, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    invoke-static {p0}, Landroid/os/UserHandle;->getAppId(I)I
-
-    move-result v0
-
-    invoke-static {}, Landroid/os/Process;->myUid()I
-
-    move-result v1
-
-    if-ne v0, v1, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    new-instance v0, Ljava/lang/SecurityException;
-
-    const-string v1, "Can only be called by system user. callingUid: "
-
-    invoke-static {p0, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-direct {v0, p0}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
-
-    throw v0
-
-    :cond_2
-    :goto_0
-    return-void
-.end method
-
-.method public static declared-synchronized getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-    .locals 5
-
-    const-class v0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->sInstance:Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-
-    if-nez v1, :cond_0
-
-    new-instance v1, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-
-    invoke-direct {v1}, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;-><init>()V
-
-    const/4 v2, 0x0
-
-    new-array v2, v2, [Ljava/lang/Object;
-
-    const-string v3, "DualDarManagerProxy"
-
-    const-string v4, "DualDarManagerProxy created"
-
-    invoke-static {v3, v4, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-instance v2, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    new-instance v3, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;
-
-    invoke-direct {v3, p0}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;-><init>(Landroid/content/Context;)V
-
-    invoke-direct {v2, v3}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;-><init>(Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;)V
-
-    iput-object v2, v1, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->mDualDarManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    sput-object v1, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->sInstance:Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    :goto_0
-    sget-object p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->sInstance:Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v0
-
-    return-object p0
-
-    :goto_1
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-
-# virtual methods
-.method public final onMessage(ILjava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
-    .locals 6
-
-    :try_start_0
-    new-instance v0, Landroid/os/Bundle;
-
-    invoke-direct {v0}, Landroid/os/Bundle;-><init>()V
-
-    invoke-virtual {p2}, Ljava/lang/String;->hashCode()I
-
-    move-result v1
-
-    const/4 v2, 0x0
-
-    const/4 v3, 0x1
-
-    sparse-switch v1, :sswitch_data_0
-
-    goto :goto_0
-
-    :sswitch_0
-    const-string/jumbo v1, "SCHEDULE_DATA_LOCK"
-
-    invoke-virtual {p2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_0
-
-    const/4 p2, 0x3
-
-    goto :goto_1
-
-    :sswitch_1
-    const-string/jumbo v1, "ON_DEVICE_OWNER_PROVISIONING"
-
-    invoke-virtual {p2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_0
-
-    move p2, v2
-
-    goto :goto_1
-
-    :sswitch_2
-    const-string v1, "ENSURE_DATA_UNLOCKED"
-
-    invoke-virtual {p2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_0
-
-    const/4 p2, 0x2
-
-    goto :goto_1
-
-    :sswitch_3
-    const-string v1, "IS_INNER_LAYER_UNLOCKED"
-
-    invoke-virtual {p2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_0
-
-    move p2, v3
-
-    goto :goto_1
-
-    :sswitch_4
-    const-string v1, "CLEAR_TRIAL_PERIOD_TIME"
-
-    invoke-virtual {p2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_0
-
-    const/4 p2, 0x6
-
-    goto :goto_1
-
-    :sswitch_5
-    const-string v1, "CANCEL_DATA_LOCK"
-
-    invoke-virtual {p2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_0
-
-    const/4 p2, 0x4
-
-    goto :goto_1
-
-    :sswitch_6
-    const-string/jumbo v1, "SET_TRIAL_PERIOD_TIME"
-
-    invoke-virtual {p2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz p2, :cond_0
-
-    const/4 p2, 0x5
-
-    goto :goto_1
-
-    :cond_0
-    :goto_0
-    const/4 p2, -0x1
-
-    :goto_1
-    const-string/jumbo v1, "user_id"
-
-    const-string v4, "DualDarManagerImpl"
-
-    const-string/jumbo v5, "dual_dar_response"
-
-    packed-switch p2, :pswitch_data_0
-
-    goto :goto_2
-
-    :pswitch_0
-    :try_start_1
-    invoke-static {p1}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->enforceCallingUser(I)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->mDualDarManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    invoke-virtual {p0, p3}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->handleClearDualDarTrialExpiryTimer(Landroid/os/Bundle;)Z
-
-    move-result p0
-
-    invoke-virtual {v0, v5, p0}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    return-object v0
-
-    :pswitch_1
-    invoke-static {p1}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->enforceCallingUser(I)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->mDualDarManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    invoke-virtual {p0, p3}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->handleScheduleDualDarTrialExpiryTimer(Landroid/os/Bundle;)Z
-
-    move-result p0
-
-    invoke-virtual {v0, v5, p0}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    return-object v0
-
-    :pswitch_2
-    invoke-static {p1}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->enforceCallingUser(I)V
-
-    invoke-virtual {p3, v1}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->mDualDarManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_1
-
-    :goto_2
-    return-object v0
-
-    :cond_1
-    const-string p1, "Cancel data lock"
-
-    new-array p2, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    sput-boolean v2, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->delayDataLockOnceForDeviceOwner:Z
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mHandler:Landroid/os/Handler;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->hardResetTask:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$$ExternalSyntheticLambda2;
-
-    invoke-virtual {p1, p0}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V
-
-    return-object v0
-
-    :pswitch_3
-    invoke-static {p1}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->enforceCallingUser(I)V
-
-    invoke-virtual {p3, v1}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->mDualDarManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->handleDataLock(I)V
-
-    return-object v0
-
-    :pswitch_4
-    invoke-static {p1}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->enforceCallingUser(I)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->mDualDarManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {p1, v2}, Lcom/android/internal/widget/LockPatternUtils;->isSecure(I)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_2
-
-    const-string/jumbo p0, "handleEnsureDataUnlocked - Not able to ensure while device lockscreen is set"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_3
-
-    :cond_2
-    sget-object p1, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DEVICE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v2, p1}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mContext:Landroid/content/Context;
-
-    const-string/jumbo p1, "trust"
-
-    invoke-virtual {p0, p1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/app/trust/TrustManager;
-
-    invoke-virtual {p0, v2, v2}, Landroid/app/trust/TrustManager;->setDeviceLockedForUser(IZ)V
-
-    move v2, v3
-
-    :goto_3
-    invoke-virtual {v0, v5, v2}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    return-object v0
-
-    :pswitch_5
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->mDualDarManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getDualDARLockstate()Z
-
-    move-result p0
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p2, "isInnerLayerUnlocked - result : "
-
-    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    xor-int/2addr p0, v3
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v4, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v0, v5, p0}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    return-object v0
-
-    :pswitch_6
-    invoke-static {p1}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->enforceCallingUser(I)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->mDualDarManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    invoke-virtual {p0, p3}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;->handleDeviceOwnerProvisioning(Landroid/os/Bundle;)Z
-
-    move-result p0
-
-    invoke-virtual {v0, v5, p0}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-
-    return-object v0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    const/4 p0, 0x0
-
-    return-object p0
-
-    nop
-
-    :sswitch_data_0
-    .sparse-switch
-        -0x69b863fb -> :sswitch_6
-        -0x68086ae5 -> :sswitch_5
-        0x6bc9530 -> :sswitch_4
-        0x37362b4f -> :sswitch_3
-        0x3e778197 -> :sswitch_2
-        0x481c6342 -> :sswitch_1
-        0x552734f8 -> :sswitch_0
-    .end sparse-switch
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_6
-        :pswitch_5
-        :pswitch_4
-        :pswitch_3
-        :pswitch_2
-        :pswitch_1
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/fsm/StateMachineImpl$StateChangeListener.smali b/smali/com/android/server/knox/dar/ddar/fsm/StateMachineImpl$StateChangeListener.smali
deleted file mode 100644
index 9a0febbd9..000000000
--- a/smali/com/android/server/knox/dar/ddar/fsm/StateMachineImpl$StateChangeListener.smali
+++ /dev/null
@@ -1,3 +0,0 @@
-.class public interface abstract Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl$StateChangeListener;
-.super Ljava/lang/Object;
-.source "SourceFile"
diff --git a/smali/com/android/server/knox/dar/ddar/fsm/StateMachineImpl.smali b/smali/com/android/server/knox/dar/ddar/fsm/StateMachineImpl.smali
deleted file mode 100644
index 98267e8fe..000000000
--- a/smali/com/android/server/knox/dar/ddar/fsm/StateMachineImpl.smali
+++ /dev/null
@@ -1,207 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# static fields
-.field public static final validTransitions:Ljava/util/Map;
-
-
-# instance fields
-.field public currentStateMap:Ljava/util/Map;
-
-.field public listenerLock:Ljava/lang/Object;
-
-.field public previousStateMap:Ljava/util/Map;
-
-.field public stateChangeListeners:Ljava/util/List;
-
-.field public stateLock:Ljava/lang/Object;
-
-
-# direct methods
-.method static constructor <clinit>()V
-    .locals 11
-
-    new-instance v0, Ljava/util/HashMap;
-
-    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V
-
-    sput-object v0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->validTransitions:Ljava/util/Map;
-
-    new-instance v1, Ljava/util/EnumMap;
-
-    const-class v2, Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-direct {v1, v2}, Ljava/util/EnumMap;-><init>(Ljava/lang/Class;)V
-
-    sget-object v2, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_CREATED:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    sget-object v3, Lcom/samsung/android/knox/dar/ddar/fsm/State;->DEVICE_UNLOCK_DATA_UNLOCK:Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    invoke-interface {v1, v2, v3}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    sget-object v2, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_REMOVED:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    sget-object v4, Lcom/samsung/android/knox/dar/ddar/fsm/State;->IDLE:Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    invoke-interface {v1, v2, v4}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    invoke-interface {v0, v4, v1}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    new-instance v1, Ljava/util/EnumMap;
-
-    const-class v5, Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-direct {v1, v5}, Ljava/util/EnumMap;-><init>(Ljava/lang/Class;)V
-
-    sget-object v5, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DEVICE_LOCKED:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    sget-object v6, Lcom/samsung/android/knox/dar/ddar/fsm/State;->DEVICE_LOCK_DATA_UNLOCK:Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    invoke-interface {v1, v5, v6}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    sget-object v7, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DATALOCK_TIMEOUT:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    sget-object v8, Lcom/samsung/android/knox/dar/ddar/fsm/State;->DEVICE_UNLOCK_DATA_LOCK:Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    invoke-interface {v1, v7, v8}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    invoke-interface {v1, v2, v4}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    invoke-interface {v0, v3, v1}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    new-instance v1, Ljava/util/EnumMap;
-
-    const-class v9, Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-direct {v1, v9}, Ljava/util/EnumMap;-><init>(Ljava/lang/Class;)V
-
-    sget-object v9, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DEVICE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-interface {v1, v9, v3}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    sget-object v10, Lcom/samsung/android/knox/dar/ddar/fsm/State;->DEVICE_LOCK_DATA_LOCK:Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    invoke-interface {v1, v7, v10}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    invoke-interface {v1, v2, v4}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    invoke-interface {v0, v6, v1}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    new-instance v1, Ljava/util/EnumMap;
-
-    const-class v6, Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-direct {v1, v6}, Ljava/util/EnumMap;-><init>(Ljava/lang/Class;)V
-
-    invoke-interface {v1, v9, v8}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    invoke-interface {v1, v2, v4}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    invoke-interface {v0, v10, v1}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    new-instance v1, Ljava/util/EnumMap;
-
-    const-class v6, Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-direct {v1, v6}, Ljava/util/EnumMap;-><init>(Ljava/lang/Class;)V
-
-    sget-object v6, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-interface {v1, v6, v3}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    invoke-interface {v1, v9, v8}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    invoke-interface {v1, v5, v10}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    invoke-interface {v1, v2, v4}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    invoke-interface {v0, v8, v1}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final getCurrentState(I)Lcom/samsung/android/knox/dar/ddar/fsm/State;
-    .locals 2
-
-    const/4 v0, 0x0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->stateLock:Ljava/lang/Object;
-
-    monitor-enter v1
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    :try_start_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->currentStateMap:Ljava/util/Map;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    :try_start_2
-    check-cast p0, Ljava/util/HashMap;
-
-    invoke-virtual {p0, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_2
-
-    :try_start_3
-    check-cast p0, Lcom/samsung/android/knox/dar/ddar/fsm/State;
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    :try_start_4
-    monitor-exit v1
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception p1
-
-    move-object v0, p0
-
-    goto :goto_0
-
-    :catchall_1
-    move-exception p1
-
-    goto :goto_0
-
-    :catchall_2
-    move-exception p0
-
-    move-object p1, p0
-
-    :goto_0
-    :try_start_5
-    monitor-exit v1
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_1
-
-    :try_start_6
-    throw p1
-    :try_end_6
-    .catch Ljava/lang/Exception; {:try_start_6 .. :try_end_6} :catch_0
-
-    :catch_0
-    move-object p0, v0
-
-    :goto_1
-    if-nez p0, :cond_0
-
-    sget-object p0, Lcom/samsung/android/knox/dar/ddar/fsm/State;->IDLE:Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    :cond_0
-    return-object p0
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/fsm/StateMachineProxy.smali b/smali/com/android/server/knox/dar/ddar/fsm/StateMachineProxy.smali
deleted file mode 100644
index 1b32c1b05..000000000
--- a/smali/com/android/server/knox/dar/ddar/fsm/StateMachineProxy.smali
+++ /dev/null
@@ -1,843 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-.super Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;
-.source "SourceFile"
-
-# interfaces
-.implements Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl$StateChangeListener;
-
-
-# static fields
-.field public static mInstance:Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-
-# instance fields
-.field public final context:Landroid/content/Context;
-
-.field public initiateState:Z
-
-.field public final stateMachine:Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;
-
-
-# direct methods
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 2
-
-    invoke-direct {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;-><init>()V
-
-    const/4 v0, 0x0
-
-    iput-boolean v0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->initiateState:Z
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->context:Landroid/content/Context;
-
-    new-instance p1, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;
-
-    invoke-direct {p1}, Ljava/lang/Object;-><init>()V
-
-    new-instance v0, Ljava/util/HashMap;
-
-    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V
-
-    iput-object v0, p1, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->currentStateMap:Ljava/util/Map;
-
-    new-instance v0, Ljava/util/HashMap;
-
-    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V
-
-    iput-object v0, p1, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->previousStateMap:Ljava/util/Map;
-
-    new-instance v0, Ljava/util/ArrayList;
-
-    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V
-
-    iput-object v0, p1, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->stateChangeListeners:Ljava/util/List;
-
-    new-instance v1, Ljava/lang/Object;
-
-    invoke-direct {v1}, Ljava/lang/Object;-><init>()V
-
-    iput-object v1, p1, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->stateLock:Ljava/lang/Object;
-
-    new-instance v1, Ljava/lang/Object;
-
-    invoke-direct {v1}, Ljava/lang/Object;-><init>()V
-
-    iput-object v1, p1, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->listenerLock:Ljava/lang/Object;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->stateMachine:Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->setInitialState()Z
-
-    monitor-enter v1
-
-    :try_start_0
-    invoke-virtual {v0, p0}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_0
-
-    invoke-virtual {v0, p0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    :cond_0
-    monitor-exit v1
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
-.method public static enforceCallingUser(I)V
-    .locals 2
-
-    invoke-static {p0}, Landroid/os/UserHandle;->getAppId(I)I
-
-    move-result v0
-
-    const/16 v1, 0x1482
-
-    if-eq v0, v1, :cond_2
-
-    invoke-static {p0}, Landroid/os/UserHandle;->getAppId(I)I
-
-    move-result v0
-
-    const/16 v1, 0x3e8
-
-    if-ne v0, v1, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    invoke-static {p0}, Landroid/os/UserHandle;->getAppId(I)I
-
-    move-result v0
-
-    invoke-static {}, Landroid/os/Process;->myUid()I
-
-    move-result v1
-
-    if-ne v0, v1, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    new-instance v0, Ljava/lang/SecurityException;
-
-    const-string v1, "Can only be called by system user. callingUid: "
-
-    invoke-static {p0, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-direct {v0, p0}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
-
-    throw v0
-
-    :cond_2
-    :goto_0
-    return-void
-.end method
-
-
-# virtual methods
-.method public final onMessage(ILjava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
-    .locals 7
-
-    const/4 v0, 0x0
-
-    :try_start_0
-    new-instance v1, Landroid/os/Bundle;
-
-    invoke-direct {v1}, Landroid/os/Bundle;-><init>()V
-
-    invoke-virtual {p2}, Ljava/lang/String;->hashCode()I
-
-    move-result v2
-
-    const/4 v3, 0x2
-
-    const/4 v4, 0x3
-
-    const/4 v5, 0x0
-
-    const/4 v6, 0x1
-
-    sparse-switch v2, :sswitch_data_0
-
-    goto :goto_0
-
-    :sswitch_0
-    const-string v2, "GET_PREVIOUS_STATE"
-
-    invoke-virtual {p2, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_0
-
-    move p2, v4
-
-    goto :goto_1
-
-    :catch_0
-    move-exception p0
-
-    goto/16 :goto_6
-
-    :sswitch_1
-    const-string/jumbo v2, "PROCESS_EVENT"
-
-    invoke-virtual {p2, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_0
-
-    move p2, v6
-
-    goto :goto_1
-
-    :sswitch_2
-    const-string/jumbo v2, "SET_INITIAL_STATE"
-
-    invoke-virtual {p2, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_0
-
-    move p2, v5
-
-    goto :goto_1
-
-    :sswitch_3
-    const-string v2, "GET_CURRENT_STATE"
-
-    invoke-virtual {p2, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_0
-
-    move p2, v3
-
-    goto :goto_1
-
-    :cond_0
-    :goto_0
-    const/4 p2, -0x1
-
-    :goto_1
-    if-eqz p2, :cond_7
-
-    if-eq p2, v6, :cond_6
-
-    if-eq p2, v3, :cond_4
-
-    if-eq p2, v4, :cond_1
-
-    goto :goto_5
-
-    :cond_1
-    const-string p1, "KEY_DUAL_DAR_USER_ID"
-
-    invoke-virtual {p3, p1}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->stateMachine:Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    :try_start_1
-    iget-object p2, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->stateLock:Ljava/lang/Object;
-
-    monitor-enter p2
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1
-
-    :try_start_2
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->previousStateMap:Ljava/util/Map;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    :try_start_3
-    check-cast p0, Ljava/util/HashMap;
-
-    invoke-virtual {p0, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_2
-
-    :try_start_4
-    check-cast p0, Lcom/samsung/android/knox/dar/ddar/fsm/State;
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
-
-    :try_start_5
-    monitor-exit p2
-
-    goto :goto_4
-
-    :catchall_0
-    move-exception p1
-
-    goto :goto_3
-
-    :catchall_1
-    move-exception p1
-
-    :goto_2
-    move-object p0, v0
-
-    goto :goto_3
-
-    :catchall_2
-    move-exception p0
-
-    move-object p1, p0
-
-    goto :goto_2
-
-    :goto_3
-    monitor-exit p2
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_0
-
-    :try_start_6
-    throw p1
-    :try_end_6
-    .catch Ljava/lang/Exception; {:try_start_6 .. :try_end_6} :catch_2
-
-    :catch_1
-    move-object p0, v0
-
-    :catch_2
-    :goto_4
-    if-nez p0, :cond_2
-
-    :try_start_7
-    sget-object p0, Lcom/samsung/android/knox/dar/ddar/fsm/State;->IDLE:Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    :cond_2
-    if-eqz p0, :cond_3
-
-    move v5, v6
-
-    :cond_3
-    const-string p1, "KEY_STATE"
-
-    invoke-virtual {p0}, Lcom/samsung/android/knox/dar/ddar/fsm/State;->name()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {v1, p1, p0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    const-string/jumbo p0, "dual_dar_response"
-
-    invoke-virtual {v1, p0, v5}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    :goto_5
-    return-object v1
-
-    :cond_4
-    const-string p1, "KEY_DUAL_DAR_USER_ID"
-
-    invoke-virtual {p3, p1}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->stateMachine:Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->getCurrentState(I)Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_5
-
-    move v5, v6
-
-    :cond_5
-    const-string p1, "KEY_STATE"
-
-    invoke-virtual {p0}, Lcom/samsung/android/knox/dar/ddar/fsm/State;->name()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {v1, p1, p0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    const-string/jumbo p0, "dual_dar_response"
-
-    invoke-virtual {v1, p0, v5}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    return-object v1
-
-    :cond_6
-    invoke-static {p1}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->enforceCallingUser(I)V
-
-    invoke-virtual {p0, p3}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->processEvent(Landroid/os/Bundle;)Z
-
-    move-result p0
-
-    const-string/jumbo p1, "dual_dar_response"
-
-    invoke-virtual {v1, p1, p0}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    return-object v1
-
-    :cond_7
-    invoke-static {p1}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->enforceCallingUser(I)V
-
-    const-string/jumbo p1, "dual_dar_response"
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->setInitialState()Z
-
-    move-result p0
-
-    invoke-virtual {v1, p1, p0}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-    :try_end_7
-    .catch Ljava/lang/Exception; {:try_start_7 .. :try_end_7} :catch_0
-
-    return-object v1
-
-    :goto_6
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    return-object v0
-
-    :sswitch_data_0
-    .sparse-switch
-        0x33660c2 -> :sswitch_3
-        0x3c5c9e59 -> :sswitch_2
-        0x52ce508a -> :sswitch_1
-        0x66d24d52 -> :sswitch_0
-    .end sparse-switch
-.end method
-
-.method public final processEvent(Landroid/os/Bundle;)Z
-    .locals 8
-
-    const-string v0, "KEY_EVENT"
-
-    invoke-virtual {p1, v0}, Landroid/os/Bundle;->containsKey(Ljava/lang/String;)Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_4
-
-    const-string v0, "KEY_DUAL_DAR_USER_ID"
-
-    invoke-virtual {p1, v0}, Landroid/os/Bundle;->containsKey(Ljava/lang/String;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    const-string v0, "KEY_EVENT"
-
-    invoke-virtual {p1, v0}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->valueOf(Ljava/lang/String;)Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    move-result-object v0
-
-    const-string v2, "KEY_DUAL_DAR_USER_ID"
-
-    invoke-virtual {p1, v2}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->stateMachine:Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;
-
-    const-string v2, "Invalid event "
-
-    const-string/jumbo v3, "Transition: ("
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->stateLock:Ljava/lang/Object;
-
-    monitor-enter v4
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->getCurrentState(I)Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    move-result-object v5
-
-    sget-object v6, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->validTransitions:Ljava/util/Map;
-
-    check-cast v6, Ljava/util/HashMap;
-
-    invoke-virtual {v6, v5}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v6
-
-    check-cast v6, Ljava/util/Map;
-
-    if-eqz v0, :cond_0
-
-    invoke-interface {v6, v0}, Ljava/util/Map;->containsKey(Ljava/lang/Object;)Z
-
-    move-result v7
-
-    if-eqz v7, :cond_0
-
-    invoke-interface {v6, v0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    iget-object v6, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->previousStateMap:Ljava/util/Map;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v7
-
-    check-cast v6, Ljava/util/HashMap;
-
-    invoke-virtual {v6, v7, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    iget-object v6, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->currentStateMap:Ljava/util/Map;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v7
-
-    check-cast v6, Ljava/util/HashMap;
-
-    invoke-virtual {v6, v7, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    const-string v6, "DualDAR::StateMachine"
-
-    new-instance v7, Ljava/lang/StringBuilder;
-
-    invoke-direct {v7, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    const-string v3, ") --> ("
-
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    const-string v3, ") because ("
-
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    const-string v3, ") for user "
-
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    new-array v7, v1, [Ljava/lang/Object;
-
-    invoke-static {v6, v3, v7}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const/4 v3, 0x1
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_3
-
-    :cond_0
-    const-string v3, "DualDAR::StateMachine"
-
-    new-instance v6, Ljava/lang/StringBuilder;
-
-    invoke-direct {v6, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    const-string v2, " in state: "
-
-    invoke-virtual {v6, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    const-string v2, " for user "
-
-    invoke-virtual {v6, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    new-array v6, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, v2, v6}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const/4 v2, 0x0
-
-    move v3, v1
-
-    :goto_0
-    sget-object v6, Lcom/samsung/android/knox/dar/ddar/fsm/State;->IDLE:Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    if-ne v2, v6, :cond_1
-
-    iget-object v6, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->currentStateMap:Ljava/util/Map;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v7
-
-    check-cast v6, Ljava/util/HashMap;
-
-    invoke-virtual {v6, v7}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
-
-    iget-object v6, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->previousStateMap:Ljava/util/Map;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v7
-
-    check-cast v6, Ljava/util/HashMap;
-
-    invoke-virtual {v6, v7}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
-
-    :cond_1
-    monitor-exit v4
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-eqz v3, :cond_3
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->listenerLock:Ljava/lang/Object;
-
-    monitor-enter v4
-
-    :try_start_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->stateChangeListeners:Ljava/util/List;
-
-    check-cast p0, Ljava/util/ArrayList;
-
-    invoke-virtual {p0}, Ljava/util/ArrayList;->size()I
-
-    move-result v6
-
-    :goto_1
-    if-ge v1, v6, :cond_2
-
-    invoke-virtual {p0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v7
-
-    add-int/lit8 v1, v1, 0x1
-
-    check-cast v7, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl$StateChangeListener;
-
-    check-cast v7, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-    iget-object v7, v7, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->context:Landroid/content/Context;
-
-    invoke-static {v7}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v7
-
-    invoke-virtual {v7, v5, v2, v0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onDualDarStateChanged(Lcom/samsung/android/knox/dar/ddar/fsm/State;Lcom/samsung/android/knox/dar/ddar/fsm/State;Lcom/samsung/android/knox/dar/ddar/fsm/Event;I)Z
-
-    goto :goto_1
-
-    :catchall_1
-    move-exception p0
-
-    goto :goto_2
-
-    :cond_2
-    monitor-exit v4
-
-    return v3
-
-    :goto_2
-    monitor-exit v4
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    throw p0
-
-    :cond_3
-    return v3
-
-    :goto_3
-    :try_start_2
-    monitor-exit v4
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :cond_4
-    return v1
-.end method
-
-.method public final setInitialState()Z
-    .locals 8
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARUser()I
-
-    move-result v0
-
-    const-string/jumbo v1, "StateMachineProxy"
-
-    const-string/jumbo v2, "Set initial state for DualDAR User "
-
-    invoke-static {v0, v2}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v2
-
-    const/4 v3, 0x0
-
-    new-array v4, v3, [Ljava/lang/Object;
-
-    invoke-static {v1, v2, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-boolean v1, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->initiateState:Z
-
-    const/4 v2, 0x1
-
-    if-eqz v1, :cond_0
-
-    const-string/jumbo p0, "StateMachineProxy"
-
-    const-string v0, "DualDAR User has been already initiated"
-
-    new-array v1, v3, [Ljava/lang/Object;
-
-    invoke-static {p0, v0, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v2
-
-    :cond_0
-    const/4 v1, -0x1
-
-    if-eq v0, v1, :cond_1
-
-    const-string/jumbo v1, "StateMachineProxy"
-
-    const-string v4, "DualDAR User set initial State."
-
-    new-array v5, v3, [Ljava/lang/Object;
-
-    invoke-static {v1, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->stateMachine:Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;
-
-    sget-object v4, Lcom/samsung/android/knox/dar/ddar/fsm/State;->DEVICE_LOCK_DATA_LOCK:Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string v5, "DualDAR::StateMachine"
-
-    new-instance v6, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v7, "setInitialState() initialState: "
-
-    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    const-string v7, " for user "
-
-    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v6
-
-    new-array v3, v3, [Ljava/lang/Object;
-
-    invoke-static {v5, v6, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v5, v1, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->stateLock:Ljava/lang/Object;
-
-    monitor-enter v5
-
-    :try_start_0
-    iget-object v3, v1, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->currentStateMap:Ljava/util/Map;
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v6
-
-    check-cast v3, Ljava/util/HashMap;
-
-    invoke-virtual {v3, v6, v4}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    iget-object v1, v1, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->previousStateMap:Ljava/util/Map;
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    check-cast v1, Ljava/util/HashMap;
-
-    const/4 v3, 0x0
-
-    invoke-virtual {v1, v0, v3}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    monitor-exit v5
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    iput-boolean v2, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->initiateState:Z
-
-    return v2
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v5
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_1
-    const-string/jumbo p0, "StateMachineProxy"
-
-    const-string/jumbo v1, "Not Active user for DualDAR : "
-
-    invoke-static {v0, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v1, v3, [Ljava/lang/Object;
-
-    invoke-static {p0, v0, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v3
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$1.smali b/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$1.smali
deleted file mode 100644
index 035a8f0f7..000000000
--- a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$1.smali
+++ /dev/null
@@ -1,68 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$1;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/lang/Runnable;
-
-
-# instance fields
-.field public final synthetic this$0:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$1;->this$0:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final run()V
-    .locals 4
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$1;->this$0:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    const-string v1, "DualDARDaemonProxy"
-
-    const-string/jumbo v2, "coudn\'t connect with daemon!"
-
-    const/4 v3, 0x0
-
-    new-array v3, v3, [Ljava/lang/Object;
-
-    invoke-static {v1, v2, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$1;->this$0:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-    const/4 v1, 0x1
-
-    iput-boolean v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->isDaemonConnectionFailed:Z
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mLock:Ljava/lang/Object;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->notify()V
-
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver.smali b/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver.smali
deleted file mode 100644
index 50a9f8c91..000000000
--- a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver.smali
+++ /dev/null
@@ -1,43 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver;
-.super Landroid/content/pm/IPackageDataObserver$Stub;
-.source "SourceFile"
-
-
-# instance fields
-.field public finished:Z
-
-.field public packageName:Ljava/lang/String;
-
-.field public success:Z
-
-
-# virtual methods
-.method public final onRemoveCompleted(Ljava/lang/String;Z)V
-    .locals 1
-
-    monitor-enter p0
-
-    const/4 v0, 0x1
-
-    :try_start_0
-    iput-boolean v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver;->finished:Z
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver;->packageName:Ljava/lang/String;
-
-    iput-boolean p2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver;->success:Z
-
-    invoke-virtual {p0}, Ljava/lang/Object;->notifyAll()V
-
-    monitor-exit p0
-
-    return-void
-
-    :catchall_0
-    move-exception p1
-
-    monitor-exit p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p1
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy.smali b/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy.smali
deleted file mode 100644
index b7393b4c7..000000000
--- a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy.smali
+++ /dev/null
@@ -1,3079 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-.super Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;
-.source "SourceFile"
-
-
-# static fields
-.field public static mContext:Landroid/content/Context;
-
-.field public static mInstance:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-
-# instance fields
-.field public isDaemonConnectionFailed:Z
-
-.field public mAm:Landroid/app/ActivityManager;
-
-.field public final mBlockedClearablePackages:Ljava/util/List;
-
-.field public mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-.field public mConnectorThread:Ljava/lang/Thread;
-
-.field public final mDualDARDOPolicyPackages:Ljava/util/List;
-
-.field public mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-.field public mHandler:Landroid/os/Handler;
-
-.field public final mLock:Ljava/lang/Object;
-
-
-# direct methods
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 3
-
-    invoke-direct {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;-><init>()V
-
-    const/4 v0, 0x0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnectorThread:Ljava/lang/Thread;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mAm:Landroid/app/ActivityManager;
-
-    new-instance v1, Ljava/lang/Object;
-
-    invoke-direct {v1}, Ljava/lang/Object;-><init>()V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mLock:Ljava/lang/Object;
-
-    const/4 v1, 0x0
-
-    iput-boolean v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->isDaemonConnectionFailed:Z
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mHandler:Landroid/os/Handler;
-
-    new-instance v0, Ljava/util/ArrayList;
-
-    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mBlockedClearablePackages:Ljava/util/List;
-
-    new-instance v0, Ljava/util/ArrayList;
-
-    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mDualDARDOPolicyPackages:Ljava/util/List;
-
-    new-array v0, v1, [Ljava/lang/Object;
-
-    const-string v1, "DualDARDaemonProxy"
-
-    const-string v2, "DualDARDaemonProxy() called"
-
-    invoke-static {v1, v2, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    sput-object p1, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mContext:Landroid/content/Context;
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->isDualDAREnabled()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->startConnectorThread()V
-
-    :cond_0
-    return-void
-.end method
-
-.method public static fetchDumpStateInfo(Lcom/samsung/android/knox/ddar/FileInfo;)V
-    .locals 7
-
-    const/4 v0, 0x0
-
-    new-array v1, v0, [Ljava/lang/Object;
-
-    const-string/jumbo v2, "fetchDumpStateInfo()"
-
-    const-string v3, "DualDARDaemonProxy"
-
-    invoke-static {v3, v2, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object p0, p0, Lcom/samsung/android/knox/ddar/FileInfo;->fd:Landroid/os/ParcelFileDescriptor;
-
-    const-string v1, "/data/log/ddar_log.txt"
-
-    const/4 v2, 0x0
-
-    :try_start_0
-    new-instance v4, Ljava/io/FileOutputStream;
-
-    invoke-virtual {p0}, Landroid/os/ParcelFileDescriptor;->getFileDescriptor()Ljava/io/FileDescriptor;
-
-    move-result-object v5
-
-    invoke-direct {v4, v5}, Ljava/io/FileOutputStream;-><init>(Ljava/io/FileDescriptor;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_5
-    .catchall {:try_start_0 .. :try_end_0} :catchall_3
-
-    :try_start_1
-    invoke-virtual {p0}, Landroid/os/ParcelFileDescriptor;->getFileDescriptor()Ljava/io/FileDescriptor;
-
-    move-result-object p0
-
-    new-instance v5, Ljava/io/FileOutputStream;
-
-    invoke-direct {v5, p0}, Ljava/io/FileOutputStream;-><init>(Ljava/io/FileDescriptor;)V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_4
-    .catchall {:try_start_1 .. :try_end_1} :catchall_2
-
-    :try_start_2
-    new-instance p0, Ljava/io/File;
-
-    invoke-direct {p0, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V
-
-    new-instance v1, Ljava/io/FileInputStream;
-
-    invoke-direct {v1, p0}, Ljava/io/FileInputStream;-><init>(Ljava/io/File;)V
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_3
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    :try_start_3
-    invoke-virtual {v1}, Ljava/io/FileInputStream;->available()I
-
-    move-result p0
-
-    :goto_0
-    if-eqz p0, :cond_1
-
-    const/16 v2, 0x400
-
-    new-array v4, v2, [B
-
-    if-le p0, v2, :cond_0
-
-    add-int/lit16 p0, p0, -0x400
-
-    move v6, v2
-
-    move v2, p0
-
-    move p0, v6
-
-    goto :goto_1
-
-    :cond_0
-    move v2, v0
-
-    :goto_1
-    invoke-virtual {v1, v4, v0, p0}, Ljava/io/FileInputStream;->read([BII)I
-
-    move-result p0
-
-    invoke-virtual {v5, v4, v0, p0}, Ljava/io/FileOutputStream;->write([BII)V
-    :try_end_3
-    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_0
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    move p0, v2
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    :goto_2
-    move-object v2, v5
-
-    goto/16 :goto_8
-
-    :catch_0
-    move-exception p0
-
-    :goto_3
-    move-object v2, v5
-
-    goto :goto_5
-
-    :cond_1
-    :try_start_4
-    invoke-virtual {v5}, Ljava/io/FileOutputStream;->close()V
-    :try_end_4
-    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_1
-
-    goto :goto_4
-
-    :catch_1
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array v2, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :goto_4
-    :try_start_5
-    invoke-virtual {v1}, Ljava/io/FileInputStream;->close()V
-    :try_end_5
-    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_2
-
-    goto :goto_7
-
-    :catch_2
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array v1, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto :goto_7
-
-    :catchall_1
-    move-exception p0
-
-    move-object v1, v2
-
-    goto :goto_2
-
-    :catch_3
-    move-exception p0
-
-    move-object v1, v2
-
-    goto :goto_3
-
-    :catchall_2
-    move-exception p0
-
-    move-object v1, v2
-
-    move-object v2, v4
-
-    goto :goto_8
-
-    :catch_4
-    move-exception p0
-
-    move-object v1, v2
-
-    move-object v2, v4
-
-    goto :goto_5
-
-    :catchall_3
-    move-exception p0
-
-    move-object v1, v2
-
-    goto :goto_8
-
-    :catch_5
-    move-exception p0
-
-    move-object v1, v2
-
-    :goto_5
-    :try_start_6
-    const-string/jumbo v4, "fail to open inputstream from FileDescriptor"
-
-    new-array v5, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array v4, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_4
-
-    if-eqz v2, :cond_2
-
-    :try_start_7
-    invoke-virtual {v2}, Ljava/io/FileOutputStream;->close()V
-    :try_end_7
-    .catch Ljava/lang/Exception; {:try_start_7 .. :try_end_7} :catch_6
-
-    goto :goto_6
-
-    :catch_6
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array v2, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_2
-    :goto_6
-    if-eqz v1, :cond_3
-
-    :try_start_8
-    invoke-virtual {v1}, Ljava/io/FileInputStream;->close()V
-    :try_end_8
-    .catch Ljava/lang/Exception; {:try_start_8 .. :try_end_8} :catch_7
-
-    goto :goto_7
-
-    :catch_7
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array v1, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_3
-    :goto_7
-    const-string/jumbo p0, "fetchDumpStateInfo() successfullly read the log file"
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return-void
-
-    :catchall_4
-    move-exception p0
-
-    :goto_8
-    if-eqz v2, :cond_4
-
-    :try_start_9
-    invoke-virtual {v2}, Ljava/io/FileOutputStream;->close()V
-    :try_end_9
-    .catch Ljava/lang/Exception; {:try_start_9 .. :try_end_9} :catch_8
-
-    goto :goto_9
-
-    :catch_8
-    move-exception v2
-
-    invoke-virtual {v2}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object v2
-
-    new-array v4, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, v2, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_4
-    :goto_9
-    if-eqz v1, :cond_5
-
-    :try_start_a
-    invoke-virtual {v1}, Ljava/io/FileInputStream;->close()V
-    :try_end_a
-    .catch Ljava/lang/Exception; {:try_start_a .. :try_end_a} :catch_9
-
-    goto :goto_a
-
-    :catch_9
-    move-exception v1
-
-    invoke-virtual {v1}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object v1
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, v1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_5
-    :goto_a
-    throw p0
-.end method
-
-.method public static declared-synchronized getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-    .locals 2
-
-    const-class v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mInstance:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-    if-nez v1, :cond_0
-
-    new-instance v1, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-    invoke-direct {v1, p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;-><init>(Landroid/content/Context;)V
-
-    sput-object v1, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mInstance:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    :goto_0
-    sget-object p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mInstance:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v0
-
-    return-object p0
-
-    :goto_1
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-.method public static setDualDARPOPolicy(II)Z
-    .locals 4
-
-    sget-object v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
-
-    move-result-object v0
-
-    iget-object v1, v0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mInjector:Lcom/android/server/knox/dar/EnterprisePartitionManager$Injector;
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v1
-
-    :try_start_0
-    iget-object v0, v0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mContext:Landroid/content/Context;
-
-    const-class v3, Landroid/os/storage/StorageManager;
-
-    invoke-virtual {v0, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/os/storage/StorageManager;
-
-    const/4 v3, 0x0
-
-    if-eqz v0, :cond_0
-
-    invoke-virtual {v0, p0, p1}, Landroid/os/storage/StorageManager;->setDualDARPolicy(II)Z
-
-    move-result p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    :try_start_1
-    const-string p0, "EnterprisePartitionManager"
-
-    const-string/jumbo p1, "StorageManager instance is NULL"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    move p0, v3
-
-    :goto_0
-    if-nez p0, :cond_1
-
-    new-array p0, v3, [Ljava/lang/Object;
-
-    const-string p1, "DualDARDaemonProxy"
-
-    const-string/jumbo v0, "setDualDARPolicy failed!"
-
-    invoke-static {p1, v0, p0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v3
-
-    :cond_1
-    const/4 p0, 0x1
-
-    return p0
-
-    :goto_1
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
-.method public static setEviction(IZ)Z
-    .locals 3
-
-    sget-object v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string v0, "EnterprisePartitionManager"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "setEviction(user:"
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v2, " evict:"
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string v2, ")"
-
-    invoke-static {v1, v2, v0}, Lcom/android/server/DirEncryptServiceHelper$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
-
-    sget-object v0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mInstallLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    const/4 v1, 0x0
-
-    :try_start_0
-    sget-object v2, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mPackageTasker:Lcom/android/server/pm/Installer;
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-    :try_end_0
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_0 .. :try_end_0} :catch_1
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :try_start_1
-    iget-object v2, v2, Lcom/android/server/pm/Installer;->mInstalld:Landroid/os/IInstalld;
-
-    invoke-interface {v2, p0, p1}, Landroid/os/IInstalld;->setEviction(IZ)Z
-
-    move-result p0
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :catch_0
-    move-exception p0
-
-    :try_start_3
-    invoke-static {p0}, Lcom/android/server/pm/Installer$InstallerException;->from(Ljava/lang/Exception;)V
-
-    const/4 p0, 0x0
-
-    throw p0
-    :try_end_3
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_3 .. :try_end_3} :catch_1
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :catch_1
-    :try_start_4
-    monitor-exit v0
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    move p0, v1
-
-    :goto_0
-    if-nez p0, :cond_0
-
-    const-string p0, "DualDARDaemonProxy"
-
-    const-string/jumbo p1, "setEviction failed!"
-
-    new-array v0, v1, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v1
-
-    :cond_0
-    const/4 p0, 0x1
-
-    return p0
-
-    :goto_1
-    :try_start_5
-    monitor-exit v0
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_0
-
-    throw p0
-.end method
-
-.method public static setSystemPropertyBoolean(Z)V
-    .locals 3
-
-    const-string/jumbo v0, "persist.sys.knox.dualdard"
-
-    invoke-static {v0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    const/4 p0, 0x0
-
-    new-array p0, p0, [Ljava/lang/Object;
-
-    const-string v0, "DualDARDaemonProxy"
-
-    const-string v1, "Invalid property"
-
-    invoke-static {v0, v1, p0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return-void
-
-    :cond_0
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v1
-
-    :try_start_0
-    invoke-static {p0}, Ljava/lang/Boolean;->toString(Z)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v0, p0}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    :try_start_1
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :goto_0
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
-
-# virtual methods
-.method public final clearApplicationUserDataForPackages(ILjava/util/List;)Z
-    .locals 9
-
-    const-string v0, "DualDARDaemonProxy"
-
-    const/4 v1, 0x0
-
-    if-nez p1, :cond_4
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_0
-
-    goto/16 :goto_3
-
-    :cond_0
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mDualDARDOPolicyPackages:Ljava/util/List;
-
-    check-cast p1, Ljava/util/ArrayList;
-
-    invoke-virtual {p1}, Ljava/util/ArrayList;->isEmpty()Z
-
-    move-result p1
-
-    const/4 v2, 0x1
-
-    if-eqz p1, :cond_1
-
-    const-string/jumbo p0, "clearApplicationUserDataForPackages - there is no package to clear"
-
-    new-array p1, v1, [Ljava/lang/Object;
-
-    invoke-static {v0, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v2
-
-    :cond_1
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v3
-
-    :try_start_0
-    check-cast p2, Ljava/util/ArrayList;
-
-    invoke-virtual {p2}, Ljava/util/ArrayList;->size()I
-
-    move-result p1
-
-    move v5, v1
-
-    :goto_0
-    if-ge v5, p1, :cond_3
-
-    invoke-virtual {p2, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v6
-
-    add-int/lit8 v5, v5, 0x1
-
-    check-cast v6, Ljava/lang/String;
-
-    invoke-virtual {p0, v6}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->clearUserData(Ljava/lang/String;)Z
-
-    move-result v7
-
-    if-nez v7, :cond_2
-
-    new-instance v7, Ljava/lang/StringBuilder;
-
-    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v8, "clearApplicationUserData failed! : "
-
-    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v6
-
-    new-array v7, v1, [Ljava/lang/Object;
-
-    invoke-static {v0, v6, v7}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_2
-
-    :catch_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_2
-    new-instance v7, Ljava/lang/StringBuilder;
-
-    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v8, "clearApplicationUserData success! : "
-
-    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v6
-
-    new-array v7, v1, [Ljava/lang/Object;
-
-    invoke-static {v0, v6, v7}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_0
-
-    :cond_3
-    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    const-string/jumbo p0, "clear app user data for initialize DualDAR at DO. success"
-
-    new-array p1, v1, [Ljava/lang/Object;
-
-    invoke-static {v0, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v2
-
-    :goto_1
-    :try_start_1
-    const-string/jumbo p1, "clearApplicationUserDataForPackages exception"
-
-    new-array p2, v1, [Ljava/lang/Object;
-
-    invoke-static {v0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return v1
-
-    :goto_2
-    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-
-    :cond_4
-    :goto_3
-    const-string/jumbo p0, "clearApplicationUserDataForPackages failed! : (reason) DualDAR at DO user"
-
-    new-array p1, v1, [Ljava/lang/Object;
-
-    invoke-static {v0, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v1
-.end method
-
-.method public final clearSecret(I)Z
-    .locals 5
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    const/4 v1, 0x0
-
-    if-nez v0, :cond_0
-
-    new-array p0, v1, [Ljava/lang/Object;
-
-    const-string p1, "DualDARDaemonProxy"
-
-    const-string/jumbo v0, "clearSecret failed! Error: native interface not yet connected failed"
-
-    invoke-static {p1, v0, p0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v1
-
-    :cond_0
-    :try_start_0
-    const-string/jumbo v2, "key"
-
-    const-string/jumbo v3, "evict"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    const-string/jumbo v4, "all"
-
-    filled-new-array {p1, v4}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    invoke-virtual {v0, v2, v3, p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->executeSync(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-virtual {p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->isClassOk()Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->isClassContinue()Z
-
-    move-result p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz p0, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    return v1
-
-    :catch_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_2
-    :goto_0
-    const/4 p0, 0x1
-
-    return p0
-
-    :goto_1
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    return v1
-.end method
-
-.method public final clearUserData(Ljava/lang/String;)Z
-    .locals 6
-
-    const-string v0, "Couldn\'t clear application user data for package: "
-
-    const-string v1, " try to clear application User Data"
-
-    const/4 v2, 0x0
-
-    if-eqz p1, :cond_4
-
-    new-instance v3, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver;
-
-    invoke-direct {v3}, Landroid/content/pm/IPackageDataObserver$Stub;-><init>()V
-
-    iput-boolean v2, v3, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver;->finished:Z
-
-    iput-boolean v2, v3, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver;->success:Z
-
-    :try_start_0
-    iget-object v4, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mAm:Landroid/app/ActivityManager;
-
-    if-nez v4, :cond_0
-
-    sget-object v4, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v5, "activity"
-
-    invoke-virtual {v4, v5}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v4
-
-    check-cast v4, Landroid/app/ActivityManager;
-
-    iput-object v4, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mAm:Landroid/app/ActivityManager;
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    goto :goto_4
-
-    :cond_0
-    :goto_0
-    const-string v4, "DualDARDaemonProxy"
-
-    invoke-virtual {p1, v1}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    new-array v5, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, v1, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mAm:Landroid/app/ActivityManager;
-
-    invoke-virtual {p0, p1, v3}, Landroid/app/ActivityManager;->clearApplicationUserData(Ljava/lang/String;Landroid/content/pm/IPackageDataObserver;)Z
-
-    move-result p0
-
-    if-nez p0, :cond_1
-
-    const-string p0, "DualDARDaemonProxy"
-
-    invoke-virtual {v0, p1}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array v0, v2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v2
-
-    :cond_1
-    monitor-enter v3
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    :goto_1
-    :try_start_1
-    iget-boolean p0, v3, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver;->finished:Z
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    if-nez p0, :cond_2
-
-    const-wide/16 v0, 0x64
-
-    :try_start_2
-    invoke-virtual {v3, v0, v1}, Ljava/lang/Object;->wait(J)V
-    :try_end_2
-    .catch Ljava/lang/InterruptedException; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_3
-
-    :catch_1
-    move-exception p0
-
-    :try_start_3
-    const-string v0, "DualDARDaemonProxy"
-
-    const-string v1, "InterruptedException occur"
-
-    new-array v4, v2, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0}, Ljava/lang/InterruptedException;->printStackTrace()V
-
-    goto :goto_1
-
-    :cond_2
-    iget-boolean p0, v3, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver;->success:Z
-
-    if-eqz p0, :cond_3
-
-    iget-object p0, v3, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$ClearUserDataObserver;->packageName:Ljava/lang/String;
-
-    invoke-virtual {p0, p1}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_3
-
-    const/4 p0, 0x1
-
-    goto :goto_2
-
-    :cond_3
-    move p0, v2
-
-    :goto_2
-    monitor-exit v3
-
-    return p0
-
-    :goto_3
-    monitor-exit v3
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :try_start_4
-    throw p0
-    :try_end_4
-    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_0
-
-    :goto_4
-    const-string p1, "DualDARDaemonProxy"
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array v0, v2, [Ljava/lang/Object;
-
-    invoke-static {p1, p0, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_4
-    return v2
-.end method
-
-.method public final getClientLibraryVersion(Ljava/lang/String;)Ljava/lang/String;
-    .locals 7
-
-    const-string/jumbo v0, "startClientLibrary failed! Error code: "
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    const-string v1, "DualDARDaemonProxy"
-
-    const/4 v2, 0x0
-
-    const-string v3, ""
-
-    if-nez p0, :cond_0
-
-    const-string/jumbo p0, "startClientLibrary failed! Error: native interface not yet connected failed"
-
-    new-array p1, v2, [Ljava/lang/Object;
-
-    invoke-static {v1, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return-object v3
-
-    :cond_0
-    :try_start_0
-    const-string/jumbo v4, "vendor_lib"
-
-    const-string/jumbo v5, "version"
-
-    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v6
-
-    filled-new-array {v6, p1}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    invoke-virtual {p0, v4, v5, p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->executeSync(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    move-result-object p0
-
-    const-string/jumbo p1, "getClientLibraryVersion() got response from executeSync"
-
-    new-array v4, v2, [Ljava/lang/Object;
-
-    invoke-static {v1, p1, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mResponseCode:I
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mMessage:Ljava/lang/String;
-
-    if-ltz p1, :cond_1
-
-    return-object v4
-
-    :cond_1
-    :try_start_1
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mCode:I
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string p0, " message: "
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v2, [Ljava/lang/Object;
-
-    invoke-static {v1, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-
-    return-object v3
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    return-object v3
-.end method
-
-.method public final loadClientLibrary(ILjava/lang/String;)Z
-    .locals 4
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    const/4 v1, 0x0
-
-    if-nez v0, :cond_0
-
-    new-array p0, v1, [Ljava/lang/Object;
-
-    const-string p1, "DualDARDaemonProxy"
-
-    const-string/jumbo p2, "loadClientLibrary failed! Error: native interface not yet connected failed"
-
-    invoke-static {p1, p2, p0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v1
-
-    :cond_0
-    :try_start_0
-    const-string/jumbo v2, "vendor_lib"
-
-    const-string/jumbo v3, "load"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    filled-new-array {p1, p2}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    invoke-virtual {v0, v2, v3, p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->executeSync(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-virtual {p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->isClassOk()Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->isClassContinue()Z
-
-    move-result p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz p0, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    return v1
-
-    :catch_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_2
-    :goto_0
-    const/4 p0, 0x1
-
-    return p0
-
-    :goto_1
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    return v1
-.end method
-
-.method public final onMessage(ILjava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
-    .locals 10
-
-    const-string/jumbo p1, "onMessage() "
-
-    const/4 v0, 0x0
-
-    new-array v1, v0, [Ljava/lang/Object;
-
-    const-string v2, "DualDARDaemonProxy"
-
-    const-string/jumbo v3, "enforceCallingUser"
-
-    invoke-static {v2, v3, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v1
-
-    invoke-static {v1}, Landroid/os/UserHandle;->getAppId(I)I
-
-    move-result v3
-
-    const/16 v4, 0x1482
-
-    if-ne v3, v4, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    invoke-static {v1}, Landroid/os/UserHandle;->getAppId(I)I
-
-    move-result v1
-
-    invoke-static {}, Landroid/os/Process;->myUid()I
-
-    move-result v3
-
-    if-ne v1, v3, :cond_6
-
-    :goto_0
-    const/4 v1, 0x0
-
-    :try_start_0
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v3, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array v3, v0, [Ljava/lang/Object;
-
-    invoke-static {v2, p1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-instance p1, Landroid/os/Bundle;
-
-    invoke-direct {p1}, Landroid/os/Bundle;-><init>()V
-
-    invoke-virtual {p2}, Ljava/lang/String;->hashCode()I
-
-    move-result v3
-
-    const/16 v4, 0x9
-
-    const/4 v5, 0x2
-
-    const/4 v6, 0x1
-
-    sparse-switch v3, :sswitch_data_0
-
-    goto/16 :goto_1
-
-    :sswitch_0
-    const-string/jumbo v3, "SET_DUALDAR_DO_POLICY"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    const/4 p2, 0x4
-
-    goto/16 :goto_2
-
-    :catch_0
-    move-exception p0
-
-    goto/16 :goto_5
-
-    :sswitch_1
-    const-string/jumbo v3, "UNLOAD_CLIENT_LIBRARY"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    const/4 p2, 0x7
-
-    goto/16 :goto_2
-
-    :sswitch_2
-    const-string v3, "CLEAR_SECRET"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    const/16 p2, 0xb
-
-    goto/16 :goto_2
-
-    :sswitch_3
-    const-string/jumbo v3, "SET_DUALDAR_POLICY"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    const/4 p2, 0x3
-
-    goto/16 :goto_2
-
-    :sswitch_4
-    const-string/jumbo v3, "PUSH_SECRET"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    const/16 p2, 0xa
-
-    goto :goto_2
-
-    :sswitch_5
-    const-string/jumbo v3, "SET_EVICTION"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    move p2, v5
-
-    goto :goto_2
-
-    :sswitch_6
-    const-string/jumbo v3, "START_DAEMON"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    move p2, v0
-
-    goto :goto_2
-
-    :sswitch_7
-    const-string v3, "GET_CLIENTLIB_VERSION"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    move p2, v4
-
-    goto :goto_2
-
-    :sswitch_8
-    const-string/jumbo v3, "START_CLIENT_LIBRARY"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    const/16 p2, 0x8
-
-    goto :goto_2
-
-    :sswitch_9
-    const-string v3, "FETCH_DUMPSTATE_REQUEST"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    const/16 p2, 0xc
-
-    goto :goto_2
-
-    :sswitch_a
-    const-string/jumbo v3, "STOP_DAEMON"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    move p2, v6
-
-    goto :goto_2
-
-    :sswitch_b
-    const-string v3, "LOAD_CLIENT_LIBRARY"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    const/4 p2, 0x6
-
-    goto :goto_2
-
-    :sswitch_c
-    const-string v3, "CLEAR_APP_DATA"
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz p2, :cond_1
-
-    const/4 p2, 0x5
-
-    goto :goto_2
-
-    :cond_1
-    :goto_1
-    const/4 p2, -0x1
-
-    :goto_2
-    const-string v3, "CRYPTO_PATH"
-
-    const-string/jumbo v7, "dual_dar_response_message"
-
-    const-string/jumbo v8, "user_id"
-
-    const-string/jumbo v9, "dual_dar_response"
-
-    packed-switch p2, :pswitch_data_0
-
-    goto/16 :goto_4
-
-    :pswitch_0
-    :try_start_1
-    const-string p0, "FSLOG_FILE_INFO"
-
-    invoke-virtual {p3, p0}, Landroid/os/Bundle;->getParcelable(Ljava/lang/String;)Landroid/os/Parcelable;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/samsung/android/knox/ddar/FileInfo;
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->fetchDumpStateInfo(Lcom/samsung/android/knox/ddar/FileInfo;)V
-
-    invoke-virtual {p1, v9, v6}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    return-object p1
-
-    :pswitch_1
-    invoke-virtual {p3, v8}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p2
-
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->clearSecret(I)Z
-
-    move-result p2
-
-    invoke-virtual {p1, v9, p2}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    if-nez p2, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    if-eqz p0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mMessage:Ljava/lang/String;
-
-    invoke-virtual {p1, v7, p0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-object p1
-
-    :pswitch_2
-    const-string p2, "INNER_LAYER_SECRET"
-
-    invoke-virtual {p3, p2}, Landroid/os/Bundle;->getParcelableArrayList(Ljava/lang/String;)Ljava/util/ArrayList;
-
-    move-result-object p2
-
-    invoke-virtual {p3, v8}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v0
-
-    const-string/jumbo v2, "ORIGINATING_SECURE_CLIENT_ID"
-
-    invoke-virtual {p3, v2}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p3
-
-    invoke-virtual {p0, v0, p3, p2}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->pushSecret(ILjava/lang/String;Ljava/util/List;)Z
-
-    move-result p2
-
-    invoke-virtual {p1, v9, p2}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    if-nez p2, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    if-eqz p0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mMessage:Ljava/lang/String;
-
-    invoke-virtual {p1, v7, p0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-object p1
-
-    :pswitch_3
-    invoke-virtual {p3, v3}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->getClientLibraryVersion(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {p1, v9, p0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-object p1
-
-    :pswitch_4
-    invoke-virtual {p3, v8}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p2
-
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->startClientLibrary(I)Z
-
-    move-result p2
-
-    invoke-virtual {p1, v9, p2}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    if-nez p2, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    if-eqz p0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mMessage:Ljava/lang/String;
-
-    invoke-virtual {p1, v7, p0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-object p1
-
-    :pswitch_5
-    invoke-virtual {p3, v8}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p2
-
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->unloadClientLibrary(I)Z
-
-    move-result p2
-
-    invoke-virtual {p1, v9, p2}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    if-nez p2, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    if-eqz p0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mMessage:Ljava/lang/String;
-
-    invoke-virtual {p1, v7, p0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-object p1
-
-    :pswitch_6
-    invoke-virtual {p3, v8}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p2
-
-    invoke-virtual {p3, v3}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p3
-
-    invoke-virtual {p0, p2, p3}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->loadClientLibrary(ILjava/lang/String;)Z
-
-    move-result p2
-
-    invoke-virtual {p1, v9, p2}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    if-nez p2, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    if-eqz p0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mMessage:Ljava/lang/String;
-
-    invoke-virtual {p1, v7, p0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-object p1
-
-    :pswitch_7
-    invoke-virtual {p3, v8}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p2
-
-    iget-object p3, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mDualDARDOPolicyPackages:Ljava/util/List;
-
-    invoke-virtual {p0, p2, p3}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->clearApplicationUserDataForPackages(ILjava/util/List;)Z
-
-    move-result p2
-
-    invoke-virtual {p1, v9, p2}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    if-nez p2, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    if-eqz p0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mMessage:Ljava/lang/String;
-
-    invoke-virtual {p1, v7, p0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-object p1
-
-    :pswitch_8
-    invoke-virtual {p0, p3, p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->setDualDARPolicyForManagedDevice(Landroid/os/Bundle;Landroid/os/Bundle;)V
-
-    return-object p1
-
-    :pswitch_9
-    invoke-virtual {p3, v8}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p2
-
-    const-string v2, "CRYPTO_TYPE"
-
-    invoke-virtual {p3, v2}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v2
-
-    const-string/jumbo v3, "STORAGE_TYPE"
-
-    invoke-virtual {p3, v3}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p3
-
-    if-ne p3, v6, :cond_2
-
-    invoke-static {p2, v4}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->setDualDARPOPolicy(II)Z
-
-    move-result v0
-
-    goto :goto_3
-
-    :cond_2
-    if-ne p3, v5, :cond_3
-
-    invoke-static {p2, v2}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->setDualDARPOPolicy(II)Z
-
-    move-result v0
-
-    :cond_3
-    :goto_3
-    invoke-virtual {p1, v9, v0}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    if-nez v0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    if-eqz p0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mMessage:Ljava/lang/String;
-
-    invoke-virtual {p1, v7, p0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-object p1
-
-    :pswitch_a
-    invoke-virtual {p3, v8}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p2
-
-    const-string v2, "EVICT"
-
-    invoke-virtual {p3, v2, v0}, Landroid/os/Bundle;->getBoolean(Ljava/lang/String;Z)Z
-
-    move-result p3
-
-    invoke-static {p2, p3}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->setEviction(IZ)Z
-
-    move-result p2
-
-    invoke-virtual {p1, v9, p2}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    if-nez p2, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    if-eqz p0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mMessage:Ljava/lang/String;
-
-    invoke-virtual {p1, v7, p0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_4
-    :goto_4
-    return-object p1
-
-    :pswitch_b
-    new-array p2, v0, [Ljava/lang/Object;
-
-    const-string/jumbo p3, "stopConnectorThread() "
-
-    invoke-static {v2, p3, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object p2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    if-eqz p2, :cond_5
-
-    iput-boolean v0, p2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mIsListening:Z
-
-    iget-object p2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnectorThread:Ljava/lang/Thread;
-
-    invoke-virtual {p2}, Ljava/lang/Thread;->interrupt()V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    :cond_5
-    invoke-static {v0}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->setSystemPropertyBoolean(Z)V
-
-    invoke-virtual {p1, v9, v6}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    return-object p1
-
-    :pswitch_c
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->startDualDARDaemon(Landroid/os/Bundle;)V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-
-    return-object p1
-
-    :goto_5
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    return-object v1
-
-    :cond_6
-    new-instance p0, Ljava/lang/SecurityException;
-
-    const-string p1, "Can only be called by system user"
-
-    invoke-direct {p0, p1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    nop
-
-    :sswitch_data_0
-    .sparse-switch
-        -0x7832af06 -> :sswitch_c
-        -0x74c33360 -> :sswitch_b
-        -0x41169e9f -> :sswitch_a
-        -0x39e32f38 -> :sswitch_9
-        -0x398c663c -> :sswitch_8
-        0x432f76a -> :sswitch_7
-        0xd454d21 -> :sswitch_6
-        0x132d527c -> :sswitch_5
-        0x205d4775 -> :sswitch_4
-        0x2b3c5855 -> :sswitch_3
-        0x2dada502 -> :sswitch_2
-        0x4d55a167 -> :sswitch_1
-        0x69e2b563 -> :sswitch_0
-    .end sparse-switch
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_c
-        :pswitch_b
-        :pswitch_a
-        :pswitch_9
-        :pswitch_8
-        :pswitch_7
-        :pswitch_6
-        :pswitch_5
-        :pswitch_4
-        :pswitch_3
-        :pswitch_2
-        :pswitch_1
-        :pswitch_0
-    .end packed-switch
-.end method
-
-.method public final pushSecret(ILjava/lang/String;Ljava/util/List;)Z
-    .locals 9
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    const-string v1, "DualDARDaemonProxy"
-
-    const/4 v2, 0x0
-
-    if-nez v0, :cond_0
-
-    const-string/jumbo p0, "pushSecret failed! Error: native interface not yet connected failed"
-
-    new-array p1, v2, [Ljava/lang/Object;
-
-    invoke-static {v1, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v2
-
-    :cond_0
-    invoke-interface {p3}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object p3
-
-    :cond_1
-    invoke-interface {p3}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    invoke-interface {p3}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/samsung/android/knox/ddar/Secret;
-
-    :try_start_0
-    iget-object v3, p0, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;->mSecureClientForInAPI:Lcom/samsung/android/knox/dar/ddar/securesession/SecureClient;
-
-    iget-object v4, v0, Lcom/samsung/android/knox/ddar/Secret;->data:[B
-
-    invoke-virtual {v3, p2, v4}, Lcom/samsung/android/knox/dar/ddar/securesession/SecureClient;->decryptMessageFrom(Ljava/lang/String;[B)[B
-
-    move-result-object v3
-
-    if-nez v3, :cond_2
-
-    const-string/jumbo p0, "pushSecret failed ! decData is null"
-
-    new-array p1, v2, [Ljava/lang/Object;
-
-    invoke-static {v1, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v2
-
-    :catch_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_2
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    array-length v5, v3
-
-    mul-int/lit8 v5, v5, 0x2
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(I)V
-
-    array-length v5, v3
-
-    move v6, v2
-
-    :goto_0
-    if-ge v6, v5, :cond_3
-
-    aget-byte v7, v3, v6
-
-    invoke-static {v7}, Ljava/lang/Byte;->valueOf(B)Ljava/lang/Byte;
-
-    move-result-object v7
-
-    filled-new-array {v7}, [Ljava/lang/Object;
-
-    move-result-object v7
-
-    const-string v8, "%02x"
-
-    invoke-static {v8, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    add-int/lit8 v6, v6, 0x1
-
-    goto :goto_0
-
-    :cond_3
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->length()I
-
-    move-result v6
-
-    invoke-virtual {v4, v2, v6}, Ljava/lang/StringBuilder;->delete(II)Ljava/lang/StringBuilder;
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    const-string/jumbo v6, "key"
-
-    const-string/jumbo v7, "install"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v8
-
-    iget-object v0, v0, Lcom/samsung/android/knox/ddar/Secret;->alias:Ljava/lang/String;
-
-    filled-new-array {v8, v0, v5}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    invoke-virtual {v4, v6, v7, v0}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->executeSync(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    move-result-object v0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-static {v3}, Lcom/samsung/android/knox/dar/ddar/securesession/Wiper;->wipe([B)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-virtual {v0}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->isClassOk()Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    const-string/jumbo p0, "pushSecret failed !"
-
-    new-array p1, v2, [Ljava/lang/Object;
-
-    invoke-static {v1, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    return v2
-
-    :goto_1
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    return v2
-
-    :cond_4
-    const/4 p0, 0x1
-
-    return p0
-.end method
-
-.method public final setDualDARPolicyForManagedDevice(Landroid/os/Bundle;Landroid/os/Bundle;)V
-    .locals 20
-
-    move-object/from16 v0, p0
-
-    move-object/from16 v1, p1
-
-    move-object/from16 v2, p2
-
-    const-string/jumbo v3, "user_id"
-
-    invoke-virtual {v1, v3}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v3
-
-    const-string v4, "CRYPTO_TYPE"
-
-    invoke-virtual {v1, v4}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v1
-
-    const-string/jumbo v4, "setDualDARDOPolicy for user "
-
-    const-string v5, " type "
-
-    invoke-static {v3, v1, v4, v5}, Lcom/android/internal/util/jobs/ArrayUtils$$ExternalSyntheticOutline0;->m(IILjava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v4
-
-    const/4 v5, 0x0
-
-    new-array v6, v5, [Ljava/lang/Object;
-
-    const-string v7, "DualDARDaemonProxy"
-
-    invoke-static {v7, v4, v6}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string v6, "/data/media/"
-
-    invoke-direct {v4, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    sget-object v6, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mContext:Landroid/content/Context;
-
-    invoke-static {v6}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
-
-    move-result-object v6
-
-    invoke-virtual {v6}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v3, v1, v4}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->setDualDARPolicyDirRecursively(IILjava/lang/String;)Z
-
-    move-result v6
-
-    const-string/jumbo v8, "setDualDARPolicyDirRecursively failed! : "
-
-    if-nez v6, :cond_0
-
-    invoke-static {v8, v4}, Landroid/net/ConnectivityModuleConnector$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    new-array v3, v5, [Ljava/lang/Object;
-
-    invoke-static {v7, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const-string v1, "Failed to set the policy to shared folders..."
-
-    new-array v3, v5, [Ljava/lang/Object;
-
-    invoke-static {v7, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto/16 :goto_a
-
-    :cond_0
-    sget-object v4, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mContext:Landroid/content/Context;
-
-    invoke-static {v4}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
-
-    move-result-object v4
-
-    const-string v6, "/data/user/"
-
-    invoke-static {v3, v6}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v9
-
-    new-instance v10, Ljava/lang/StringBuilder;
-
-    const-string v11, "/data/user_de/"
-
-    invoke-direct {v10, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v10, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v10
-
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v3, v1, v9}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->setDualDARPolicyDir(IILjava/lang/String;)Z
-
-    move-result v4
-
-    const-string/jumbo v12, "setDualDARPolicyDir user failed! : "
-
-    if-nez v4, :cond_1
-
-    invoke-static {v12, v9}, Landroid/net/ConnectivityModuleConnector$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    new-array v3, v5, [Ljava/lang/Object;
-
-    invoke-static {v7, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const-string v1, "Failed to set the policy to data package folder..."
-
-    new-array v3, v5, [Ljava/lang/Object;
-
-    invoke-static {v7, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto/16 :goto_a
-
-    :cond_1
-    const/16 v4, 0x9
-
-    invoke-static {v3, v4, v10}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->setDualDARPolicyDir(IILjava/lang/String;)Z
-
-    move-result v9
-
-    if-nez v9, :cond_2
-
-    invoke-static {v12, v10}, Landroid/net/ConnectivityModuleConnector$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v9
-
-    new-array v10, v5, [Ljava/lang/Object;
-
-    invoke-static {v7, v9, v10}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_2
-    const-string/jumbo v9, "dar"
-
-    invoke-static {v9}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v10
-
-    check-cast v10, Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v10, :cond_14
-
-    new-instance v12, Ljava/util/ArrayList;
-
-    invoke-direct {v12}, Ljava/util/ArrayList;-><init>()V
-
-    new-instance v13, Ljava/util/ArrayList;
-
-    invoke-direct {v13}, Ljava/util/ArrayList;-><init>()V
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v14
-
-    :try_start_0
-    const-string/jumbo v4, "pkg_clearable_system"
-
-    invoke-virtual {v10, v4}, Lcom/android/server/knox/dar/DarManagerService;->getPackageListForDualDarPolicy(Ljava/lang/String;)Ljava/util/List;
-
-    move-result-object v4
-
-    const-string/jumbo v5, "pkg_not_system"
-
-    invoke-virtual {v10, v5}, Lcom/android/server/knox/dar/DarManagerService;->getPackageListForDualDarPolicy(Ljava/lang/String;)Ljava/util/List;
-
-    move-result-object v5
-
-    move-object/from16 v17, v4
-
-    const-string/jumbo v4, "pkg_not_clearable_system"
-
-    invoke-virtual {v10, v4}, Lcom/android/server/knox/dar/DarManagerService;->getPackageListForDualDarPolicy(Ljava/lang/String;)Ljava/util/List;
-
-    move-result-object v4
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    invoke-static {v9}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v9
-
-    check-cast v9, Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v9, :cond_3
-
-    invoke-virtual {v9, v3}, Lcom/android/server/knox/dar/DarManagerService;->getBlockedClearablePackages(I)Ljava/util/List;
-
-    move-result-object v9
-
-    goto :goto_0
-
-    :cond_3
-    const/4 v9, 0x0
-
-    :goto_0
-    if-eqz v9, :cond_4
-
-    iget-object v10, v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mBlockedClearablePackages:Ljava/util/List;
-
-    check-cast v10, Ljava/util/ArrayList;
-
-    invoke-virtual {v10}, Ljava/util/ArrayList;->clear()V
-
-    iget-object v10, v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mBlockedClearablePackages:Ljava/util/List;
-
-    check-cast v10, Ljava/util/ArrayList;
-
-    invoke-virtual {v10, v9}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z
-
-    :cond_4
-    iget-object v9, v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mBlockedClearablePackages:Ljava/util/List;
-
-    if-eqz v9, :cond_5
-
-    check-cast v9, Ljava/util/ArrayList;
-
-    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I
-
-    move-result v10
-
-    const/4 v14, 0x0
-
-    :goto_1
-    if-ge v14, v10, :cond_5
-
-    invoke-virtual {v9, v14}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v15
-
-    add-int/lit8 v14, v14, 0x1
-
-    check-cast v15, Ljava/lang/String;
-
-    move-object/from16 v18, v4
-
-    const-string/jumbo v4, "refreshNonClearablePackagesList = "
-
-    invoke-static {v4, v15}, Landroid/net/ConnectivityModuleConnector$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v4
-
-    move-object/from16 v19, v5
-
-    const/4 v15, 0x0
-
-    new-array v5, v15, [Ljava/lang/Object;
-
-    invoke-static {v7, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    move-object/from16 v4, v18
-
-    move-object/from16 v5, v19
-
-    goto :goto_1
-
-    :cond_5
-    move-object/from16 v18, v4
-
-    move-object/from16 v19, v5
-
-    if-eqz v17, :cond_6
-
-    invoke-interface/range {v17 .. v17}, Ljava/util/List;->isEmpty()Z
-
-    move-result v4
-
-    if-eqz v4, :cond_7
-
-    :cond_6
-    const/4 v15, 0x0
-
-    goto :goto_3
-
-    :cond_7
-    invoke-interface/range {v17 .. v17}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v4
-
-    :goto_2
-    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v5
-
-    if-eqz v5, :cond_9
-
-    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v5
-
-    check-cast v5, Ljava/lang/String;
-
-    iget-object v9, v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mBlockedClearablePackages:Ljava/util/List;
-
-    check-cast v9, Ljava/util/ArrayList;
-
-    invoke-virtual {v9}, Ljava/util/ArrayList;->isEmpty()Z
-
-    move-result v9
-
-    if-nez v9, :cond_8
-
-    iget-object v9, v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mBlockedClearablePackages:Ljava/util/List;
-
-    check-cast v9, Ljava/util/ArrayList;
-
-    invoke-virtual {v9, v5}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z
-
-    move-result v9
-
-    if-eqz v9, :cond_8
-
-    const-string v9, "1. Skip ddar policy for the pkg "
-
-    invoke-static {v9, v5}, Landroid/net/ConnectivityModuleConnector$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v9
-
-    const/4 v15, 0x0
-
-    new-array v10, v15, [Ljava/lang/Object;
-
-    invoke-static {v7, v9, v10}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {v12, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_2
-
-    :cond_8
-    const/4 v15, 0x0
-
-    invoke-virtual {v13, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_2
-
-    :goto_3
-    const-string v4, "Clearable system package list is Empty."
-
-    new-array v5, v15, [Ljava/lang/Object;
-
-    invoke-static {v7, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_9
-    if-eqz v19, :cond_a
-
-    invoke-interface/range {v19 .. v19}, Ljava/util/List;->isEmpty()Z
-
-    move-result v4
-
-    if-eqz v4, :cond_b
-
-    :cond_a
-    const/4 v15, 0x0
-
-    goto :goto_5
-
-    :cond_b
-    invoke-interface/range {v19 .. v19}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v4
-
-    :goto_4
-    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v5
-
-    if-eqz v5, :cond_d
-
-    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v5
-
-    check-cast v5, Ljava/lang/String;
-
-    iget-object v9, v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mBlockedClearablePackages:Ljava/util/List;
-
-    check-cast v9, Ljava/util/ArrayList;
-
-    invoke-virtual {v9}, Ljava/util/ArrayList;->isEmpty()Z
-
-    move-result v9
-
-    if-nez v9, :cond_c
-
-    iget-object v9, v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mBlockedClearablePackages:Ljava/util/List;
-
-    check-cast v9, Ljava/util/ArrayList;
-
-    invoke-virtual {v9, v5}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z
-
-    move-result v9
-
-    if-eqz v9, :cond_c
-
-    const-string v9, "2. Skip ddar policy for the pkg "
-
-    invoke-static {v9, v5}, Landroid/net/ConnectivityModuleConnector$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v9
-
-    const/4 v15, 0x0
-
-    new-array v10, v15, [Ljava/lang/Object;
-
-    invoke-static {v7, v9, v10}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {v12, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_4
-
-    :cond_c
-    const/4 v15, 0x0
-
-    invoke-virtual {v13, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_4
-
-    :goto_5
-    const-string/jumbo v4, "Not system package list is Empty."
-
-    new-array v5, v15, [Ljava/lang/Object;
-
-    invoke-static {v7, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_d
-    if-eqz v18, :cond_e
-
-    invoke-interface/range {v18 .. v18}, Ljava/util/List;->isEmpty()Z
-
-    move-result v4
-
-    if-eqz v4, :cond_f
-
-    :cond_e
-    const/4 v15, 0x0
-
-    goto :goto_7
-
-    :cond_f
-    invoke-interface/range {v18 .. v18}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v4
-
-    :goto_6
-    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v5
-
-    if-eqz v5, :cond_10
-
-    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v5
-
-    check-cast v5, Ljava/lang/String;
-
-    const-string v9, "3. Skip ddar policy for the pkg "
-
-    invoke-static {v9, v5}, Landroid/net/ConnectivityModuleConnector$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v9
-
-    const/4 v15, 0x0
-
-    new-array v10, v15, [Ljava/lang/Object;
-
-    invoke-static {v7, v9, v10}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {v12, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_6
-
-    :goto_7
-    const-string/jumbo v4, "Not clearable system package list is Empty."
-
-    new-array v5, v15, [Ljava/lang/Object;
-
-    invoke-static {v7, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_10
-    sget-object v4, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mContext:Landroid/content/Context;
-
-    invoke-static {v4}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
-
-    move-result-object v4
-
-    invoke-virtual {v13}, Ljava/util/ArrayList;->size()I
-
-    move-result v5
-
-    const/4 v9, 0x0
-
-    :goto_8
-    if-ge v9, v5, :cond_13
-
-    invoke-virtual {v13, v9}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v10
-
-    add-int/lit8 v9, v9, 0x1
-
-    check-cast v10, Ljava/lang/String;
-
-    const-string v14, "/"
-
-    invoke-static {v3, v6, v14, v10}, Lcom/android/server/accessibility/AccessibilityManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v15
-
-    move-object/from16 v17, v4
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    invoke-direct {v4, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual/range {v17 .. v17}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v3, v1, v15}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->setDualDARPolicyDirRecursively(IILjava/lang/String;)Z
-
-    move-result v14
-
-    if-nez v14, :cond_11
-
-    invoke-static {v8, v15}, Landroid/net/ConnectivityModuleConnector$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    const/4 v15, 0x0
-
-    new-array v3, v15, [Ljava/lang/Object;
-
-    invoke-static {v7, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const-string/jumbo v1, "setDualDARPolicyForPackages failed!"
-
-    new-array v3, v15, [Ljava/lang/Object;
-
-    invoke-static {v7, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    move v5, v15
-
-    goto :goto_a
-
-    :cond_11
-    const/16 v14, 0x9
-
-    const/4 v15, 0x0
-
-    invoke-static {v3, v14, v4}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->setDualDARPolicyDirRecursively(IILjava/lang/String;)Z
-
-    move-result v16
-
-    if-nez v16, :cond_12
-
-    invoke-static {v8, v4}, Landroid/net/ConnectivityModuleConnector$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v4
-
-    new-array v14, v15, [Ljava/lang/Object;
-
-    invoke-static {v7, v4, v14}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_12
-    iget-object v4, v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mDualDARDOPolicyPackages:Ljava/util/List;
-
-    check-cast v4, Ljava/util/ArrayList;
-
-    invoke-virtual {v4, v10}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    move-object/from16 v4, v17
-
-    goto :goto_8
-
-    :cond_13
-    sget-object v1, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mContext:Landroid/content/Context;
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;
-
-    move-result-object v1
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-virtual {v12}, Ljava/util/ArrayList;->size()I
-
-    move-result v3
-
-    const/4 v15, 0x0
-
-    :goto_9
-    if-ge v15, v3, :cond_14
-
-    invoke-virtual {v12, v15}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v4
-
-    add-int/lit8 v15, v15, 0x1
-
-    check-cast v4, Ljava/lang/String;
-
-    iget-object v5, v1, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;->skippedPackages:Ljava/util/List;
-
-    check-cast v5, Ljava/util/ArrayList;
-
-    invoke-virtual {v5, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_9
-
-    :catchall_0
-    move-exception v0
-
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw v0
-
-    :cond_14
-    const-string/jumbo v1, "setDualDARDOPolicy res : true"
-
-    const/4 v15, 0x0
-
-    new-array v3, v15, [Ljava/lang/Object;
-
-    invoke-static {v7, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const/4 v5, 0x1
-
-    :goto_a
-    const-string/jumbo v1, "dual_dar_response"
-
-    invoke-virtual {v2, v1, v5}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    if-nez v5, :cond_15
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    if-eqz v0, :cond_15
-
-    const-string/jumbo v1, "dual_dar_response_message"
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mMessage:Ljava/lang/String;
-
-    invoke-virtual {v2, v1, v0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_15
-    return-void
-.end method
-
-.method public final startClientLibrary(I)Z
-    .locals 5
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    const/4 v1, 0x0
-
-    if-nez v0, :cond_0
-
-    new-array p0, v1, [Ljava/lang/Object;
-
-    const-string p1, "DualDARDaemonProxy"
-
-    const-string/jumbo v0, "startClientLibrary failed! Error: native interface not yet connected failed"
-
-    invoke-static {p1, v0, p0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v1
-
-    :cond_0
-    :try_start_0
-    const-string/jumbo v2, "vendor_lib"
-
-    const-string/jumbo v3, "start"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    const/16 v4, 0x10
-
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v4
-
-    filled-new-array {p1, v4}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    invoke-virtual {v0, v2, v3, p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->executeSync(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-virtual {p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->isClassOk()Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->isClassContinue()Z
-
-    move-result p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz p0, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    return v1
-
-    :catch_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_2
-    :goto_0
-    const/4 p0, 0x1
-
-    return p0
-
-    :goto_1
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    return v1
-.end method
-
-.method public final startConnectorThread()V
-    .locals 3
-
-    const/4 v0, 0x0
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    const-string/jumbo v1, "startConnectorThread() "
-
-    const-string v2, "DualDARDaemonProxy"
-
-    invoke-static {v2, v1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-instance v0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    invoke-static {}, Landroid/os/Looper;->getMainLooper()Landroid/os/Looper;
-
-    invoke-direct {v0, p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;-><init>(Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    new-instance v0, Ljava/lang/Thread;
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    invoke-direct {v0, v1, v2}, Ljava/lang/Thread;-><init>(Ljava/lang/Runnable;Ljava/lang/String;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnectorThread:Ljava/lang/Thread;
-
-    invoke-virtual {v0}, Ljava/lang/Thread;->start()V
-
-    return-void
-.end method
-
-.method public final startDualDARDaemon(Landroid/os/Bundle;)V
-    .locals 7
-
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mLock:Ljava/lang/Object;
-
-    monitor-enter v0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    :try_start_1
-    invoke-static {}, Lcom/android/server/knox/dar/DarUtil;->isDaemonRunning()Z
-
-    move-result v1
-
-    const/4 v2, 0x1
-
-    const/4 v3, 0x0
-
-    if-nez v1, :cond_0
-
-    const-string v1, "DualDARDaemonProxy"
-
-    const-string/jumbo v4, "start newly dualdard daemon ! "
-
-    new-array v5, v3, [Ljava/lang/Object;
-
-    invoke-static {v1, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->setSystemPropertyBoolean(Z)V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_2
-
-    :cond_0
-    :goto_0
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->startConnectorThread()V
-
-    new-instance v1, Landroid/os/Handler;
-
-    invoke-static {}, Landroid/os/Looper;->getMainLooper()Landroid/os/Looper;
-
-    move-result-object v4
-
-    invoke-direct {v1, v4}, Landroid/os/Handler;-><init>(Landroid/os/Looper;)V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mHandler:Landroid/os/Handler;
-
-    new-instance v4, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$1;
-
-    invoke-direct {v4, p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy$1;-><init>(Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;)V
-
-    const-wide/16 v5, 0x2710
-
-    invoke-virtual {v1, v4, v5, v6}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mLock:Ljava/lang/Object;
-
-    invoke-virtual {v1}, Ljava/lang/Object;->wait()V
-
-    iget-boolean v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->isDaemonConnectionFailed:Z
-
-    if-nez v1, :cond_1
-
-    const-string/jumbo v1, "dual_dar_response"
-
-    invoke-virtual {p1, v1, v2}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    goto :goto_1
-
-    :cond_1
-    const-string v1, "DualDARDaemonProxy"
-
-    const-string/jumbo v2, "failed to start newly dualdard daemon ! "
-
-    new-array v4, v3, [Ljava/lang/Object;
-
-    invoke-static {v1, v2, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const-string/jumbo v1, "dual_dar_response"
-
-    invoke-virtual {p1, v1, v3}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    invoke-static {v3}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->setSystemPropertyBoolean(Z)V
-
-    :goto_1
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mHandler:Landroid/os/Handler;
-
-    if-eqz p1, :cond_2
-
-    const/4 v1, 0x0
-
-    invoke-virtual {p1, v1}, Landroid/os/Handler;->removeCallbacksAndMessages(Ljava/lang/Object;)V
-
-    :cond_2
-    iput-boolean v3, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->isDaemonConnectionFailed:Z
-
-    monitor-exit v0
-
-    return-void
-
-    :goto_2
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :try_start_2
-    throw p0
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    return-void
-.end method
-
-.method public final unloadClientLibrary(I)Z
-    .locals 4
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    const/4 v1, 0x0
-
-    if-nez v0, :cond_0
-
-    new-array p0, v1, [Ljava/lang/Object;
-
-    const-string p1, "DualDARDaemonProxy"
-
-    const-string/jumbo v0, "unloadClientLibrary failed! Error: native interface not yet connected failed"
-
-    invoke-static {p1, v0, p0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v1
-
-    :cond_0
-    :try_start_0
-    const-string/jumbo v2, "vendor_lib"
-
-    const-string/jumbo v3, "unload"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    filled-new-array {p1}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    invoke-virtual {v0, v2, v3, p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->executeSync(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-virtual {p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->isClassOk()Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->isClassContinue()Z
-
-    move-result p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz p0, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    return v1
-
-    :catch_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_2
-    :goto_0
-    const/4 p0, 0x1
-
-    return p0
-
-    :goto_1
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    return v1
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd.smali b/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd.smali
deleted file mode 100644
index 11ff5344b..000000000
--- a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd.smali
+++ /dev/null
@@ -1,35 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public availableResponseCount:I
-
-.field public final cmd:Ljava/lang/String;
-
-.field public final cmdNum:I
-
-.field public final responses:Ljava/util/concurrent/BlockingQueue;
-
-
-# direct methods
-.method public constructor <init>(ILjava/lang/String;)V
-    .locals 2
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    new-instance v0, Ljava/util/concurrent/ArrayBlockingQueue;
-
-    const/16 v1, 0xa
-
-    invoke-direct {v0, v1}, Ljava/util/concurrent/ArrayBlockingQueue;-><init>(I)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->responses:Ljava/util/concurrent/BlockingQueue;
-
-    iput p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->cmdNum:I
-
-    iput-object p2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->cmd:Ljava/lang/String;
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue.smali b/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue.smali
deleted file mode 100644
index e2b319975..000000000
--- a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue.smali
+++ /dev/null
@@ -1,334 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public final mMaxCount:I
-
-.field public final mPendingCmds:Ljava/util/LinkedList;
-
-
-# direct methods
-.method public constructor <init>()V
-    .locals 1
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    new-instance v0, Ljava/util/LinkedList;
-
-    invoke-direct {v0}, Ljava/util/LinkedList;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mPendingCmds:Ljava/util/LinkedList;
-
-    const/16 v0, 0xa
-
-    iput v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mMaxCount:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final add(ILcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;)V
-    .locals 7
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mPendingCmds:Ljava/util/LinkedList;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mPendingCmds:Ljava/util/LinkedList;
-
-    invoke-virtual {v1}, Ljava/util/LinkedList;->iterator()Ljava/util/Iterator;
-
-    move-result-object v1
-
-    :cond_0
-    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v2
-
-    const/4 v3, 0x0
-
-    if-eqz v2, :cond_1
-
-    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;
-
-    iget v4, v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->cmdNum:I
-
-    if-ne v4, p1, :cond_0
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto/16 :goto_2
-
-    :cond_1
-    move-object v2, v3
-
-    :goto_0
-    if-nez v2, :cond_3
-
-    :goto_1
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mPendingCmds:Ljava/util/LinkedList;
-
-    invoke-virtual {v1}, Ljava/util/LinkedList;->size()I
-
-    move-result v1
-
-    iget v2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mMaxCount:I
-
-    if-lt v1, v2, :cond_2
-
-    const-string v1, "DualDarDaemonConnector"
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v4, "more buffered than allowed: "
-
-    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mPendingCmds:Ljava/util/LinkedList;
-
-    invoke-virtual {v4}, Ljava/util/LinkedList;->size()I
-
-    move-result v4
-
-    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v4, " >= "
-
-    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget v4, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mMaxCount:I
-
-    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    const/4 v4, 0x0
-
-    new-array v5, v4, [Ljava/lang/Object;
-
-    invoke-static {v1, v2, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mPendingCmds:Ljava/util/LinkedList;
-
-    invoke-virtual {v1}, Ljava/util/LinkedList;->remove()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;
-
-    const-string v2, "DualDarDaemonConnector"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v6, "Removing request: "
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget-object v6, v1, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->cmd:Ljava/lang/String;
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v6, " ("
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget v1, v1, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->cmdNum:I
-
-    invoke-virtual {v5, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v1, ")"
-
-    invoke-virtual {v5, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    new-array v4, v4, [Ljava/lang/Object;
-
-    invoke-static {v2, v1, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto :goto_1
-
-    :cond_2
-    new-instance v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;
-
-    invoke-direct {v2, p1, v3}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;-><init>(ILjava/lang/String;)V
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mPendingCmds:Ljava/util/LinkedList;
-
-    invoke-virtual {p1, v2}, Ljava/util/LinkedList;->add(Ljava/lang/Object;)Z
-
-    :cond_3
-    iget p1, v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->availableResponseCount:I
-
-    add-int/lit8 p1, p1, 0x1
-
-    iput p1, v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->availableResponseCount:I
-
-    if-nez p1, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mPendingCmds:Ljava/util/LinkedList;
-
-    invoke-virtual {p0, v2}, Ljava/util/LinkedList;->remove(Ljava/lang/Object;)Z
-
-    :cond_4
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :try_start_1
-    iget-object p0, v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->responses:Ljava/util/concurrent/BlockingQueue;
-
-    check-cast p0, Ljava/util/concurrent/ArrayBlockingQueue;
-
-    invoke-virtual {p0, p2}, Ljava/util/concurrent/ArrayBlockingQueue;->put(Ljava/lang/Object;)V
-    :try_end_1
-    .catch Ljava/lang/InterruptedException; {:try_start_1 .. :try_end_1} :catch_0
-
-    :catch_0
-    return-void
-
-    :goto_2
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-.end method
-
-.method public final remove(ILjava/lang/String;)Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-    .locals 5
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mPendingCmds:Ljava/util/LinkedList;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mPendingCmds:Ljava/util/LinkedList;
-
-    invoke-virtual {v1}, Ljava/util/LinkedList;->iterator()Ljava/util/Iterator;
-
-    move-result-object v1
-
-    :cond_0
-    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v2
-
-    const/4 v3, 0x0
-
-    if-eqz v2, :cond_1
-
-    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;
-
-    iget v4, v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->cmdNum:I
-
-    if-ne v4, p1, :cond_0
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_1
-    move-object v2, v3
-
-    :goto_0
-    if-nez v2, :cond_2
-
-    new-instance v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;
-
-    invoke-direct {v2, p1, p2}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;-><init>(ILjava/lang/String;)V
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mPendingCmds:Ljava/util/LinkedList;
-
-    invoke-virtual {p1, v2}, Ljava/util/LinkedList;->add(Ljava/lang/Object;)Z
-
-    :cond_2
-    iget p1, v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->availableResponseCount:I
-
-    add-int/lit8 p1, p1, -0x1
-
-    iput p1, v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->availableResponseCount:I
-
-    if-nez p1, :cond_3
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->mPendingCmds:Ljava/util/LinkedList;
-
-    invoke-virtual {p0, v2}, Ljava/util/LinkedList;->remove(Ljava/lang/Object;)Z
-
-    :cond_3
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :try_start_1
-    iget-object p0, v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue$PendingCmd;->responses:Ljava/util/concurrent/BlockingQueue;
-
-    const p1, 0xea60
-
-    int-to-long p1, p1
-
-    sget-object v0, Ljava/util/concurrent/TimeUnit;->MILLISECONDS:Ljava/util/concurrent/TimeUnit;
-
-    check-cast p0, Ljava/util/concurrent/ArrayBlockingQueue;
-
-    invoke-virtual {p0, p1, p2, v0}, Ljava/util/concurrent/ArrayBlockingQueue;->poll(JLjava/util/concurrent/TimeUnit;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-    :try_end_1
-    .catch Ljava/lang/InterruptedException; {:try_start_1 .. :try_end_1} :catch_0
-
-    move-object v3, p0
-
-    :catch_0
-    if-nez v3, :cond_4
-
-    const-string p0, "DualDarDaemonConnector"
-
-    const-string/jumbo p1, "Timeout waiting for response"
-
-    const/4 p2, 0x0
-
-    new-array p2, p2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_4
-    return-object v3
-
-    :goto_1
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector.smali b/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector.smali
deleted file mode 100644
index d30924332..000000000
--- a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector.smali
+++ /dev/null
@@ -1,1278 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/lang/Runnable;
-.implements Landroid/os/Handler$Callback;
-
-
-# instance fields
-.field public final mCallback:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-.field public final mDaemonLock:Ljava/lang/Object;
-
-.field public mInputStream:Ljava/io/InputStream;
-
-.field public mIsListening:Z
-
-.field public mOutputStream:Ljava/io/OutputStream;
-
-.field public final mResponseQueue:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;
-
-.field public final mSequenceNumber:Ljava/util/concurrent/atomic/AtomicInteger;
-
-.field public mSocket:Landroid/net/LocalSocket;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;)V
-    .locals 1
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    const/4 v0, 0x1
-
-    iput-boolean v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mIsListening:Z
-
-    new-instance v0, Ljava/lang/Object;
-
-    invoke-direct {v0}, Ljava/lang/Object;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mDaemonLock:Ljava/lang/Object;
-
-    const/4 v0, 0x0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSocket:Landroid/net/LocalSocket;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mCallback:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-    new-instance p1, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;
-
-    invoke-direct {p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mResponseQueue:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;
-
-    new-instance p1, Ljava/util/concurrent/atomic/AtomicInteger;
-
-    const/4 v0, 0x0
-
-    invoke-direct {p1, v0}, Ljava/util/concurrent/atomic/AtomicInteger;-><init>(I)V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSequenceNumber:Ljava/util/concurrent/atomic/AtomicInteger;
-
-    return-void
-.end method
-
-.method public static varargs makeCommand(Ljava/lang/StringBuilder;ILjava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    .locals 8
-
-    const/4 v0, 0x0
-
-    invoke-virtual {p3, v0}, Ljava/lang/String;->indexOf(I)I
-
-    move-result v1
-
-    if-gez v1, :cond_9
-
-    const/16 v1, 0x20
-
-    invoke-virtual {p3, v1}, Ljava/lang/String;->indexOf(I)I
-
-    move-result v2
-
-    if-gez v2, :cond_8
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    array-length p1, p4
-
-    move p2, v0
-
-    :goto_0
-    if-ge p2, p1, :cond_7
-
-    aget-object p3, p4, p2
-
-    invoke-static {p3}, Ljava/lang/String;->valueOf(Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p3
-
-    invoke-virtual {p3, v0}, Ljava/lang/String;->indexOf(I)I
-
-    move-result v2
-
-    if-gez v2, :cond_6
-
-    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p3, v1}, Ljava/lang/String;->indexOf(I)I
-
-    move-result v2
-
-    if-ltz v2, :cond_0
-
-    const/4 v2, 0x1
-
-    goto :goto_1
-
-    :cond_0
-    move v2, v0
-
-    :goto_1
-    const/16 v3, 0x22
-
-    if-eqz v2, :cond_1
-
-    invoke-virtual {p0, v3}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
-
-    :cond_1
-    invoke-virtual {p3}, Ljava/lang/String;->length()I
-
-    move-result v4
-
-    move v5, v0
-
-    :goto_2
-    if-ge v5, v4, :cond_4
-
-    invoke-virtual {p3, v5}, Ljava/lang/String;->charAt(I)C
-
-    move-result v6
-
-    if-ne v6, v3, :cond_2
-
-    const-string/jumbo v6, "\\\""
-
-    invoke-virtual {p0, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    goto :goto_3
-
-    :cond_2
-    const/16 v7, 0x5c
-
-    if-ne v6, v7, :cond_3
-
-    const-string/jumbo v6, "\\\\"
-
-    invoke-virtual {p0, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    goto :goto_3
-
-    :cond_3
-    invoke-virtual {p0, v6}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
-
-    :goto_3
-    add-int/lit8 v5, v5, 0x1
-
-    goto :goto_2
-
-    :cond_4
-    if-eqz v2, :cond_5
-
-    invoke-virtual {p0, v3}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
-
-    :cond_5
-    add-int/lit8 p2, p2, 0x1
-
-    goto :goto_0
-
-    :cond_6
-    new-instance p0, Ljava/lang/IllegalArgumentException;
-
-    const-string/jumbo p1, "Unexpected argument: "
-
-    invoke-virtual {p1, p3}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    :cond_7
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
-
-    return-void
-
-    :cond_8
-    new-instance p0, Ljava/lang/IllegalArgumentException;
-
-    const-string p1, "Arguments must be separate from command"
-
-    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    :cond_9
-    new-instance p0, Ljava/lang/IllegalArgumentException;
-
-    const-string/jumbo p1, "Unexpected command: "
-
-    invoke-virtual {p1, p3}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-.end method
-
-
-# virtual methods
-.method public final varargs declared-synchronized executeSync(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-    .locals 6
-
-    monitor-enter p0
-
-    :try_start_0
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const/16 v1, 0x320
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(I)V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSequenceNumber:Ljava/util/concurrent/atomic/AtomicInteger;
-
-    invoke-virtual {v1}, Ljava/util/concurrent/atomic/AtomicInteger;->incrementAndGet()I
-
-    move-result v1
-
-    invoke-static {v0, v1, p1, p2, p3}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->makeCommand(Ljava/lang/StringBuilder;ILjava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const/4 p3, 0x0
-
-    invoke-virtual {v0, p3}, Ljava/lang/StringBuilder;->substring(I)Ljava/lang/String;
-
-    move-result-object v2
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mDaemonLock:Ljava/lang/Object;
-
-    monitor-enter v3
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    :try_start_1
-    iget-object v4, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mOutputStream:Ljava/io/OutputStream;
-
-    if-nez v4, :cond_0
-
-    const-string v2, "DualDarDaemonConnector"
-
-    const-string/jumbo v4, "Missing Output stream - cannot write commands!"
-
-    new-array v5, p3, [Ljava/lang/Object;
-
-    invoke-static {v2, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p1
-
-    goto/16 :goto_2
-
-    :cond_0
-    :try_start_2
-    sget-object v4, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;
-
-    invoke-virtual {v2, v4}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
-
-    move-result-object v2
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mOutputStream:Ljava/io/OutputStream;
-
-    invoke-virtual {v4, v2}, Ljava/io/OutputStream;->write([B)V
-
-    invoke-static {v2, p3}, Ljava/util/Arrays;->fill([BB)V
-    :try_end_2
-    .catch Ljava/io/IOException; {:try_start_2 .. :try_end_2} :catch_0
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception v2
-
-    :try_start_3
-    invoke-virtual {v2}, Ljava/io/IOException;->printStackTrace()V
-
-    :cond_1
-    :goto_0
-    const-string v2, "DualDarDaemonConnector"
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v5, "Command Sent : sequence Number "
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "task is "
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v5, " Command is "
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    new-array v5, p3, [Ljava/lang/Object;
-
-    invoke-static {v2, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mResponseQueue:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;
-
-    invoke-virtual {v2, v1, p2}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->remove(ILjava/lang/String;)Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    move-result-object v2
-
-    if-nez v2, :cond_2
-
-    const-string p1, "DualDarDaemonConnector"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v4, "timed-out waiting for response to "
-
-    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    new-array v1, p3, [Ljava/lang/Object;
-
-    invoke-static {p1, p2, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto :goto_1
-
-    :cond_2
-    invoke-virtual {v2}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->isClassContinue()Z
-
-    move-result v4
-
-    if-nez v4, :cond_1
-
-    :goto_1
-    if-eqz v2, :cond_3
-
-    iget p1, v2, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mCode:I
-
-    const/16 p2, 0x1f4
-
-    if-lt p1, p2, :cond_3
-
-    const/16 p2, 0x258
-
-    if-ge p1, p2, :cond_3
-
-    const-string p1, "DualDarDaemonConnector"
-
-    const-string/jumbo p2, "event = null or isClassClientError = true"
-
-    new-array v1, p3, [Ljava/lang/Object;
-
-    invoke-static {p1, p2, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_3
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->length()I
-
-    move-result p1
-
-    invoke-virtual {v0, p3, p1}, Ljava/lang/StringBuilder;->delete(II)Ljava/lang/StringBuilder;
-
-    monitor-exit v3
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    monitor-exit p0
-
-    return-object v2
-
-    :goto_2
-    :try_start_4
-    monitor-exit v3
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    :try_start_5
-    throw p1
-
-    :catchall_1
-    move-exception p1
-
-    monitor-exit p0
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_1
-
-    throw p1
-.end method
-
-.method public final handleMessage(Landroid/os/Message;)Z
-    .locals 4
-
-    const-string p0, "DualDarDaemonConnector"
-
-    const-string/jumbo v0, "Unhandled event \'"
-
-    iget-object p1, p1, Landroid/os/Message;->obj:Ljava/lang/Object;
-
-    check-cast p1, Ljava/lang/String;
-
-    const/4 v1, 0x0
-
-    :try_start_0
-    invoke-static {p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->unescapeArgs(Ljava/lang/String;)V
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    invoke-direct {v2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v0, "\'"
-
-    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v2, v1, [Ljava/lang/Object;
-
-    invoke-static {p0, v0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->v(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception v0
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string v3, "Error handling \'"
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string p1, "\': "
-
-    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array v0, v1, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :goto_0
-    const/4 p0, 0x1
-
-    return p0
-.end method
-
-.method public final listenToSocket()V
-    .locals 10
-
-    const/4 v0, 0x0
-
-    const/16 v1, 0x1000
-
-    const/4 v2, 0x0
-
-    :try_start_0
-    new-array v3, v1, [B
-
-    :cond_0
-    move v4, v0
-
-    :goto_0
-    iget-object v5, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mInputStream:Ljava/io/InputStream;
-
-    rsub-int v6, v4, 0x1000
-
-    invoke-virtual {v5, v3, v4, v6}, Ljava/io/InputStream;->read([BII)I
-
-    move-result v5
-
-    if-gez v5, :cond_4
-
-    const-string v6, "DualDarDaemonConnector"
-
-    new-instance v7, Ljava/lang/StringBuilder;
-
-    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v8, "got "
-
-    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v5, " reading with start = "
-
-    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    new-array v5, v0, [Ljava/lang/Object;
-
-    invoke-static {v6, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    move v4, v0
-
-    :goto_1
-    if-ge v4, v1, :cond_1
-
-    aput-byte v0, v3, v4
-    :try_end_0
-    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    add-int/lit8 v4, v4, 0x1
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception v1
-
-    goto/16 :goto_9
-
-    :catch_0
-    move-exception v1
-
-    goto/16 :goto_8
-
-    :cond_1
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mDaemonLock:Ljava/lang/Object;
-
-    monitor-enter v1
-
-    :try_start_1
-    iget-object v3, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mOutputStream:Ljava/io/OutputStream;
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    if-eqz v3, :cond_2
-
-    :try_start_2
-    const-string v3, "DualDarDaemonConnector"
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v5, "closing stream for "
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget-object v5, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSocket:Landroid/net/LocalSocket;
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    new-array v5, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mOutputStream:Ljava/io/OutputStream;
-
-    invoke-virtual {v3}, Ljava/io/OutputStream;->close()V
-    :try_end_2
-    .catch Ljava/io/IOException; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    goto :goto_2
-
-    :catchall_1
-    move-exception p0
-
-    goto :goto_4
-
-    :catch_1
-    move-exception v3
-
-    :try_start_3
-    const-string v4, "DualDarDaemonConnector"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v6, "Failed closing output stream: "
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    new-array v5, v0, [Ljava/lang/Object;
-
-    invoke-static {v4, v3, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :goto_2
-    iput-object v2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mOutputStream:Ljava/io/OutputStream;
-
-    :cond_2
-    monitor-exit v1
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    :try_start_4
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSocket:Landroid/net/LocalSocket;
-
-    if-eqz p0, :cond_3
-
-    invoke-virtual {p0}, Landroid/net/LocalSocket;->close()V
-    :try_end_4
-    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_2
-
-    goto :goto_3
-
-    :catch_2
-    move-exception p0
-
-    const-string v1, "DualDarDaemonConnector"
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string v3, "Failed closing socket: "
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    invoke-static {v1, p0, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_3
-    :goto_3
-    return-void
-
-    :goto_4
-    :try_start_5
-    monitor-exit v1
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_1
-
-    throw p0
-
-    :cond_4
-    add-int/2addr v5, v4
-
-    move v4, v0
-
-    move v6, v4
-
-    :goto_5
-    if-ge v4, v5, :cond_8
-
-    :try_start_6
-    aget-byte v7, v3, v4
-
-    if-nez v7, :cond_7
-
-    new-instance v7, Ljava/lang/String;
-
-    sub-int v8, v4, v6
-
-    sget-object v9, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;
-
-    invoke-direct {v7, v3, v6, v8, v9}, Ljava/lang/String;-><init>([BIILjava/nio/charset/Charset;)V
-
-    const-string v6, "DualDarDaemonConnector"
-
-    new-instance v8, Ljava/lang/StringBuilder;
-
-    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v9, "rawEvent "
-
-    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v8
-
-    new-array v9, v0, [Ljava/lang/Object;
-
-    invoke-static {v6, v8, v9}, Lcom/android/server/knox/dar/ddar/DDLog;->v(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    :try_end_6
-    .catch Ljava/io/IOException; {:try_start_6 .. :try_end_6} :catch_0
-    .catchall {:try_start_6 .. :try_end_6} :catchall_0
-
-    :try_start_7
-    invoke-static {v7}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->parseRawEvent(Ljava/lang/String;)Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    move-result-object v6
-
-    iget v7, v6, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mCode:I
-
-    const/16 v8, 0x258
-
-    if-lt v7, v8, :cond_5
-
-    const/16 v8, 0x2bc
-
-    if-ge v7, v8, :cond_5
-
-    const/4 v7, 0x1
-
-    goto :goto_6
-
-    :cond_5
-    move v7, v0
-
-    :goto_6
-    if-eqz v7, :cond_6
-
-    goto :goto_7
-
-    :cond_6
-    iget-object v7, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mResponseQueue:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;
-
-    iget v8, v6, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mCmdNumber:I
-
-    invoke-virtual {v7, v8, v6}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector$ResponseQueue;->add(ILcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;)V
-    :try_end_7
-    .catch Ljava/lang/IllegalArgumentException; {:try_start_7 .. :try_end_7} :catch_3
-    .catch Ljava/io/IOException; {:try_start_7 .. :try_end_7} :catch_0
-    .catchall {:try_start_7 .. :try_end_7} :catchall_0
-
-    goto :goto_7
-
-    :catch_3
-    move-exception v6
-
-    :try_start_8
-    const-string v7, "DualDarDaemonConnector"
-
-    new-instance v8, Ljava/lang/StringBuilder;
-
-    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v9, "Problem parsing message "
-
-    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v6
-
-    new-array v8, v0, [Ljava/lang/Object;
-
-    invoke-static {v7, v6, v8}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :goto_7
-    add-int/lit8 v6, v4, 0x1
-
-    :cond_7
-    add-int/lit8 v4, v4, 0x1
-
-    goto :goto_5
-
-    :cond_8
-    if-nez v6, :cond_9
-
-    const-string v4, "DualDarDaemonConnector"
-
-    const-string/jumbo v7, "RCV incomplete"
-
-    new-array v8, v0, [Ljava/lang/Object;
-
-    invoke-static {v4, v7, v8}, Lcom/android/server/knox/dar/ddar/DDLog;->v(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_9
-    if-eq v6, v5, :cond_0
-
-    rsub-int v4, v6, 0x1000
-
-    invoke-static {v3, v6, v3, v0, v4}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
-    :try_end_8
-    .catch Ljava/io/IOException; {:try_start_8 .. :try_end_8} :catch_0
-    .catchall {:try_start_8 .. :try_end_8} :catchall_0
-
-    goto/16 :goto_0
-
-    :goto_8
-    :try_start_9
-    invoke-virtual {v1}, Ljava/io/IOException;->printStackTrace()V
-
-    throw v1
-    :try_end_9
-    .catchall {:try_start_9 .. :try_end_9} :catchall_0
-
-    :goto_9
-    iget-object v3, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mDaemonLock:Ljava/lang/Object;
-
-    monitor-enter v3
-
-    :try_start_a
-    iget-object v4, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mOutputStream:Ljava/io/OutputStream;
-    :try_end_a
-    .catchall {:try_start_a .. :try_end_a} :catchall_2
-
-    if-eqz v4, :cond_a
-
-    :try_start_b
-    const-string v4, "DualDarDaemonConnector"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v6, "closing stream for "
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget-object v6, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSocket:Landroid/net/LocalSocket;
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    new-array v6, v0, [Ljava/lang/Object;
-
-    invoke-static {v4, v5, v6}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mOutputStream:Ljava/io/OutputStream;
-
-    invoke-virtual {v4}, Ljava/io/OutputStream;->close()V
-    :try_end_b
-    .catch Ljava/io/IOException; {:try_start_b .. :try_end_b} :catch_4
-    .catchall {:try_start_b .. :try_end_b} :catchall_2
-
-    goto :goto_a
-
-    :catchall_2
-    move-exception p0
-
-    goto :goto_c
-
-    :catch_4
-    move-exception v4
-
-    :try_start_c
-    const-string v5, "DualDarDaemonConnector"
-
-    new-instance v6, Ljava/lang/StringBuilder;
-
-    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v7, "Failed closing output stream: "
-
-    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    new-array v6, v0, [Ljava/lang/Object;
-
-    invoke-static {v5, v4, v6}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :goto_a
-    iput-object v2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mOutputStream:Ljava/io/OutputStream;
-
-    :cond_a
-    monitor-exit v3
-    :try_end_c
-    .catchall {:try_start_c .. :try_end_c} :catchall_2
-
-    :try_start_d
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSocket:Landroid/net/LocalSocket;
-
-    if-eqz p0, :cond_b
-
-    invoke-virtual {p0}, Landroid/net/LocalSocket;->close()V
-    :try_end_d
-    .catch Ljava/io/IOException; {:try_start_d .. :try_end_d} :catch_5
-
-    goto :goto_b
-
-    :catch_5
-    move-exception p0
-
-    const-string v2, "DualDarDaemonConnector"
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    const-string v4, "Failed closing socket: "
-
-    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v3, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_b
-    :goto_b
-    throw v1
-
-    :goto_c
-    :try_start_e
-    monitor-exit v3
-    :try_end_e
-    .catchall {:try_start_e .. :try_end_e} :catchall_2
-
-    throw p0
-.end method
-
-.method public final openSocketLocked()V
-    .locals 7
-
-    const/4 v0, 0x0
-
-    const/4 v1, 0x0
-
-    :try_start_0
-    new-instance v2, Landroid/net/LocalSocketAddress;
-
-    const-string/jumbo v3, "ddar"
-
-    sget-object v4, Landroid/net/LocalSocketAddress$Namespace;->RESERVED:Landroid/net/LocalSocketAddress$Namespace;
-
-    invoke-direct {v2, v3, v4}, Landroid/net/LocalSocketAddress;-><init>(Ljava/lang/String;Landroid/net/LocalSocketAddress$Namespace;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mInputStream:Ljava/io/InputStream;
-
-    const-string v3, "DualDarDaemonConnector"
-
-    const-string v4, "Creating socket"
-
-    new-array v5, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-instance v3, Landroid/net/LocalSocket;
-
-    invoke-direct {v3}, Landroid/net/LocalSocket;-><init>()V
-
-    iput-object v3, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSocket:Landroid/net/LocalSocket;
-
-    const-string v3, "DualDarDaemonConnector"
-
-    const-string v4, "Connecting socket"
-
-    new-array v5, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSocket:Landroid/net/LocalSocket;
-
-    invoke-virtual {v3, v2}, Landroid/net/LocalSocket;->connect(Landroid/net/LocalSocketAddress;)V
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSocket:Landroid/net/LocalSocket;
-
-    invoke-virtual {v2}, Landroid/net/LocalSocket;->getOutputStream()Ljava/io/OutputStream;
-
-    move-result-object v2
-
-    iput-object v2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mOutputStream:Ljava/io/OutputStream;
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSocket:Landroid/net/LocalSocket;
-
-    invoke-virtual {v2}, Landroid/net/LocalSocket;->getInputStream()Ljava/io/InputStream;
-
-    move-result-object v2
-
-    iput-object v2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mInputStream:Ljava/io/InputStream;
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mCallback:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-    :try_end_0
-    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_1
-
-    :try_start_1
-    const-string v3, "DualDARDaemonProxy"
-
-    const-string/jumbo v4, "onDaemonConnected()"
-
-    new-array v5, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v3, v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mLock:Ljava/lang/Object;
-
-    monitor-enter v3
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-
-    :try_start_2
-    iget-object v2, v2, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mLock:Ljava/lang/Object;
-
-    invoke-virtual {v2}, Ljava/lang/Object;->notify()V
-
-    monitor-exit v3
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v2
-
-    monitor-exit v3
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    :try_start_3
-    throw v2
-    :try_end_3
-    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_0
-
-    :catch_0
-    move-exception v2
-
-    :try_start_4
-    invoke-virtual {v2}, Ljava/lang/Exception;->printStackTrace()V
-
-    :goto_0
-    const-string v2, "DualDarDaemonConnector"
-
-    const-string v3, "DualDarDaemon connected !"
-
-    new-array v4, v1, [Ljava/lang/Object;
-
-    invoke-static {v2, v3, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    :try_end_4
-    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_1
-
-    return-void
-
-    :catch_1
-    move-exception v2
-
-    const-string v3, "DualDarDaemonConnector"
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string v5, "Caught an exception opening the socket: "
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    new-array v5, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-array v3, v1, [Ljava/lang/Object;
-
-    const-string v4, "DualDarDaemonConnector"
-
-    const-string v5, "Closing socket"
-
-    invoke-static {v4, v5, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :try_start_5
-    iget-object v3, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mOutputStream:Ljava/io/OutputStream;
-
-    if-eqz v3, :cond_0
-
-    invoke-virtual {v3}, Ljava/io/OutputStream;->close()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mOutputStream:Ljava/io/OutputStream;
-    :try_end_5
-    .catch Ljava/io/IOException; {:try_start_5 .. :try_end_5} :catch_2
-
-    goto :goto_1
-
-    :catch_2
-    move-exception v3
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    const-string v6, "Failed closing output stream: "
-
-    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    new-array v5, v1, [Ljava/lang/Object;
-
-    invoke-static {v4, v3, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_0
-    :goto_1
-    :try_start_6
-    iget-object v3, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSocket:Landroid/net/LocalSocket;
-
-    if-eqz v3, :cond_1
-
-    invoke-virtual {v3}, Landroid/net/LocalSocket;->close()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mSocket:Landroid/net/LocalSocket;
-    :try_end_6
-    .catch Ljava/io/IOException; {:try_start_6 .. :try_end_6} :catch_3
-
-    goto :goto_2
-
-    :catch_3
-    move-exception p0
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string v3, "Failed closing socket: "
-
-    invoke-direct {v0, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array v0, v1, [Ljava/lang/Object;
-
-    invoke-static {v4, p0, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_1
-    :goto_2
-    throw v2
-.end method
-
-.method public final run()V
-    .locals 6
-
-    :goto_0
-    iget-boolean v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->mIsListening:Z
-
-    if-eqz v0, :cond_0
-
-    monitor-enter p0
-
-    const-wide/16 v0, 0x64
-
-    :try_start_0
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->openSocketLocked()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception v0
-
-    goto :goto_2
-
-    :catch_0
-    :try_start_1
-    invoke-static {v0, v1}, Landroid/os/SystemClock;->sleep(J)V
-
-    :goto_1
-    monitor-exit p0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :try_start_2
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->listenToSocket()V
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_1
-
-    goto :goto_0
-
-    :catch_1
-    move-exception v2
-
-    const-string v3, "DualDarDaemonConnector"
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string v5, "Error connecting to DualDAR daemon in NativeDaemonConnector: "
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    const/4 v4, 0x0
-
-    new-array v4, v4, [Ljava/lang/Object;
-
-    invoke-static {v3, v2, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-static {v0, v1}, Landroid/os/SystemClock;->sleep(J)V
-
-    goto :goto_0
-
-    :goto_2
-    :try_start_3
-    monitor-exit p0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    throw v0
-
-    :cond_0
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent.smali b/smali/com/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent.smali
deleted file mode 100644
index 082e8170c..000000000
--- a/smali/com/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent.smali
+++ /dev/null
@@ -1,514 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public final mCmdNumber:I
-
-.field public final mCode:I
-
-.field public final mLogMessage:Ljava/lang/String;
-
-.field public final mMessage:Ljava/lang/String;
-
-.field public final mResponseCode:I
-
-
-# direct methods
-.method public constructor <init>(IIILjava/lang/String;Ljava/lang/String;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mCmdNumber:I
-
-    iput p2, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mCode:I
-
-    iput p3, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mResponseCode:I
-
-    iput-object p4, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mMessage:Ljava/lang/String;
-
-    iput-object p5, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mLogMessage:Ljava/lang/String;
-
-    return-void
-.end method
-
-.method public static parseRawEvent(Ljava/lang/String;)Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-    .locals 12
-
-    const-string v0, " "
-
-    invoke-virtual {p0, v0}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;
-
-    move-result-object v1
-
-    array-length v2, v1
-
-    const/4 v3, 0x2
-
-    if-lt v2, v3, :cond_5
-
-    const/4 v2, 0x0
-
-    :try_start_0
-    aget-object v4, v1, v2
-
-    invoke-static {v4}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
-
-    move-result v7
-
-    aget-object v4, v1, v2
-
-    invoke-virtual {v4}, Ljava/lang/String;->length()I
-
-    move-result v4
-    :try_end_0
-    .catch Ljava/lang/NumberFormatException; {:try_start_0 .. :try_end_0} :catch_2
-
-    const/4 v5, 0x1
-
-    add-int/2addr v4, v5
-
-    const/16 v6, 0x258
-
-    if-lt v7, v6, :cond_0
-
-    const/16 v6, 0x2bc
-
-    if-ge v7, v6, :cond_0
-
-    move v6, v5
-
-    goto :goto_0
-
-    :cond_0
-    move v6, v2
-
-    :goto_0
-    const/4 v8, 0x3
-
-    if-nez v6, :cond_3
-
-    array-length v6, v1
-
-    const-string v9, "Insufficient arguemnts"
-
-    if-lt v6, v3, :cond_2
-
-    :try_start_1
-    aget-object v6, v1, v5
-
-    invoke-static {v6}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
-
-    move-result v6
-
-    aget-object v10, v1, v5
-
-    invoke-virtual {v10}, Ljava/lang/String;->length()I
-
-    move-result v10
-    :try_end_1
-    .catch Ljava/lang/NumberFormatException; {:try_start_1 .. :try_end_1} :catch_1
-
-    add-int/2addr v10, v5
-
-    add-int/2addr v10, v4
-
-    array-length v4, v1
-
-    if-lt v4, v8, :cond_1
-
-    :try_start_2
-    aget-object v4, v1, v3
-
-    invoke-static {v4}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
-
-    move-result v4
-
-    aget-object v3, v1, v3
-
-    invoke-virtual {v3}, Ljava/lang/String;->length()I
-
-    move-result v3
-    :try_end_2
-    .catch Ljava/lang/NumberFormatException; {:try_start_2 .. :try_end_2} :catch_0
-
-    add-int/2addr v3, v5
-
-    add-int/2addr v3, v10
-
-    move v11, v4
-
-    move v4, v3
-
-    move v3, v8
-
-    move v8, v11
-
-    goto :goto_1
-
-    :catch_0
-    move-exception v0
-
-    move-object p0, v0
-
-    new-instance v0, Ljava/lang/IllegalArgumentException;
-
-    const-string/jumbo v1, "problem parsing responseCode"
-
-    invoke-direct {v0, v1, p0}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    throw v0
-
-    :cond_1
-    new-instance p0, Ljava/lang/IllegalArgumentException;
-
-    invoke-direct {p0, v9}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    :catch_1
-    move-exception v0
-
-    move-object p0, v0
-
-    new-instance v0, Ljava/lang/IllegalArgumentException;
-
-    const-string/jumbo v1, "problem parsing cmdNumber"
-
-    invoke-direct {v0, v1, p0}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    throw v0
-
-    :cond_2
-    new-instance p0, Ljava/lang/IllegalArgumentException;
-
-    invoke-direct {p0, v9}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    :cond_3
-    const/4 v6, -0x1
-
-    move v3, v8
-
-    move v8, v6
-
-    :goto_1
-    array-length v9, v1
-
-    if-le v9, v3, :cond_4
-
-    aget-object v9, v1, v3
-
-    const-string/jumbo v10, "{{sensitive}}"
-
-    invoke-virtual {v9, v10}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v9
-
-    if-eqz v9, :cond_4
-
-    aget-object v3, v1, v3
-
-    invoke-virtual {v3}, Ljava/lang/String;->length()I
-
-    move-result v3
-
-    add-int/2addr v3, v5
-
-    add-int/2addr v4, v3
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
-
-    aget-object v2, v1, v2
-
-    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    aget-object v0, v1, v5
-
-    const-string v1, " {}"
-
-    invoke-static {v3, v0, v1}, Landroid/hardware/audio/common/V2_0/AudioOffloadInfo$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    move-object v10, v0
-
-    goto :goto_2
-
-    :cond_4
-    move-object v10, p0
-
-    :goto_2
-    invoke-virtual {p0, v4}, Ljava/lang/String;->substring(I)Ljava/lang/String;
-
-    move-result-object v9
-
-    new-instance v5, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-direct/range {v5 .. v10}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;-><init>(IIILjava/lang/String;Ljava/lang/String;)V
-
-    return-object v5
-
-    :catch_2
-    move-exception v0
-
-    move-object p0, v0
-
-    new-instance v0, Ljava/lang/IllegalArgumentException;
-
-    const-string/jumbo v1, "problem parsing code"
-
-    invoke-direct {v0, v1, p0}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    throw v0
-
-    :cond_5
-    new-instance p0, Ljava/lang/IllegalArgumentException;
-
-    const-string v0, "Insufficient arguments"
-
-    invoke-direct {p0, v0}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-.end method
-
-.method public static unescapeArgs(Ljava/lang/String;)V
-    .locals 12
-
-    new-instance v0, Ljava/util/ArrayList;
-
-    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V
-
-    invoke-virtual {p0}, Ljava/lang/String;->length()I
-
-    move-result v1
-
-    const/4 v2, 0x0
-
-    invoke-virtual {p0, v2}, Ljava/lang/String;->charAt(I)C
-
-    move-result v3
-
-    const/4 v4, 0x1
-
-    const/16 v5, 0x22
-
-    if-ne v3, v5, :cond_0
-
-    move v3, v4
-
-    :goto_0
-    move v6, v3
-
-    goto :goto_1
-
-    :cond_0
-    move v3, v2
-
-    goto :goto_0
-
-    :goto_1
-    if-ge v3, v1, :cond_8
-
-    const/16 v7, 0x20
-
-    if-eqz v6, :cond_1
-
-    move v8, v5
-
-    goto :goto_2
-
-    :cond_1
-    move v8, v7
-
-    :goto_2
-    move v9, v3
-
-    :goto_3
-    if-ge v9, v1, :cond_3
-
-    invoke-virtual {p0, v9}, Ljava/lang/String;->charAt(I)C
-
-    move-result v10
-
-    if-eq v10, v8, :cond_3
-
-    invoke-virtual {p0, v9}, Ljava/lang/String;->charAt(I)C
-
-    move-result v10
-
-    const/16 v11, 0x5c
-
-    if-ne v10, v11, :cond_2
-
-    add-int/lit8 v9, v9, 0x1
-
-    :cond_2
-    add-int/2addr v9, v4
-
-    goto :goto_3
-
-    :cond_3
-    if-le v9, v1, :cond_4
-
-    move v9, v1
-
-    :cond_4
-    invoke-virtual {p0, v3, v9}, Ljava/lang/String;->substring(II)Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-virtual {v8}, Ljava/lang/String;->length()I
-
-    move-result v9
-
-    add-int/2addr v9, v3
-
-    if-nez v6, :cond_5
-
-    invoke-virtual {v8}, Ljava/lang/String;->trim()Ljava/lang/String;
-
-    move-result-object v8
-
-    goto :goto_4
-
-    :cond_5
-    add-int/lit8 v9, v9, 0x1
-
-    :goto_4
-    const-string/jumbo v3, "\\\\"
-
-    const-string/jumbo v6, "\\"
-
-    invoke-virtual {v8, v3, v6}, Ljava/lang/String;->replace(Ljava/lang/CharSequence;Ljava/lang/CharSequence;)Ljava/lang/String;
-
-    move-result-object v3
-
-    const-string/jumbo v6, "\\\""
-
-    const-string v8, "\""
-
-    invoke-virtual {v3, v6, v8}, Ljava/lang/String;->replace(Ljava/lang/CharSequence;Ljava/lang/CharSequence;)Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-virtual {v0, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    invoke-virtual {p0, v7, v9}, Ljava/lang/String;->indexOf(II)I
-
-    move-result v3
-
-    const-string v6, " \""
-
-    invoke-virtual {p0, v6, v9}, Ljava/lang/String;->indexOf(Ljava/lang/String;I)I
-
-    move-result v6
-
-    const/4 v7, -0x1
-
-    if-le v6, v7, :cond_6
-
-    if-gt v6, v3, :cond_6
-
-    add-int/lit8 v6, v6, 0x2
-
-    move v3, v6
-
-    move v6, v4
-
-    goto :goto_1
-
-    :cond_6
-    if-le v3, v7, :cond_7
-
-    add-int/lit8 v3, v3, 0x1
-
-    move v6, v2
-
-    goto :goto_1
-
-    :cond_7
-    move v6, v2
-
-    move v3, v9
-
-    goto :goto_1
-
-    :cond_8
-    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I
-
-    move-result p0
-
-    new-array p0, p0, [Ljava/lang/String;
-
-    invoke-virtual {v0, p0}, Ljava/util/ArrayList;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, [Ljava/lang/String;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final isClassContinue()Z
-    .locals 1
-
-    const/16 v0, 0x64
-
-    iget p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mCode:I
-
-    if-lt p0, v0, :cond_0
-
-    const/16 v0, 0xc8
-
-    if-ge p0, v0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final isClassOk()Z
-    .locals 1
-
-    const/16 v0, 0xc8
-
-    iget p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mCode:I
-
-    if-lt p0, v0, :cond_0
-
-    const/16 v0, 0x12c
-
-    if-ge p0, v0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final toString()Ljava/lang/String;
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->mLogMessage:Ljava/lang/String;
-
-    return-object p0
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$$ExternalSyntheticLambda1.smali b/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$$ExternalSyntheticLambda1.smali
deleted file mode 100644
index f2b59be77..000000000
--- a/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$$ExternalSyntheticLambda1.smali
+++ /dev/null
@@ -1,137 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$$ExternalSyntheticLambda1;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Consumer;
-
-
-# instance fields
-.field public final synthetic f$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
-
-.field public final synthetic f$1:I
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;I)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
-
-    iput p2, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$$ExternalSyntheticLambda1;->f$1:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 6
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
-
-    iget p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$$ExternalSyntheticLambda1;->f$1:I
-
-    check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v1, "dualdar-config-datalock-whitelistpackages"
-
-    const-string v2, "DualDARComnService"
-
-    invoke-static {p0}, Lcom/samsung/android/knox/SemPersonaManager;->getAdminComponentName(I)Landroid/content/ComponentName;
-
-    move-result-object v3
-
-    const/4 v4, 0x0
-
-    :try_start_0
-    iget-object v0, v0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
-
-    move-result-object v0
-
-    invoke-virtual {v3}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-virtual {v0, v3, p0}, Landroid/content/pm/PackageManager;->getPackageUidAsUser(Ljava/lang/String;I)I
-
-    move-result v0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception v0
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "addKPUAppToWhitelist failed ! Component may be null"
-
-    invoke-direct {v3, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v3, v4, [Ljava/lang/Object;
-
-    invoke-static {v2, v0, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const/4 v0, -0x1
-
-    :goto_0
-    :try_start_1
-    new-instance v3, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-direct {v3, v0, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
-
-    invoke-interface {p1, v3}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
-
-    move-result-object v3
-
-    if-eqz v3, :cond_0
-
-    new-instance v5, Landroid/os/Bundle;
-
-    invoke-direct {v5}, Landroid/os/Bundle;-><init>()V
-
-    invoke-virtual {v3, v1}, Landroid/os/Bundle;->getParcelableArray(Ljava/lang/String;)[Landroid/os/Parcelable;
-
-    move-result-object v3
-
-    invoke-virtual {v5, v1, v3}, Landroid/os/Bundle;->putParcelableArray(Ljava/lang/String;[Landroid/os/Parcelable;)V
-
-    new-instance v1, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-direct {v1, v0, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
-
-    invoke-interface {p1, v1, v5}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->setConfig(Lcom/samsung/android/knox/ContextInfo;Landroid/os/Bundle;)I
-    :try_end_1
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1
-
-    goto :goto_1
-
-    :catch_1
-    const-string/jumbo p0, "addKPUAppToWhitelist Failed"
-
-    new-array p1, v4, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_0
-    :goto_1
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$1.smali b/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$1.smali
index 8413b6fa1..79884033a 100644
--- a/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$1.smali
+++ b/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$1.smali
@@ -25,7 +25,7 @@
 
 # virtual methods
 .method public final onReceive(Landroid/content/Context;Landroid/content/Intent;)V
-    .locals 4
+    .locals 3
 
     iget p1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;->$r8$classId:I
 
@@ -43,23 +43,21 @@
 
     invoke-virtual {p2, v1, v2}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
 
-    move-result v1
-
-    const-string/jumbo v2, "android.intent.action.PACKAGE_ADDED"
+    const-string/jumbo v1, "android.intent.action.PACKAGE_ADDED"
 
-    invoke-virtual {v2, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v2
+    move-result v1
 
-    if-nez v2, :cond_1
+    if-nez v1, :cond_1
 
-    const-string/jumbo v2, "android.intent.action.PACKAGE_CHANGED"
+    const-string/jumbo v1, "android.intent.action.PACKAGE_CHANGED"
 
-    invoke-virtual {v2, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v2
+    move-result v1
 
-    if-eqz v2, :cond_0
+    if-eqz v1, :cond_0
 
     goto :goto_0
 
@@ -70,13 +68,13 @@
 
     move-result p0
 
-    if-nez p0, :cond_4
+    if-nez p0, :cond_3
 
     const-string/jumbo p0, "android.intent.action.PACKAGE_FULLY_REMOVED"
 
     invoke-virtual {p0, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    goto/16 :goto_3
+    goto :goto_3
 
     :cond_1
     :goto_0
@@ -85,9 +83,9 @@
     :try_start_0
     invoke-virtual {p2}, Landroid/content/Intent;->getData()Landroid/net/Uri;
 
-    move-result-object v2
+    move-result-object v1
 
-    if-eqz v2, :cond_4
+    if-eqz v1, :cond_3
 
     invoke-virtual {p2}, Landroid/content/Intent;->getData()Landroid/net/Uri;
 
@@ -99,9 +97,9 @@
 
     if-eqz p2, :cond_2
 
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;->this$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
+    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;->this$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
 
-    invoke-static {v2, p2}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->-$$Nest$mreConnectAgentsByPkgName(Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;Ljava/lang/String;)V
+    invoke-static {v1, p2}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->-$$Nest$mreConnectAgentsByPkgName(Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;Ljava/lang/String;)V
 
     goto :goto_1
 
@@ -112,78 +110,41 @@
 
     :cond_2
     :goto_1
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;->this$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
+    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;->this$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
 
-    iget-object v2, v2, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
+    iget-object v1, v1, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v2}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+    invoke-virtual {v1}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
 
-    move-result-object v2
+    move-result-object v1
 
-    const-string/jumbo v3, "com.samsung.android.knox.permission.KNOX_KPU_INTERNAL"
+    const-string/jumbo v2, "com.samsung.android.knox.permission.KNOX_KPU_INTERNAL"
 
-    invoke-virtual {v2, v3, p2}, Landroid/content/pm/PackageManager;->checkPermission(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-virtual {v1, v2, p2}, Landroid/content/pm/PackageManager;->checkPermission(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result v2
+    move-result v1
 
-    if-nez v2, :cond_4
+    if-nez v1, :cond_3
 
-    new-instance v2, Ljava/lang/StringBuilder;
+    new-instance v1, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v3, "hasKnoxKPUInternalPermission "
+    const-string/jumbo v2, "hasKnoxKPUInternalPermission "
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object p2
 
-    new-array v2, v0, [Ljava/lang/Object;
-
-    invoke-static {p1, p2, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    new-array v1, v0, [Ljava/lang/Object;
 
-    iget-object p2, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;->this$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
-
-    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_4
+    invoke-static {p1, p2, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     iget-object p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;->this$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
 
-    iget-object p2, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    if-nez p2, :cond_3
-
-    const-string p2, "DualDARPolicy"
-
-    invoke-static {p2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object p2
-
-    invoke-static {p2}, Lcom/samsung/android/knox/ddar/IDualDARPolicy$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    move-result-object p2
-
-    iput-object p2, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    :cond_3
-    iget-object p2, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    invoke-static {p2}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p2
-
-    new-instance v2, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$$ExternalSyntheticLambda1;
-
-    invoke-direct {v2, p0, v1}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;I)V
-
-    invoke-virtual {p2, v2}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
     :try_end_0
     .catch Ljava/lang/RuntimeException; {:try_start_0 .. :try_end_0} :catch_0
 
@@ -198,7 +159,7 @@
 
     invoke-virtual {p0}, Ljava/lang/RuntimeException;->printStackTrace()V
 
-    :cond_4
+    :cond_3
     :goto_3
     return-void
 
@@ -221,7 +182,7 @@
 
     move-result p1
 
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_6
 
     iget-object p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;->this$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
 
@@ -262,13 +223,13 @@
 
     move-result-object v0
 
-    :cond_5
+    :cond_4
     :goto_4
     invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
 
     move-result v1
 
-    if-eqz v1, :cond_6
+    if-eqz v1, :cond_5
 
     invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -290,7 +251,7 @@
 
     iget v2, v1, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;->mUserId:I
 
-    if-ne v2, p2, :cond_5
+    if-ne v2, p2, :cond_4
 
     invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->connectProxyAgentASync(Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;)Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentWrapper;
 
@@ -301,7 +262,7 @@
 
     goto :goto_5
 
-    :cond_6
+    :cond_5
     monitor-exit p1
 
     goto :goto_6
@@ -313,7 +274,7 @@
 
     throw p0
 
-    :cond_7
+    :cond_6
     :goto_6
     return-void
 
diff --git a/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$3.smali b/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$3.smali
index 3faf6274c..274a64a06 100644
--- a/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$3.smali
+++ b/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$3.smali
@@ -21,7 +21,7 @@
 
 # virtual methods
 .method public final handleMessage(Landroid/os/Message;)V
-    .locals 7
+    .locals 6
 
     iget v0, p1, Landroid/os/Message;->what:I
 
@@ -29,11 +29,11 @@
 
     const/4 v2, 0x1
 
-    if-eq v0, v2, :cond_9
+    if-eq v0, v2, :cond_7
 
     const/4 v2, 0x2
 
-    if-eq v0, v2, :cond_4
+    if-eq v0, v2, :cond_2
 
     const/4 v2, 0x4
 
@@ -50,70 +50,68 @@
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v0, "clientPkg connected : "
+    const-string/jumbo p0, "Not installed service "
 
-    const-string/jumbo v2, "Not installed service "
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    new-instance v3, Ljava/lang/StringBuilder;
+    const-string/jumbo v2, "handleAgentStarted : "
 
-    const-string/jumbo v4, "handleAgentStarted : "
+    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    iget-object v2, p1, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;->mCompName:Landroid/content/ComponentName;
 
-    iget-object v4, p1, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;->mCompName:Landroid/content/ComponentName;
+    invoke-virtual {v2}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
 
-    invoke-virtual {v4}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
+    move-result-object v2
 
-    move-result-object v4
+    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    move-result-object v0
 
-    move-result-object v3
+    new-array v2, v1, [Ljava/lang/Object;
 
-    new-array v4, v1, [Ljava/lang/Object;
-
-    const-string v5, "DualDARComnService"
+    const-string v3, "DualDARComnService"
 
-    invoke-static {v5, v3, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v3, v0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     :try_start_0
-    const-string/jumbo v3, "package"
+    const-string/jumbo v0, "package"
 
-    invoke-static {v3}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
+    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
 
-    move-result-object v3
+    move-result-object v0
 
-    invoke-static {v3}, Landroid/content/pm/IPackageManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/content/pm/IPackageManager;
+    invoke-static {v0}, Landroid/content/pm/IPackageManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/content/pm/IPackageManager;
 
-    move-result-object v3
+    move-result-object v0
 
-    iget-object v4, p1, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;->mCompName:Landroid/content/ComponentName;
+    iget-object v2, p1, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;->mCompName:Landroid/content/ComponentName;
 
-    invoke-virtual {v4}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
+    invoke-virtual {v2}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v2
 
-    iget v6, p1, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;->mUserId:I
+    iget v4, p1, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;->mUserId:I
 
-    invoke-interface {v3, v4, v6}, Landroid/content/pm/IPackageManager;->isPackageAvailable(Ljava/lang/String;I)Z
+    invoke-interface {v0, v2, v4}, Landroid/content/pm/IPackageManager;->isPackageAvailable(Ljava/lang/String;I)Z
 
-    move-result v3
+    move-result v0
 
-    if-nez v3, :cond_1
+    if-nez v0, :cond_1
 
     invoke-virtual {p1}, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;->toString()Ljava/lang/String;
 
-    move-result-object p0
+    move-result-object p1
 
-    invoke-virtual {v2, p0}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
+    invoke-virtual {p0, p1}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
 
     move-result-object p0
 
     new-array p1, v1, [Ljava/lang/Object;
 
-    invoke-static {v5, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v3, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     goto/16 :goto_4
 
@@ -123,59 +121,7 @@
     goto :goto_0
 
     :cond_1
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARUser()I
-
-    move-result v2
-
-    if-gtz v2, :cond_2
-
-    goto/16 :goto_4
-
-    :cond_2
-    invoke-static {v2}, Lcom/samsung/android/knox/SemPersonaManager;->isDualDARNativeCrypto(I)Z
-
-    move-result v3
-
-    if-nez v3, :cond_3
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    invoke-static {v3}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
-
-    move-result-object v3
-
-    invoke-virtual {v3, v2}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getClientPackage(I)Ljava/lang/String;
-
-    move-result-object v3
-
-    if-eqz v3, :cond_d
-
-    iget-object p1, p1, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;->mCompName:Landroid/content/ComponentName;
-
-    invoke-virtual {p1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-virtual {v3, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_d
-
-    invoke-virtual {v0, v3}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array v0, v1, [Ljava/lang/Object;
-
-    invoke-static {v5, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->setDeviceUnlockedForUserIfUnsecured(I)V
-
-    goto/16 :goto_4
-
-    :cond_3
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->setDeviceUnlockedForUserIfUnsecured(I)V
+    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getUserManager()Lcom/android/server/pm/UserManagerService;
     :try_end_0
     .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
 
@@ -186,13 +132,13 @@
 
     new-array v0, v1, [Ljava/lang/Object;
 
-    invoke-static {v5, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v3, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
 
     goto/16 :goto_4
 
-    :cond_4
+    :cond_2
     iget-object p1, p1, Landroid/os/Message;->obj:Ljava/lang/Object;
 
     check-cast p1, Ljava/lang/String;
@@ -201,7 +147,7 @@
 
     iget-object p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mBindingChecker:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$ProxyAgentBindingChecker;
 
-    if-eqz p1, :cond_8
+    if-eqz p1, :cond_6
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -209,11 +155,11 @@
 
     move-result v0
 
-    if-eqz v0, :cond_5
+    if-eqz v0, :cond_3
 
     goto :goto_1
 
-    :cond_5
+    :cond_3
     const-string v0, "DualDARComnService"
 
     const-string v3, "Binding Checker : Check binding to "
@@ -232,7 +178,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_6
+    if-eqz v0, :cond_4
 
     iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$ProxyAgentBindingChecker;->mCheckerLock:Ljava/lang/Object;
 
@@ -264,7 +210,7 @@
 
     throw p0
 
-    :cond_6
+    :cond_4
     const-string v0, "DualDARComnService"
 
     const-string v3, "Binding Checker : Maybe not bound yet"
@@ -279,13 +225,13 @@
 
     move-result v0
 
-    if-eqz v0, :cond_7
+    if-eqz v0, :cond_5
 
     iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$ProxyAgentBindingChecker;->mHandler:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$3;
 
     invoke-virtual {v0, v2, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
 
-    :cond_7
+    :cond_5
     iget-object p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$ProxyAgentBindingChecker;->mHandler:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$3;
 
     invoke-virtual {p0, v2, p1}, Landroid/os/Handler;->obtainMessage(ILjava/lang/Object;)Landroid/os/Message;
@@ -298,7 +244,7 @@
 
     return-void
 
-    :cond_8
+    :cond_6
     :goto_1
     iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$ProxyAgentBindingChecker;->mCheckerLock:Ljava/lang/Object;
 
@@ -330,7 +276,7 @@
 
     throw p0
 
-    :cond_9
+    :cond_7
     iget-object p1, p1, Landroid/os/Message;->obj:Ljava/lang/Object;
 
     check-cast p1, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;
@@ -360,7 +306,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_a
+    if-eqz v4, :cond_8
 
     iget-object v4, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mProxyAgentWrapperMap:Ljava/util/HashMap;
 
@@ -383,7 +329,7 @@
 
     goto :goto_5
 
-    :cond_a
+    :cond_8
     :goto_2
     monitor-exit v3
     :try_end_3
@@ -412,7 +358,7 @@
 
     move-result v3
 
-    if-nez v3, :cond_b
+    if-nez v3, :cond_9
 
     const-string p0, "DualDARComnService"
 
@@ -435,12 +381,12 @@
 
     goto :goto_3
 
-    :cond_b
+    :cond_9
     invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->connectProxyAgentASync(Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;)Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentWrapper;
 
     move-result-object p0
 
-    if-eqz p0, :cond_c
+    if-eqz p0, :cond_a
 
     new-instance p1, Ljava/lang/StringBuilder;
 
@@ -464,7 +410,7 @@
 
     goto :goto_4
 
-    :cond_c
+    :cond_a
     const-string p0, "DualDARComnService"
 
     const-string/jumbo p1, "ProxyAgentWrapper is NULL !"
@@ -488,7 +434,6 @@
 
     invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
 
-    :cond_d
     :goto_4
     return-void
 
diff --git a/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$4.smali b/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$4.smali
index 99b60b670..375ebd5cc 100644
--- a/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$4.smali
+++ b/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService$4.smali
@@ -58,11 +58,7 @@
 
     invoke-static {v3, v0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$4;->this$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
+    invoke-static {}, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->getInstance()Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
 
     move-result-object v0
 
diff --git a/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService.smali b/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService.smali
index 12e48bee9..e54149313 100644
--- a/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService.smali
+++ b/smali/com/android/server/knox/dar/ddar/proxy/DualDARComnService.smali
@@ -13,14 +13,10 @@
 
 .field public final mContext:Landroid/content/Context;
 
-.field public mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
 .field public final mHandler:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$3;
 
 .field public final mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-.field public final mPackageBroadcastReceiver:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;
-
 .field public final mProxyAgentWrapperLock:Ljava/lang/Object;
 
 .field public final mProxyAgentWrapperMap:Ljava/util/HashMap;
@@ -29,8 +25,6 @@
 
 .field public final mRegisteredProxyAgentsLock:Ljava/lang/Object;
 
-.field public final mUserBroadcastReceiver:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;
-
 
 # direct methods
 .method public static -$$Nest$mreConnectAgentsByPkgName(Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;Ljava/lang/String;)V
@@ -165,7 +159,7 @@
 .end method
 
 .method public constructor <init>(Landroid/content/Context;)V
-    .locals 3
+    .locals 2
 
     invoke-direct {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyService$Stub;-><init>()V
 
@@ -201,31 +195,25 @@
 
     iput-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    new-instance v1, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;
+    new-instance v0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;
 
-    const/4 v2, 0x0
-
-    invoke-direct {v1, p0, v2}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;-><init>(Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;I)V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mUserBroadcastReceiver:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;
+    const/4 v1, 0x0
 
-    new-instance v1, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;
+    invoke-direct {v0, p0, v1}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;-><init>(Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;I)V
 
-    const/4 v2, 0x1
+    new-instance v0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;
 
-    invoke-direct {v1, p0, v2}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;-><init>(Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;I)V
+    const/4 v1, 0x1
 
-    iput-object v1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mPackageBroadcastReceiver:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;
+    invoke-direct {v0, p0, v1}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;-><init>(Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;I)V
 
     iput-object p1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
 
-    new-instance v1, Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-direct {v1, p1}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
+    new-instance v0, Lcom/android/internal/widget/LockPatternUtils;
 
-    iput-object v1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
+    invoke-direct {v0, p1}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
 
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
+    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
     const-string p1, "DualDARComnService"
 
@@ -359,9 +347,9 @@
     :try_end_0
     .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
 
-    const/4 v4, 0x0
+    const-string v4, "DualDARComnService"
 
-    const-string v6, "DualDARComnService"
+    const/4 v6, 0x0
 
     if-eqz v2, :cond_4
 
@@ -403,9 +391,9 @@
 
     move-result-object p3
 
-    new-array v1, v4, [Ljava/lang/Object;
+    new-array v1, v6, [Ljava/lang/Object;
 
-    invoke-static {v6, p3, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {p3, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->i(Ljava/lang/String;[Ljava/lang/Object;)V
 
     new-instance p3, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;
 
@@ -444,9 +432,9 @@
 
     move-result-object p0
 
-    new-array p1, v4, [Ljava/lang/Object;
+    new-array p1, v6, [Ljava/lang/Object;
 
-    invoke-static {v6, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v4, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
     :try_end_1
     .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0
 
@@ -620,23 +608,21 @@
 
     :cond_1
     :goto_0
-    const-string p0, "DualDARComnService"
-
-    new-instance v0, Ljava/lang/StringBuilder;
+    new-instance p0, Ljava/lang/StringBuilder;
 
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {p0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
     iget-object p1, p1, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentInfo;->mName:Ljava/lang/String;
 
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object p1
+    move-result-object p0
 
-    new-array v0, v4, [Ljava/lang/Object;
+    new-array p1, v4, [Ljava/lang/Object;
 
-    invoke-static {p0, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->i(Ljava/lang/String;[Ljava/lang/Object;)V
 
     monitor-exit v2
 
@@ -1540,9 +1526,7 @@
 
     if-eqz v0, :cond_0
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
+    invoke-static {}, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->getInstance()Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
 
     move-result-object p0
 
@@ -1719,418 +1703,18 @@
     return-object p0
 .end method
 
-.method public final setDeviceUnlockedForUserIfUnsecured(I)V
-    .locals 3
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    const-class v1, Landroid/app/KeyguardManager;
-
-    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/app/KeyguardManager;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v1, "trust"
-
-    invoke-virtual {p0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/app/trust/TrustManager;
-
-    if-eqz v0, :cond_0
-
-    if-eqz p0, :cond_0
-
-    invoke-virtual {v0}, Landroid/app/KeyguardManager;->isDeviceSecure()Z
-
-    move-result v1
-
-    if-nez v1, :cond_0
-
-    invoke-virtual {v0, p1}, Landroid/app/KeyguardManager;->isDeviceSecure(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_0
-
-    const/4 p1, 0x0
-
-    new-array v0, p1, [Ljava/lang/Object;
-
-    const-string v1, "DualDARComnService"
-
-    const-string/jumbo v2, "setDeviceUnlockedForUserIfUnsecured"
-
-    invoke-static {v1, v2, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0, p1, p1}, Landroid/app/trust/TrustManager;->setDeviceLockedForUser(IZ)V
-
-    :cond_0
-    return-void
-.end method
-
 .method public final systemReady()V
-    .locals 14
-
-    const-string v0, "DualDARComnService"
-
-    const-string/jumbo v1, "initialize"
-
-    const/4 v2, 0x0
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-instance v7, Landroid/content/IntentFilter;
-
-    invoke-direct {v7}, Landroid/content/IntentFilter;-><init>()V
-
-    const-string/jumbo v0, "android.intent.action.USER_STARTED"
-
-    invoke-virtual {v7, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string/jumbo v0, "android.intent.action.USER_REMOVED"
-
-    invoke-virtual {v7, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string/jumbo v0, "android.intent.action.USER_ADDED"
-
-    invoke-virtual {v7, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    iget-object v5, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mUserBroadcastReceiver:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;
-
-    sget-object v6, Landroid/os/UserHandle;->ALL:Landroid/os/UserHandle;
-
-    const/4 v8, 0x0
-
-    const/4 v9, 0x0
-
-    invoke-virtual/range {v4 .. v9}, Landroid/content/Context;->registerReceiverAsUser(Landroid/content/BroadcastReceiver;Landroid/os/UserHandle;Landroid/content/IntentFilter;Ljava/lang/String;Landroid/os/Handler;)Landroid/content/Intent;
-
-    new-instance v11, Landroid/content/IntentFilter;
-
-    invoke-direct {v11}, Landroid/content/IntentFilter;-><init>()V
-
-    const-string/jumbo v0, "android.intent.action.PACKAGE_ADDED"
-
-    invoke-virtual {v11, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string/jumbo v0, "android.intent.action.PACKAGE_REMOVED"
-
-    invoke-virtual {v11, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string/jumbo v0, "android.intent.action.PACKAGE_FULLY_REMOVED"
-
-    invoke-virtual {v11, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string/jumbo v0, "android.intent.action.PACKAGE_CHANGED"
-
-    invoke-virtual {v11, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string/jumbo v0, "package"
-
-    invoke-virtual {v11, v0}, Landroid/content/IntentFilter;->addDataScheme(Ljava/lang/String;)V
-
-    iget-object v8, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    iget-object v9, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mPackageBroadcastReceiver:Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService$1;
-
-    const/4 v12, 0x0
-
-    const/4 v13, 0x0
-
-    move-object v10, v6
-
-    invoke-virtual/range {v8 .. v13}, Landroid/content/Context;->registerReceiverAsUser(Landroid/content/BroadcastReceiver;Landroid/os/UserHandle;Landroid/content/IntentFilter;Ljava/lang/String;Landroid/os/Handler;)Landroid/content/Intent;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->onCreate()V
-
-    const-string/jumbo v1, "TA_PROXY_SERVICE"
-
-    sget-object v3, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mInstance:Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-
-    const-class v3, Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-
-    monitor-enter v3
-
-    :try_start_0
-    sget-object v4, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mInstance:Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-
-    if-nez v4, :cond_0
-
-    new-instance v4, Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-
-    invoke-direct {v4}, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;-><init>()V
-
-    new-instance v5, Ljava/util/HashMap;
-
-    invoke-direct {v5}, Ljava/util/HashMap;-><init>()V
-
-    iput-object v5, v4, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mTAMap:Ljava/util/Map;
-
-    new-array v5, v2, [Ljava/lang/Object;
-
-    const-string/jumbo v6, "TAProxy"
-
-    const-string/jumbo v7, "TAProxy() called updated"
-
-    invoke-static {v6, v7, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    sput-object v4, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mInstance:Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto/16 :goto_7
-
-    :cond_0
-    :goto_0
-    sget-object v4, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mInstance:Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v3
-
-    invoke-virtual {v0, v1, v4}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    const-string v1, "DAEMON_PROXY_SERVICE"
-
-    iget-object v3, v0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mContext:Landroid/content/Context;
-
-    invoke-static {v3}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-    move-result-object v3
-
-    invoke-virtual {v0, v1, v3}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    const-string/jumbo v1, "STATE_MACHINE_SERVICE"
-
-    iget-object v3, v0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mContext:Landroid/content/Context;
-
-    sget-object v4, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->mInstance:Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-    const-class v4, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-    monitor-enter v4
-
-    :try_start_1
-    sget-object v5, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->mInstance:Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-    if-nez v5, :cond_1
-
-    new-instance v5, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-    invoke-direct {v5, v3}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;-><init>(Landroid/content/Context;)V
-
-    sput-object v5, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->mInstance:Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-    goto :goto_1
-
-    :catchall_1
-    move-exception v0
-
-    move-object p0, v0
-
-    goto/16 :goto_6
-
-    :cond_1
-    :goto_1
-    sget-object v3, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->mInstance:Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    monitor-exit v4
-
-    invoke-virtual {v0, v1, v3}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    const-string v1, "DDAR_LOG_SERVICE"
-
-    sget-object v3, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-
-    const-class v3, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-
-    monitor-enter v3
-
-    :try_start_2
-    sget-object v4, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-
-    if-nez v4, :cond_3
-
-    new-instance v4, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-
-    invoke-direct {v4}, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;-><init>()V
-
-    const-string v5, "DDLog"
-
-    const-string/jumbo v6, "Logger ready"
-
-    invoke-static {v5, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-class v5, Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    monitor-enter v5
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_3
-
-    :try_start_3
-    sget-object v6, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    if-nez v6, :cond_2
-
-    new-instance v6, Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    invoke-direct {v6}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;-><init>()V
-
-    sput-object v6, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    invoke-virtual {v6}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->start()V
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_2
-
-    goto :goto_2
-
-    :catchall_2
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_3
-
-    :cond_2
-    :goto_2
-    :try_start_4
-    monitor-exit v5
-
-    sput-object v4, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_3
-
-    goto :goto_4
-
-    :catchall_3
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_5
-
-    :goto_3
-    :try_start_5
-    monitor-exit v5
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_2
-
-    :try_start_6
-    throw p0
-
-    :cond_3
-    :goto_4
-    sget-object v4, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_3
-
-    monitor-exit v3
-
-    invoke-virtual {v0, v1, v4}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    const-string v1, "DDAR_CACHE_SERVICE"
-
-    invoke-static {}, Lcom/android/server/knox/dar/ddar/DDCache;->getInstance()Lcom/android/server/knox/dar/ddar/DDCache;
-
-    move-result-object v3
-
-    invoke-virtual {v0, v1, v3}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    const-string v1, "DDAR_PLATFORM_SERVICE"
-
-    iget-object v3, v0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mContext:Landroid/content/Context;
-
-    invoke-static {v3}, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    move-result-object v3
-
-    invoke-virtual {v0, v1, v3}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    const-string v1, "DDAR_MANAGER_SERVICE"
-
-    iget-object v3, v0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mContext:Landroid/content/Context;
-
-    invoke-static {v3}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-
-    move-result-object v3
-
-    invoke-virtual {v0, v1, v3}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    new-array v0, v2, [Ljava/lang/Object;
-
-    const-string v1, "DualDARComnService"
-
-    const-string/jumbo v3, "initKnownProxyAgents"
-
-    invoke-static {v1, v3, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->isDualDAREnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManager;
+    .locals 2
 
-    move-result-object p0
+    const/4 p0, 0x0
 
-    const-string/jumbo v0, "proxyAgent.class"
+    new-array p0, p0, [Ljava/lang/Object;
 
-    const-string v1, "KNOXCORE_PROXY_AGENT"
+    const-string v0, "DualDARComnService"
 
-    const-string/jumbo v3, "com.samsung.android.knox.containercore"
+    const-string/jumbo v1, "device does not support DualDAR"
 
-    invoke-virtual {p0, v1, v2, v3, v0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManager;->registerAgentByMetadata(Ljava/lang/String;ILjava/lang/String;Ljava/lang/String;)Z
+    invoke-static {v0, v1, p0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    :cond_4
     return-void
-
-    :goto_5
-    :try_start_7
-    monitor-exit v3
-    :try_end_7
-    .catchall {:try_start_7 .. :try_end_7} :catchall_3
-
-    throw p0
-
-    :goto_6
-    :try_start_8
-    monitor-exit v4
-    :try_end_8
-    .catchall {:try_start_8 .. :try_end_8} :catchall_1
-
-    throw p0
-
-    :goto_7
-    :try_start_9
-    monitor-exit v3
-    :try_end_9
-    .catchall {:try_start_9 .. :try_end_9} :catchall_0
-
-    throw p0
 .end method
diff --git a/smali/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda0.smali b/smali/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda0.smali
deleted file mode 100644
index 3c633720f..000000000
--- a/smali/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda0.smali
+++ /dev/null
@@ -1,223 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda0;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Consumer;
-
-
-# instance fields
-.field public final synthetic f$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-.field public final synthetic f$1:Landroid/os/Bundle;
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;Landroid/os/Bundle;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda0;->f$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    iput-object p2, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda0;->f$1:Landroid/os/Bundle;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 9
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda0;->f$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda0;->f$1:Landroid/os/Bundle;
-
-    check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    const-string/jumbo v1, "null"
-
-    const-string v2, "DualDARPlatformProxy"
-
-    const-string/jumbo v3, "setClientInfo adminUid : "
-
-    const-string/jumbo v4, "setClientInfo adminPackage : "
-
-    const/4 v5, 0x0
-
-    const/4 v6, -0x1
-
-    :try_start_0
-    const-string/jumbo v7, "user_id"
-
-    invoke-virtual {p0, v7}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v7
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1
-
-    :try_start_1
-    const-string v8, "DUAL_DAR_ADMIN_PACKAGE"
-
-    invoke-virtual {p0, v8, v1}, Landroid/os/Bundle;->getString(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-virtual {v8, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    invoke-static {v7}, Lcom/samsung/android/knox/SemPersonaManager;->getAdminComponentName(I)Landroid/content/ComponentName;
-
-    move-result-object v1
-
-    invoke-virtual {v1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
-
-    move-result-object v8
-
-    goto :goto_0
-
-    :catch_0
-    move-exception v0
-
-    goto :goto_1
-
-    :cond_0
-    :goto_0
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    new-array v4, v5, [Ljava/lang/Object;
-
-    invoke-static {v2, v1, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
-
-    move-result-object v0
-
-    invoke-virtual {v0, v8, v7}, Landroid/content/pm/PackageManager;->getPackageUidAsUser(Ljava/lang/String;I)I
-
-    move-result v6
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v1, v5, [Ljava/lang/Object;
-
-    invoke-static {v2, v0, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-
-    goto :goto_2
-
-    :catch_1
-    move-exception v0
-
-    move v7, v6
-
-    :goto_1
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "setClientInfo failed ! Component may be null"
-
-    invoke-direct {v1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v1, v5, [Ljava/lang/Object;
-
-    invoke-static {v2, v0, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :goto_2
-    const-string v0, "CLIENT_PACKAGE_NAME"
-
-    invoke-virtual {p0, v0}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string v1, "CLIENT_PACKAGE_SIGNATURE"
-
-    invoke-virtual {p0, v1}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    const-string v3, "CLIENT_VERSION"
-
-    invoke-virtual {p0, v3}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string/jumbo v3, "setClientInfo packageName "
-
-    const-string/jumbo v4, "packageSig "
-
-    const-string/jumbo v8, "client version "
-
-    invoke-static {v3, v0, v4, v1, v8}, Landroid/net/shared/InitialConfiguration$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    move-result-object v3
-
-    invoke-virtual {v3, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string/jumbo v4, "user id "
-
-    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    new-array v4, v5, [Ljava/lang/Object;
-
-    invoke-static {v2, v3, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :try_start_2
-    new-instance v3, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-direct {v3, v6, v7}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
-
-    invoke-interface {p1, v3, v0, v1, p0}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->setClientInfo(Lcom/samsung/android/knox/ContextInfo;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-    :try_end_2
-    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_2
-
-    goto :goto_3
-
-    :catch_2
-    const-string/jumbo p0, "setClientInfo Failed"
-
-    new-array p1, v5, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :goto_3
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda1.smali b/smali/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda1.smali
deleted file mode 100644
index da2986ae4..000000000
--- a/smali/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda1.smali
+++ /dev/null
@@ -1,124 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda1;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic f$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-.field public final synthetic f$1:Landroid/os/Bundle;
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;Landroid/os/Bundle;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    iput-object p2, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda1;->f$1:Landroid/os/Bundle;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 5
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda1;->f$1:Landroid/os/Bundle;
-
-    check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    const-string v1, "DualDARPlatformProxy"
-
-    const-string/jumbo v2, "user_id"
-
-    invoke-virtual {p0, v2}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p0
-
-    invoke-static {p0}, Lcom/samsung/android/knox/SemPersonaManager;->getAdminComponentName(I)Landroid/content/ComponentName;
-
-    move-result-object v2
-
-    const/4 v3, 0x0
-
-    :try_start_0
-    iget-object v0, v0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
-
-    move-result-object v0
-
-    invoke-virtual {v2}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v0, v2, p0}, Landroid/content/pm/PackageManager;->getPackageUidAsUser(Ljava/lang/String;I)I
-
-    move-result v0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception v0
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v4, "getConfig failed ! Component may be null"
-
-    invoke-direct {v2, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v2, v3, [Ljava/lang/Object;
-
-    invoke-static {v1, v0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const/4 v0, -0x1
-
-    :goto_0
-    :try_start_1
-    new-instance v2, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-direct {v2, v0, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
-
-    invoke-interface {p1, v2}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
-
-    move-result-object p0
-    :try_end_1
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1
-
-    goto :goto_1
-
-    :catch_1
-    const-string/jumbo p0, "getConfig Failed"
-
-    new-array p1, v3, [Ljava/lang/Object;
-
-    invoke-static {v1, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-instance p0, Landroid/os/Bundle;
-
-    invoke-direct {p0}, Landroid/os/Bundle;-><init>()V
-
-    :goto_1
-    return-object p0
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy.smali b/smali/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy.smali
deleted file mode 100644
index 6a2d43ea6..000000000
--- a/smali/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy.smali
+++ /dev/null
@@ -1,259 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-.super Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;
-.source "SourceFile"
-
-
-# static fields
-.field public static mInstance:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-
-# instance fields
-.field public final mContext:Landroid/content/Context;
-
-.field public mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-
-# direct methods
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 3
-
-    invoke-direct {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;-><init>()V
-
-    const/4 v0, 0x0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    const/4 v0, 0x0
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    const-string v1, "DualDARPlatformProxy"
-
-    const-string v2, "DualDARPlatformProxy() constructor"
-
-    invoke-static {v1, v2, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mContext:Landroid/content/Context;
-
-    return-void
-.end method
-
-.method public static declared-synchronized getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-    .locals 2
-
-    const-class v0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mInstance:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    if-nez v1, :cond_0
-
-    new-instance v1, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    invoke-direct {v1, p0}, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;-><init>(Landroid/content/Context;)V
-
-    sput-object v1, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mInstance:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    :goto_0
-    sget-object p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mInstance:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v0
-
-    return-object p0
-
-    :goto_1
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-
-# virtual methods
-.method public final onMessage(ILjava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
-    .locals 4
-
-    const-string/jumbo p1, "onMessage() "
-
-    :try_start_0
-    const-string v0, "DualDARPlatformProxy"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    const/4 v1, 0x0
-
-    new-array v2, v1, [Ljava/lang/Object;
-
-    invoke-static {v0, p1, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-instance p1, Landroid/os/Bundle;
-
-    invoke-direct {p1}, Landroid/os/Bundle;-><init>()V
-
-    invoke-virtual {p2}, Ljava/lang/String;->hashCode()I
-
-    move-result v0
-
-    const v2, -0x67735fdb
-
-    const/4 v3, 0x1
-
-    if-eq v0, v2, :cond_1
-
-    const v1, -0x21c8630f
-
-    if-eq v0, v1, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const-string v0, "GET_DUALDAR_CONFIG"
-
-    invoke-virtual {p2, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_2
-
-    move v1, v3
-
-    goto :goto_1
-
-    :cond_1
-    const-string/jumbo v0, "SET_CLIENT_INFO"
-
-    invoke-virtual {p2, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz p2, :cond_2
-
-    goto :goto_1
-
-    :cond_2
-    :goto_0
-    const/4 v1, -0x1
-
-    :goto_1
-    const-string p2, "DualDARPolicy"
-
-    const-string/jumbo v0, "dual_dar_response"
-
-    if-eqz v1, :cond_5
-
-    if-eq v1, v3, :cond_3
-
-    return-object p1
-
-    :cond_3
-    :try_start_1
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    if-nez p1, :cond_4
-
-    invoke-static {p2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object p1
-
-    invoke-static {p1}, Lcom/samsung/android/knox/ddar/IDualDARPolicy$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    :cond_4
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    invoke-static {p1}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p1
-
-    new-instance p2, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda1;
-
-    invoke-direct {p2, p0, p3}, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;Landroid/os/Bundle;)V
-
-    invoke-virtual {p1, p2}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance p1, Landroid/os/Bundle;
-
-    invoke-direct {p1}, Landroid/os/Bundle;-><init>()V
-
-    invoke-virtual {p0, p1}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/os/Bundle;
-
-    invoke-virtual {p0, v0, v3}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    return-object p0
-
-    :cond_5
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    if-nez v1, :cond_6
-
-    invoke-static {p2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object p2
-
-    invoke-static {p2}, Lcom/samsung/android/knox/ddar/IDualDARPolicy$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    move-result-object p2
-
-    iput-object p2, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    :cond_6
-    iget-object p2, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    invoke-static {p2}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p2
-
-    new-instance v1, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda0;
-
-    invoke-direct {v1, p0, p3}, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;Landroid/os/Bundle;)V
-
-    invoke-virtual {p2, v1}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    invoke-virtual {p1, v0, v3}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-
-    return-object p1
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/proxy/ProxyAgentWrapper$1.smali b/smali/com/android/server/knox/dar/ddar/proxy/ProxyAgentWrapper$1.smali
index 6c30fdfb1..ab1018e51 100644
--- a/smali/com/android/server/knox/dar/ddar/proxy/ProxyAgentWrapper$1.smali
+++ b/smali/com/android/server/knox/dar/ddar/proxy/ProxyAgentWrapper$1.smali
@@ -158,7 +158,29 @@
 
     new-array v2, v1, [Ljava/lang/Object;
 
-    invoke-static {p1, v0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->v(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+
+    move-result-object v0
+
+    const-string v2, "KnoxService::ProxyAgentWrapper: "
+
+    const-string v3, "\n"
+
+    invoke-static {v2, v0, v3}, Lcom/android/internal/util/jobs/XmlUtils$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
+
+    move-result-object v2
+
+    const-class v3, Lcom/android/server/knox/dar/ddar/DDLog$Logger;
+
+    monitor-enter v3
+
+    monitor-exit v3
+
+    const-string v3, ""
+
+    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-static {p1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     iget-object p1, p0, Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentWrapper$1;->this$0:Lcom/android/server/knox/dar/ddar/proxy/ProxyAgentWrapper;
 
diff --git a/smali/com/android/server/knox/dar/ddar/proxy/SystemProxyAgent.smali b/smali/com/android/server/knox/dar/ddar/proxy/SystemProxyAgent.smali
index b0614b087..45006ae41 100644
--- a/smali/com/android/server/knox/dar/ddar/proxy/SystemProxyAgent.smali
+++ b/smali/com/android/server/knox/dar/ddar/proxy/SystemProxyAgent.smali
@@ -7,22 +7,8 @@
 .field public static mInstance:Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
 
 
-# instance fields
-.field public final mContext:Landroid/content/Context;
-
-
 # direct methods
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 0
-
-    invoke-direct {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mContext:Landroid/content/Context;
-
-    return-void
-.end method
-
-.method public static declared-synchronized getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
+.method public static declared-synchronized getInstance()Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
     .locals 2
 
     const-class v0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
@@ -36,26 +22,26 @@
 
     new-instance v1, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
 
-    invoke-direct {v1, p0}, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;-><init>(Landroid/content/Context;)V
+    invoke-direct {v1}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;-><init>()V
 
     sput-object v1, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mInstance:Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
 
     goto :goto_0
 
     :catchall_0
-    move-exception p0
+    move-exception v1
 
     goto :goto_1
 
     :cond_0
     :goto_0
-    sget-object p0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mInstance:Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
+    sget-object v1, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mInstance:Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     monitor-exit v0
 
-    return-object p0
+    return-object v1
 
     :goto_1
     :try_start_1
@@ -63,7 +49,7 @@
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    throw p0
+    throw v1
 .end method
 
 
diff --git a/smali/com/android/server/knox/dar/ddar/ta/TAProxy$TAInfo.smali b/smali/com/android/server/knox/dar/ddar/ta/TAProxy$TAInfo.smali
deleted file mode 100644
index 551825771..000000000
--- a/smali/com/android/server/knox/dar/ddar/ta/TAProxy$TAInfo.smali
+++ /dev/null
@@ -1,17 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public maxSendCmdSize:I
-
-.field public ta:Lcom/android/server/knox/dar/ddar/ta/TZNative;
-
-.field public taId:I
-
-.field public taProcessName:Ljava/lang/String;
-
-.field public taRootName:Ljava/lang/String;
-
-.field public taTechnology:Ljava/lang/String;
diff --git a/smali/com/android/server/knox/dar/ddar/ta/TAProxy.smali b/smali/com/android/server/knox/dar/ddar/ta/TAProxy.smali
deleted file mode 100644
index fa01e3a76..000000000
--- a/smali/com/android/server/knox/dar/ddar/ta/TAProxy.smali
+++ /dev/null
@@ -1,1012 +0,0 @@
-.class public final Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-.super Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;
-.source "SourceFile"
-
-
-# static fields
-.field public static mInstance:Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-
-
-# instance fields
-.field public iSehDdar:Lvendor/samsung/hardware/tlc/ddar/ISehDdar;
-
-.field public mTAMap:Ljava/util/Map;
-
-
-# virtual methods
-.method public final loadTARequest(Landroid/os/Bundle;)Z
-    .locals 11
-
-    const/4 v1, 0x0
-
-    new-array v0, v1, [Ljava/lang/Object;
-
-    const-string/jumbo v2, "loadTARequest called"
-
-    const-string/jumbo v3, "TAProxy"
-
-    invoke-static {v3, v2, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const-string/jumbo v0, "TA_ID"
-
-    invoke-virtual {p1, v0}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v0
-
-    const-string/jumbo v2, "TA_FD"
-
-    invoke-virtual {p1, v2}, Landroid/os/Bundle;->getParcelable(Ljava/lang/String;)Landroid/os/Parcelable;
-
-    move-result-object v2
-
-    check-cast v2, Landroid/os/ParcelFileDescriptor;
-
-    const-string/jumbo v4, "TA_FD_OFFSET"
-
-    invoke-virtual {p1, v4}, Landroid/os/Bundle;->getLong(Ljava/lang/String;)J
-
-    move-result-wide v7
-
-    const-string/jumbo v4, "TA_FD_SIZE"
-
-    invoke-virtual {p1, v4}, Landroid/os/Bundle;->getLong(Ljava/lang/String;)J
-
-    move-result-wide v9
-
-    new-array p1, v1, [Ljava/lang/Object;
-
-    const-string/jumbo v4, "TAProxy::loadTA"
-
-    invoke-static {v3, v4, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    if-eqz v2, :cond_0
-
-    invoke-virtual {v2}, Landroid/os/ParcelFileDescriptor;->getFd()I
-
-    move-result p1
-
-    :goto_0
-    move v6, p1
-
-    goto :goto_1
-
-    :cond_0
-    const/4 p1, -0x1
-
-    goto :goto_0
-
-    :goto_1
-    const-string/jumbo p1, "TA fd="
-
-    const-string v4, " offset="
-
-    invoke-static {v6, p1, v7, v8, v4}, Lcom/android/server/accessibility/AbstractAccessibilityServiceConnection$$ExternalSyntheticOutline0;->m(ILjava/lang/String;JLjava/lang/String;)Ljava/lang/StringBuilder;
-
-    move-result-object p1
-
-    const-string v4, " size="
-
-    invoke-virtual {p1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1, v9, v10}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array v4, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, p1, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :try_start_0
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mTAMap:Ljava/util/Map;
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    check-cast p1, Ljava/util/HashMap;
-
-    invoke-virtual {p1, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;
-
-    if-nez p1, :cond_1
-
-    const-string/jumbo p0, "TAProxy::loadTA failed. TAInfo is null on Map."
-
-    new-array p1, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-eqz v2, :cond_3
-
-    :try_start_1
-    invoke-virtual {v2}, Landroid/os/ParcelFileDescriptor;->close()V
-    :try_end_1
-    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0
-
-    return v1
-
-    :catch_0
-    move-exception v0
-
-    move-object p0, v0
-
-    invoke-virtual {p0}, Ljava/io/IOException;->printStackTrace()V
-
-    goto :goto_2
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_3
-
-    :cond_1
-    :try_start_2
-    iget-object v5, p1, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->ta:Lcom/android/server/knox/dar/ddar/ta/TZNative;
-
-    invoke-virtual/range {v5 .. v10}, Lcom/android/server/knox/dar/ddar/ta/TZNative;->loadTA(IJJ)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_2
-
-    const/4 p1, 0x1
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->updateServiceHolder(Z)V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    :cond_2
-    if-eqz v2, :cond_3
-
-    :try_start_3
-    invoke-virtual {v2}, Landroid/os/ParcelFileDescriptor;->close()V
-    :try_end_3
-    .catch Ljava/io/IOException; {:try_start_3 .. :try_end_3} :catch_0
-
-    :cond_3
-    :goto_2
-    return v1
-
-    :goto_3
-    if-eqz v2, :cond_4
-
-    :try_start_4
-    invoke-virtual {v2}, Landroid/os/ParcelFileDescriptor;->close()V
-    :try_end_4
-    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_1
-
-    goto :goto_4
-
-    :catch_1
-    move-exception v0
-
-    move-object p1, v0
-
-    invoke-virtual {p1}, Ljava/io/IOException;->printStackTrace()V
-
-    :cond_4
-    :goto_4
-    throw p0
-.end method
-
-.method public final onMessage(ILjava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
-    .locals 5
-
-    const-string/jumbo p1, "onMessage() "
-
-    const/4 v0, 0x0
-
-    new-array v1, v0, [Ljava/lang/Object;
-
-    const-string/jumbo v2, "TAProxy"
-
-    const-string/jumbo v3, "enforceCallingUser"
-
-    invoke-static {v2, v3, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v1
-
-    invoke-static {v1}, Landroid/os/UserHandle;->getAppId(I)I
-
-    move-result v3
-
-    const/16 v4, 0x1482
-
-    if-ne v3, v4, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    invoke-static {v1}, Landroid/os/UserHandle;->getAppId(I)I
-
-    move-result v1
-
-    invoke-static {}, Landroid/os/Process;->myUid()I
-
-    move-result v3
-
-    if-ne v1, v3, :cond_6
-
-    :goto_0
-    :try_start_0
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array v1, v0, [Ljava/lang/Object;
-
-    invoke-static {v2, p1, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-instance p1, Landroid/os/Bundle;
-
-    invoke-direct {p1}, Landroid/os/Bundle;-><init>()V
-
-    invoke-virtual {p2}, Ljava/lang/String;->hashCode()I
-
-    move-result v1
-
-    const/4 v2, 0x2
-
-    const/4 v3, 0x3
-
-    const/4 v4, 0x1
-
-    sparse-switch v1, :sswitch_data_0
-
-    goto :goto_1
-
-    :sswitch_0
-    const-string/jumbo v0, "PROCESS_COMMAND"
-
-    invoke-virtual {p2, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    move v0, v3
-
-    goto :goto_2
-
-    :sswitch_1
-    const-string v0, "LOAD_TA"
-
-    invoke-virtual {p2, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    move v0, v4
-
-    goto :goto_2
-
-    :sswitch_2
-    const-string/jumbo v0, "UNLOAD_TA"
-
-    invoke-virtual {p2, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    move v0, v2
-
-    goto :goto_2
-
-    :sswitch_3
-    const-string/jumbo v1, "SETUP_TA"
-
-    invoke-virtual {p2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p2
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz p2, :cond_1
-
-    goto :goto_2
-
-    :cond_1
-    :goto_1
-    const/4 v0, -0x1
-
-    :goto_2
-    const-string/jumbo p2, "dual_dar_response"
-
-    if-eqz v0, :cond_5
-
-    if-eq v0, v4, :cond_4
-
-    if-eq v0, v2, :cond_3
-
-    if-eq v0, v3, :cond_2
-
-    return-object p1
-
-    :cond_2
-    :try_start_1
-    invoke-virtual {p0, p3}, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->processCommandRequest(Landroid/os/Bundle;)Landroid/os/Bundle;
-
-    move-result-object p0
-
-    invoke-virtual {p1, p2, p0}, Landroid/os/Bundle;->putBundle(Ljava/lang/String;Landroid/os/Bundle;)V
-
-    return-object p1
-
-    :cond_3
-    invoke-virtual {p0, p3}, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->unloadTARequest(Landroid/os/Bundle;)V
-
-    invoke-virtual {p1, p2, v4}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    return-object p1
-
-    :cond_4
-    invoke-virtual {p0, p3}, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->loadTARequest(Landroid/os/Bundle;)Z
-
-    move-result p0
-
-    invoke-virtual {p1, p2, p0}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    return-object p1
-
-    :cond_5
-    invoke-virtual {p0, p3}, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->setupTARequest(Landroid/os/Bundle;)V
-
-    invoke-virtual {p1, p2, v4}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-
-    return-object p1
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    const/4 p0, 0x0
-
-    return-object p0
-
-    :cond_6
-    new-instance p0, Ljava/lang/SecurityException;
-
-    const-string p1, "Can only be called by system user"
-
-    invoke-direct {p0, p1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    :sswitch_data_0
-    .sparse-switch
-        -0x7bc5cc71 -> :sswitch_3
-        0x203147ad -> :sswitch_2
-        0x3edcc066 -> :sswitch_1
-        0x632dfd3b -> :sswitch_0
-    .end sparse-switch
-.end method
-
-.method public final processCommandRequest(Landroid/os/Bundle;)Landroid/os/Bundle;
-    .locals 9
-
-    const/4 v0, 0x0
-
-    new-array v1, v0, [Ljava/lang/Object;
-
-    const-string/jumbo v2, "processCommandRequest called"
-
-    const-string/jumbo v3, "TAProxy"
-
-    invoke-static {v3, v2, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const-string/jumbo v1, "TA_ID"
-
-    invoke-virtual {p1, v1}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v1
-
-    new-instance v2, Landroid/os/Bundle;
-
-    invoke-direct {v2}, Landroid/os/Bundle;-><init>()V
-
-    new-instance v4, Lcom/android/server/knox/dar/ddar/ta/TACommandRequest;
-
-    invoke-direct {v4}, Lcom/android/server/knox/dar/ddar/ta/TACommandRequest;-><init>()V
-
-    const-string/jumbo v5, "TA_VERSION"
-
-    invoke-virtual {p1, v5}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v5
-
-    const-string/jumbo v6, "TA_MAGICNUM"
-
-    invoke-virtual {p1, v6}, Landroid/os/Bundle;->getByteArray(Ljava/lang/String;)[B
-
-    move-result-object v6
-
-    const-string/jumbo v7, "TA_CMD_ID"
-
-    invoke-virtual {p1, v7}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v7
-
-    const-string/jumbo v8, "TA_CMD_DATA"
-
-    invoke-virtual {p1, v8}, Landroid/os/Bundle;->getByteArray(Ljava/lang/String;)[B
-
-    move-result-object p1
-
-    invoke-virtual {v4, v5, v6, v7, p1}, Lcom/android/server/knox/dar/ddar/ta/TACommandRequest;->init(I[BI[B)V
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "TAProxy::processTACommand: request = "
-
-    invoke-direct {p1, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    const-string v5, "; request.mCommandId = "
-
-    invoke-virtual {p1, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget v5, v4, Lcom/android/server/knox/dar/ddar/ta/TACommandRequest;->mCommandId:I
-
-    invoke-virtual {p1, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v5, "; this.mTAId = "
-
-    invoke-virtual {p1, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mTAMap:Ljava/util/Map;
-
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    check-cast p0, Ljava/util/HashMap;
-
-    invoke-virtual {p0, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->ta:Lcom/android/server/knox/dar/ddar/ta/TZNative;
-
-    invoke-virtual {p0, v4}, Lcom/android/server/knox/dar/ddar/ta/TZNative;->processTACommand(Lcom/android/server/knox/dar/ddar/ta/TACommandRequest;)Lcom/android/server/knox/dar/ddar/ta/TACommandResponse;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    const-string/jumbo p1, "TA_RESP_CODE"
-
-    iget v0, p0, Lcom/android/server/knox/dar/ddar/ta/TACommandResponse;->mResponseCode:I
-
-    invoke-virtual {v2, p1, v0}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    const-string/jumbo p1, "TA_ERROR_MSG"
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/ta/TACommandResponse;->mErrorMsg:Ljava/lang/String;
-
-    invoke-virtual {v2, p1, v0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    const-string/jumbo p1, "TA_RESPDATA"
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/ta/TACommandResponse;->mResponse:[B
-
-    invoke-virtual {v2, p1, p0}, Landroid/os/Bundle;->putByteArray(Ljava/lang/String;[B)V
-
-    :cond_0
-    return-object v2
-.end method
-
-.method public final setupTARequest(Landroid/os/Bundle;)V
-    .locals 14
-
-    const/4 v0, 0x0
-
-    new-array v1, v0, [Ljava/lang/Object;
-
-    const-string/jumbo v2, "setupTARequest called"
-
-    const-string/jumbo v3, "TAProxy"
-
-    invoke-static {v3, v2, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const-string v1, "ALL_TAS"
-
-    invoke-virtual {p1, v1}, Landroid/os/Bundle;->getParcelableArrayList(Ljava/lang/String;)Ljava/util/ArrayList;
-
-    move-result-object p1
-
-    move v1, v0
-
-    :goto_0
-    invoke-interface {p1}, Ljava/util/List;->size()I
-
-    move-result v2
-
-    if-ge v1, v2, :cond_1
-
-    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Landroid/os/Bundle;
-
-    const-string/jumbo v4, "TA_ID"
-
-    invoke-virtual {v2, v4}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v4
-
-    iget-object v5, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mTAMap:Ljava/util/Map;
-
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v6
-
-    check-cast v5, Ljava/util/HashMap;
-
-    invoke-virtual {v5, v6}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z
-
-    move-result v5
-
-    if-nez v5, :cond_0
-
-    new-instance v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;
-
-    invoke-direct {v5}, Ljava/lang/Object;-><init>()V
-
-    iput v4, v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->taId:I
-
-    const-string/jumbo v4, "TA_TECHNOLOGY"
-
-    invoke-virtual {v2, v4}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v4
-
-    iput-object v4, v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->taTechnology:Ljava/lang/String;
-
-    const-string/jumbo v4, "TA_ROOT_NAME"
-
-    invoke-virtual {v2, v4}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v4
-
-    iput-object v4, v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->taRootName:Ljava/lang/String;
-
-    const-string/jumbo v4, "TA_PROCESS_NAME"
-
-    invoke-virtual {v2, v4}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v4
-
-    iput-object v4, v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->taProcessName:Ljava/lang/String;
-
-    const-string/jumbo v4, "TA_SEND_CMD_SIZE"
-
-    invoke-virtual {v2, v4}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v4
-
-    iput v4, v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->maxSendCmdSize:I
-
-    const-string/jumbo v4, "TA_RECV_RESP_SIZE"
-
-    invoke-virtual {v2, v4}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result v2
-
-    new-instance v4, Lcom/android/server/knox/dar/ddar/ta/TZNative;
-
-    iget v6, v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->taId:I
-
-    iget-object v7, v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->taTechnology:Ljava/lang/String;
-
-    iget-object v8, v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->taRootName:Ljava/lang/String;
-
-    iget-object v9, v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->taProcessName:Ljava/lang/String;
-
-    iget v10, v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->maxSendCmdSize:I
-
-    invoke-direct {v4}, Ljava/lang/Object;-><init>()V
-
-    const-string/jumbo v11, "TZNative constructor: taId = "
-
-    invoke-static {v6, v11}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v11
-
-    new-array v12, v0, [Ljava/lang/Object;
-
-    const-string v13, "DualDAR:TZNative"
-
-    invoke-static {v13, v11, v12}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iput v6, v4, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mTAId:I
-
-    const-wide/16 v11, 0x0
-
-    iput-wide v11, v4, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mDDARTZNativePtr_:J
-
-    iput v10, v4, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mSendBufSize:I
-
-    iput v2, v4, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mRecvBufSize:I
-
-    iput-object v7, v4, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mTATechnology:Ljava/lang/String;
-
-    iput-object v8, v4, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mRootName:Ljava/lang/String;
-
-    iput-object v9, v4, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mProcessName:Ljava/lang/String;
-
-    iput-boolean v0, v4, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mIsLoaded:Z
-
-    iput-object v4, v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->ta:Lcom/android/server/knox/dar/ddar/ta/TZNative;
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mTAMap:Ljava/util/Map;
-
-    iget v4, v5, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->taId:I
-
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v4
-
-    check-cast v2, Ljava/util/HashMap;
-
-    invoke-virtual {v2, v4, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    :cond_0
-    add-int/lit8 v1, v1, 0x1
-
-    goto/16 :goto_0
-
-    :cond_1
-    const-string/jumbo p0, "setupTARequest completed"
-
-    new-array p1, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return-void
-.end method
-
-.method public final unloadTARequest(Landroid/os/Bundle;)V
-    .locals 8
-
-    const-string/jumbo v0, "TAProxy"
-
-    const-string/jumbo v1, "unloadTARequest called"
-
-    const/4 v2, 0x0
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const-string/jumbo v0, "TA_ID"
-
-    invoke-virtual {p1, v0}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p1
-
-    const-string/jumbo v0, "TAProxy"
-
-    const-string/jumbo v1, "TAProxy::unloadTA"
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mTAMap:Ljava/util/Map;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    check-cast v0, Ljava/util/HashMap;
-
-    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;
-
-    if-nez v0, :cond_0
-
-    const-string/jumbo p0, "TAProxy"
-
-    const-string/jumbo p1, "TAProxy::unloadTA failed. TAInfo is null on Map."
-
-    new-array v0, v2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto :goto_2
-
-    :cond_0
-    iget-object v0, v0, Lcom/android/server/knox/dar/ddar/ta/TAProxy$TAInfo;->ta:Lcom/android/server/knox/dar/ddar/ta/TZNative;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v1, "TZNative::unloadTA called for TA that is not loaded. Call Ignored: ta loaded: "
-
-    const-class v3, Lcom/android/server/knox/dar/ddar/ta/TZNative;
-
-    monitor-enter v3
-
-    :try_start_0
-    iget-wide v4, v0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mDDARTZNativePtr_:J
-
-    const-wide/16 v6, 0x0
-
-    cmp-long v4, v4, v6
-
-    if-eqz v4, :cond_2
-
-    iget-boolean v4, v0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mIsLoaded:Z
-
-    if-nez v4, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    iput-boolean v2, v0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mIsLoaded:Z
-
-    monitor-exit v3
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-virtual {v0}, Lcom/android/server/knox/dar/ddar/ta/TZNative;->nativeDDARDestroyTLCommunicationContext()V
-
-    iput-wide v6, v0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mDDARTZNativePtr_:J
-
-    const-string v0, "DualDAR:TZNative"
-
-    const-string/jumbo v1, "TZNative::unloadTA called"
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_3
-
-    :cond_2
-    :goto_0
-    :try_start_1
-    const-string v4, "DualDAR:TZNative"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-boolean v0, v0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mIsLoaded:Z
-
-    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v1, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, v0, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    monitor-exit v3
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :goto_1
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mTAMap:Ljava/util/Map;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    check-cast v0, Ljava/util/HashMap;
-
-    invoke-virtual {v0, p1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mTAMap:Ljava/util/Map;
-
-    check-cast p1, Ljava/util/HashMap;
-
-    invoke-virtual {p1}, Ljava/util/HashMap;->size()I
-
-    move-result p1
-
-    if-gtz p1, :cond_3
-
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->updateServiceHolder(Z)V
-
-    :cond_3
-    :goto_2
-    return-void
-
-    :goto_3
-    :try_start_2
-    monitor-exit v3
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-.end method
-
-.method public final updateServiceHolder(Z)V
-    .locals 7
-
-    const-string v0, ", "
-
-    const-string/jumbo v1, "TAProxy"
-
-    const-string/jumbo v2, "vendor.samsung.hardware.tlc.ddar.ISehDdar/default"
-
-    const-string/jumbo v3, "updateServiceHolder: "
-
-    const/4 v4, 0x0
-
-    :try_start_0
-    const-string v5, "31"
-
-    invoke-static {v5}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
-
-    move-result v5
-
-    const/16 v6, 0x22
-
-    if-lt v5, v6, :cond_5
-
-    invoke-static {v2}, Landroid/os/ServiceManager;->isDeclared(Ljava/lang/String;)Z
-
-    move-result v5
-
-    new-instance v6, Ljava/lang/StringBuilder;
-
-    invoke-direct {v6, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->iSehDdar:Lvendor/samsung/hardware/tlc/ddar/ISehDdar;
-
-    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v3, v4, [Ljava/lang/Object;
-
-    invoke-static {v1, v0, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    if-nez v5, :cond_0
-
-    goto :goto_3
-
-    :cond_0
-    const/4 v0, 0x0
-
-    if-eqz p1, :cond_4
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->iSehDdar:Lvendor/samsung/hardware/tlc/ddar/ISehDdar;
-
-    if-eqz p1, :cond_1
-
-    goto :goto_1
-
-    :cond_1
-    invoke-static {v2}, Landroid/os/ServiceManager;->waitForService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object p1
-
-    sget v2, Lvendor/samsung/hardware/tlc/ddar/ISehDdar$Stub;->$r8$clinit:I
-
-    if-nez p1, :cond_2
-
-    goto :goto_0
-
-    :cond_2
-    sget-object v0, Lvendor/samsung/hardware/tlc/ddar/ISehDdar;->DESCRIPTOR:Ljava/lang/String;
-
-    invoke-interface {p1, v0}, Landroid/os/IBinder;->queryLocalInterface(Ljava/lang/String;)Landroid/os/IInterface;
-
-    move-result-object v0
-
-    if-eqz v0, :cond_3
-
-    instance-of v2, v0, Lvendor/samsung/hardware/tlc/ddar/ISehDdar;
-
-    if-eqz v2, :cond_3
-
-    check-cast v0, Lvendor/samsung/hardware/tlc/ddar/ISehDdar;
-
-    goto :goto_0
-
-    :cond_3
-    new-instance v0, Lvendor/samsung/hardware/tlc/ddar/ISehDdar$Stub$Proxy;
-
-    invoke-direct {v0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, v0, Lvendor/samsung/hardware/tlc/ddar/ISehDdar$Stub$Proxy;->mRemote:Landroid/os/IBinder;
-
-    :goto_0
-    move-object p1, v0
-
-    :goto_1
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->iSehDdar:Lvendor/samsung/hardware/tlc/ddar/ISehDdar;
-
-    return-void
-
-    :catch_0
-    move-exception p0
-
-    goto :goto_2
-
-    :cond_4
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->iSehDdar:Lvendor/samsung/hardware/tlc/ddar/ISehDdar;
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-void
-
-    :goto_2
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "updateServiceHolder failed: "
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v4, [Ljava/lang/Object;
-
-    invoke-static {v1, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_5
-    :goto_3
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/ddar/ta/TZNative.smali b/smali/com/android/server/knox/dar/ddar/ta/TZNative.smali
deleted file mode 100644
index 97f4f2942..000000000
--- a/smali/com/android/server/knox/dar/ddar/ta/TZNative.smali
+++ /dev/null
@@ -1,229 +0,0 @@
-.class Lcom/android/server/knox/dar/ddar/ta/TZNative;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public mDDARTZNativePtr_:J
-
-.field public mIsLoaded:Z
-
-.field public mProcessName:Ljava/lang/String;
-
-.field public mRecvBufSize:I
-
-.field public mRootName:Ljava/lang/String;
-
-.field public mSendBufSize:I
-
-.field public mTAId:I
-
-.field public mTATechnology:Ljava/lang/String;
-
-
-# direct methods
-.method private native nativeDDARProcessTACommand(Lcom/android/server/knox/dar/ddar/ta/TACommandRequest;Lcom/android/server/knox/dar/ddar/ta/TACommandResponse;)Z
-.end method
-
-
-# virtual methods
-.method public final loadTA(IJJ)Z
-    .locals 14
-
-    move-wide/from16 v1, p2
-
-    move-wide/from16 v3, p4
-
-    iget-wide v5, p0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mDDARTZNativePtr_:J
-
-    const-wide/16 v10, 0x0
-
-    cmp-long v5, v5, v10
-
-    const/4 v12, 0x1
-
-    const/4 v13, 0x0
-
-    if-eqz v5, :cond_0
-
-    const-string v0, "DualDAR:TZNative"
-
-    const-string/jumbo v1, "TZNative::loadTA called for TA that is already loaded. Call Ignored"
-
-    new-array v2, v13, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v12
-
-    :cond_0
-    const-wide/32 v5, 0x7fffffff
-
-    cmp-long v7, v1, v5
-
-    if-gtz v7, :cond_3
-
-    cmp-long v5, v3, v5
-
-    if-lez v5, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    long-to-int v2, v1
-
-    long-to-int v3, v3
-
-    iget v4, p0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mTAId:I
-
-    iget v5, p0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mSendBufSize:I
-
-    iget v6, p0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mRecvBufSize:I
-
-    iget-object v7, p0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mTATechnology:Ljava/lang/String;
-
-    iget-object v8, p0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mRootName:Ljava/lang/String;
-
-    iget-object v9, p0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mProcessName:Ljava/lang/String;
-
-    move-object v0, p0
-
-    move v1, p1
-
-    invoke-virtual/range {v0 .. v9}, Lcom/android/server/knox/dar/ddar/ta/TZNative;->nativeDDARCreateTLCommunicationContext(IIIIIILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)J
-
-    move-result-wide v1
-
-    iput-wide v1, p0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mDDARTZNativePtr_:J
-
-    cmp-long v1, v1, v10
-
-    if-nez v1, :cond_2
-
-    const-string v0, "DualDAR:TZNative"
-
-    const-string v1, "Error: nativeDDARCreateTLCommunicationContext failed"
-
-    new-array v2, v13, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v13
-
-    :cond_2
-    const-class v1, Lcom/android/server/knox/dar/ddar/ta/TZNative;
-
-    monitor-enter v1
-
-    :try_start_0
-    iput-boolean v12, p0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mIsLoaded:Z
-
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    const-string v1, "DualDAR:TZNative"
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "TZNative::loadTA: mDDARTZNativePtr_ = "
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-wide v3, p0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mDDARTZNativePtr_:J
-
-    invoke-virtual {v2, v3, v4}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v2, v13, [Ljava/lang/Object;
-
-    invoke-static {v1, v0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v12
-
-    :catchall_0
-    move-exception v0
-
-    :try_start_1
-    monitor-exit v1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw v0
-
-    :cond_3
-    :goto_0
-    const-string v0, "DualDAR:TZNative"
-
-    const-string/jumbo v1, "loadTA: cannot get ta offset or size"
-
-    new-array v2, v13, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return v13
-.end method
-
-.method public native nativeDDARCreateTLCommunicationContext(IIIIIILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)J
-.end method
-
-.method public native nativeDDARDestroyTLCommunicationContext()V
-.end method
-
-.method public final processTACommand(Lcom/android/server/knox/dar/ddar/ta/TACommandRequest;)Lcom/android/server/knox/dar/ddar/ta/TACommandResponse;
-    .locals 4
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "TZNative::processTACommand: request = "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    const-string v1, "; mDDARTZNativePtr_ = "
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget-wide v1, p0, Lcom/android/server/knox/dar/ddar/ta/TZNative;->mDDARTZNativePtr_:J
-
-    invoke-virtual {v0, v1, v2}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v1, 0x0
-
-    new-array v2, v1, [Ljava/lang/Object;
-
-    const-string v3, "DualDAR:TZNative"
-
-    invoke-static {v3, v0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-instance v0, Lcom/android/server/knox/dar/ddar/ta/TACommandResponse;
-
-    invoke-direct {v0}, Lcom/android/server/knox/dar/ddar/ta/TACommandResponse;-><init>()V
-
-    invoke-direct {p0, p1, v0}, Lcom/android/server/knox/dar/ddar/ta/TZNative;->nativeDDARProcessTACommand(Lcom/android/server/knox/dar/ddar/ta/TACommandRequest;Lcom/android/server/knox/dar/ddar/ta/TACommandResponse;)Z
-
-    move-result p0
-
-    if-nez p0, :cond_0
-
-    const-string/jumbo p0, "TZNative::processTACommand: Error: nativeDDARProcessTACommand returned failure"
-
-    new-array p1, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const/4 p0, 0x0
-
-    return-object p0
-
-    :cond_0
-    return-object v0
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SDPLog.smali b/smali/com/android/server/knox/dar/sdp/SDPLog.smali
index ae3497cd8..7dfc7068a 100644
--- a/smali/com/android/server/knox/dar/sdp/SDPLog.smali
+++ b/smali/com/android/server/knox/dar/sdp/SDPLog.smali
@@ -193,48 +193,38 @@
 .end method
 
 .method public static i(Ljava/lang/String;)V
-    .locals 2
-
-    new-instance v0, Ljava/lang/Throwable;
+    .locals 19
 
-    invoke-direct {v0}, Ljava/lang/Throwable;-><init>()V
+    move-object/from16 v0, p0
 
-    const/4 v1, 0x0
+    new-instance v1, Ljava/lang/Throwable;
 
-    invoke-static {v1, p0, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
+    invoke-direct {v1}, Ljava/lang/Throwable;-><init>()V
 
-    return-void
-.end method
-
-.method public static i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
-    .locals 19
-
-    move-object/from16 v0, p1
-
-    new-instance v1, Ljava/lang/StringBuilder;
+    new-instance v2, Ljava/lang/StringBuilder;
 
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V
 
     invoke-static {}, Lcom/android/server/knox/dar/sdp/SDPLogUtil;->getCurrentTime()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object v3
 
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string v2, ",I,"
+    const-string v3, ",I,"
 
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v1
+    move-result-object v2
 
     :try_start_0
-    invoke-virtual/range {p2 .. p2}, Ljava/lang/Throwable;->getStackTrace()[Ljava/lang/StackTraceElement;
+    invoke-virtual {v1}, Ljava/lang/Throwable;->getStackTrace()[Ljava/lang/StackTraceElement;
 
-    move-result-object v2
+    move-result-object v1
 
-    array-length v3, v2
+    array-length v3, v1
     :try_end_0
     .catch Ljava/lang/ArrayIndexOutOfBoundsException; {:try_start_0 .. :try_end_0} :catch_0
 
@@ -251,7 +241,7 @@
 
     invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
 
-    aget-object v7, v2, v4
+    aget-object v7, v1, v4
 
     invoke-virtual {v7}, Ljava/lang/StackTraceElement;->getClassName()Ljava/lang/String;
 
@@ -261,7 +251,7 @@
 
     invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    aget-object v4, v2, v4
+    aget-object v4, v1, v4
 
     invoke-virtual {v4}, Ljava/lang/StackTraceElement;->getMethodName()Ljava/lang/String;
 
@@ -283,7 +273,7 @@
     move-object/from16 v16, v6
 
     :goto_0
-    array-length v3, v2
+    array-length v3, v1
 
     const/4 v4, 0x2
 
@@ -293,7 +283,7 @@
 
     invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
 
-    aget-object v7, v2, v4
+    aget-object v7, v1, v4
 
     invoke-virtual {v7}, Ljava/lang/StackTraceElement;->getClassName()Ljava/lang/String;
 
@@ -303,13 +293,13 @@
 
     invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    aget-object v2, v2, v4
+    aget-object v1, v1, v4
 
-    invoke-virtual {v2}, Ljava/lang/StackTraceElement;->getMethodName()Ljava/lang/String;
+    invoke-virtual {v1}, Ljava/lang/StackTraceElement;->getMethodName()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object v1
 
-    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
@@ -322,45 +312,45 @@
 
     invoke-static {}, Landroid/os/Binder;->getCallingUid()I
 
-    move-result v2
+    move-result v1
 
-    invoke-static {v2}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
+    invoke-static {v1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
 
     move-result-object v10
 
     invoke-static {}, Landroid/os/Binder;->getCallingPid()I
 
-    move-result v2
+    move-result v1
 
-    invoke-static {v2}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
+    invoke-static {v1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
 
     move-result-object v12
 
     invoke-static {}, Landroid/os/Process;->myTid()I
 
-    move-result v2
+    move-result v1
 
-    invoke-static {v2}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
+    invoke-static {v1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
 
     move-result-object v14
 
     invoke-static {}, Landroid/os/Binder;->getCallingUserHandle()Landroid/os/UserHandle;
 
-    move-result-object v2
+    move-result-object v1
 
-    invoke-virtual {v2}, Landroid/os/UserHandle;->getIdentifier()I
+    invoke-virtual {v1}, Landroid/os/UserHandle;->getIdentifier()I
 
-    move-result v2
+    move-result v1
 
-    invoke-static {v2}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
+    invoke-static {v1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
 
     move-result-object v8
 
-    new-instance v2, Ljava/lang/StringBuilder;
+    new-instance v1, Ljava/lang/StringBuilder;
 
-    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     const-string/jumbo v7, "UserId"
 
@@ -382,34 +372,34 @@
 
     move-result-object v3
 
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object v1
     :try_end_1
     .catch Ljava/lang/ArrayIndexOutOfBoundsException; {:try_start_1 .. :try_end_1} :catch_0
 
     goto :goto_1
 
     :catch_0
-    move-object v2, v1
+    move-object v1, v2
 
     :goto_1
     if-nez v0, :cond_2
 
-    filled-new-array {v2}, [Ljava/lang/String;
+    filled-new-array {v1}, [Ljava/lang/String;
 
     move-result-object v1
 
     goto :goto_2
 
     :cond_2
-    invoke-static {v1, v0}, Landroid/net/ConnectivityModuleConnector$$ExternalSyntheticOutline0;->m$1(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
+    invoke-static {v2, v0}, Landroid/net/ConnectivityModuleConnector$$ExternalSyntheticOutline0;->m$1(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object v1
+    move-result-object v2
 
-    filled-new-array {v1, v2}, [Ljava/lang/String;
+    filled-new-array {v2, v1}, [Ljava/lang/String;
 
     move-result-object v1
 
@@ -430,20 +420,12 @@
     goto :goto_3
 
     :cond_3
-    if-eqz v0, :cond_5
-
-    if-eqz p0, :cond_4
-
-    move-object/from16 v1, p0
+    if-eqz v0, :cond_4
 
-    goto :goto_4
-
-    :cond_4
     const-string/jumbo v1, "SDPLog"
 
-    :goto_4
     invoke-static {v1, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_5
+    :cond_4
     return-void
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10.smali
new file mode 100644
index 000000000..16417ef77
--- /dev/null
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10.smali
@@ -0,0 +1,361 @@
+.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;
+.super Ljava/lang/Object;
+.source "qb/102434624 4ec8f6d2813f753a220c00d05e2aa013ded863b1967e4bb65f3969ed08f5cc72"
+
+# interfaces
+.implements Ljava/lang/Runnable;
+
+
+# instance fields
+.field public final synthetic $r8$classId:I
+
+.field public final synthetic f$0:Ljava/lang/Object;
+
+.field public final synthetic f$1:I
+
+
+# direct methods
+.method public synthetic constructor <init>(IILjava/lang/Object;)V
+    .locals 0
+
+    iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->$r8$classId:I
+
+    iput-object p3, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$0:Ljava/lang/Object;
+
+    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$1:I
+
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+
+    return-void
+.end method
+
+
+# virtual methods
+.method public final run()V
+    .locals 12
+
+    iget v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->$r8$classId:I
+
+    packed-switch v0, :pswitch_data_0
+
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$0:Ljava/lang/Object;
+
+    check-cast v0, Lcom/android/server/locksettings/LockSettingsService$4;
+
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$1:I
+
+    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService$4;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+
+    sget-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+
+    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
+
+    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    invoke-static {}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getUserManagerInternal()Lcom/android/server/pm/UserManagerInternal;
+
+    move-result-object v1
+
+    invoke-virtual {v1, p0}, Lcom/android/server/pm/UserManagerInternal;->getUserProperties(I)Landroid/content/pm/UserProperties;
+
+    move-result-object v1
+
+    if-eqz v1, :cond_0
+
+    invoke-virtual {v1}, Landroid/content/pm/UserProperties;->getAllowStoppingUserWithDelayedLocking()Z
+
+    move-result v1
+
+    if-eqz v1, :cond_0
+
+    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService$4;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+
+    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+
+    invoke-static {v1}, Lcom/android/internal/widget/LockPatternUtils$StrongAuthTracker;->getDefaultFlags(Landroid/content/Context;)I
+
+    move-result v1
+
+    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService$4;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+
+    invoke-virtual {v0, v1, p0}, Lcom/android/server/locksettings/LockSettingsService;->requireStrongAuth(II)V
+
+    :cond_0
+    return-void
+
+    :pswitch_0
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$0:Ljava/lang/Object;
+
+    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$1:I
+
+    sget-boolean v1, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+
+    invoke-virtual {v0, p0}, Lcom/android/server/locksettings/LockSettingsService;->unlockUser(I)V
+
+    return-void
+
+    :pswitch_1
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$0:Ljava/lang/Object;
+
+    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$1:I
+
+    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
+
+    iget-object v2, v1, Lcom/android/server/locksettings/LockSettingsService$Injector;->mContext:Landroid/content/Context;
+
+    invoke-virtual {v2}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+
+    move-result-object v2
+
+    const-string/jumbo v3, "android.hardware.fingerprint"
+
+    invoke-virtual {v2, v3}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z
+
+    move-result v2
+
+    const/4 v3, 0x0
+
+    if-eqz v2, :cond_1
+
+    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService$Injector;->mContext:Landroid/content/Context;
+
+    const-string/jumbo v2, "fingerprint"
+
+    invoke-virtual {v1, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
+
+    move-result-object v1
+
+    check-cast v1, Landroid/hardware/fingerprint/FingerprintManager;
+
+    goto :goto_0
+
+    :cond_1
+    move-object v1, v3
+
+    :goto_0
+    const-string/jumbo v2, "LockSettingsService"
+
+    const-wide/16 v4, 0x2710
+
+    const/4 v6, 0x1
+
+    if-eqz v1, :cond_2
+
+    invoke-virtual {v1}, Landroid/hardware/fingerprint/FingerprintManager;->isHardwareDetected()Z
+
+    move-result v7
+
+    if-eqz v7, :cond_2
+
+    invoke-virtual {v1, p0}, Landroid/hardware/fingerprint/FingerprintManager;->hasEnrolledFingerprints(I)Z
+
+    move-result v7
+
+    if-eqz v7, :cond_2
+
+    new-instance v7, Ljava/util/concurrent/CountDownLatch;
+
+    invoke-direct {v7, v6}, Ljava/util/concurrent/CountDownLatch;-><init>(I)V
+
+    new-instance v8, Lcom/android/server/locksettings/LockSettingsService$6;
+
+    invoke-direct {v8, v7}, Lcom/android/server/locksettings/LockSettingsService$6;-><init>(Ljava/util/concurrent/CountDownLatch;)V
+
+    invoke-virtual {v1, p0, v8}, Landroid/hardware/fingerprint/FingerprintManager;->removeAll(ILandroid/hardware/fingerprint/FingerprintManager$RemovalCallback;)V
+
+    :try_start_0
+    sget-object v1, Ljava/util/concurrent/TimeUnit;->MILLISECONDS:Ljava/util/concurrent/TimeUnit;
+
+    invoke-virtual {v7, v4, v5, v1}, Ljava/util/concurrent/CountDownLatch;->await(JLjava/util/concurrent/TimeUnit;)Z
+    :try_end_0
+    .catch Ljava/lang/InterruptedException; {:try_start_0 .. :try_end_0} :catch_0
+
+    goto :goto_1
+
+    :catch_0
+    move-exception v1
+
+    const-string v7, "Latch interrupted when removing fingerprint"
+
+    invoke-static {v2, v7, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    :cond_2
+    :goto_1
+    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
+
+    iget-object v7, v1, Lcom/android/server/locksettings/LockSettingsService$Injector;->mContext:Landroid/content/Context;
+
+    invoke-virtual {v7}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+
+    move-result-object v7
+
+    const-string/jumbo v8, "android.hardware.biometrics.face"
+
+    invoke-virtual {v7, v8}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z
+
+    move-result v7
+
+    if-eqz v7, :cond_3
+
+    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService$Injector;->mContext:Landroid/content/Context;
+
+    const-string/jumbo v7, "face"
+
+    invoke-virtual {v1, v7}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
+
+    move-result-object v1
+
+    check-cast v1, Landroid/hardware/face/FaceManager;
+
+    goto :goto_2
+
+    :cond_3
+    move-object v1, v3
+
+    :goto_2
+    const-string v7, "Latch interrupted when removing face"
+
+    if-eqz v1, :cond_4
+
+    invoke-virtual {v1}, Landroid/hardware/face/FaceManager;->isHardwareDetected()Z
+
+    move-result v8
+
+    if-eqz v8, :cond_4
+
+    invoke-virtual {v1, p0}, Landroid/hardware/face/FaceManager;->hasEnrolledTemplates(I)Z
+
+    move-result v8
+
+    if-eqz v8, :cond_5
+
+    new-instance v8, Ljava/util/concurrent/CountDownLatch;
+
+    invoke-direct {v8, v6}, Ljava/util/concurrent/CountDownLatch;-><init>(I)V
+
+    new-instance v6, Lcom/android/server/locksettings/LockSettingsService$7;
+
+    invoke-direct {v6, v8}, Lcom/android/server/locksettings/LockSettingsService$7;-><init>(Ljava/util/concurrent/CountDownLatch;)V
+
+    invoke-virtual {v1, p0, v6}, Landroid/hardware/face/FaceManager;->removeAll(ILandroid/hardware/face/FaceManager$RemovalCallback;)V
+
+    :try_start_1
+    sget-object p0, Ljava/util/concurrent/TimeUnit;->MILLISECONDS:Ljava/util/concurrent/TimeUnit;
+
+    invoke-virtual {v8, v4, v5, p0}, Ljava/util/concurrent/CountDownLatch;->await(JLjava/util/concurrent/TimeUnit;)Z
+    :try_end_1
+    .catch Ljava/lang/InterruptedException; {:try_start_1 .. :try_end_1} :catch_1
+
+    goto :goto_3
+
+    :catch_1
+    move-exception p0
+
+    invoke-static {v2, v7, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto :goto_3
+
+    :cond_4
+    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+
+    invoke-virtual {v1}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+
+    move-result-object v1
+
+    const-string/jumbo v8, "com.samsung.android.bio.face"
+
+    invoke-virtual {v1, v8}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z
+
+    move-result v1
+
+    if-eqz v1, :cond_5
+
+    invoke-static {p0}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
+
+    move-result v1
+
+    if-eqz v1, :cond_5
+
+    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+
+    invoke-static {v1}, Lcom/samsung/android/bio/face/SemBioFaceManager;->createInstance(Landroid/content/Context;)Lcom/samsung/android/bio/face/SemBioFaceManager;
+
+    move-result-object v1
+
+    if-eqz v1, :cond_5
+
+    invoke-virtual {v1}, Lcom/samsung/android/bio/face/SemBioFaceManager;->isHardwareDetected()Z
+
+    move-result v8
+
+    if-eqz v8, :cond_5
+
+    invoke-virtual {v1, p0}, Lcom/samsung/android/bio/face/SemBioFaceManager;->hasEnrolledFaces(I)Z
+
+    move-result v8
+
+    if-eqz v8, :cond_5
+
+    invoke-virtual {v1, p0}, Lcom/samsung/android/bio/face/SemBioFaceManager;->setActiveUser(I)V
+
+    new-instance v8, Ljava/util/concurrent/CountDownLatch;
+
+    invoke-direct {v8, v6}, Ljava/util/concurrent/CountDownLatch;-><init>(I)V
+
+    new-instance v6, Landroid/hardware/face/Face;
+
+    const/4 v9, 0x0
+
+    const-wide/16 v10, 0x0
+
+    invoke-direct {v6, v3, v9, v10, v11}, Landroid/hardware/face/Face;-><init>(Ljava/lang/CharSequence;IJ)V
+
+    new-instance v9, Lcom/samsung/android/bio/face/SemBioFace;
+
+    invoke-direct {v9, v6}, Lcom/samsung/android/bio/face/SemBioFace;-><init>(Landroid/hardware/face/Face;)V
+
+    new-instance v6, Lcom/android/server/locksettings/LockSettingsService$8;
+
+    invoke-direct {v6, v8}, Lcom/android/server/locksettings/LockSettingsService$8;-><init>(Ljava/util/concurrent/CountDownLatch;)V
+
+    invoke-virtual {v1, v9, p0, v6}, Lcom/samsung/android/bio/face/SemBioFaceManager;->remove(Lcom/samsung/android/bio/face/SemBioFace;ILcom/samsung/android/bio/face/SemBioFaceManager$RemovalCallback;)V
+
+    :try_start_2
+    sget-object p0, Ljava/util/concurrent/TimeUnit;->MILLISECONDS:Ljava/util/concurrent/TimeUnit;
+
+    invoke-virtual {v8, v4, v5, p0}, Ljava/util/concurrent/CountDownLatch;->await(JLjava/util/concurrent/TimeUnit;)Z
+    :try_end_2
+    .catch Ljava/lang/InterruptedException; {:try_start_2 .. :try_end_2} :catch_2
+
+    goto :goto_3
+
+    :catch_2
+    move-exception p0
+
+    invoke-static {v2, v7, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    :cond_5
+    :goto_3
+    iget-object p0, v0, Lcom/android/server/locksettings/LockSettingsService;->mMaintenanceModeCallback:Lcom/samsung/android/server/pm/mm/MaintenanceModeManager$$ExternalSyntheticLambda16;
+
+    if-eqz p0, :cond_6
+
+    sget-object v1, Ljava/lang/Boolean;->TRUE:Ljava/lang/Boolean;
+
+    invoke-virtual {p0, v1}, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager$$ExternalSyntheticLambda16;->accept(Ljava/lang/Object;)V
+
+    iput-object v3, v0, Lcom/android/server/locksettings/LockSettingsService;->mMaintenanceModeCallback:Lcom/samsung/android/server/pm/mm/MaintenanceModeManager$$ExternalSyntheticLambda16;
+
+    :cond_6
+    return-void
+
+    :pswitch_data_0
+    .packed-switch 0x0
+        :pswitch_1
+        :pswitch_0
+    .end packed-switch
+.end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11.smali
index 85f96e759..01351232f 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11.smali
@@ -3,26 +3,22 @@
 .source "SourceFile"
 
 # interfaces
-.implements Ljava/lang/Runnable;
+.implements Ljava/util/function/Consumer;
 
 
 # instance fields
 .field public final synthetic $r8$classId:I
 
-.field public final synthetic f$0:Ljava/lang/Object;
-
-.field public final synthetic f$1:I
+.field public final synthetic f$0:I
 
 
 # direct methods
-.method public synthetic constructor <init>(IILjava/lang/Object;)V
+.method public synthetic constructor <init>(II)V
     .locals 0
 
     iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->$r8$classId:I
 
-    iput-object p3, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$0:Ljava/lang/Object;
-
-    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$1:I
+    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$0:I
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
@@ -31,331 +27,330 @@
 
 
 # virtual methods
-.method public final run()V
-    .locals 12
+.method public final accept(Ljava/lang/Object;)V
+    .locals 7
 
     iget v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->$r8$classId:I
 
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$0:I
+
     packed-switch v0, :pswitch_data_0
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$0:Ljava/lang/Object;
+    check-cast p1, Lcom/android/server/knox/dar/DarManagerService;
 
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService$4;
+    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$1:I
+    if-eqz p0, :cond_0
 
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService$4;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+    goto/16 :goto_1
 
-    sget-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+    :cond_0
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
+    const-string/jumbo v1, "Save secured escrow data for user "
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-static {}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getUserManagerInternal()Lcom/android/server/pm/UserManagerInternal;
+    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    move-result-object v1
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-virtual {v1, p0}, Lcom/android/server/pm/UserManagerInternal;->getUserProperties(I)Landroid/content/pm/UserProperties;
+    move-result-object v0
 
-    move-result-object v1
+    const-string v1, "DarManagerService"
 
-    if-eqz v1, :cond_0
+    invoke-static {v1, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {v1}, Landroid/content/pm/UserProperties;->getAllowStoppingUserWithDelayedLocking()Z
+    new-instance v0, Ljava/io/File;
 
-    move-result v1
+    invoke-static {p0}, Landroid/os/Environment;->getDataSystemDeDirectory(I)Ljava/io/File;
 
-    if-eqz v1, :cond_0
+    move-result-object v2
 
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService$4;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+    const-string/jumbo v3, "spblob"
 
-    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    invoke-direct {v0, v2, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
 
-    invoke-static {v1}, Lcom/android/internal/widget/LockPatternUtils$StrongAuthTracker;->getDefaultFlags(Landroid/content/Context;)I
+    new-instance v2, Ljava/io/File;
 
-    move-result v1
+    const-wide/16 v3, 0x0
 
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService$4;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    invoke-virtual {v0, v1, p0}, Lcom/android/server/locksettings/LockSettingsService;->requireStrongAuth(II)V
+    move-result-object v5
 
-    :cond_0
-    return-void
+    const-string/jumbo v6, "e0"
 
-    :pswitch_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$0:Ljava/lang/Object;
+    filled-new-array {v5, v6}, [Ljava/lang/Object;
 
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+    move-result-object v5
 
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$1:I
+    const-string v6, "%016x.%s"
 
-    sget-boolean v1, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+    invoke-static {v6, v5}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    invoke-virtual {v0, p0}, Lcom/android/server/locksettings/LockSettingsService;->unlockUser(I)V
+    move-result-object v5
 
-    return-void
+    invoke-direct {v2, v0, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
 
-    :pswitch_1
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$0:Ljava/lang/Object;
+    new-instance v5, Ljava/io/File;
 
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$1:I
+    move-result-object v3
 
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
+    const-string/jumbo v4, "p1"
 
-    iget-object v2, v1, Lcom/android/server/locksettings/LockSettingsService$Injector;->mContext:Landroid/content/Context;
+    filled-new-array {v3, v4}, [Ljava/lang/Object;
 
-    invoke-virtual {v2}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+    move-result-object v3
 
-    move-result-object v2
+    invoke-static {v6, v3}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    const-string/jumbo v3, "android.hardware.fingerprint"
+    move-result-object v3
 
-    invoke-virtual {v2, v3}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z
+    invoke-direct {v5, v0, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
 
-    move-result v2
+    invoke-virtual {v2}, Ljava/io/File;->exists()Z
 
-    const/4 v3, 0x0
+    move-result v0
 
-    if-eqz v2, :cond_1
+    if-eqz v0, :cond_4
 
-    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService$Injector;->mContext:Landroid/content/Context;
+    invoke-virtual {v5}, Ljava/io/File;->exists()Z
 
-    const-string/jumbo v2, "fingerprint"
+    move-result v0
 
-    invoke-virtual {v1, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
+    if-nez v0, :cond_1
 
-    move-result-object v1
+    goto/16 :goto_0
 
-    check-cast v1, Landroid/hardware/fingerprint/FingerprintManager;
+    :cond_1
+    invoke-virtual {v2}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
 
-    goto :goto_0
+    move-result-object v0
 
-    :cond_1
-    move-object v1, v3
+    invoke-static {v0}, Lcom/android/server/knox/dar/DarManagerService;->fileRead(Ljava/lang/String;)[B
 
-    :goto_0
-    const-string/jumbo v2, "LockSettingsService"
+    move-result-object v0
 
-    const-wide/16 v4, 0x2710
+    invoke-virtual {v5}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
 
-    const/4 v6, 0x1
+    move-result-object v3
 
-    if-eqz v1, :cond_2
+    invoke-static {v3}, Lcom/android/server/knox/dar/DarManagerService;->fileRead(Ljava/lang/String;)[B
 
-    invoke-virtual {v1}, Landroid/hardware/fingerprint/FingerprintManager;->isHardwareDetected()Z
+    move-result-object v3
 
-    move-result v7
+    filled-new-array {v0, v3}, [Ljava/lang/Object;
 
-    if-eqz v7, :cond_2
+    move-result-object v4
 
-    invoke-virtual {v1, p0}, Landroid/hardware/fingerprint/FingerprintManager;->hasEnrolledFingerprints(I)Z
+    invoke-static {v4}, Lcom/android/server/knox/dar/SecureUtil;->isAnyoneEmptyHere([Ljava/lang/Object;)Z
 
-    move-result v7
+    move-result v4
 
-    if-eqz v7, :cond_2
+    if-eqz v4, :cond_2
 
-    new-instance v7, Ljava/util/concurrent/CountDownLatch;
+    goto/16 :goto_1
 
-    invoke-direct {v7, v6}, Ljava/util/concurrent/CountDownLatch;-><init>(I)V
+    :cond_2
+    const-string/jumbo v4, "SdpSecureDataKey"
 
-    new-instance v8, Lcom/android/server/locksettings/LockSettingsService$6;
+    invoke-virtual {p1, v4, p0}, Lcom/android/server/knox/dar/DarManagerService;->getSpecificKeyViaProtector(Ljava/lang/String;I)[B
 
-    invoke-direct {v8, v7}, Lcom/android/server/locksettings/LockSettingsService$6;-><init>(Ljava/util/concurrent/CountDownLatch;)V
+    move-result-object v4
 
-    invoke-virtual {v1, p0, v8}, Landroid/hardware/fingerprint/FingerprintManager;->removeAll(ILandroid/hardware/fingerprint/FingerprintManager$RemovalCallback;)V
+    invoke-static {v4}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
 
-    :try_start_0
-    sget-object v1, Ljava/util/concurrent/TimeUnit;->MILLISECONDS:Ljava/util/concurrent/TimeUnit;
+    move-result v6
 
-    invoke-virtual {v7, v4, v5, v1}, Ljava/util/concurrent/CountDownLatch;->await(JLjava/util/concurrent/TimeUnit;)Z
-    :try_end_0
-    .catch Ljava/lang/InterruptedException; {:try_start_0 .. :try_end_0} :catch_0
+    if-eqz v6, :cond_3
 
-    goto :goto_1
+    new-instance p0, Ljava/lang/Exception;
 
-    :catch_0
-    move-exception v1
+    const-string/jumbo p1, "Unexpected failure while get secure data key"
 
-    const-string v7, "Latch interrupted when removing fingerprint"
+    invoke-direct {p0, p1}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
 
-    invoke-static {v2, v7, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    invoke-virtual {p0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
 
-    :cond_2
-    :goto_1
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
+    move-result-object p0
 
-    iget-object v7, v1, Lcom/android/server/locksettings/LockSettingsService$Injector;->mContext:Landroid/content/Context;
+    invoke-static {v1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {v7}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+    goto/16 :goto_1
 
-    move-result-object v7
+    :cond_3
+    iget-object v6, p1, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
 
-    const-string/jumbo v8, "android.hardware.biometrics.face"
+    invoke-virtual {v6}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v7, v8}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z
+    invoke-static {v4, v0}, Lcom/android/server/knox/dar/KeyProtector;->encryptFast([B[B)[B
 
-    move-result v7
+    move-result-object v0
 
-    if-eqz v7, :cond_3
+    iget-object p1, p1, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
 
-    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService$Injector;->mContext:Landroid/content/Context;
+    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v7, "face"
+    invoke-static {v4, v3}, Lcom/android/server/knox/dar/KeyProtector;->encryptFast([B[B)[B
 
-    invoke-virtual {v1, v7}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
+    move-result-object p1
 
-    move-result-object v1
+    new-instance v3, Ljava/lang/StringBuilder;
 
-    check-cast v1, Landroid/hardware/face/FaceManager;
+    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
 
-    goto :goto_2
+    invoke-virtual {v2}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
 
-    :cond_3
-    move-object v1, v3
+    move-result-object v2
 
-    :goto_2
-    const-string v7, "Latch interrupted when removing face"
+    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    if-eqz v1, :cond_4
+    const-string v2, ".bku"
 
-    invoke-virtual {v1}, Landroid/hardware/face/FaceManager;->isHardwareDetected()Z
+    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result v8
+    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    if-eqz v8, :cond_4
+    move-result-object v3
 
-    invoke-virtual {v1, p0}, Landroid/hardware/face/FaceManager;->hasEnrolledTemplates(I)Z
+    invoke-static {v3, v0}, Lcom/android/server/knox/dar/DarManagerService;->fileWrite(Ljava/lang/String;[B)Z
 
-    move-result v8
+    move-result v0
 
-    if-eqz v8, :cond_5
+    new-instance v3, Ljava/lang/StringBuilder;
 
-    new-instance v8, Ljava/util/concurrent/CountDownLatch;
+    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-direct {v8, v6}, Ljava/util/concurrent/CountDownLatch;-><init>(I)V
+    invoke-virtual {v5}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
 
-    new-instance v6, Lcom/android/server/locksettings/LockSettingsService$7;
+    move-result-object v4
 
-    invoke-direct {v6, v8}, Lcom/android/server/locksettings/LockSettingsService$7;-><init>(Ljava/util/concurrent/CountDownLatch;)V
+    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v1, p0, v6}, Landroid/hardware/face/FaceManager;->removeAll(ILandroid/hardware/face/FaceManager$RemovalCallback;)V
+    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    :try_start_1
-    sget-object p0, Ljava/util/concurrent/TimeUnit;->MILLISECONDS:Ljava/util/concurrent/TimeUnit;
+    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-virtual {v8, v4, v5, p0}, Ljava/util/concurrent/CountDownLatch;->await(JLjava/util/concurrent/TimeUnit;)Z
-    :try_end_1
-    .catch Ljava/lang/InterruptedException; {:try_start_1 .. :try_end_1} :catch_1
+    move-result-object v2
 
-    goto :goto_3
+    invoke-static {v2, p1}, Lcom/android/server/knox/dar/DarManagerService;->fileWrite(Ljava/lang/String;[B)Z
 
-    :catch_1
-    move-exception p0
+    move-result p1
 
-    invoke-static {v2, v7, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    goto :goto_3
+    move-result-object p0
 
-    :cond_4
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    invoke-static {v0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
 
-    invoke-virtual {v1}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+    move-result-object v0
 
-    move-result-object v1
+    invoke-static {p1}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
 
-    const-string/jumbo v8, "com.samsung.android.bio.face"
+    move-result-object p1
 
-    invoke-virtual {v1, v8}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z
+    filled-new-array {p0, v0, p1}, [Ljava/lang/Object;
 
-    move-result v1
+    move-result-object p0
 
-    if-eqz v1, :cond_5
+    const-string p1, "Escrow data for SYSTEM user %d got secured [ Res : %b/%b ]"
 
-    invoke-static {p0}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
+    invoke-static {p1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result v1
+    move-result-object p0
 
-    if-eqz v1, :cond_5
+    invoke-static {v1, p0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    goto :goto_1
 
-    invoke-static {v1}, Lcom/samsung/android/bio/face/SemBioFaceManager;->createInstance(Landroid/content/Context;)Lcom/samsung/android/bio/face/SemBioFaceManager;
+    :cond_4
+    :goto_0
+    invoke-virtual {v2}, Ljava/io/File;->exists()Z
 
-    move-result-object v1
+    move-result p0
 
-    if-eqz v1, :cond_5
+    invoke-virtual {v5}, Ljava/io/File;->exists()Z
 
-    invoke-virtual {v1}, Lcom/samsung/android/bio/face/SemBioFaceManager;->isHardwareDetected()Z
+    move-result p1
 
-    move-result v8
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    if-eqz v8, :cond_5
+    const-string v2, "Escrow data doesn\'t exist [ "
 
-    invoke-virtual {v1, p0}, Lcom/samsung/android/bio/face/SemBioFaceManager;->hasEnrolledFaces(I)Z
+    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    move-result v8
+    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    if-eqz v8, :cond_5
+    const-string p0, "/"
 
-    invoke-virtual {v1, p0}, Lcom/samsung/android/bio/face/SemBioFaceManager;->setActiveUser(I)V
+    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    new-instance v8, Ljava/util/concurrent/CountDownLatch;
+    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    invoke-direct {v8, v6}, Ljava/util/concurrent/CountDownLatch;-><init>(I)V
+    const-string p0, " ]"
 
-    new-instance v6, Landroid/hardware/face/Face;
+    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const/4 v9, 0x0
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    const-wide/16 v10, 0x0
+    move-result-object p0
 
-    invoke-direct {v6, v3, v9, v10, v11}, Landroid/hardware/face/Face;-><init>(Ljava/lang/CharSequence;IJ)V
+    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    new-instance v9, Lcom/samsung/android/bio/face/SemBioFace;
+    :goto_1
+    return-void
 
-    invoke-direct {v9, v6}, Lcom/samsung/android/bio/face/SemBioFace;-><init>(Landroid/hardware/face/Face;)V
+    :pswitch_0
+    check-cast p1, Lcom/android/server/pm/PersonaManagerService;
 
-    new-instance v6, Lcom/android/server/locksettings/LockSettingsService$8;
+    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
 
-    invoke-direct {v6, v8}, Lcom/android/server/locksettings/LockSettingsService$8;-><init>(Ljava/util/concurrent/CountDownLatch;)V
+    iget-object v0, p1, Lcom/android/server/pm/PersonaManagerService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v1, v9, p0, v6}, Lcom/samsung/android/bio/face/SemBioFaceManager;->remove(Lcom/samsung/android/bio/face/SemBioFace;ILcom/samsung/android/bio/face/SemBioFaceManager$RemovalCallback;)V
+    iget-object p1, p1, Lcom/android/server/pm/PersonaManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    :try_start_2
-    sget-object p0, Ljava/util/concurrent/TimeUnit;->MILLISECONDS:Ljava/util/concurrent/TimeUnit;
+    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
 
-    invoke-virtual {v8, v4, v5, p0}, Ljava/util/concurrent/CountDownLatch;->await(JLjava/util/concurrent/TimeUnit;)Z
-    :try_end_2
-    .catch Ljava/lang/InterruptedException; {:try_start_2 .. :try_end_2} :catch_2
+    move-result-object v1
 
-    goto :goto_3
+    const-string/jumbo v2, "knox_finger_print_plus"
 
-    :catch_2
-    move-exception p0
+    const/4 v3, 0x0
 
-    invoke-static {v2, v7, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    invoke-static {v1, v2, v3, p0}, Landroid/provider/Settings$Secure;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
 
-    :cond_5
-    :goto_3
-    iget-object p0, v0, Lcom/android/server/locksettings/LockSettingsService;->mMaintenanceModeCallback:Lcom/samsung/android/server/pm/mm/MaintenanceModeManager$$ExternalSyntheticLambda16;
+    move-result v1
+
+    const/4 v4, 0x1
+
+    if-ne v1, v4, :cond_5
 
-    if-eqz p0, :cond_6
+    invoke-virtual {p1, p0}, Lcom/android/internal/widget/LockPatternUtils;->getBiometricType(I)I
 
-    sget-object v1, Ljava/lang/Boolean;->TRUE:Ljava/lang/Boolean;
+    move-result p1
 
-    invoke-virtual {p0, v1}, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager$$ExternalSyntheticLambda16;->accept(Ljava/lang/Object;)V
+    if-nez p1, :cond_5
 
-    iput-object v3, v0, Lcom/android/server/locksettings/LockSettingsService;->mMaintenanceModeCallback:Lcom/samsung/android/server/pm/mm/MaintenanceModeManager$$ExternalSyntheticLambda16;
+    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
 
-    :cond_6
+    move-result-object p1
+
+    invoke-static {p1, v2, v3, p0}, Landroid/provider/Settings$Secure;->putIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)Z
+
+    const-string p0, "ContainerDependencyWrapper"
+
+    const-string/jumbo p1, "unset two-factor setting value."
+
+    invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    :cond_5
     return-void
 
     :pswitch_data_0
     .packed-switch 0x0
-        :pswitch_1
         :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12.smali
index 6d749b36a..b2f72d041 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12.smali
@@ -3,354 +3,62 @@
 .source "SourceFile"
 
 # interfaces
-.implements Ljava/util/function/Consumer;
+.implements Ljava/lang/Runnable;
 
 
 # instance fields
-.field public final synthetic $r8$classId:I
+.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-.field public final synthetic f$0:I
+.field public final synthetic f$1:Landroid/content/Intent;
 
+.field public final synthetic f$2:Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;
 
-# direct methods
-.method public synthetic constructor <init>(II)V
-    .locals 0
+.field public final synthetic f$3:I
 
-    iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->$r8$classId:I
 
-    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->f$0:I
+# direct methods
+.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;Landroid/content/Intent;Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;I)V
+    .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    return-void
-.end method
-
-
-# virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 7
-
-    iget v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->$r8$classId:I
-
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->f$0:I
-
-    packed-switch v0, :pswitch_data_0
-
-    check-cast p1, Lcom/android/server/knox/dar/DarManagerService;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    if-eqz p0, :cond_0
-
-    goto/16 :goto_1
-
-    :cond_0
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "Save secured escrow data for user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string v1, "DarManagerService"
-
-    invoke-static {v1, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v0, Ljava/io/File;
-
-    invoke-static {p0}, Landroid/os/Environment;->getDataSystemDeDirectory(I)Ljava/io/File;
-
-    move-result-object v2
-
-    const-string/jumbo v3, "spblob"
-
-    invoke-direct {v0, v2, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    new-instance v2, Ljava/io/File;
-
-    const-wide/16 v3, 0x0
-
-    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v5
-
-    const-string/jumbo v6, "e0"
-
-    filled-new-array {v5, v6}, [Ljava/lang/Object;
-
-    move-result-object v5
-
-    const-string v6, "%016x.%s"
-
-    invoke-static {v6, v5}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-direct {v2, v0, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
+    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    new-instance v5, Ljava/io/File;
+    iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->f$1:Landroid/content/Intent;
 
-    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    iput-object p3, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->f$2:Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;
 
-    move-result-object v3
-
-    const-string/jumbo v4, "p1"
-
-    filled-new-array {v3, v4}, [Ljava/lang/Object;
-
-    move-result-object v3
-
-    invoke-static {v6, v3}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-direct {v5, v0, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-virtual {v2}, Ljava/io/File;->exists()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    invoke-virtual {v5}, Ljava/io/File;->exists()Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    goto/16 :goto_0
-
-    :cond_1
-    invoke-virtual {v2}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarManagerService;->fileRead(Ljava/lang/String;)[B
-
-    move-result-object v0
-
-    invoke-virtual {v5}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-static {v3}, Lcom/android/server/knox/dar/DarManagerService;->fileRead(Ljava/lang/String;)[B
-
-    move-result-object v3
-
-    filled-new-array {v0, v3}, [Ljava/lang/Object;
-
-    move-result-object v4
-
-    invoke-static {v4}, Lcom/android/server/knox/dar/SecureUtil;->isAnyoneEmptyHere([Ljava/lang/Object;)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_2
-
-    goto/16 :goto_1
-
-    :cond_2
-    const-string/jumbo v4, "SdpSecureDataKey"
-
-    invoke-virtual {p1, v4, p0}, Lcom/android/server/knox/dar/DarManagerService;->getSpecificKeyViaProtector(Ljava/lang/String;I)[B
-
-    move-result-object v4
-
-    invoke-static {v4}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v6
-
-    if-eqz v6, :cond_3
-
-    new-instance p0, Ljava/lang/Exception;
-
-    const-string/jumbo p1, "Unexpected failure while get secure data key"
-
-    invoke-direct {p0, p1}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object p0
+    iput p4, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->f$3:I
 
-    invoke-static {v1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto/16 :goto_1
-
-    :cond_3
-    iget-object v6, p1, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {v6}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v4, v0}, Lcom/android/server/knox/dar/KeyProtector;->encryptFast([B[B)[B
-
-    move-result-object v0
-
-    iget-object p1, p1, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v4, v3}, Lcom/android/server/knox/dar/KeyProtector;->encryptFast([B[B)[B
-
-    move-result-object p1
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {v2}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v2, ".bku"
-
-    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-static {v3, v0}, Lcom/android/server/knox/dar/DarManagerService;->fileWrite(Ljava/lang/String;[B)Z
-
-    move-result v0
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {v5}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v2, p1}, Lcom/android/server/knox/dar/DarManagerService;->fileWrite(Ljava/lang/String;[B)Z
-
-    move-result p1
-
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    invoke-static {v0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object v0
-
-    invoke-static {p1}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p1
-
-    filled-new-array {p0, v0, p1}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string p1, "Escrow data for SYSTEM user %d got secured [ Res : %b/%b ]"
-
-    invoke-static {p1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_1
-
-    :cond_4
-    :goto_0
-    invoke-virtual {v2}, Ljava/io/File;->exists()Z
-
-    move-result p0
-
-    invoke-virtual {v5}, Ljava/io/File;->exists()Z
-
-    move-result p1
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string v2, "Escrow data doesn\'t exist [ "
-
-    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string p0, "/"
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string p0, " ]"
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_1
     return-void
+.end method
 
-    :pswitch_0
-    check-cast p1, Lcom/android/server/pm/PersonaManagerService;
-
-    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    iget-object v0, p1, Lcom/android/server/pm/PersonaManagerService;->mContext:Landroid/content/Context;
-
-    iget-object p1, p1, Lcom/android/server/pm/PersonaManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+# virtual methods
+.method public final run()V
+    .locals 5
 
-    move-result-object v1
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    const-string/jumbo v2, "knox_finger_print_plus"
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->f$1:Landroid/content/Intent;
 
-    const/4 v3, 0x0
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->f$2:Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;
 
-    invoke-static {v1, v2, v3, p0}, Landroid/provider/Settings$Secure;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->f$3:I
 
-    move-result v1
+    iget-object v3, v0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
     const/4 v4, 0x1
 
-    if-ne v1, v4, :cond_5
-
-    invoke-virtual {p1, p0}, Lcom/android/internal/widget/LockPatternUtils;->getBiometricType(I)I
-
-    move-result p1
-
-    if-nez p1, :cond_5
-
-    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    invoke-static {p0}, Landroid/os/UserHandle;->of(I)Landroid/os/UserHandle;
 
-    move-result-object p1
-
-    invoke-static {p1, v2, v3, p0}, Landroid/provider/Settings$Secure;->putIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)Z
+    move-result-object p0
 
-    const-string p0, "ContainerDependencyWrapper"
+    invoke-virtual {v3, v1, v2, v4, p0}, Landroid/content/Context;->bindServiceAsUser(Landroid/content/Intent;Landroid/content/ServiceConnection;ILandroid/os/UserHandle;)Z
 
-    const-string/jumbo p1, "unset two-factor setting value."
+    move-result p0
 
-    invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    iput-boolean p0, v0, Lcom/android/server/locksettings/LockSettingsService;->mShouldUnbind:Z
 
-    :cond_5
     return-void
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13.smali
index ec7c7024c..eccf3f897 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13.smali
@@ -7,28 +7,20 @@
 
 
 # instance fields
-.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-.field public final synthetic f$1:Landroid/content/Intent;
+.field public final synthetic $r8$classId:I
 
-.field public final synthetic f$2:Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;
-
-.field public final synthetic f$3:I
+.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
 
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;Landroid/content/Intent;Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;I)V
+.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;I)V
     .locals 0
 
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+    iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->$r8$classId:I
 
     iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$1:Landroid/content/Intent;
-
-    iput-object p3, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$2:Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;
-
-    iput p4, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$3:I
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
     return-void
 .end method
@@ -36,29 +28,505 @@
 
 # virtual methods
 .method public final run()V
-    .locals 5
+    .locals 13
+
+    const/4 v0, 0x0
+
+    const/4 v1, 0x1
+
+    iget v2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->$r8$classId:I
+
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+
+    packed-switch v2, :pswitch_data_0
+
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
+
+    invoke-virtual {v2}, Ljava/util/ArrayList;->isEmpty()Z
+
+    move-result v2
+
+    if-nez v2, :cond_1
+
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+
+    monitor-enter v2
+
+    :try_start_0
+    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
+
+    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I
+
+    move-result v4
+
+    move v5, v0
+
+    :goto_0
+    if-ge v5, v4, :cond_0
+
+    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+
+    move-result-object v6
+
+    add-int/2addr v5, v1
+
+    check-cast v6, Landroid/util/Pair;
+
+    iget-object v7, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+
+    iget-object v8, v6, Landroid/util/Pair;->first:Ljava/lang/Object;
+
+    check-cast v8, Ljava/lang/Long;
+
+    invoke-virtual {v8}, Ljava/lang/Long;->longValue()J
+
+    move-result-wide v8
+
+    iget-object v6, v6, Landroid/util/Pair;->second:Ljava/lang/Object;
+
+    check-cast v6, Ljava/lang/Integer;
+
+    invoke-virtual {v6}, Ljava/lang/Integer;->intValue()I
+
+    move-result v6
+
+    invoke-virtual {v7, v6, v8, v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyLskfBasedProtector(IJ)V
+
+    goto :goto_0
+
+    :catchall_0
+    move-exception v0
+
+    move-object p0, v0
+
+    goto :goto_1
+
+    :cond_0
+    monitor-exit v2
+
+    goto :goto_2
+
+    :goto_1
+    monitor-exit v2
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+
+    throw p0
+
+    :cond_1
+    :goto_2
+    const/4 v2, 0x0
+
+    iput-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
+
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mRebootEscrowManager:Lcom/android/server/locksettings/RebootEscrowManager;
+
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
+
+    iget-object v3, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mUserManager:Landroid/os/UserManager;
+
+    invoke-virtual {v3}, Landroid/os/UserManager;->getUsers()Ljava/util/List;
+
+    move-result-object v3
+
+    iget-object v4, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mCallbacks:Lcom/android/server/locksettings/RebootEscrowManager$Callbacks;
+
+    check-cast v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+
+    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    sget-boolean v5, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+
+    iget-object v5, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    check-cast v5, Lcom/android/server/locksettings/LockSettingsService;
+
+    invoke-virtual {v5, v0}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
+
+    move-result v5
+
+    const-string/jumbo v6, "RebootEscrowManager"
+
+    iget-object v7, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mInjector:Lcom/android/server/locksettings/RebootEscrowManager$Injector;
+
+    iget-object v8, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+
+    if-eqz v5, :cond_2
+
+    invoke-virtual {v8, v0}, Lcom/android/server/locksettings/LockSettingsStorage;->getRebootEscrowFile(I)Ljava/io/File;
+
+    move-result-object v5
+
+    invoke-virtual {v8, v5}, Lcom/android/server/locksettings/LockSettingsStorage;->hasFile(Ljava/io/File;)Z
+
+    move-result v5
+
+    if-nez v5, :cond_2
+
+    const-string/jumbo v4, "No reboot escrow data found for system user"
+
+    invoke-static {v6, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+
+    sget-object v4, Ljava/util/Collections;->EMPTY_LIST:Ljava/util/List;
+
+    goto/16 :goto_5
+
+    :cond_2
+    new-instance v5, Ljava/util/HashSet;
+
+    invoke-direct {v5}, Ljava/util/HashSet;-><init>()V
+
+    invoke-interface {v3}, Ljava/util/List;->iterator()Ljava/util/Iterator;
+
+    move-result-object v9
+
+    :cond_3
+    :goto_3
+    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z
+
+    move-result v10
+
+    if-eqz v10, :cond_4
+
+    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+
+    move-result-object v10
+
+    check-cast v10, Landroid/content/pm/UserInfo;
+
+    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
+
+    sget-boolean v12, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+
+    iget-object v12, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    check-cast v12, Lcom/android/server/locksettings/LockSettingsService;
+
+    invoke-virtual {v12, v11}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
+
+    move-result v11
+
+    if-eqz v11, :cond_3
+
+    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
+
+    invoke-virtual {v8, v11}, Lcom/android/server/locksettings/LockSettingsStorage;->getRebootEscrowFile(I)Ljava/io/File;
+
+    move-result-object v11
+
+    invoke-virtual {v8, v11}, Lcom/android/server/locksettings/LockSettingsStorage;->hasFile(Ljava/io/File;)Z
+
+    move-result v11
+
+    if-nez v11, :cond_3
+
+    new-instance v11, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v12, "No reboot escrow data found for user "
+
+    invoke-direct {v11, v12}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v11, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v11
+
+    invoke-static {v6, v11}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    iget v10, v10, Landroid/content/pm/UserInfo;->id:I
+
+    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+
+    move-result-object v10
+
+    invoke-virtual {v5, v10}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z
+
+    goto :goto_3
+
+    :cond_4
+    new-instance v8, Ljava/util/ArrayList;
+
+    invoke-direct {v8}, Ljava/util/ArrayList;-><init>()V
+
+    invoke-interface {v3}, Ljava/util/List;->iterator()Ljava/util/Iterator;
+
+    move-result-object v9
+
+    :cond_5
+    :goto_4
+    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z
+
+    move-result v10
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+    if-eqz v10, :cond_8
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$1:Landroid/content/Intent;
+    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$2:Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;
+    move-result-object v10
 
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$3:I
+    check-cast v10, Landroid/content/pm/UserInfo;
 
-    iget-object v3, v0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
 
-    const/4 v4, 0x1
+    sget-boolean v12, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
 
-    invoke-static {p0}, Landroid/os/UserHandle;->of(I)Landroid/os/UserHandle;
+    iget-object v12, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
-    move-result-object p0
+    check-cast v12, Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-virtual {v3, v1, v2, v4, p0}, Landroid/content/Context;->bindServiceAsUser(Landroid/content/Intent;Landroid/content/ServiceConnection;ILandroid/os/UserHandle;)Z
+    invoke-virtual {v12, v11}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
 
-    move-result p0
+    move-result v11
 
-    iput-boolean p0, v0, Lcom/android/server/locksettings/LockSettingsService;->mShouldUnbind:Z
+    if-nez v11, :cond_6
 
+    goto :goto_4
+
+    :cond_6
+    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
+
+    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+
+    move-result-object v12
+
+    invoke-virtual {v5, v12}, Ljava/util/HashSet;->contains(Ljava/lang/Object;)Z
+
+    move-result v12
+
+    if-nez v12, :cond_5
+
+    iget-object v12, v7, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->mUserManagerInternal:Lcom/android/server/pm/UserManagerInternal;
+
+    invoke-virtual {v12, v11}, Lcom/android/server/pm/UserManagerInternal;->getProfileParentId(I)I
+
+    move-result v11
+
+    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+
+    move-result-object v11
+
+    invoke-virtual {v5, v11}, Ljava/util/HashSet;->contains(Ljava/lang/Object;)Z
+
+    move-result v11
+
+    if-eqz v11, :cond_7
+
+    goto :goto_4
+
+    :cond_7
+    invoke-virtual {v8, v10}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
+
+    goto :goto_4
+
+    :cond_8
+    move-object v4, v8
+
+    :goto_5
+    invoke-interface {v4}, Ljava/util/List;->isEmpty()Z
+
+    move-result v5
+
+    if-eqz v5, :cond_9
+
+    const-string/jumbo p0, "No reboot escrow data found for users, skipping loading escrow data"
+
+    invoke-static {v6, p0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual {v2}, Lcom/android/server/locksettings/RebootEscrowManager;->clearMetricsStorage()V
+
+    goto :goto_6
+
+    :cond_9
+    iget-object v5, v7, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->mContext:Landroid/content/Context;
+
+    const-class v8, Landroid/os/PowerManager;
+
+    invoke-virtual {v5, v8}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object v5
+
+    check-cast v5, Landroid/os/PowerManager;
+
+    invoke-virtual {v5, v1, v6}, Landroid/os/PowerManager;->newWakeLock(ILjava/lang/String;)Landroid/os/PowerManager$WakeLock;
+
+    move-result-object v1
+
+    iput-object v1, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mWakeLock:Landroid/os/PowerManager$WakeLock;
+
+    if-eqz v1, :cond_a
+
+    invoke-virtual {v1, v0}, Landroid/os/PowerManager$WakeLock;->setReferenceCounted(Z)V
+
+    iget-object v0, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mWakeLock:Landroid/os/PowerManager$WakeLock;
+
+    invoke-virtual {v7}, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->getWakeLockTimeoutMillis()I
+
+    move-result v1
+
+    int-to-long v5, v1
+
+    invoke-virtual {v0, v5, v6}, Landroid/os/PowerManager$WakeLock;->acquire(J)V
+
+    :cond_a
+    new-instance v0, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda1;
+
+    invoke-direct {v0, v2}, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/locksettings/RebootEscrowManager;)V
+
+    invoke-virtual {v7}, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->getLoadEscrowTimeoutMillis()I
+
+    move-result v1
+
+    int-to-long v5, v1
+
+    invoke-virtual {p0, v0, v5, v6}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
+
+    new-instance v0, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda2;
+
+    invoke-direct {v0, v2, p0, v3, v4}, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/locksettings/RebootEscrowManager;Landroid/os/Handler;Ljava/util/List;Ljava/util/List;)V
+
+    invoke-virtual {p0, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+
+    :goto_6
     return-void
+
+    :pswitch_0
+    sget-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+
+    invoke-static {v0}, Lcom/samsung/android/lock/LsLog;->getFailureCount(I)I
+
+    move-result v2
+
+    add-int/2addr v2, v1
+
+    sget v1, Lcom/samsung/android/lock/LsConstants;->SECURITY_DEBUG_ON_COUNT:I
+
+    if-lt v2, v1, :cond_d
+
+    const-string/jumbo v1, "LockSettingsService"
+
+    const-string v3, "!@ DoVerifySI called. failedCount = "
+
+    invoke-static {v2, v3, v1}, Lcom/android/server/AnyMotionDetector$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+
+    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
+
+    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService;->getSICheckerId(I)J
+
+    move-result-wide v3
+
+    const-string/jumbo v1, "locksettings_si_protector_id"
+
+    const-wide/16 v5, 0x0
+
+    invoke-virtual {p0, v1, v5, v6, v0}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+
+    move-result-wide v5
+
+    invoke-virtual {p0, v5, v6}, Lcom/android/server/locksettings/LockSettingsService;->hasSecurityIntegrity(J)B
+
+    move-result v1
+
+    const/4 v2, 0x3
+
+    if-eq v1, v2, :cond_b
+
+    const-string/jumbo p0, "[SI Checker] NO Security integrity key...."
+
+    invoke-static {p0}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
+
+    goto :goto_7
+
+    :cond_b
+    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
+
+    move-result-wide v1
+
+    cmp-long v7, v5, v1
+
+    if-eqz v7, :cond_c
+
+    const-string/jumbo v7, "[SI Checker]: Protector Mismatch! SICheckerID=%016x, SIProtectorID=%016x, ProtectorID=%016x"
+
+    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+
+    move-result-object v8
+
+    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+
+    move-result-object v9
+
+    invoke-static {v1, v2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+
+    move-result-object v1
+
+    filled-new-array {v8, v9, v1}, [Ljava/lang/Object;
+
+    move-result-object v1
+
+    invoke-static {v7, v1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+
+    move-result-object v1
+
+    invoke-static {v1}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
+
+    :cond_c
+    invoke-static {}, Landroid/os/Process;->myPid()I
+
+    move-result v1
+
+    const-string/jumbo v2, "SI:%016x"
+
+    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+
+    move-result-object v7
+
+    filled-new-array {v7}, [Ljava/lang/Object;
+
+    move-result-object v7
+
+    invoke-static {v2, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+
+    move-result-object v2
+
+    invoke-static {v0, v1, v2}, Lcom/samsung/android/lock/LsLog;->verifyRequest(IILjava/lang/String;)V
+
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+
+    monitor-enter v1
+
+    :try_start_1
+    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
+
+    move-result-object v7
+
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+
+    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->checkSecurityIntegrity(JJLcom/android/internal/widget/LockscreenCredential;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+
+    invoke-virtual {v7}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
+
+    monitor-exit v1
+
+    goto :goto_7
+
+    :catchall_1
+    move-exception v0
+
+    move-object p0, v0
+
+    monitor-exit v1
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_1
+
+    throw p0
+
+    :cond_d
+    :goto_7
+    return-void
+
+    :pswitch_data_0
+    .packed-switch 0x0
+        :pswitch_0
+    .end packed-switch
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14.smali
deleted file mode 100644
index b6b40dd70..000000000
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14.smali
+++ /dev/null
@@ -1,532 +0,0 @@
-.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/lang/Runnable;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;I)V
-    .locals 0
-
-    iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;->$r8$classId:I
-
-    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final run()V
-    .locals 13
-
-    const/4 v0, 0x0
-
-    const/4 v1, 0x1
-
-    iget v2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;->$r8$classId:I
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    packed-switch v2, :pswitch_data_0
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
-
-    invoke-virtual {v2}, Ljava/util/ArrayList;->isEmpty()Z
-
-    move-result v2
-
-    if-nez v2, :cond_1
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v2
-
-    :try_start_0
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
-
-    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I
-
-    move-result v4
-
-    move v5, v0
-
-    :goto_0
-    if-ge v5, v4, :cond_0
-
-    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v6
-
-    add-int/2addr v5, v1
-
-    check-cast v6, Landroid/util/Pair;
-
-    iget-object v7, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    iget-object v8, v6, Landroid/util/Pair;->first:Ljava/lang/Object;
-
-    check-cast v8, Ljava/lang/Long;
-
-    invoke-virtual {v8}, Ljava/lang/Long;->longValue()J
-
-    move-result-wide v8
-
-    iget-object v6, v6, Landroid/util/Pair;->second:Ljava/lang/Object;
-
-    check-cast v6, Ljava/lang/Integer;
-
-    invoke-virtual {v6}, Ljava/lang/Integer;->intValue()I
-
-    move-result v6
-
-    invoke-virtual {v7, v6, v8, v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyLskfBasedProtector(IJ)V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_1
-
-    :cond_0
-    monitor-exit v2
-
-    goto :goto_2
-
-    :goto_1
-    monitor-exit v2
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-
-    :cond_1
-    :goto_2
-    const/4 v2, 0x0
-
-    iput-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mRebootEscrowManager:Lcom/android/server/locksettings/RebootEscrowManager;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
-
-    iget-object v3, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mUserManager:Landroid/os/UserManager;
-
-    invoke-virtual {v3}, Landroid/os/UserManager;->getUsers()Ljava/util/List;
-
-    move-result-object v3
-
-    iget-object v4, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mCallbacks:Lcom/android/server/locksettings/RebootEscrowManager$Callbacks;
-
-    check-cast v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    sget-boolean v5, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    iget-object v5, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v5, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v5, v0}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
-
-    move-result v5
-
-    const-string/jumbo v6, "RebootEscrowManager"
-
-    iget-object v7, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mInjector:Lcom/android/server/locksettings/RebootEscrowManager$Injector;
-
-    iget-object v8, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
-
-    if-eqz v5, :cond_2
-
-    invoke-virtual {v8, v0}, Lcom/android/server/locksettings/LockSettingsStorage;->getRebootEscrowFile(I)Ljava/io/File;
-
-    move-result-object v5
-
-    invoke-virtual {v8, v5}, Lcom/android/server/locksettings/LockSettingsStorage;->hasFile(Ljava/io/File;)Z
-
-    move-result v5
-
-    if-nez v5, :cond_2
-
-    const-string/jumbo v4, "No reboot escrow data found for system user"
-
-    invoke-static {v6, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    sget-object v4, Ljava/util/Collections;->EMPTY_LIST:Ljava/util/List;
-
-    goto/16 :goto_5
-
-    :cond_2
-    new-instance v5, Ljava/util/HashSet;
-
-    invoke-direct {v5}, Ljava/util/HashSet;-><init>()V
-
-    invoke-interface {v3}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v9
-
-    :cond_3
-    :goto_3
-    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v10
-
-    if-eqz v10, :cond_4
-
-    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v10
-
-    check-cast v10, Landroid/content/pm/UserInfo;
-
-    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
-
-    sget-boolean v12, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    iget-object v12, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v12, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v12, v11}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
-
-    move-result v11
-
-    if-eqz v11, :cond_3
-
-    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-virtual {v8, v11}, Lcom/android/server/locksettings/LockSettingsStorage;->getRebootEscrowFile(I)Ljava/io/File;
-
-    move-result-object v11
-
-    invoke-virtual {v8, v11}, Lcom/android/server/locksettings/LockSettingsStorage;->hasFile(Ljava/io/File;)Z
-
-    move-result v11
-
-    if-nez v11, :cond_3
-
-    new-instance v11, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v12, "No reboot escrow data found for user "
-
-    invoke-direct {v11, v12}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v11, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v11
-
-    invoke-static {v6, v11}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget v10, v10, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v10
-
-    invoke-virtual {v5, v10}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z
-
-    goto :goto_3
-
-    :cond_4
-    new-instance v8, Ljava/util/ArrayList;
-
-    invoke-direct {v8}, Ljava/util/ArrayList;-><init>()V
-
-    invoke-interface {v3}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v9
-
-    :cond_5
-    :goto_4
-    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v10
-
-    if-eqz v10, :cond_8
-
-    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v10
-
-    check-cast v10, Landroid/content/pm/UserInfo;
-
-    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
-
-    sget-boolean v12, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    iget-object v12, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v12, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v12, v11}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
-
-    move-result v11
-
-    if-nez v11, :cond_6
-
-    goto :goto_4
-
-    :cond_6
-    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v12
-
-    invoke-virtual {v5, v12}, Ljava/util/HashSet;->contains(Ljava/lang/Object;)Z
-
-    move-result v12
-
-    if-nez v12, :cond_5
-
-    iget-object v12, v7, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->mUserManagerInternal:Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-virtual {v12, v11}, Lcom/android/server/pm/UserManagerInternal;->getProfileParentId(I)I
-
-    move-result v11
-
-    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v11
-
-    invoke-virtual {v5, v11}, Ljava/util/HashSet;->contains(Ljava/lang/Object;)Z
-
-    move-result v11
-
-    if-eqz v11, :cond_7
-
-    goto :goto_4
-
-    :cond_7
-    invoke-virtual {v8, v10}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_4
-
-    :cond_8
-    move-object v4, v8
-
-    :goto_5
-    invoke-interface {v4}, Ljava/util/List;->isEmpty()Z
-
-    move-result v5
-
-    if-eqz v5, :cond_9
-
-    const-string/jumbo p0, "No reboot escrow data found for users, skipping loading escrow data"
-
-    invoke-static {v6, p0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v2}, Lcom/android/server/locksettings/RebootEscrowManager;->clearMetricsStorage()V
-
-    goto :goto_6
-
-    :cond_9
-    iget-object v5, v7, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->mContext:Landroid/content/Context;
-
-    const-class v8, Landroid/os/PowerManager;
-
-    invoke-virtual {v5, v8}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v5
-
-    check-cast v5, Landroid/os/PowerManager;
-
-    invoke-virtual {v5, v1, v6}, Landroid/os/PowerManager;->newWakeLock(ILjava/lang/String;)Landroid/os/PowerManager$WakeLock;
-
-    move-result-object v1
-
-    iput-object v1, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mWakeLock:Landroid/os/PowerManager$WakeLock;
-
-    if-eqz v1, :cond_a
-
-    invoke-virtual {v1, v0}, Landroid/os/PowerManager$WakeLock;->setReferenceCounted(Z)V
-
-    iget-object v0, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mWakeLock:Landroid/os/PowerManager$WakeLock;
-
-    invoke-virtual {v7}, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->getWakeLockTimeoutMillis()I
-
-    move-result v1
-
-    int-to-long v5, v1
-
-    invoke-virtual {v0, v5, v6}, Landroid/os/PowerManager$WakeLock;->acquire(J)V
-
-    :cond_a
-    new-instance v0, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda1;
-
-    invoke-direct {v0, v2}, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/locksettings/RebootEscrowManager;)V
-
-    invoke-virtual {v7}, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->getLoadEscrowTimeoutMillis()I
-
-    move-result v1
-
-    int-to-long v5, v1
-
-    invoke-virtual {p0, v0, v5, v6}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
-
-    new-instance v0, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda2;
-
-    invoke-direct {v0, v2, p0, v3, v4}, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/locksettings/RebootEscrowManager;Landroid/os/Handler;Ljava/util/List;Ljava/util/List;)V
-
-    invoke-virtual {p0, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
-
-    :goto_6
-    return-void
-
-    :pswitch_0
-    sget-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    invoke-static {v0}, Lcom/samsung/android/lock/LsLog;->getFailureCount(I)I
-
-    move-result v2
-
-    add-int/2addr v2, v1
-
-    sget v1, Lcom/samsung/android/lock/LsConstants;->SECURITY_DEBUG_ON_COUNT:I
-
-    if-lt v2, v1, :cond_d
-
-    const-string/jumbo v1, "LockSettingsService"
-
-    const-string v3, "!@ DoVerifySI called. failedCount = "
-
-    invoke-static {v2, v3, v1}, Lcom/android/server/AnyMotionDetector$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService;->getSICheckerId(I)J
-
-    move-result-wide v3
-
-    const-string/jumbo v1, "locksettings_si_protector_id"
-
-    const-wide/16 v5, 0x0
-
-    invoke-virtual {p0, v1, v5, v6, v0}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
-
-    move-result-wide v5
-
-    invoke-virtual {p0, v5, v6}, Lcom/android/server/locksettings/LockSettingsService;->hasSecurityIntegrity(J)B
-
-    move-result v1
-
-    const/4 v2, 0x3
-
-    if-eq v1, v2, :cond_b
-
-    const-string/jumbo p0, "[SI Checker] NO Security integrity key...."
-
-    invoke-static {p0}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
-
-    goto :goto_7
-
-    :cond_b
-    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
-
-    move-result-wide v1
-
-    cmp-long v7, v5, v1
-
-    if-eqz v7, :cond_c
-
-    const-string/jumbo v7, "[SI Checker]: Protector Mismatch! SICheckerID=%016x, SIProtectorID=%016x, ProtectorID=%016x"
-
-    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v8
-
-    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v9
-
-    invoke-static {v1, v2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v1
-
-    filled-new-array {v8, v9, v1}, [Ljava/lang/Object;
-
-    move-result-object v1
-
-    invoke-static {v7, v1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
-
-    :cond_c
-    invoke-static {}, Landroid/os/Process;->myPid()I
-
-    move-result v1
-
-    const-string/jumbo v2, "SI:%016x"
-
-    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v7
-
-    filled-new-array {v7}, [Ljava/lang/Object;
-
-    move-result-object v7
-
-    invoke-static {v2, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v0, v1, v2}, Lcom/samsung/android/lock/LsLog;->verifyRequest(IILjava/lang/String;)V
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v1
-
-    :try_start_1
-    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v7
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->checkSecurityIntegrity(JJLcom/android/internal/widget/LockscreenCredential;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
-
-    invoke-virtual {v7}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-
-    monitor-exit v1
-
-    goto :goto_7
-
-    :catchall_1
-    move-exception v0
-
-    move-object p0, v0
-
-    monitor-exit v1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    throw p0
-
-    :cond_d
-    :goto_7
-    return-void
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20.smali
similarity index 84%
rename from smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21.smali
rename to smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20.smali
index f8ca6d2db..504e50fc1 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20.smali
@@ -1,4 +1,4 @@
-.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;
+.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;
 .super Ljava/lang/Object;
 .source "SourceFile"
 
@@ -14,7 +14,7 @@
 .method public synthetic constructor <init>(I)V
     .locals 0
 
-    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;->$r8$classId:I
+    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;->$r8$classId:I
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
@@ -26,7 +26,7 @@
 .method public final accept(Ljava/lang/Object;)V
     .locals 1
 
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;->$r8$classId:I
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;->$r8$classId:I
 
     packed-switch p0, :pswitch_data_0
 
@@ -66,16 +66,8 @@
     :goto_0
     return-void
 
-    :pswitch_1
-    check-cast p1, Lcom/android/server/knox/dar/DarManagerService;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    return-void
-
     :pswitch_data_0
     .packed-switch 0x0
-        :pswitch_1
         :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4.smali
index 0660151b4..f1c37f799 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4.smali
@@ -7,46 +7,22 @@
 
 
 # instance fields
-.field public final synthetic $r8$classId:I
-
 .field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-.field public final synthetic f$1:Ljava/lang/Object;
+.field public final synthetic f$1:Lcom/android/internal/widget/LockscreenCredential;
 
 .field public final synthetic f$2:I
 
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;Landroid/app/admin/PasswordMetrics;I)V
-    .locals 1
-
-    const/4 v0, 0x0
-
-    iput v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->$r8$classId:I
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Ljava/lang/Object;
-
-    iput p3, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$2:I
-
-    return-void
-.end method
-
 .method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
-    .locals 1
-
-    const/4 v0, 0x1
-
-    iput v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->$r8$classId:I
+    .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
     iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Ljava/lang/Object;
+    iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Lcom/android/internal/widget/LockscreenCredential;
 
     iput p3, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$2:I
 
@@ -58,15 +34,9 @@
 .method public final run()V
     .locals 2
 
-    iget v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->$r8$classId:I
-
-    packed-switch v0, :pswitch_data_0
-
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Ljava/lang/Object;
-
-    check-cast v1, Lcom/android/internal/widget/LockscreenCredential;
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Lcom/android/internal/widget/LockscreenCredential;
 
     iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$2:I
 
@@ -93,40 +63,4 @@
     invoke-virtual {v0, p0}, Lcom/android/server/wm/WindowManagerInternal;->reportPasswordChanged(I)V
 
     return-void
-
-    :pswitch_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Ljava/lang/Object;
-
-    check-cast v1, Landroid/app/admin/PasswordMetrics;
-
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$2:I
-
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
-
-    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
-
-    move-result-object v0
-
-    invoke-virtual {v0, v1, p0}, Landroid/app/admin/DevicePolicyManager;->reportPasswordChanged(Landroid/app/admin/PasswordMetrics;I)V
-
-    const-class v0, Lcom/android/server/wm/WindowManagerInternal;
-
-    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/wm/WindowManagerInternal;
-
-    invoke-virtual {v0, p0}, Lcom/android/server/wm/WindowManagerInternal;->reportPasswordChanged(I)V
-
-    return-void
-
-    nop
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5.smali
new file mode 100644
index 000000000..f6bcd6747
--- /dev/null
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5.smali
@@ -0,0 +1,47 @@
+.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;
+.super Ljava/lang/Object;
+.source "qb/102434624 4ec8f6d2813f753a220c00d05e2aa013ded863b1967e4bb65f3969ed08f5cc72"
+
+# interfaces
+.implements Ljava/lang/Runnable;
+
+
+# instance fields
+.field public final synthetic f$0:I
+
+
+# direct methods
+.method public synthetic constructor <init>(I)V
+    .locals 0
+
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+
+    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;->f$0:I
+
+    return-void
+.end method
+
+
+# virtual methods
+.method public final run()V
+    .locals 1
+
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;->f$0:I
+
+    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+
+    const-class v0, Landroid/app/admin/DevicePolicyManagerInternal;
+
+    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object v0
+
+    check-cast v0, Landroid/app/admin/DevicePolicyManagerInternal;
+
+    if-eqz v0, :cond_0
+
+    invoke-virtual {v0, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->reportSeparateProfileChallengeChanged(I)V
+
+    :cond_0
+    return-void
+.end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6.smali
index 46e618029..875acc995 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6.smali
@@ -3,45 +3,88 @@
 .source "SourceFile"
 
 # interfaces
-.implements Ljava/lang/Runnable;
+.implements Ljava/util/function/Function;
 
 
 # instance fields
+.field public final synthetic $r8$classId:I
+
 .field public final synthetic f$0:I
 
 
 # direct methods
-.method public synthetic constructor <init>(I)V
+.method public synthetic constructor <init>(II)V
     .locals 0
 
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+    iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;->$r8$classId:I
 
     iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;->f$0:I
 
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+
     return-void
 .end method
 
 
 # virtual methods
-.method public final run()V
+.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
     .locals 1
 
+    iget v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;->$r8$classId:I
+
     iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;->f$0:I
 
+    check-cast p1, Lcom/android/server/pm/PersonaManagerService;
+
+    packed-switch v0, :pswitch_data_0
+
     sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
 
-    const-class v0, Landroid/app/admin/DevicePolicyManagerInternal;
+    invoke-virtual {p1, p0}, Lcom/android/server/pm/PersonaManagerService;->getPersonaUserHasBeenShutdownBefore(I)Z
 
-    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
+    move-result p0
 
-    move-result-object v0
+    xor-int/lit8 p0, p0, 0x1
 
-    check-cast v0, Landroid/app/admin/DevicePolicyManagerInternal;
+    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
 
-    if-eqz v0, :cond_0
+    move-result-object p0
 
-    invoke-virtual {v0, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->reportSeparateProfileChallengeChanged(I)V
+    return-object p0
 
-    :cond_0
-    return-void
+    :pswitch_0
+    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+
+    invoke-virtual {p1, p0}, Lcom/android/server/pm/PersonaManagerService;->getPersonaUserHasBeenShutdownBefore(I)Z
+
+    move-result p0
+
+    xor-int/lit8 p0, p0, 0x1
+
+    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+
+    move-result-object p0
+
+    return-object p0
+
+    :pswitch_1
+    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+
+    invoke-virtual {p1, p0}, Lcom/android/server/pm/PersonaManagerService;->getPersonaUserHasBeenShutdownBefore(I)Z
+
+    move-result p0
+
+    xor-int/lit8 p0, p0, 0x1
+
+    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+
+    move-result-object p0
+
+    return-object p0
+
+    :pswitch_data_0
+    .packed-switch 0x0
+        :pswitch_1
+        :pswitch_0
+    .end packed-switch
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7.smali
index 64f279f84..167171845 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7.smali
@@ -3,22 +3,22 @@
 .source "SourceFile"
 
 # interfaces
-.implements Ljava/util/function/Function;
+.implements Ljava/util/function/Supplier;
 
 
 # instance fields
 .field public final synthetic $r8$classId:I
 
-.field public final synthetic f$0:I
+.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
 
 
 # direct methods
-.method public synthetic constructor <init>(II)V
+.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;I)V
     .locals 0
 
     iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;->$r8$classId:I
 
-    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;->f$0:I
+    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
@@ -27,63 +27,87 @@
 
 
 # virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
+.method public final get()Ljava/lang/Object;
     .locals 1
 
     iget v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;->$r8$classId:I
 
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;->f$0:I
-
-    check-cast p1, Lcom/android/server/pm/PersonaManagerService;
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
     packed-switch v0, :pswitch_data_0
 
-    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+
+    const v0, 0x104107c
+
+    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
-    invoke-virtual {p1, p0}, Lcom/android/server/pm/PersonaManagerService;->getPersonaUserHasBeenShutdownBefore(I)Z
+    move-result-object p0
 
-    move-result p0
+    return-object p0
 
-    xor-int/lit8 p0, p0, 0x1
+    :pswitch_0
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+    const v0, 0x1040cb2
+
+    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
     move-result-object p0
 
     return-object p0
 
-    :pswitch_0
-    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+    :pswitch_1
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {p1, p0}, Lcom/android/server/pm/PersonaManagerService;->getPersonaUserHasBeenShutdownBefore(I)Z
+    const v0, 0x1040cc3
 
-    move-result p0
+    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
-    xor-int/lit8 p0, p0, 0x1
+    move-result-object p0
 
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+    return-object p0
+
+    :pswitch_2
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+
+    const v0, 0x1040cb6
+
+    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
     move-result-object p0
 
     return-object p0
 
-    :pswitch_1
-    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+    :pswitch_3
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+
+    const v0, 0x1040cc5
 
-    invoke-virtual {p1, p0}, Lcom/android/server/pm/PersonaManagerService;->getPersonaUserHasBeenShutdownBefore(I)Z
+    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
-    move-result p0
+    move-result-object p0
+
+    return-object p0
 
-    xor-int/lit8 p0, p0, 0x1
+    :pswitch_4
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+    const v0, 0x104107d
+
+    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
     move-result-object p0
 
     return-object p0
 
+    nop
+
     :pswitch_data_0
     .packed-switch 0x0
+        :pswitch_4
+        :pswitch_3
+        :pswitch_2
         :pswitch_1
         :pswitch_0
     .end packed-switch
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8.smali
deleted file mode 100644
index 2f77f62ca..000000000
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8.smali
+++ /dev/null
@@ -1,114 +0,0 @@
-.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Supplier;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;I)V
-    .locals 0
-
-    iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;->$r8$classId:I
-
-    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final get()Ljava/lang/Object;
-    .locals 1
-
-    iget v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;->$r8$classId:I
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    packed-switch v0, :pswitch_data_0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    const v0, 0x104107c
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_0
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    const v0, 0x1040cb2
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_1
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    const v0, 0x1040cc3
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_2
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    const v0, 0x1040cb6
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_3
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    const v0, 0x1040cc5
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_4
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    const v0, 0x104107d
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
-
-    move-result-object p0
-
-    return-object p0
-
-    nop
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_4
-        :pswitch_3
-        :pswitch_2
-        :pswitch_1
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$2.smali b/smali/com/android/server/locksettings/LockSettingsService$2.smali
index 9968225cf..095f65610 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$2.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$2.smali
@@ -129,36 +129,23 @@
 
     iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$2;->val$userId:I
 
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
 
-    invoke-virtual {v1, p0}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_1
-
-    const-string/jumbo v0, "Unlocking user - Dualdar user "
-
-    const-string/jumbo v1, "LockSettingsService.SDP"
-
-    invoke-static {p0, v0, v1}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
+    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :cond_1
-    if-nez p0, :cond_3
+    if-nez p0, :cond_2
 
     invoke-static {}, Landroid/os/storage/StorageManager;->isFileEncrypted()Z
 
     move-result v1
 
-    if-eqz v1, :cond_3
+    if-eqz v1, :cond_2
 
     invoke-virtual {v0, p0}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
 
     move-result v1
 
-    if-nez v1, :cond_3
+    if-nez v1, :cond_2
 
     iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
@@ -170,13 +157,13 @@
 
     move-result-object p0
 
-    :cond_2
+    :cond_1
     :goto_1
     invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
 
     move-result v1
 
-    if-eqz v1, :cond_3
+    if-eqz v1, :cond_2
 
     invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -188,13 +175,13 @@
 
     move-result v2
 
-    if-eqz v2, :cond_2
+    if-eqz v2, :cond_1
 
     invoke-virtual {v0, v1}, Lcom/android/server/locksettings/LockSettingsService;->UnlockSecureFolderIfAutoDataDecryption(Landroid/content/pm/UserInfo;)V
 
     goto :goto_1
 
-    :cond_3
+    :cond_2
     return-void
 
     :catchall_0
diff --git a/smali/com/android/server/locksettings/LockSettingsService$3.smali b/smali/com/android/server/locksettings/LockSettingsService$3.smali
index 7b753be8d..033bb34f5 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$3.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$3.smali
@@ -25,7 +25,7 @@
 
 # virtual methods
 .method public final onReceive(Landroid/content/Context;Landroid/content/Intent;)V
-    .locals 10
+    .locals 7
 
     iget p1, p0, Lcom/android/server/locksettings/LockSettingsService$3;->$r8$classId:I
 
@@ -41,17 +41,13 @@
 
     move-result p1
 
-    const/4 v0, -0x1
-
-    const-string/jumbo v1, "urid"
-
     if-eqz p1, :cond_0
 
     const-string/jumbo p1, "LockSettingsService.SDP"
 
-    const-string/jumbo v2, "onReceive :: android.intent.action.DUMP_SYNTHETIC_PASSWORD"
+    const-string/jumbo v0, "onReceive :: android.intent.action.DUMP_SYNTHETIC_PASSWORD"
 
-    invoke-static {p1, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {p1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     const-string/jumbo p1, "cred"
 
@@ -61,7 +57,11 @@
 
     invoke-virtual {p2, p1}, Landroid/content/Intent;->getStringExtra(Ljava/lang/String;)Ljava/lang/String;
 
-    invoke-virtual {p2, v1, v0}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
+    const-string/jumbo p1, "urid"
+
+    const/4 v0, -0x1
+
+    invoke-virtual {p2, p1, v0}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$3;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
@@ -75,325 +75,7 @@
 
     invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto/16 :goto_3
-
     :cond_0
-    const-string/jumbo p1, "android.intent.action.DUMP_DUALDAR_PASSWORD"
-
-    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {p1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    const-string/jumbo v2, "LockSettingsService.DUALDAR"
-
-    const/4 v3, 0x0
-
-    if-eqz p1, :cond_2
-
-    const-string/jumbo p1, "onReceive :: android.intent.action.DUMP_DUALDAR_PASSWORD"
-
-    new-array v4, v3, [Ljava/lang/Object;
-
-    invoke-static {v2, p1, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p2, v1, v0}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
-
-    move-result p1
-
-    const-string/jumbo v0, "path"
-
-    invoke-virtual {p2, v0}, Landroid/content/Intent;->getStringExtra(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p2
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$3;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-    move-result-object p0
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    if-nez v0, :cond_1
-
-    new-array p0, v3, [Ljava/lang/Object;
-
-    const-string p1, "DualDARDaemonProxy"
-
-    const-string/jumbo p2, "dumpSecret failed! Error: native interface not yet connected failed"
-
-    invoke-static {p1, p2, p0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto/16 :goto_3
-
-    :cond_1
-    const-string/jumbo v0, "dumpSecret() - userId : "
-
-    const-string v1, ", filePath : "
-
-    invoke-static {p1, v0, v1, p2}, Lcom/android/server/accessibility/AccessibilityManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v1, v3, [Ljava/lang/Object;
-
-    const-string v2, "DualDARDaemonProxy.DUALDAR"
-
-    invoke-static {v2, v0, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mConnector:Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;
-
-    const-string/jumbo v1, "key"
-
-    const-string/jumbo v2, "key_dump"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    filled-new-array {p1, p2}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    invoke-virtual {v0, v1, v2, p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDarDaemonConnector;->executeSync(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-virtual {p1}, Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;->isClassOk()Z
-
-    move-result p1
-
-    if-nez p1, :cond_8
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->mEvent:Lcom/android/server/knox/dar/ddar/nativedaemon/NativeDaemonEvent;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto/16 :goto_3
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    goto/16 :goto_3
-
-    :cond_2
-    const-string/jumbo p1, "android.intent.action.CHECK_DUALDAR_POLICY_PACKAGES"
-
-    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {p1, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_8
-
-    const-string/jumbo p1, "onReceive :: android.intent.action.CHECK_DUALDAR_POLICY_PACKAGES"
-
-    new-array v4, v3, [Ljava/lang/Object;
-
-    invoke-static {v2, p1, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p2, v1, v0}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
-
-    move-result p1
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$3;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string p2, "/data/user/"
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v0
-
-    const-string v1, "DualDarDoPolicyChecker"
-
-    if-nez v0, :cond_3
-
-    const-string/jumbo p0, "Not a DualDAR at DO user - "
-
-    invoke-static {p1, p0, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    goto/16 :goto_3
-
-    :cond_3
-    new-instance v0, Ljava/util/ArrayList;
-
-    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V
-
-    new-instance v2, Ljava/util/ArrayList;
-
-    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V
-
-    sget-object v4, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;->sContext:Landroid/content/Context;
-
-    invoke-static {v4}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
-
-    move-result-object v4
-
-    :try_start_1
-    new-instance v5, Ljava/io/File;
-
-    new-instance v6, Ljava/lang/StringBuilder;
-
-    invoke-direct {v6, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-direct {v5, p2}, Ljava/io/File;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v5}, Ljava/io/File;->listFiles()[Ljava/io/File;
-
-    move-result-object p2
-
-    array-length v5, p2
-
-    move v6, v3
-
-    :goto_0
-    if-ge v6, v5, :cond_7
-
-    aget-object v7, p2, v6
-
-    invoke-virtual {v7}, Ljava/io/File;->isDirectory()Z
-
-    move-result v8
-
-    if-eqz v8, :cond_6
-
-    invoke-virtual {v7}, Ljava/io/File;->getName()Ljava/lang/String;
-
-    move-result-object v8
-
-    iget-object v9, p0, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;->skippedPackages:Ljava/util/List;
-
-    if-eqz v9, :cond_5
-
-    check-cast v9, Ljava/util/ArrayList;
-
-    invoke-virtual {v9}, Ljava/util/ArrayList;->isEmpty()Z
-
-    move-result v9
-
-    if-eqz v9, :cond_4
-
-    goto :goto_1
-
-    :cond_4
-    iget-object v9, p0, Lcom/android/server/knox/dar/ddar/DualDarDoPolicyChecker;->skippedPackages:Ljava/util/List;
-
-    check-cast v9, Ljava/util/ArrayList;
-
-    invoke-virtual {v9, v8}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z
-
-    move-result v9
-
-    goto :goto_2
-
-    :cond_5
-    :goto_1
-    move v9, v3
-
-    :goto_2
-    if-nez v9, :cond_6
-
-    invoke-virtual {v7}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v4, v7, v0}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->hasDualDARPolicyRecursively(Ljava/lang/String;Ljava/util/List;)Z
-
-    move-result v7
-
-    if-nez v7, :cond_6
-
-    new-instance v7, Ljava/lang/StringBuilder;
-
-    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v9, "ddar policy mismatch on user directory : "
-
-    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-static {v1, v7}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_6
-    add-int/lit8 v6, v6, 0x1
-
-    goto :goto_0
-
-    :cond_7
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string p2, "/data/media/"
-
-    invoke-virtual {p0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string p1, "/Android/data"
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {v4, p0, v2}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->hasDualDARPolicyRecursively(Ljava/lang/String;Ljava/util/List;)Z
-
-    move-result p0
-
-    if-nez p0, :cond_8
-
-    const-string/jumbo p0, "ddar policy mismatch on media directory"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1
-
-    goto :goto_3
-
-    :catch_1
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :cond_8
-    :goto_3
     return-void
 
     :pswitch_0
@@ -409,7 +91,7 @@
 
     const/4 v0, 0x0
 
-    if-eqz p1, :cond_9
+    if-eqz p1, :cond_1
 
     const-string/jumbo p1, "android.intent.extra.user_handle"
 
@@ -423,9 +105,9 @@
 
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->prefetchUser(I)V
 
-    goto/16 :goto_6
+    goto/16 :goto_2
 
-    :cond_9
+    :cond_1
     const-string/jumbo p1, "android.intent.action.LOCALE_CHANGED"
 
     invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
@@ -436,7 +118,7 @@
 
     move-result p1
 
-    if-eqz p1, :cond_c
+    if-eqz p1, :cond_4
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$3;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
@@ -450,13 +132,13 @@
 
     move-result-object p1
 
-    :cond_a
-    :goto_4
+    :cond_2
+    :goto_0
     invoke-interface {p1}, Ljava/util/Iterator;->hasNext()Z
 
     move-result v1
 
-    if-eqz v1, :cond_e
+    if-eqz v1, :cond_5
 
     invoke-interface {p1}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -492,8 +174,8 @@
 
     move v4, v0
 
-    :goto_5
-    if-ge v4, v3, :cond_a
+    :goto_1
+    if-ge v4, v3, :cond_2
 
     aget-object v5, v2, v4
 
@@ -503,7 +185,7 @@
 
     const/16 v6, 0x9
 
-    if-ne v5, v6, :cond_b
+    if-ne v5, v6, :cond_3
 
     iget v1, v1, Landroid/content/pm/UserInfo;->id:I
 
@@ -511,15 +193,15 @@
 
     invoke-virtual {p0, v1, v2}, Lcom/android/server/locksettings/LockSettingsService;->maybeShowEncryptionNotificationForUser(ILjava/lang/String;)V
 
-    goto :goto_4
+    goto :goto_0
 
-    :cond_b
+    :cond_3
     add-int/lit8 v4, v4, 0x1
 
-    goto :goto_5
+    goto :goto_1
 
-    :cond_c
-    const-string/jumbo p1, "android.intent.action.MANAGED_PROFILE_ADDED"
+    :cond_4
+    const-string/jumbo p1, "com.samsung.intent.action.LAZY_BOOT_COMPLETE"
 
     invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
@@ -529,100 +211,13 @@
 
     move-result p1
 
-    const/4 v0, 0x1
-
-    if-eqz p1, :cond_d
-
-    const-string/jumbo p1, "android.intent.extra.USER"
-
-    invoke-virtual {p2, p1}, Landroid/content/Intent;->getExtra(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Landroid/os/UserHandle;
-
-    invoke-virtual {p1}, Landroid/os/UserHandle;->getIdentifier()I
-
-    move-result p1
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_e
-
-    const-string/jumbo v1, "OnUserAdded(): Setup SeparateCredential for DualDAR User : "
-
-    const-string/jumbo v2, "LockSettingsService"
-
-    invoke-static {p1, v1, v2}, Lcom/android/server/AnyMotionDetector$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$3;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    const/4 v3, 0x0
-
-    invoke-virtual {v1, p1, v0, v3}, Lcom/android/server/locksettings/LockSettingsService;->setSeparateProfileChallengeEnabled(IZLcom/android/internal/widget/LockscreenCredential;)V
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "OnUserAdded(): Successfully added OLK to vold for DualDAR User : "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v2, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "reportEnabledTrustAgentsChanged for DualDAR User : "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v2, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+    if-eqz p1, :cond_5
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$3;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    const-class v0, Landroid/app/trust/TrustManager;
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
+    const/4 p1, 0x1
 
-    move-result-object p0
-
-    check-cast p0, Landroid/app/trust/TrustManager;
-
-    invoke-virtual {p0, p1}, Landroid/app/trust/TrustManager;->reportEnabledTrustAgentsChanged(I)V
-
-    goto :goto_6
-
-    :cond_d
-    const-string/jumbo p1, "com.samsung.intent.action.LAZY_BOOT_COMPLETE"
-
-    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {p1, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_e
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$3;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iput-boolean v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mLazyBootCompleted:Z
+    iput-boolean p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mLazyBootCompleted:Z
 
     new-instance p0, Ljava/lang/StringBuilder;
 
@@ -642,8 +237,8 @@
 
     invoke-static {p0}, Lcom/samsung/android/lock/LsLog;->events(Ljava/lang/String;)V
 
-    :cond_e
-    :goto_6
+    :cond_5
+    :goto_2
     const-string/jumbo p0, "android.intent.action.LOCKED_BOOT_COMPLETED"
 
     invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
@@ -664,13 +259,13 @@
 
     move-result p1
 
-    if-nez p1, :cond_f
+    if-nez p1, :cond_6
 
-    if-nez p0, :cond_f
+    if-nez p0, :cond_6
 
-    goto :goto_7
+    goto :goto_3
 
-    :cond_f
+    :cond_6
     const-string/jumbo p0, "ro.boot.bootreason"
 
     const-string/jumbo p1, "Unknown"
@@ -713,11 +308,9 @@
 
     invoke-static {p0}, Lcom/samsung/android/lock/LsLog;->events(Ljava/lang/String;)V
 
-    :goto_7
+    :goto_3
     return-void
 
-    nop
-
     :pswitch_data_0
     .packed-switch 0x0
         :pswitch_0
diff --git a/smali/com/android/server/locksettings/LockSettingsService$4.smali b/smali/com/android/server/locksettings/LockSettingsService$4.smali
index b1dd37ddc..9790811be 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$4.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$4.smali
@@ -36,11 +36,11 @@
 
     iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;
 
     const/4 v2, 0x2
 
-    invoke-direct {v1, p1, v2, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;-><init>(IILjava/lang/Object;)V
+    invoke-direct {v1, p1, v2, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;-><init>(IILjava/lang/Object;)V
 
     invoke-virtual {v0, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
diff --git a/smali/com/android/server/locksettings/LockSettingsService$DarLockSettings.smali b/smali/com/android/server/locksettings/LockSettingsService$DarLockSettings.smali
index 72404f1cf..db162adf0 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$DarLockSettings.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$DarLockSettings.smali
@@ -425,78 +425,52 @@
 .end method
 
 .method public final saveEscrowDataIfNeededLocked(I)V
-    .locals 10
+    .locals 9
 
-    const/4 v0, 0x1
-
-    sget-boolean v1, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    const-string/jumbo v2, "sdp-mdfppmode-for-system"
+    const-string/jumbo v1, "sdp-mdfppmode-for-system"
 
-    const-wide/16 v3, 0x0
+    const-wide/16 v2, 0x0
 
-    const/4 v5, 0x0
+    const/4 v4, 0x0
 
-    invoke-virtual {v1, v2, v3, v4, v5}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
-    move-result-wide v6
+    move-result-wide v5
 
-    const-wide/16 v8, 0x1
+    const-wide/16 v7, 0x1
 
-    cmp-long v6, v6, v8
+    cmp-long v5, v5, v7
 
-    if-nez v6, :cond_0
+    if-nez v5, :cond_0
 
     goto :goto_0
 
     :cond_0
-    invoke-virtual {v1, v2, v3, v4, v5}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
-    move-result-wide v2
+    move-result-wide v0
 
-    const-wide/16 v6, 0x2
+    const-wide/16 v2, 0x2
 
-    cmp-long v2, v2, v6
+    cmp-long v0, v0, v2
 
-    if-ltz v2, :cond_1
+    if-ltz v0, :cond_1
 
     :goto_0
-    move v2, v0
-
-    goto :goto_1
+    return-void
 
     :cond_1
-    move v2, v5
-
-    :goto_1
-    invoke-virtual {v1, p1}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_2
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_2
-
-    move v5, v0
-
-    :cond_2
-    if-nez v2, :cond_3
-
-    if-nez v5, :cond_3
-
-    if-nez p1, :cond_3
+    if-nez p1, :cond_2
 
-    const/4 v1, 0x0
+    const/4 v0, 0x0
 
-    const-string/jumbo v2, "saveEscrowDataIfNeededLocked for system"
+    const-string/jumbo v1, "saveEscrowDataIfNeededLocked for system"
 
-    invoke-static {v1, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v0, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
 
@@ -504,13 +478,15 @@
 
     move-result-object p0
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;
+    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;
 
-    invoke-direct {v1, p1, v0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;-><init>(II)V
+    const/4 v1, 0x1
 
-    invoke-virtual {p0, v1}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
+    invoke-direct {v0, p1, v1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;-><init>(II)V
 
-    :cond_3
+    invoke-virtual {p0, v0}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
+
+    :cond_2
     return-void
 .end method
 
@@ -533,30 +509,18 @@
 
     invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    if-nez p1, :cond_0
-
-    goto :goto_0
-
-    :cond_0
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
 
-    :goto_0
-    if-nez p1, :cond_1
-
-    goto :goto_1
-
-    :cond_1
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
-    :goto_1
-    if-nez p2, :cond_2
+    if-nez p2, :cond_0
 
-    goto :goto_2
+    goto :goto_0
 
-    :cond_2
+    :cond_0
     invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
 
-    :goto_2
+    :goto_0
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
     move-result-wide v0
@@ -565,43 +529,41 @@
 
     const/4 v3, 0x0
 
-    if-eqz p1, :cond_5
-
     :try_start_0
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v4
 
-    if-nez v4, :cond_5
+    if-nez v4, :cond_3
 
-    if-eqz p2, :cond_3
+    if-eqz p2, :cond_1
 
     invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result p2
 
-    if-nez p2, :cond_3
+    if-nez p2, :cond_1
 
-    goto :goto_3
+    goto :goto_1
 
     :catchall_0
     move-exception p0
 
-    goto :goto_7
+    goto :goto_5
 
     :catch_0
     move-exception p0
 
-    goto :goto_5
+    goto :goto_3
 
-    :cond_3
+    :cond_1
     sget-boolean p2, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
 
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isSyntheticPasswordBasedCredentialLocked(I)Z
 
     move-result p2
 
-    if-eqz p2, :cond_4
+    if-eqz p2, :cond_2
 
     const-string/jumbo p2, "Secure Folder already has sp based credential"
 
@@ -613,18 +575,18 @@
 
     move-result p0
 
-    if-eqz p0, :cond_6
+    if-eqz p0, :cond_4
 
     sget-object v2, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    goto :goto_4
+    goto :goto_2
 
-    :cond_4
+    :cond_2
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isSyntheticPasswordBasedCredentialLocked(I)Z
 
     move-result p0
 
-    if-nez p0, :cond_6
+    if-nez p0, :cond_4
 
     const-string/jumbo p0, "Secure Folder seems to need sp initialization first"
 
@@ -632,10 +594,10 @@
 
     sget-object v2, Lcom/android/internal/widget/VerifyCredentialResponse;->SKIP:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    goto :goto_4
+    goto :goto_2
 
-    :cond_5
-    :goto_3
+    :cond_3
+    :goto_1
     const-string/jumbo p0, "Seems normal case, skip handling"
 
     invoke-static {v3, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
@@ -645,13 +607,13 @@
     .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    :cond_6
-    :goto_4
+    :cond_4
+    :goto_2
     invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    goto :goto_6
+    goto :goto_4
 
-    :goto_5
+    :goto_3
     :try_start_1
     const-string/jumbo p1, "Unexpected exception while set sf credential"
 
@@ -659,9 +621,9 @@
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    goto :goto_4
+    goto :goto_2
 
-    :goto_6
+    :goto_4
     invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object p0
@@ -684,7 +646,7 @@
 
     return-object v2
 
-    :goto_7
+    :goto_5
     invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw p0
@@ -707,33 +669,9 @@
 
     invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    if-nez p1, :cond_0
-
-    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v0
-
-    goto :goto_0
-
-    :cond_0
-    move-object v0, p1
-
-    :goto_0
-    invoke-virtual {v0}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    if-nez p1, :cond_1
-
-    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v0
-
-    goto :goto_1
-
-    :cond_1
-    move-object v0, p1
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
 
-    :goto_1
-    invoke-virtual {v0}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
     sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
 
@@ -749,7 +687,7 @@
 
     const-wide/16 v2, 0x0
 
-    if-eqz v1, :cond_3
+    if-eqz v1, :cond_1
 
     iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
 
@@ -761,7 +699,7 @@
 
     move-result-object v1
 
-    if-eqz v1, :cond_2
+    if-eqz v1, :cond_0
 
     sget-object v4, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
 
@@ -783,9 +721,9 @@
 
     move-result-wide v4
 
-    goto :goto_2
+    goto :goto_0
 
-    :cond_2
+    :cond_0
     const-string v1, "DarManagerService"
 
     const-string/jumbo v4, "get SecureFolder Token Handle Failed"
@@ -794,28 +732,28 @@
 
     move-wide v4, v2
 
-    :goto_2
+    :goto_0
     move-wide v8, v4
 
-    goto :goto_3
+    goto :goto_1
 
-    :cond_3
+    :cond_1
     move-wide v8, v2
 
-    :goto_3
+    :goto_1
     cmp-long v1, v8, v2
 
     const/4 v2, 0x0
 
-    if-nez v1, :cond_4
+    if-nez v1, :cond_2
 
     const-string p0, "Failed to get SecureFolder token handle"
 
     invoke-static {v2, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    goto :goto_4
+    goto :goto_2
 
-    :cond_4
+    :cond_2
     iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
 
     invoke-virtual {v0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
@@ -830,20 +768,20 @@
 
     move-result v0
 
-    if-eqz v0, :cond_5
+    if-eqz v0, :cond_3
 
     const-string p0, "Failed to get SecureFolder reset token"
 
     invoke-static {v2, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    :goto_4
+    :goto_2
     const/4 p0, 0x0
 
     move v11, p2
 
-    goto :goto_5
+    goto :goto_3
 
-    :cond_5
+    :cond_3
     iget-object v6, p0, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
 
     move-object v7, p1
@@ -856,7 +794,7 @@
 
     invoke-static {v10}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
 
-    :goto_5
+    :goto_3
     invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object p1
diff --git a/smali/com/android/server/locksettings/LockSettingsService$DualDarLockSettings.smali b/smali/com/android/server/locksettings/LockSettingsService$DualDarLockSettings.smali
new file mode 100644
index 000000000..d2da86c06
--- /dev/null
+++ b/smali/com/android/server/locksettings/LockSettingsService$DualDarLockSettings.smali
@@ -0,0 +1,3 @@
+.class public final Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
+.super Ljava/lang/Object;
+.source "SourceFile"
diff --git a/smali/com/android/server/locksettings/LockSettingsService$Injector$1.smali b/smali/com/android/server/locksettings/LockSettingsService$Injector$1.smali
index 68b39d716..29030c236 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$Injector$1.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$Injector$1.smali
@@ -21,1826 +21,81 @@
     return-void
 .end method
 
-.method public static prepare(I)V
-    .locals 4
 
-    new-instance v0, Ljava/io/File;
-
-    new-instance v1, Ljava/io/File;
-
-    invoke-static {}, Landroid/os/Environment;->getDataSystemDirectory()Ljava/io/File;
-
-    move-result-object v2
-
-    const-string/jumbo v3, "users"
-
-    invoke-direct {v1, v2, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-static {p0}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-direct {v0, v1, v2}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/io/File;->exists()Z
-
-    move-result v1
-
-    if-nez v1, :cond_1
-
-    invoke-virtual {v0}, Ljava/io/File;->mkdir()Z
-
-    move-result v1
-
-    if-nez v1, :cond_0
-
-    const-string/jumbo v0, "prepare - failed to create sp state path for user "
-
-    const-string/jumbo v1, "LockSettingsService.DarVirtualLock"
-
-    invoke-static {p0, v0, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :cond_0
-    invoke-virtual {v0}, Ljava/io/File;->getPath()Ljava/lang/String;
-
-    move-result-object p0
-
-    const/16 v0, 0x1f9
-
-    const/4 v1, -0x1
-
-    invoke-static {p0, v0, v1, v1}, Landroid/os/FileUtils;->setPermissions(Ljava/lang/String;III)I
-
-    :cond_1
-    return-void
-.end method
-
-
-# virtual methods
-.method public activateEscrowTokenForDualDAR(JI[B[B)V
-    .locals 7
-
-    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v1
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {v0, p3}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
-
-    move-result v2
-
-    move-wide v4, p1
-
-    move-object v6, p4
-
-    move-object v3, p5
-
-    invoke-virtual/range {v1 .. v6}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->setResetPasswordToken(I[BJ[B)Z
-
-    move-result p1
-
-    const/4 p2, 0x0
-
-    const-string/jumbo p4, "LockSettingsService"
-
-    if-eqz p1, :cond_0
-
-    const-string/jumbo p0, "Successfully activated reset pwd token for Dual DAR user: "
-
-    invoke-static {p3, p0}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, p2, [Ljava/lang/Object;
-
-    invoke-static {p4, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return-void
-
-    :cond_0
-    const-string p1, "Failed to activate escrow token for Dual DAR user: "
-
-    const-string p5, " because client failed to activate reset pwd token"
-
-    invoke-static {p3, p1, p5}, Lcom/android/server/BinaryTransparencyService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array p2, p2, [Ljava/lang/Object;
-
-    invoke-static {p4, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0, v4, v5, p3}, Lcom/android/server/locksettings/LockSettingsService;->removeEscrowToken(JI)Z
-
-    :cond_1
-    return-void
-.end method
-
-.method public activateEscrowTokensForDualDAR(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I[B)V
-    .locals 10
-
-    const-string/jumbo v0, "LockSettingsService"
-
-    const-string/jumbo v1, "activateEscrowTokens: user="
-
-    invoke-static {p2, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    const/4 v2, 0x0
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v1
-
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v0, p2}, Lcom/android/server/locksettings/LockSettingsService;->disableEscrowTokenOnNonManagedDevicesIfNeeded(I)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v0, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getPendingTokensForUser(I)Ljava/util/Set;
-
-    move-result-object v0
-
-    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
-
-    move-result-object v0
-
-    :goto_0
-    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_1
-
-    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Ljava/lang/Long;
-
-    invoke-virtual {v3}, Ljava/lang/Long;->longValue()J
-
-    move-result-wide v5
-
-    const-string/jumbo v4, "LockSettingsService"
-
-    const-string/jumbo v7, "activateEscrowTokens: %x %d "
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v8
-
-    filled-new-array {v3, v8}, [Ljava/lang/Object;
-
-    move-result-object v3
-
-    invoke-static {v7, v3}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v3
-
-    new-array v7, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, v3, v7}, Lcom/android/server/knox/dar/ddar/DDLog;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0, p2, v5, v6}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->getPendingTokenForDualDAR(IJ)[B
-
-    move-result-object v8
-
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v3, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v3, v3, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v3, p2, v5, v6, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createTokenBasedProtector(IJLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_0
-
-    move-object v4, p0
-
-    move v7, p2
-
-    move-object v9, p3
-
-    invoke-virtual/range {v4 .. v9}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->activateEscrowTokenForDualDAR(JI[B[B)V
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_2
-
-    :cond_0
-    move-object v4, p0
-
-    move v7, p2
-
-    move-object v9, p3
-
-    :goto_1
-    move-object p0, v4
-
-    move p2, v7
-
-    move-object p3, v9
-
-    goto :goto_0
-
-    :cond_1
-    monitor-exit v1
-
-    return-void
-
-    :goto_2
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
-.method public doVerifyCredentialForDualDAR(Lcom/android/internal/widget/LockscreenCredential;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 9
-
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_8
-
-    invoke-static {p2}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncrypted(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_8
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto/16 :goto_2
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v1
-
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isSyntheticPasswordBasedCredentialLocked(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    const/4 p0, 0x0
-
-    monitor-exit v1
-
-    return-object p0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto/16 :goto_1
-
-    :cond_1
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v0, p2}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
-
-    move-result-wide v4
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v3
-
-    const/4 v8, 0x0
-
-    move-object v6, p1
-
-    move v7, p2
-
-    invoke-virtual/range {v2 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
-
-    move-result-object p1
-
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p2, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {p2, v7}, Lcom/android/server/locksettings/LockSettingsService;->getCredentialType(I)I
-
-    move-result p2
-
-    invoke-virtual {v6}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v0
-
-    const/4 v2, 0x0
-
-    if-eq p2, v0, :cond_2
-
-    const-string/jumbo p0, "LockSettingsService"
-
-    const-string p1, "Credential type mismatch."
-
-    new-array p2, v2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    monitor-exit v1
-
-    return-object p0
-
-    :cond_2
-    iget-object p1, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
-
-    move-result p2
-
-    if-nez p2, :cond_5
-
-    invoke-virtual {v6}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object p1
-
-    const-string/jumbo p2, "onPassword2Auth()"
-
-    const-string/jumbo v0, "LockSettingsService"
-
-    invoke-static {v0, p2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, v7}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
-
-    move-result p2
-
-    if-nez p2, :cond_3
-
-    const-string/jumbo p1, "User is not DualDAR eligible. so no need to verify DualDAR Passwords"
-
-    invoke-static {v7, p1, v0}, Lcom/android/server/AnyMotionDetector$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    sget-object p1, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    goto :goto_0
-
-    :cond_3
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p2, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {p2}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p2
-
-    invoke-virtual {p2, v7, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Auth(I[B)Z
-
-    move-result p1
-
-    if-nez p1, :cond_4
-
-    const-string p1, "Authentication Failure by dual dar client"
-
-    invoke-static {v0, p1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    sget-object p1, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    goto :goto_0
-
-    :cond_4
-    const-string/jumbo p1, "onPassword2Auth completed sucessfully"
-
-    invoke-static {v0, p1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    sget-object p1, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v7, p1}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    sget-object p1, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    :goto_0
-    invoke-virtual {p1}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
-
-    move-result p2
-
-    if-eqz p2, :cond_5
-
-    const-string/jumbo p0, "LockSettingsService"
-
-    const-string/jumbo p1, "verifyChallenge for DualDAR failed."
-
-    new-array p2, v2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-
-    :cond_5
-    invoke-virtual {p1}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
-
-    move-result p2
-
-    if-nez p2, :cond_6
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p0, v7}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->onCredentialMismatchedForInner(I)V
-
-    return-object p1
-
-    :cond_6
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p0, v6, v7}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->onCredentialVerifiedForInner(Lcom/android/internal/widget/LockscreenCredential;I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_7
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-
-    :cond_7
-    return-object p1
-
-    :goto_1
-    :try_start_1
-    monitor-exit v1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_8
-    :goto_2
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-.end method
-
-.method public getPendingTokenForDualDAR(IJ)[B
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v1, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v1, p1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getPendingTokenForDualDar(IJ)[B
-
-    move-result-object p2
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->getSecureMode(I)I
-
-    move-result p0
-
-    if-gtz p0, :cond_2
-
-    const/4 p0, 0x0
-
-    if-eqz p2, :cond_0
-
-    array-length p1, p2
-
-    add-int/lit8 p1, p1, -0x40
-
-    goto :goto_0
-
-    :cond_0
-    move p1, p0
-
-    :goto_0
-    if-lez p1, :cond_2
-
-    new-array p3, p1, [B
-
-    invoke-static {p2, p0, p3, p0, p1}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
-
-    sget-object p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mSecureModeCache:Landroid/util/SparseArray;
-
-    if-nez p1, :cond_1
-
-    return-object p3
-
-    :cond_1
-    sget-object p0, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;
-
-    const-string p1, "KeyEncryptionKey"
-
-    invoke-virtual {p1, p0}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
-
-    move-result-object p1
-
-    const-string p2, "ForResetPasswordToken"
-
-    invoke-virtual {p2, p0}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
-
-    move-result-object p0
-
-    new-instance p2, Lcom/android/server/locksettings/SP800Derive;
-
-    invoke-direct {p2, p3}, Lcom/android/server/locksettings/SP800Derive;-><init>([B)V
-
-    invoke-virtual {p2, p1, p0}, Lcom/android/server/locksettings/SP800Derive;->withContext([B[B)[B
-
-    move-result-object p0
-
-    return-object p0
-
-    :cond_2
-    return-object p2
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-.method public initializeSyntheticPasswordForVirtualUser(I)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-    .locals 11
-
-    const-string/jumbo v0, "Successfully initialized sp for virtual user "
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string v2, "Initialize sp for virtual user "
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v1, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v1
-
-    :try_start_0
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v2, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v2, v2, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v2, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->newSyntheticPassword(I)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    move-result-object v9
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v2, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v3, v2, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v2}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v4
-
-    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v8
-
-    const/4 v5, 0x0
-
-    const-wide/16 v6, 0x0
-
-    move v10, p1
-
-    invoke-virtual/range {v3 .. v10}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
-
-    move-result-wide v2
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p1, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {p1, v10, v2, v3}, Lcom/android/server/locksettings/LockSettingsService;->setCurrentLskfBasedProtectorId(IJ)V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    const/4 p1, 0x1
-
-    invoke-virtual {p0, v10, v9, p1}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordKnown(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Z)V
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    monitor-exit v1
-
-    return-object v9
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
-.method public isDualDARUser(I)Z
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getUserManagerInternal()Lcom/android/server/pm/UserManagerInternal;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerInternal;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    iget p0, p0, Landroid/content/pm/UserInfo;->flags:I
-
-    const/high16 p1, 0x6000000
-
-    and-int/2addr p0, p1
-
-    if-lez p0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public isInnerAuthUserForDualDarDo(I)Z
-    .locals 1
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {p0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public migrateWithAuthToken(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-    .locals 0
-
-    if-nez p2, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result p2
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    if-nez p2, :cond_2
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p2, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_1
-
-    goto :goto_1
-
-    :cond_1
-    :goto_0
-    return-void
-
-    :cond_2
-    :goto_1
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_4
-
-    const-class p0, Lcom/android/server/knox/dar/sdp/SdpManagerInternal;
-
-    invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    if-nez p0, :cond_3
-
-    const/4 p0, 0x0
-
-    invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance p1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;
-
-    const/4 p2, 0x2
-
-    invoke-direct {p1, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;-><init>(I)V
-
-    invoke-virtual {p0, p1}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    return-void
-
-    :cond_3
-    new-instance p0, Ljava/lang/ClassCastException;
-
-    invoke-direct {p0}, Ljava/lang/ClassCastException;-><init>()V
-
-    throw p0
-
-    :cond_4
-    return-void
-.end method
-
-.method public onCredentialMismatchedForInner(I)V
-    .locals 2
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isInnerAuthUserForDualDarDo(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    goto :goto_1
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
-
-    invoke-virtual {p0, p1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;
-
-    if-eqz p0, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mDualDARCallback:Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-eqz p0, :cond_1
-
-    :try_start_1
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->mCallback:Ljava/lang/Object;
-
-    check-cast p0, Lcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;
-
-    if-eqz p0, :cond_1
-
-    invoke-interface {p0}, Lcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;->onInnerLayerUnlockFailed()V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_2
-
-    :catch_0
-    move-exception p0
-
-    :try_start_2
-    const-string/jumbo p1, "LockSettingsService.DarVirtualLock"
-
-    const-string v1, "Callback might be dead..."
-
-    invoke-static {p0, p1, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_1
-    :goto_0
-    monitor-exit v0
-
-    :goto_1
-    return-void
-
-    :goto_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-.end method
-
-.method public onCredentialVerifiedForInner(Lcom/android/internal/widget/LockscreenCredential;I)Z
-    .locals 5
-
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isInnerAuthUserForDualDarDo(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    goto/16 :goto_6
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {v0, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
-
-    move-result v0
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v1, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {v1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v1
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v2
-
-    const/4 v3, 0x0
-
-    if-eqz v2, :cond_1
-
-    move-object v2, v3
-
-    goto :goto_0
-
-    :cond_1
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object v2
-
-    :goto_0
-    invoke-virtual {v1, v0, v2}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Auth(I[B)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_4
-
-    const-string/jumbo v1, "LockSettingsService.DarVirtualLock"
-
-    const-string v2, "Inner-layer authenticated with auth user "
-
-    invoke-static {p2, v2, v1}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v1, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v1, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->setUserPasswordMetrics(Lcom/android/internal/widget/LockscreenCredential;I)V
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p1, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p1, p1, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
-
-    monitor-enter p1
-
-    :try_start_0
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p2, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
-
-    invoke-virtual {p2, v0}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
-
-    move-result-object p2
-
-    check-cast p2, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;
-
-    if-eqz p2, :cond_3
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v1, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v2, p2, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mSyntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    iget-object v4, p2, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mPasswordMetrics:Landroid/app/admin/PasswordMetrics;
-
-    invoke-virtual {v1, v2, v4, v0}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
-
-    sget-object v1, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DEVICE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v0, v1}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    sget-object v1, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v0, v1}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mDualDARCallback:Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    :try_start_1
-    iget-object v1, p2, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->mCallback:Ljava/lang/Object;
-
-    check-cast v1, Lcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;
-
-    if-eqz v1, :cond_2
-
-    invoke-interface {v1}, Lcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;->onInnerLayerUnlocked()V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception v1
-
-    goto :goto_4
-
-    :catch_0
-    move-exception v1
-
-    goto :goto_3
-
-    :cond_2
-    :goto_1
-    :try_start_2
-    iput-object v3, p2, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->mCallback:Ljava/lang/Object;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
-
-    :goto_2
-    invoke-virtual {p0, v0}, Landroid/util/SparseArray;->remove(I)V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    goto :goto_5
-
-    :catchall_1
-    move-exception p0
-
-    goto :goto_7
-
-    :goto_3
-    :try_start_3
-    const-string/jumbo v2, "LockSettingsService.DarVirtualLock"
-
-    const-string v4, "Callback might be dead..."
-
-    invoke-static {v1, v2, v4}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :try_start_4
-    iput-object v3, p2, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->mCallback:Ljava/lang/Object;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
-
-    goto :goto_2
-
-    :goto_4
-    iput-object v3, p2, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->mCallback:Ljava/lang/Object;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
-
-    invoke-virtual {p0, v0}, Landroid/util/SparseArray;->remove(I)V
-
-    throw v1
-
-    :cond_3
-    :goto_5
-    monitor-exit p1
-
-    :goto_6
-    const/4 p0, 0x1
-
-    return p0
-
-    :goto_7
-    monitor-exit p1
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
-
-    throw p0
-
-    :cond_4
-    const-string/jumbo p0, "LockSettingsService.DarVirtualLock"
-
-    const-string p1, "Failed in inner-layer authentication with auth user "
-
-    invoke-static {p2, p1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    const/4 p2, 0x0
-
-    new-array v0, p2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return p2
-.end method
-
-.method public onRebootEscrowRestored(B[BI)V
-    .locals 2
-
-    new-instance v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    invoke-direct {v0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;-><init>(B)V
-
-    array-length p1, p2
-
-    invoke-static {p2, p1}, Ljava/util/Arrays;->copyOf([BI)[B
-
-    move-result-object p1
-
-    iput-object p1, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p1, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p1, p1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter p1
-
-    :try_start_0
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p2, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v1, p2, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object p2
-
-    invoke-virtual {v1, p2, v0, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallenge(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    monitor-exit p1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    const-string/jumbo p1, "LockSettingsService"
-
-    const-string/jumbo p2, "Restored synthetic password for user %d using reboot escrow"
-
-    invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    filled-new-array {v1}, [Ljava/lang/Object;
-
-    move-result-object v1
-
-    invoke-static {p1, p2, v1}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {p0, p3, v0}, Lcom/android/server/locksettings/LockSettingsService;->loadPasswordMetrics(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Landroid/app/admin/PasswordMetrics;
-
-    move-result-object p1
-
-    invoke-virtual {p0, v0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-.method public performDualDARPasswordChange(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)V
-    .locals 6
-
-    const-string/jumbo v0, "LockSettingsService"
-
-    const-string/jumbo v1, "performDualDARPasswordChange "
-
-    const/4 v2, 0x0
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-static {p3}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isInnerAuthUserForDualDarDo(I)Z
-
-    move-result p4
-
-    if-eqz p4, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {p4}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p4
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {v0, p3}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
-
-    move-result v0
-
-    invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object p2
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object v1
-
-    invoke-virtual {p4, v0, p2, v1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Change(I[B[B)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    invoke-virtual {p0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService;->setUserPasswordMetrics(Lcom/android/internal/widget/LockscreenCredential;I)V
-
-    goto :goto_0
-
-    :cond_0
-    move p2, v2
-
-    :cond_1
-    :goto_0
-    if-nez p2, :cond_9
-
-    const-string/jumbo p0, "LockSettingsService"
-
-    const-string/jumbo p1, "Unexpected failure while change password"
-
-    new-array p2, v2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return-void
-
-    :cond_2
-    if-nez p3, :cond_4
-
-    invoke-static {p3}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_3
-
-    const-string/jumbo p0, "LockSettingsService"
-
-    const-string/jumbo p1, "Skipped in DualDAR on DO case"
-
-    new-array p2, v2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return-void
-
-    :cond_3
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p0
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result p1
-
-    xor-int/lit8 p1, p1, 0x1
-
-    invoke-virtual {p0, p3, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword1Change(IZ)Z
-
-    return-void
-
-    :cond_4
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_9
-
-    invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_5
-
-    move-object v0, v1
-
-    goto :goto_1
-
-    :cond_5
-    invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object v0
-
-    :goto_1
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_6
-
-    goto :goto_2
-
-    :cond_6
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object v1
-
-    :goto_2
-    const-string/jumbo v3, "onPassword2Change()"
-
-    const-string/jumbo v4, "LockSettingsService"
-
-    invoke-static {v4, v3}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v3, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v3, v3, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {v3}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v3
-
-    invoke-virtual {v3, p3, v0, v1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Change(I[B[B)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_7
-
-    const-string v1, "Authentication Change to DualDAR Client Successful"
-
-    invoke-static {v4, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_3
-
-    :cond_7
-    const-string v1, "Authentication Change Failure by dual dar client"
-
-    invoke-static {v4, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_3
-    if-eqz v0, :cond_8
-
-    goto :goto_5
-
-    :cond_8
-    const-string/jumbo v0, "LockSettingsService"
-
-    const-string v1, "Change profile password failed by DualDAR Client"
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :try_start_0
-    invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v0
-
-    invoke-static {v0}, Lcom/android/internal/widget/LockPatternUtils;->credentialTypeToPasswordQuality(I)I
-
-    move-result v2
-    :try_end_0
-    .catch Ljava/lang/IllegalStateException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_4
-
-    :catch_0
-    move-exception v0
-
-    const-string/jumbo v1, "LockSettingsService"
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    const-string v4, "IllegalStateException : get credential quality : "
-
-    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/lang/IllegalStateException;->getMessage()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v1, v0, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :goto_4
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v0
-
-    :try_start_1
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v1, Lcom/android/server/locksettings/LockSettingsService;
-
-    const-string/jumbo v3, "lockscreen.password_type"
-
-    int-to-long v4, v2
-
-    invoke-virtual {v1, v3, v4, v5, p3}, Lcom/android/server/locksettings/LockSettingsService;->setLong(Ljava/lang/String;JI)V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {p0, p2, p1, p3, p4}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialInternal(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
-
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    new-instance p0, Landroid/os/RemoteException;
-
-    const-string p1, "Change profile password failed by DualDAR Client"
-
-    invoke-direct {p0, p1}, Landroid/os/RemoteException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :cond_9
-    :goto_5
-    return-void
-.end method
-
-.method public setLockCredentialWithTokenInternalForDualDAR(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
-    .locals 9
-
-    const-string/jumbo v0, "LockSettingsService: "
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v1, Lcom/android/server/locksettings/LockSettingsService;
-
-    sget-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    invoke-virtual {v1, p5}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_5
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v1, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v1
-
-    :try_start_0
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v2, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v3, v2, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v2}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v7
-
-    move-wide v5, p2
-
-    move-object v8, p4
-
-    move v4, p5
-
-    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockTokenBasedProtector(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
-
-    move-result-object p2
-
-    move p3, v4
-
-    iget-object p2, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    const/4 p4, 0x0
-
-    if-nez p2, :cond_0
+# virtual methods
+.method public onRebootEscrowRestored(B[BI)V
+    .locals 2
 
-    const-string/jumbo p0, "LockSettingsService"
+    new-instance v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    const-string p1, "Invalid escrow token supplied"
+    invoke-direct {v0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;-><init>(B)V
 
-    new-array p2, p4, [Ljava/lang/Object;
+    array-length p1, p2
 
-    invoke-static {p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {p2, p1}, Ljava/util/Arrays;->copyOf([BI)[B
 
     move-result-object p1
 
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string p3, "\n"
-
-    invoke-virtual {p2, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-static {p2}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->enqueLog(Ljava/lang/String;)V
-
-    invoke-static {p0, p1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    monitor-exit v1
-
-    return p4
+    iput-object p1, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
 
-    :catchall_0
-    move-exception v0
+    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
-    move-object p0, v0
+    check-cast p1, Lcom/android/server/locksettings/LockSettingsService;
 
-    goto/16 :goto_2
+    iget-object p1, p1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    :cond_0
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    monitor-enter p1
 
+    :try_start_0
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
     check-cast p2, Lcom/android/server/locksettings/LockSettingsService;
 
-    iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    sget-object p2, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mSecureModeCache:Landroid/util/SparseArray;
-
-    if-eqz v8, :cond_2
-
-    array-length p2, v8
-
-    if-nez p2, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    sget-object p2, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;
-
-    const-string p5, "KeyEncryptionKey"
-
-    invoke-virtual {p5, p2}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
-
-    move-result-object p5
-
-    const-string v0, "ForResetPasswordToken"
-
-    invoke-virtual {v0, p2}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
-
-    move-result-object p2
-
-    new-instance v0, Lcom/android/server/locksettings/SP800Derive;
-
-    invoke-direct {v0, v8}, Lcom/android/server/locksettings/SP800Derive;-><init>([B)V
+    iget-object v1, p2, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {v0, p5, p2}, Lcom/android/server/locksettings/SP800Derive;->withContext([B[B)[B
+    invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
     move-result-object p2
 
-    move-object v7, p2
-
-    goto :goto_1
-
-    :cond_2
-    :goto_0
-    move-object v7, v8
-
-    :goto_1
-    if-nez v7, :cond_3
-
-    const-string/jumbo p0, "LockSettingsService"
-
-    const-string p1, "Dual DAR Client failed to get reset token for user: "
-
-    invoke-static {p3, p1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
+    invoke-virtual {v1, p2, v0, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallenge(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    new-array p2, p4, [Ljava/lang/Object;
+    monitor-exit p1
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    const-string/jumbo p1, "LockSettingsService"
 
-    return p4
+    const-string/jumbo p2, "Restored synthetic password for user %d using reboot escrow"
 
-    :cond_3
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    check-cast p2, Lcom/android/server/locksettings/LockSettingsService;
+    move-result-object v1
 
-    iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    filled-new-array {v1}, [Ljava/lang/Object;
 
-    invoke-static {p2}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
+    move-result-object v1
 
-    move-result-object v2
+    invoke-static {p1, p2, v1}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
     check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {p0, p3}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
-
-    move-result v3
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object v4
-
-    invoke-virtual/range {v2 .. v7}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->resetPasswordWithToken(I[BJ[B)Z
-
-    move-result p0
-
-    if-nez p0, :cond_4
-
-    const-string/jumbo p0, "LockSettingsService"
-
-    const-string p1, "Dual DAR Client failed to reset password with token for user: "
-
-    invoke-static {p3, p1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array p2, p4, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return p4
-
-    :cond_4
-    const-string/jumbo p0, "LockSettingsService"
-
-    const-string p1, "Dual DAR Client successfully reset password with token for user: "
-
-    invoke-static {p3, p1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
+    invoke-virtual {p0, p3, v0}, Lcom/android/server/locksettings/LockSettingsService;->loadPasswordMetrics(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Landroid/app/admin/PasswordMetrics;
 
     move-result-object p1
 
-    new-array p2, p4, [Ljava/lang/Object;
+    invoke-virtual {p0, v0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
 
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    return-void
 
-    goto :goto_3
+    :catchall_0
+    move-exception p0
 
-    :goto_2
     :try_start_1
-    monitor-exit v1
+    monitor-exit p1
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
     throw p0
-
-    :cond_5
-    :goto_3
-    const/4 p0, 0x1
-
-    return p0
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$Lifecycle.smali b/smali/com/android/server/locksettings/LockSettingsService$Lifecycle.smali
index a9eb64e3a..ad8a4eb4c 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$Lifecycle.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$Lifecycle.smali
@@ -19,19 +19,17 @@
 
 # virtual methods
 .method public final onBootPhase(I)V
-    .locals 3
-
-    const/4 v0, 0x1
+    .locals 2
 
     invoke-super {p0, p1}, Lcom/android/server/SystemService;->onBootPhase(I)V
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Lifecycle;->mLockSettingsService:Lcom/android/server/locksettings/LockSettingsService;
 
-    sget-boolean v1, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
 
-    const/16 v1, 0x226
+    const/16 v0, 0x226
 
-    if-ne p1, v1, :cond_0
+    if-ne p1, v0, :cond_0
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->migrateOldDataAfterSystemReady()V
 
@@ -40,71 +38,10 @@
     return-void
 
     :cond_0
-    const/16 v1, 0x208
-
-    if-ne p1, v1, :cond_3
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v1
-
-    :try_start_0
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->checkWeaverStatus()V
-
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    const-string/jumbo p1, "Refresh weaver slots"
-
-    const/4 v1, 0x0
-
-    invoke-static {v1, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter p1
-
-    :try_start_1
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getUsedWeaverSlots()Ljava/util/Set;
-
-    move-result-object v2
-
-    iget-object v1, v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->mPasswordSlotManager:Lcom/android/server/locksettings/PasswordSlotManager;
-
-    invoke-virtual {v1, v2}, Lcom/android/server/locksettings/PasswordSlotManager;->refreshActiveSlots(Ljava/util/Set;)V
-
-    monitor-exit p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    const/16 v0, 0x208
 
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->isDualDAREnabled()Z
+    if-ne p1, v0, :cond_2
 
-    move-result p1
-
-    if-eqz p1, :cond_1
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getDarManagerService()Ljava/util/Optional;
-
-    move-result-object p1
-
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;
-
-    const/4 v2, 0x0
-
-    invoke-direct {v1, v2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;-><init>(I)V
-
-    invoke-virtual {p1, v1}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    :cond_1
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
     iget-object p1, p1, Lcom/android/server/locksettings/LockSettingsService$Injector;->mContext:Landroid/content/Context;
@@ -113,57 +50,41 @@
 
     move-result p1
 
-    if-lez p1, :cond_2
+    if-lez p1, :cond_1
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getDarManagerService()Ljava/util/Optional;
 
     move-result-object p0
 
-    new-instance p1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;
+    new-instance p1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;
+
+    const/4 v0, 0x0
 
-    invoke-direct {p1, v0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;-><init>(I)V
+    invoke-direct {p1, v0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;-><init>(I)V
 
     invoke-virtual {p0, p1}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
 
-    :cond_2
+    :cond_1
     return-void
 
-    :catchall_0
-    move-exception p0
-
-    :try_start_2
-    monitor-exit p1
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :catchall_1
-    move-exception p0
-
-    :try_start_3
-    monitor-exit v1
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    throw p0
-
-    :cond_3
-    const/16 v1, 0x3e8
+    :cond_2
+    const/16 v0, 0x3e8
 
-    if-ne p1, v1, :cond_4
+    if-ne p1, v0, :cond_3
 
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
+    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
+
+    const/4 v1, 0x1
 
-    invoke-direct {v1, p0, v0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+    invoke-direct {v0, p0, v1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
 
-    invoke-virtual {p1, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+    invoke-virtual {p1, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
     return-void
 
-    :cond_4
+    :cond_3
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     return-void
diff --git a/smali/com/android/server/locksettings/LockSettingsService$LocalService.smali b/smali/com/android/server/locksettings/LockSettingsService$LocalService.smali
index 417d8513a..a4aa74c41 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$LocalService.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$LocalService.smali
@@ -357,21 +357,13 @@
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
 
-    if-nez v0, :cond_1
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
+    if-nez v0, :cond_0
 
-    goto :goto_0
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :cond_0
     return-void
 
-    :cond_1
-    :goto_0
+    :cond_0
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->removeUser(I)V
diff --git a/smali/com/android/server/locksettings/LockSettingsService.smali b/smali/com/android/server/locksettings/LockSettingsService.smali
index d40038499..871ba4648 100644
--- a/smali/com/android/server/locksettings/LockSettingsService.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService.smali
@@ -38,11 +38,11 @@
 
 .field public final mDeviceProvisionedObserver:Lcom/android/server/locksettings/LockSettingsService$DeviceProvisionedObserver;
 
-.field public final mDoVerifySI:Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
+.field public final mDoVerifySI:Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
 
 .field public final mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
 
-.field public final mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+.field public final mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
 
 .field public mEarlyCreatedUsers:Landroid/util/SparseIntArray;
 
@@ -133,501 +133,325 @@
 
 # direct methods
 .method public static -$$Nest$msetLockCredentialWithToken(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
-    .locals 12
-
-    move/from16 v1, p5
+    .locals 8
 
     const-string/jumbo v0, "Unknown or unactivated token: "
 
-    new-instance v2, Ljava/lang/StringBuilder;
+    new-instance v1, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v3, "Set lock credential with token for user "
+    const-string/jumbo v2, "Set lock credential with token for user "
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, p5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object v1
 
-    invoke-static {v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
+    invoke-static {v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
 
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
-    invoke-static {v1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->validateBasicRequirements()V
 
-    move-result v2
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    const/4 v7, 0x1
+    monitor-enter v1
 
-    const/4 v6, 0x0
+    :try_start_0
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
 
-    const/4 v8, 0x0
+    invoke-virtual {v2, p5}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->restoreEscrowDataIfNeededLocked(I)V
 
-    if-eqz v2, :cond_2
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    invoke-virtual {v2, p5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasEscrowData(I)Z
 
-    invoke-virtual {p0, v1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isInnerAuthUserForDualDarDo(I)Z
+    move-result v2
 
-    move-result v0
+    if-eqz v2, :cond_3
 
-    if-eqz v0, :cond_0
+    invoke-virtual {p0, p2, p3, p5}, Lcom/android/server/locksettings/LockSettingsService;->isEscrowTokenActive(JI)Z
 
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    move-result v2
 
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+    if-nez v2, :cond_0
 
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_1
+    const-string/jumbo p0, "LockSettingsService"
 
-    move-wide v2, p2
+    new-instance p1, Ljava/lang/StringBuilder;
 
-    move-object/from16 v4, p4
+    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    move v5, v1
+    invoke-static {p2, p3}, Ljava/lang/Long;->toHexString(J)Ljava/lang/String;
 
-    move-object v1, p1
+    move-result-object p2
 
-    :try_start_1
-    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->setLockCredentialWithTokenInternalForDualDAR(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
+    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result v0
-    :try_end_1
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0
+    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move v1, v5
+    move-result-object p1
 
-    goto :goto_1
+    invoke-static {p0, p1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    :catch_0
-    move-exception v0
+    const/4 p0, 0x0
 
-    move v1, v5
+    monitor-exit v1
 
-    goto :goto_0
+    return p0
 
-    :catch_1
+    :catchall_0
     move-exception v0
 
-    :goto_0
-    const-string/jumbo v2, "LockSettingsService.DarVirtualLock"
+    move-object p0, v0
 
-    new-instance v3, Ljava/lang/StringBuilder;
+    goto :goto_1
 
-    const-string v4, "Exception : "
+    :cond_0
+    move-object v2, p0
 
-    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    move-object v3, p1
 
-    invoke-virtual {v0}, Landroid/os/RemoteException;->getMessage()Ljava/lang/String;
+    move-wide v4, p2
 
-    move-result-object v0
+    move-object v6, p4
 
-    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    move v7, p5
 
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithTokenInternalLocked(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
 
-    move-result-object v0
+    move-result p0
 
-    new-array v3, v6, [Ljava/lang/Object;
+    monitor-exit v1
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-static {v2, v0, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    const/4 p1, 0x0
 
-    move v0, v6
+    if-eqz p0, :cond_2
 
-    :goto_1
-    if-nez v0, :cond_0
+    iget-object p2, v2, Lcom/android/server/locksettings/LockSettingsService;->mSeparateChallengeLock:Ljava/lang/Object;
 
-    const-string/jumbo p0, "LockSettingsService.DarVirtualLock"
+    monitor-enter p2
 
-    const-string p1, "Dual DAR Client failed to reset password with token for user: "
+    const/4 p3, 0x1
 
-    invoke-static {v1, p1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
+    :try_start_1
+    invoke-virtual {v2, v7, p3, p1}, Lcom/android/server/locksettings/LockSettingsService;->setSeparateProfileChallengeEnabledLocked(IZLcom/android/internal/widget/LockscreenCredential;)V
 
-    move-result-object p1
+    monitor-exit p2
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_1
 
-    new-array v0, v6, [Ljava/lang/Object;
+    invoke-virtual {v3}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    invoke-static {p0, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    move-result p2
 
-    :goto_2
-    move v7, v6
+    if-eqz p2, :cond_1
 
-    goto :goto_3
+    iget-object p2, v2, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    new-instance p3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;
 
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+    const/4 p4, 0x1
 
-    iget-object v9, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    invoke-direct {p3, v7, p4, v2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;-><init>(IILjava/lang/Object;)V
 
-    monitor-enter v9
+    invoke-virtual {p2, p3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    :try_start_2
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    :cond_1
+    iget-object p2, v2, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+    new-instance p3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;
 
-    move-object v2, v0
+    invoke-direct {p3, v2, v3, v7}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    iget-object v0, v2, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    invoke-virtual {p2, p3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    invoke-virtual {v2}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+    iget-object p2, v2, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    move-result-object v4
+    new-instance p3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;
 
-    move-wide v2, p2
+    invoke-direct {p3, v7}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;-><init>(I)V
 
-    move-object/from16 v5, p4
+    invoke-virtual {p2, p3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockTokenBasedProtector(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    goto :goto_0
 
-    move-result-object v0
+    :catchall_1
+    move-exception v0
 
-    iget-object v2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    move-object p0, v0
 
-    if-nez v2, :cond_1
+    :try_start_2
+    monitor-exit p2
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_1
 
-    const-string p0, "Invalid escrow token supplied"
+    throw p0
 
-    invoke-static {v8, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    :cond_2
+    :goto_0
+    const-string/jumbo p2, "Result of setting credential with token for user %d : %s"
 
-    monitor-exit v9
+    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    goto :goto_2
+    move-result-object p3
 
-    :catchall_0
-    move-exception v0
+    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
 
-    move-object p0, v0
+    move-result-object p4
 
-    goto :goto_4
+    filled-new-array {p3, p4}, [Ljava/lang/Object;
 
-    :cond_1
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    move-result-object p3
 
-    check-cast v2, Lcom/android/server/locksettings/LockSettingsService;
+    invoke-static {p2, p3}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    invoke-virtual {v2, v1}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
+    move-result-object p2
 
-    move-result-wide v10
+    invoke-static {p1, p2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    return p0
 
-    check-cast v2, Lcom/android/server/locksettings/LockSettingsService;
+    :cond_3
+    :try_start_3
+    new-instance p0, Ljava/lang/SecurityException;
 
-    iget-object v5, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    const-string p1, "Escrow token is disabled on the current user"
 
-    move-object v0, v2
+    invoke-direct {p0, p1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
 
-    const/4 v2, 0x0
+    throw p0
 
-    const-wide/16 v3, 0x0
+    :goto_1
+    monitor-exit v1
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_0
 
-    move v6, v1
+    throw p0
+.end method
 
-    move-object v1, p1
+.method static constructor <clinit>()V
+    .locals 3
 
-    invoke-virtual/range {v0 .. v6}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithSpLocked(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
+    const-string/jumbo v0, "ro.build.type"
 
-    move v1, v6
+    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    move-result-object v1
 
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
+    const-string/jumbo v2, "userdebug"
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    invoke-virtual {v2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    invoke-virtual {p0, v1, v10, v11}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyLskfBasedProtector(IJ)V
+    move-result v1
 
-    monitor-exit v9
+    const/4 v2, 0x0
 
-    :goto_3
-    return v7
+    if-nez v1, :cond_1
 
-    :goto_4
-    monitor-exit v9
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+    const-string/jumbo v1, "eng"
 
-    throw p0
+    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    :cond_2
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->validateBasicRequirements()V
+    move-result-object v0
 
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    invoke-virtual {v1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    monitor-enter v3
+    move-result v0
 
-    :try_start_3
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
+    if-eqz v0, :cond_0
 
-    invoke-virtual {v4, v1}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->restoreEscrowDataIfNeededLocked(I)V
+    goto :goto_0
 
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    :cond_0
+    move v0, v2
 
-    invoke-virtual {v4, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasEscrowData(I)Z
+    goto :goto_1
 
-    move-result v4
+    :cond_1
+    :goto_0
+    const/4 v0, 0x1
 
-    if-eqz v4, :cond_6
+    :goto_1
+    sput-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
 
-    invoke-virtual {p0, p2, p3, v1}, Lcom/android/server/locksettings/LockSettingsService;->isEscrowTokenActive(JI)Z
+    const/16 v0, 0x3f8
 
-    move-result v9
+    const/16 v1, 0x3e8
 
-    if-nez v9, :cond_3
+    filled-new-array {v0, v2, v1}, [I
 
-    const-string/jumbo p0, "LockSettingsService"
+    move-result-object v0
 
-    new-instance p1, Ljava/lang/StringBuilder;
+    sput-object v0, Lcom/android/server/locksettings/LockSettingsService;->SYSTEM_CREDENTIAL_UIDS:[I
 
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    sput-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->mIsDbMigrated:Z
 
-    invoke-static {p2, p3}, Ljava/lang/Long;->toHexString(J)Ljava/lang/String;
+    sput-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->mIsSpblobMigrated:Z
 
-    move-result-object v0
+    return-void
+.end method
 
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+.method public constructor <init>(Lcom/android/server/locksettings/LockSettingsService$Injector;)V
+    .locals 26
 
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    move-object/from16 v0, p0
 
-    move-result-object p1
+    move-object/from16 v1, p1
 
-    invoke-static {p0, p1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-direct {v0}, Lcom/android/internal/widget/ILockSettings$Stub;-><init>()V
 
-    monitor-exit v3
+    new-instance v2, Ljava/lang/Object;
 
-    return v6
+    invoke-direct {v2}, Ljava/lang/Object;-><init>()V
 
-    :catchall_1
-    move-exception v0
+    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mSeparateChallengeLock:Ljava/lang/Object;
 
-    move-object p0, v0
+    new-instance v2, Lcom/android/server/locksettings/LockSettingsService$DeviceProvisionedObserver;
 
-    goto :goto_6
+    invoke-direct {v2, v0}, Lcom/android/server/locksettings/LockSettingsService$DeviceProvisionedObserver;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
 
-    :cond_3
-    invoke-virtual/range {p0 .. p5}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithTokenInternalLocked(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
+    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mDeviceProvisionedObserver:Lcom/android/server/locksettings/LockSettingsService$DeviceProvisionedObserver;
 
-    move-result v0
+    new-instance v2, Ljava/lang/Object;
 
-    monitor-exit v3
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    invoke-direct {v2}, Ljava/lang/Object;-><init>()V
 
-    if-eqz v0, :cond_5
+    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mUserCreationAndRemovalLock:Ljava/lang/Object;
 
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mSeparateChallengeLock:Ljava/lang/Object;
+    new-instance v2, Landroid/util/SparseIntArray;
 
-    monitor-enter v3
+    invoke-direct {v2}, Landroid/util/SparseIntArray;-><init>()V
 
-    :try_start_4
-    invoke-virtual {p0, v1, v7, v8}, Lcom/android/server/locksettings/LockSettingsService;->setSeparateProfileChallengeEnabledLocked(IZLcom/android/internal/widget/LockscreenCredential;)V
+    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mEarlyCreatedUsers:Landroid/util/SparseIntArray;
 
-    monitor-exit v3
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_2
+    new-instance v2, Landroid/util/SparseIntArray;
 
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    invoke-direct {v2}, Landroid/util/SparseIntArray;-><init>()V
 
-    move-result v3
+    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mEarlyRemovedUsers:Landroid/util/SparseIntArray;
 
-    if-eqz v3, :cond_4
+    new-instance v2, Ljava/util/ArrayList;
 
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
+    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V
 
-    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;
+    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
 
-    const/4 v5, 0x1
+    new-instance v2, Landroid/util/SparseArray;
 
-    invoke-direct {v4, v1, v5, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;-><init>(IILjava/lang/Object;)V
+    invoke-direct {v2}, Landroid/util/SparseArray;-><init>()V
 
-    invoke-virtual {v3, v4}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mUserPasswordMetrics:Landroid/util/SparseArray;
 
-    :cond_4
-    invoke-virtual {p0, p1, v1}, Lcom/android/server/locksettings/LockSettingsService;->notifyPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
+    new-instance v2, Ljava/lang/Object;
 
-    invoke-virtual {p0, v1}, Lcom/android/server/locksettings/LockSettingsService;->notifySeparateProfileChallengeChanged(I)V
-
-    goto :goto_5
-
-    :catchall_2
-    move-exception v0
-
-    move-object p0, v0
-
-    :try_start_5
-    monitor-exit v3
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_2
-
-    throw p0
-
-    :cond_5
-    :goto_5
-    const-string/jumbo p0, "Result of setting credential with token for user %d : %s"
-
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    invoke-static {v0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object v1
-
-    filled-new-array {p1, v1}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    invoke-static {p0, p1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v8, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return v0
-
-    :cond_6
-    :try_start_6
-    new-instance p0, Ljava/lang/SecurityException;
-
-    const-string p1, "Escrow token is disabled on the current user"
-
-    invoke-direct {p0, p1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    :goto_6
-    monitor-exit v3
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_1
-
-    throw p0
-.end method
-
-.method static constructor <clinit>()V
-    .locals 3
-
-    const-string/jumbo v0, "ro.build.type"
-
-    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    const-string/jumbo v2, "userdebug"
-
-    invoke-virtual {v2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v1
-
-    const/4 v2, 0x0
-
-    if-nez v1, :cond_1
-
-    const-string/jumbo v1, "eng"
-
-    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    move v0, v2
-
-    goto :goto_1
-
-    :cond_1
-    :goto_0
-    const/4 v0, 0x1
-
-    :goto_1
-    sput-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    const/16 v0, 0x3f8
-
-    const/16 v1, 0x3e8
-
-    filled-new-array {v0, v2, v1}, [I
-
-    move-result-object v0
-
-    sput-object v0, Lcom/android/server/locksettings/LockSettingsService;->SYSTEM_CREDENTIAL_UIDS:[I
-
-    sput-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->mIsDbMigrated:Z
-
-    sput-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->mIsSpblobMigrated:Z
-
-    return-void
-.end method
-
-.method public constructor <init>(Lcom/android/server/locksettings/LockSettingsService$Injector;)V
-    .locals 26
-
-    move-object/from16 v0, p0
-
-    move-object/from16 v1, p1
-
-    invoke-direct {v0}, Lcom/android/internal/widget/ILockSettings$Stub;-><init>()V
-
-    new-instance v2, Ljava/lang/Object;
-
-    invoke-direct {v2}, Ljava/lang/Object;-><init>()V
-
-    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mSeparateChallengeLock:Ljava/lang/Object;
-
-    new-instance v2, Lcom/android/server/locksettings/LockSettingsService$DeviceProvisionedObserver;
-
-    invoke-direct {v2, v0}, Lcom/android/server/locksettings/LockSettingsService$DeviceProvisionedObserver;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
-
-    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mDeviceProvisionedObserver:Lcom/android/server/locksettings/LockSettingsService$DeviceProvisionedObserver;
-
-    new-instance v2, Ljava/lang/Object;
-
-    invoke-direct {v2}, Ljava/lang/Object;-><init>()V
-
-    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mUserCreationAndRemovalLock:Ljava/lang/Object;
-
-    new-instance v2, Landroid/util/SparseIntArray;
-
-    invoke-direct {v2}, Landroid/util/SparseIntArray;-><init>()V
-
-    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mEarlyCreatedUsers:Landroid/util/SparseIntArray;
-
-    new-instance v2, Landroid/util/SparseIntArray;
-
-    invoke-direct {v2}, Landroid/util/SparseIntArray;-><init>()V
-
-    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mEarlyRemovedUsers:Landroid/util/SparseIntArray;
-
-    new-instance v2, Ljava/util/ArrayList;
-
-    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V
-
-    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
-
-    new-instance v2, Landroid/util/SparseArray;
-
-    invoke-direct {v2}, Landroid/util/SparseArray;-><init>()V
-
-    iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mUserPasswordMetrics:Landroid/util/SparseArray;
-
-    new-instance v2, Ljava/lang/Object;
-
-    invoke-direct {v2}, Ljava/lang/Object;-><init>()V
+    invoke-direct {v2}, Ljava/lang/Object;-><init>()V
 
     iput-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mHeadlessAuthSecretLock:Ljava/lang/Object;
 
@@ -687,11 +511,11 @@
 
     iput-object v4, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpBackup:Lcom/android/server/locksettings/LockSettingsService$9;
 
-    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
+    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
 
-    invoke-direct {v4, v0, v3}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+    invoke-direct {v4, v0, v3}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
 
-    iput-object v4, v0, Lcom/android/server/locksettings/LockSettingsService;->mDoVerifySI:Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
+    iput-object v4, v0, Lcom/android/server/locksettings/LockSettingsService;->mDoVerifySI:Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
 
     new-instance v3, Lcom/android/server/locksettings/LockSettingsService$3;
 
@@ -984,20 +808,16 @@
 
     const-string/jumbo v6, "android.intent.action.LOCALE_CHANGED"
 
-    const-string/jumbo v7, "android.intent.action.MANAGED_PROFILE_ADDED"
+    const-string/jumbo v7, "com.samsung.intent.action.LAZY_BOOT_COMPLETE"
 
-    const-string/jumbo v8, "com.samsung.intent.action.LAZY_BOOT_COMPLETE"
+    const-string/jumbo v8, "android.intent.action.LOCKED_BOOT_COMPLETED"
 
-    const-string/jumbo v9, "android.intent.action.LOCKED_BOOT_COMPLETED"
+    const-string/jumbo v9, "android.intent.action.BOOT_COMPLETED"
 
     invoke-static {v4, v6, v7, v8, v9}, Lcom/android/server/VpnManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
 
     move-result-object v7
 
-    const-string/jumbo v4, "android.intent.action.BOOT_COMPLETED"
-
-    invoke-virtual {v7, v4}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
     iget-object v4, v1, Lcom/android/server/locksettings/LockSettingsService$Injector;->mContext:Landroid/content/Context;
 
     sget-object v6, Landroid/os/UserHandle;->ALL:Landroid/os/UserHandle;
@@ -1230,13 +1050,11 @@
 
     iput-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
 
     invoke-direct {v1}, Ljava/lang/Object;-><init>()V
 
-    iput-object v0, v1, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    iput-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    iput-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
 
     new-instance v1, Lcom/android/server/locksettings/LockSettingsService$Injector$1;
 
@@ -1524,7 +1342,7 @@
 .end method
 
 .method public final addEscrowToken([BIILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
-    .locals 10
+    .locals 9
 
     new-instance v0, Ljava/lang/StringBuilder;
 
@@ -1540,67 +1358,62 @@
 
     invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    invoke-static {p3}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    const/4 v1, 0x0
+    const-string/jumbo v0, "LockSettingsService"
 
-    if-eqz v0, :cond_4
+    const-string v1, "Adding escrow token for user %d"
 
-    new-instance v0, Ljava/lang/StringBuilder;
+    invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    const-string/jumbo v2, "add escrow token for virtual user "
+    move-result-object v2
 
-    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    filled-new-array {v2}, [Ljava/lang/Object;
 
-    invoke-virtual {v0, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    move-result-object v2
 
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-static {v0, v1, v2}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    move-result-object v0
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
+    monitor-enter v1
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    :try_start_0
+    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    move-result v0
 
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+    if-nez v0, :cond_0
 
-    iget-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
-    monitor-enter v2
+    move-result-wide v4
 
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    invoke-virtual {v0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
+    move-result-object v3
 
-    move-result v0
+    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
 
-    if-nez v0, :cond_0
+    move-result-object v6
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    const/4 v8, 0x0
 
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+    move v7, p3
 
-    invoke-virtual {v0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isSyntheticPasswordBasedCredentialLocked(I)Z
+    invoke-virtual/range {v2 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
-    move-result v0
+    move-result-object p3
 
-    if-nez v0, :cond_1
+    iget-object p3, p3, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    invoke-static {p3}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->prepare(I)V
+    const-string/jumbo v0, "addEscrowToken: saveEscrowDataIfNeededLocked"
 
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->initializeSyntheticPasswordForVirtualUser(I)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    move-result-object v1
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
 
-    :cond_0
-    move v6, p3
+    invoke-virtual {v0, v7}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->saveEscrowDataIfNeededLocked(I)V
 
     goto :goto_0
 
@@ -1611,255 +1424,64 @@
 
     goto :goto_2
 
-    :cond_1
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    :cond_0
+    move v7, p3
 
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+    const/4 p3, 0x0
 
-    invoke-virtual {v0, p3}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
+    :goto_0
+    invoke-virtual {p0, v7}, Lcom/android/server/locksettings/LockSettingsService;->disableEscrowTokenOnNonManagedDevicesIfNeeded(I)V
 
-    move-result-wide v5
+    const-string/jumbo v0, "addEscrowToken: restoreEscrowDataIfNeededLocked"
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
 
-    iget-object v3, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    invoke-virtual {v0, v7}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->restoreEscrowDataIfNeededLocked(I)V
 
-    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    move-result-object v4
+    invoke-virtual {v0, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasEscrowData(I)Z
 
-    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
+    move-result v0
 
-    move-result-object v7
+    if-eqz v0, :cond_2
 
-    const/4 v9, 0x0
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    move v8, p3
+    invoke-virtual {v0, p1, p2, v7, p4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->addPendingToken([BIILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
 
-    invoke-virtual/range {v3 .. v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    move-result-wide p1
 
-    move-result-object p3
+    if-eqz p3, :cond_1
 
-    move v6, v8
+    const-string/jumbo p4, "LockSettingsService"
 
-    iget-object v1, p3, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    const-string v0, "Immediately activating escrow token %016x"
 
-    :goto_0
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    invoke-static {p1, p2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    check-cast p3, Lcom/android/server/locksettings/LockSettingsService;
+    move-result-object v2
 
-    iget-object p3, p3, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    filled-new-array {v2}, [Ljava/lang/Object;
 
-    invoke-virtual {p3, p1, p2, v6, p4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->addPendingToken([BIILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
+    move-result-object v2
 
-    move-result-wide v4
+    invoke-static {p4, v0, v2}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    if-eqz v1, :cond_3
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    invoke-virtual {p0, v7, p1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createTokenBasedProtector(IJLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
 
-    check-cast p1, Lcom/android/server/locksettings/LockSettingsService;
+    goto :goto_1
 
-    iget-object p1, p1, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
+    :cond_1
+    const-string/jumbo p0, "LockSettingsService"
 
-    invoke-virtual {p1, v6}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
+    const-string p3, "Escrow token %016x will be activated when user is unlocked"
 
-    move-result p1
-
-    if-eqz p1, :cond_2
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p1, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p1, p1, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p1, v6, v4, v5}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->getPendingTokenForDualDAR(IJ)[B
-
-    move-result-object v7
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p1, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p1, p1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p1, v6, v4, v5, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createTokenBasedProtector(IJLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_3
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    const/4 v8, 0x0
-
-    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->activateEscrowTokenForDualDAR(JI[B[B)V
-
-    goto :goto_1
-
-    :cond_2
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p0, v6, v4, v5, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createTokenBasedProtector(IJLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
-
-    :cond_3
-    :goto_1
-    monitor-exit v2
-
-    return-wide v4
-
-    :goto_2
-    monitor-exit v2
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-
-    :cond_4
-    move v6, p3
-
-    const-string/jumbo p3, "LockSettingsService"
-
-    const-string v0, "Adding escrow token for user %d"
-
-    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v2
-
-    filled-new-array {v2}, [Ljava/lang/Object;
-
-    move-result-object v2
-
-    invoke-static {p3, v0, v2}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter p3
-
-    :try_start_1
-    invoke-virtual {p0, v6}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_5
-
-    move v8, v6
-
-    invoke-virtual {p0, v8}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
-
-    move-result-wide v5
-
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v4
-
-    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v7
-
-    const/4 v9, 0x0
-
-    invoke-virtual/range {v3 .. v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
-
-    move-result-object v0
-
-    move v6, v8
-
-    iget-object v1, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    const-string/jumbo v0, "addEscrowToken: saveEscrowDataIfNeededLocked"
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
-
-    invoke-virtual {v0, v6}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->saveEscrowDataIfNeededLocked(I)V
-
-    goto :goto_3
-
-    :catchall_1
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_5
-
-    :cond_5
-    :goto_3
-    invoke-virtual {p0, v6}, Lcom/android/server/locksettings/LockSettingsService;->disableEscrowTokenOnNonManagedDevicesIfNeeded(I)V
-
-    const-string/jumbo v0, "addEscrowToken: restoreEscrowDataIfNeededLocked"
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
-
-    invoke-virtual {v0, v6}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->restoreEscrowDataIfNeededLocked(I)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v0, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasEscrowData(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_9
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v0, p1, p2, v6, p4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->addPendingToken([BIILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
-
-    move-result-wide v4
-
-    if-eqz v1, :cond_7
-
-    invoke-virtual {p0, v6}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_6
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p1, v6, v4, v5}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->getPendingTokenForDualDAR(IJ)[B
-
-    move-result-object v7
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p1, v6, v4, v5, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createTokenBasedProtector(IJLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_8
-
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    const/4 v8, 0x0
-
-    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->activateEscrowTokenForDualDAR(JI[B[B)V
-
-    goto :goto_4
-
-    :cond_6
-    const-string/jumbo p1, "LockSettingsService"
-
-    const-string p2, "Immediately activating escrow token %016x"
-
-    invoke-static {v4, v5}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {p1, p2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
     move-result-object p4
 
@@ -1867,36 +1489,14 @@
 
     move-result-object p4
 
-    invoke-static {p1, p2, p4}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p0, v6, v4, v5, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createTokenBasedProtector(IJLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
-
-    goto :goto_4
-
-    :cond_7
-    const-string/jumbo p0, "LockSettingsService"
-
-    const-string p1, "Escrow token %016x will be activated when user is unlocked"
-
-    invoke-static {v4, v5}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object p2
-
-    filled-new-array {p2}, [Ljava/lang/Object;
+    invoke-static {p0, p3, p4}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    move-result-object p2
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_8
-    :goto_4
-    monitor-exit p3
+    :goto_1
+    monitor-exit v1
 
-    return-wide v4
+    return-wide p1
 
-    :cond_9
+    :cond_2
     new-instance p0, Ljava/lang/SecurityException;
 
     const-string p1, "Escrow token is disabled on the current user"
@@ -1905,10 +1505,10 @@
 
     throw p0
 
-    :goto_5
-    monitor-exit p3
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
+    :goto_2
+    monitor-exit v1
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     throw p0
 .end method
@@ -3460,7 +3060,7 @@
 .end method
 
 .method public final checkCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 4
+    .locals 3
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->checkPasswordReadPermission()V
 
@@ -3468,56 +3068,14 @@
 
     move-result-wide v0
 
-    :try_start_0
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v2
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    const/4 v3, 0x0
-
-    if-eqz v2, :cond_1
-
-    :try_start_1
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/StreamCipher;->decryptStream(Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object p1
-
-    invoke-virtual {p0, p1, p2, p3, v3}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p2
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :try_start_2
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->scheduleGc()V
-
-    return-object p2
-
-    :catchall_0
-    move-exception p2
-
-    if-eqz p1, :cond_0
-
-    :try_start_3
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-
-    :cond_0
-    throw p2
+    const/4 v2, 0x0
 
-    :cond_1
-    invoke-virtual {p0, p1, p2, p3, v3}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
+    :try_start_0
+    invoke-virtual {p0, p1, p2, p3, v2}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
 
     move-result-object p1
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
@@ -3525,7 +3083,7 @@
 
     return-object p1
 
-    :catchall_1
+    :catchall_0
     move-exception p1
 
     invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
@@ -3924,21 +3482,6 @@
 .method public final disableEscrowTokenOnNonManagedDevicesIfNeeded(I)V
     .locals 9
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    const-string/jumbo p0, "LockSettingsService.SDP"
-
-    const-string/jumbo p1, "Virtual user can have escrow token"
-
-    invoke-static {p0, p1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-
-    :cond_0
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     const-string/jumbo v1, "e0"
@@ -3951,15 +3494,15 @@
 
     const-string/jumbo v5, "p1"
 
-    if-nez v4, :cond_1
+    if-nez v4, :cond_0
 
     invoke-virtual {v0, p1, v5, v2, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasState(ILjava/lang/String;J)Z
 
     move-result v0
 
-    if-eqz v0, :cond_b
+    if-eqz v0, :cond_6
 
-    :cond_1
+    :cond_0
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
     move-result-wide v6
@@ -3979,7 +3522,7 @@
 
     const-string/jumbo v4, "LockSettingsService"
 
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_1
 
     :try_start_1
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
@@ -3994,29 +3537,9 @@
 
     move-result v0
 
-    if-eqz v0, :cond_8
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v0, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
-
-    move-result v0
-
     if-eqz v0, :cond_3
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v0
-
-    invoke-virtual {v0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->isResetPasswordSupported(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    const-string p0, "Dual DAR enabled Organization Managed profile can have escrow token"
+    const-string/jumbo p0, "Organization managed users can have escrow token"
 
     invoke-static {v4, p0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
     :try_end_1
@@ -4029,29 +3552,10 @@
     :catchall_0
     move-exception p0
 
-    goto/16 :goto_2
+    goto/16 :goto_0
 
-    :cond_2
+    :cond_1
     :try_start_2
-    const-string v0, "Dual DAR enabled Organization Managed profile doesn\'t support reset password. Disable escrow"
-
-    invoke-static {v4, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_1
-
-    :cond_3
-    const-string/jumbo p0, "Organization managed users can have escrow token"
-
-    invoke-static {v4, p0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :cond_4
-    :try_start_3
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
@@ -4064,85 +3568,44 @@
 
     move-result v8
 
-    if-eqz v8, :cond_7
-
-    iget-object v8, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v8, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
-
-    move-result v8
-
-    if-eqz v8, :cond_6
-
-    iget-object v8, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {v8}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v8
-
-    invoke-virtual {v8, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->isResetPasswordSupported(I)Z
-
-    move-result v8
-
-    if-eqz v8, :cond_5
-
-    const-string p0, "Dual DAR enabled Managed profile can have escrow token"
-
-    invoke-static {v4, p0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :cond_5
-    :try_start_4
-    const-string v8, "Dual DAR enabled Managed profile doesn\'t support reset password. Disable escrow"
-
-    invoke-static {v4, v8}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_0
+    if-eqz v8, :cond_2
 
-    :cond_6
     const-string/jumbo p0, "Managed profile can have escrow token"
 
     invoke-static {v4, p0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
     invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return-void
 
-    :cond_7
-    :goto_0
-    :try_start_5
+    :cond_2
+    :try_start_3
     invoke-virtual {v0}, Lcom/android/server/pm/UserManagerInternal;->isDeviceManaged()Z
 
     move-result v0
 
-    if-eqz v0, :cond_8
+    if-eqz v0, :cond_3
 
     const-string p0, "Corp-owned device can have escrow token"
 
     invoke-static {v4, p0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_0
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_0
 
     invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return-void
 
-    :cond_8
-    :goto_1
+    :cond_3
     invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isKnoxAdminActivated(I)Z
 
     move-result v0
 
-    if-eqz v0, :cond_9
+    if-eqz v0, :cond_4
 
     const-string/jumbo p0, "User with knox admin can have escrow token"
 
@@ -4150,7 +3613,7 @@
 
     return-void
 
-    :cond_9
+    :cond_4
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
@@ -4163,7 +3626,7 @@
 
     move-result v0
 
-    if-nez v0, :cond_a
+    if-nez v0, :cond_5
 
     const-string/jumbo p0, "Postpone disabling escrow tokens until device is provisioned"
 
@@ -4171,19 +3634,19 @@
 
     return-void
 
-    :cond_a
+    :cond_5
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
     invoke-static {v0}, Lcom/android/internal/pm/RoSystemFeatures;->hasFeatureAutomotive(Landroid/content/Context;)Z
 
     move-result v0
 
-    if-eqz v0, :cond_c
+    if-eqz v0, :cond_7
 
-    :cond_b
+    :cond_6
     return-void
 
-    :cond_c
+    :cond_7
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
@@ -4196,13 +3659,13 @@
 
     move-result-object v0
 
-    if-eqz v0, :cond_d
+    if-eqz v0, :cond_8
 
     invoke-virtual {v0}, Landroid/content/pm/UserInfo;->isForTesting()Z
 
     move-result v6
 
-    if-eqz v6, :cond_d
+    if-eqz v6, :cond_8
 
     const-string p0, "Keeping escrow data for test-only user"
 
@@ -4210,14 +3673,14 @@
 
     return-void
 
-    :cond_d
-    if-eqz v0, :cond_e
+    :cond_8
+    if-eqz v0, :cond_9
 
     invoke-virtual {v0}, Landroid/content/pm/UserInfo;->isSecureFolder()Z
 
     move-result v0
 
-    if-eqz v0, :cond_e
+    if-eqz v0, :cond_9
 
     const-string/jumbo p0, "SecureFolder can have escrow token"
 
@@ -4225,7 +3688,7 @@
 
     return-void
 
-    :cond_e
+    :cond_9
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v0
@@ -4246,854 +3709,616 @@
 
     return-void
 
-    :goto_2
+    :goto_0
     invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw p0
 .end method
 
 .method public final doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 10
+    .locals 14
+
+    move/from16 v0, p2
 
-    if-eqz p1, :cond_1d
+    if-eqz p1, :cond_13
 
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    move-result v0
+    move-result v1
 
-    if-nez v0, :cond_1d
+    if-nez v1, :cond_13
 
-    new-instance v0, Ljava/lang/StringBuilder;
+    new-instance v1, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v1, "Verify credential for user "
+    const-string/jumbo v2, "Verify credential for user "
 
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v0
+    move-result-object v1
 
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
+    invoke-static {v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
 
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
-    invoke-static {p2}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    const/4 v7, 0x0
 
-    move-result v0
+    const/16 v1, -0x270f
 
-    const/4 v1, 0x0
+    if-ne v0, v1, :cond_0
 
-    if-eqz v0, :cond_6
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
 
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    move-result-object v2
 
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    const-string/jumbo v3, "device_provisioned"
 
-    move-result p4
+    invoke-static {v2, v3, v7}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I
 
-    if-nez p4, :cond_5
+    move-result v2
 
-    sget-object p4, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
+    if-eqz v2, :cond_0
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    const-string/jumbo p0, "LockSettingsService"
 
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+    const-string v0, "FRP credential can only be verified prior to provisioning."
 
-    invoke-virtual {v0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isSyntheticPasswordBasedCredentialLocked(I)Z
+    invoke-static {p0, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result v2
+    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    if-eqz v2, :cond_0
+    return-object p0
 
-    invoke-virtual {v0, p2}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
+    :cond_0
+    const/16 v2, -0x270e
 
-    move-result-wide v5
+    if-ne v0, v2, :cond_1
 
-    iget-object v3, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+    invoke-static {v2}, Lcom/android/internal/widget/LockPatternUtils;->isRepairModeActive(Landroid/content/Context;)Z
 
-    move-result-object v4
+    move-result v2
 
-    move-object v7, p1
+    if-nez v2, :cond_1
 
-    move v8, p2
+    const-string/jumbo p0, "LockSettingsService"
 
-    move-object v9, p3
+    const-string/jumbo v0, "Repair mode is not active on the device."
 
-    invoke-virtual/range {v3 .. v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    invoke-static {p0, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result-object p1
+    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    move-object v6, v7
+    return-object p0
 
-    iget-object p4, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    :cond_1
+    const-string/jumbo v2, "LockSettingsService"
 
-    goto :goto_0
+    const-string/jumbo v3, "Verifying lockscreen credential for user %d"
 
-    :cond_0
-    move-object v6, p1
+    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move v8, p2
+    move-result-object v5
 
-    new-instance p1, Ljava/lang/StringBuilder;
+    filled-new-array {v5}, [Ljava/lang/Object;
 
-    const-string/jumbo p2, "Sp not yet applied to user "
+    move-result-object v5
 
-    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-static {v2, v3, v5}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    invoke-virtual {p1, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    iget-object v8, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    monitor-enter v8
 
-    move-result-object p1
+    :try_start_0
+    invoke-static {v0}, Lcom/android/internal/widget/LockPatternUtils;->isSpecialUserId(I)Z
 
-    invoke-static {v1, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    move-result v2
 
-    move-object p1, v1
+    if-eqz v2, :cond_4
 
-    :goto_0
-    if-nez p4, :cond_1
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    sget-object p4, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    :cond_1
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    move-result-object v3
 
-    move-result-object p2
+    invoke-virtual {v2, v0, v3, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifySpecialUserCredential(ILandroid/service/gatekeeper/IGateKeeperService;Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    filled-new-array {p2, p4}, [Ljava/lang/Object;
+    move-result-object v2
 
-    move-result-object p2
+    invoke-virtual {v2}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
 
-    const-string/jumbo p3, "Result of verification for user %d : %s"
+    move-result v3
 
-    invoke-static {p3, p2}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    if-eqz v3, :cond_3
 
-    move-result-object p2
+    if-ne v0, v1, :cond_3
 
-    invoke-static {v1, p2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {p4}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsStorage;->getPersistentDataBlockManager()Lcom/android/server/pdb/PersistentDataBlockManagerInternal;
 
-    move-result p2
+    move-result-object p0
 
-    if-nez p2, :cond_2
+    if-eqz p0, :cond_2
 
-    invoke-virtual {p0, v8}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->onCredentialMismatchedForInner(I)V
+    check-cast p0, Lcom/android/server/pdb/PersistentDataBlockService$InternalService;
 
-    goto :goto_1
+    iget-object v0, p0, Lcom/android/server/pdb/PersistentDataBlockService$InternalService;->this$0:Lcom/android/server/pdb/PersistentDataBlockService;
 
-    :cond_2
-    invoke-virtual {p0, v6, v8}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->onCredentialVerifiedForInner(Lcom/android/internal/widget/LockscreenCredential;I)Z
+    iget-object v1, v0, Lcom/android/server/pdb/PersistentDataBlockService;->mLock:Ljava/lang/Object;
 
-    move-result p0
+    monitor-enter v1
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_1
 
-    if-nez p0, :cond_3
+    :try_start_1
+    iget-object p0, p0, Lcom/android/server/pdb/PersistentDataBlockService$InternalService;->this$0:Lcom/android/server/pdb/PersistentDataBlockService;
 
-    sget-object p4, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iput-boolean v7, p0, Lcom/android/server/pdb/PersistentDataBlockService;->mFrpActive:Z
 
-    :cond_3
-    :goto_1
-    invoke-virtual {p4}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
+    invoke-virtual {p0, v7}, Lcom/android/server/pdb/PersistentDataBlockService;->setOldSettingForBackworkCompatibility(Z)V
 
-    move-result p0
+    monitor-exit v1
 
-    if-eqz p0, :cond_4
+    goto :goto_0
 
-    if-eqz p1, :cond_4
+    :catchall_0
+    move-exception v0
 
-    invoke-virtual {v0, v8}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
+    move-object p0, v0
 
-    move-result p0
+    monitor-exit v1
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    if-eqz p0, :cond_4
+    :try_start_2
+    throw p0
 
-    iget-object p0, v0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    :cond_2
+    const-string/jumbo p0, "LockSettingsStorage"
 
-    iget-object p1, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    const-string v0, "Failed to get PersistentDataBlockManagerInternal"
 
-    invoke-virtual {v6}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
+    invoke-static {p0, v0}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result-object p2
+    goto :goto_0
 
-    invoke-virtual {p0, p1, v8, p2}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->activateEscrowTokensForDualDAR(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I[B)V
+    :catchall_1
+    move-exception v0
 
-    :cond_4
-    return-object p4
+    move-object p0, v0
 
-    :cond_5
-    new-instance p0, Ljava/lang/IllegalArgumentException;
+    goto/16 :goto_a
 
-    const-string p1, "Credential can\'t be null or empty"
+    :cond_3
+    :goto_0
+    monitor-exit v8
 
-    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
+    return-object v2
 
-    throw p0
+    :cond_4
+    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
-    :cond_6
-    move-object v6, p1
+    move-result-wide v1
 
-    move v8, p2
+    invoke-static {}, Lcom/android/server/locksettings/LockSettingsService;->isEnablePrevCredential()Z
 
-    move-object v9, p3
+    move-result v3
 
-    const/4 p1, 0x0
+    const/4 v9, 0x1
 
-    const/16 p2, -0x270f
+    if-eqz v3, :cond_5
 
-    if-ne v8, p2, :cond_7
+    const/16 v3, -0x26ab
 
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    if-ne v0, v3, :cond_5
 
-    invoke-virtual {p3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    const-string/jumbo v0, "LockSettingsService"
 
-    move-result-object p3
+    const-string v1, "!@ try unlock with prevCredential!!!"
 
-    const-string/jumbo v0, "device_provisioned"
+    invoke-static {v0, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {p3, v0, p1}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I
+    invoke-virtual {p0, v7}, Lcom/android/server/locksettings/LockSettingsService;->getBackupLskfBasedProtectorId(I)J
 
-    move-result p3
+    move-result-wide v1
 
-    if-eqz p3, :cond_7
+    move v5, v7
 
-    const-string/jumbo p0, "LockSettingsService"
+    move v10, v9
 
-    const-string p1, "FRP credential can only be verified prior to provisioning."
+    :goto_1
+    move-wide v2, v1
 
-    invoke-static {p0, p1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    goto :goto_2
 
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    :cond_5
+    move v5, v0
 
-    return-object p0
+    move v10, v7
 
-    :cond_7
-    const/16 p3, -0x270e
+    goto :goto_1
 
-    if-ne v8, p3, :cond_8
+    :goto_2
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    invoke-static {p3}, Lcom/android/internal/widget/LockPatternUtils;->isRepairModeActive(Landroid/content/Context;)Z
+    move-result-object v1
 
-    move-result p3
+    move-object v4, p1
 
-    if-nez p3, :cond_8
+    move-object/from16 v6, p3
 
-    const-string/jumbo p0, "LockSettingsService"
+    invoke-virtual/range {v0 .. v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
-    const-string/jumbo p1, "Repair mode is not active on the device."
+    move-result-object v0
 
-    invoke-static {p0, p1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    iget-object v1, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    return-object p0
+    move-result v6
 
-    :cond_8
-    const-string/jumbo p3, "LockSettingsService"
+    if-nez v6, :cond_7
 
-    const-string/jumbo v0, "Verifying lockscreen credential for user %d"
+    and-int/lit8 v6, p4, 0x2
 
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    if-eqz v6, :cond_6
 
-    move-result-object v2
+    iget-object v6, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    filled-new-array {v2}, [Ljava/lang/Object;
+    invoke-virtual {v6, v5, v2, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->writeRepairModeCredentialLocked(IJ)Z
 
-    move-result-object v2
+    move-result v2
 
-    invoke-static {p3, v0, v2}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    if-nez v2, :cond_6
 
-    :try_start_0
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    const-string/jumbo p0, "LockSettingsService"
 
-    invoke-virtual {p3, v6, v8}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->doVerifyCredentialForDualDAR(Lcom/android/internal/widget/LockscreenCredential;I)Lcom/android/internal/widget/VerifyCredentialResponse;
+    const-string v0, "Failed to write repair mode credential"
 
-    move-result-object p3
+    invoke-static {p0, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {p3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    const-string/jumbo p0, "Verify success. But failed to write repair mode credential"
 
-    move-result v0
+    invoke-static {p0}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
 
-    if-eqz v0, :cond_9
+    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    const-string/jumbo v0, "LockSettingsService"
+    monitor-exit v8
 
-    const-string/jumbo v2, "verifyChallenge for DualDAR failed."
+    return-object p0
 
-    invoke-static {v0, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
+    :cond_6
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mBiometricDeferredQueue:Lcom/android/server/locksettings/BiometricDeferredQueue;
 
-    return-object p3
+    iget-object v3, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    :catch_0
-    move-exception v0
+    invoke-virtual {v3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    move-object p3, v0
+    sget-object v6, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_GK_AUTH:[B
 
-    const-string/jumbo v0, "LockSettingsService"
+    invoke-virtual {v3, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
 
-    new-instance v2, Ljava/lang/StringBuilder;
+    move-result-object v3
 
-    const-string/jumbo v3, "RemoteException : "
+    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    new-instance v6, Lcom/android/server/locksettings/BiometricDeferredQueue$$ExternalSyntheticLambda0;
 
-    invoke-virtual {p3}, Landroid/os/RemoteException;->getMessage()Ljava/lang/String;
+    invoke-direct {v6, v2, v5, v3}, Lcom/android/server/locksettings/BiometricDeferredQueue$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/locksettings/BiometricDeferredQueue;I[B)V
 
-    move-result-object p3
+    iget-object v2, v2, Lcom/android/server/locksettings/BiometricDeferredQueue;->mHandler:Landroid/os/Handler;
 
-    invoke-virtual {v2, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v6}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    :cond_7
+    monitor-exit v8
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_1
 
-    move-result-object p3
+    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    invoke-static {v0, p3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    move-result v2
 
-    :cond_9
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    if-nez v2, :cond_d
 
-    monitor-enter p3
+    const-string/jumbo v2, "LockSettingsService"
 
-    :try_start_1
-    invoke-static {v8}, Lcom/android/internal/widget/LockPatternUtils;->isSpecialUserId(I)Z
+    const-string/jumbo v3, "Successfully verified lockscreen credential for user %d"
 
-    move-result v0
+    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    if-eqz v0, :cond_c
+    move-result-object v6
 
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    filled-new-array {v6}, [Ljava/lang/Object;
 
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+    move-result-object v6
 
-    move-result-object v0
+    invoke-static {v2, v3, v6}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    invoke-virtual {p4, v8, v0, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifySpecialUserCredential(ILandroid/service/gatekeeper/IGateKeeperService;Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/VerifyCredentialResponse;
+    if-nez v10, :cond_8
 
-    move-result-object p4
+    invoke-static {v5, v7}, Lcom/samsung/android/lock/LsLog;->setFailureCount(II)V
 
-    invoke-virtual {p4}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
+    :cond_8
+    iget-object v2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    move-result v0
+    if-eqz v10, :cond_9
 
-    if-eqz v0, :cond_b
+    const/4 v3, 0x0
 
-    if-ne v8, p2, :cond_b
+    goto :goto_3
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    :cond_9
+    invoke-static {p1}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
 
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsStorage;->getPersistentDataBlockManager()Lcom/android/server/pdb/PersistentDataBlockManagerInternal;
+    move-result-object v3
 
-    move-result-object p0
+    :goto_3
+    invoke-virtual {p0, v2, v3, v5}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
 
-    if-eqz p0, :cond_a
+    and-int/lit8 v2, p4, 0x1
 
-    check-cast p0, Lcom/android/server/pdb/PersistentDataBlockService$InternalService;
+    if-eqz v2, :cond_c
 
-    iget-object p2, p0, Lcom/android/server/pdb/PersistentDataBlockService$InternalService;->this$0:Lcom/android/server/pdb/PersistentDataBlockService;
+    iget-object v0, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    iget-object p2, p2, Lcom/android/server/pdb/PersistentDataBlockService;->mLock:Ljava/lang/Object;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    monitor-enter p2
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
+    sget-object v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_GK_AUTH:[B
 
-    :try_start_2
-    iget-object p0, p0, Lcom/android/server/pdb/PersistentDataBlockService$InternalService;->this$0:Lcom/android/server/pdb/PersistentDataBlockService;
+    invoke-virtual {v0, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
 
-    iput-boolean p1, p0, Lcom/android/server/pdb/PersistentDataBlockService;->mFrpActive:Z
+    move-result-object v0
 
-    invoke-virtual {p0, p1}, Lcom/android/server/pdb/PersistentDataBlockService;->setOldSettingForBackworkCompatibility(Z)V
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mGatekeeperPasswords:Landroid/util/LongSparseArray;
 
-    monitor-exit p2
+    monitor-enter v2
 
-    goto :goto_2
+    const-wide/16 v10, 0x0
 
-    :catchall_0
-    move-exception v0
+    move-wide v12, v10
 
-    move-object p0, v0
+    :goto_4
+    cmp-long v1, v12, v10
 
-    monitor-exit p2
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+    if-eqz v1, :cond_b
 
     :try_start_3
-    throw p0
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mGatekeeperPasswords:Landroid/util/LongSparseArray;
 
-    :cond_a
-    const-string/jumbo p0, "LockSettingsStorage"
+    invoke-virtual {v1, v12, v13}, Landroid/util/LongSparseArray;->get(J)Ljava/lang/Object;
 
-    const-string p1, "Failed to get PersistentDataBlockManagerInternal"
+    move-result-object v1
 
-    invoke-static {p0, p1}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I
+    if-eqz v1, :cond_a
 
-    goto :goto_2
+    goto :goto_5
 
-    :catchall_1
-    move-exception v0
+    :cond_a
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mGatekeeperPasswords:Landroid/util/LongSparseArray;
 
-    move-object p0, v0
+    invoke-virtual {v1, v12, v13, v0}, Landroid/util/LongSparseArray;->put(JLjava/lang/Object;)V
 
-    goto/16 :goto_c
+    monitor-exit v2
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_2
 
-    :cond_b
-    :goto_2
-    monitor-exit p3
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    return-object p4
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda0;
 
-    :cond_c
-    invoke-virtual {p0, v8}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
+    invoke-direct {v1, p0, v12, v13}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/locksettings/LockSettingsService;J)V
 
-    move-result-wide v2
+    const-wide/32 v2, 0x927c0
 
-    invoke-static {}, Lcom/android/server/locksettings/LockSettingsService;->isEnablePrevCredential()Z
+    invoke-virtual {v0, v1, v2, v3}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
 
-    move-result p2
+    new-instance v0, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
 
-    const/4 v0, 0x1
+    invoke-direct {v0}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;-><init>()V
 
-    if-eqz p2, :cond_d
+    invoke-virtual {v0, v12, v13}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->setGatekeeperPasswordHandle(J)Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
 
-    const/16 p2, -0x26ab
+    move-result-object v0
 
-    if-ne v8, p2, :cond_d
+    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->build()Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    const-string/jumbo p2, "LockSettingsService"
+    move-result-object v1
 
-    const-string v2, "!@ try unlock with prevCredential!!!"
+    goto :goto_7
 
-    invoke-static {p2, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    :catchall_2
+    move-exception v0
 
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->getBackupLskfBasedProtectorId(I)J
+    move-object p0, v0
 
-    move-result-wide v2
+    goto :goto_6
 
-    move v7, p1
+    :cond_b
+    :goto_5
+    :try_start_4
+    sget-object v1, Lcom/android/server/locksettings/SecureRandomUtils;->RNG:Ljava/security/SecureRandom;
 
-    move p2, v0
+    invoke-virtual {v1}, Ljava/security/SecureRandom;->nextLong()J
 
-    :goto_3
-    move-wide v4, v2
+    move-result-wide v12
 
     goto :goto_4
 
-    :cond_d
-    move p2, p1
+    :goto_6
+    monitor-exit v2
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_2
 
-    move v7, v8
+    throw p0
 
-    goto :goto_3
+    :cond_c
+    :goto_7
+    invoke-virtual {p0, p1, v5}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnUnlockIfRequired(Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    :goto_4
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    const-string/jumbo v0, "persist.escrowvault.sa.signed"
 
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+    invoke-static {v0, v7}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z
 
-    move-result-object v3
+    move-result v0
 
-    move-object v8, v9
+    new-instance v2, Ljava/lang/StringBuilder;
 
-    invoke-virtual/range {v2 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    const-string/jumbo v3, "isSaSignedIn : "
 
-    move-result-object v2
+    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget-object v3, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result v8
+    move-result-object v2
 
-    if-nez v8, :cond_f
+    const-string/jumbo v3, "LockSettingsService"
 
-    and-int/lit8 v8, p4, 0x2
+    invoke-static {v3, v2}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    if-eqz v8, :cond_e
+    if-eqz v0, :cond_f
 
-    iget-object v8, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    invoke-virtual {p0, p1, v5}, Lcom/android/server/locksettings/LockSettingsService;->updateVerifier(Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    invoke-virtual {v8, v7, v4, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->writeRepairModeCredentialLocked(IJ)Z
+    goto :goto_8
 
-    move-result v4
+    :cond_d
+    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    if-nez v4, :cond_e
+    move-result v0
 
-    const-string/jumbo p0, "LockSettingsService"
+    if-ne v0, v9, :cond_f
 
-    const-string p1, "Failed to write repair mode credential"
+    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse;->getTimeout()I
 
-    invoke-static {p0, p1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    move-result v0
 
-    const-string/jumbo p0, "Verify success. But failed to write repair mode credential"
+    if-lez v0, :cond_e
 
-    invoke-static {p0}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
+    const/16 v0, 0x8
 
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {p0, v0, v5}, Lcom/android/server/locksettings/LockSettingsService;->requireStrongAuth(II)V
 
-    monitor-exit p3
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
-    return-object p0
+    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
 
-    :cond_e
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mBiometricDeferredQueue:Lcom/android/server/locksettings/BiometricDeferredQueue;
+    move-result-object v0
 
-    iget-object v5, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    invoke-virtual {v0, v5}, Landroid/app/admin/DevicePolicyManager;->getCurrentFailedPasswordAttempts(I)I
 
-    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    move-result v0
 
-    sget-object v8, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_GK_AUTH:[B
+    add-int/2addr v0, v9
 
-    invoke-virtual {v5, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
+    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v5
+    move-result-object v0
+
+    filled-new-array {v0}, [Ljava/lang/Object;
+
+    move-result-object v0
 
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    const/16 v2, 0x53
 
-    new-instance v8, Lcom/android/server/locksettings/BiometricDeferredQueue$$ExternalSyntheticLambda0;
+    invoke-static {v5, v2, v0}, Landroid/sec/enterprise/auditlog/AuditLog;->logEventAsUser(II[Ljava/lang/Object;)V
 
-    invoke-direct {v8, v4, v7, v5}, Lcom/android/server/locksettings/BiometricDeferredQueue$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/locksettings/BiometricDeferredQueue;I[B)V
+    :cond_e
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    iget-object v4, v4, Lcom/android/server/locksettings/BiometricDeferredQueue;->mHandler:Landroid/os/Handler;
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDoVerifySI:Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
 
-    invoke-virtual {v4, v8}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+    invoke-virtual {v0, v2}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
     :cond_f
-    monitor-exit p3
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    :goto_8
+    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    move-result v0
 
-    move-result p3
+    if-nez v0, :cond_10
 
-    if-nez p3, :cond_17
+    move v7, v9
 
-    const-string/jumbo p3, "LockSettingsService"
+    :cond_10
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mLockSettingsStateListeners:Ljava/util/concurrent/CopyOnWriteArrayList;
 
-    const-string/jumbo v4, "Successfully verified lockscreen credential for user %d"
+    invoke-virtual {p0}, Ljava/util/concurrent/CopyOnWriteArrayList;->iterator()Ljava/util/Iterator;
 
-    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    move-result-object p0
 
-    move-result-object v5
+    :goto_9
+    invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
 
-    filled-new-array {v5}, [Ljava/lang/Object;
+    move-result v0
 
-    move-result-object v5
+    if-eqz v0, :cond_12
 
-    invoke-static {p3, v4, v5}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
-    if-nez p2, :cond_10
+    move-result-object v0
 
-    invoke-static {v7, p1}, Lcom/samsung/android/lock/LsLog;->setFailureCount(II)V
+    check-cast v0, Lcom/android/internal/widget/LockSettingsStateListener;
 
-    :cond_10
-    iget-object p3, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    if-eqz v7, :cond_11
 
-    if-eqz p2, :cond_11
+    invoke-interface {v0, v5}, Lcom/android/internal/widget/LockSettingsStateListener;->onAuthenticationSucceeded(I)V
 
-    goto :goto_5
+    goto :goto_9
 
     :cond_11
-    invoke-static {v6}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
+    invoke-interface {v0, v5}, Lcom/android/internal/widget/LockSettingsStateListener;->onAuthenticationFailed(I)V
 
-    move-result-object v1
+    goto :goto_9
 
-    :goto_5
-    invoke-virtual {p0, p3, v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
+    :cond_12
+    return-object v1
 
-    invoke-virtual {p0, v7}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
+    :goto_a
+    :try_start_5
+    monitor-exit v8
+    :try_end_5
+    .catchall {:try_start_5 .. :try_end_5} :catchall_1
 
-    move-result p2
+    throw p0
 
-    if-eqz p2, :cond_12
+    :cond_13
+    new-instance p0, Ljava/lang/IllegalArgumentException;
 
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    const-string v0, "Credential can\'t be null or empty"
 
-    iget-object p3, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    invoke-direct {p0, v0}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v6}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
+    throw p0
+.end method
 
-    move-result-object v1
+.method public final doVerifyCredentialForDualDarDo(Lcom/android/internal/widget/LockscreenCredential;IILcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;)Lcom/android/internal/widget/VerifyCredentialResponse;
+    .locals 9
 
-    invoke-virtual {p2, p3, v7, v1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->activateEscrowTokensForDualDAR(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I[B)V
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    :cond_12
-    and-int/lit8 p2, p4, 0x1
+    const-string/jumbo v1, "Verify credential for dual-dar user "
 
-    if-eqz p2, :cond_15
+    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget-object p2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    sget-object p3, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_GK_AUTH:[B
-
-    invoke-virtual {p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
-
-    move-result-object p2
-
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mGatekeeperPasswords:Landroid/util/LongSparseArray;
-
-    monitor-enter p3
-
-    const-wide/16 v1, 0x0
-
-    move-wide v3, v1
-
-    :goto_6
-    cmp-long p4, v3, v1
-
-    if-eqz p4, :cond_14
-
-    :try_start_4
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mGatekeeperPasswords:Landroid/util/LongSparseArray;
-
-    invoke-virtual {p4, v3, v4}, Landroid/util/LongSparseArray;->get(J)Ljava/lang/Object;
-
-    move-result-object p4
-
-    if-eqz p4, :cond_13
-
-    goto :goto_7
-
-    :cond_13
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mGatekeeperPasswords:Landroid/util/LongSparseArray;
-
-    invoke-virtual {p4, v3, v4, p2}, Landroid/util/LongSparseArray;->put(JLjava/lang/Object;)V
-
-    monitor-exit p3
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_2
-
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
-
-    new-instance p3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda0;
-
-    invoke-direct {p3, p0, v3, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/locksettings/LockSettingsService;J)V
-
-    const-wide/32 v1, 0x927c0
-
-    invoke-virtual {p2, p3, v1, v2}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
-
-    new-instance p2, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
-
-    invoke-direct {p2}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;-><init>()V
-
-    invoke-virtual {p2, v3, v4}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->setGatekeeperPasswordHandle(J)Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
-
-    move-result-object p2
-
-    invoke-virtual {p2}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->build()Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object v3
-
-    goto :goto_9
-
-    :catchall_2
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_8
-
-    :cond_14
-    :goto_7
-    :try_start_5
-    sget-object p4, Lcom/android/server/locksettings/SecureRandomUtils;->RNG:Ljava/security/SecureRandom;
-
-    invoke-virtual {p4}, Ljava/security/SecureRandom;->nextLong()J
-
-    move-result-wide v3
-
-    goto :goto_6
-
-    :goto_8
-    monitor-exit p3
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_2
-
-    throw p0
-
-    :cond_15
-    :goto_9
-    invoke-virtual {p0, v6, v7}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnUnlockIfRequired(Lcom/android/internal/widget/LockscreenCredential;I)V
-
-    invoke-static {v7}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_16
-
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {p2}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
-
-    move-result-object p2
-
-    invoke-virtual {p2, v7}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->cancelDataLock(I)V
-
-    :cond_16
-    const-string/jumbo p2, "persist.escrowvault.sa.signed"
-
-    invoke-static {p2, p1}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z
-
-    move-result p2
-
-    new-instance p3, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p4, "isSaSignedIn : "
-
-    invoke-direct {p3, p4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p3, p2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p3
-
-    const-string/jumbo p4, "LockSettingsService"
-
-    invoke-static {p4, p3}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    if-eqz p2, :cond_19
-
-    invoke-virtual {p0, v6, v7}, Lcom/android/server/locksettings/LockSettingsService;->updateVerifier(Lcom/android/internal/widget/LockscreenCredential;I)V
-
-    goto :goto_a
-
-    :cond_17
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
-
-    move-result p2
-
-    if-ne p2, v0, :cond_19
-
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getTimeout()I
-
-    move-result p2
-
-    if-lez p2, :cond_18
-
-    const/16 p2, 0x8
-
-    invoke-virtual {p0, p2, v7}, Lcom/android/server/locksettings/LockSettingsService;->requireStrongAuth(II)V
-
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
-
-    invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
-
-    move-result-object p2
-
-    invoke-virtual {p2, v7}, Landroid/app/admin/DevicePolicyManager;->getCurrentFailedPasswordAttempts(I)I
-
-    move-result p2
-
-    add-int/2addr p2, v0
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p2
-
-    filled-new-array {p2}, [Ljava/lang/Object;
-
-    move-result-object p2
-
-    const/16 p3, 0x53
-
-    invoke-static {v7, p3, p2}, Landroid/sec/enterprise/auditlog/AuditLog;->logEventAsUser(II[Ljava/lang/Object;)V
-
-    :cond_18
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
-
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mDoVerifySI:Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
-
-    invoke-virtual {p2, p3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
-
-    :cond_19
-    :goto_a
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
-
-    move-result p2
-
-    if-nez p2, :cond_1a
-
-    move p1, v0
-
-    :cond_1a
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mLockSettingsStateListeners:Ljava/util/concurrent/CopyOnWriteArrayList;
-
-    invoke-virtual {p0}, Ljava/util/concurrent/CopyOnWriteArrayList;->iterator()Ljava/util/Iterator;
-
-    move-result-object p0
-
-    :goto_b
-    invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1c
-
-    invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object p2
-
-    check-cast p2, Lcom/android/internal/widget/LockSettingsStateListener;
-
-    if-eqz p1, :cond_1b
-
-    invoke-interface {p2, v7}, Lcom/android/internal/widget/LockSettingsStateListener;->onAuthenticationSucceeded(I)V
-
-    goto :goto_b
-
-    :cond_1b
-    invoke-interface {p2, v7}, Lcom/android/internal/widget/LockSettingsStateListener;->onAuthenticationFailed(I)V
-
-    goto :goto_b
-
-    :cond_1c
-    return-object v3
-
-    :goto_c
-    :try_start_6
-    monitor-exit p3
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_1
-
-    throw p0
-
-    :cond_1d
-    new-instance p0, Ljava/lang/IllegalArgumentException;
-
-    const-string p1, "Credential can\'t be null or empty"
-
-    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-.end method
-
-.method public final doVerifyCredentialForDualDarDo(Lcom/android/internal/widget/LockscreenCredential;IILcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 9
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "Verify credential for dual-dar user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object v0
 
@@ -5109,13 +4334,13 @@
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
     :cond_1
-    if-eqz p1, :cond_a
+    if-eqz p1, :cond_e
 
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v0
 
-    if-nez v0, :cond_a
+    if-nez v0, :cond_e
 
     const-string/jumbo v0, "LockSettingsService"
 
@@ -5213,7 +4438,7 @@
 
     move-object p0, v0
 
-    goto/16 :goto_3
+    goto/16 :goto_b
 
     :cond_2
     :goto_0
@@ -5240,7 +4465,7 @@
 
     const/4 v1, 0x1
 
-    if-nez v0, :cond_8
+    if-nez v0, :cond_c
 
     const-string/jumbo v0, "LockSettingsService"
 
@@ -5258,7 +4483,7 @@
 
     and-int/2addr p3, v1
 
-    if-eqz p3, :cond_6
+    if-eqz p3, :cond_a
 
     iget-object p1, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
@@ -5268,7 +4493,7 @@
 
     if-nez p1, :cond_4
 
-    goto/16 :goto_2
+    goto/16 :goto_9
 
     :cond_4
     new-instance v0, Ljava/lang/StringBuilder;
@@ -5332,7 +4557,7 @@
 
     monitor-exit v2
     :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_4
 
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
 
@@ -5344,7 +4569,7 @@
 
     move-result p3
 
-    if-nez p3, :cond_7
+    if-nez p3, :cond_b
 
     new-instance p3, Ljava/lang/StringBuilder;
 
@@ -5370,80 +4595,324 @@
 
     move-result-object p4
 
-    invoke-virtual {p3, p4, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->onCredentialVerifiedForInner(Lcom/android/internal/widget/LockscreenCredential;I)Z
+    invoke-virtual {p3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    goto :goto_2
+    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
 
-    :catchall_1
-    move-exception v0
+    move-result v0
 
-    move-object p0, v0
+    if-eqz v0, :cond_b
 
-    :try_start_2
-    monitor-exit v2
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
+    iget-object v0, p3, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
-    throw p0
+    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
 
-    :cond_6
-    iget-object p1, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
 
-    invoke-static {v6}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
+    invoke-virtual {v0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
 
-    move-result-object p3
+    move-result v0
 
-    invoke-virtual {p0, p1, p3, v7}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
+    if-eqz v0, :cond_b
 
-    :cond_7
-    :goto_2
-    invoke-virtual {p0, v6, v7}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnUnlockIfRequired(Lcom/android/internal/widget/LockscreenCredential;I)V
+    iget-object v0, p3, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
-    invoke-static {v7}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
+    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
 
-    move-result p1
+    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
 
-    if-eqz p1, :cond_9
+    invoke-virtual {v0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    move-result v2
 
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
+    iget-object v0, p3, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
-    move-result-object p0
+    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-virtual {p0, v7}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->cancelDataLock(I)V
+    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
-    return-object p2
+    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
 
-    :cond_8
-    invoke-virtual {p2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    move-result-object v0
 
-    move-result p1
+    invoke-virtual {p4}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    if-ne p1, v1, :cond_9
+    move-result v3
 
-    invoke-virtual {p2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getTimeout()I
+    if-eqz v3, :cond_6
 
-    move-result p1
+    move-object v3, v1
 
-    if-lez p1, :cond_9
+    goto :goto_2
 
-    const/16 p1, 0x8
+    :cond_6
+    invoke-virtual {p4}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
 
-    invoke-virtual {p0, p1, v7}, Lcom/android/server/locksettings/LockSettingsService;->requireStrongAuth(II)V
+    move-result-object v3
 
-    :cond_9
-    return-object p2
+    :goto_2
+    invoke-virtual {v0, v2, v3}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Auth(I[B)Z
 
-    :goto_3
-    :try_start_3
-    monitor-exit v1
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
+    move-result v0
 
-    throw p0
+    if-eqz v0, :cond_9
+
+    const-string/jumbo v0, "LockSettingsService.DarVirtualLock"
+
+    const-string v3, "Inner-layer authenticated with auth user "
+
+    invoke-static {p1, v3, v0}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+
+    iget-object v0, p3, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    move-object v3, v0
+
+    check-cast v3, Lcom/android/server/locksettings/LockSettingsService;
+
+    monitor-enter v3
+
+    :try_start_2
+    iget-object v0, v3, Lcom/android/server/locksettings/LockSettingsService;->mUserPasswordMetrics:Landroid/util/SparseArray;
+
+    invoke-static {p4}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
+
+    move-result-object p4
+
+    invoke-virtual {v0, p1, p4}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
+
+    monitor-exit v3
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_3
+
+    iget-object p1, p3, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    check-cast p1, Lcom/android/server/locksettings/LockSettingsService;
+
+    iget-object p1, p1, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
+
+    monitor-enter p1
+
+    :try_start_3
+    iget-object p4, p3, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    check-cast p4, Lcom/android/server/locksettings/LockSettingsService;
+
+    iget-object p4, p4, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
+
+    invoke-virtual {p4, v2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
+
+    move-result-object p4
+
+    check-cast p4, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;
+
+    if-eqz p4, :cond_8
+
+    iget-object v0, p3, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
+
+    iget-object v3, p4, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mSyntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+
+    iget-object v4, p4, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mPasswordMetrics:Landroid/app/admin/PasswordMetrics;
+
+    invoke-virtual {v0, v3, v4, v2}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
+
+    sget-object v0, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DEVICE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
+
+    invoke-static {v2, v0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
+
+    sget-object v0, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
+
+    invoke-static {v2, v0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
+
+    iget-object p4, p4, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mDualDARCallback:Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_2
+
+    :try_start_4
+    iget-object v0, p4, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->mCallback:Ljava/lang/Object;
+
+    check-cast v0, Lcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;
+
+    if-eqz v0, :cond_7
+
+    invoke-interface {v0}, Lcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;->onInnerLayerUnlocked()V
+    :try_end_4
+    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_0
+    .catchall {:try_start_4 .. :try_end_4} :catchall_1
+
+    goto :goto_3
+
+    :catchall_1
+    move-exception v0
+
+    move-object p0, v0
+
+    goto :goto_6
+
+    :catch_0
+    move-exception v0
+
+    goto :goto_5
+
+    :cond_7
+    :goto_3
+    :try_start_5
+    iput-object v1, p4, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->mCallback:Ljava/lang/Object;
+
+    iget-object p3, p3, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    check-cast p3, Lcom/android/server/locksettings/LockSettingsService;
+
+    iget-object p3, p3, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
+
+    :goto_4
+    invoke-virtual {p3, v2}, Landroid/util/SparseArray;->remove(I)V
+    :try_end_5
+    .catchall {:try_start_5 .. :try_end_5} :catchall_2
+
+    goto :goto_7
+
+    :catchall_2
+    move-exception v0
+
+    move-object p0, v0
+
+    goto :goto_8
+
+    :goto_5
+    :try_start_6
+    const-string/jumbo v3, "LockSettingsService.DarVirtualLock"
+
+    const-string v4, "Callback might be dead..."
+
+    invoke-static {v0, v3, v4}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
+    :try_end_6
+    .catchall {:try_start_6 .. :try_end_6} :catchall_1
+
+    :try_start_7
+    iput-object v1, p4, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->mCallback:Ljava/lang/Object;
+
+    iget-object p3, p3, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    check-cast p3, Lcom/android/server/locksettings/LockSettingsService;
+
+    iget-object p3, p3, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
+
+    goto :goto_4
+
+    :goto_6
+    iput-object v1, p4, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->mCallback:Ljava/lang/Object;
+
+    iget-object p2, p3, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    check-cast p2, Lcom/android/server/locksettings/LockSettingsService;
+
+    iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
+
+    invoke-virtual {p2, v2}, Landroid/util/SparseArray;->remove(I)V
+
+    throw p0
+
+    :cond_8
+    :goto_7
+    monitor-exit p1
+
+    goto :goto_9
+
+    :goto_8
+    monitor-exit p1
+    :try_end_7
+    .catchall {:try_start_7 .. :try_end_7} :catchall_2
+
+    throw p0
+
+    :catchall_3
+    move-exception v0
+
+    move-object p0, v0
+
+    :try_start_8
+    monitor-exit v3
+    :try_end_8
+    .catchall {:try_start_8 .. :try_end_8} :catchall_3
+
+    throw p0
+
+    :cond_9
+    const-string/jumbo p3, "LockSettingsService.DarVirtualLock"
+
+    const-string p4, "Failed in inner-layer authentication with auth user "
+
+    invoke-static {p1, p4}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
+
+    move-result-object p1
+
+    const/4 p4, 0x0
+
+    new-array p4, p4, [Ljava/lang/Object;
+
+    invoke-static {p3, p1, p4}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+
+    goto :goto_9
+
+    :catchall_4
+    move-exception v0
+
+    move-object p0, v0
+
+    :try_start_9
+    monitor-exit v2
+    :try_end_9
+    .catchall {:try_start_9 .. :try_end_9} :catchall_4
+
+    throw p0
 
     :cond_a
+    iget-object p1, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+
+    invoke-static {v6}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
+
+    move-result-object p3
+
+    invoke-virtual {p0, p1, p3, v7}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
+
+    :cond_b
+    :goto_9
+    invoke-virtual {p0, v6, v7}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnUnlockIfRequired(Lcom/android/internal/widget/LockscreenCredential;I)V
+
+    goto :goto_a
+
+    :cond_c
+    invoke-virtual {p2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+
+    move-result p1
+
+    if-ne p1, v1, :cond_d
+
+    invoke-virtual {p2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getTimeout()I
+
+    move-result p1
+
+    if-lez p1, :cond_d
+
+    const/16 p1, 0x8
+
+    invoke-virtual {p0, p1, v7}, Lcom/android/server/locksettings/LockSettingsService;->requireStrongAuth(II)V
+
+    :cond_d
+    :goto_a
+    return-object p2
+
+    :goto_b
+    :try_start_a
+    monitor-exit v1
+    :try_end_a
+    .catchall {:try_start_a .. :try_end_a} :catchall_0
+
+    throw p0
+
+    :cond_e
     new-instance p0, Ljava/lang/IllegalArgumentException;
 
     const-string p1, "Credential can\'t be null or empty"
@@ -7070,32 +6539,6 @@
     throw p0
 .end method
 
-.method public final gateKeeperClearSecureUserId(I)V
-    .locals 1
-
-    :try_start_0
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object p0
-
-    invoke-interface {p0, p1}, Landroid/service/gatekeeper/IGateKeeperService;->clearSecureUserId(I)V
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-void
-
-    :catch_0
-    move-exception p0
-
-    const-string/jumbo p1, "LockSettingsService"
-
-    const-string v0, "Failed to clear SID"
-
-    invoke-static {p1, v0, p0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    return-void
-.end method
-
 .method public final generateKey(Ljava/lang/String;)Ljava/lang/String;
     .locals 1
 
@@ -7958,27 +7401,6 @@
 
     invoke-static {v0, v1, v2}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/StreamCipher;->decryptStream(Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object p1
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p1, v0
-
-    goto/16 :goto_6
-
-    :cond_0
-    :goto_0
     invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isProfileWithUnifiedLock(I)Z
 
     move-result v0
@@ -7987,7 +7409,7 @@
 
     const/4 v1, 0x0
 
-    if-eqz v0, :cond_1
+    if-eqz v0, :cond_0
 
     :try_start_1
     invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->getDecryptedPasswordForTiedProfile(I)Lcom/android/internal/widget/LockscreenCredential;
@@ -7997,10 +7419,17 @@
     .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :cond_1
+    :cond_0
     move-object v6, p1
 
-    goto :goto_1
+    goto :goto_0
+
+    :catchall_0
+    move-exception v0
+
+    move-object p1, v0
+
+    goto :goto_5
 
     :catch_0
     move-exception v0
@@ -8020,7 +7449,7 @@
 
     return-object v1
 
-    :goto_1
+    :goto_0
     :try_start_3
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
@@ -8032,7 +7461,7 @@
 
     const/4 v2, 0x0
 
-    if-ne p2, v0, :cond_2
+    if-ne p2, v0, :cond_1
 
     :try_start_4
     const-string/jumbo p2, "LockSettingsService"
@@ -8047,38 +7476,38 @@
 
     move v2, p2
 
-    goto :goto_2
+    goto :goto_1
 
     :catchall_1
     move-exception v0
 
     move-object p2, v0
 
-    goto :goto_5
+    goto :goto_4
 
-    :cond_2
+    :cond_1
     move v7, p2
 
-    :goto_2
-    if-eqz v2, :cond_3
+    :goto_1
+    if-eqz v2, :cond_2
 
     invoke-virtual {p0, v7}, Lcom/android/server/locksettings/LockSettingsService;->getBackupLskfBasedProtectorId(I)J
 
     move-result-wide v2
 
-    :goto_3
+    :goto_2
     move-wide v4, v2
 
-    goto :goto_4
+    goto :goto_3
 
-    :cond_3
+    :cond_2
     invoke-virtual {p0, v7}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
     move-result-wide v2
 
-    goto :goto_3
+    goto :goto_2
 
-    :goto_4
+    :goto_3
     iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
@@ -8093,7 +7522,7 @@
 
     iget-object p2, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    if-nez p2, :cond_4
+    if-nez p2, :cond_3
 
     const-string/jumbo p2, "LockSettingsService"
 
@@ -8109,7 +7538,7 @@
 
     return-object v1
 
-    :cond_4
+    :cond_3
     :try_start_5
     invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8127,7 +7556,7 @@
 
     return-object p2
 
-    :goto_5
+    :goto_4
     :try_start_6
     monitor-exit p1
     :try_end_6
@@ -8138,7 +7567,7 @@
     :try_end_7
     .catchall {:try_start_7 .. :try_end_7} :catchall_0
 
-    :goto_6
+    :goto_5
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->scheduleGc()V
 
     throw p1
@@ -9460,99 +8889,6 @@
     return p0
 .end method
 
-.method public final isDualDarAuthUserId(I)Z
-    .locals 1
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {p0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
-
-    move-result p0
-
-    return p0
-
-    :cond_0
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_1
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_1
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_1
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final isEnterpriseUserId(I)Z
-    .locals 2
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getUserManagerInternal()Lcom/android/server/pm/UserManagerInternal;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerInternal;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    const/4 p0, 0x0
-
-    :goto_0
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return p0
-
-    :goto_1
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
 .method public final isEscrowTokenActive(JI)Z
     .locals 2
 
@@ -10158,11 +9494,11 @@
 
     move-result-object v2
 
-    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;
+    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;
 
     const/4 v4, 0x0
 
-    invoke-direct {v3, p1, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;-><init>(II)V
+    invoke-direct {v3, p1, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;-><init>(II)V
 
     invoke-virtual {v2, v3}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
@@ -10210,11 +9546,11 @@
 
     move-result-object p1
 
-    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;
+    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;
 
     const/4 v4, 0x0
 
-    invoke-direct {v3, p0, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+    invoke-direct {v3, p0, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
 
     invoke-virtual {p1, v2, v3}, Landroid/app/admin/DevicePolicyResourcesManager;->getString(Ljava/lang/String;Ljava/util/function/Supplier;)Ljava/lang/String;
 
@@ -10233,11 +9569,11 @@
 
     move-result-object p1
 
-    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;
+    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;
 
-    const/4 v4, 0x5
+    const/4 v4, 0x4
 
-    invoke-direct {v3, p0, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+    invoke-direct {v3, p0, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
 
     invoke-virtual {p1, v2, v3}, Landroid/app/admin/DevicePolicyResourcesManager;->getString(Ljava/lang/String;Ljava/util/function/Supplier;)Ljava/lang/String;
 
@@ -10256,11 +9592,11 @@
 
     move-result-object p1
 
-    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;
+    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;
 
-    const/4 v4, 0x1
+    const/4 v4, 0x5
 
-    invoke-direct {v3, p0, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+    invoke-direct {v3, p0, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
 
     invoke-virtual {p1, v2, v3}, Landroid/app/admin/DevicePolicyResourcesManager;->getString(Ljava/lang/String;Ljava/util/function/Supplier;)Ljava/lang/String;
 
@@ -10301,11 +9637,11 @@
 
     move-result-object v3
 
-    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;
+    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;
 
     const/4 v5, 0x1
 
-    invoke-direct {v4, v2, v5}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;-><init>(II)V
+    invoke-direct {v4, v2, v5}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;-><init>(II)V
 
     invoke-virtual {v3, v4}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
@@ -10337,11 +9673,11 @@
 
     move-result-object v2
 
-    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;
+    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;
 
-    const/4 v5, 0x2
+    const/4 v5, 0x1
 
-    invoke-direct {v4, p0, v5}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+    invoke-direct {v4, p0, v5}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
 
     invoke-virtual {v2, v3, v4}, Landroid/app/admin/DevicePolicyResourcesManager;->getString(Ljava/lang/String;Ljava/util/function/Supplier;)Ljava/lang/String;
 
@@ -10360,11 +9696,11 @@
 
     move-result-object v2
 
-    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;
+    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;
 
-    const/4 v5, 0x3
+    const/4 v5, 0x2
 
-    invoke-direct {v4, p0, v5}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+    invoke-direct {v4, p0, v5}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
 
     invoke-virtual {v2, v3, v4}, Landroid/app/admin/DevicePolicyResourcesManager;->getString(Ljava/lang/String;Ljava/util/function/Supplier;)Ljava/lang/String;
 
@@ -10397,11 +9733,11 @@
 
     move-result-object v3
 
-    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;
+    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;
 
     const/4 v5, 0x2
 
-    invoke-direct {v4, v2, v5}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;-><init>(II)V
+    invoke-direct {v4, v2, v5}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;-><init>(II)V
 
     invoke-virtual {v3, v4}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
@@ -10431,11 +9767,11 @@
 
     move-result-object v2
 
-    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;
+    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;
 
-    const/4 v4, 0x4
+    const/4 v4, 0x3
 
-    invoke-direct {v3, p0, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+    invoke-direct {v3, p0, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
 
     const-string v4, "Core.PROFILE_ENCRYPTED_DETAIL"
 
@@ -11795,84 +11131,8 @@
     throw p0
 .end method
 
-.method public final notifyPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
-    .locals 2
-
-    invoke-static {p2}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    invoke-static {p1}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
-
-    move-result-object p1
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
-
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;
-
-    invoke-direct {v1, p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/locksettings/LockSettingsService;Landroid/app/admin/PasswordMetrics;I)V
-
-    invoke-virtual {v0, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
-
-    return-void
-
-    :cond_1
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
-
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;
-
-    invoke-direct {v1, p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
-
-    invoke-virtual {v0, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
-
-    return-void
-.end method
-
 .method public final notifyPasswordChangedForEnterpriseUser(Lcom/android/internal/widget/LockscreenCredential;I)V
-    .locals 1
-
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->notifyPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
-
-    :cond_0
-    return-void
-.end method
-
-.method public final notifySeparateProfileChallengeChanged(I)V
-    .locals 1
-
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
-
-    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;
-
-    invoke-direct {v0, p1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;-><init>(I)V
-
-    invoke-virtual {p0, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+    .locals 0
 
     return-void
 .end method
@@ -11880,20 +11140,7 @@
 .method public final onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
     .locals 7
 
-    invoke-static {p3}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p0, p3, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->migrateWithAuthToken(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-
-    return-void
-
-    :cond_0
-    if-eqz p2, :cond_1
+    if-eqz p2, :cond_0
 
     monitor-enter p0
 
@@ -11915,7 +11162,7 @@
 
     throw p1
 
-    :cond_1
+    :cond_0
     :goto_0
     invoke-virtual {p0, p3, p1}, Lcom/android/server/locksettings/LockSettingsService;->unlockKeystore(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
 
@@ -11923,21 +11170,6 @@
 
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->unlockUser(I)V
 
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p2, p3}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_2
-
-    invoke-static {p3}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_4
-
-    :cond_2
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     monitor-enter p2
@@ -11960,7 +11192,7 @@
 
     move-result v1
 
-    if-eqz v1, :cond_3
+    if-eqz v1, :cond_1
 
     invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -11997,17 +11229,16 @@
 
     goto :goto_3
 
-    :cond_3
+    :cond_1
     monitor-exit p2
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_1
 
-    :cond_4
     iget-boolean p2, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSecureFolderAuthToken:Z
 
     const/4 v0, 0x0
 
-    if-eqz p2, :cond_5
+    if-eqz p2, :cond_2
 
     const-string/jumbo p2, "onCredentialVerified : unlockSecureFolderWithToken is true."
 
@@ -12019,18 +11250,18 @@
 
     return-void
 
-    :cond_5
+    :cond_2
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
 
     move-result p2
 
-    if-eqz p2, :cond_8
+    if-eqz p2, :cond_5
 
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
 
     move-result p2
 
-    if-eqz p2, :cond_7
+    if-eqz p2, :cond_4
 
     :try_start_2
     const-string/jumbo p2, "password_policy"
@@ -12043,7 +11274,7 @@
 
     move-result-object p2
 
-    if-eqz p2, :cond_6
+    if-eqz p2, :cond_3
 
     invoke-interface {p2, p3}, Lcom/samsung/android/knox/devicesecurity/IPasswordPolicy;->isChangeRequestedAsUser(I)I
 
@@ -12051,7 +11282,7 @@
     :try_end_2
     .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0
 
-    if-lez p2, :cond_6
+    if-lez p2, :cond_3
 
     const-string/jumbo p2, "LockSettingsService"
 
@@ -12066,7 +11297,7 @@
 
     invoke-virtual {p2}, Ljava/lang/Exception;->printStackTrace()V
 
-    :cond_6
+    :cond_3
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
     const-class v1, Landroid/app/trust/TrustManager;
@@ -12081,12 +11312,12 @@
 
     goto :goto_2
 
-    :cond_7
+    :cond_4
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mStrongAuth:Lcom/android/server/locksettings/LockSettingsStrongAuth;
 
     invoke-virtual {p2, v0, p3}, Lcom/android/server/locksettings/LockSettingsStrongAuth;->requireStrongAuth(II)V
 
-    :cond_8
+    :cond_5
     :goto_2
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mStrongAuth:Lcom/android/server/locksettings/LockSettingsStrongAuth;
 
@@ -12136,7 +11367,7 @@
 
     if-eqz v0, :cond_0
 
-    goto/16 :goto_3
+    goto/16 :goto_2
 
     :cond_0
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isPattern()Z
@@ -12145,7 +11376,7 @@
 
     if-eqz v0, :cond_1
 
-    goto/16 :goto_3
+    goto/16 :goto_2
 
     :cond_1
     const-string/jumbo v0, "lockscreen.passwordhistory"
@@ -12163,46 +11394,26 @@
     move-object v2, v3
 
     :cond_2
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
+    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
-    invoke-virtual {v4, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
-
-    move-result v4
+    invoke-virtual {v4}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
 
-    if-eqz v4, :cond_3
+    move-result-object v4
 
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
+    invoke-virtual {v4, v1, p2}, Landroid/app/admin/DevicePolicyManager;->getPasswordHistoryLength(Landroid/content/ComponentName;I)I
 
-    invoke-virtual {v4, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
+    move-result v1
 
-    move-result v4
+    if-nez v1, :cond_3
 
-    goto :goto_0
+    goto :goto_1
 
     :cond_3
-    move v4, p2
+    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    :goto_0
-    iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
+    move-result-object v3
 
-    invoke-virtual {v5}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
-
-    move-result-object v5
-
-    invoke-virtual {v5, v1, v4}, Landroid/app/admin/DevicePolicyManager;->getPasswordHistoryLength(Landroid/content/ComponentName;I)I
-
-    move-result v1
-
-    if-nez v1, :cond_4
-
-    goto :goto_2
-
-    :cond_4
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v3
-
-    filled-new-array {v3}, [Ljava/lang/Object;
+    filled-new-array {v3}, [Ljava/lang/Object;
 
     move-result-object v3
 
@@ -12226,7 +11437,7 @@
 
     cmp-long v6, v8, v6
 
-    if-nez v6, :cond_5
+    if-nez v6, :cond_4
 
     sget-object v6, Lcom/android/server/locksettings/SecureRandomUtils;->RNG:Ljava/security/SecureRandom;
 
@@ -12236,7 +11447,7 @@
 
     invoke-virtual {p0, v5, v8, v9, p2}, Lcom/android/server/locksettings/LockSettingsService;->setLong(Ljava/lang/String;JI)V
 
-    :cond_5
+    :cond_4
     invoke-static {v8, v9}, Ljava/lang/Long;->toHexString(J)Ljava/lang/String;
 
     move-result-object v5
@@ -12249,24 +11460,24 @@
 
     move-result-object v3
 
-    if-nez v3, :cond_6
+    if-nez v3, :cond_5
 
     const-string v0, "Failed to compute password hash; password history won\'t be updated"
 
     invoke-static {v4, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_3
+    goto :goto_2
 
-    :cond_6
+    :cond_5
     invoke-static {v2}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
 
     move-result v4
 
-    if-eqz v4, :cond_7
+    if-eqz v4, :cond_6
 
-    goto :goto_2
+    goto :goto_1
 
-    :cond_7
+    :cond_6
     const-string v4, ","
 
     invoke-virtual {v2, v4}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;
@@ -12281,14 +11492,14 @@
 
     const/4 v3, 0x0
 
-    :goto_1
+    :goto_0
     add-int/lit8 v4, v1, -0x1
 
-    if-ge v3, v4, :cond_8
+    if-ge v3, v4, :cond_7
 
     array-length v4, v2
 
-    if-ge v3, v4, :cond_8
+    if-ge v3, v4, :cond_7
 
     aget-object v4, v2, v3
 
@@ -12296,17 +11507,17 @@
 
     add-int/lit8 v3, v3, 0x1
 
-    goto :goto_1
+    goto :goto_0
 
-    :cond_8
+    :cond_7
     invoke-virtual {v5}, Ljava/util/StringJoiner;->toString()Ljava/lang/String;
 
     move-result-object v3
 
-    :goto_2
+    :goto_1
     invoke-virtual {p0, v0, v3, p2}, Lcom/android/server/locksettings/LockSettingsService;->setString(Ljava/lang/String;Ljava/lang/String;I)V
 
-    :goto_3
+    :goto_2
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
     const-class v1, Landroid/app/trust/TrustManager;
@@ -12331,11 +11542,11 @@
 
     move-result v0
 
-    if-eq p2, v0, :cond_9
+    if-eq p2, v0, :cond_8
 
-    goto :goto_4
+    goto :goto_3
 
-    :cond_9
+    :cond_8
     new-instance v0, Landroid/content/Intent;
 
     const-string/jumbo v1, "android.intent.action.MAIN_USER_LOCKSCREEN_KNOWLEDGE_FACTOR_CHANGED"
@@ -12350,7 +11561,7 @@
 
     invoke-virtual {p0, v0, v1, v2}, Lcom/android/server/locksettings/LockSettingsService;->sendBroadcast(Landroid/content/Intent;Landroid/os/UserHandle;Ljava/lang/String;)V
 
-    :goto_4
+    :goto_3
     invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->updateVerifier(Lcom/android/internal/widget/LockscreenCredential;I)V
 
     return-void
@@ -13411,24 +12622,22 @@
 .end method
 
 .method public final removeEscrowToken(JI)Z
-    .locals 6
-
-    const-string v0, "Clearing activated reset pwd token for DualDAR user: "
+    .locals 5
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    monitor-enter v1
+    monitor-enter v0
 
     :try_start_0
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
-    move-result-wide v2
+    move-result-wide v1
 
-    cmp-long v2, p1, v2
+    cmp-long v1, p1, v1
 
-    const/4 v3, 0x0
+    const/4 v2, 0x0
 
-    if-nez v2, :cond_0
+    if-nez v1, :cond_0
 
     const-string/jumbo p0, "LockSettingsService"
 
@@ -13436,9 +12645,9 @@
 
     invoke-static {p0, p1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    monitor-exit v1
+    monitor-exit v0
 
-    return v3
+    return v2
 
     :catchall_0
     move-exception p0
@@ -13446,120 +12655,85 @@
     goto :goto_1
 
     :cond_0
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    iget-object v4, v2, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
+    iget-object v3, v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
 
     invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v5
+    move-result-object v4
 
-    invoke-virtual {v4, v5}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z
+    invoke-virtual {v3, v4}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z
 
-    move-result v4
+    move-result v3
 
-    const/4 v5, 0x1
+    const/4 v4, 0x1
 
-    if-nez v4, :cond_2
+    if-nez v3, :cond_2
 
     :cond_1
-    move v2, v3
+    move v1, v2
 
     goto :goto_0
 
     :cond_2
-    iget-object v2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
+    iget-object v1, v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
 
     invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v4
+    move-result-object v3
 
-    invoke-virtual {v2, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {v1, v3}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
 
-    move-result-object v2
+    move-result-object v1
 
-    check-cast v2, Landroid/util/ArrayMap;
+    check-cast v1, Landroid/util/ArrayMap;
 
     invoke-static {p1, p2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    move-result-object v4
+    move-result-object v3
 
-    invoke-virtual {v2, v4}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {v1, v3}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
 
-    move-result-object v2
+    move-result-object v1
 
-    if-eqz v2, :cond_1
+    if-eqz v1, :cond_1
 
-    move v2, v5
+    move v1, v4
 
     :goto_0
-    if-eqz v2, :cond_3
+    if-eqz v1, :cond_3
 
-    monitor-exit v1
+    monitor-exit v0
 
-    return v5
+    return v4
 
     :cond_3
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    const-string/jumbo v4, "spblob"
-
-    invoke-virtual {v2, p3, v4, p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasState(ILjava/lang/String;J)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_5
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v2, p3, p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyTokenBasedProtector(IJ)V
-
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_4
-
-    const-string/jumbo v2, "LockSettingsService"
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v3, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-static {v2, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+    const-string/jumbo v3, "spblob"
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    invoke-virtual {v1, p3, v3, p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasState(ILjava/lang/String;J)Z
 
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
+    move-result v1
 
-    move-result-object v0
+    if-eqz v1, :cond_4
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {p0, p3}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
+    invoke-virtual {p0, p3, p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyTokenBasedProtector(IJ)V
 
-    move-result p0
+    monitor-exit v0
 
-    invoke-virtual {v0, p0, p1, p2}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->clearResetPasswordToken(IJ)V
+    return v4
 
     :cond_4
-    monitor-exit v1
-
-    return v5
-
-    :cond_5
-    monitor-exit v1
+    monitor-exit v0
 
-    return v3
+    return v2
 
     :goto_1
-    monitor-exit v1
+    monitor-exit v0
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
@@ -13654,15 +12828,6 @@
 
     const-string/jumbo v0, "LockSettingsService"
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    goto :goto_2
-
-    :cond_0
     const-string/jumbo v1, "profile_key_name_encrypt_"
 
     invoke-static {p1, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
@@ -13682,7 +12847,7 @@
 
     move-result v3
 
-    if-nez v3, :cond_1
+    if-nez v3, :cond_0
 
     iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mKeyStore:Ljava/security/KeyStore;
 
@@ -13690,7 +12855,7 @@
 
     move-result v3
 
-    if-eqz v3, :cond_2
+    if-eqz v3, :cond_1
 
     goto :goto_0
 
@@ -13699,7 +12864,7 @@
 
     goto :goto_1
 
-    :cond_1
+    :cond_0
     :goto_0
     const-string/jumbo v3, "Removing keystore profile key for user %d"
 
@@ -13738,8 +12903,7 @@
 
     invoke-static {v0, p0, v1, p1}, Lcom/android/server/utils/Slogf;->e(Ljava/lang/String;Ljava/lang/Throwable;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    :cond_2
-    :goto_2
+    :cond_1
     return-void
 .end method
 
@@ -13806,15 +12970,15 @@
 .end method
 
 .method public final removeUserState(I)V
-    .locals 3
+    .locals 8
 
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;
 
     const/4 v2, 0x0
 
-    invoke-direct {v1, p1, v2, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;-><init>(IILjava/lang/Object;)V
+    invoke-direct {v1, p1, v2, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;-><init>(IILjava/lang/Object;)V
 
     invoke-virtual {v0, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
@@ -13824,17 +12988,76 @@
 
     move-result-object v1
 
-    invoke-virtual {v0, v1, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->removeUser(Landroid/service/gatekeeper/IGateKeeperService;I)V
+    iget-object v2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+
+    const-string/jumbo v3, "spblob"
+
+    invoke-virtual {v2, p1, v3}, Lcom/android/server/locksettings/LockSettingsStorage;->listSyntheticPasswordProtectorsForUser(ILjava/lang/String;)Ljava/util/List;
+
+    move-result-object v2
+
+    check-cast v2, Ljava/util/ArrayList;
+
+    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I
+
+    move-result v3
+
+    const/4 v4, 0x0
+
+    move v5, v4
+
+    :goto_0
+    if-ge v5, v3, :cond_0
+
+    invoke-virtual {v2, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+
+    move-result-object v6
+
+    add-int/lit8 v5, v5, 0x1
+
+    check-cast v6, Ljava/lang/Long;
+
+    invoke-virtual {v6}, Ljava/lang/Long;->longValue()J
+
+    move-result-wide v6
+
+    invoke-virtual {v0, p1, v6, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyWeaverSlot(IJ)V
+
+    invoke-static {v6, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getProtectorKeyAlias(J)Ljava/lang/String;
+
+    move-result-object v6
+
+    invoke-virtual {v0, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyProtectorKey(Ljava/lang/String;)V
+
+    goto :goto_0
+
+    :cond_0
+    :try_start_0
+    invoke-static {p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
+
+    move-result v0
+
+    invoke-interface {v1, v0}, Landroid/service/gatekeeper/IGateKeeperService;->clearSecureUserId(I)V
+    :try_end_0
+    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
+
+    goto :goto_1
+
+    :catch_0
+    const-string/jumbo v0, "SyntheticPasswordManager"
+
+    const-string v1, "Failed to clear SID from gatekeeper"
 
+    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
+
+    :goto_1
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStrongAuth:Lcom/android/server/locksettings/LockSettingsStrongAuth;
 
     iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mHandler:Landroid/os/Handler;
 
     const/4 v1, 0x4
 
-    const/4 v2, 0x0
-
-    invoke-virtual {v0, v1, p1, v2}, Landroid/os/Handler;->obtainMessage(III)Landroid/os/Message;
+    invoke-virtual {v0, v1, p1, v4}, Landroid/os/Handler;->obtainMessage(III)Landroid/os/Message;
 
     move-result-object v0
 
@@ -13846,8 +13069,27 @@
 
     invoke-virtual {v0, p1}, Lcom/android/server/locksettings/UnifiedProfilePasswordCache;->removePassword(I)V
 
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->gateKeeperClearSecureUserId(I)V
+    :try_start_1
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+
+    move-result-object v0
+
+    invoke-interface {v0, p1}, Landroid/service/gatekeeper/IGateKeeperService;->clearSecureUserId(I)V
+    :try_end_1
+    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1
+
+    goto :goto_2
+
+    :catch_1
+    move-exception v0
+
+    const-string/jumbo v1, "LockSettingsService"
+
+    const-string v2, "Failed to clear SID"
 
+    invoke-static {v1, v2, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    :goto_2
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->removeKeystoreProfileKey(I)V
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
@@ -14394,15 +13636,6 @@
 .method public final resetKeyStore(I)V
     .locals 13
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto/16 :goto_4
-
-    :cond_0
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->checkWritePermission()V
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
@@ -14437,13 +13670,13 @@
 
     move-result-object v3
 
-    :cond_1
+    :cond_0
     :goto_0
     invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z
 
     move-result v4
 
-    if-eqz v4, :cond_2
+    if-eqz v4, :cond_1
 
     invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -14457,7 +13690,7 @@
 
     move-result v5
 
-    if-eqz v5, :cond_1
+    if-eqz v5, :cond_0
 
     iget v5, v4, Landroid/content/pm/UserInfo;->id:I
 
@@ -14465,7 +13698,7 @@
 
     move-result v5
 
-    if-nez v5, :cond_1
+    if-nez v5, :cond_0
 
     iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
@@ -14479,7 +13712,7 @@
 
     move-result v5
 
-    if-eqz v5, :cond_1
+    if-eqz v5, :cond_0
 
     :try_start_0
     iget v5, v4, Landroid/content/pm/UserInfo;->id:I
@@ -14520,7 +13753,7 @@
 
     goto :goto_0
 
-    :cond_2
+    :cond_1
     const/4 v2, -0x1
 
     const/4 v3, 0x0
@@ -14537,7 +13770,7 @@
     move v6, v3
 
     :goto_1
-    if-ge v6, v5, :cond_4
+    if-ge v6, v5, :cond_3
 
     aget v7, v4, v6
 
@@ -14548,7 +13781,7 @@
     move v10, v3
 
     :goto_2
-    if-ge v10, v9, :cond_3
+    if-ge v10, v9, :cond_2
 
     aget v11, v8, v10
 
@@ -14567,14 +13800,14 @@
     :catchall_0
     move-exception v4
 
-    goto :goto_5
+    goto :goto_4
 
-    :cond_3
+    :cond_2
     add-int/lit8 v6, v6, 0x1
 
     goto :goto_1
 
-    :cond_4
+    :cond_3
     iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
     invoke-virtual {v4, p1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
@@ -14585,7 +13818,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_5
+    if-eqz v4, :cond_4
 
     const/4 v4, 0x2
 
@@ -14595,13 +13828,13 @@
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :cond_5
+    :cond_4
     :goto_3
     invoke-virtual {v0}, Ljava/util/ArrayList;->size()I
 
     move-result v4
 
-    if-ge v3, v4, :cond_8
+    if-ge v3, v4, :cond_7
 
     invoke-virtual {v0, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
@@ -14619,32 +13852,31 @@
 
     check-cast v5, Lcom/android/internal/widget/LockscreenCredential;
 
-    if-eq v4, v2, :cond_6
+    if-eq v4, v2, :cond_5
 
-    if-eqz v5, :cond_6
+    if-eqz v5, :cond_5
 
     invoke-virtual {p0, v4, p1, v5}, Lcom/android/server/locksettings/LockSettingsService;->tieProfileLockToParent(IILcom/android/internal/widget/LockscreenCredential;)V
 
-    :cond_6
-    if-eqz v5, :cond_7
+    :cond_5
+    if-eqz v5, :cond_6
 
     invoke-virtual {v5}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
 
-    :cond_7
+    :cond_6
     add-int/lit8 v3, v3, 0x1
 
     goto :goto_3
 
-    :cond_8
-    :goto_4
+    :cond_7
     return-void
 
-    :goto_5
+    :goto_4
     invoke-virtual {v0}, Ljava/util/ArrayList;->size()I
 
     move-result v5
 
-    if-ge v3, v5, :cond_b
+    if-ge v3, v5, :cond_a
 
     invoke-virtual {v0, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
@@ -14662,23 +13894,23 @@
 
     check-cast v6, Lcom/android/internal/widget/LockscreenCredential;
 
-    if-eq v5, v2, :cond_9
+    if-eq v5, v2, :cond_8
 
-    if-eqz v6, :cond_9
+    if-eqz v6, :cond_8
 
     invoke-virtual {p0, v5, p1, v6}, Lcom/android/server/locksettings/LockSettingsService;->tieProfileLockToParent(IILcom/android/internal/widget/LockscreenCredential;)V
 
-    :cond_9
-    if-eqz v6, :cond_a
+    :cond_8
+    if-eqz v6, :cond_9
 
     invoke-virtual {v6}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
 
-    :cond_a
+    :cond_9
     add-int/lit8 v3, v3, 0x1
 
-    goto :goto_5
+    goto :goto_4
 
-    :cond_b
+    :cond_a
     throw v4
 .end method
 
@@ -14949,7 +14181,7 @@
 
     move/from16 v0, p2
 
-    invoke-static {v0}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    invoke-static {v0}, Lcom/android/internal/widget/LockPatternUtils;->isSpecialUserId(I)Z
 
     move-result v2
 
@@ -14958,7 +14190,7 @@
     goto/16 :goto_4
 
     :cond_0
-    invoke-static {v0}, Lcom/android/internal/widget/LockPatternUtils;->isSpecialUserId(I)Z
+    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v2
 
@@ -14967,24 +14199,15 @@
     goto/16 :goto_4
 
     :cond_1
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_2
-
-    goto/16 :goto_4
-
-    :cond_2
     invoke-virtual {v1, v0}, Lcom/android/server/locksettings/LockSettingsService;->isProfileWithUnifiedLock(I)Z
 
     move-result v2
 
-    if-eqz v2, :cond_3
+    if-eqz v2, :cond_2
 
     goto :goto_4
 
-    :cond_3
+    :cond_2
     invoke-virtual {v1, v0}, Lcom/android/server/locksettings/LockSettingsService;->getProfilesWithSameLockScreen(I)Ljava/util/Set;
 
     move-result-object v0
@@ -15000,7 +14223,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_3
 
     invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -15105,7 +14328,7 @@
 
     goto :goto_0
 
-    :cond_4
+    :cond_3
     :goto_4
     return-void
 .end method
@@ -15474,19 +14697,10 @@
 .end method
 
 .method public final setCeStorageProtection(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-    .locals 6
+    .locals 4
 
     const-string v0, "Failed to protect CE key for user "
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    return-void
-
-    :cond_0
     sget-object v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_FBE_KEY:[B
 
     invoke-virtual {p2, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
@@ -15498,106 +14712,26 @@
     move-result-wide v1
 
     :try_start_0
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v3, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorageManager:Landroid/os/storage/IStorageManager;
 
-    move-result v3
+    invoke-interface {p0, p1, p2}, Landroid/os/storage/IStorageManager;->setCeStorageProtection(I[B)V
     :try_end_0
     .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    const-string/jumbo v4, "LockSettingsService"
-
-    const/4 v5, 0x0
-
-    if-eqz v3, :cond_2
-
-    :try_start_1
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_1
-
-    const-string v3, "Do not substitute outer-layer-key in case of DualDAR on DO!"
-
-    invoke-static {v4, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_0
-
-    :cond_1
-    const-string/jumbo v3, "need to get secret for DualDAR user"
-
-    invoke-static {v4, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 v5, 0x1
-
-    :cond_2
-    :goto_0
-    if-eqz v5, :cond_3
-
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v3, "getChangedStorageSecretIfDualDAR"
-
-    invoke-static {v4, v3}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo v3, "fetchOuterLayerKey()"
-
-    invoke-static {v4, v3}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p2, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {p2}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p2
-
-    invoke-virtual {p2, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->fetchOuterLayerKey(I)[B
-
-    move-result-object p2
-
-    const-string/jumbo v3, "fetchOuterLayerKey Finished"
-
-    invoke-static {v4, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorageManager:Landroid/os/storage/IStorageManager;
-
-    invoke-interface {p0, p1, p2}, Landroid/os/storage/IStorageManager;->setCeStorageProtection(I[B)V
+    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    goto :goto_1
+    return-void
 
     :catchall_0
     move-exception p0
 
-    goto :goto_3
+    goto :goto_0
 
     :catch_0
     move-exception p0
 
-    goto :goto_2
-
-    :cond_3
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorageManager:Landroid/os/storage/IStorageManager;
-
-    invoke-interface {p0, p1, p2}, Landroid/os/storage/IStorageManager;->setCeStorageProtection(I[B)V
-    :try_end_1
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :goto_1
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :goto_2
-    :try_start_2
+    :try_start_1
     new-instance p2, Ljava/lang/IllegalStateException;
 
     new-instance v3, Ljava/lang/StringBuilder;
@@ -15613,10 +14747,10 @@
     invoke-direct {p2, p1, p0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V
 
     throw p2
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :goto_3
+    :goto_0
     invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw p0
@@ -15768,19 +14902,17 @@
 .end method
 
 .method public final setLockCredentialInternal(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
-    .locals 17
+    .locals 16
 
     move-object/from16 v1, p0
 
-    move/from16 v8, p4
-
     invoke-static/range {p1 .. p1}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;
 
     invoke-static/range {p2 .. p2}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;
 
     const/16 v0, -0x26ab
 
-    const/4 v9, 0x1
+    const/4 v8, 0x1
 
     const/4 v2, 0x0
 
@@ -15794,397 +14926,74 @@
 
     invoke-static {v0, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    move v15, v2
+    move v14, v2
 
-    move v3, v9
+    move v3, v8
 
     goto :goto_0
 
     :cond_0
-    move v15, v3
+    move v14, v3
 
     move v3, v2
 
     :goto_0
     invoke-static {}, Lcom/samsung/android/lock/SPBnRManager;->resetMode()V
 
-    invoke-static {v15}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    const/4 v4, 0x0
-
-    if-eqz v0, :cond_4
-
-    const-string/jumbo v0, "Set credential for user virtual "
-
-    const-string v5, " credentialType:"
-
-    invoke-static {v15, v0, v5}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    move-result-object v0
-
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v5
-
-    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    invoke-virtual/range {p2 .. p2}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    invoke-virtual/range {p2 .. p2}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    iget-object v4, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v5
-
-    if-eqz v5, :cond_2
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string v2, "Clear virtual lock for user "
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, v15}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v0, v15}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
-
-    move-result-wide v1
-
-    const-wide/16 v5, 0x0
-
-    cmp-long v3, v1, v5
-
-    if-eqz v3, :cond_1
-
-    invoke-static {v1, v2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v1
-
-    invoke-static {v15}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v2
-
-    filled-new-array {v1, v2}, [Ljava/lang/Object;
-
-    move-result-object v1
-
-    const-string v2, "Handle(%d) detected at the moment of clearing lock for user %d"
-
-    invoke-static {v2, v1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v4, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_1
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    const-string/jumbo v2, "handle"
-
-    invoke-virtual {v1, v15, v2, v5, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyState(ILjava/lang/String;J)V
-
-    invoke-static {v15, v5, v6, v2}, Lcom/samsung/android/lock/SPBnRManager;->deleteBackup(IJLjava/lang/String;)Z
-
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v2
-
-    invoke-virtual {v1, v2, v15}, Lcom/android/server/locksettings/SyntheticPasswordManager;->removeUser(Landroid/service/gatekeeper/IGateKeeperService;I)V
-
-    invoke-virtual {v0, v15}, Lcom/android/server/locksettings/LockSettingsService;->gateKeeperClearSecureUserId(I)V
-
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
-
-    invoke-virtual {v0, v15}, Lcom/android/server/locksettings/LockSettingsStorage;->removeUser(I)V
-
-    const-string/jumbo v0, "credential is NONE"
-
-    new-instance v1, Ljava/lang/Throwable;
-
-    invoke-direct {v1}, Ljava/lang/Throwable;-><init>()V
-
-    const-string/jumbo v2, "LockSettingsService.DarVirtualLock"
-
-    invoke-static {v2, v0, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    return v9
-
-    :cond_2
-    iget-object v5, v0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v5, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v5, v5, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v5
+    monitor-enter v4
 
     :try_start_0
-    iget-object v6, v0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v6, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v6, v15}, Lcom/android/server/locksettings/LockSettingsService;->isSyntheticPasswordBasedCredentialLocked(I)Z
-
-    move-result v6
-
-    if-nez v6, :cond_3
-
-    invoke-static {v15}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->prepare(I)V
-
-    invoke-virtual {v0, v15}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->initializeSyntheticPasswordForVirtualUser(I)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception v0
-
-    goto :goto_2
-
-    :cond_3
-    :goto_1
-    monitor-exit v5
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    const-string/jumbo v0, "progressing to set credential for virtual user"
-
-    new-instance v5, Ljava/lang/Throwable;
-
-    invoke-direct {v5}, Ljava/lang/Throwable;-><init>()V
-
-    const-string/jumbo v6, "LockSettingsService.DarVirtualLock"
-
-    invoke-static {v6, v0, v5}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    goto :goto_3
-
-    :goto_2
-    :try_start_1
-    monitor-exit v5
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw v0
-
-    :cond_4
-    :goto_3
-    invoke-virtual {v1, v15}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_8
-
-    const-string/jumbo v0, "Set credential for user enterprise "
-
-    const-string v5, " credentialType:"
-
-    invoke-static {v15, v0, v5}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    move-result-object v0
-
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v5
-
-    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    invoke-virtual/range {p2 .. p2}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    invoke-virtual/range {p2 .. p2}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v5
-
-    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v5
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v6
-
-    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v6
-
-    filled-new-array {v5, v6}, [Ljava/lang/Object;
-
-    move-result-object v5
-
-    const-string v6, "Check accessor - UID : %d, PID : %d"
-
-    invoke-static {v6, v5}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v4, v5}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    const-string v5, "Empty"
-
-    const-string v6, "Hidden"
-
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v7
-
-    if-eqz v7, :cond_5
-
-    move-object v7, v5
-
-    goto :goto_4
-
-    :cond_5
-    move-object v7, v6
-
-    :goto_4
     invoke-virtual/range {p2 .. p2}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    move-result v10
-
-    if-eqz v10, :cond_6
-
-    goto :goto_5
-
-    :cond_6
-    move-object v5, v6
-
-    :goto_5
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v0, v15}, Lcom/android/server/locksettings/LockSettingsService;->isProfileWithUnifiedLock(I)Z
-
     move-result v0
 
-    if-eqz v0, :cond_7
-
-    const-string/jumbo v0, "Yes"
-
-    goto :goto_6
-
-    :cond_7
-    const-string/jumbo v0, "No"
-
-    :goto_6
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v6
-
-    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v6
-
-    invoke-static {v15}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v10
-
-    filled-new-array {v7, v5, v0, v6, v10}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    const-string v5, "Check requisites - Given : %s, Saved : %s, Unified : %s, Type : %d, User : %d"
-
-    invoke-static {v5, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v4, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_8
-    iget-object v5, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v5
-
-    :try_start_2
-    invoke-virtual/range {p2 .. p2}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v0
+    const/4 v5, 0x0
 
-    if-eqz v0, :cond_9
+    if-eqz v0, :cond_1
 
-    invoke-virtual {v1, v15}, Lcom/android/server/locksettings/LockSettingsService;->isProfileWithUnifiedLock(I)Z
+    invoke-virtual {v1, v14}, Lcom/android/server/locksettings/LockSettingsService;->isProfileWithUnifiedLock(I)Z
 
     move-result v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    if-eqz v0, :cond_9
+    if-eqz v0, :cond_1
 
-    :try_start_3
-    invoke-virtual {v1, v15}, Lcom/android/server/locksettings/LockSettingsService;->getDecryptedPasswordForTiedProfile(I)Lcom/android/internal/widget/LockscreenCredential;
+    :try_start_1
+    invoke-virtual {v1, v14}, Lcom/android/server/locksettings/LockSettingsService;->getDecryptedPasswordForTiedProfile(I)Lcom/android/internal/widget/LockscreenCredential;
 
     move-result-object v0
-    :try_end_3
-    .catch Ljava/io/FileNotFoundException; {:try_start_3 .. :try_end_3} :catch_1
-    .catch Ljava/security/UnrecoverableKeyException; {:try_start_3 .. :try_end_3} :catch_0
-    .catch Ljava/security/InvalidKeyException; {:try_start_3 .. :try_end_3} :catch_0
-    .catch Ljava/security/KeyStoreException; {:try_start_3 .. :try_end_3} :catch_0
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_3 .. :try_end_3} :catch_0
-    .catch Ljavax/crypto/NoSuchPaddingException; {:try_start_3 .. :try_end_3} :catch_0
-    .catch Ljava/security/InvalidAlgorithmParameterException; {:try_start_3 .. :try_end_3} :catch_0
-    .catch Ljavax/crypto/IllegalBlockSizeException; {:try_start_3 .. :try_end_3} :catch_0
-    .catch Ljavax/crypto/BadPaddingException; {:try_start_3 .. :try_end_3} :catch_0
-    .catch Ljava/security/cert/CertificateException; {:try_start_3 .. :try_end_3} :catch_0
-    .catch Ljava/io/IOException; {:try_start_3 .. :try_end_3} :catch_0
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    :try_end_1
+    .catch Ljava/io/FileNotFoundException; {:try_start_1 .. :try_end_1} :catch_1
+    .catch Ljava/security/UnrecoverableKeyException; {:try_start_1 .. :try_end_1} :catch_0
+    .catch Ljava/security/InvalidKeyException; {:try_start_1 .. :try_end_1} :catch_0
+    .catch Ljava/security/KeyStoreException; {:try_start_1 .. :try_end_1} :catch_0
+    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_1 .. :try_end_1} :catch_0
+    .catch Ljavax/crypto/NoSuchPaddingException; {:try_start_1 .. :try_end_1} :catch_0
+    .catch Ljava/security/InvalidAlgorithmParameterException; {:try_start_1 .. :try_end_1} :catch_0
+    .catch Ljavax/crypto/IllegalBlockSizeException; {:try_start_1 .. :try_end_1} :catch_0
+    .catch Ljavax/crypto/BadPaddingException; {:try_start_1 .. :try_end_1} :catch_0
+    .catch Ljava/security/cert/CertificateException; {:try_start_1 .. :try_end_1} :catch_0
+    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    move-object v14, v0
+    move-object v13, v0
 
-    goto :goto_8
+    goto :goto_2
 
-    :catchall_1
+    :catchall_0
     move-exception v0
 
-    move-object v10, v5
+    move-object v9, v4
 
-    goto/16 :goto_e
+    goto/16 :goto_8
 
     :catch_0
     move-exception v0
 
-    :try_start_4
+    :try_start_2
     const-string/jumbo v6, "LockSettingsService"
 
     const-string v7, "Failed to decrypt child profile key"
@@ -16193,9 +15002,9 @@
 
     const-string v6, "Failed to decrypt child profile key"
 
-    invoke-static {v0, v4, v6}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v0, v5, v6}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
 
-    goto :goto_7
+    goto :goto_1
 
     :catch_1
     move-exception v0
@@ -16208,68 +15017,68 @@
 
     const-string v6, "Child profile key not found"
 
-    invoke-static {v0, v4, v6}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v0, v5, v6}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
 
-    :cond_9
-    :goto_7
-    move-object/from16 v14, p2
+    :cond_1
+    :goto_1
+    move-object/from16 v13, p2
 
-    :goto_8
+    :goto_2
     invoke-static {}, Lcom/android/server/locksettings/LockSettingsService;->isEnablePrevCredential()Z
 
     move-result v0
 
-    if-eqz v0, :cond_a
+    if-eqz v0, :cond_2
 
-    if-eqz v3, :cond_a
+    if-eqz v3, :cond_2
 
-    invoke-virtual {v1, v15}, Lcom/android/server/locksettings/LockSettingsService;->getBackupLskfBasedProtectorId(I)J
+    invoke-virtual {v1, v14}, Lcom/android/server/locksettings/LockSettingsService;->getBackupLskfBasedProtectorId(I)J
 
-    move-result-wide v12
+    move-result-wide v11
 
-    iget-object v10, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v9, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    move-result-object v11
+    move-result-object v10
 
-    const/16 v16, 0x0
+    const/4 v15, 0x0
 
-    invoke-virtual/range {v10 .. v16}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    invoke-virtual/range {v9 .. v15}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
     move-result-object v0
 
-    goto :goto_9
+    goto :goto_3
 
-    :cond_a
-    invoke-virtual {v1, v15}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
+    :cond_2
+    invoke-virtual {v1, v14}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
-    move-result-wide v12
+    move-result-wide v11
 
-    iget-object v10, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v9, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    move-result-object v11
+    move-result-object v10
 
-    const/16 v16, 0x0
+    const/4 v15, 0x0
 
-    invoke-virtual/range {v10 .. v16}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    invoke-virtual/range {v9 .. v15}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
     move-result-object v0
 
-    :goto_9
+    :goto_3
     iget-object v6, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
     iget-object v0, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    if-nez v0, :cond_e
+    if-nez v0, :cond_6
 
     const-string/jumbo v0, "Untrusted credential reset not acceptable"
 
-    invoke-static {v4, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v5, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    if-eqz v6, :cond_d
+    if-eqz v6, :cond_5
 
     invoke-virtual {v6}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
@@ -16277,16 +15086,16 @@
 
     const/4 v1, -0x1
 
-    if-ne v0, v1, :cond_b
+    if-ne v0, v1, :cond_3
 
-    goto :goto_a
+    goto :goto_4
 
-    :cond_b
+    :cond_3
     invoke-virtual {v6}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
     move-result v0
 
-    if-ne v0, v9, :cond_c
+    if-ne v0, v8, :cond_4
 
     const-string/jumbo v0, "LockSettingsService"
 
@@ -16296,16 +15105,16 @@
 
     const-string v0, "Failed to enroll: rate limit exceeded."
 
-    invoke-static {v0, v9}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;Z)V
+    invoke-static {v0, v8}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;Z)V
 
-    monitor-exit v5
+    monitor-exit v4
 
-    goto :goto_b
+    goto :goto_5
 
-    :cond_c
+    :cond_4
     const-string/jumbo v0, "credential change failed. sp is null"
 
-    invoke-static {v0, v9}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;Z)V
+    invoke-static {v0, v8}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;Z)V
 
     new-instance v0, Ljava/lang/IllegalStateException;
 
@@ -16315,8 +15124,8 @@
 
     throw v0
 
-    :cond_d
-    :goto_a
+    :cond_5
+    :goto_4
     const-string/jumbo v0, "LockSettingsService"
 
     const-string v1, "Failed to enroll: incorrect credential."
@@ -16325,87 +15134,90 @@
 
     const-string v0, "Failed to enroll: incorrect credential."
 
-    invoke-static {v0, v9}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;Z)V
+    invoke-static {v0, v8}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;Z)V
 
-    monitor-exit v5
+    monitor-exit v4
 
-    :goto_b
+    :goto_5
     return v2
 
-    :cond_e
+    :cond_6
     invoke-static {}, Lcom/android/server/locksettings/LockSettingsService;->isEnablePrevCredential()Z
 
-    move-result v4
+    move-result v5
 
-    if-eqz v4, :cond_f
+    if-eqz v5, :cond_7
 
-    if-nez v3, :cond_f
+    if-nez v3, :cond_7
 
-    if-nez v15, :cond_f
+    if-nez v14, :cond_7
 
     invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService;->expirePreviousData()V
 
-    :cond_f
-    invoke-virtual {v1, v15, v0, v2}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordKnown(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Z)V
+    :cond_7
+    invoke-virtual {v1, v14, v0, v2}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordKnown(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Z)V
 
     invoke-static {}, Lcom/android/server/locksettings/LockSettingsService;->isEnablePrevCredential()Z
 
     move-result v2
 
-    if-eqz v2, :cond_10
+    if-eqz v2, :cond_8
 
     invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService;->isSupportWeaver()Z
 
     move-result v2
 
-    if-nez v2, :cond_10
+    if-nez v2, :cond_8
 
-    if-nez v15, :cond_10
+    if-nez v14, :cond_8
 
-    invoke-virtual {v14}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    invoke-virtual {v13}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v2
 
-    if-nez v2, :cond_10
+    if-nez v2, :cond_8
 
     invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v2
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    if-nez v2, :cond_10
+    if-nez v2, :cond_8
 
     move-object/from16 v2, p1
 
     move-object v6, v0
 
-    move-object v10, v5
+    move-object v9, v4
 
-    move-wide v4, v12
+    move-wide v4, v11
 
-    move-object v3, v14
+    move-object v3, v13
 
-    move v7, v15
+    move v7, v14
 
-    :try_start_5
+    :try_start_3
     invoke-virtual/range {v1 .. v7}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithSpLocked(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
 
     move-object/from16 v1, p0
 
+    :goto_6
     move-object/from16 v2, p1
 
-    goto :goto_c
+    move/from16 v3, p4
 
-    :catchall_2
+    goto :goto_7
+
+    :catchall_1
     move-exception v0
 
-    goto :goto_e
+    goto :goto_8
 
-    :cond_10
+    :cond_8
     move-object v6, v0
 
-    move-object v10, v5
+    move-object v9, v4
 
     const/4 v3, 0x0
 
@@ -16415,75 +15227,47 @@
 
     move-object/from16 v2, p1
 
-    move v7, v15
+    move v7, v14
 
     invoke-virtual/range {v1 .. v7}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithSpLocked(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
 
-    :goto_c
-    invoke-virtual {v1, v15, v8, v2}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnChangeIfRequired(IZLcom/android/internal/widget/LockscreenCredential;)V
-
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
-
-    invoke-virtual {v0, v15}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->saveEscrowDataIfNeededLocked(I)V
-
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->isDualDAREnabled()Z
-
-    move-result v0
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_2
-
-    if-eqz v0, :cond_11
-
-    :try_start_6
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v0, v2, v14, v15, v8}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->performDualDARPasswordChange(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)V
-    :try_end_6
-    .catch Landroid/os/RemoteException; {:try_start_6 .. :try_end_6} :catch_2
-    .catchall {:try_start_6 .. :try_end_6} :catchall_2
+    goto :goto_6
 
-    goto :goto_d
+    :goto_7
+    invoke-virtual {v1, v14, v3, v2}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnChangeIfRequired(IZLcom/android/internal/widget/LockscreenCredential;)V
 
-    :catch_2
-    move-exception v0
+    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
 
-    :try_start_7
-    invoke-virtual {v0}, Landroid/os/RemoteException;->printStackTrace()V
+    invoke-virtual {v0, v14}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->saveEscrowDataIfNeededLocked(I)V
 
-    :cond_11
-    :goto_d
-    monitor-exit v10
+    monitor-exit v9
 
-    return v9
+    return v8
 
-    :goto_e
-    monitor-exit v10
-    :try_end_7
-    .catchall {:try_start_7 .. :try_end_7} :catchall_2
+    :goto_8
+    monitor-exit v9
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_1
 
     throw v0
 .end method
 
 .method public final setLockCredentialWithIgnoreNotifyIfNeeded(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
-    .locals 10
+    .locals 9
 
-    iget-boolean v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHasSecureLockScreen:Z
+    iget-boolean p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mHasSecureLockScreen:Z
 
-    if-nez v0, :cond_1
+    if-nez p4, :cond_1
 
     if-eqz p1, :cond_1
 
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
-    move-result v0
+    move-result p4
 
-    const/4 v1, -0x1
+    const/4 v0, -0x1
 
-    if-ne v0, v1, :cond_0
+    if-ne p4, v0, :cond_0
 
     goto :goto_0
 
@@ -16498,35 +15282,35 @@
 
     :cond_1
     :goto_0
-    const-string/jumbo v0, "android.permission.ACCESS_KEYGUARD_SECURE_STORAGE"
+    const-string/jumbo p4, "android.permission.ACCESS_KEYGUARD_SECURE_STORAGE"
 
-    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService;->hasPermission(Ljava/lang/String;)Z
+    invoke-virtual {p0, p4}, Lcom/android/server/locksettings/LockSettingsService;->hasPermission(Ljava/lang/String;)Z
 
-    move-result v0
+    move-result p4
 
-    if-nez v0, :cond_3
+    if-nez p4, :cond_3
 
-    const-string/jumbo v0, "android.permission.SET_AND_VERIFY_LOCKSCREEN_CREDENTIALS"
+    const-string/jumbo p4, "android.permission.SET_AND_VERIFY_LOCKSCREEN_CREDENTIALS"
 
-    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService;->hasPermission(Ljava/lang/String;)Z
+    invoke-virtual {p0, p4}, Lcom/android/server/locksettings/LockSettingsService;->hasPermission(Ljava/lang/String;)Z
 
-    move-result v0
+    move-result p4
 
-    if-nez v0, :cond_3
+    if-nez p4, :cond_3
 
-    const-string/jumbo v0, "android.permission.SET_INITIAL_LOCK"
+    const-string/jumbo p4, "android.permission.SET_INITIAL_LOCK"
 
-    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService;->hasPermission(Ljava/lang/String;)Z
+    invoke-virtual {p0, p4}, Lcom/android/server/locksettings/LockSettingsService;->hasPermission(Ljava/lang/String;)Z
 
-    move-result v0
+    move-result p4
 
-    if-eqz v0, :cond_2
+    if-eqz p4, :cond_2
 
     invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    move-result v0
+    move-result p4
 
-    if-eqz v0, :cond_2
+    if-eqz p4, :cond_2
 
     goto :goto_1
 
@@ -16543,62 +15327,62 @@
     :goto_1
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->validateBasicRequirements()V
 
-    const/4 v0, 0x0
+    const/4 p4, 0x0
 
-    const/16 v1, -0x26ab
+    const/16 v0, -0x26ab
 
-    const/4 v2, 0x1
+    const/4 v1, 0x1
 
-    if-ne p3, v1, :cond_4
+    if-ne p3, v0, :cond_4
 
-    move p3, v0
+    move p3, p4
 
-    move v3, v2
+    move v2, v1
 
     goto :goto_2
 
     :cond_4
-    move v3, v0
+    move v2, p4
 
     :goto_2
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v4
+    move-result-wide v3
 
     :try_start_0
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->enforceFrpNotActive()V
 
-    iget-object v6, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v6}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    invoke-virtual {v5}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
 
-    move-result-object v6
+    move-result-object v5
 
-    const-string/jumbo v7, "n_digits_pin_enabled"
+    const-string/jumbo v6, "n_digits_pin_enabled"
 
-    invoke-static {v6, v7, v0, p3}, Landroid/provider/Settings$Secure;->putIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)Z
+    invoke-static {v5, v6, p4, p3}, Landroid/provider/Settings$Secure;->putIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)Z
 
     invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    move-result v6
+    move-result v5
 
-    if-nez v6, :cond_5
+    if-nez v5, :cond_5
 
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isProfileWithUnifiedLock(I)Z
 
-    move-result v6
+    move-result v5
 
-    if-eqz v6, :cond_5
+    if-eqz v5, :cond_5
 
-    iget-object v6, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
+    iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
-    invoke-virtual {v6, p3}, Landroid/os/UserManager;->getProfileParent(I)Landroid/content/pm/UserInfo;
+    invoke-virtual {v5, p3}, Landroid/os/UserManager;->getProfileParent(I)Landroid/content/pm/UserInfo;
 
-    move-result-object v6
+    move-result-object v5
 
-    iget v6, v6, Landroid/content/pm/UserInfo;->id:I
+    iget v5, v5, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-virtual {p0, p2, v6, v0}, Lcom/android/server/locksettings/LockSettingsService;->verifyCredential(Lcom/android/internal/widget/LockscreenCredential;II)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {p0, p2, v5, p4}, Lcom/android/server/locksettings/LockSettingsService;->verifyCredential(Lcom/android/internal/widget/LockscreenCredential;II)Lcom/android/internal/widget/VerifyCredentialResponse;
 
     invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
 
@@ -16611,217 +15395,191 @@
     :catchall_0
     move-exception p0
 
-    goto/16 :goto_7
+    goto/16 :goto_6
 
     :cond_5
     :goto_3
-    iget-object v6, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
+    iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
-    invoke-virtual {v6, p3}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
+    invoke-virtual {v5, p3}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-virtual {v6}, Landroid/content/pm/UserInfo;->isSdpNotSupportedSecureFolder()Z
+    invoke-virtual {v5}, Landroid/content/pm/UserInfo;->isSdpNotSupportedSecureFolder()Z
 
-    move-result v6
+    move-result v5
 
-    const/4 v7, 0x0
+    const/4 v6, 0x0
 
-    if-eqz v6, :cond_6
+    if-eqz v5, :cond_6
 
-    const-string/jumbo v8, "User %d identified as sdp not-supported secure folder user"
+    const-string/jumbo v7, "User %d identified as sdp not-supported secure folder user"
 
     invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v9
-
-    filled-new-array {v9}, [Ljava/lang/Object;
-
-    move-result-object v9
-
-    invoke-static {v8, v9}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
     move-result-object v8
 
-    invoke-static {v7, v8}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_6
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v8
-
-    if-eqz v8, :cond_7
+    filled-new-array {v8}, [Ljava/lang/Object;
 
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/StreamCipher;->decryptStream(Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/LockscreenCredential;
+    move-result-object v8
 
-    move-result-object p1
+    invoke-static {v7, v8}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    invoke-static {p2}, Lcom/samsung/android/knox/dar/StreamCipher;->decryptStream(Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/LockscreenCredential;
+    move-result-object v7
 
-    move-result-object p2
+    invoke-static {v6, v7}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    :cond_7
+    :cond_6
     invoke-static {p3}, Lcom/samsung/android/knox/SemPersonaManager;->isSecureFolderId(I)Z
 
-    move-result v8
+    move-result v7
 
-    if-nez v8, :cond_8
+    if-nez v7, :cond_7
 
-    if-eqz v6, :cond_9
+    if-eqz v5, :cond_8
 
-    :cond_8
-    const-string/jumbo v6, "SEP-Lite User %d identified as SecureFolder user"
+    :cond_7
+    const-string/jumbo v5, "SEP-Lite User %d identified as SecureFolder user"
 
     invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v8
+    move-result-object v7
 
-    filled-new-array {v8}, [Ljava/lang/Object;
+    filled-new-array {v7}, [Ljava/lang/Object;
 
-    move-result-object v8
+    move-result-object v7
 
-    invoke-static {v6, v8}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v5, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-static {v7, v6}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v6, v5}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    iget-object v6, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
+    iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
 
-    invoke-virtual {v6, p1, p2, p3}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->setSecureFolderLockCredential(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {v5, p1, p2, p3}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->setSecureFolderLockCredential(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-virtual {v6}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    invoke-virtual {v5}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    move-result v6
+    move-result v5
 
-    if-eq v6, v2, :cond_9
+    if-eq v5, v1, :cond_8
 
     const-string/jumbo p0, "sdp not supported : setSecureFolderLockCredential success"
 
-    invoke-static {v7, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v6, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return v2
+    return v1
 
-    :cond_9
+    :cond_8
     :try_start_1
-    iget-object v6, p0, Lcom/android/server/locksettings/LockSettingsService;->mSeparateChallengeLock:Ljava/lang/Object;
+    iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mSeparateChallengeLock:Ljava/lang/Object;
 
-    monitor-enter v6
+    monitor-enter v5
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    if-eqz v3, :cond_a
+    if-eqz v2, :cond_9
 
     goto :goto_4
 
-    :cond_a
-    move v1, p3
+    :cond_9
+    move v0, p3
 
     :goto_4
     :try_start_2
-    invoke-virtual {p0, p1, p2, v1, v0}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialInternal(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
+    invoke-virtual {p0, p1, p2, v0, p4}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialInternal(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
 
-    move-result v1
+    move-result p2
 
-    if-nez v1, :cond_b
+    if-nez p2, :cond_a
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->scheduleGc()V
 
-    monitor-exit v6
+    monitor-exit v5
     :try_end_2
     .catchall {:try_start_2 .. :try_end_2} :catchall_1
 
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return v0
+    return p4
 
     :catchall_1
     move-exception p0
 
-    goto :goto_6
+    goto :goto_5
 
-    :cond_b
+    :cond_a
     :try_start_3
-    invoke-virtual {p0, p3, v2, v7}, Lcom/android/server/locksettings/LockSettingsService;->setSeparateProfileChallengeEnabledLocked(IZLcom/android/internal/widget/LockscreenCredential;)V
+    invoke-virtual {p0, p3, v1, v6}, Lcom/android/server/locksettings/LockSettingsService;->setSeparateProfileChallengeEnabledLocked(IZLcom/android/internal/widget/LockscreenCredential;)V
 
-    if-eqz p4, :cond_c
-
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result p4
+    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    if-eqz p4, :cond_c
+    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;
 
-    goto :goto_5
+    invoke-direct {v0, p0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    :cond_c
-    invoke-virtual {p0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService;->notifyPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
+    invoke-virtual {p2, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    :goto_5
-    monitor-exit v6
+    monitor-exit v5
     :try_end_3
     .catchall {:try_start_3 .. :try_end_3} :catchall_1
 
     :try_start_4
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
 
-    move-result p4
-
-    if-eqz p4, :cond_d
-
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    move-result p2
 
-    const-class v1, Landroid/app/trust/TrustManager;
+    if-eqz p2, :cond_b
 
-    invoke-virtual {p4, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
+    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
-    move-result-object p4
+    const-class v0, Landroid/app/trust/TrustManager;
 
-    check-cast p4, Landroid/app/trust/TrustManager;
+    invoke-virtual {p2, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
 
-    invoke-virtual {p4, p3, v0}, Landroid/app/trust/TrustManager;->setDeviceLockedForUser(IZ)V
+    move-result-object p2
 
-    :cond_d
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->notifySeparateProfileChallengeChanged(I)V
+    check-cast p2, Landroid/app/trust/TrustManager;
 
-    invoke-virtual {p0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService;->onPostPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
+    invoke-virtual {p2, p3, p4}, Landroid/app/trust/TrustManager;->setDeviceLockedForUser(IZ)V
 
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
+    :cond_b
+    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    move-result p4
+    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;
 
-    if-eqz p4, :cond_e
+    invoke-direct {v0, p3}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;-><init>(I)V
 
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
+    invoke-virtual {p2, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
+    invoke-virtual {p0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService;->onPostPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    :cond_e
-    invoke-static {p3, v0}, Lcom/samsung/android/lock/LsLog;->setFailureCount(II)V
+    invoke-static {p3, p4}, Lcom/samsung/android/lock/LsLog;->setFailureCount(II)V
 
     invoke-static {p3}, Lcom/samsung/android/lock/SPBnRManager;->getPWFilelist(I)Ljava/lang/String;
 
     move-result-object p1
 
-    invoke-static {p1, v2}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;Z)V
+    invoke-static {p1, v1}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;Z)V
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->scheduleGc()V
     :try_end_4
     .catchall {:try_start_4 .. :try_end_4} :catchall_0
 
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return v2
+    return v1
 
-    :goto_6
+    :goto_5
     :try_start_5
-    monitor-exit v6
+    monitor-exit v5
     :try_end_5
     .catchall {:try_start_5 .. :try_end_5} :catchall_1
 
@@ -16830,14 +15588,14 @@
     :try_end_6
     .catchall {:try_start_6 .. :try_end_6} :catchall_0
 
-    :goto_7
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :goto_6
+    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw p0
 .end method
 
 .method public final setLockCredentialWithSpLocked(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
-    .locals 21
+    .locals 20
 
     move-object/from16 v1, p0
 
@@ -16956,11 +15714,11 @@
 
     move v7, v9
 
-    move-wide/from16 v19, v16
+    move-wide/from16 v18, v16
 
     move/from16 v16, v10
 
-    move-wide/from16 v9, v19
+    move-wide/from16 v9, v18
 
     invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
@@ -17033,27 +15791,17 @@
 
     move-wide v9, v2
 
-    invoke-static {v7}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
 
     move-result v0
 
     if-eqz v0, :cond_3
 
-    :goto_1
     const/4 v4, 0x0
 
-    goto :goto_4
+    goto :goto_3
 
     :cond_3
-    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    goto :goto_1
-
-    :cond_4
     new-instance v4, Landroid/util/ArrayMap;
 
     invoke-direct {v4}, Landroid/util/ArrayMap;-><init>()V
@@ -17070,8 +15818,8 @@
 
     const/4 v5, 0x0
 
-    :goto_2
-    if-ge v5, v3, :cond_7
+    :goto_1
+    if-ge v5, v3, :cond_6
 
     invoke-interface {v2, v5}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
@@ -17085,22 +15833,22 @@
 
     move-result v6
 
-    if-nez v6, :cond_5
+    if-nez v6, :cond_4
 
-    goto :goto_3
+    goto :goto_2
 
-    :cond_5
+    :cond_4
     iget v6, v0, Landroid/content/pm/UserInfo;->id:I
 
     invoke-virtual {v1, v6}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
 
     move-result v0
 
-    if-eqz v0, :cond_6
+    if-eqz v0, :cond_5
 
-    goto :goto_3
+    goto :goto_2
 
-    :cond_6
+    :cond_5
     :try_start_1
     invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -17123,7 +15871,7 @@
     .catch Ljava/security/cert/CertificateException; {:try_start_1 .. :try_end_1} :catch_1
     .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_1
 
-    goto :goto_3
+    goto :goto_2
 
     :catch_1
     move-exception v0
@@ -17144,15 +15892,15 @@
 
     invoke-static {v9, v6, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    :goto_3
+    :goto_2
     add-int/lit8 v5, v5, 0x1
 
     const-wide/16 v9, 0x0
 
-    goto :goto_2
+    goto :goto_1
 
-    :cond_7
-    :goto_4
+    :cond_6
+    :goto_3
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     const-string/jumbo v2, "handle"
@@ -17163,8 +15911,27 @@
 
     invoke-static {v7, v9, v10, v2}, Lcom/samsung/android/lock/SPBnRManager;->deleteBackup(IJLjava/lang/String;)Z
 
-    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->gateKeeperClearSecureUserId(I)V
+    :try_start_2
+    invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+
+    move-result-object v0
+
+    invoke-interface {v0, v7}, Landroid/service/gatekeeper/IGateKeeperService;->clearSecureUserId(I)V
+    :try_end_2
+    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_2
+
+    goto :goto_4
+
+    :catch_2
+    move-exception v0
+
+    const-string/jumbo v2, "LockSettingsService"
+
+    const-string v3, "Failed to clear SID"
 
+    invoke-static {v2, v3, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    :goto_4
     invoke-virtual {v1, v7, v8}, Lcom/android/server/locksettings/LockSettingsService;->unlockCeStorage(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
 
     invoke-virtual {v1, v7, v8}, Lcom/android/server/locksettings/LockSettingsService;->unlockKeystore(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
@@ -17173,11 +15940,11 @@
 
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    new-instance v2, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;
+    new-instance v2, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;
 
     const/4 v3, 0x0
 
-    invoke-direct {v2, v7, v3, v1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;-><init>(IILjava/lang/Object;)V
+    invoke-direct {v2, v7, v3, v1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;-><init>(IILjava/lang/Object;)V
 
     invoke-virtual {v0, v2}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
@@ -17186,30 +15953,17 @@
 
     invoke-static {}, Lcom/android/internal/widget/LockPatternUtils;->invalidateCredentialTypeCache()V
 
-    invoke-static {v7}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
 
     move-result v0
 
     const/4 v2, 0x1
 
-    if-eqz v0, :cond_9
-
-    :cond_8
-    :goto_6
-    move-object/from16 v3, p1
-
-    goto/16 :goto_a
-
-    :cond_9
-    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_a
+    if-eqz v0, :cond_7
 
-    goto :goto_6
+    goto/16 :goto_9
 
-    :cond_a
+    :cond_7
     invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
 
     move-result v0
@@ -17262,8 +16016,8 @@
 
     const/4 v6, 0x0
 
-    :goto_7
-    if-ge v6, v5, :cond_8
+    :goto_6
+    if-ge v6, v5, :cond_c
 
     invoke-interface {v3, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
@@ -17277,22 +16031,22 @@
 
     move-result v9
 
-    if-eqz v9, :cond_b
+    if-eqz v9, :cond_8
 
     invoke-virtual {v1, v8}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
 
     move-result v9
 
-    if-eqz v9, :cond_c
+    if-eqz v9, :cond_9
 
-    :cond_b
-    :goto_8
+    :cond_8
+    :goto_7
     const/4 v10, 0x0
 
-    goto :goto_9
+    goto :goto_8
 
-    :cond_c
-    if-eqz v0, :cond_d
+    :cond_9
+    if-eqz v0, :cond_a
 
     invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
 
@@ -17300,12 +16054,12 @@
 
     invoke-virtual {v1, v9, v8}, Lcom/android/server/locksettings/LockSettingsService;->tieProfileLockIfNecessary(Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    goto :goto_8
+    goto :goto_7
 
-    :cond_d
+    :cond_a
     const-string/jumbo v9, "Profile("
 
-    if-eqz v4, :cond_e
+    if-eqz v4, :cond_b
 
     invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -17315,7 +16069,7 @@
 
     move-result v10
 
-    if-eqz v10, :cond_e
+    if-eqz v10, :cond_b
 
     new-instance v10, Ljava/lang/StringBuilder;
 
@@ -17361,9 +16115,9 @@
 
     invoke-virtual {v1, v8}, Lcom/android/server/locksettings/LockSettingsService;->removeKeystoreProfileKey(I)V
 
-    goto :goto_8
+    goto :goto_7
 
-    :cond_e
+    :cond_b
     new-instance v10, Ljava/lang/StringBuilder;
 
     invoke-direct {v10, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
@@ -17388,13 +16142,27 @@
 
     invoke-static {v8, v9}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_9
+    :goto_8
     add-int/lit8 v6, v6, 0x1
 
-    goto/16 :goto_7
+    goto/16 :goto_6
 
-    :goto_a
-    invoke-virtual {v1, v3, v7}, Lcom/android/server/locksettings/LockSettingsService;->setUserPasswordMetrics(Lcom/android/internal/widget/LockscreenCredential;I)V
+    :cond_c
+    :goto_9
+    monitor-enter p0
+
+    :try_start_3
+    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mUserPasswordMetrics:Landroid/util/SparseArray;
+
+    invoke-static/range {p1 .. p1}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
+
+    move-result-object v3
+
+    invoke-virtual {v0, v7, v3}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
+
+    monitor-exit p0
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_1
 
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mUnifiedProfilePasswordCache:Lcom/android/server/locksettings/UnifiedProfilePasswordCache;
 
@@ -17402,36 +16170,36 @@
 
     const/4 v0, -0x1
 
-    move/from16 v5, v16
+    move/from16 v3, v16
 
-    if-eq v5, v0, :cond_10
+    if-eq v3, v0, :cond_e
 
-    iget-object v6, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v5, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    iget-object v8, v6, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    iget-object v6, v5, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string/jumbo v9, "spblob"
+    const-string/jumbo v8, "spblob"
 
-    invoke-virtual {v8, v7, v9}, Lcom/android/server/locksettings/LockSettingsStorage;->listSyntheticPasswordProtectorsForUser(ILjava/lang/String;)Ljava/util/List;
+    invoke-virtual {v6, v7, v8}, Lcom/android/server/locksettings/LockSettingsStorage;->listSyntheticPasswordProtectorsForUser(ILjava/lang/String;)Ljava/util/List;
 
-    move-result-object v10
+    move-result-object v9
 
-    check-cast v10, Ljava/util/ArrayList;
+    check-cast v9, Ljava/util/ArrayList;
 
-    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I
+    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I
 
-    move-result v15
+    move-result v10
 
-    const/4 v2, 0x0
+    const/4 v15, 0x0
 
-    :goto_b
-    if-ge v2, v15, :cond_10
+    :goto_a
+    if-ge v15, v10, :cond_e
 
-    invoke-virtual {v10, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    invoke-virtual {v9, v15}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
     move-result-object v16
 
-    add-int/lit8 v2, v2, 0x1
+    add-int/lit8 v15, v15, 0x1
 
     check-cast v16, Ljava/lang/Long;
 
@@ -17439,39 +16207,41 @@
 
     move-result-wide v0
 
-    invoke-virtual {v8, v7, v9, v0, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
+    invoke-virtual {v6, v7, v8, v0, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object v16
 
-    move/from16 v18, v2
-
     invoke-static/range {v16 .. v16}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;
 
     move-result-object v2
 
     iget-byte v2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
 
-    const/4 v3, 0x2
+    move-object/from16 v16, v4
 
-    if-ne v2, v3, :cond_f
+    const/4 v4, 0x2
 
-    invoke-virtual {v6, v7, v0, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyTokenBasedProtector(IJ)V
+    if-ne v2, v4, :cond_d
+
+    invoke-virtual {v5, v7, v0, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyTokenBasedProtector(IJ)V
+
+    :cond_d
+    move-object/from16 v4, v16
 
-    :cond_f
     const/4 v0, -0x1
 
-    move-object/from16 v1, p0
+    const/4 v2, 0x1
 
-    move-object/from16 v3, p1
+    move-object/from16 v1, p0
 
-    move/from16 v2, v18
+    goto :goto_a
 
-    goto :goto_b
+    :cond_e
+    move-object/from16 v16, v4
 
-    :cond_10
-    if-eqz v4, :cond_11
+    if-eqz v16, :cond_f
 
-    invoke-virtual {v4}, Landroid/util/ArrayMap;->entrySet()Ljava/util/Set;
+    invoke-virtual/range {v16 .. v16}, Landroid/util/ArrayMap;->entrySet()Ljava/util/Set;
 
     move-result-object v0
 
@@ -17479,12 +16249,12 @@
 
     move-result-object v0
 
-    :goto_c
+    :goto_b
     invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
 
     move-result v1
 
-    if-eqz v1, :cond_11
+    if-eqz v1, :cond_f
 
     invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -17500,26 +16270,26 @@
 
     invoke-virtual {v1}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
 
-    goto :goto_c
+    goto :goto_b
 
-    :cond_11
+    :cond_f
     invoke-static {}, Lcom/android/server/locksettings/LockSettingsService;->isEnablePrevCredential()Z
 
     move-result v0
 
-    if-eqz v0, :cond_12
+    if-eqz v0, :cond_10
 
     const/4 v0, -0x1
 
-    if-eq v5, v0, :cond_12
+    if-eq v3, v0, :cond_10
 
     invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
     move-result v1
 
-    if-eq v1, v0, :cond_12
+    if-eq v1, v0, :cond_10
 
-    if-nez v7, :cond_12
+    if-nez v7, :cond_10
 
     move-object/from16 v1, p0
 
@@ -17531,21 +16301,21 @@
 
     cmp-long v0, v2, v9
 
-    if-nez v0, :cond_13
+    if-nez v0, :cond_11
 
     invoke-virtual {v1, v7, v11, v12}, Lcom/android/server/locksettings/LockSettingsService;->setBackupLskfBasedProtectorId(IJ)V
 
-    goto :goto_d
+    goto :goto_c
 
-    :cond_12
+    :cond_10
     move-object/from16 v1, p0
 
-    :cond_13
+    :cond_11
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     invoke-virtual {v0, v7, v11, v12}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyLskfBasedProtector(IJ)V
 
-    :goto_d
+    :goto_c
     const-string/jumbo v0, "LockSettingsService"
 
     const-string/jumbo v2, "Successfully changed lockscreen credential of user %d"
@@ -17560,7 +16330,7 @@
 
     invoke-static {v0, v2, v3}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    if-nez v7, :cond_17
+    if-nez v7, :cond_15
 
     invoke-virtual {v1, v13, v14}, Lcom/android/server/locksettings/LockSettingsService;->hasSecurityIntegrity(J)B
 
@@ -17568,11 +16338,11 @@
 
     const/4 v2, 0x1
 
-    if-eq v0, v2, :cond_14
+    if-eq v0, v2, :cond_12
 
-    goto :goto_e
+    goto :goto_d
 
-    :cond_14
+    :cond_12
     invoke-static {}, Landroid/os/Process;->myPid()I
 
     move-result v0
@@ -17587,7 +16357,7 @@
 
     monitor-enter v2
 
-    :try_start_2
+    :try_start_4
     invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
 
     move-result-object v0
@@ -17608,18 +16378,18 @@
 
     cmp-long v0, v8, v16
 
-    if-nez v0, :cond_15
+    if-nez v0, :cond_13
 
     monitor-exit v2
 
-    goto :goto_e
+    goto :goto_d
 
     :catchall_0
     move-exception v0
 
-    goto :goto_f
+    goto :goto_e
 
-    :cond_15
+    :cond_13
     invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
     move-result-object v0
@@ -17652,7 +16422,7 @@
 
     cmp-long v0, v4, v9
 
-    if-eqz v0, :cond_16
+    if-eqz v0, :cond_14
 
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
@@ -17674,12 +16444,12 @@
 
     invoke-static {v0}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;)V
 
-    :cond_16
+    :cond_14
     monitor-exit v2
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_0
 
-    :goto_e
+    :goto_d
     invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
     move-result-wide v2
@@ -17690,172 +16460,117 @@
 
     invoke-static {v2, v3, v0, v1}, Lcom/samsung/android/lock/LsLog;->setCurIds(JJ)V
 
-    goto :goto_10
+    goto :goto_f
 
-    :goto_f
-    :try_start_3
+    :goto_e
+    :try_start_5
     monitor-exit v2
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
+    :try_end_5
+    .catchall {:try_start_5 .. :try_end_5} :catchall_0
 
     throw v0
 
-    :cond_17
-    :goto_10
-    return-wide v13
-.end method
-
-.method public final setLockCredentialWithTokenInternalLocked(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
-    .locals 10
-
-    const-string v0, "Dual DAR Client failed to reset password with token for user: "
-
-    invoke-static {p5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v2
-
-    invoke-static {p2, p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v3
-
-    filled-new-array {v2, v3}, [Ljava/lang/Object;
-
-    move-result-object v2
-
-    const-string/jumbo v3, "Resetting lockscreen credential of user %d using escrow token %016x"
-
-    const-string/jumbo v8, "LockSettingsService"
-
-    invoke-static {v8, v3, v2}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0, p5}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
-
-    move-result v2
-
-    const/4 v9, 0x0
-
-    if-eqz v2, :cond_0
-
-    :try_start_0
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    move-object v3, p1
-
-    move-wide v4, p2
-
-    move-object v6, p4
-
-    move v7, p5
-
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->setLockCredentialWithTokenInternalForDualDAR(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
-
-    move-result v2
-
-    if-nez v2, :cond_0
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    invoke-direct {v2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, p5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v8, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return v9
+    :cond_15
+    :goto_f
+    return-wide v13
 
-    :catch_0
+    :catchall_1
     move-exception v0
 
-    new-instance v2, Ljava/lang/StringBuilder;
+    :try_start_6
+    monitor-exit p0
+    :try_end_6
+    .catchall {:try_start_6 .. :try_end_6} :catchall_1
 
-    const-string v3, "Exception : "
+    throw v0
+.end method
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+.method public final setLockCredentialWithTokenInternalLocked(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
+    .locals 10
 
-    invoke-virtual {v0}, Landroid/os/RemoteException;->getMessage()Ljava/lang/String;
+    invoke-static {p5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v0
 
-    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-static {p2, p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    move-result-object v1
+
+    filled-new-array {v0, v1}, [Ljava/lang/Object;
 
     move-result-object v0
 
-    new-array v2, v9, [Ljava/lang/Object;
+    const-string/jumbo v1, "Resetting lockscreen credential of user %d using escrow token %016x"
 
-    invoke-static {v8, v0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    const-string/jumbo v2, "LockSettingsService"
 
-    :cond_0
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    invoke-static {v2, v1, v0}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+
+    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    move-result-object v6
+    move-result-object v7
 
-    move-wide v4, p2
+    move-wide v5, p2
 
-    move-object v7, p4
+    move-object v8, p4
 
-    move v3, p5
+    move v4, p5
 
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockTokenBasedProtector(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockTokenBasedProtector(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
-    move-result-object v0
+    move-result-object p2
 
-    iget-object v2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    iget-object p3, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    if-nez v2, :cond_1
+    const/4 p4, 0x0
 
-    const-string v0, "Invalid escrow token supplied"
+    if-nez p3, :cond_0
 
-    invoke-static {v8, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
+    const-string p0, "Invalid escrow token supplied"
 
-    return v9
+    invoke-static {v2, p0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_1
-    iget-object v2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    return p4
 
-    invoke-virtual {v2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    :cond_0
+    iget-object p3, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    move-result v2
+    invoke-virtual {p3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    if-eqz v2, :cond_2
+    move-result p3
 
-    const-string/jumbo v0, "Obsolete token: synthetic password decrypted but it fails GK verification."
+    if-eqz p3, :cond_1
 
-    invoke-static {v8, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    const-string/jumbo p0, "Obsolete token: synthetic password decrypted but it fails GK verification."
 
-    return v9
+    invoke-static {v2, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_2
-    iget-object v2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    return p4
 
-    invoke-virtual {p0, p5, v2, v9}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordKnown(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Z)V
+    :cond_1
+    iget-object p3, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    iget-object v6, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    invoke-virtual {p0, v4, p3, p4}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordKnown(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Z)V
 
-    const/4 v3, 0x0
+    iget-object v8, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    const-wide/16 v4, 0x0
+    const/4 v5, 0x0
 
-    move-object v1, p0
+    const-wide/16 v6, 0x0
 
-    move-object v2, p1
+    move-object v3, p0
 
-    move v7, p5
+    move v9, v4
 
-    invoke-virtual/range {v1 .. v7}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithSpLocked(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
+    move-object v4, p1
 
-    const/4 v0, 0x1
+    invoke-virtual/range {v3 .. v9}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithSpLocked(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
 
-    return v0
+    const/4 p0, 0x1
+
+    return p0
 .end method
 
 .method public final setLockFMMPassword([BI)V
@@ -17994,11 +16709,11 @@
 
     move-result-object p0
 
-    new-instance p1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;
+    new-instance p1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;
 
     const/4 p2, 0x0
 
-    invoke-direct {p1, p4, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;-><init>(II)V
+    invoke-direct {p1, p4, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;-><init>(II)V
 
     invoke-virtual {p0, p1}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
 
@@ -18681,22 +17396,13 @@
 .method public final setSeparateProfileChallengeEnabled(IZLcom/android/internal/widget/LockscreenCredential;)V
     .locals 2
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->checkWritePermission()V
 
     iget-boolean v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHasSecureLockScreen:Z
 
-    if-nez v0, :cond_2
+    if-nez v0, :cond_1
 
-    if-eqz p3, :cond_2
+    if-eqz p3, :cond_1
 
     invoke-virtual {p3}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
@@ -18704,11 +17410,11 @@
 
     const/4 v1, -0x1
 
-    if-ne v0, v1, :cond_1
+    if-ne v0, v1, :cond_0
 
     goto :goto_0
 
-    :cond_1
+    :cond_0
     new-instance p0, Ljava/lang/UnsupportedOperationException;
 
     const-string/jumbo p1, "This operation requires secure lock screen feature."
@@ -18717,19 +17423,19 @@
 
     throw p0
 
-    :cond_2
+    :cond_1
     :goto_0
     new-instance v0, Ljava/lang/StringBuilder;
 
     invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
 
-    if-eqz p2, :cond_3
+    if-eqz p2, :cond_2
 
     const-string v1, "Enable"
 
     goto :goto_1
 
-    :cond_3
+    :cond_2
     const-string v1, "Disable"
 
     :goto_1
@@ -18751,11 +17457,11 @@
 
     monitor-enter v0
 
-    if-eqz p3, :cond_4
+    if-eqz p3, :cond_3
 
     goto :goto_2
 
-    :cond_4
+    :cond_3
     :try_start_0
     invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
 
@@ -18768,7 +17474,13 @@
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->notifySeparateProfileChallengeChanged(I)V
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
+
+    new-instance p2, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;
+
+    invoke-direct {p2, p1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;-><init>(I)V
+
+    invoke-virtual {p0, p2}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
     return-void
 
@@ -18786,15 +17498,6 @@
 .method public final setSeparateProfileChallengeEnabledLocked(IZLcom/android/internal/widget/LockscreenCredential;)V
     .locals 3
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
     const-string/jumbo v0, "lockscreen.profilechallenge"
 
     const/4 v1, 0x0
@@ -18817,12 +17520,12 @@
 
     move-result-object v2
 
-    if-eqz v2, :cond_1
+    if-eqz v2, :cond_0
 
     invoke-virtual {v2, v1, p1}, Landroid/sec/enterprise/PasswordPolicy;->notifyPasswordPolicyOneLockChanged(ZI)V
 
-    :cond_1
-    if-eqz p2, :cond_2
+    :cond_0
+    if-eqz p2, :cond_1
 
     :try_start_0
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
@@ -18842,7 +17545,7 @@
 
     goto :goto_0
 
-    :cond_2
+    :cond_1
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     monitor-enter p2
@@ -19100,34 +17803,6 @@
     return-void
 .end method
 
-.method public final setUserPasswordMetrics(Lcom/android/internal/widget/LockscreenCredential;I)V
-    .locals 1
-
-    monitor-enter p0
-
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserPasswordMetrics:Landroid/util/SparseArray;
-
-    invoke-static {p1}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
-
-    move-result-object p1
-
-    invoke-virtual {v0, p2, p1}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
-
-    monitor-exit p0
-
-    return-void
-
-    :catchall_0
-    move-exception p1
-
-    monitor-exit p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p1
-.end method
-
 .method public final startRecoverySessionWithCertPath(Ljava/lang/String;Ljava/lang/String;Landroid/security/keystore/recovery/RecoveryCertPath;[B[BLjava/util/List;)[B
     .locals 3
 
@@ -19934,15 +18609,6 @@
 .method public final tieProfileLockIfNecessary(Lcom/android/internal/widget/LockscreenCredential;I)V
     .locals 10
 
-    invoke-static {p2}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto/16 :goto_0
-
-    :cond_0
     new-instance v0, Ljava/lang/StringBuilder;
 
     const-string/jumbo v1, "Tie lock if necessary for user "
@@ -19961,20 +18627,20 @@
 
     move-result v0
 
-    if-nez v0, :cond_1
+    if-nez v0, :cond_0
 
     goto :goto_0
 
-    :cond_1
+    :cond_0
     invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
 
     move-result v0
 
-    if-eqz v0, :cond_2
+    if-eqz v0, :cond_1
 
     goto :goto_0
 
-    :cond_2
+    :cond_1
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
     invoke-virtual {v0, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->getChildProfileLockFile(I)Ljava/io/File;
@@ -19985,33 +18651,22 @@
 
     move-result v0
 
-    if-eqz v0, :cond_3
-
-    goto :goto_0
-
-    :cond_3
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v0, p2}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_2
 
     goto :goto_0
 
-    :cond_4
+    :cond_2
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
     invoke-virtual {v0, p2}, Landroid/os/UserManager;->getProfileParent(I)Landroid/content/pm/UserInfo;
 
     move-result-object v0
 
-    if-nez v0, :cond_5
+    if-nez v0, :cond_3
 
     goto :goto_0
 
-    :cond_5
+    :cond_3
     iget v1, v0, Landroid/content/pm/UserInfo;->id:I
 
     invoke-virtual {p0, v1}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
@@ -20022,13 +18677,13 @@
 
     const-string/jumbo v3, "LockSettingsService"
 
-    if-nez v1, :cond_6
+    if-nez v1, :cond_4
 
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v1
 
-    if-nez v1, :cond_6
+    if-nez v1, :cond_4
 
     invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -20050,7 +18705,7 @@
 
     return-void
 
-    :cond_6
+    :cond_4
     :try_start_0
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
@@ -20068,12 +18723,12 @@
 
     cmp-long v1, v3, v5
 
-    if-nez v1, :cond_7
+    if-nez v1, :cond_5
 
     :goto_0
     return-void
 
-    :cond_7
+    :cond_5
     const/16 v1, 0x28
 
     invoke-static {v1}, Lcom/android/server/locksettings/SecureRandomUtils;->randomBytes(I)[B
@@ -20095,7 +18750,7 @@
     :goto_1
     array-length v9, v5
 
-    if-ge v8, v9, :cond_8
+    if-ge v8, v9, :cond_6
 
     aget-char v9, v5, v8
 
@@ -20107,7 +18762,7 @@
 
     goto :goto_1
 
-    :cond_8
+    :cond_6
     invoke-static {v6}, Lcom/android/internal/widget/LockscreenCredential;->createUnifiedProfilePassword([B)Lcom/android/internal/widget/LockscreenCredential;
 
     move-result-object v8
@@ -20133,7 +18788,7 @@
 
     move-result p1
 
-    if-eqz p1, :cond_9
+    if-eqz p1, :cond_7
 
     const/4 p1, 0x0
 
@@ -20148,14 +18803,14 @@
 
     goto :goto_3
 
-    :cond_9
+    :cond_7
     :goto_2
     invoke-virtual {v8}, Lcom/android/internal/widget/LockscreenCredential;->close()V
 
     return-void
 
     :goto_3
-    if-eqz v8, :cond_a
+    if-eqz v8, :cond_8
 
     :try_start_2
     invoke-virtual {v8}, Lcom/android/internal/widget/LockscreenCredential;->close()V
@@ -20169,7 +18824,7 @@
 
     invoke-virtual {p0, p1}, Ljava/lang/Throwable;->addSuppressed(Ljava/lang/Throwable;)V
 
-    :cond_a
+    :cond_8
     :goto_4
     throw p0
 
@@ -20713,156 +19368,66 @@
     :try_end_7
     .catchall {:try_start_7 .. :try_end_7} :catchall_0
 
-    throw p0
-.end method
-
-.method public final unlockCeStorage(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-    .locals 6
-
-    const-string/jumbo v0, "Unable to unlock CE storage for profile id: "
-
-    const-string v1, "CE storage for profile id: "
-
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_0
-
-    goto/16 :goto_4
-
-    :cond_0
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isCeStorageUnlocked(I)Z
-
-    move-result v2
-
-    const-string/jumbo v3, "LockSettingsService"
-
-    if-eqz v2, :cond_1
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    filled-new-array {p0}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string p1, "CE storage for user %d is already unlocked"
-
-    invoke-static {v3, p1, p0}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return-void
-
-    :cond_1
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_2
-
-    const-string/jumbo v2, "secured"
-
-    goto :goto_0
-
-    :cond_2
-    const-string/jumbo v2, "unsecured"
-
-    :goto_0
-    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    sget-object v4, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_FBE_KEY:[B
-
-    invoke-virtual {p2, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
-
-    move-result-object p2
-
-    :try_start_0
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v4, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
-
-    move-result v4
-
-    const/4 v5, 0x0
-
-    if-eqz v4, :cond_4
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_3
-
-    const-string v4, "Do not substitute outer-layer-key in case of DualDAR on DO!"
-
-    invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_1
-
-    :cond_3
-    const-string/jumbo v4, "need to get secret for DualDAR user"
-
-    invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    throw p0
+.end method
 
-    const/4 v5, 0x1
+.method public final unlockCeStorage(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
+    .locals 5
 
-    :cond_4
-    :goto_1
-    if-eqz v5, :cond_5
+    const-string/jumbo v0, "Unable to unlock CE storage for profile id: "
 
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    const-string v1, "CE storage for profile id: "
 
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isCeStorageUnlocked(I)Z
 
-    const-string/jumbo v5, "getChangedStorageSecretIfDualDAR"
+    move-result v2
 
-    invoke-static {v3, v5}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+    const-string/jumbo v3, "LockSettingsService"
 
-    const-string/jumbo v5, "fetchOuterLayerKey()"
+    if-eqz v2, :cond_0
 
-    invoke-static {v3, v5}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    iget-object v4, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    move-result-object p0
 
-    check-cast v4, Lcom/android/server/locksettings/LockSettingsService;
+    filled-new-array {p0}, [Ljava/lang/Object;
 
-    iget-object v4, v4, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    move-result-object p0
 
-    invoke-static {v4}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
+    const-string p1, "CE storage for user %d is already unlocked"
 
-    move-result-object v4
+    invoke-static {v3, p1, p0}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    invoke-virtual {v4, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->fetchOuterLayerKey(I)[B
+    return-void
 
-    move-result-object v4
+    :cond_0
+    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
 
-    const-string/jumbo v5, "fetchOuterLayerKey Finished"
+    move-result v2
 
-    invoke-static {v3, v5}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    if-eqz v2, :cond_1
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorageManager:Landroid/os/storage/IStorageManager;
+    const-string/jumbo v2, "secured"
 
-    invoke-interface {p0, p1, v4}, Landroid/os/storage/IStorageManager;->unlockCeStorage(I[B)V
+    goto :goto_0
 
-    goto :goto_2
+    :cond_1
+    const-string/jumbo v2, "unsecured"
 
-    :catchall_0
-    move-exception p0
+    :goto_0
+    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    goto :goto_5
+    sget-object v4, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_FBE_KEY:[B
 
-    :catch_0
-    move-exception p0
+    invoke-virtual {p2, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
 
-    goto :goto_3
+    move-result-object p2
 
-    :cond_5
+    :try_start_0
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorageManager:Landroid/os/storage/IStorageManager;
 
     invoke-interface {p0, p1, p2}, Landroid/os/storage/IStorageManager;->unlockCeStorage(I[B)V
 
-    :goto_2
     const-string p0, "!@Unlocked CE storage for %s user %d"
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
@@ -20898,7 +19463,14 @@
 
     return-void
 
-    :goto_3
+    :catchall_0
+    move-exception p0
+
+    goto :goto_1
+
+    :catch_0
+    move-exception p0
+
     :try_start_1
     const-string v1, "Failed to unlock CE storage for %s user %d"
 
@@ -20928,10 +19500,9 @@
 
     invoke-static {p2}, Lcom/android/internal/widget/LockPatternUtils;->zeroize([B)V
 
-    :goto_4
     return-void
 
-    :goto_5
+    :goto_1
     invoke-static {p2}, Lcom/android/internal/widget/LockPatternUtils;->zeroize([B)V
 
     throw p0
@@ -20940,15 +19511,6 @@
 .method public final unlockKeystore(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
     .locals 1
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mKeyStoreAuthorization:Landroid/security/KeyStoreAuthorization;
 
     invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
@@ -20967,7 +19529,7 @@
 
     move-result p0
 
-    if-eqz p0, :cond_1
+    if-eqz p0, :cond_0
 
     new-instance p2, Ljava/lang/StringBuilder;
 
@@ -20991,23 +19553,13 @@
 
     invoke-static {p0, p1}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
 
-    :cond_1
-    :goto_0
+    :cond_0
     return-void
 .end method
 
 .method public final unlockUser(I)V
     .locals 8
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto/16 :goto_3
-
-    :cond_0
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v0
@@ -21068,13 +19620,13 @@
 
     move-result v1
 
-    if-eqz v1, :cond_2
+    if-eqz v1, :cond_1
 
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
 
     move-result v0
 
-    if-nez v0, :cond_1
+    if-nez v0, :cond_0
 
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
@@ -21086,11 +19638,11 @@
 
     move-result p1
 
-    if-eqz p1, :cond_1
+    if-eqz p1, :cond_0
 
     goto/16 :goto_3
 
-    :cond_1
+    :cond_0
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mBiometricDeferredQueue:Lcom/android/server/locksettings/BiometricDeferredQueue;
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
@@ -21105,7 +19657,7 @@
 
     goto/16 :goto_3
 
-    :cond_2
+    :cond_1
     iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
     invoke-virtual {v1, p1}, Landroid/os/UserManager;->getProfiles(I)Ljava/util/List;
@@ -21116,13 +19668,13 @@
 
     move-result-object v1
 
-    :cond_3
+    :cond_2
     :goto_1
     invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z
 
     move-result v3
 
-    if-eqz v3, :cond_a
+    if-eqz v3, :cond_9
 
     invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -21132,27 +19684,27 @@
 
     iget v4, v3, Landroid/content/pm/UserInfo;->id:I
 
-    if-ne v4, p1, :cond_4
+    if-ne v4, p1, :cond_3
 
     goto :goto_1
 
-    :cond_4
+    :cond_3
     invoke-virtual {p0, v4}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
 
     move-result v4
 
-    if-nez v4, :cond_5
+    if-nez v4, :cond_4
 
     goto :goto_1
 
-    :cond_5
+    :cond_4
     iget v4, v3, Landroid/content/pm/UserInfo;->id:I
 
     invoke-virtual {p0, v4}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
 
     move-result v5
 
-    if-nez v5, :cond_8
+    if-nez v5, :cond_7
 
     iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
@@ -21164,7 +19716,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_8
+    if-eqz v4, :cond_7
 
     iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
@@ -21174,7 +19726,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_7
+    if-eqz v4, :cond_6
 
     iget v4, v3, Landroid/content/pm/UserInfo;->id:I
 
@@ -21207,7 +19759,7 @@
 
     instance-of v6, v5, Ljava/io/FileNotFoundException;
 
-    if-eqz v6, :cond_6
+    if-eqz v6, :cond_5
 
     const-string v5, "Child profile key not found"
 
@@ -21229,7 +19781,7 @@
 
     goto :goto_2
 
-    :cond_6
+    :cond_5
     const-string v6, "Failed to decrypt child profile key"
 
     invoke-static {v2, v6, v5}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
@@ -21260,7 +19812,7 @@
 
     goto :goto_2
 
-    :cond_7
+    :cond_6
     :try_start_3
     iget v4, v3, Landroid/content/pm/UserInfo;->id:I
 
@@ -21278,279 +19830,126 @@
 
     invoke-static {v2, v5, v4}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    :cond_8
+    :cond_7
     :goto_2
     invoke-static {}, Landroid/os/storage/StorageManager;->isFileEncrypted()Z
 
     move-result v4
 
-    if-eqz v4, :cond_9
+    if-eqz v4, :cond_8
 
     invoke-virtual {v3}, Landroid/content/pm/UserInfo;->isSecureFolder()Z
 
     move-result v4
 
-    if-eqz v4, :cond_9
-
-    invoke-virtual {p0, v3}, Lcom/android/server/locksettings/LockSettingsService;->UnlockSecureFolderIfAutoDataDecryption(Landroid/content/pm/UserInfo;)V
-
-    :cond_9
-    if-nez v0, :cond_3
-
-    invoke-static {}, Lcom/android/internal/widget/ILockSettings$Stub;->clearCallingIdentity()J
-
-    move-result-wide v4
-
-    :try_start_4
-    iget v3, v3, Landroid/content/pm/UserInfo;->id:I
-
-    const-string/jumbo v6, "parent unlocked"
-
-    invoke-virtual {p0, v3, v6}, Lcom/android/server/locksettings/LockSettingsService;->maybeShowEncryptionNotificationForUser(ILjava/lang/String;)V
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    invoke-static {v4, v5}, Lcom/android/internal/widget/ILockSettings$Stub;->restoreCallingIdentity(J)V
-
-    goto/16 :goto_1
-
-    :catchall_0
-    move-exception p0
-
-    invoke-static {v4, v5}, Lcom/android/internal/widget/ILockSettings$Stub;->restoreCallingIdentity(J)V
-
-    throw p0
-
-    :cond_a
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mBiometricDeferredQueue:Lcom/android/server/locksettings/BiometricDeferredQueue;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance p1, Lcom/android/server/locksettings/BiometricDeferredQueue$$ExternalSyntheticLambda1;
-
-    invoke-direct {p1, p0}, Lcom/android/server/locksettings/BiometricDeferredQueue$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/locksettings/BiometricDeferredQueue;)V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/BiometricDeferredQueue;->mHandler:Landroid/os/Handler;
-
-    invoke-virtual {p0, p1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
-
-    :goto_3
-    return-void
-
-    :catch_3
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->rethrowAsRuntimeException()Ljava/lang/RuntimeException;
-
-    move-result-object p0
-
-    throw p0
-.end method
-
-.method public final unlockUserKeyIfUnsecured(I)V
-    .locals 12
-
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->checkPasswordReadPermission()V
-
-    const-string/jumbo v0, "migrated_dualdar_user_to_sp_and_bound_ce"
-
-    const-string/jumbo v1, "true"
-
-    invoke-virtual {p0, v0, v1, p1}, Lcom/android/server/locksettings/LockSettingsService;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "false"
-
-    invoke-static {v0, v1}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_1
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v2
-
-    :try_start_0
-    const-string/jumbo v0, "LockSettingsService"
-
-    const-string/jumbo v3, "Migrating unsecured DualDar user."
-
-    new-array v4, v1, [Ljava/lang/Object;
-
-    invoke-static {v0, v3, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->migrateUserToSpWithBoundKeysLocked(I)V
-
-    monitor-exit v2
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    const-string/jumbo v0, "LockSettingsService"
-
-    const-string/jumbo v2, "Migrated unsecured DualDar user."
-
-    new-array v3, v1, [Ljava/lang/Object;
-
-    invoke-static {v0, v2, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    const-string/jumbo v0, "migrated_dualdar_user_to_sp_and_bound_ce"
-
-    const-string/jumbo v2, "true"
-
-    invoke-virtual {p0, v0, v2, p1}, Lcom/android/server/locksettings/LockSettingsService;->setString(Ljava/lang/String;Ljava/lang/String;I)V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    :try_start_1
-    monitor-exit v2
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_1
-    :goto_0
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v2
-
-    :try_start_2
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isCeStorageUnlocked(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    const-string/jumbo p0, "LockSettingsService"
-
-    const-string v0, "CE storage for user %d is already unlocked"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    filled-new-array {p1}, [Ljava/lang/Object;
+    if-eqz v4, :cond_8
 
-    move-result-object p1
+    invoke-virtual {p0, v3}, Lcom/android/server/locksettings/LockSettingsService;->UnlockSecureFolderIfAutoDataDecryption(Landroid/content/pm/UserInfo;)V
 
-    invoke-static {p0, v0, p1}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    :cond_8
+    if-nez v0, :cond_2
 
-    monitor-exit v2
+    invoke-static {}, Lcom/android/internal/widget/ILockSettings$Stub;->clearCallingIdentity()J
 
-    return-void
+    move-result-wide v4
 
-    :catchall_1
-    move-exception v0
+    :try_start_4
+    iget v3, v3, Landroid/content/pm/UserInfo;->id:I
 
-    move-object p0, v0
+    const-string/jumbo v6, "parent unlocked"
 
-    goto/16 :goto_2
+    invoke-virtual {p0, v3, v6}, Lcom/android/server/locksettings/LockSettingsService;->maybeShowEncryptionNotificationForUser(ILjava/lang/String;)V
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_0
 
-    :cond_2
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
+    invoke-static {v4, v5}, Lcom/android/internal/widget/ILockSettings$Stub;->restoreCallingIdentity(J)V
 
-    move-result v0
+    goto/16 :goto_1
 
-    if-eqz v0, :cond_3
+    :catchall_0
+    move-exception p0
 
-    const-string/jumbo p0, "LockSettingsService"
+    invoke-static {v4, v5}, Lcom/android/internal/widget/ILockSettings$Stub;->restoreCallingIdentity(J)V
 
-    const-string/jumbo v0, "Not unlocking CE storage for user %d yet because user is secured"
+    throw p0
 
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    :cond_9
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mBiometricDeferredQueue:Lcom/android/server/locksettings/BiometricDeferredQueue;
 
-    move-result-object p1
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    filled-new-array {p1}, [Ljava/lang/Object;
+    new-instance p1, Lcom/android/server/locksettings/BiometricDeferredQueue$$ExternalSyntheticLambda1;
 
-    move-result-object p1
+    invoke-direct {p1, p0}, Lcom/android/server/locksettings/BiometricDeferredQueue$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/locksettings/BiometricDeferredQueue;)V
 
-    invoke-static {p0, v0, p1}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    iget-object p0, p0, Lcom/android/server/locksettings/BiometricDeferredQueue;->mHandler:Landroid/os/Handler;
 
-    monitor-exit v2
+    invoke-virtual {p0, p1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
+    :goto_3
     return-void
 
-    :cond_3
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v0, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
+    :catch_3
+    move-exception p0
 
-    move-result v0
+    invoke-virtual {p0}, Landroid/os/RemoteException;->rethrowAsRuntimeException()Ljava/lang/RuntimeException;
 
-    const/4 v3, 0x1
+    move-result-object p0
 
-    if-nez v0, :cond_4
+    throw p0
+.end method
 
-    goto :goto_1
+.method public final unlockUserKeyIfUnsecured(I)V
+    .locals 11
 
-    :cond_4
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->checkPasswordReadPermission()V
 
-    move-result v0
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    if-eqz v0, :cond_5
+    monitor-enter v1
 
-    goto :goto_1
+    :try_start_0
+    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isCeStorageUnlocked(I)Z
 
-    :cond_5
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->getCurrentState(I)Lcom/samsung/android/knox/dar/ddar/fsm/State;
+    move-result v0
 
-    move-result-object v0
+    if-eqz v0, :cond_0
 
-    sget-object v4, Lcom/samsung/android/knox/dar/ddar/fsm/State;->DEVICE_UNLOCK_DATA_UNLOCK:Lcom/samsung/android/knox/dar/ddar/fsm/State;
+    const-string/jumbo p0, "LockSettingsService"
 
-    const-string/jumbo v5, "LockSettingsService"
+    const-string v0, "CE storage for user %d is already unlocked"
 
-    const/4 v6, 0x0
+    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    if-ne v0, v4, :cond_6
+    move-result-object p1
 
-    const-string/jumbo v0, "Password2Auth has already been completed for: "
+    filled-new-array {p1}, [Ljava/lang/Object;
 
-    invoke-static {p1, v0}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
+    move-result-object p1
 
-    move-result-object v0
+    invoke-static {p0, v0, p1}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    new-array v4, v6, [Ljava/lang/Object;
+    monitor-exit v1
 
-    invoke-static {v5, v0, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    return-void
 
-    goto :goto_1
+    :catchall_0
+    move-exception v0
 
-    :cond_6
-    const-string/jumbo v0, "dualdar data is not unlocked yet!"
+    move-object p0, v0
 
-    new-array v3, v6, [Ljava/lang/Object;
+    goto :goto_0
 
-    invoke-static {v5, v0, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    :cond_0
+    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
 
-    move v3, v6
+    move-result v0
 
-    :goto_1
-    if-nez v3, :cond_7
+    if-eqz v0, :cond_1
 
     const-string/jumbo p0, "LockSettingsService"
 
-    const-string/jumbo v0, "unlocking CE storage for dualdar user %d is failed"
+    const-string/jumbo v0, "Not unlocking CE storage for user %d yet because user is secured"
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -21562,56 +19961,56 @@
 
     invoke-static {p0, v0, p1}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    monitor-exit v2
+    monitor-exit v1
 
     return-void
 
-    :cond_7
+    :cond_1
     const-string/jumbo v0, "LockSettingsService"
 
-    const-string/jumbo v3, "Unwrapping synthetic password for unsecured user %d"
+    const-string/jumbo v2, "Unwrapping synthetic password for unsecured user %d"
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v4
+    move-result-object v3
 
-    filled-new-array {v4}, [Ljava/lang/Object;
+    filled-new-array {v3}, [Ljava/lang/Object;
 
-    move-result-object v4
+    move-result-object v3
 
-    invoke-static {v0, v3, v4}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v0, v2, v3}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    move-result-object v6
+    move-result-object v5
 
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
-    move-result-wide v7
+    move-result-wide v6
 
     invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
 
-    move-result-object v9
+    move-result-object v8
 
-    const/4 v11, 0x0
+    const/4 v10, 0x0
 
-    move v10, p1
+    move v9, p1
 
-    invoke-virtual/range {v5 .. v11}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    invoke-virtual/range {v4 .. v10}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
     move-result-object p1
 
     iget-object v0, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    if-nez v0, :cond_8
+    if-nez v0, :cond_2
 
     const-string/jumbo p0, "LockSettingsService"
 
     const-string p1, "Failed to unwrap synthetic password for unsecured user %d"
 
-    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v0
 
@@ -21621,29 +20020,31 @@
 
     invoke-static {p0, p1, v0}, Lcom/android/server/utils/Slogf;->wtf(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    monitor-exit v2
+    monitor-exit v1
 
     return-void
 
-    :cond_8
-    invoke-virtual {p0, v10, v0, v1}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordKnown(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Z)V
+    :cond_2
+    const/4 v2, 0x0
+
+    invoke-virtual {p0, v9, v0, v2}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordKnown(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Z)V
 
     iget-object v0, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    invoke-virtual {p0, v10, v0}, Lcom/android/server/locksettings/LockSettingsService;->unlockKeystore(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
+    invoke-virtual {p0, v9, v0}, Lcom/android/server/locksettings/LockSettingsService;->unlockKeystore(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
 
     iget-object p1, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    invoke-virtual {p0, v10, p1}, Lcom/android/server/locksettings/LockSettingsService;->unlockCeStorage(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
+    invoke-virtual {p0, v9, p1}, Lcom/android/server/locksettings/LockSettingsService;->unlockCeStorage(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
 
-    monitor-exit v2
+    monitor-exit v1
 
     return-void
 
-    :goto_2
-    monitor-exit v2
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
+    :goto_0
+    monitor-exit v1
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     throw p0
 .end method
@@ -21981,9 +20382,9 @@
 
     new-instance p1, Ljava/lang/Thread;
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;
 
-    invoke-direct {v1, p0, v2, v3, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;-><init>(Lcom/android/server/locksettings/LockSettingsService;Landroid/content/Intent;Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;I)V
+    invoke-direct {v1, p0, v2, v3, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;-><init>(Lcom/android/server/locksettings/LockSettingsService;Landroid/content/Intent;Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;I)V
 
     const-string p0, "KMX_UPDATE_VERIFIER_SERVICE_CONNECTION"
 
@@ -22357,7 +20758,7 @@
 .end method
 
 .method public final verifyCredential(Lcom/android/internal/widget/LockscreenCredential;II)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 4
+    .locals 3
 
     const-string/jumbo v0, "android.permission.ACCESS_KEYGUARD_SECURE_STORAGE"
 
@@ -22392,56 +20793,14 @@
 
     move-result-wide v0
 
-    :try_start_0
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v2
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    const/4 v3, 0x0
-
-    if-eqz v2, :cond_3
-
-    :try_start_1
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/StreamCipher;->decryptStream(Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object p1
-
-    invoke-virtual {p0, p1, p2, v3, p3}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p2
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :try_start_2
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->scheduleGc()V
-
-    return-object p2
-
-    :catchall_0
-    move-exception p2
-
-    if-eqz p1, :cond_2
-
-    :try_start_3
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-
-    :cond_2
-    throw p2
+    const/4 v2, 0x0
 
-    :cond_3
-    invoke-virtual {p0, p1, p2, v3, p3}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
+    :try_start_0
+    invoke-virtual {p0, p1, p2, v2, p3}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
 
     move-result-object p1
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
@@ -22449,7 +20808,7 @@
 
     return-object p1
 
-    :catchall_1
+    :catchall_0
     move-exception p1
 
     invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
@@ -22693,7 +21052,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_1
+    if-eqz v0, :cond_5
 
     iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
@@ -22719,20 +21078,82 @@
 
     invoke-static {v2, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    goto :goto_0
+    goto :goto_2
 
     :catchall_0
     move-exception v0
 
     move-object p0, v0
 
-    goto :goto_1
+    goto :goto_3
 
     :cond_0
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
 
-    invoke-virtual {p0, v5, p2}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->migrateWithAuthToken(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    invoke-static {v5}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+
+    move-result p2
+
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
+
+    if-nez p2, :cond_1
+
+    goto :goto_1
+
+    :cond_1
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+
+    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
+
+    move-result-object p0
+
+    if-eqz p0, :cond_2
+
+    const/4 p0, 0x1
+
+    goto :goto_0
+
+    :cond_2
+    const/4 p0, 0x0
+
+    :goto_0
+    if-eqz p0, :cond_4
+
+    const-class p0, Lcom/android/server/knox/dar/sdp/SdpManagerInternal;
 
+    invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object p0
+
+    if-nez p0, :cond_3
+
+    invoke-static {v2}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
+
+    move-result-object p0
+
+    new-instance p2, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;
+
+    const/4 p3, 0x1
+
+    invoke-direct {p2, p3}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;-><init>(I)V
+
+    invoke-virtual {p0, p2}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
+
+    goto :goto_1
+
+    :cond_3
+    new-instance p0, Ljava/lang/ClassCastException;
+
+    invoke-direct {p0}, Ljava/lang/ClassCastException;-><init>()V
+
+    throw p0
+
+    :cond_4
+    :goto_1
     new-instance p0, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
 
     invoke-direct {p0}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;-><init>()V
@@ -22753,12 +21174,12 @@
 
     invoke-virtual {v1, p0}, Lcom/android/internal/widget/VerifyCredentialResponse;->setSecret([B)V
 
-    :goto_0
+    :goto_2
     monitor-exit v3
 
-    goto :goto_2
+    goto :goto_4
 
-    :cond_1
+    :cond_5
     new-instance p0, Ljava/lang/SecurityException;
 
     const-string p1, "Escrow token is disabled on the current user"
@@ -22767,7 +21188,7 @@
 
     throw p0
 
-    :goto_1
+    :goto_3
     monitor-exit v3
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
@@ -22786,7 +21207,7 @@
 
     invoke-static {p0, v2, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
 
-    :goto_2
+    :goto_4
     new-instance p0, Ljava/lang/StringBuilder;
 
     const-string/jumbo p1, "Result of token verification : "
diff --git a/smali/com/android/server/locksettings/LockSettingsStorage.smali b/smali/com/android/server/locksettings/LockSettingsStorage.smali
index 034a775e1..d728c8874 100644
--- a/smali/com/android/server/locksettings/LockSettingsStorage.smali
+++ b/smali/com/android/server/locksettings/LockSettingsStorage.smali
@@ -978,69 +978,16 @@
 .end method
 
 .method public getSyntheticPasswordDirectoryForUser(I)Ljava/io/File;
-    .locals 3
-
-    const-string/jumbo v0, "spblob/"
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsStorage;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v1, "user"
-
-    invoke-virtual {p0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/os/UserManager;
-
-    invoke-virtual {p0, p1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    invoke-virtual {p0}, Landroid/content/pm/UserInfo;->isVirtualUser()Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    invoke-static {}, Landroid/os/Environment;->getDataSystemDirectory()Ljava/io/File;
-
-    move-result-object p0
-
-    const-string/jumbo v1, "users"
-
-    invoke-static {p1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v2
-
-    filled-new-array {v1, v2, v0}, [Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {p0, v1}, Landroid/os/Environment;->buildPath(Ljava/io/File;[Ljava/lang/String;)Ljava/io/File;
-
-    move-result-object p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-object p0
-
-    :catch_0
-    const-string/jumbo p0, "Unexpected error while get sp path for user "
-
-    const-string/jumbo v1, "LockSettingsStorage"
-
-    invoke-static {p1, p0, v1}, Lcom/android/server/NandswapManager$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    .locals 1
 
-    :cond_0
     new-instance p0, Ljava/io/File;
 
     invoke-static {p1}, Landroid/os/Environment;->getDataSystemDeDirectory(I)Ljava/io/File;
 
     move-result-object p1
 
+    const-string/jumbo v0, "spblob/"
+
     invoke-direct {p0, p1, v0}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
 
     return-object p0
@@ -1193,7 +1140,7 @@
 .end method
 
 .method public final listSyntheticPasswordProtectorsForAllUsers(Ljava/lang/String;)Ljava/util/Map;
-    .locals 6
+    .locals 4
 
     new-instance v0, Landroid/util/ArrayMap;
 
@@ -1243,38 +1190,6 @@
     goto :goto_0
 
     :cond_0
-    new-instance v1, Lcom/samsung/android/knox/dar/VirtualLockUtils;
-
-    invoke-direct {v1}, Lcom/samsung/android/knox/dar/VirtualLockUtils;-><init>()V
-
-    invoke-virtual {v1}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->getVirtualUsers()[I
-
-    move-result-object v1
-
-    array-length v2, v1
-
-    const/4 v3, 0x0
-
-    :goto_1
-    if-ge v3, v2, :cond_1
-
-    aget v4, v1, v3
-
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v5
-
-    invoke-virtual {p0, v4, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->listSyntheticPasswordProtectorsForUser(ILjava/lang/String;)Ljava/util/List;
-
-    move-result-object v4
-
-    invoke-virtual {v0, v5, v4}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    add-int/lit8 v3, v3, 0x1
-
-    goto :goto_1
-
-    :cond_1
     return-object v0
 .end method
 
diff --git a/smali/com/android/server/locksettings/SP800Derive.smali b/smali/com/android/server/locksettings/SP800Derive.smali
deleted file mode 100644
index 788311a79..000000000
--- a/smali/com/android/server/locksettings/SP800Derive.smali
+++ /dev/null
@@ -1,122 +0,0 @@
-.class public final Lcom/android/server/locksettings/SP800Derive;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public final mKeyBytes:[B
-
-
-# direct methods
-.method public constructor <init>([B)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/locksettings/SP800Derive;->mKeyBytes:[B
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final withContext([B[B)[B
-    .locals 3
-
-    :try_start_0
-    const-string v0, "HmacSHA256"
-
-    invoke-static {v0}, Ljavax/crypto/Mac;->getInstance(Ljava/lang/String;)Ljavax/crypto/Mac;
-
-    move-result-object v0
-
-    new-instance v1, Ljavax/crypto/spec/SecretKeySpec;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SP800Derive;->mKeyBytes:[B
-
-    invoke-virtual {v0}, Ljavax/crypto/Mac;->getAlgorithm()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-direct {v1, p0, v2}, Ljavax/crypto/spec/SecretKeySpec;-><init>([BLjava/lang/String;)V
-
-    invoke-virtual {v0, v1}, Ljavax/crypto/Mac;->init(Ljava/security/Key;)V
-    :try_end_0
-    .catch Ljava/security/InvalidKeyException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_0 .. :try_end_0} :catch_0
-
-    const/4 p0, 0x4
-
-    invoke-static {p0}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
-
-    move-result-object v1
-
-    const/4 v2, 0x1
-
-    invoke-virtual {v1, v2}, Ljava/nio/ByteBuffer;->putInt(I)Ljava/nio/ByteBuffer;
-
-    move-result-object v1
-
-    invoke-virtual {v1}, Ljava/nio/ByteBuffer;->array()[B
-
-    move-result-object v1
-
-    invoke-virtual {v0, v1}, Ljavax/crypto/Mac;->update([B)V
-
-    invoke-virtual {v0, p1}, Ljavax/crypto/Mac;->update([B)V
-
-    const/4 p1, 0x0
-
-    invoke-virtual {v0, p1}, Ljavax/crypto/Mac;->update(B)V
-
-    invoke-virtual {v0, p2}, Ljavax/crypto/Mac;->update([B)V
-
-    array-length p1, p2
-
-    mul-int/lit8 p1, p1, 0x8
-
-    invoke-static {p0}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
-
-    move-result-object p2
-
-    invoke-virtual {p2, p1}, Ljava/nio/ByteBuffer;->putInt(I)Ljava/nio/ByteBuffer;
-
-    move-result-object p1
-
-    invoke-virtual {p1}, Ljava/nio/ByteBuffer;->array()[B
-
-    move-result-object p1
-
-    invoke-virtual {v0, p1}, Ljavax/crypto/Mac;->update([B)V
-
-    invoke-static {p0}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
-
-    move-result-object p0
-
-    const/16 p1, 0x100
-
-    invoke-virtual {p0, p1}, Ljava/nio/ByteBuffer;->putInt(I)Ljava/nio/ByteBuffer;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Ljava/nio/ByteBuffer;->array()[B
-
-    move-result-object p0
-
-    invoke-virtual {v0, p0}, Ljavax/crypto/Mac;->update([B)V
-
-    invoke-virtual {v0}, Ljavax/crypto/Mac;->doFinal()[B
-
-    move-result-object p0
-
-    return-object p0
-
-    :catch_0
-    move-exception p0
-
-    new-instance p1, Ljava/lang/RuntimeException;
-
-    invoke-direct {p1, p0}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/Throwable;)V
-
-    throw p1
-.end method
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword.smali b/smali/com/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword.smali
index 97146b2e7..9c33c2f45 100644
--- a/smali/com/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword.smali
+++ b/smali/com/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword.smali
@@ -33,7 +33,7 @@
 
 # virtual methods
 .method public final deriveSubkey([B)[B
-    .locals 2
+    .locals 4
 
     iget-byte v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mVersion:B
 
@@ -41,20 +41,105 @@
 
     if-ne v0, v1, :cond_0
 
-    new-instance v0, Lcom/android/server/locksettings/SP800Derive;
-
     iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
 
-    invoke-direct {v0, p0}, Lcom/android/server/locksettings/SP800Derive;-><init>([B)V
+    sget-object v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_CONTEXT:[B
+
+    :try_start_0
+    const-string v1, "HmacSHA256"
+
+    invoke-static {v1}, Ljavax/crypto/Mac;->getInstance(Ljava/lang/String;)Ljavax/crypto/Mac;
+
+    move-result-object v1
+
+    new-instance v2, Ljavax/crypto/spec/SecretKeySpec;
+
+    invoke-virtual {v1}, Ljavax/crypto/Mac;->getAlgorithm()Ljava/lang/String;
+
+    move-result-object v3
+
+    invoke-direct {v2, p0, v3}, Ljavax/crypto/spec/SecretKeySpec;-><init>([BLjava/lang/String;)V
+
+    invoke-virtual {v1, v2}, Ljavax/crypto/Mac;->init(Ljava/security/Key;)V
+    :try_end_0
+    .catch Ljava/security/InvalidKeyException; {:try_start_0 .. :try_end_0} :catch_0
+    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_0 .. :try_end_0} :catch_0
+
+    const/4 p0, 0x4
+
+    invoke-static {p0}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
+
+    move-result-object v2
+
+    const/4 v3, 0x1
+
+    invoke-virtual {v2, v3}, Ljava/nio/ByteBuffer;->putInt(I)Ljava/nio/ByteBuffer;
+
+    move-result-object v2
+
+    invoke-virtual {v2}, Ljava/nio/ByteBuffer;->array()[B
+
+    move-result-object v2
+
+    invoke-virtual {v1, v2}, Ljavax/crypto/Mac;->update([B)V
+
+    invoke-virtual {v1, p1}, Ljavax/crypto/Mac;->update([B)V
+
+    const/4 p1, 0x0
+
+    invoke-virtual {v1, p1}, Ljavax/crypto/Mac;->update(B)V
+
+    invoke-virtual {v1, v0}, Ljavax/crypto/Mac;->update([B)V
 
-    sget-object p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_CONTEXT:[B
+    array-length p1, v0
 
-    invoke-virtual {v0, p1, p0}, Lcom/android/server/locksettings/SP800Derive;->withContext([B[B)[B
+    mul-int/lit8 p1, p1, 0x8
+
+    invoke-static {p0}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
+
+    move-result-object v0
+
+    invoke-virtual {v0, p1}, Ljava/nio/ByteBuffer;->putInt(I)Ljava/nio/ByteBuffer;
+
+    move-result-object p1
+
+    invoke-virtual {p1}, Ljava/nio/ByteBuffer;->array()[B
+
+    move-result-object p1
+
+    invoke-virtual {v1, p1}, Ljavax/crypto/Mac;->update([B)V
+
+    invoke-static {p0}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
+
+    move-result-object p0
+
+    const/16 p1, 0x100
+
+    invoke-virtual {p0, p1}, Ljava/nio/ByteBuffer;->putInt(I)Ljava/nio/ByteBuffer;
+
+    move-result-object p0
+
+    invoke-virtual {p0}, Ljava/nio/ByteBuffer;->array()[B
+
+    move-result-object p0
+
+    invoke-virtual {v1, p0}, Ljavax/crypto/Mac;->update([B)V
+
+    invoke-virtual {v1}, Ljavax/crypto/Mac;->doFinal()[B
 
     move-result-object p0
 
     return-object p0
 
+    :catch_0
+    move-exception p0
+
+    new-instance p1, Ljava/lang/RuntimeException;
+
+    invoke-direct {p1, p0}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/Throwable;)V
+
+    throw p1
+
     :cond_0
     iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
 
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordManager.smali b/smali/com/android/server/locksettings/SyntheticPasswordManager.smali
index bac355cf9..99f37bc16 100644
--- a/smali/com/android/server/locksettings/SyntheticPasswordManager.smali
+++ b/smali/com/android/server/locksettings/SyntheticPasswordManager.smali
@@ -752,112 +752,6 @@
     return-object v0
 .end method
 
-.method public final checkWeaverStatus()V
-    .locals 7
-
-    const/4 v0, 0x0
-
-    const/4 v1, 0x0
-
-    :try_start_0
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
-
-    move-result-object v2
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz v2, :cond_0
-
-    const/4 v1, 0x1
-
-    goto :goto_0
-
-    :catch_0
-    move-exception v2
-
-    const-string/jumbo v3, "Unexpected exception while check weaver availability"
-
-    invoke-static {v2, v0, v3}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_0
-    :goto_0
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "Weaver is "
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    if-eqz v1, :cond_1
-
-    const-string/jumbo v3, "now"
-
-    goto :goto_1
-
-    :cond_1
-    const-string/jumbo v3, "NOT"
-
-    :goto_1
-    const-string v4, " available"
-
-    invoke-static {v2, v3, v4}, Landroid/hardware/audio/common/V2_0/AudioOffloadInfo$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v2
-
-    sget-boolean v3, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEBUG:Z
-
-    if-eqz v3, :cond_2
-
-    if-eqz v1, :cond_2
-
-    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mWeaverConfig:Landroid/hardware/weaver/WeaverConfig;
-
-    iget v1, p0, Landroid/hardware/weaver/WeaverConfig;->slots:I
-
-    iget v3, p0, Landroid/hardware/weaver/WeaverConfig;->keySize:I
-
-    iget p0, p0, Landroid/hardware/weaver/WeaverConfig;->valueSize:I
-
-    const-string v4, " with slots("
-
-    const-string v5, "), kSize("
-
-    const-string v6, ") and vSize("
-
-    invoke-static {v1, v3, v4, v5, v6}, Lcom/android/internal/util/jobs/ArrayUtils$$ExternalSyntheticOutline0;->m(IILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    move-result-object v1
-
-    const-string v3, ")"
-
-    invoke-static {p0, v1, v3}, Landroid/hardware/broadcastradio/V2_0/AmFmBandRange$$ExternalSyntheticOutline0;->m(ILjava/lang/StringBuilder;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    goto :goto_2
-
-    :cond_2
-    const-string p0, "!"
-
-    :goto_2
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v0, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-.end method
-
 .method public final createLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
     .locals 18
 
@@ -3267,83 +3161,6 @@
     return-object v6
 .end method
 
-.method public final getPendingTokenForDualDar(IJ)[B
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    invoke-virtual {v0, v1}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    const/4 p0, 0x0
-
-    return-object p0
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    invoke-virtual {v0, v1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/util/ArrayMap;
-
-    invoke-static {p2, p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v1
-
-    invoke-virtual {v0, v1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;
-
-    iget-object v0, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->aggregatedSecret:[B
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    invoke-virtual {p0, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/util/ArrayMap;
-
-    invoke-static {p2, p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object p1
-
-    invoke-virtual {p0, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->aggregatedSecret:[B
-
-    array-length p0, p0
-
-    invoke-static {v0, p0}, Ljava/util/Arrays;->copyOf([BI)[B
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public final getPendingTokensForUser(I)Ljava/util/Set;
     .locals 2
 
@@ -4848,72 +4665,6 @@
     return-object v6
 .end method
 
-.method public final removeUser(Landroid/service/gatekeeper/IGateKeeperService;I)V
-    .locals 5
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
-
-    const-string/jumbo v1, "spblob"
-
-    invoke-virtual {v0, p2, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->listSyntheticPasswordProtectorsForUser(ILjava/lang/String;)Ljava/util/List;
-
-    move-result-object v0
-
-    check-cast v0, Ljava/util/ArrayList;
-
-    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I
-
-    move-result v1
-
-    const/4 v2, 0x0
-
-    :goto_0
-    if-ge v2, v1, :cond_0
-
-    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v3
-
-    add-int/lit8 v2, v2, 0x1
-
-    check-cast v3, Ljava/lang/Long;
-
-    invoke-virtual {v3}, Ljava/lang/Long;->longValue()J
-
-    move-result-wide v3
-
-    invoke-virtual {p0, p2, v3, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyWeaverSlot(IJ)V
-
-    invoke-static {v3, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getProtectorKeyAlias(J)Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-virtual {p0, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyProtectorKey(Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_0
-    :try_start_0
-    invoke-static {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
-
-    move-result p0
-
-    invoke-interface {p1, p0}, Landroid/service/gatekeeper/IGateKeeperService;->clearSecureUserId(I)V
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-void
-
-    :catch_0
-    const-string/jumbo p0, "SyntheticPasswordManager"
-
-    const-string p1, "Failed to clear SID from gatekeeper"
-
-    invoke-static {p0, p1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-.end method
-
 .method public final savePasswordMetrics(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;JI)V
     .locals 7
 
diff --git a/smali_classes2/com/android/server/pm/ComputerEngine.smali b/smali_classes2/com/android/server/pm/ComputerEngine.smali
index dffa32888..ae9d1855d 100644
--- a/smali_classes2/com/android/server/pm/ComputerEngine.smali
+++ b/smali_classes2/com/android/server/pm/ComputerEngine.smali
@@ -17090,13 +17090,13 @@
 
     const/4 v2, 0x1
 
-    if-eqz v1, :cond_e
+    if-eqz v1, :cond_8
 
     invoke-virtual {p0, v1, p1, p2}, Lcom/android/server/pm/ComputerEngine;->shouldFilterApplication(Lcom/android/server/pm/pkg/PackageStateInternal;II)Z
 
     move-result p1
 
-    if-nez p1, :cond_e
+    if-nez p1, :cond_8
 
     invoke-interface {v1, p2}, Lcom/android/server/pm/pkg/PackageStateInternal;->getUserStateOrDefault(I)Lcom/android/server/pm/pkg/PackageUserStateInternal;
 
@@ -17108,7 +17108,7 @@
 
     if-nez p1, :cond_0
 
-    goto/16 :goto_6
+    goto :goto_2
 
     :cond_0
     iget-object p1, p0, Lcom/android/server/pm/ComputerEngine;->mService:Lcom/android/server/pm/PackageManagerService;
@@ -17117,19 +17117,19 @@
 
     const-wide/16 v5, 0x2
 
-    cmp-long v3, v3, v5
+    cmp-long p2, v3, v5
 
-    if-nez v3, :cond_2
+    if-nez p2, :cond_2
 
-    iget-object v3, p1, Lcom/android/server/pm/PackageManagerService;->mSafeModeAllowList:Ljava/util/Set;
+    iget-object p2, p1, Lcom/android/server/pm/PackageManagerService;->mSafeModeAllowList:Ljava/util/Set;
 
-    if-eqz v3, :cond_1
+    if-eqz p2, :cond_1
 
-    invoke-interface {v3}, Ljava/util/Set;->isEmpty()Z
+    invoke-interface {p2}, Ljava/util/Set;->isEmpty()Z
 
-    move-result v3
+    move-result p2
 
-    if-nez v3, :cond_1
+    if-nez p2, :cond_1
 
     iget-object p1, p1, Lcom/android/server/pm/PackageManagerService;->mSafeModeAllowList:Ljava/util/Set;
 
@@ -17163,225 +17163,57 @@
     return p0
 
     :cond_3
-    iget-object p1, p0, Lcom/android/server/pm/ComputerEngine;->mFrozenPackages:Lcom/android/server/utils/WatchedArrayMap;
+    iget-object p0, p0, Lcom/android/server/pm/ComputerEngine;->mFrozenPackages:Lcom/android/server/utils/WatchedArrayMap;
 
-    iget-object p1, p1, Lcom/android/server/utils/WatchedArrayMap;->mStorage:Landroid/util/ArrayMap;
+    iget-object p0, p0, Lcom/android/server/utils/WatchedArrayMap;->mStorage:Landroid/util/ArrayMap;
 
-    invoke-virtual {p1, p3}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z
+    invoke-virtual {p0, p3}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z
 
-    move-result p1
+    move-result p0
 
-    if-eqz p1, :cond_4
+    if-eqz p0, :cond_4
 
     const/4 p0, 0x3
 
     return p0
 
     :cond_4
-    const/4 p1, 0x0
+    const/4 p0, 0x0
 
     if-nez v0, :cond_7
 
     invoke-interface {v1}, Lcom/android/server/pm/pkg/PackageStateInternal;->getPkg()Lcom/android/internal/pm/parsing/pkg/AndroidPackageInternal;
 
-    move-result-object p4
+    move-result-object p1
 
-    invoke-interface {p4}, Lcom/android/server/pm/pkg/AndroidPackage;->isDirectBootAware()Z
+    invoke-interface {p1}, Lcom/android/server/pm/pkg/AndroidPackage;->isDirectBootAware()Z
 
-    move-result v0
+    move-result p2
 
-    if-nez v0, :cond_6
+    if-nez p2, :cond_6
 
-    invoke-interface {p4}, Lcom/android/server/pm/pkg/AndroidPackage;->isPartiallyDirectBootAware()Z
+    invoke-interface {p1}, Lcom/android/server/pm/pkg/AndroidPackage;->isPartiallyDirectBootAware()Z
 
-    move-result p4
+    move-result p1
 
-    if-eqz p4, :cond_5
+    if-eqz p1, :cond_5
 
     goto :goto_1
 
     :cond_5
-    move p4, p1
-
-    goto :goto_2
+    move v2, p0
 
     :cond_6
     :goto_1
-    move p4, v2
-
-    :goto_2
-    if-nez p4, :cond_7
+    if-nez v2, :cond_7
 
     const/4 p0, 0x4
 
-    return p0
-
     :cond_7
-    invoke-static {p2}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncrypted(I)Z
-
-    move-result p4
-
-    if-eqz p4, :cond_d
-
-    invoke-static {p2}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result p4
-
-    if-eqz p4, :cond_8
-
-    invoke-static {p2}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
-
-    move-result p4
-
-    if-nez p4, :cond_8
-
-    const-string/jumbo p0, "PackageManager"
-
-    const-string p2, "DualDAR at DO provisioning not completed"
-
-    invoke-static {p0, p2}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    return p1
-
-    :cond_8
-    iget-object p0, p0, Lcom/android/server/pm/ComputerEngine;->mContext:Landroid/content/Context;
-
-    invoke-static {p2, p3}, Lcom/android/server/pm/PersonaServiceHelper;->isSystemApp(ILjava/lang/String;)Z
-
-    move-result p4
-
-    const-string/jumbo v0, "PersonaServiceHelper"
-
-    if-eqz p4, :cond_9
-
-    const-string/jumbo p0, "system app allowed - "
-
-    invoke-static {p0, p3, v0}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_5
-
-    :cond_9
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARPolicyService()Ljava/util/Optional;
-
-    move-result-object p4
-
-    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;
-
-    const/4 v3, 0x2
-
-    invoke-direct {v1, p2, v3}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;-><init>(II)V
-
-    invoke-virtual {p4, v1}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p4
-
-    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;
-
-    const/4 v3, 0x1
-
-    invoke-direct {v1, p2, v3}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;-><init>(II)V
-
-    invoke-virtual {p4, v1}, Ljava/util/Optional;->orElseGet(Ljava/util/function/Supplier;)Ljava/lang/Object;
-
-    move-result-object p4
-
-    check-cast p4, Landroid/os/Bundle;
-
-    if-eqz p4, :cond_c
-
-    new-instance v1, Ljava/util/ArrayList;
-
-    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V
-
-    const-string/jumbo v3, "dualdar-config-datalock-whitelistpackages"
-
-    invoke-virtual {p4, v3}, Landroid/os/Bundle;->getParcelableArray(Ljava/lang/String;)[Landroid/os/Parcelable;
-
-    move-result-object p4
-
-    array-length v3, p4
-
-    move v4, p1
-
-    :goto_3
-    if-ge v4, v3, :cond_a
-
-    aget-object v5, p4, v4
-
-    check-cast v5, Lcom/samsung/android/knox/AppIdentity;
-
-    invoke-virtual {v1, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    add-int/lit8 v4, v4, 0x1
-
-    goto :goto_3
-
-    :cond_a
-    :try_start_0
-    invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
-
-    move-result-object p4
-
-    const-wide/16 v3, 0x80
-
-    invoke-interface {p4, p3, v3, v4, p2}, Landroid/content/pm/IPackageManager;->getApplicationInfo(Ljava/lang/String;JI)Landroid/content/pm/ApplicationInfo;
-
-    move-result-object p4
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_4
-
-    :catch_0
-    move-exception p4
-
-    invoke-virtual {p4}, Landroid/os/RemoteException;->printStackTrace()V
-
-    const/4 p4, 0x0
-
-    :goto_4
-    if-eqz p4, :cond_c
-
-    invoke-virtual {p4}, Landroid/content/pm/ApplicationInfo;->isDirectBootAware()Z
-
-    move-result v3
-
-    if-nez v3, :cond_b
-
-    invoke-virtual {p4}, Landroid/content/pm/ApplicationInfo;->isPartiallyDirectBootAware()Z
-
-    move-result p4
-
-    if-eqz p4, :cond_c
-
-    :cond_b
-    invoke-static {p0, p2, p3, v1}, Lcom/android/server/pm/PersonaServiceHelper;->verifyPackageForDualDAR(Landroid/content/Context;ILjava/lang/String;Ljava/util/List;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_c
-
-    const-string/jumbo p0, "checkPackageStartable direct boot aware and whitelisted allowed: "
-
-    invoke-static {p0, p3, v0}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_5
-
-    :cond_c
-    move v2, p1
-
-    :goto_5
-    if-nez v2, :cond_d
-
-    const/4 p0, 0x5
-
     return p0
 
-    :cond_d
-    return p1
-
-    :cond_e
-    :goto_6
+    :cond_8
+    :goto_2
     return v2
 .end method
 
diff --git a/smali_classes2/com/android/server/pm/PersonaManagerService$2.smali b/smali_classes2/com/android/server/pm/PersonaManagerService$2.smali
index aed628364..edee41442 100644
--- a/smali_classes2/com/android/server/pm/PersonaManagerService$2.smali
+++ b/smali_classes2/com/android/server/pm/PersonaManagerService$2.smali
@@ -1816,7 +1816,7 @@
 
     invoke-static {p0, p1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
 
-    goto/16 :goto_19
+    goto/16 :goto_1b
 
     :cond_2a
     const-string/jumbo v1, "android.intent.action.MANAGED_PROFILE_REMOVED"
@@ -1950,7 +1950,7 @@
 
     move-result p0
 
-    if-eqz p0, :cond_3c
+    if-eqz p0, :cond_3f
 
     const-string/jumbo p0, "PersonaManagerService"
 
@@ -1964,7 +1964,7 @@
 
     invoke-static {p0, p1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
 
-    goto/16 :goto_19
+    goto/16 :goto_1b
 
     :catchall_0
     move-exception p0
@@ -2074,7 +2074,7 @@
 
     move-result-object p1
 
-    if-eqz p1, :cond_3c
+    if-eqz p1, :cond_3f
 
     const-string p2, ""
 
@@ -2082,7 +2082,7 @@
 
     move-result p1
 
-    if-nez p1, :cond_3c
+    if-nez p1, :cond_3f
 
     :try_start_b
     new-instance p1, Ljava/text/SimpleDateFormat;
@@ -2132,7 +2132,7 @@
 
     invoke-static {p1, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto/16 :goto_19
+    goto/16 :goto_1b
 
     :catch_7
     move-exception p1
@@ -2183,7 +2183,7 @@
 
     invoke-virtual {p0, p1, p2}, Landroid/content/Context;->sendBroadcastAsUser(Landroid/content/Intent;Landroid/os/UserHandle;)V
 
-    goto/16 :goto_19
+    goto/16 :goto_1b
 
     :goto_16
     invoke-virtual {p1}, Ljava/lang/Exception;->printStackTrace()V
@@ -2194,7 +2194,7 @@
 
     invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto/16 :goto_19
+    goto/16 :goto_1b
 
     :cond_32
     const-string/jumbo v1, "android.intent.action.SCREEN_OFF"
@@ -2222,7 +2222,7 @@
 
     move-result p2
 
-    if-ge v3, p2, :cond_3c
+    if-ge v3, p2, :cond_3f
 
     invoke-interface {p1, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
@@ -2305,7 +2305,7 @@
 
     monitor-exit v1
 
-    goto/16 :goto_19
+    goto/16 :goto_1b
 
     :catchall_2
     move-exception p0
@@ -2342,7 +2342,7 @@
 
     monitor-exit v0
 
-    goto/16 :goto_19
+    goto/16 :goto_1b
 
     :catchall_3
     move-exception p0
@@ -2360,7 +2360,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_39
+    if-eqz v0, :cond_3c
 
     invoke-static {v3}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
 
@@ -2401,90 +2401,193 @@
 
     iget-object p0, p0, Lcom/android/server/pm/PersonaManagerService$2;->this$0:Lcom/android/server/pm/PersonaManagerService;
 
+    const-string/jumbo p1, "PersonaManagerService"
+
+    :try_start_e
     invoke-static {v3}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
 
-    move-result p1
+    move-result p2
 
-    if-eqz p1, :cond_3c
+    if-eqz p2, :cond_3f
 
     invoke-virtual {p0, v3, v3}, Lcom/android/server/pm/PersonaManagerService;->getProfiles(IZ)Ljava/util/List;
 
-    move-result-object p1
+    move-result-object p2
+
+    move v0, v3
 
     :goto_18
-    move-object p2, p1
+    move-object v1, p2
 
-    check-cast p2, Ljava/util/ArrayList;
+    check-cast v1, Ljava/util/ArrayList;
 
-    invoke-virtual {p2}, Ljava/util/ArrayList;->size()I
+    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I
 
-    move-result v0
+    move-result v2
 
-    if-ge v3, v0, :cond_3c
+    if-ge v0, v2, :cond_3f
 
-    invoke-virtual {p2, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
-    move-result-object p2
+    move-result-object v1
 
-    check-cast p2, Landroid/content/pm/UserInfo;
+    check-cast v1, Landroid/content/pm/UserInfo;
 
-    iget-object v0, p0, Lcom/android/server/pm/PersonaManagerService;->mLocalService:Lcom/android/server/pm/PersonaManagerService$LocalService;
+    iget-object v2, p0, Lcom/android/server/pm/PersonaManagerService;->mLocalService:Lcom/android/server/pm/PersonaManagerService$LocalService;
 
-    iget v1, p2, Landroid/content/pm/UserInfo;->id:I
+    iget v5, v1, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v1}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
+    invoke-static {v5}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
 
-    move-result v0
+    move-result v2
 
-    if-eqz v0, :cond_38
+    if-eqz v2, :cond_3b
 
-    new-instance v0, Ljava/lang/StringBuilder;
+    new-instance v2, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v1, "device owner changed. but managed profile is exists. SA case. remove u"
+    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    const-string/jumbo v5, "device owner changed. but managed profile is exists. SA case. remove u"
 
-    iget v1, p2, Landroid/content/pm/UserInfo;->id:I
+    invoke-virtual {v2, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    iget v5, v1, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v2, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    move-result-object v0
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    const-string/jumbo v1, "PersonaManagerService"
+    move-result-object v2
 
-    invoke-static {v1, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {p1, v2}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {p0}, Lcom/android/server/pm/PersonaManagerService;->getUserManager()Landroid/os/UserManager;
+    invoke-static {}, Lcom/android/server/pm/PersonaManagerService;->getDeviceOwnerPackage()Ljava/lang/String;
 
-    move-result-object v0
+    move-result-object v2
 
-    iget p2, p2, Landroid/content/pm/UserInfo;->id:I
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    :try_end_e
+    .catch Ljava/lang/Exception; {:try_start_e .. :try_end_e} :catch_9
 
-    invoke-virtual {v0, p2}, Landroid/os/UserManager;->removeUser(I)Z
+    :try_start_f
+    invoke-virtual {p0}, Lcom/android/server/pm/PersonaManagerService;->getIPackageManager()Landroid/content/pm/IPackageManager;
+
+    move-result-object v5
+
+    const-wide/32 v6, 0xc0000
+
+    invoke-interface {v5, v2, v6, v7, v3}, Landroid/content/pm/IPackageManager;->getApplicationInfo(Ljava/lang/String;JI)Landroid/content/pm/ApplicationInfo;
+
+    move-result-object v5
+    :try_end_f
+    .catch Landroid/os/RemoteException; {:try_start_f .. :try_end_f} :catch_8
+    .catch Ljava/lang/Exception; {:try_start_f .. :try_end_f} :catch_9
+
+    if-eqz v5, :cond_3a
+
+    :try_start_10
+    iget v2, v5, Landroid/content/pm/ApplicationInfo;->flags:I
+
+    and-int/lit16 v2, v2, 0x100
+
+    if-eqz v2, :cond_38
+
+    move v2, v4
+
+    goto :goto_19
 
     :cond_38
-    add-int/2addr v3, v4
+    move v2, v3
+
+    :goto_19
+    if-eqz v2, :cond_39
+
+    new-instance p0, Ljava/lang/StringBuilder;
+
+    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string/jumbo p2, "test only admin. do not remove u"
+
+    invoke-virtual {p0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    iget p2, v1, Landroid/content/pm/UserInfo;->id:I
 
-    goto :goto_18
+    invoke-virtual {p0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object p0
+
+    invoke-static {p1, p0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+
+    goto/16 :goto_1b
 
     :cond_39
+    invoke-virtual {p0}, Lcom/android/server/pm/PersonaManagerService;->getUserManager()Landroid/os/UserManager;
+
+    move-result-object v2
+
+    iget v1, v1, Landroid/content/pm/UserInfo;->id:I
+
+    invoke-virtual {v2, v1}, Landroid/os/UserManager;->removeUser(I)Z
+
+    goto :goto_1a
+
+    :cond_3a
+    new-instance p0, Ljava/lang/IllegalStateException;
+
+    const-string p1, "Couldn\'t find package: "
+
+    const-string p2, " on user 0"
+
+    invoke-static {p1, v2, p2}, Lcom/android/internal/util/jobs/XmlUtils$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
+
+    move-result-object p1
+
+    invoke-direct {p0, p1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
+
+    throw p0
+
+    :catch_8
+    move-exception p0
+
+    new-instance p1, Ljava/lang/IllegalStateException;
+
+    invoke-direct {p1, p0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/Throwable;)V
+
+    throw p1
+    :try_end_10
+    .catch Ljava/lang/Exception; {:try_start_10 .. :try_end_10} :catch_9
+
+    :cond_3b
+    :goto_1a
+    add-int/2addr v0, v4
+
+    goto/16 :goto_18
+
+    :catch_9
+    move-exception p0
+
+    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
+
+    goto :goto_1b
+
+    :cond_3c
     const-string/jumbo p0, "android.intent.action.MANAGED_PROFILE_AVAILABLE"
 
     invoke-virtual {p0, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result p0
 
-    if-eqz p0, :cond_3a
+    if-eqz p0, :cond_3d
 
     invoke-static {v7}, Lcom/samsung/android/knox/SemPersonaManager;->isSecureFolderId(I)Z
 
     move-result p0
 
-    if-eqz p0, :cond_3c
+    if-eqz p0, :cond_3f
 
     const-string/jumbo p0, "PersonaManagerService"
 
@@ -2498,22 +2601,22 @@
 
     invoke-static {p0, p1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
 
-    goto :goto_19
+    goto :goto_1b
 
-    :cond_3a
+    :cond_3d
     const-string/jumbo p0, "android.intent.action.MANAGED_PROFILE_UNAVAILABLE"
 
     invoke-virtual {p0, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result p0
 
-    if-eqz p0, :cond_3c
+    if-eqz p0, :cond_3f
 
     invoke-static {v7}, Lcom/samsung/android/knox/SemPersonaManager;->isSecureFolderId(I)Z
 
     move-result p0
 
-    if-eqz p0, :cond_3b
+    if-eqz p0, :cond_3e
 
     const-string/jumbo p0, "PersonaManagerService"
 
@@ -2527,14 +2630,14 @@
 
     invoke-static {p0, p1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
 
-    goto :goto_19
+    goto :goto_1b
 
-    :cond_3b
+    :cond_3e
     invoke-static {v7}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
 
     move-result p0
 
-    if-eqz p0, :cond_3c
+    if-eqz p0, :cond_3f
 
     const-string/jumbo p0, "PersonaManagerService"
 
@@ -2550,14 +2653,14 @@
 
     check-cast p0, Lcom/android/server/wm/ActivityTaskManagerService;
 
-    if-eqz p0, :cond_3c
+    if-eqz p0, :cond_3f
 
     iget-object p0, p0, Lcom/android/server/wm/ActivityTaskManagerService;->mExt:Lcom/android/server/wm/ActivityTaskManagerServiceExt;
 
     invoke-virtual {p0}, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->removeTaskByCmpName()V
 
-    :cond_3c
-    :goto_19
+    :cond_3f
+    :goto_1b
     return-void
 
     nop
diff --git a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0.smali b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0.smali
deleted file mode 100644
index baad3c5ab..000000000
--- a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0.smali
+++ /dev/null
@@ -1,169 +0,0 @@
-.class public final synthetic Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:I
-
-
-# direct methods
-.method public synthetic constructor <init>(II)V
-    .locals 0
-
-    iput p2, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;->$r8$classId:I
-
-    iput p1, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;->f$0:I
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 3
-
-    const/4 v0, 0x0
-
-    iget v1, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;->$r8$classId:I
-
-    iget p0, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;->f$0:I
-
-    check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    packed-switch v1, :pswitch_data_0
-
-    sget-object v1, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
-
-    :try_start_0
-    new-instance v1, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v2
-
-    invoke-direct {v1, v2, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
-
-    invoke-interface {p1, v1}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
-
-    move-result-object v0
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
-
-    :goto_0
-    return-object v0
-
-    :pswitch_0
-    sget-object v1, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
-
-    :try_start_1
-    new-instance v1, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v2
-
-    invoke-direct {v1, v2, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
-
-    invoke-interface {p1, v1}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
-
-    move-result-object v0
-    :try_end_1
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1
-
-    goto :goto_1
-
-    :catch_1
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
-
-    :goto_1
-    return-object v0
-
-    :pswitch_1
-    sget-object v1, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
-
-    :try_start_2
-    new-instance v1, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v2
-
-    invoke-direct {v1, v2, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
-
-    invoke-interface {p1, v1}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
-
-    move-result-object v0
-    :try_end_2
-    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_2
-
-    goto :goto_2
-
-    :catch_2
-    move-exception p0
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "isDERestrictionEnforced exception "
-
-    invoke-direct {p1, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->getMessage()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string/jumbo p1, "PersonaServiceHelper"
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_2
-    if-eqz v0, :cond_0
-
-    const-string/jumbo p0, "dualdar-config-de-restriction"
-
-    const/4 p1, 0x1
-
-    invoke-virtual {v0, p0, p1}, Landroid/os/Bundle;->getBoolean(Ljava/lang/String;Z)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    goto :goto_3
-
-    :cond_0
-    sget-object p0, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    :goto_3
-    return-object p0
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_1
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2.smali b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2.smali
deleted file mode 100644
index be8f6e173..000000000
--- a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2.smali
+++ /dev/null
@@ -1,62 +0,0 @@
-.class public final synthetic Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Supplier;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:I
-
-
-# direct methods
-.method public synthetic constructor <init>(II)V
-    .locals 0
-
-    iput p2, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;->$r8$classId:I
-
-    iput p1, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;->f$0:I
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final get()Ljava/lang/Object;
-    .locals 4
-
-    const/4 v0, 0x0
-
-    const-string/jumbo v1, "PersonaServiceHelper"
-
-    const-string/jumbo v2, "checkPackageStartable failed to acquire dualDARPolicy for user: "
-
-    iget v3, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;->$r8$classId:I
-
-    iget p0, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;->f$0:I
-
-    packed-switch v3, :pswitch_data_0
-
-    sget-object v3, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
-
-    invoke-static {p0, v2, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-object v0
-
-    :pswitch_0
-    sget-object v3, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
-
-    invoke-static {p0, v2, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-object v0
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3.smali b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3.smali
deleted file mode 100644
index ab47c5e19..000000000
--- a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3.smali
+++ /dev/null
@@ -1,44 +0,0 @@
-.class public final synthetic Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 2
-
-    check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    sget-object p0, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
-
-    :try_start_0
-    new-instance p0, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    invoke-direct {p0, v0, v1}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
-
-    invoke-interface {p1, p0}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
-
-    move-result-object p0
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-object p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
-
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
diff --git a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4.smali b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4.smali
deleted file mode 100644
index ca737f39c..000000000
--- a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4.smali
+++ /dev/null
@@ -1,24 +0,0 @@
-.class public final synthetic Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Supplier;
-
-
-# virtual methods
-.method public final get()Ljava/lang/Object;
-    .locals 1
-
-    sget-object p0, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
-
-    const-string/jumbo p0, "checkPackageStartable failed to acquire dualDARPolicy for user: 0"
-
-    const-string/jumbo v0, "PersonaServiceHelper"
-
-    invoke-static {v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
diff --git a/smali_classes2/com/android/server/pm/PersonaServiceHelper.smali b/smali_classes2/com/android/server/pm/PersonaServiceHelper.smali
index 23bc06cbb..36fd72ea9 100644
--- a/smali_classes2/com/android/server/pm/PersonaServiceHelper.smali
+++ b/smali_classes2/com/android/server/pm/PersonaServiceHelper.smali
@@ -10,8 +10,6 @@
 
 .field public static mApplicationPolicyService:Lcom/samsung/android/knox/application/IApplicationPolicy;
 
-.field public static mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
 .field public static mPersonaManager:Lcom/android/server/pm/PersonaManagerService;
 
 .field public static mUserManager:Lcom/android/server/pm/UserManagerService;
@@ -55,8 +53,6 @@
 
     sput-object v0, Lcom/android/server/pm/PersonaServiceHelper;->mPersonaManager:Lcom/android/server/pm/PersonaManagerService;
 
-    sput-object v0, Lcom/android/server/pm/PersonaServiceHelper;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
     sput-object v0, Lcom/android/server/pm/PersonaServiceHelper;->mUserManager:Lcom/android/server/pm/UserManagerService;
 
     new-instance v0, Lcom/android/server/pm/PersonaServiceHelper$1;
@@ -409,35 +405,6 @@
     return-object v0
 .end method
 
-.method public static getDualDARPolicyService()Ljava/util/Optional;
-    .locals 1
-
-    sget-object v0, Lcom/android/server/pm/PersonaServiceHelper;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    if-nez v0, :cond_0
-
-    const-string v0, "DualDARPolicy"
-
-    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/samsung/android/knox/ddar/IDualDARPolicy$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    move-result-object v0
-
-    sput-object v0, Lcom/android/server/pm/PersonaServiceHelper;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    :cond_0
-    sget-object v0, Lcom/android/server/pm/PersonaServiceHelper;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    invoke-static {v0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object v0
-
-    return-object v0
-.end method
-
 .method public static getDualDARType(I)I
     .locals 2
 
@@ -480,58 +447,6 @@
     return v0
 .end method
 
-.method public static getDualDARUser()I
-    .locals 5
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getUserManager()Lcom/android/server/pm/UserManagerService;
-
-    move-result-object v0
-
-    const/4 v1, 0x1
-
-    const/4 v2, 0x0
-
-    invoke-virtual {v0, v1, v2, v1}, Lcom/android/server/pm/UserManagerService;->getUsers(ZZZ)Ljava/util/List;
-
-    move-result-object v0
-
-    check-cast v0, Ljava/util/ArrayList;
-
-    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I
-
-    move-result v1
-
-    :cond_0
-    if-ge v2, v1, :cond_1
-
-    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v3
-
-    add-int/lit8 v2, v2, 0x1
-
-    check-cast v3, Landroid/content/pm/UserInfo;
-
-    if-eqz v3, :cond_0
-
-    iget v4, v3, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-static {v4}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_0
-
-    iget v0, v3, Landroid/content/pm/UserInfo;->id:I
-
-    return v0
-
-    :cond_1
-    const/4 v0, -0x1
-
-    return v0
-.end method
-
 .method public static getPersonaManager()Lcom/android/server/pm/PersonaManagerService;
     .locals 1
 
@@ -842,151 +757,6 @@
     return v2
 .end method
 
-.method public static isDualDAREnabled()Z
-    .locals 6
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getUserManager()Lcom/android/server/pm/UserManagerService;
-
-    move-result-object v0
-
-    const/4 v1, 0x1
-
-    const/4 v2, 0x0
-
-    invoke-virtual {v0, v1, v2, v1}, Lcom/android/server/pm/UserManagerService;->getUsers(ZZZ)Ljava/util/List;
-
-    move-result-object v0
-
-    check-cast v0, Ljava/util/ArrayList;
-
-    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I
-
-    move-result v3
-
-    move v4, v2
-
-    :cond_0
-    if-ge v4, v3, :cond_1
-
-    invoke-virtual {v0, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v5
-
-    add-int/lit8 v4, v4, 0x1
-
-    check-cast v5, Landroid/content/pm/UserInfo;
-
-    if-eqz v5, :cond_0
-
-    iget v5, v5, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-static {v5}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v5
-
-    if-eqz v5, :cond_0
-
-    goto :goto_0
-
-    :cond_1
-    move v1, v2
-
-    :goto_0
-    const-string/jumbo v0, "isDualDAREnabled result : "
-
-    const-string/jumbo v2, "PersonaServiceHelper"
-
-    invoke-static {v0, v2, v1}, Lcom/android/server/accessibility/AccessibilityManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Z)V
-
-    return v1
-.end method
-
-.method public static isPackageAllowlistedForDEAccessForDualDAR(Landroid/content/Context;Ljava/lang/String;I)Z
-    .locals 5
-
-    invoke-static {p2, p1}, Lcom/android/server/pm/PersonaServiceHelper;->isSystemApp(ILjava/lang/String;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    const-string/jumbo p0, "system app allowed - "
-
-    const-string/jumbo p2, "PersonaServiceHelper"
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARPolicyService()Ljava/util/Optional;
-
-    move-result-object v0
-
-    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;
-
-    const/4 v2, 0x1
-
-    invoke-direct {v1, p2, v2}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;-><init>(II)V
-
-    invoke-virtual {v0, v1}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object v0
-
-    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;
-
-    const/4 v2, 0x0
-
-    invoke-direct {v1, p2, v2}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;-><init>(II)V
-
-    invoke-virtual {v0, v1}, Ljava/util/Optional;->orElseGet(Ljava/util/function/Supplier;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/os/Bundle;
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_2
-
-    new-instance v2, Ljava/util/ArrayList;
-
-    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V
-
-    const-string/jumbo v3, "dualdar-config-datalock-whitelistpackages"
-
-    invoke-virtual {v0, v3}, Landroid/os/Bundle;->getParcelableArray(Ljava/lang/String;)[Landroid/os/Parcelable;
-
-    move-result-object v0
-
-    array-length v3, v0
-
-    :goto_0
-    if-ge v1, v3, :cond_1
-
-    aget-object v4, v0, v1
-
-    check-cast v4, Lcom/samsung/android/knox/AppIdentity;
-
-    invoke-virtual {v2, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    add-int/lit8 v1, v1, 0x1
-
-    goto :goto_0
-
-    :cond_1
-    invoke-static {p0, p2, p1, v2}, Lcom/android/server/pm/PersonaServiceHelper;->verifyPackageForDualDAR(Landroid/content/Context;ILjava/lang/String;Ljava/util/List;)Z
-
-    move-result p0
-
-    return p0
-
-    :cond_2
-    return v1
-.end method
-
 .method public static isRequiredAppForKnox(Lcom/android/server/pm/PackageSetting;I)Z
     .locals 4
 
@@ -1055,72 +825,6 @@
     return v1
 .end method
 
-.method public static isSystemApp(ILjava/lang/String;)Z
-    .locals 4
-
-    const/4 v0, 0x0
-
-    :try_start_0
-    invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
-
-    move-result-object v1
-
-    const-wide/16 v2, 0x80
-
-    invoke-interface {v1, p1, v2, v3, p0}, Landroid/content/pm/IPackageManager;->getApplicationInfo(Ljava/lang/String;JI)Landroid/content/pm/ApplicationInfo;
-
-    move-result-object v1
-
-    if-nez v1, :cond_0
-
-    return v0
-
-    :cond_0
-    iget p0, v1, Landroid/content/pm/ApplicationInfo;->flags:I
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    and-int/lit16 p0, p0, 0x81
-
-    if-eqz p0, :cond_1
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_1
-    return v0
-
-    :catch_0
-    move-exception v1
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "Unable to check is System App for: "
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string p1, " in user: "
-
-    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string/jumbo p1, "PersonaServiceHelper"
-
-    invoke-static {p1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V
-
-    return v0
-.end method
-
 .method public static shouldBlockBluetooth(Landroid/content/Context;I)Z
     .locals 4
 
@@ -1444,279 +1148,3 @@
     :cond_2
     return v1
 .end method
-
-.method public static verifyPackageForDualDAR(Landroid/content/Context;ILjava/lang/String;Ljava/util/List;)Z
-    .locals 11
-
-    const-string/jumbo v0, "verifyPackageForDualDAR package: "
-
-    const-string/jumbo v1, "PersonaServiceHelper"
-
-    invoke-static {v0, p2, v1}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    check-cast p3, Ljava/util/ArrayList;
-
-    invoke-virtual {p3}, Ljava/util/ArrayList;->size()I
-
-    move-result v0
-
-    const/4 v2, 0x0
-
-    move v3, v2
-
-    :cond_0
-    const/4 v4, 0x0
-
-    if-ge v3, v0, :cond_1
-
-    invoke-virtual {p3, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v5
-
-    add-int/lit8 v3, v3, 0x1
-
-    check-cast v5, Lcom/samsung/android/knox/AppIdentity;
-
-    invoke-virtual {v5}, Lcom/samsung/android/knox/AppIdentity;->getPackageName()Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-virtual {p2, v6}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I
-
-    move-result v6
-
-    if-nez v6, :cond_0
-
-    goto :goto_0
-
-    :cond_1
-    move-object v5, v4
-
-    :goto_0
-    if-nez v5, :cond_2
-
-    const-string/jumbo p0, "Package not whitelisted: "
-
-    invoke-static {p0, p2, v1}, Lcom/android/server/StorageManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    return v2
-
-    :cond_2
-    invoke-virtual {v5}, Lcom/samsung/android/knox/AppIdentity;->getSignature()Ljava/lang/String;
-
-    move-result-object p2
-
-    const/4 p3, 0x1
-
-    if-eqz p2, :cond_9
-
-    invoke-virtual {v5}, Lcom/samsung/android/knox/AppIdentity;->getSignature()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-virtual {p2}, Ljava/lang/String;->length()I
-
-    move-result p2
-
-    if-lez p2, :cond_9
-
-    invoke-virtual {v5}, Lcom/samsung/android/knox/AppIdentity;->getPackageName()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-virtual {v5}, Lcom/samsung/android/knox/AppIdentity;->getSignature()Ljava/lang/String;
-
-    move-result-object v0
-
-    if-eqz v0, :cond_8
-
-    if-eqz p2, :cond_8
-
-    if-nez p1, :cond_3
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v3
-
-    if-nez v3, :cond_3
-
-    goto/16 :goto_8
-
-    :cond_3
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v5
-
-    :try_start_0
-    invoke-virtual {p0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
-
-    move-result-object p0
-
-    const/high16 v3, 0x8000000
-
-    invoke-virtual {p0, p2, v3, p1}, Landroid/content/pm/PackageManager;->getPackageInfoAsUser(Ljava/lang/String;II)Landroid/content/pm/PackageInfo;
-
-    move-result-object p0
-    :try_end_0
-    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception p0
-
-    goto/16 :goto_7
-
-    :catch_0
-    move-exception p0
-
-    :try_start_1
-    invoke-virtual {p0}, Landroid/content/pm/PackageManager$NameNotFoundException;->printStackTrace()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    move-object p0, v4
-
-    :goto_1
-    if-eqz p0, :cond_7
-
-    iget-object p0, p0, Landroid/content/pm/PackageInfo;->signingInfo:Landroid/content/pm/SigningInfo;
-
-    if-eqz p0, :cond_7
-
-    invoke-virtual {p0}, Landroid/content/pm/SigningInfo;->getApkContentsSigners()[Landroid/content/pm/Signature;
-
-    move-result-object p0
-
-    array-length p1, p0
-
-    move p2, v2
-
-    :goto_2
-    if-ge p2, p1, :cond_7
-
-    aget-object v3, p0, p2
-
-    if-eqz v3, :cond_6
-
-    invoke-virtual {v3}, Landroid/content/pm/Signature;->toByteArray()[B
-
-    move-result-object v5
-
-    :try_start_2
-    const-string/jumbo v6, "SHA256"
-
-    invoke-static {v6}, Ljava/security/MessageDigest;->getInstance(Ljava/lang/String;)Ljava/security/MessageDigest;
-
-    move-result-object v6
-    :try_end_2
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_2 .. :try_end_2} :catch_1
-
-    invoke-virtual {v6, v5}, Ljava/security/MessageDigest;->update([B)V
-
-    invoke-virtual {v6}, Ljava/security/MessageDigest;->digest()[B
-
-    move-result-object v5
-
-    goto :goto_3
-
-    :catch_1
-    move-object v5, v4
-
-    :goto_3
-    new-instance v6, Ljava/lang/StringBuffer;
-
-    invoke-direct {v6}, Ljava/lang/StringBuffer;-><init>()V
-
-    array-length v7, v5
-
-    move v8, v2
-
-    :goto_4
-    if-ge v8, v7, :cond_4
-
-    aget-byte v9, v5, v8
-
-    and-int/lit16 v9, v9, 0xff
-
-    add-int/lit16 v9, v9, 0x100
-
-    const/16 v10, 0x10
-
-    invoke-static {v9, v10}, Ljava/lang/Integer;->toString(II)Ljava/lang/String;
-
-    move-result-object v9
-
-    invoke-virtual {v9, p3}, Ljava/lang/String;->substring(I)Ljava/lang/String;
-
-    move-result-object v9
-
-    invoke-virtual {v6, v9}, Ljava/lang/StringBuffer;->append(Ljava/lang/String;)Ljava/lang/StringBuffer;
-
-    add-int/lit8 v8, v8, 0x1
-
-    goto :goto_4
-
-    :cond_4
-    invoke-virtual {v6}, Ljava/lang/StringBuffer;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-virtual {v0, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v5
-
-    if-eqz v5, :cond_5
-
-    :goto_5
-    move v2, p3
-
-    goto :goto_6
-
-    :cond_5
-    invoke-virtual {v3}, Landroid/content/pm/Signature;->toCharsString()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-virtual {v0, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_6
-
-    goto :goto_5
-
-    :cond_6
-    add-int/lit8 p2, p2, 0x1
-
-    goto :goto_2
-
-    :cond_7
-    const-string p0, "FAIL to verify Pkg Signature"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_6
-    return v2
-
-    :goto_7
-    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-
-    :cond_8
-    :goto_8
-    const-string p0, "Invalid arguments"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v2
-
-    :cond_9
-    return p3
-.end method
diff --git a/smali_classes2/com/android/server/pm/UserManagerInternal.smali b/smali_classes2/com/android/server/pm/UserManagerInternal.smali
index 94ff5010c..1dd5ef6d7 100644
--- a/smali_classes2/com/android/server/pm/UserManagerInternal.smali
+++ b/smali_classes2/com/android/server/pm/UserManagerInternal.smali
@@ -205,9 +205,6 @@
 .method public abstract setDevicePolicyUserRestrictions(Landroid/os/Bundle;Lcom/android/server/pm/RestrictionsSet;)V
 .end method
 
-.method public abstract setDualDarInfo(II)Z
-.end method
-
 .method public abstract setForceEphemeralUsers(Z)V
 .end method
 
diff --git a/smali_classes2/com/android/server/pm/UserManagerService$LocalService.smali b/smali_classes2/com/android/server/pm/UserManagerService$LocalService.smali
index dc198ae8e..01a829d7e 100644
--- a/smali_classes2/com/android/server/pm/UserManagerService$LocalService.smali
+++ b/smali_classes2/com/android/server/pm/UserManagerService$LocalService.smali
@@ -1947,15 +1947,6 @@
 .method public final isUserUnlocked(I)Z
     .locals 1
 
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncrypted(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
     iget-object v0, p0, Lcom/android/server/pm/UserManagerService$LocalService;->this$0:Lcom/android/server/pm/UserManagerService;
 
     iget-object v0, v0, Lcom/android/server/pm/UserManagerService;->mUserStates:Lcom/android/server/pm/UserManagerService$WatchedUserStates;
@@ -1977,31 +1968,30 @@
 
     const/4 v0, 0x4
 
-    if-eq p0, v0, :cond_3
+    if-eq p0, v0, :cond_2
 
     const/4 v0, 0x5
 
-    if-ne p0, v0, :cond_1
+    if-ne p0, v0, :cond_0
 
-    goto :goto_1
+    goto :goto_0
 
-    :cond_1
+    :cond_0
     const/4 p1, 0x3
 
-    if-ne p0, p1, :cond_2
+    if-ne p0, p1, :cond_1
 
     const/4 p0, 0x1
 
     return p0
 
-    :cond_2
-    :goto_0
+    :cond_1
     const/4 p0, 0x0
 
     return p0
 
-    :cond_3
-    :goto_1
+    :cond_2
+    :goto_0
     invoke-static {p1}, Landroid/os/storage/StorageManager;->isCeStorageUnlocked(I)Z
 
     move-result p0
@@ -2630,123 +2620,6 @@
     throw p0
 .end method
 
-.method public final setDualDarInfo(II)Z
-    .locals 6
-
-    const-string/jumbo v0, "Set DUAL_DAR flag as samsung crypto for user "
-
-    const-string/jumbo v1, "Set DUAL_DAR flag as custom crypto for user "
-
-    iget-object v2, p0, Lcom/android/server/pm/UserManagerService$LocalService;->this$0:Lcom/android/server/pm/UserManagerService;
-
-    iget-object v2, v2, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
-
-    monitor-enter v2
-
-    :try_start_0
-    iget-object v3, p0, Lcom/android/server/pm/UserManagerService$LocalService;->this$0:Lcom/android/server/pm/UserManagerService;
-
-    iget-object v3, v3, Lcom/android/server/pm/UserManagerService;->mUsers:Landroid/util/SparseArray;
-
-    invoke-virtual {v3, p1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/android/server/pm/UserManagerService$UserData;
-
-    const/4 v4, 0x0
-
-    if-eqz v3, :cond_2
-
-    const/high16 v5, 0x6000000
-
-    and-int/2addr v5, p2
-
-    if-eqz v5, :cond_2
-
-    const/high16 v5, 0x4000000
-
-    and-int/2addr v5, p2
-
-    if-eqz v5, :cond_0
-
-    const-string/jumbo v0, "UserManagerService"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    const/high16 v1, 0x2000000
-
-    and-int/2addr v1, p2
-
-    if-eqz v1, :cond_1
-
-    const-string/jumbo v1, "UserManagerService"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v1, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_0
-
-    :cond_1
-    move p2, v4
-
-    :goto_0
-    if-eqz p2, :cond_2
-
-    iget-object p1, v3, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
-
-    iget v0, p1, Landroid/content/pm/UserInfo;->flags:I
-
-    or-int/2addr p2, v0
-
-    iput p2, p1, Landroid/content/pm/UserInfo;->flags:I
-
-    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$LocalService;->this$0:Lcom/android/server/pm/UserManagerService;
-
-    invoke-virtual {p0, v3}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
-
-    const/4 v4, 0x1
-
-    :cond_2
-    monitor-exit v2
-
-    return v4
-
-    :goto_1
-    monitor-exit v2
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
 .method public final setForceEphemeralUsers(Z)V
     .locals 1
 
diff --git a/smali_classes2/com/android/server/pm/UserManagerService.smali b/smali_classes2/com/android/server/pm/UserManagerService.smali
index a92241e28..0778d27b8 100644
--- a/smali_classes2/com/android/server/pm/UserManagerService.smali
+++ b/smali_classes2/com/android/server/pm/UserManagerService.smali
@@ -2911,45 +2911,6 @@
     return-void
 .end method
 
-.method public static setResetTokenForSecureFolder(Landroid/content/pm/UserInfo;)V
-    .locals 4
-
-    const-string/jumbo v0, "dar"
-
-    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v0, :cond_0
-
-    iget p0, p0, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-virtual {v0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
-
-    iget-object v1, v0, Lcom/android/server/knox/dar/DarManagerService;->mDarHandler:Lcom/android/server/knox/dar/DarManagerService$DarHandler;
-
-    const/16 v2, 0x76
-
-    const/4 v3, 0x0
-
-    invoke-virtual {v1, v2, p0, v3}, Landroid/os/Handler;->obtainMessage(III)Landroid/os/Message;
-
-    move-result-object p0
-
-    const/4 v1, 0x0
-
-    iput-object v1, p0, Landroid/os/Message;->obj:Ljava/lang/Object;
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService;->mDarHandler:Lcom/android/server/knox/dar/DarManagerService$DarHandler;
-
-    invoke-virtual {v0, p0}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z
-
-    :cond_0
-    return-void
-.end method
-
 .method public static throwCheckedUserOperationException(ILjava/lang/String;)V
     .locals 1
 
@@ -5256,7 +5217,7 @@
 .end method
 
 .method public final createUserInternalUncheckedNoTracing(Ljava/lang/String;Ljava/lang/String;IIZ[Ljava/lang/String;Lcom/android/server/utils/TimingsTraceAndSlog;Ljava/lang/Object;)Landroid/content/pm/UserInfo;
-    .locals 41
+    .locals 32
 
     move-object/from16 v1, p0
 
@@ -5266,61 +5227,37 @@
 
     move-object/from16 v5, p8
 
-    const-string v6, "Creating SecureFolder user - Separate challenge is enabled for user "
-
-    const-string/jumbo v7, "could not start pre-created user "
-
-    const-string/jumbo v8, "starting pre-created user "
-
-    const-string/jumbo v9, "PM.onNewUserCreated-"
-
-    const-string v10, "Apply policies and setup dualdar for user "
-
-    const-string v11, "EM Token status : "
-
-    const-string v12, "Creating user "
-
-    const-string v13, "Cannot add profile of type "
+    const-string v6, "Cannot add profile of type "
 
-    const-string v14, "Cannot add more profiles of type "
+    const-string v7, "Cannot add more profiles of type "
 
-    const-string v15, "Cannot add more users of type "
+    const-string v8, "Cannot add more users of type "
 
-    move-object/from16 v16, v6
+    const-string v9, "Cannot find user data for parent user "
 
-    const-string v6, "Cannot find user data for parent user "
+    const/16 v10, 0x64
 
-    move-object/from16 v17, v7
+    move-object/from16 v11, p1
 
-    const/16 v7, 0x64
+    invoke-static {v10, v11}, Lcom/android/server/pm/UserManagerService;->truncateString(ILjava/lang/String;)Ljava/lang/String;
 
-    move-object/from16 v18, v8
+    move-result-object v13
 
-    move-object/from16 v8, p1
+    iget-object v10, v1, Lcom/android/server/pm/UserManagerService;->mUserTypes:Landroid/util/ArrayMap;
 
-    invoke-static {v7, v8}, Lcom/android/server/pm/UserManagerService;->truncateString(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v7
-
-    iget-object v8, v1, Lcom/android/server/pm/UserManagerService;->mUserTypes:Landroid/util/ArrayMap;
-
-    invoke-virtual {v8, v0}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v8
-
-    check-cast v8, Lcom/android/server/pm/UserTypeDetails;
+    invoke-virtual {v10, v0}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
 
-    move-object/from16 v25, v9
+    move-result-object v10
 
-    const/16 p1, 0x0
+    check-cast v10, Lcom/android/server/pm/UserTypeDetails;
 
-    if-eqz v8, :cond_59
+    if-eqz v10, :cond_4f
 
     invoke-virtual {v0}, Ljava/lang/String;->intern()Ljava/lang/String;
 
-    move-result-object v9
+    move-result-object v14
 
-    invoke-virtual {v8}, Lcom/android/server/pm/UserTypeDetails;->getDefaultUserInfoFlags()I
+    invoke-virtual {v10}, Lcom/android/server/pm/UserTypeDetails;->getDefaultUserInfoFlags()I
 
     move-result v0
 
@@ -5328,134 +5265,117 @@
 
     invoke-static {v0}, Lcom/android/server/pm/UserManagerService;->checkUserTypeConsistency(I)Z
 
-    move-result v19
-
-    if-eqz v19, :cond_58
+    move-result v15
 
-    move-object/from16 v27, v10
+    if-eqz v15, :cond_4e
 
-    and-int/lit16 v10, v0, 0x800
+    and-int/lit16 v15, v0, 0x800
 
-    if-nez v10, :cond_57
+    if-nez v15, :cond_4d
 
-    invoke-static {v8}, Lcom/android/server/pm/UserManagerService;->isUserTypeEnabled(Lcom/android/server/pm/UserTypeDetails;)Z
+    invoke-static {v10}, Lcom/android/server/pm/UserManagerService;->isUserTypeEnabled(Lcom/android/server/pm/UserTypeDetails;)Z
 
-    move-result v10
+    move-result v15
 
-    move/from16 p2, v10
+    if-eqz v15, :cond_4c
 
-    if-eqz p2, :cond_56
+    invoke-static {v14}, Lcom/samsung/android/core/pm/mm/MaintenanceModeUtils;->isUserTypeMaintenanceMode(Ljava/lang/String;)Z
 
-    invoke-static {v9}, Lcom/samsung/android/core/pm/mm/MaintenanceModeUtils;->isUserTypeMaintenanceMode(Ljava/lang/String;)Z
+    move-result v17
 
-    move-result v28
+    iget-object v15, v1, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
 
-    iget-object v10, v1, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
+    monitor-enter v15
 
-    monitor-enter v10
+    const/16 v16, 0x0
 
-    if-eqz v28, :cond_5
+    if-eqz v17, :cond_3
 
     :try_start_0
-    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
+    iget-object v11, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
 
-    iget-object v4, v4, Lcom/android/server/pm/PackageManagerService;->mCustomInjector:Lcom/samsung/android/server/pm/lifecycle/PmCustomInjector;
+    iget-object v11, v11, Lcom/android/server/pm/PackageManagerService;->mCustomInjector:Lcom/samsung/android/server/pm/lifecycle/PmCustomInjector;
 
-    invoke-virtual {v4}, Lcom/samsung/android/server/pm/lifecycle/PmCustomInjector;->getMaintenanceModeManager()Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;
+    invoke-virtual {v11}, Lcom/samsung/android/server/pm/lifecycle/PmCustomInjector;->getMaintenanceModeManager()Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;
 
-    move-result-object v4
-
-    move-object/from16 v29, v11
+    move-result-object v11
 
-    iget-boolean v11, v1, Lcom/android/server/pm/UserManagerService;->mForceEphemeralUsers:Z
+    iget-boolean v12, v1, Lcom/android/server/pm/UserManagerService;->mForceEphemeralUsers:Z
 
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    if-nez v12, :cond_1
 
-    if-nez v11, :cond_0
+    invoke-virtual {v11}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     invoke-static {}, Landroid/os/Binder;->getCallingUid()I
 
-    move-result v11
+    move-result v12
 
-    const/16 v3, 0x3e8
+    const/16 v4, 0x3e8
 
-    invoke-static {v11, v3}, Landroid/os/UserHandle;->isSameApp(II)Z
+    invoke-static {v12, v4}, Landroid/os/UserHandle;->isSameApp(II)Z
 
     move-result v19
 
-    if-nez v19, :cond_1
+    if-nez v19, :cond_0
 
-    :cond_0
-    move-object/from16 v19, v12
+    const/4 v3, 0x0
 
     goto :goto_0
 
-    :cond_1
+    :cond_0
     invoke-static {}, Landroid/os/Binder;->getCallingPid()I
 
-    move-result v3
+    move-result v4
 
-    move-object/from16 v19, v12
+    new-instance v3, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager$$ExternalSyntheticLambda10;
 
-    new-instance v12, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager$$ExternalSyntheticLambda10;
+    invoke-direct {v3, v4, v12}, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager$$ExternalSyntheticLambda10;-><init>(II)V
 
-    invoke-direct {v12, v3, v11}, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager$$ExternalSyntheticLambda10;-><init>(II)V
+    iget-object v4, v11, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;->mHandler:Landroid/os/Handler;
 
-    iget-object v3, v4, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;->mHandler:Landroid/os/Handler;
+    invoke-virtual {v4, v3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+
+    const/4 v3, 0x1
 
-    invoke-virtual {v3, v12}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+    :goto_0
+    if-eqz v3, :cond_2
 
-    iget-object v3, v4, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;->mContext:Landroid/content/Context;
+    iget-object v3, v11, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;->mContext:Landroid/content/Context;
 
     invoke-static {v3}, Lcom/samsung/android/core/pm/mm/MaintenanceModeUtils;->doesMaintenanceModeUserIdExist(Landroid/content/Context;)Z
 
     move-result v3
 
-    if-nez v3, :cond_3
+    if-nez v3, :cond_2
 
     invoke-static {}, Lcom/samsung/android/core/pm/mm/MaintenanceModeUtils;->hasSystemFeature()Z
 
     move-result v3
 
-    if-nez v3, :cond_2
-
-    goto :goto_0
-
-    :cond_2
-    const/4 v3, 0x1
+    if-eqz v3, :cond_2
 
     goto :goto_1
 
-    :cond_3
-    :goto_0
-    const/4 v3, 0x0
-
-    :goto_1
-    if-eqz v3, :cond_4
-
-    goto :goto_2
+    :cond_1
+    invoke-virtual {v11}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :cond_4
+    :cond_2
     const-string v0, "Cannot add Maintenance mode user."
 
     const/4 v1, 0x1
 
     invoke-static {v1, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    throw p1
+    throw v16
 
     :catchall_0
     move-exception v0
 
-    goto/16 :goto_38
-
-    :cond_5
-    move-object/from16 v29, v11
-
-    move-object/from16 v19, v12
+    goto/16 :goto_32
 
-    :goto_2
-    monitor-exit v10
+    :cond_3
+    :goto_1
+    monitor-exit v15
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
@@ -5466,112 +5386,112 @@
     :try_start_1
     iget-boolean v4, v1, Lcom/android/server/pm/UserManagerService;->mForceEphemeralUsers:Z
 
-    if-eqz v4, :cond_6
+    if-eqz v4, :cond_4
 
     or-int/lit16 v0, v0, 0x100
 
-    :cond_6
+    :cond_4
     monitor-exit v3
     :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_16
+    .catchall {:try_start_1 .. :try_end_1} :catchall_13
 
     sget-boolean v3, Lcom/samsung/android/rune/PMRune;->UM_BMODE:Z
 
     const/high16 v4, 0x10000
 
-    const/high16 v10, 0x8000000
+    const/high16 v11, 0x8000000
 
-    if-eqz v3, :cond_7
+    if-eqz v3, :cond_5
 
-    and-int v11, v0, v10
+    and-int v12, v0, v11
 
-    if-nez v11, :cond_8
+    if-nez v12, :cond_6
 
-    and-int v11, v0, v4
+    and-int v12, v0, v4
 
-    if-eqz v11, :cond_7
+    if-eqz v12, :cond_5
 
-    goto :goto_3
+    goto :goto_2
 
-    :cond_7
-    move/from16 v20, v4
+    :cond_5
+    move/from16 v19, v4
 
-    goto :goto_4
+    goto :goto_3
 
-    :cond_8
-    :goto_3
+    :cond_6
+    :goto_2
     invoke-static {}, Landroid/os/UserManager;->supportsMultipleUsers()Z
 
-    move-result v11
+    move-result v12
 
-    if-nez v11, :cond_7
+    if-nez v12, :cond_5
 
     invoke-static {}, Lcom/samsung/android/core/pm/multiuser/MultiUserSupportsHelper;->getConfigMaxMultiUsers()I
 
-    move-result v11
+    move-result v12
 
-    const/16 v26, 0x1
+    const/4 v15, 0x1
 
-    add-int/lit8 v11, v11, 0x1
+    add-int/2addr v12, v15
 
-    const-string/jumbo v12, "persist.sys.show_multiuserui"
+    const-string/jumbo v15, "persist.sys.show_multiuserui"
 
-    move/from16 v20, v4
+    move/from16 v19, v4
 
     const-string/jumbo v4, "true"
 
-    invoke-static {v12, v4}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v15, v4}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
 
     const-string/jumbo v4, "persist.sys.max_users"
 
-    invoke-static {v11}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
+    invoke-static {v12}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
 
-    move-result-object v11
+    move-result-object v12
 
-    invoke-static {v4, v11}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v4, v12}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
 
     const-string v4, "BmodeMigrationUtils"
 
-    const-string v11, "Enabling multi user due to BMODE"
+    const-string v12, "Enabling multi user due to BMODE"
 
-    invoke-static {v4, v11}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v12}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_4
-    if-nez p5, :cond_a
+    :goto_3
+    if-nez p5, :cond_8
 
-    if-gez v2, :cond_a
+    if-gez v2, :cond_8
 
-    iget v4, v8, Lcom/android/server/pm/UserTypeDetails;->mBaseType:I
+    iget v4, v10, Lcom/android/server/pm/UserTypeDetails;->mBaseType:I
 
     and-int/lit16 v4, v4, 0x1000
 
-    if-eqz v4, :cond_9
+    if-eqz v4, :cond_7
 
-    goto :goto_5
+    goto :goto_4
 
-    :cond_9
+    :cond_7
     const-string/jumbo v4, "android.os.usertype.full.RESTRICTED"
 
-    iget-object v11, v8, Lcom/android/server/pm/UserTypeDetails;->mName:Ljava/lang/String;
+    iget-object v12, v10, Lcom/android/server/pm/UserTypeDetails;->mName:Ljava/lang/String;
 
-    invoke-virtual {v11, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v12, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v4
 
-    if-nez v4, :cond_a
+    if-nez v4, :cond_8
 
-    if-nez v28, :cond_a
+    if-nez v17, :cond_8
 
-    invoke-virtual {v1, v0, v5, v9, v7}, Lcom/android/server/pm/UserManagerService;->convertPreCreatedUserIfPossible(ILjava/lang/Object;Ljava/lang/String;Ljava/lang/String;)Landroid/content/pm/UserInfo;
+    invoke-virtual {v1, v0, v5, v14, v13}, Lcom/android/server/pm/UserManagerService;->convertPreCreatedUserIfPossible(ILjava/lang/Object;Ljava/lang/String;Ljava/lang/String;)Landroid/content/pm/UserInfo;
 
     move-result-object v4
 
-    if-eqz v4, :cond_a
+    if-eqz v4, :cond_8
 
     return-object v4
 
-    :cond_a
-    :goto_5
+    :cond_8
+    :goto_4
     const-class v4, Lcom/android/server/storage/DeviceStorageMonitorService$2;
 
     invoke-static {v4}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
@@ -5584,346 +5504,289 @@
 
     move-result v4
 
-    if-nez v4, :cond_55
+    if-nez v4, :cond_4b
 
     and-int/lit16 v4, v0, 0x4000
 
-    if-eqz v4, :cond_b
+    if-eqz v4, :cond_9
 
     const/4 v4, 0x1
 
-    goto :goto_6
+    goto :goto_5
 
-    :cond_b
+    :cond_9
     const/4 v4, 0x0
 
-    :goto_6
-    iget v11, v8, Lcom/android/server/pm/UserTypeDetails;->mBaseType:I
-
-    and-int/lit16 v11, v11, 0x1000
-
-    if-eqz v11, :cond_c
-
-    const/4 v11, 0x1
-
-    goto :goto_7
+    :goto_5
+    iget v12, v10, Lcom/android/server/pm/UserTypeDetails;->mBaseType:I
 
-    :cond_c
-    const/4 v11, 0x0
+    and-int/lit16 v12, v12, 0x1000
 
-    :goto_7
-    invoke-static {v9}, Landroid/os/UserManager;->isUserTypeGuest(Ljava/lang/String;)Z
+    if-eqz v12, :cond_a
 
-    move-result v12
+    const/16 v20, 0x1
 
-    invoke-static {v9}, Landroid/os/UserManager;->isUserTypeRestricted(Ljava/lang/String;)Z
+    goto :goto_6
 
-    move-result v30
+    :cond_a
+    const/16 v20, 0x0
 
-    invoke-static {v9}, Landroid/os/UserManager;->isUserTypeDemo(Ljava/lang/String;)Z
+    :goto_6
+    invoke-static {v14}, Landroid/os/UserManager;->isUserTypeGuest(Ljava/lang/String;)Z
 
     move-result v21
 
-    and-int/2addr v10, v0
+    invoke-static {v14}, Landroid/os/UserManager;->isUserTypeRestricted(Ljava/lang/String;)Z
 
-    if-nez v10, :cond_e
+    move-result v22
 
-    and-int v10, v0, v20
+    invoke-static {v14}, Landroid/os/UserManager;->isUserTypeDemo(Ljava/lang/String;)Z
 
-    if-eqz v10, :cond_d
+    move-result v12
 
-    goto :goto_8
+    and-int/2addr v11, v0
 
-    :cond_d
-    const/4 v10, 0x0
+    if-nez v11, :cond_c
 
-    goto :goto_9
+    and-int v11, v0, v19
 
-    :cond_e
-    :goto_8
-    const/4 v10, 0x1
+    if-eqz v11, :cond_b
 
-    :goto_9
-    invoke-static {v9}, Landroid/os/UserManager;->isUserTypeManagedProfile(Ljava/lang/String;)Z
+    goto :goto_7
 
-    move-result v31
+    :cond_b
+    const/16 v19, 0x0
+
+    goto :goto_8
 
-    const/high16 v20, 0x20000
+    :cond_c
+    :goto_7
+    const/16 v19, 0x1
 
-    and-int v20, v0, v20
+    :goto_8
+    invoke-static {v14}, Landroid/os/UserManager;->isUserTypeManagedProfile(Ljava/lang/String;)Z
 
-    if-eqz v20, :cond_f
+    move-result v23
 
-    move/from16 v20, v3
+    const/high16 v11, 0x20000
 
-    const/4 v3, 0x1
+    and-int/2addr v11, v0
 
-    goto :goto_a
+    if-eqz v11, :cond_d
 
-    :cond_f
-    move/from16 v20, v3
+    const/4 v11, 0x1
 
-    const/4 v3, 0x0
+    goto :goto_9
 
-    :goto_a
-    const/high16 v22, 0x20000000
+    :cond_d
+    const/4 v11, 0x0
 
-    and-int v22, v0, v22
+    :goto_9
+    const/high16 v15, 0x20000000
 
-    if-eqz v22, :cond_10
+    and-int/2addr v15, v0
 
-    move/from16 v22, v0
+    if-eqz v15, :cond_e
 
     invoke-static {}, Landroid/os/Binder;->getCallingUid()I
 
-    move-result v0
+    move-result v15
 
-    move/from16 v32, v4
+    move/from16 v24, v0
 
-    const/16 v4, 0x3e8
+    const/16 v0, 0x3e8
 
-    if-ne v0, v4, :cond_11
+    if-ne v15, v0, :cond_f
 
     const/4 v0, 0x1
 
-    goto :goto_b
-
-    :cond_10
-    move/from16 v22, v0
+    goto :goto_a
 
-    move/from16 v32, v4
+    :cond_e
+    move/from16 v24, v0
 
-    :cond_11
+    :cond_f
     const/4 v0, 0x0
 
-    :goto_b
-    invoke-static {v9}, Landroid/os/UserManager;->isUserTypePrivateProfile(Ljava/lang/String;)Z
-
-    move-result v4
+    :goto_a
+    invoke-static {v14}, Landroid/os/UserManager;->isUserTypePrivateProfile(Ljava/lang/String;)Z
 
-    move/from16 p3, v4
+    move-result v25
 
-    iget-boolean v4, v8, Lcom/android/server/pm/UserTypeDetails;->mProfileParentRequired:Z
+    iget-boolean v15, v10, Lcom/android/server/pm/UserTypeDetails;->mProfileParentRequired:Z
 
-    const/high16 v23, 0x4000000
+    if-eqz v23, :cond_11
 
-    and-int v23, v22, v23
+    if-eqz v19, :cond_10
 
-    if-eqz v23, :cond_12
+    goto :goto_b
 
-    const/16 v33, 0x1
+    :cond_10
+    const/16 v26, 0x1
 
     goto :goto_c
 
-    :cond_12
-    const/16 v33, 0x0
+    :cond_11
+    :goto_b
+    const/16 v26, 0x0
 
     :goto_c
-    const/high16 v23, 0x2000000
+    if-eqz v11, :cond_12
+
+    const/high16 v27, 0x40000
+
+    or-int v24, v24, v27
+
+    :cond_12
+    move/from16 p2, v3
+
+    move/from16 v3, v24
 
-    and-int v23, v22, v23
+    const/high16 v24, 0x1000000
 
-    if-eqz v23, :cond_13
+    and-int v24, v3, v24
 
-    const/16 v34, 0x1
+    if-eqz v24, :cond_13
+
+    const/16 v24, 0x1
 
     goto :goto_d
 
     :cond_13
-    const/16 v34, 0x0
+    const/16 v24, 0x0
 
     :goto_d
-    if-nez v33, :cond_15
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    if-eqz v34, :cond_14
+    move-result-wide v27
 
-    goto :goto_e
+    move/from16 v29, v4
 
-    :cond_14
-    const/16 v23, 0x0
+    :try_start_2
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mPackagesLock:Ljava/lang/Object;
 
-    goto :goto_f
+    monitor-enter v4
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_12
 
-    :cond_15
-    :goto_e
-    const/16 v23, 0x1
+    const/16 v5, -0x2710
 
-    :goto_f
-    if-eqz v31, :cond_16
+    if-eq v2, v5, :cond_15
 
-    if-eqz v10, :cond_17
+    :try_start_3
+    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
 
-    :cond_16
-    if-eqz v23, :cond_18
+    monitor-enter v5
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_1
 
-    :cond_17
-    const/16 v35, 0x1
+    :try_start_4
+    invoke-virtual {v1, v2}, Lcom/android/server/pm/UserManagerService;->getUserDataLU(I)Lcom/android/server/pm/UserManagerService$UserData;
 
-    goto :goto_10
+    move-result-object v30
 
-    :cond_18
-    const/16 v35, 0x0
+    monitor-exit v5
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_2
 
-    :goto_10
-    if-eqz v3, :cond_19
+    if-eqz v30, :cond_14
 
-    const/high16 v23, 0x40000
+    move-object/from16 v5, v30
 
-    or-int v22, v22, v23
+    goto :goto_f
 
-    :cond_19
-    move/from16 v23, v4
+    :cond_14
+    :try_start_5
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    move/from16 v4, v22
+    invoke-direct {v0, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    const/high16 v22, 0x1000000
+    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    and-int v22, v4, v22
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    if-eqz v22, :cond_1a
+    move-result-object v0
 
-    const/16 v22, 0x1
+    const/4 v15, 0x1
 
-    goto :goto_11
+    invoke-static {v15, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    :cond_1a
-    const/16 v22, 0x0
-
-    :goto_11
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v36
-
-    move-object/from16 v24, v7
-
-    :try_start_2
-    iget-object v7, v1, Lcom/android/server/pm/UserManagerService;->mPackagesLock:Ljava/lang/Object;
-
-    monitor-enter v7
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_15
-
-    move/from16 v38, v10
-
-    const/16 v10, -0x2710
-
-    if-eq v2, v10, :cond_1c
-
-    :try_start_3
-    iget-object v10, v1, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
-
-    monitor-enter v10
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    :try_start_4
-    invoke-virtual {v1, v2}, Lcom/android/server/pm/UserManagerService;->getUserDataLU(I)Lcom/android/server/pm/UserManagerService$UserData;
-
-    move-result-object v39
-
-    monitor-exit v10
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_2
-
-    if-eqz v39, :cond_1b
-
-    move-object/from16 v6, v39
-
-    goto :goto_14
-
-    :cond_1b
-    :try_start_5
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v2, 0x1
-
-    invoke-static {v2, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
-
-    throw p1
+    throw v16
     :try_end_5
     .catchall {:try_start_5 .. :try_end_5} :catchall_1
 
-    :goto_12
-    move-object/from16 v9, p1
+    :goto_e
+    move-object/from16 v11, v16
 
-    :goto_13
-    const/4 v12, 0x0
+    const/4 v3, 0x0
 
-    goto/16 :goto_35
+    goto/16 :goto_2f
 
     :catchall_1
     move-exception v0
 
-    goto :goto_12
+    goto :goto_e
 
     :catchall_2
     move-exception v0
 
     :try_start_6
-    monitor-exit v10
+    monitor-exit v5
     :try_end_6
     .catchall {:try_start_6 .. :try_end_6} :catchall_2
 
     :try_start_7
     throw v0
 
-    :cond_1c
-    move-object/from16 v6, p1
+    :cond_15
+    move-object/from16 v5, v16
 
-    :goto_14
-    if-eqz v32, :cond_1e
+    :goto_f
+    if-eqz v29, :cond_17
 
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getMainUserIdUnchecked()I
 
-    move-result v10
+    move-result v9
 
-    move/from16 v40, v11
+    move/from16 v31, v12
 
-    const/16 v11, -0x2710
+    const/16 v12, -0x2710
 
-    if-ne v10, v11, :cond_1d
+    if-ne v9, v12, :cond_16
 
-    goto :goto_15
+    goto :goto_10
 
-    :cond_1d
+    :cond_16
     const-string v0, "Cannot add user with FLAG_MAIN as main user already exists."
 
     const/4 v2, 0x6
 
     invoke-static {v2, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    throw p1
+    throw v16
 
-    :cond_1e
-    move/from16 v40, v11
+    :cond_17
+    move/from16 v31, v12
 
-    :goto_15
-    if-nez p5, :cond_20
+    :goto_10
+    if-nez p5, :cond_19
 
-    invoke-virtual {v1, v8}, Lcom/android/server/pm/UserManagerService;->canAddMoreUsersOfType(Lcom/android/server/pm/UserTypeDetails;)Z
+    invoke-virtual {v1, v10}, Lcom/android/server/pm/UserManagerService;->canAddMoreUsersOfType(Lcom/android/server/pm/UserTypeDetails;)Z
 
-    move-result v10
+    move-result v9
 
-    if-nez v10, :cond_20
+    if-nez v9, :cond_19
 
-    if-eqz v28, :cond_1f
+    if-eqz v17, :cond_18
 
-    goto :goto_16
+    goto :goto_11
 
-    :cond_1f
+    :cond_18
     new-instance v0, Ljava/lang/StringBuilder;
 
-    invoke-direct {v0, v15}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     const-string v2, ". Maximum number of that type already exists."
 
@@ -5937,61 +5800,61 @@
 
     invoke-static {v2, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    throw p1
+    throw v16
 
-    :cond_20
-    :goto_16
-    if-nez v12, :cond_22
+    :cond_19
+    :goto_11
+    if-nez v21, :cond_1b
 
-    if-nez v31, :cond_22
+    if-nez v23, :cond_1b
 
-    if-nez v21, :cond_22
+    if-nez v31, :cond_1b
 
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->isUserLimitReached()Z
 
-    move-result v10
+    move-result v8
 
-    if-eqz v10, :cond_22
+    if-eqz v8, :cond_1b
 
-    if-nez v28, :cond_22
+    if-nez v17, :cond_1b
 
-    if-nez v38, :cond_22
+    if-nez v19, :cond_1b
 
-    if-nez v22, :cond_22
+    if-nez v24, :cond_1b
 
-    if-nez p3, :cond_22
+    if-nez v25, :cond_1b
 
-    if-eqz v0, :cond_21
+    if-eqz v0, :cond_1a
 
-    goto :goto_17
+    goto :goto_12
 
-    :cond_21
+    :cond_1a
     const-string v0, "Cannot add user. Maximum user limit is reached."
 
     const/4 v2, 0x6
 
     invoke-static {v2, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    throw p1
+    throw v16
 
-    :cond_22
-    :goto_17
-    if-eqz v23, :cond_24
+    :cond_1b
+    :goto_12
+    if-eqz v15, :cond_1d
 
-    invoke-virtual {v1, v2, v4, v9}, Lcom/android/server/pm/UserManagerService;->canAddMoreProfilesToUser(IILjava/lang/String;)Z
+    invoke-virtual {v1, v2, v3, v14}, Lcom/android/server/pm/UserManagerService;->canAddMoreProfilesToUser(IILjava/lang/String;)Z
 
-    move-result v10
+    move-result v8
 
-    if-eqz v10, :cond_23
+    if-eqz v8, :cond_1c
 
-    goto :goto_18
+    goto :goto_13
 
-    :cond_23
+    :cond_1c
     new-instance v0, Ljava/lang/StringBuilder;
 
-    invoke-direct {v0, v14}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     const-string v3, " for user "
 
@@ -6007,26 +5870,26 @@
 
     invoke-static {v2, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    throw p1
+    throw v16
 
-    :cond_24
-    :goto_18
-    if-eqz p3, :cond_26
+    :cond_1d
+    :goto_13
+    if-eqz v25, :cond_1f
 
     invoke-virtual {v1, v2}, Lcom/android/server/pm/UserManagerService;->canAddPrivateProfile(I)Z
 
-    move-result v10
+    move-result v7
 
-    if-eqz v10, :cond_25
+    if-eqz v7, :cond_1e
 
-    goto :goto_19
+    goto :goto_14
 
-    :cond_25
+    :cond_1e
     new-instance v0, Ljava/lang/StringBuilder;
 
-    invoke-direct {v0, v13}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     const-string v3, " for user "
 
@@ -6042,154 +5905,156 @@
 
     invoke-static {v2, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    throw p1
-
-    :cond_26
-    :goto_19
-    if-eqz v20, :cond_2a
+    throw v16
 
-    if-eqz v38, :cond_2a
+    :cond_1f
+    :goto_14
+    if-eqz p2, :cond_23
 
-    const/4 v10, 0x1
+    if-eqz v19, :cond_23
 
-    invoke-virtual {v1, v10, v10, v10}, Lcom/android/server/pm/UserManagerService;->getUsers(ZZZ)Ljava/util/List;
+    const/4 v15, 0x1
 
-    move-result-object v11
+    invoke-virtual {v1, v15, v15, v15}, Lcom/android/server/pm/UserManagerService;->getUsers(ZZZ)Ljava/util/List;
 
-    check-cast v11, Ljava/util/ArrayList;
+    move-result-object v6
 
-    invoke-virtual {v11}, Ljava/util/ArrayList;->size()I
+    check-cast v6, Ljava/util/ArrayList;
 
-    move-result v13
+    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I
 
-    const/4 v14, 0x0
+    move-result v7
 
-    :goto_1a
-    if-ge v14, v13, :cond_28
+    const/4 v8, 0x0
 
-    invoke-virtual {v11, v14}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    :goto_15
+    if-ge v8, v7, :cond_21
 
-    move-result-object v15
+    invoke-virtual {v6, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
-    add-int/2addr v14, v10
+    move-result-object v9
 
-    move-object v10, v15
+    add-int/2addr v8, v15
 
-    check-cast v10, Landroid/content/pm/UserInfo;
+    check-cast v9, Landroid/content/pm/UserInfo;
 
-    invoke-virtual {v10}, Landroid/content/pm/UserInfo;->isBMode()Z
+    invoke-virtual {v9}, Landroid/content/pm/UserInfo;->isBMode()Z
 
-    move-result v15
+    move-result v12
 
-    if-eqz v15, :cond_27
+    if-eqz v12, :cond_20
 
-    goto :goto_1b
+    goto :goto_16
 
-    :cond_27
-    const/4 v10, 0x1
+    :cond_20
+    const/4 v15, 0x1
 
-    goto :goto_1a
+    goto :goto_15
 
-    :cond_28
-    move-object/from16 v10, p1
+    :cond_21
+    move-object/from16 v9, v16
 
-    :goto_1b
-    if-nez v10, :cond_29
+    :goto_16
+    if-nez v9, :cond_22
 
-    goto :goto_1c
+    goto :goto_17
 
-    :cond_29
+    :cond_22
     const-string v0, "Cannot add Bmode user. There already exists one."
 
     const/4 v2, 0x6
 
     invoke-static {v2, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    throw p1
+    throw v16
 
-    :cond_2a
-    :goto_1c
-    if-eqz v30, :cond_2c
+    :cond_23
+    :goto_17
+    if-eqz v22, :cond_24
 
-    if-eqz v2, :cond_2c
+    if-eqz v2, :cond_24
 
     invoke-static {}, Lcom/android/server/pm/UserManagerService;->isCreationOverrideEnabled()Z
 
-    move-result v10
+    move-result v6
 
-    if-eqz v10, :cond_2b
+    if-eqz v6, :cond_25
 
-    goto :goto_1d
+    :cond_24
+    const/4 v15, 0x1
 
-    :cond_2b
+    goto :goto_18
+
+    :cond_25
     const-string v0, "Cannot add restricted profile - parent user must be system"
 
-    const/4 v10, 0x1
+    const/4 v15, 0x1
 
-    invoke-static {v10, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
+    invoke-static {v15, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    throw p1
+    throw v16
     :try_end_7
     .catchall {:try_start_7 .. :try_end_7} :catchall_1
 
-    :cond_2c
-    :goto_1d
-    if-eqz v28, :cond_2d
+    :goto_18
+    if-eqz v17, :cond_26
 
     const/16 v0, 0x4d
 
-    :goto_1e
-    move v10, v0
+    :goto_19
+    move v12, v0
 
-    goto :goto_1f
+    goto :goto_1a
 
-    :cond_2d
+    :cond_26
     :try_start_8
-    invoke-virtual {v1, v3, v0}, Lcom/android/server/pm/UserManagerService;->getNextAvailableId(ZZ)I
+    invoke-virtual {v1, v11, v0}, Lcom/android/server/pm/UserManagerService;->getNextAvailableId(ZZ)I
 
     move-result v0
 
-    goto :goto_1e
+    goto :goto_19
 
-    :goto_1f
+    :goto_1a
     const-string/jumbo v0, "UserManagerService"
 
-    new-instance v11, Ljava/lang/StringBuilder;
+    new-instance v6, Ljava/lang/StringBuilder;
 
-    move-object/from16 v13, v19
+    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-direct {v11, v13}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    const-string v7, "Creating user "
 
-    invoke-virtual {v11, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string v13, " of type "
+    invoke-virtual {v6, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v11, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    const-string v7, " of type "
 
-    invoke-virtual {v11, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v6, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v11
+    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v6
 
-    invoke-static {v0, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {v10}, Landroid/os/Environment;->getUserSystemDirectory(I)Ljava/io/File;
+    invoke-static {v12}, Landroid/os/Environment;->getUserSystemDirectory(I)Ljava/io/File;
 
     move-result-object v0
 
     invoke-virtual {v0}, Ljava/io/File;->mkdirs()Z
 
-    iget-object v11, v1, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
+    iget-object v6, v1, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
 
-    monitor-enter v11
+    monitor-enter v6
     :try_end_8
-    .catchall {:try_start_8 .. :try_end_8} :catchall_13
+    .catchall {:try_start_8 .. :try_end_8} :catchall_10
 
-    if-eqz v6, :cond_2e
+    if-eqz v5, :cond_27
 
     :try_start_9
-    iget-object v0, v6, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
+    iget-object v0, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
     invoke-virtual {v0}, Landroid/content/pm/UserInfo;->isEphemeral()Z
 
@@ -6197,82 +6062,92 @@
     :try_end_9
     .catchall {:try_start_9 .. :try_end_9} :catchall_3
 
-    if-eqz v0, :cond_2e
+    if-eqz v0, :cond_27
 
-    or-int/lit16 v4, v4, 0x100
+    or-int/lit16 v3, v3, 0x100
 
-    goto :goto_20
+    goto :goto_1b
 
     :catchall_3
     move-exception v0
 
-    move-object/from16 v9, p1
+    move-object/from16 v11, v16
 
-    const/4 v12, 0x0
+    const/4 v3, 0x0
 
-    goto/16 :goto_34
+    goto/16 :goto_2e
 
-    :cond_2e
-    :goto_20
-    if-eqz p5, :cond_2f
+    :cond_27
+    :goto_1b
+    if-eqz p5, :cond_28
 
-    and-int/lit16 v4, v4, -0x101
+    and-int/lit16 v3, v3, -0x101
 
-    :cond_2f
-    and-int/lit16 v0, v4, 0x100
+    :cond_28
+    and-int/lit16 v0, v3, 0x100
 
-    if-eqz v0, :cond_30
+    if-eqz v0, :cond_29
 
-    or-int/lit16 v4, v4, 0x2000
+    or-int/lit16 v3, v3, 0x2000
 
-    :cond_30
-    move/from16 v23, v4
+    :cond_29
+    move v7, v11
 
     :try_start_a
-    new-instance v19, Landroid/content/pm/UserInfo;
+    new-instance v11, Landroid/content/pm/UserInfo;
+    :try_end_a
+    .catchall {:try_start_a .. :try_end_a} :catchall_d
 
-    const/16 v22, 0x0
+    move-object/from16 v8, v16
 
-    move/from16 v20, v10
+    move-object/from16 v16, v14
 
-    move-object/from16 v21, v24
+    const/4 v14, 0x0
 
-    move-object/from16 v24, v9
+    move/from16 v18, v7
 
-    invoke-direct/range {v19 .. v24}, Landroid/content/pm/UserInfo;-><init>(ILjava/lang/String;Ljava/lang/String;ILjava/lang/String;)V
-    :try_end_a
-    .catchall {:try_start_a .. :try_end_a} :catchall_10
+    move v7, v15
 
-    move-object/from16 v13, v19
+    const/16 v9, 0x8
 
-    move/from16 v9, v20
+    move v15, v3
 
-    move/from16 v10, v23
+    const/4 v3, 0x0
 
-    move-object/from16 v4, v24
+    :try_start_b
+    invoke-direct/range {v11 .. v16}, Landroid/content/pm/UserInfo;-><init>(ILjava/lang/String;Ljava/lang/String;ILjava/lang/String;)V
+    :try_end_b
+    .catchall {:try_start_b .. :try_end_b} :catchall_c
 
-    if-eqz v40, :cond_31
+    move-object v13, v11
 
-    :try_start_b
-    iput v9, v13, Landroid/content/pm/UserInfo;->serialNumber:I
+    move-object/from16 v11, v16
 
-    iget v0, v1, Lcom/android/server/pm/UserManagerService;->mNextSerialNumber:I
+    if-eqz v20, :cond_2a
 
-    const/16 v26, 0x1
+    :try_start_c
+    iput v12, v13, Landroid/content/pm/UserInfo;->serialNumber:I
 
-    add-int/lit8 v0, v0, 0x1
+    iget v0, v1, Lcom/android/server/pm/UserManagerService;->mNextSerialNumber:I
+
+    add-int/2addr v0, v7
 
     iput v0, v1, Lcom/android/server/pm/UserManagerService;->mNextSerialNumber:I
-    :try_end_b
-    .catchall {:try_start_b .. :try_end_b} :catchall_3
+    :try_end_c
+    .catchall {:try_start_c .. :try_end_c} :catchall_4
 
-    goto :goto_21
+    goto :goto_1c
 
-    :cond_31
-    :try_start_c
-    iget v0, v1, Lcom/android/server/pm/UserManagerService;->mNextSerialNumber:I
+    :catchall_4
+    move-exception v0
 
-    const/16 v26, 0x1
+    move-object v11, v8
+
+    goto/16 :goto_2e
+
+    :cond_2a
+    :try_start_d
+    iget v0, v1, Lcom/android/server/pm/UserManagerService;->mNextSerialNumber:I
 
     add-int/lit8 v14, v0, 0x1
 
@@ -6280,28 +6155,26 @@
 
     iput v0, v13, Landroid/content/pm/UserInfo;->serialNumber:I
 
-    :goto_21
+    :goto_1c
     invoke-static {}, Ljava/lang/System;->currentTimeMillis()J
 
     move-result-wide v14
 
-    const-wide v19, 0xdc46c32800L
+    const-wide v30, 0xdc46c32800L
 
-    cmp-long v0, v14, v19
+    cmp-long v0, v14, v30
 
-    if-lez v0, :cond_32
+    if-lez v0, :cond_2b
 
-    goto :goto_22
+    goto :goto_1d
 
-    :cond_32
+    :cond_2b
     const-wide/16 v14, 0x0
 
-    :goto_22
+    :goto_1d
     iput-wide v14, v13, Landroid/content/pm/UserInfo;->creationTime:J
 
-    const/4 v14, 0x1
-
-    iput-boolean v14, v13, Landroid/content/pm/UserInfo;->partial:Z
+    iput-boolean v7, v13, Landroid/content/pm/UserInfo;->partial:Z
 
     move/from16 v14, p5
 
@@ -6311,45 +6184,45 @@
 
     iput-object v0, v13, Landroid/content/pm/UserInfo;->lastLoggedInFingerprint:Ljava/lang/String;
 
-    invoke-virtual {v8}, Lcom/android/server/pm/UserTypeDetails;->hasBadge()Z
+    invoke-virtual {v10}, Lcom/android/server/pm/UserTypeDetails;->hasBadge()Z
 
     move-result v0
-    :try_end_c
-    .catchall {:try_start_c .. :try_end_c} :catchall_10
+    :try_end_d
+    .catchall {:try_start_d .. :try_end_d} :catchall_c
 
-    if-eqz v0, :cond_33
+    if-eqz v0, :cond_2c
 
     const/16 v0, -0x2710
 
-    if-eq v2, v0, :cond_33
+    if-eq v2, v0, :cond_2c
 
-    :try_start_d
-    invoke-virtual {v1, v2, v4}, Lcom/android/server/pm/UserManagerService;->getFreeProfileBadgeLU(ILjava/lang/String;)I
+    :try_start_e
+    invoke-virtual {v1, v2, v11}, Lcom/android/server/pm/UserManagerService;->getFreeProfileBadgeLU(ILjava/lang/String;)I
 
     move-result v0
 
     iput v0, v13, Landroid/content/pm/UserInfo;->profileBadge:I
-    :try_end_d
-    .catchall {:try_start_d .. :try_end_d} :catchall_3
+    :try_end_e
+    .catchall {:try_start_e .. :try_end_e} :catchall_4
 
-    :cond_33
-    :try_start_e
+    :cond_2c
+    :try_start_f
     new-instance v15, Lcom/android/server/pm/UserManagerService$UserData;
 
     invoke-direct {v15}, Lcom/android/server/pm/UserManagerService$UserData;-><init>()V
-    :try_end_e
-    .catchall {:try_start_e .. :try_end_e} :catchall_10
+    :try_end_f
+    .catchall {:try_start_f .. :try_end_f} :catchall_c
 
-    :try_start_f
+    :try_start_10
     iput-object v13, v15, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
     new-instance v0, Landroid/content/pm/UserProperties;
 
-    move/from16 v19, v3
+    move-object/from16 v16, v8
 
-    iget-object v3, v8, Lcom/android/server/pm/UserTypeDetails;->mDefaultUserProperties:Landroid/content/pm/UserProperties;
+    iget-object v8, v10, Lcom/android/server/pm/UserTypeDetails;->mDefaultUserProperties:Landroid/content/pm/UserProperties;
 
-    invoke-direct {v0, v3}, Landroid/content/pm/UserProperties;-><init>(Landroid/content/pm/UserProperties;)V
+    invoke-direct {v0, v8}, Landroid/content/pm/UserProperties;-><init>(Landroid/content/pm/UserProperties;)V
 
     iput-object v0, v15, Lcom/android/server/pm/UserManagerService$UserData;->userProperties:Landroid/content/pm/UserProperties;
 
@@ -6357,108 +6230,102 @@
 
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mUsers:Landroid/util/SparseArray;
 
-    iget-object v3, v15, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
+    iget-object v8, v15, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
-    iget v3, v3, Landroid/content/pm/UserInfo;->id:I
+    iget v8, v8, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-virtual {v0, v3, v15}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
+    invoke-virtual {v0, v8, v15}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
 
-    monitor-exit v11
-    :try_end_f
-    .catchall {:try_start_f .. :try_end_f} :catchall_f
+    monitor-exit v6
+    :try_end_10
+    .catchall {:try_start_10 .. :try_end_10} :catchall_b
 
-    :try_start_10
+    :try_start_11
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
 
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->writeUserListLP()V
-    :try_end_10
-    .catchall {:try_start_10 .. :try_end_10} :catchall_e
 
-    if-eqz v6, :cond_37
+    if-eqz v5, :cond_30
 
-    if-eqz v40, :cond_35
+    if-eqz v20, :cond_2e
 
-    :try_start_11
-    iget-object v0, v6, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
+    iget-object v0, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
-    iget v3, v0, Landroid/content/pm/UserInfo;->profileGroupId:I
+    iget v6, v0, Landroid/content/pm/UserInfo;->profileGroupId:I
 
-    const/16 v11, -0x2710
+    const/16 v8, -0x2710
 
-    if-ne v3, v11, :cond_34
+    if-ne v6, v8, :cond_2d
 
-    iget v3, v0, Landroid/content/pm/UserInfo;->id:I
+    iget v6, v0, Landroid/content/pm/UserInfo;->id:I
 
-    iput v3, v0, Landroid/content/pm/UserInfo;->profileGroupId:I
+    iput v6, v0, Landroid/content/pm/UserInfo;->profileGroupId:I
 
-    invoke-virtual {v1, v6}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
+    invoke-virtual {v1, v5}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    goto :goto_23
+    goto :goto_1e
 
-    :catchall_4
+    :catchall_5
     move-exception v0
 
-    move-object v9, v15
+    move-object v11, v15
 
-    goto/16 :goto_13
+    goto/16 :goto_2f
 
-    :cond_34
-    :goto_23
-    iget-object v0, v6, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
+    :cond_2d
+    :goto_1e
+    iget-object v0, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
     iget v0, v0, Landroid/content/pm/UserInfo;->profileGroupId:I
 
     iput v0, v13, Landroid/content/pm/UserInfo;->profileGroupId:I
 
-    goto :goto_24
+    goto :goto_1f
 
-    :cond_35
-    if-eqz v30, :cond_37
+    :cond_2e
+    if-eqz v22, :cond_30
 
-    iget-object v0, v6, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
+    iget-object v0, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
-    iget v3, v0, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
+    iget v6, v0, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
 
-    const/16 v11, -0x2710
+    const/16 v8, -0x2710
 
-    if-ne v3, v11, :cond_36
+    if-ne v6, v8, :cond_2f
 
-    iget v3, v0, Landroid/content/pm/UserInfo;->id:I
+    iget v6, v0, Landroid/content/pm/UserInfo;->id:I
 
-    iput v3, v0, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
+    iput v6, v0, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
 
-    invoke-virtual {v1, v6}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
+    invoke-virtual {v1, v5}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_36
-    iget-object v0, v6, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
+    :cond_2f
+    iget-object v0, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
     iget v0, v0, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
 
     iput v0, v13, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
-    :try_end_11
-    .catchall {:try_start_11 .. :try_end_11} :catchall_4
 
-    :cond_37
-    :goto_24
-    :try_start_12
-    monitor-exit v7
-    :try_end_12
-    .catchall {:try_start_12 .. :try_end_12} :catchall_e
+    :cond_30
+    :goto_1f
+    monitor-exit v4
+    :try_end_11
+    .catchall {:try_start_11 .. :try_end_11} :catchall_5
 
-    if-eqz v35, :cond_45
+    if-eqz v26, :cond_3e
 
-    :try_start_13
+    :try_start_12
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getDarManagerService()Lcom/samsung/android/knox/dar/IDarManagerService;
 
     move-result-object v0
 
-    const-string/jumbo v3, "UserManagerService"
-    :try_end_13
-    .catchall {:try_start_13 .. :try_end_13} :catchall_5
+    const-string/jumbo v4, "UserManagerService"
+    :try_end_12
+    .catchall {:try_start_12 .. :try_end_12} :catchall_6
 
-    if-eqz v0, :cond_38
+    if-eqz v0, :cond_31
 
-    :try_start_14
+    :try_start_13
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getDarManagerService()Lcom/samsung/android/knox/dar/IDarManagerService;
 
     move-result-object v0
@@ -6466,112 +6333,109 @@
     invoke-interface {v0}, Lcom/samsung/android/knox/dar/IDarManagerService;->isKnoxKeyInstallable()Z
 
     move-result v0
-    :try_end_14
-    .catch Landroid/os/RemoteException; {:try_start_14 .. :try_end_14} :catch_0
-    .catchall {:try_start_14 .. :try_end_14} :catchall_5
+    :try_end_13
+    .catch Landroid/os/RemoteException; {:try_start_13 .. :try_end_13} :catch_0
+    .catchall {:try_start_13 .. :try_end_13} :catchall_6
 
-    goto :goto_26
+    goto :goto_21
 
     :catch_0
     move-exception v0
 
-    :try_start_15
-    new-instance v6, Ljava/lang/StringBuilder;
+    :try_start_14
+    new-instance v5, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v7, "check Device Integrity - Remote Exception : "
+    const-string/jumbo v6, "check Device Integrity - Remote Exception : "
 
-    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object v0
 
-    invoke-static {v3, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_25
-    const/4 v0, 0x0
+    :goto_20
+    move v0, v3
 
-    goto :goto_26
+    goto :goto_21
 
-    :cond_38
+    :cond_31
     const-string/jumbo v0, "check Device Integrity - failed. cannot get DAR Service"
 
-    invoke-static {v3, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_25
+    goto :goto_20
 
-    :goto_26
-    if-nez v0, :cond_3a
+    :goto_21
+    if-nez v0, :cond_33
 
     const-string/jumbo v0, "UserManagerService"
 
     const-string v2, "Failed in device integrity check"
 
     invoke-static {v0, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_15
-    .catchall {:try_start_15 .. :try_end_15} :catchall_5
+    :try_end_14
+    .catchall {:try_start_14 .. :try_end_14} :catchall_6
 
-    if-eqz v28, :cond_39
+    if-eqz v17, :cond_32
 
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_39
-    invoke-static/range {v36 .. v37}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :cond_32
+    invoke-static/range {v27 .. v28}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return-object p1
+    return-object v16
 
-    :catchall_5
+    :catchall_6
     move-exception v0
 
-    move-object v9, v15
-
-    const/4 v4, 0x0
+    :goto_22
+    move v11, v3
 
-    goto/16 :goto_36
+    goto/16 :goto_30
 
-    :cond_3a
-    :try_start_16
+    :cond_33
+    :try_start_15
     const-string/jumbo v0, "ro.product.first_api_level"
 
-    const/4 v3, 0x0
-
     invoke-static {v0, v3}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I
 
     move-result v0
 
-    const/16 v3, 0x23
+    const/16 v4, 0x23
 
-    if-lt v0, v3, :cond_3b
+    if-lt v0, v4, :cond_34
 
     const-string/jumbo v0, "UserManagerService"
 
-    const-string v3, "DRK is not supported from V OS"
+    const-string v4, "DRK is not supported from V OS"
 
-    invoke-static {v0, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/4 v0, 0x0
+    move v0, v3
 
-    goto :goto_27
+    goto :goto_23
 
-    :cond_3b
-    const/4 v0, 0x1
+    :cond_34
+    move v0, v7
 
-    :goto_27
-    if-eqz v0, :cond_3e
+    :goto_23
+    if-eqz v0, :cond_37
 
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getDarManagerService()Lcom/samsung/android/knox/dar/IDarManagerService;
 
     move-result-object v0
 
-    const-string/jumbo v3, "UserManagerService"
-    :try_end_16
-    .catchall {:try_start_16 .. :try_end_16} :catchall_5
+    const-string/jumbo v4, "UserManagerService"
+    :try_end_15
+    .catchall {:try_start_15 .. :try_end_15} :catchall_6
 
-    if-eqz v0, :cond_3c
+    if-eqz v0, :cond_35
 
-    :try_start_17
+    :try_start_16
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getDarManagerService()Lcom/samsung/android/knox/dar/IDarManagerService;
 
     move-result-object v0
@@ -6579,296 +6443,272 @@
     invoke-interface {v0}, Lcom/samsung/android/knox/dar/IDarManagerService;->isDeviceRootKeyInstalled()Z
 
     move-result v0
-    :try_end_17
-    .catch Landroid/os/RemoteException; {:try_start_17 .. :try_end_17} :catch_1
-    .catchall {:try_start_17 .. :try_end_17} :catchall_5
+    :try_end_16
+    .catch Landroid/os/RemoteException; {:try_start_16 .. :try_end_16} :catch_1
+    .catchall {:try_start_16 .. :try_end_16} :catchall_6
 
-    goto :goto_29
+    goto :goto_25
 
     :catch_1
     move-exception v0
 
-    :try_start_18
-    new-instance v6, Ljava/lang/StringBuilder;
+    :try_start_17
+    new-instance v5, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v7, "check Device Root Key - Remote Exception : "
+    const-string/jumbo v6, "check Device Root Key - Remote Exception : "
 
-    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object v0
 
-    invoke-static {v3, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_28
-    const/4 v0, 0x0
+    :goto_24
+    move v0, v3
 
-    goto :goto_29
+    goto :goto_25
 
-    :cond_3c
+    :cond_35
     const-string/jumbo v0, "check Device Root Key - failed. cannot get DAR Service"
 
-    invoke-static {v3, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_28
+    goto :goto_24
 
-    :goto_29
-    if-nez v0, :cond_3e
+    :goto_25
+    if-nez v0, :cond_37
 
     const-string/jumbo v0, "UserManagerService"
 
     const-string v2, "Failed in (DRK)Device Root Key check"
 
     invoke-static {v0, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_18
-    .catchall {:try_start_18 .. :try_end_18} :catchall_5
+    :try_end_17
+    .catchall {:try_start_17 .. :try_end_17} :catchall_6
 
-    if-eqz v28, :cond_3d
+    if-eqz v17, :cond_36
 
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_3d
-    invoke-static/range {v36 .. v37}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :cond_36
+    invoke-static/range {v27 .. v28}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return-object p1
+    return-object v16
 
-    :cond_3e
-    :try_start_19
+    :cond_37
+    :try_start_18
     const-string v0, "KnoxTestKeyUMS"
-    :try_end_19
-    .catchall {:try_start_19 .. :try_end_19} :catchall_5
-
-    :try_start_1a
-    new-instance v3, Lcom/samsung/android/security/keystore/AttestationUtils;
-
-    invoke-direct {v3}, Lcom/samsung/android/security/keystore/AttestationUtils;-><init>()V
-
-    new-instance v6, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;
-
-    sget-object v7, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
-
-    const/16 v11, 0x8
+    :try_end_18
+    .catchall {:try_start_18 .. :try_end_18} :catchall_6
 
-    invoke-virtual {v7, v11}, Ljava/security/SecureRandom;->generateSeed(I)[B
+    :try_start_19
+    new-instance v4, Lcom/samsung/android/security/keystore/AttestationUtils;
 
-    move-result-object v7
+    invoke-direct {v4}, Lcom/samsung/android/security/keystore/AttestationUtils;-><init>()V
 
-    invoke-direct {v6, v0, v7}, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;-><init>(Ljava/lang/String;[B)V
+    new-instance v5, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;
 
-    const-class v7, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;
+    sget-object v6, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
 
-    const-string/jumbo v11, "mVerifiableIntegrity"
+    invoke-virtual {v6, v9}, Ljava/security/SecureRandom;->generateSeed(I)[B
 
-    invoke-virtual {v7, v11}, Ljava/lang/Class;->getDeclaredField(Ljava/lang/String;)Ljava/lang/reflect/Field;
+    move-result-object v6
 
-    move-result-object v7
+    invoke-direct {v5, v0, v6}, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;-><init>(Ljava/lang/String;[B)V
 
-    const/4 v11, 0x1
+    const-class v6, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;
 
-    invoke-virtual {v7, v11}, Ljava/lang/reflect/Field;->setAccessible(Z)V
+    const-string/jumbo v8, "mVerifiableIntegrity"
 
-    sget-object v11, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
+    invoke-virtual {v6, v8}, Ljava/lang/Class;->getDeclaredField(Ljava/lang/String;)Ljava/lang/reflect/Field;
 
-    invoke-virtual {v7, v6, v11}, Ljava/lang/reflect/Field;->set(Ljava/lang/Object;Ljava/lang/Object;)V
+    move-result-object v6
 
-    new-instance v7, Lcom/samsung/android/security/keystore/AttestParameterSpec;
+    invoke-virtual {v6, v7}, Ljava/lang/reflect/Field;->setAccessible(Z)V
 
-    iget-boolean v11, v6, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;->mVerifiableIntegrity:Z
+    sget-object v8, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
 
-    move-object/from16 p2, v0
+    invoke-virtual {v6, v5, v8}, Ljava/lang/reflect/Field;->set(Ljava/lang/Object;Ljava/lang/Object;)V
 
-    iget-object v0, v6, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;->mSpec:Landroid/security/keystore/KeyGenParameterSpec;
+    new-instance v6, Lcom/samsung/android/security/keystore/AttestParameterSpec;
 
-    iget-object v6, v6, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;->mChallenge:[B
-    :try_end_1a
-    .catch Ljava/lang/Exception; {:try_start_1a .. :try_end_1a} :catch_3
-    .catchall {:try_start_1a .. :try_end_1a} :catchall_5
+    iget-boolean v8, v5, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;->mVerifiableIntegrity:Z
 
-    move/from16 v20, v12
+    iget-object v9, v5, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;->mSpec:Landroid/security/keystore/KeyGenParameterSpec;
 
-    const/4 v12, 0x0
+    iget-object v5, v5, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;->mChallenge:[B
 
-    :try_start_1b
-    invoke-direct {v7, v6, v11, v12, v0}, Lcom/samsung/android/security/keystore/AttestParameterSpec;-><init>([BZZLandroid/security/keystore/KeyGenParameterSpec;)V
+    invoke-direct {v6, v5, v8, v3, v9}, Lcom/samsung/android/security/keystore/AttestParameterSpec;-><init>([BZZLandroid/security/keystore/KeyGenParameterSpec;)V
 
-    invoke-virtual {v3, v7}, Lcom/samsung/android/security/keystore/AttestationUtils;->generateKeyPair(Lcom/samsung/android/security/keystore/AttestParameterSpec;)Ljava/security/KeyPair;
+    invoke-virtual {v4, v6}, Lcom/samsung/android/security/keystore/AttestationUtils;->generateKeyPair(Lcom/samsung/android/security/keystore/AttestParameterSpec;)Ljava/security/KeyPair;
 
-    move-result-object v0
+    move-result-object v4
 
-    const-string/jumbo v3, "dar"
+    const-string/jumbo v5, "dar"
 
-    invoke-static {v3}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
+    invoke-static {v5}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
 
-    move-result-object v3
+    move-result-object v5
 
-    check-cast v3, Lcom/android/server/knox/dar/DarManagerService;
+    check-cast v5, Lcom/android/server/knox/dar/DarManagerService;
 
-    if-eqz v0, :cond_3f
+    if-eqz v4, :cond_38
 
-    if-eqz v3, :cond_3f
+    if-eqz v5, :cond_38
 
-    invoke-static/range {p2 .. p2}, Lcom/samsung/android/security/keystore/AttestationUtils;->getCertificateChain(Ljava/lang/String;)[Ljava/security/cert/Certificate;
+    invoke-static {v0}, Lcom/samsung/android/security/keystore/AttestationUtils;->getCertificateChain(Ljava/lang/String;)[Ljava/security/cert/Certificate;
 
-    move-result-object v0
+    move-result-object v4
 
-    if-eqz v0, :cond_3f
+    if-eqz v4, :cond_38
 
-    invoke-static/range {p2 .. p2}, Lcom/samsung/android/security/keystore/AttestationUtils;->deleteKey(Ljava/lang/String;)V
+    invoke-static {v0}, Lcom/samsung/android/security/keystore/AttestationUtils;->deleteKey(Ljava/lang/String;)V
 
-    goto :goto_2d
+    goto :goto_29
 
     :catch_2
     move-exception v0
 
-    goto :goto_2a
+    goto :goto_26
 
-    :cond_3f
+    :cond_38
     const-string/jumbo v0, "UserManagerService"
 
-    const-string v3, "Failed in device integrity check"
+    const-string v4, "Failed in device integrity check"
 
-    invoke-static {v0, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_1b
-    .catch Ljava/lang/Exception; {:try_start_1b .. :try_end_1b} :catch_2
-    .catchall {:try_start_1b .. :try_end_1b} :catchall_5
+    invoke-static {v0, v4}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    :try_end_19
+    .catch Ljava/lang/Exception; {:try_start_19 .. :try_end_19} :catch_2
+    .catchall {:try_start_19 .. :try_end_19} :catchall_6
 
-    if-eqz v28, :cond_40
+    if-eqz v17, :cond_39
 
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_40
-    invoke-static/range {v36 .. v37}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-object p1
-
-    :catch_3
-    move-exception v0
+    :cond_39
+    invoke-static/range {v27 .. v28}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    move/from16 v20, v12
+    return-object v16
 
-    :goto_2a
-    :try_start_1c
-    const-string/jumbo v3, "UserManagerService"
+    :goto_26
+    :try_start_1a
+    const-string/jumbo v4, "UserManagerService"
 
-    const-string v6, "Device integrity status is abnormal."
+    const-string v5, "Device integrity status is abnormal."
 
-    invoke-static {v3, v6}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v5}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
 
     new-instance v0, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;
 
-    iget-object v3, v1, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
 
-    invoke-direct {v0, v3}, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;-><init>(Landroid/content/Context;)V
+    invoke-direct {v0, v4}, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;-><init>(Landroid/content/Context;)V
 
     invoke-static {v13}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
 
-    move-result v3
+    move-result v4
 
-    if-eqz v3, :cond_42
+    if-eqz v4, :cond_3b
 
     invoke-virtual {v0}, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;->isConnected()Z
 
-    move-result v3
+    move-result v4
 
-    if-eqz v3, :cond_42
+    if-eqz v4, :cond_3b
 
-    const/4 v3, 0x7
+    const/4 v4, 0x7
 
-    invoke-virtual {v0, v3}, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;->getStatus(I)I
+    invoke-virtual {v0, v4}, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;->getStatus(I)I
 
     move-result v0
 
-    const/4 v11, 0x1
+    if-ne v0, v7, :cond_3a
 
-    if-ne v0, v11, :cond_41
+    move v0, v7
 
-    const/4 v0, 0x1
+    goto :goto_27
 
-    goto :goto_2b
+    :cond_3a
+    move v0, v3
 
-    :cond_41
-    const/4 v0, 0x0
+    :goto_27
+    const-string/jumbo v4, "UserManagerService"
 
-    :goto_2b
-    const-string/jumbo v3, "UserManagerService"
+    new-instance v5, Ljava/lang/StringBuilder;
 
-    new-instance v6, Ljava/lang/StringBuilder;
+    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
 
-    move-object/from16 v7, v29
+    const-string v6, "EM Token status : "
 
-    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-static {v3, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_2c
+    goto :goto_28
 
-    :cond_42
-    const/4 v0, 0x0
+    :cond_3b
+    move v0, v3
 
-    :goto_2c
-    if-eqz v0, :cond_43
+    :goto_28
+    if-eqz v0, :cond_3c
 
     const-string/jumbo v0, "UserManagerService"
 
-    const-string v3, "Device integrity status is abnormal. But, EM Token is allowed. Continue - "
+    const-string v4, "Device integrity status is abnormal. But, EM Token is allowed. Continue - "
 
-    invoke-static {v0, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_1c
-    .catchall {:try_start_1c .. :try_end_1c} :catchall_5
+    invoke-static {v0, v4}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    :try_end_1a
+    .catchall {:try_start_1a .. :try_end_1a} :catchall_6
 
-    goto :goto_2d
+    goto :goto_29
 
-    :cond_43
-    if-eqz v28, :cond_44
+    :cond_3c
+    if-eqz v17, :cond_3d
 
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_44
-    invoke-static/range {v36 .. v37}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-object p1
+    :cond_3d
+    invoke-static/range {v27 .. v28}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :cond_45
-    move/from16 v20, v12
+    return-object v16
 
-    :goto_2d
-    if-eqz v40, :cond_46
+    :cond_3e
+    :goto_29
+    if-eqz v20, :cond_3f
 
-    if-nez v14, :cond_46
+    if-nez v14, :cond_3f
 
-    :try_start_1d
+    :try_start_1b
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->sPersonaManager:Lcom/android/server/pm/PersonaManagerService;
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v9}, Lcom/android/server/pm/PersonaManagerService;->clearStorageForUser(I)V
-    :try_end_1d
-    .catchall {:try_start_1d .. :try_end_1d} :catchall_5
+    invoke-static {v12}, Lcom/android/server/pm/PersonaManagerService;->clearStorageForUser(I)V
 
-    :cond_46
-    :try_start_1e
+    :cond_3f
     const-string/jumbo v0, "createUserStorageKeys"
 
-    move-object/from16 v3, p7
+    move-object/from16 v4, p7
 
-    invoke-virtual {v3, v0}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+    invoke-virtual {v4, v0}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
 
-    const-class v6, Landroid/os/storage/StorageManager;
+    const-class v5, Landroid/os/storage/StorageManager;
 
-    invoke-virtual {v0, v6}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
+    invoke-virtual {v0, v5}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
 
     move-result-object v0
 
@@ -6876,271 +6716,182 @@
 
     invoke-virtual {v13}, Landroid/content/pm/UserInfo;->isEphemeral()Z
 
-    move-result v6
+    move-result v5
 
-    invoke-virtual {v0, v9, v6}, Landroid/os/storage/StorageManager;->createUserStorageKeys(IZ)V
+    invoke-virtual {v0, v12, v5}, Landroid/os/storage/StorageManager;->createUserStorageKeys(IZ)V
 
-    invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
+    invoke-virtual {v4}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
     const-string/jumbo v0, "prepareUserData"
 
-    invoke-virtual {v3, v0}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+    invoke-virtual {v4, v0}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mUserDataPreparer:Lcom/android/server/pm/UserDataPreparer;
 
-    const/4 v11, 0x1
-
-    invoke-virtual {v0, v11, v13}, Lcom/android/server/pm/UserDataPreparer;->prepareUserData(ILandroid/content/pm/UserInfo;)V
-
-    invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
-    :try_end_1e
-    .catchall {:try_start_1e .. :try_end_1e} :catchall_9
-
-    if-eqz v31, :cond_4a
-
-    if-nez v33, :cond_47
-
-    if-eqz v34, :cond_4a
-
-    :cond_47
-    :try_start_1f
-    const-string/jumbo v0, "UserManagerService"
-
-    new-instance v6, Ljava/lang/StringBuilder;
-
-    move-object/from16 v7, v27
-
-    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-static {v0, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v0
-
-    invoke-virtual {v0, v9}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->handleWorkspaceCreation(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_49
-
-    const-string/jumbo v0, "UserManagerService"
-
-    const-string v2, "DualDAR Setup failed during workspace creation"
-
-    invoke-static {v0, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_1f
-    .catchall {:try_start_1f .. :try_end_1f} :catchall_5
-
-    if-eqz v28, :cond_48
-
-    invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
-
-    :cond_48
-    invoke-static/range {v36 .. v37}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-object p1
-
-    :cond_49
-    :try_start_20
-    sget-object v0, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_CREATED:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v9, v0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
+    invoke-virtual {v0, v7, v13}, Lcom/android/server/pm/UserDataPreparer;->prepareUserData(ILandroid/content/pm/UserInfo;)V
 
-    iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mLocalService:Lcom/android/server/pm/UserManagerService$LocalService;
+    invoke-virtual {v4}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
-    invoke-virtual {v0, v9, v10}, Lcom/android/server/pm/UserManagerService$LocalService;->setDualDarInfo(II)Z
-    :try_end_20
-    .catchall {:try_start_20 .. :try_end_20} :catchall_5
-
-    :cond_4a
-    :try_start_21
     const-string v0, "LSS.createNewUser"
 
-    invoke-virtual {v3, v0}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+    invoke-virtual {v4, v0}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    iget v6, v13, Landroid/content/pm/UserInfo;->serialNumber:I
+    iget v5, v13, Landroid/content/pm/UserInfo;->serialNumber:I
 
-    invoke-virtual {v0, v9, v6}, Lcom/android/internal/widget/LockPatternUtils;->createNewUser(II)V
+    invoke-virtual {v0, v12, v5}, Lcom/android/internal/widget/LockPatternUtils;->createNewUser(II)V
 
-    invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
+    invoke-virtual {v4}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mSystemPackageInstaller:Lcom/android/server/pm/UserSystemPackageInstaller;
 
-    invoke-virtual {v0, v4}, Lcom/android/server/pm/UserSystemPackageInstaller;->getInstallablePackagesForUserType(Ljava/lang/String;)Ljava/util/Set;
+    invoke-virtual {v0, v11}, Lcom/android/server/pm/UserSystemPackageInstaller;->getInstallablePackagesForUserType(Ljava/lang/String;)Ljava/util/Set;
 
     move-result-object v0
 
-    const-string/jumbo v4, "PM.createNewUser"
+    const-string/jumbo v5, "PM.createNewUser"
 
-    invoke-virtual {v3, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+    invoke-virtual {v4, v5}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
-    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
+    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
 
     move-object/from16 v6, p6
 
-    invoke-virtual {v4, v9, v0, v6}, Lcom/android/server/pm/PackageManagerService;->createNewUser(ILjava/util/Set;[Ljava/lang/String;)V
+    invoke-virtual {v5, v12, v0, v6}, Lcom/android/server/pm/PackageManagerService;->createNewUser(ILjava/util/Set;[Ljava/lang/String;)V
 
-    invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
+    invoke-virtual {v4}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
     new-instance v0, Landroid/os/Bundle;
 
     invoke-direct {v0}, Landroid/os/Bundle;-><init>()V
-    :try_end_21
-    .catchall {:try_start_21 .. :try_end_21} :catchall_9
 
-    if-eqz v20, :cond_4b
+    if-eqz v21, :cond_40
 
-    :try_start_22
-    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mGuestRestrictions:Landroid/os/Bundle;
+    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mGuestRestrictions:Landroid/os/Bundle;
 
-    monitor-enter v4
-    :try_end_22
-    .catchall {:try_start_22 .. :try_end_22} :catchall_5
+    monitor-enter v5
+    :try_end_1b
+    .catchall {:try_start_1b .. :try_end_1b} :catchall_6
 
-    :try_start_23
+    :try_start_1c
     iget-object v6, v1, Lcom/android/server/pm/UserManagerService;->mGuestRestrictions:Landroid/os/Bundle;
 
     invoke-virtual {v0, v6}, Landroid/os/Bundle;->putAll(Landroid/os/Bundle;)V
 
-    monitor-exit v4
+    monitor-exit v5
 
-    goto :goto_2e
+    goto :goto_2a
 
-    :catchall_6
+    :catchall_7
     move-exception v0
 
-    monitor-exit v4
-    :try_end_23
-    .catchall {:try_start_23 .. :try_end_23} :catchall_6
+    monitor-exit v5
+    :try_end_1c
+    .catchall {:try_start_1c .. :try_end_1c} :catchall_7
 
-    :try_start_24
+    :try_start_1d
     throw v0
-    :try_end_24
-    .catchall {:try_start_24 .. :try_end_24} :catchall_5
 
-    :cond_4b
-    :try_start_25
-    iget-object v4, v8, Lcom/android/server/pm/UserTypeDetails;->mDefaultRestrictions:Landroid/os/Bundle;
+    :cond_40
+    iget-object v5, v10, Lcom/android/server/pm/UserTypeDetails;->mDefaultRestrictions:Landroid/os/Bundle;
 
-    invoke-static {v0, v4}, Lcom/android/server/pm/UserRestrictionsUtils;->merge(Landroid/os/Bundle;Landroid/os/Bundle;)V
-    :try_end_25
-    .catchall {:try_start_25 .. :try_end_25} :catchall_9
+    invoke-static {v0, v5}, Lcom/android/server/pm/UserRestrictionsUtils;->merge(Landroid/os/Bundle;Landroid/os/Bundle;)V
 
-    if-eqz v32, :cond_4c
+    if-eqz v29, :cond_41
 
-    :try_start_26
-    const-string/jumbo v4, "no_outgoing_calls"
+    const-string/jumbo v5, "no_outgoing_calls"
 
-    invoke-virtual {v0, v4}, Landroid/os/Bundle;->remove(Ljava/lang/String;)V
+    invoke-virtual {v0, v5}, Landroid/os/Bundle;->remove(Ljava/lang/String;)V
 
-    const-string/jumbo v4, "no_sms"
+    const-string/jumbo v5, "no_sms"
 
-    invoke-virtual {v0, v4}, Landroid/os/Bundle;->remove(Ljava/lang/String;)V
-    :try_end_26
-    .catchall {:try_start_26 .. :try_end_26} :catchall_5
+    invoke-virtual {v0, v5}, Landroid/os/Bundle;->remove(Ljava/lang/String;)V
 
-    :cond_4c
-    :goto_2e
-    :try_start_27
-    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mRestrictionsLock:Ljava/lang/Object;
+    :cond_41
+    :goto_2a
+    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mRestrictionsLock:Ljava/lang/Object;
 
-    monitor-enter v4
-    :try_end_27
-    .catchall {:try_start_27 .. :try_end_27} :catchall_9
+    monitor-enter v5
+    :try_end_1d
+    .catchall {:try_start_1d .. :try_end_1d} :catchall_6
 
-    :try_start_28
+    :try_start_1e
     iget-object v6, v1, Lcom/android/server/pm/UserManagerService;->mBaseUserRestrictions:Lcom/android/server/pm/RestrictionsSet;
 
-    invoke-virtual {v6, v9, v0}, Lcom/android/server/pm/RestrictionsSet;->updateRestrictions(ILandroid/os/Bundle;)Z
+    invoke-virtual {v6, v12, v0}, Lcom/android/server/pm/RestrictionsSet;->updateRestrictions(ILandroid/os/Bundle;)Z
 
-    monitor-exit v4
-    :try_end_28
-    .catchall {:try_start_28 .. :try_end_28} :catchall_c
-
-    const/4 v12, 0x0
+    monitor-exit v5
+    :try_end_1e
+    .catchall {:try_start_1e .. :try_end_1e} :catchall_a
 
-    :try_start_29
-    iput-boolean v12, v13, Landroid/content/pm/UserInfo;->partial:Z
-    :try_end_29
-    .catchall {:try_start_29 .. :try_end_29} :catchall_8
+    :try_start_1f
+    iput-boolean v3, v13, Landroid/content/pm/UserInfo;->partial:Z
 
-    :try_start_2a
     invoke-static {}, Landroid/os/UserManager;->invalidateCacheOnUserListChange()V
 
-    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mPackagesLock:Ljava/lang/Object;
+    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mPackagesLock:Ljava/lang/Object;
 
-    monitor-enter v4
-    :try_end_2a
-    .catchall {:try_start_2a .. :try_end_2a} :catchall_9
+    monitor-enter v5
+    :try_end_1f
+    .catchall {:try_start_1f .. :try_end_1f} :catchall_6
 
-    :try_start_2b
+    :try_start_20
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    monitor-exit v4
-    :try_end_2b
-    .catchall {:try_start_2b .. :try_end_2b} :catchall_a
+    monitor-exit v5
+    :try_end_20
+    .catchall {:try_start_20 .. :try_end_20} :catchall_9
 
-    :try_start_2c
+    :try_start_21
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->updateUserIds()V
 
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v5, Ljava/lang/StringBuilder;
 
-    move-object/from16 v6, v25
+    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-direct {v4, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    const-string/jumbo v6, "PM.onNewUserCreated-"
 
-    invoke-virtual {v4, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v5, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    move-result-object v4
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-virtual {v3, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+    move-result-object v5
 
-    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
-    :try_end_2c
-    .catchall {:try_start_2c .. :try_end_2c} :catchall_9
+    invoke-virtual {v4, v5}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
-    const/4 v12, 0x0
+    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
 
-    :try_start_2d
-    invoke-virtual {v4, v9, v12}, Lcom/android/server/pm/PackageManagerService;->onNewUserCreated(IZ)V
+    invoke-virtual {v5, v12, v3}, Lcom/android/server/pm/PackageManagerService;->onNewUserCreated(IZ)V
 
-    invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
+    invoke-virtual {v4}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
-    invoke-virtual {v1, v8, v9}, Lcom/android/server/pm/UserManagerService;->applyDefaultUserSettings(Lcom/android/server/pm/UserTypeDetails;I)V
+    invoke-virtual {v1, v10, v12}, Lcom/android/server/pm/UserManagerService;->applyDefaultUserSettings(Lcom/android/server/pm/UserTypeDetails;I)V
 
-    invoke-virtual {v1, v9, v8, v0, v2}, Lcom/android/server/pm/UserManagerService;->setDefaultCrossProfileIntentFilters(ILcom/android/server/pm/UserTypeDetails;Landroid/os/Bundle;I)V
-    :try_end_2d
-    .catchall {:try_start_2d .. :try_end_2d} :catchall_8
+    invoke-virtual {v1, v12, v10, v0, v2}, Lcom/android/server/pm/UserManagerService;->setDefaultCrossProfileIntentFilters(ILcom/android/server/pm/UserTypeDetails;Landroid/os/Bundle;I)V
+    :try_end_21
+    .catchall {:try_start_21 .. :try_end_21} :catchall_6
 
-    if-eqz v14, :cond_4d
+    if-eqz v14, :cond_42
 
-    :try_start_2e
+    :try_start_22
     const-string/jumbo v0, "UserManagerService"
 
     new-instance v2, Ljava/lang/StringBuilder;
 
-    move-object/from16 v3, v18
+    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    const-string/jumbo v4, "starting pre-created user "
+
+    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v13}, Landroid/content/pm/UserInfo;->toFullString()Ljava/lang/String;
 
-    move-result-object v3
+    move-result-object v4
 
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
@@ -7151,80 +6902,111 @@
     invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;
 
     move-result-object v0
-    :try_end_2e
-    .catchall {:try_start_2e .. :try_end_2e} :catchall_7
+    :try_end_22
+    .catchall {:try_start_22 .. :try_end_22} :catchall_8
 
-    :try_start_2f
-    invoke-interface {v0, v9}, Landroid/app/IActivityManager;->startUserInBackground(I)Z
-    :try_end_2f
-    .catch Landroid/os/RemoteException; {:try_start_2f .. :try_end_2f} :catch_4
-    .catchall {:try_start_2f .. :try_end_2f} :catchall_7
+    :try_start_23
+    invoke-interface {v0, v12}, Landroid/app/IActivityManager;->startUserInBackground(I)Z
+    :try_end_23
+    .catch Landroid/os/RemoteException; {:try_start_23 .. :try_end_23} :catch_3
+    .catchall {:try_start_23 .. :try_end_23} :catchall_8
 
-    goto :goto_2f
+    goto :goto_2b
 
-    :catchall_7
+    :catchall_8
     move-exception v0
 
-    move-object v9, v15
+    move/from16 v11, v17
 
-    move/from16 v4, v28
+    goto/16 :goto_30
 
-    goto/16 :goto_36
-
-    :catch_4
+    :catch_3
     move-exception v0
 
-    :try_start_30
+    :try_start_24
     const-string/jumbo v2, "UserManagerService"
 
-    new-instance v3, Ljava/lang/StringBuilder;
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    move-object/from16 v4, v17
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    const-string/jumbo v5, "could not start pre-created user "
 
-    invoke-virtual {v3, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v4, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    move-result-object v3
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-static {v2, v3, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    move-result-object v4
 
-    goto :goto_2f
+    invoke-static {v2, v4, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto :goto_2b
+
+    :cond_42
+    move-object/from16 v5, p8
 
-    :cond_4d
     invoke-virtual {v1, v13, v5}, Lcom/android/server/pm/UserManagerService;->dispatchUserAdded(Landroid/content/pm/UserInfo;Ljava/lang/Object;)V
 
-    :goto_2f
-    if-nez v31, :cond_4e
+    :goto_2b
+    if-nez v23, :cond_43
 
-    if-eqz p3, :cond_50
+    if-eqz v25, :cond_46
 
-    :cond_4e
-    if-nez v38, :cond_50
+    :cond_43
+    if-nez v19, :cond_46
 
-    if-eqz v19, :cond_4f
+    if-eqz v18, :cond_45
 
-    invoke-static {v13}, Lcom/android/server/pm/UserManagerService;->setResetTokenForSecureFolder(Landroid/content/pm/UserInfo;)V
+    const-string/jumbo v0, "dar"
 
-    iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
+    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
 
-    move-object/from16 v2, p1
+    move-result-object v0
 
-    const/4 v11, 0x1
+    check-cast v0, Lcom/android/server/knox/dar/DarManagerService;
+
+    if-eqz v0, :cond_44
+
+    iget v2, v13, Landroid/content/pm/UserInfo;->id:I
+
+    invoke-virtual {v0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
+
+    iget-object v4, v0, Lcom/android/server/knox/dar/DarManagerService;->mDarHandler:Lcom/android/server/knox/dar/DarManagerService$DarHandler;
+
+    const/16 v5, 0x76
+
+    invoke-virtual {v4, v5, v2, v3}, Landroid/os/Handler;->obtainMessage(III)Landroid/os/Message;
+
+    move-result-object v2
+
+    move-object/from16 v8, v16
+
+    iput-object v8, v2, Landroid/os/Message;->obj:Ljava/lang/Object;
+
+    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService;->mDarHandler:Lcom/android/server/knox/dar/DarManagerService$DarHandler;
+
+    invoke-virtual {v0, v2}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z
+
+    :cond_44
+    iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
+
+    const/4 v8, 0x0
 
-    invoke-virtual {v0, v9, v11, v2}, Lcom/android/internal/widget/LockPatternUtils;->setSeparateProfileChallengeEnabled(IZLcom/android/internal/widget/LockscreenCredential;)V
+    invoke-virtual {v0, v12, v7, v8}, Lcom/android/internal/widget/LockPatternUtils;->setSeparateProfileChallengeEnabled(IZLcom/android/internal/widget/LockscreenCredential;)V
 
     const-string/jumbo v0, "UserManagerService.DAR"
 
     new-instance v2, Ljava/lang/StringBuilder;
 
-    move-object/from16 v3, v16
+    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    const-string v3, "Creating SecureFolder user - Separate challenge is enabled for user "
 
-    invoke-virtual {v2, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v2, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
@@ -7232,19 +7014,19 @@
 
     invoke-static {v0, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_4f
+    :cond_45
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->sPersonaManager:Lcom/android/server/pm/PersonaManagerService;
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     invoke-static {v13}, Lcom/android/server/pm/PersonaManagerService;->onNewUserCreated(Landroid/content/pm/UserInfo;)V
-    :try_end_30
-    .catchall {:try_start_30 .. :try_end_30} :catchall_7
+    :try_end_24
+    .catchall {:try_start_24 .. :try_end_24} :catchall_8
 
-    :cond_50
-    if-eqz v28, :cond_52
+    :cond_46
+    if-eqz v17, :cond_48
 
-    if-eqz v28, :cond_51
+    if-eqz v17, :cond_47
 
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
 
@@ -7256,157 +7038,121 @@
 
     invoke-virtual {v0}, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;->finishUserCreation()V
 
-    goto :goto_30
+    goto :goto_2c
 
-    :cond_51
+    :cond_47
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_52
-    :goto_30
-    invoke-static/range {v36 .. v37}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :cond_48
+    :goto_2c
+    invoke-static/range {v27 .. v28}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return-object v13
 
-    :catchall_8
-    move-exception v0
-
-    :goto_31
-    move v4, v12
-
-    move-object v9, v15
-
-    goto :goto_36
-
     :catchall_9
     move-exception v0
 
-    const/4 v12, 0x0
+    :try_start_25
+    monitor-exit v5
+    :try_end_25
+    .catchall {:try_start_25 .. :try_end_25} :catchall_9
 
-    goto :goto_31
+    :try_start_26
+    throw v0
+    :try_end_26
+    .catchall {:try_start_26 .. :try_end_26} :catchall_6
 
     :catchall_a
     move-exception v0
 
-    const/4 v12, 0x0
-
-    :goto_32
-    :try_start_31
-    monitor-exit v4
-    :try_end_31
-    .catchall {:try_start_31 .. :try_end_31} :catchall_b
+    :try_start_27
+    monitor-exit v5
+    :try_end_27
+    .catchall {:try_start_27 .. :try_end_27} :catchall_a
 
-    :try_start_32
+    :try_start_28
     throw v0
-    :try_end_32
-    .catchall {:try_start_32 .. :try_end_32} :catchall_8
+    :try_end_28
+    .catchall {:try_start_28 .. :try_end_28} :catchall_6
 
     :catchall_b
     move-exception v0
 
-    goto :goto_32
+    move-object v11, v15
+
+    goto :goto_2e
 
     :catchall_c
     move-exception v0
 
-    const/4 v12, 0x0
-
-    :goto_33
-    :try_start_33
-    monitor-exit v4
-    :try_end_33
-    .catchall {:try_start_33 .. :try_end_33} :catchall_d
+    :goto_2d
+    const/4 v11, 0x0
 
-    :try_start_34
-    throw v0
-    :try_end_34
-    .catchall {:try_start_34 .. :try_end_34} :catchall_8
+    goto :goto_2e
 
     :catchall_d
     move-exception v0
 
-    goto :goto_33
-
-    :catchall_e
-    move-exception v0
-
-    const/4 v12, 0x0
-
-    move-object v9, v15
-
-    goto :goto_35
-
-    :catchall_f
-    move-exception v0
-
-    const/4 v12, 0x0
-
-    move-object v9, v15
-
-    goto :goto_34
-
-    :catchall_10
-    move-exception v0
-
-    const/4 v12, 0x0
+    const/4 v3, 0x0
 
-    const/4 v9, 0x0
+    goto :goto_2d
 
-    :goto_34
-    :try_start_35
-    monitor-exit v11
-    :try_end_35
-    .catchall {:try_start_35 .. :try_end_35} :catchall_12
+    :goto_2e
+    :try_start_29
+    monitor-exit v6
+    :try_end_29
+    .catchall {:try_start_29 .. :try_end_29} :catchall_f
 
-    :try_start_36
+    :try_start_2a
     throw v0
 
-    :catchall_11
+    :catchall_e
     move-exception v0
 
-    goto :goto_35
+    goto :goto_2f
 
-    :catchall_12
+    :catchall_f
     move-exception v0
 
-    goto :goto_34
+    goto :goto_2e
 
-    :catchall_13
+    :catchall_10
     move-exception v0
 
-    const/4 v12, 0x0
+    const/4 v3, 0x0
 
-    const/4 v9, 0x0
+    const/4 v11, 0x0
 
-    :goto_35
-    monitor-exit v7
-    :try_end_36
-    .catchall {:try_start_36 .. :try_end_36} :catchall_11
+    :goto_2f
+    monitor-exit v4
+    :try_end_2a
+    .catchall {:try_start_2a .. :try_end_2a} :catchall_e
 
-    :try_start_37
+    :try_start_2b
     throw v0
-    :try_end_37
-    .catchall {:try_start_37 .. :try_end_37} :catchall_14
+    :try_end_2b
+    .catchall {:try_start_2b .. :try_end_2b} :catchall_11
 
-    :catchall_14
+    :catchall_11
     move-exception v0
 
-    move v4, v12
+    move-object v15, v11
 
-    goto :goto_36
+    goto/16 :goto_22
 
-    :catchall_15
+    :catchall_12
     move-exception v0
 
-    const/4 v12, 0x0
+    const/4 v3, 0x0
 
-    move v4, v12
+    move v11, v3
 
-    const/4 v9, 0x0
+    const/4 v15, 0x0
 
-    :goto_36
-    if-eqz v28, :cond_54
+    :goto_30
+    if-eqz v17, :cond_4a
 
-    if-eqz v4, :cond_53
+    if-eqz v11, :cond_49
 
     iget-object v1, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
 
@@ -7418,48 +7164,50 @@
 
     invoke-virtual {v1}, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;->finishUserCreation()V
 
-    goto :goto_37
+    goto :goto_31
 
-    :cond_53
-    invoke-virtual {v1, v9}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
+    :cond_49
+    invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_54
-    :goto_37
-    invoke-static/range {v36 .. v37}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :cond_4a
+    :goto_31
+    invoke-static/range {v27 .. v28}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw v0
 
-    :cond_55
+    :cond_4b
     const-string v0, "Cannot add user. Not enough space on disk."
 
     const/4 v1, 0x5
 
     invoke-static {v1, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    const/4 v2, 0x0
+    const/16 v16, 0x0
 
-    throw v2
+    throw v16
 
-    :catchall_16
+    :catchall_13
     move-exception v0
 
-    :try_start_38
+    :try_start_2c
     monitor-exit v3
-    :try_end_38
-    .catchall {:try_start_38 .. :try_end_38} :catchall_16
+    :try_end_2c
+    .catchall {:try_start_2c .. :try_end_2c} :catchall_13
 
     throw v0
 
-    :goto_38
-    :try_start_39
-    monitor-exit v10
-    :try_end_39
-    .catchall {:try_start_39 .. :try_end_39} :catchall_0
+    :goto_32
+    :try_start_2d
+    monitor-exit v15
+    :try_end_2d
+    .catchall {:try_start_2d .. :try_end_2d} :catchall_0
 
     throw v0
 
-    :cond_56
-    move-object v4, v9
+    :cond_4c
+    move-object v11, v14
+
+    const/16 v9, 0x8
 
     new-instance v0, Ljava/lang/StringBuilder;
 
@@ -7467,7 +7215,7 @@
 
     invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     const-string v1, "."
 
@@ -7477,22 +7225,22 @@
 
     move-result-object v0
 
-    const/16 v11, 0x8
+    invoke-static {v9, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    invoke-static {v11, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
+    const/16 v16, 0x0
 
-    const/4 v2, 0x0
+    throw v16
 
-    throw v2
+    :cond_4d
+    const/4 v7, 0x1
 
-    :cond_57
-    move-object/from16 v2, p1
+    const/16 v16, 0x0
 
     new-instance v1, Ljava/lang/StringBuilder;
 
-    const-string v3, "Cannot add user. Flags ("
+    const-string v2, "Cannot add user. Flags ("
 
-    invoke-direct {v1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
     invoke-static {v0}, Ljava/lang/Integer;->toHexString(I)Ljava/lang/String;
 
@@ -7508,14 +7256,14 @@
 
     move-result-object v0
 
-    const/4 v11, 0x1
+    invoke-static {v7, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    invoke-static {v11, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
+    throw v16
 
-    throw v2
+    :cond_4e
+    move-object v11, v14
 
-    :cond_58
-    move-object v4, v9
+    const/4 v7, 0x1
 
     new-instance v1, Ljava/lang/StringBuilder;
 
@@ -7533,7 +7281,7 @@
 
     invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     const-string v0, ") are inconsistent."
 
@@ -7543,24 +7291,22 @@
 
     move-result-object v0
 
-    const/4 v11, 0x1
-
-    invoke-static {v11, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
+    invoke-static {v7, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    const/4 v2, 0x0
+    const/16 v16, 0x0
 
-    throw v2
+    throw v16
 
-    :cond_59
-    move-object/from16 v2, p1
+    :cond_4f
+    const/4 v7, 0x1
 
-    const/4 v11, 0x1
+    const/16 v16, 0x0
 
     new-instance v1, Ljava/lang/StringBuilder;
 
-    const-string v3, "Cannot create user of invalid user type: "
+    const-string v2, "Cannot create user of invalid user type: "
 
-    invoke-direct {v1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
     invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
@@ -7568,9 +7314,9 @@
 
     move-result-object v0
 
-    invoke-static {v11, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
+    invoke-static {v7, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
-    throw v2
+    throw v16
 .end method
 
 .method public final createUserWithAttributes(Ljava/lang/String;Ljava/lang/String;ILandroid/graphics/Bitmap;Ljava/lang/String;Ljava/lang/String;Landroid/os/PersistableBundle;)Landroid/os/UserHandle;
@@ -9837,99 +9583,40 @@
 
     invoke-virtual {v7}, Landroid/content/pm/UserInfo;->isAdminLocked()Z
 
-    move-result v0
-
-    if-eqz v0, :cond_d
-
-    const-string v0, " <admin locked> "
-
-    invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
-
-    :cond_d
-    invoke-virtual {v7}, Landroid/content/pm/UserInfo;->isLicenseLocked()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_e
-
-    const-string v0, " <license expired> "
-
-    invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
-
-    :cond_e
-    invoke-virtual {v7}, Landroid/content/pm/UserInfo;->isDeviceCompromised()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_f
-
-    const-string v0, " <device compromise detected> "
-
-    invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
-
-    :cond_f
-    invoke-virtual {p1}, Ljava/io/PrintWriter;->println()V
-
-    :cond_10
-    iget v0, v7, Landroid/content/pm/UserInfo;->flags:I
-
-    const/high16 v2, 0x6000000
-
-    and-int/2addr v2, v0
-
-    if-eqz v2, :cond_13
-
-    const/high16 v2, 0x4000000
-
-    and-int/2addr v0, v2
-
-    if-eqz v0, :cond_11
-
-    const-string v0, " <DUALDAR CUSTOM CRYPTO>"
-
-    invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
-
-    :cond_11
-    iget v0, v7, Landroid/content/pm/UserInfo;->flags:I
-
-    const/high16 v2, 0x2000000
-
-    and-int/2addr v0, v2
-
-    if-eqz v0, :cond_12
-
-    const-string v0, " <DUALDAR NATIVE CRYPTO>"
-
-    invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
+    move-result v0
 
-    :cond_12
-    iget v0, v7, Landroid/content/pm/UserInfo;->id:I
+    if-eqz v0, :cond_d
 
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->getCurrentState(I)Lcom/samsung/android/knox/dar/ddar/fsm/State;
+    const-string v0, " <admin locked> "
 
-    move-result-object v0
+    invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
 
-    if-eqz v0, :cond_13
+    :cond_d
+    invoke-virtual {v7}, Landroid/content/pm/UserInfo;->isLicenseLocked()Z
 
-    new-instance v2, Ljava/lang/StringBuilder;
+    move-result v0
 
-    const-string v3, " - "
+    if-eqz v0, :cond_e
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    const-string v0, " <license expired> "
 
-    invoke-virtual {v0}, Lcom/samsung/android/knox/dar/ddar/fsm/State;->toString()Ljava/lang/String;
+    invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
 
-    move-result-object v0
+    :cond_e
+    invoke-virtual {v7}, Landroid/content/pm/UserInfo;->isDeviceCompromised()Z
 
-    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    move-result v0
 
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    if-eqz v0, :cond_f
 
-    move-result-object v0
+    const-string v0, " <device compromise detected> "
 
     invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
 
-    :cond_13
+    :cond_f
+    invoke-virtual {p1}, Ljava/io/PrintWriter;->println()V
+
+    :cond_10
     return-void
 
     :catchall_0
@@ -14828,51 +14515,18 @@
 .end method
 
 .method public final getUserPropertiesInternal(I)Landroid/content/pm/UserProperties;
-    .locals 3
+    .locals 1
 
     iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
 
     monitor-enter v0
 
     :try_start_0
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v1
-
-    const/4 v2, 0x0
-
-    if-eqz v1, :cond_0
-
-    iget-object v1, p0, Lcom/android/server/pm/UserManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {v1}, Lcom/android/internal/widget/LockPatternUtils;->getLockPatternUtilForDualDarDo()Lcom/android/internal/widget/LockPatternUtils$LockPatternUtilForDualDarDo;
-
-    move-result-object v1
-
-    invoke-virtual {v1, p1}, Lcom/android/internal/widget/LockPatternUtils$LockPatternUtilForDualDarDo;->isInnerAuthUserForDo(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    const/4 v1, 0x1
-
-    goto :goto_0
-
-    :cond_0
-    move v1, v2
-
-    :goto_0
-    if-eqz v1, :cond_1
-
-    move p1, v2
-
-    :cond_1
     invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->getUserDataLU(I)Lcom/android/server/pm/UserManagerService$UserData;
 
     move-result-object p0
 
-    if-eqz p0, :cond_2
+    if-eqz p0, :cond_0
 
     iget-object p0, p0, Lcom/android/server/pm/UserManagerService$UserData;->userProperties:Landroid/content/pm/UserProperties;
 
@@ -14883,16 +14537,16 @@
     :catchall_0
     move-exception p0
 
-    goto :goto_1
+    goto :goto_0
 
-    :cond_2
+    :cond_0
     monitor-exit v0
 
     const/4 p0, 0x0
 
     return-object p0
 
-    :goto_1
+    :goto_0
     monitor-exit v0
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
@@ -18707,195 +18361,6 @@
     return-void
 .end method
 
-.method public final onBeforeUnlockUser(I)V
-    .locals 6
-
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    if-nez v0, :cond_0
-
-    return-void
-
-    :cond_0
-    sget-object v1, Landroid/content/pm/PackagePartitions;->FINGERPRINT:Ljava/lang/String;
-
-    iget-object v2, v0, Landroid/content/pm/UserInfo;->lastLoggedInFingerprint:Ljava/lang/String;
-
-    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v1
-
-    const/4 v2, 0x1
-
-    xor-int/2addr v1, v2
-
-    new-instance v3, Lcom/android/server/utils/TimingsTraceAndSlog;
-
-    invoke-direct {v3}, Lcom/android/server/utils/TimingsTraceAndSlog;-><init>()V
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "prepareUserData-"
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {v3, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
-
-    iget-object v4, p0, Lcom/android/server/pm/UserManagerService;->mUserDataPreparer:Lcom/android/server/pm/UserDataPreparer;
-
-    const/4 v5, 0x2
-
-    invoke-virtual {v4, v5, v0}, Lcom/android/server/pm/UserDataPreparer;->prepareUserData(ILandroid/content/pm/UserInfo;)V
-
-    invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
-
-    invoke-virtual {v0}, Landroid/content/pm/UserInfo;->isManagedProfile()Z
-
-    move-result v4
-
-    if-eqz v4, :cond_2
-
-    iget v0, v0, Landroid/content/pm/UserInfo;->flags:I
-
-    const/high16 v4, 0x6000000
-
-    and-int/2addr v0, v4
-
-    if-lez v0, :cond_2
-
-    const-string/jumbo v0, "UserManagerService"
-
-    const-string v4, "Apply policies on CE storage for dualdar user "
-
-    invoke-static {p1, v4, v0}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v0
-
-    invoke-virtual {v0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->handleBeforeUnlockUser(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_2
-
-    const-string/jumbo v0, "UserManagerService"
-
-    const-string/jumbo v1, "To set DualDAR Policy on CE storage was failed."
-
-    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mPackagesLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->getUserDataNoChecks(I)Lcom/android/server/pm/UserManagerService$UserData;
-
-    move-result-object v1
-
-    if-nez v1, :cond_1
-
-    const-string/jumbo p0, "UserManagerService"
-
-    const-string p1, "Failed to remove invalid enterprise user - Couldn\'t get UserData"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_0
-
-    :cond_1
-    iget-object v3, v1, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
-
-    iput-boolean v2, v3, Landroid/content/pm/UserInfo;->partial:Z
-
-    iget v2, v3, Landroid/content/pm/UserInfo;->flags:I
-
-    or-int/lit8 v2, v2, 0x40
-
-    iput v2, v3, Landroid/content/pm/UserInfo;->flags:I
-
-    invoke-virtual {p0, v1}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
-
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->removeUser(I)Z
-
-    monitor-exit v0
-
-    return-void
-
-    :goto_0
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-
-    :cond_2
-    const-class v0, Landroid/os/storage/StorageManagerInternal;
-
-    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/os/storage/StorageManagerInternal;
-
-    invoke-virtual {v0, p1}, Landroid/os/storage/StorageManagerInternal;->markCeStoragePrepared(I)V
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "reconcileAppsData-"
-
-    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v3, v0}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mPmInternal:Landroid/content/pm/PackageManagerInternal;
-
-    if-nez v0, :cond_3
-
-    const-class v0, Landroid/content/pm/PackageManagerInternal;
-
-    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/content/pm/PackageManagerInternal;
-
-    iput-object v0, p0, Lcom/android/server/pm/UserManagerService;->mPmInternal:Landroid/content/pm/PackageManagerInternal;
-
-    :cond_3
-    iget-object p0, p0, Lcom/android/server/pm/UserManagerService;->mPmInternal:Landroid/content/pm/PackageManagerInternal;
-
-    invoke-virtual {p0, p1, v5, v1}, Landroid/content/pm/PackageManagerInternal;->reconcileAppsData(IIZ)V
-
-    invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
-
-    return-void
-.end method
-
 .method public final onShellCommand(Ljava/io/FileDescriptor;Ljava/io/FileDescriptor;Ljava/io/FileDescriptor;[Ljava/lang/String;Landroid/os/ShellCallback;Landroid/os/ResultReceiver;)V
     .locals 8
 
@@ -21517,30 +20982,11 @@
     :cond_2
     if-eqz v2, :cond_3
 
-    iget v0, v2, Landroid/content/pm/UserInfo;->flags:I
-
-    const/high16 v1, 0x6000000
-
-    and-int/2addr v0, v1
-
-    if-eqz v0, :cond_3
-
-    iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v0
-
-    invoke-virtual {v0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onUserRemoved(I)V
-
-    :cond_3
-    if-eqz v2, :cond_4
-
     invoke-static {}, Lcom/samsung/android/knox/SemPersonaManager;->getUCMDAREncryption()Z
 
     move-result v0
 
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_3
 
     const-string/jumbo v0, "UserManagerService"
 
@@ -21561,7 +21007,7 @@
 
     move-result v3
 
-    if-eqz v3, :cond_4
+    if-eqz v3, :cond_3
 
     new-instance v4, Ljava/lang/StringBuilder;
 
@@ -21590,7 +21036,7 @@
 
     invoke-static {v1, v3, v0}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/Exception;Ljava/lang/StringBuilder;Ljava/lang/String;)V
 
-    :cond_4
+    :cond_3
     :goto_2
     iget-object v1, p0, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
 
@@ -21657,7 +21103,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_5
+    if-eqz v0, :cond_4
 
     iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mCachedEffectiveUserRestrictions:Lcom/android/server/pm/RestrictionsSet;
 
@@ -21675,7 +21121,7 @@
 
     invoke-virtual {v3, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    :cond_5
+    :cond_4
     monitor-exit v1
     :try_end_6
     .catchall {:try_start_6 .. :try_end_6} :catchall_3
@@ -21709,13 +21155,13 @@
 
     invoke-virtual {p0}, Lcom/android/server/pm/UserManagerService;->updateUserIds()V
 
-    if-eqz v2, :cond_7
+    if-eqz v2, :cond_6
 
     invoke-virtual {v2}, Landroid/content/pm/UserInfo;->isDualAppProfile()Z
 
     move-result v0
 
-    if-eqz v0, :cond_7
+    if-eqz v0, :cond_6
 
     iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
 
@@ -21723,12 +21169,12 @@
 
     const/16 v1, 0x63
 
-    if-ne p1, v1, :cond_6
+    if-ne p1, v1, :cond_5
 
     const/16 p1, 0x5f
 
     :goto_3
-    if-gt p1, v1, :cond_6
+    if-gt p1, v1, :cond_5
 
     :try_start_8
     iget-object v2, p0, Lcom/android/server/pm/UserManagerService;->mRemovingUserIds:Landroid/util/SparseBooleanArray;
@@ -21744,7 +21190,7 @@
 
     goto :goto_4
 
-    :cond_6
+    :cond_5
     monitor-exit v0
 
     goto :goto_5
@@ -21756,7 +21202,7 @@
 
     throw p0
 
-    :cond_7
+    :cond_6
     :goto_5
     return-void
 
diff --git a/smali_classes2/com/android/server/trust/TrustManagerService$3.smali b/smali_classes2/com/android/server/trust/TrustManagerService$3.smali
index d17d2f57e..5b9076a88 100644
--- a/smali_classes2/com/android/server/trust/TrustManagerService$3.smali
+++ b/smali_classes2/com/android/server/trust/TrustManagerService$3.smali
@@ -669,178 +669,96 @@
 .end method
 
 .method public final setDeviceLockedForUser(IZ)V
-    .locals 9
-
-    const-string/jumbo v0, "setDeviceLocked for DualDAR DO. locked state : "
+    .locals 7
 
-    const-string v1, "Enable FBE lock for Secure Folder VALUE: "
+    const-string v0, "Enable FBE lock for Secure Folder VALUE: "
 
     invoke-virtual {p0}, Lcom/android/server/trust/TrustManagerService$3;->enforceReportPermission()V
 
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v2
+    move-result-wide v1
 
     :try_start_0
     invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isSecureFolderId(I)Z
 
-    move-result v4
-
-    const/4 v5, 0x0
+    move-result v3
 
-    if-eqz v4, :cond_0
+    if-eqz v3, :cond_0
 
     if-eqz p2, :cond_0
 
-    iget-object v4, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
+    iget-object v3, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
-    iget-object v4, v4, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
+    iget-object v3, v3, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v4}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
 
-    move-result-object v4
+    move-result-object v3
 
-    const-string/jumbo v6, "enable_fbe_lock"
+    const-string/jumbo v4, "enable_fbe_lock"
 
-    invoke-static {v4, v6, v5, p1}, Landroid/provider/Settings$Secure;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
+    const/4 v5, 0x0
 
-    move-result v4
+    invoke-static {v3, v4, v5, p1}, Landroid/provider/Settings$Secure;->getIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)I
 
-    iget-object v6, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
+    move-result v3
 
-    iget-object v6, v6, Lcom/android/server/trust/TrustManagerService;->mUserManager:Landroid/os/UserManager;
+    iget-object v4, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
-    invoke-virtual {v6, p1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
+    iget-object v4, v4, Lcom/android/server/trust/TrustManagerService;->mUserManager:Landroid/os/UserManager;
 
-    move-result-object v6
+    invoke-virtual {v4, p1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
 
-    invoke-virtual {v6}, Landroid/content/pm/UserInfo;->getUserHandle()Landroid/os/UserHandle;
+    move-result-object v4
 
-    move-result-object v6
+    invoke-virtual {v4}, Landroid/content/pm/UserInfo;->getUserHandle()Landroid/os/UserHandle;
 
-    const-string/jumbo v7, "TrustManagerService"
+    move-result-object v4
 
-    new-instance v8, Ljava/lang/StringBuilder;
+    const-string/jumbo v5, "TrustManagerService"
 
-    invoke-direct {v8, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    new-instance v6, Ljava/lang/StringBuilder;
 
-    invoke-virtual {v8, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-direct {v6, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    move-result-object v1
+    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-static {v7, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    move-result-object v0
 
-    const/4 v1, 0x1
+    invoke-static {v5, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v0, 0x1
 
-    if-ne v4, v1, :cond_0
+    if-ne v3, v0, :cond_0
 
-    iget-object v4, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
+    iget-object v3, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
-    iget-object v4, v4, Lcom/android/server/trust/TrustManagerService;->mUserManager:Landroid/os/UserManager;
+    iget-object v3, v3, Lcom/android/server/trust/TrustManagerService;->mUserManager:Landroid/os/UserManager;
 
-    invoke-virtual {v4, v6}, Landroid/os/UserManager;->isUserRunning(Landroid/os/UserHandle;)Z
+    invoke-virtual {v3, v4}, Landroid/os/UserManager;->isUserRunning(Landroid/os/UserHandle;)Z
 
-    move-result v4
+    move-result v3
 
-    if-eqz v4, :cond_0
+    if-eqz v3, :cond_0
 
-    iget-object v4, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
+    iget-object v3, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
-    iget-object v4, v4, Lcom/android/server/trust/TrustManagerService;->mUserManager:Landroid/os/UserManager;
+    iget-object v3, v3, Lcom/android/server/trust/TrustManagerService;->mUserManager:Landroid/os/UserManager;
 
-    invoke-virtual {v4, v1, v6}, Landroid/os/UserManager;->requestQuietModeEnabled(ZLandroid/os/UserHandle;)Z
+    invoke-virtual {v3, v0, v4}, Landroid/os/UserManager;->requestQuietModeEnabled(ZLandroid/os/UserHandle;)Z
 
     goto :goto_0
 
     :catchall_0
     move-exception p0
 
-    goto/16 :goto_3
+    goto :goto_2
 
     :cond_0
     :goto_0
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_1
-
-    iget-object v1, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
-
-    iget-object v1, v1, Lcom/android/server/trust/TrustManagerService;->mDeviceLockedForUser:Landroid/util/SparseBooleanArray;
-
-    monitor-enter v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :try_start_1
-    iget-object v4, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
-
-    iget-object v4, v4, Lcom/android/server/trust/TrustManagerService;->mDeviceLockedForUser:Landroid/util/SparseBooleanArray;
-
-    invoke-virtual {v4, p1, p2}, Landroid/util/SparseBooleanArray;->put(IZ)V
-
-    monitor-exit v1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    :try_start_2
-    const-string/jumbo v1, "TrustManagerService"
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    invoke-direct {v4, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v4, v5, [Ljava/lang/Object;
-
-    invoke-static {v1, v0, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
-
-    invoke-virtual {v0, p1, p2}, Lcom/android/server/trust/TrustManagerService;->handleDualDARDeviceLockedChangedForUser(IZ)V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    goto :goto_1
-
-    :catchall_1
-    move-exception p0
-
-    :try_start_3
-    monitor-exit v1
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    :try_start_4
-    throw p0
-
-    :cond_1
-    if-nez p1, :cond_2
-
-    if-nez p2, :cond_2
-
-    const-string/jumbo v0, "TrustManagerService"
-
-    const-string/jumbo v1, "setDeviceLocked false and update DualDAR user state"
-
-    new-array v4, v5, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
-
-    invoke-virtual {v0, p1}, Lcom/android/server/trust/TrustManagerService;->updateDualDARStateAndUnlockIfNeeded(I)V
-
-    :cond_2
-    :goto_1
     iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
     iget-object v0, v0, Lcom/android/server/trust/TrustManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
@@ -849,7 +767,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_5
+    if-eqz v0, :cond_3
 
     iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
@@ -859,28 +777,28 @@
 
     move-result v0
 
-    if-eqz v0, :cond_5
+    if-eqz v0, :cond_3
 
     iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
     iget-object v0, v0, Lcom/android/server/trust/TrustManagerService;->mDeviceLockedForUser:Landroid/util/SparseBooleanArray;
 
     monitor-enter v0
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    :try_start_5
-    iget-object v1, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
+    :try_start_1
+    iget-object v3, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
-    iget-object v1, v1, Lcom/android/server/trust/TrustManagerService;->mDeviceLockedForUser:Landroid/util/SparseBooleanArray;
+    iget-object v3, v3, Lcom/android/server/trust/TrustManagerService;->mDeviceLockedForUser:Landroid/util/SparseBooleanArray;
 
-    invoke-virtual {v1, p1, p2}, Landroid/util/SparseBooleanArray;->put(IZ)V
+    invoke-virtual {v3, p1, p2}, Landroid/util/SparseBooleanArray;->put(IZ)V
 
     monitor-exit v0
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_2
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_1
 
-    :try_start_6
+    :try_start_2
     iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
     invoke-virtual {v0, p1, p2}, Lcom/android/server/trust/TrustManagerService;->notifyKeystoreOfDeviceLockState(IZ)V
@@ -888,24 +806,24 @@
     iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
     invoke-virtual {v0, p1, p2}, Lcom/android/server/trust/TrustManagerService;->notifyDeviceLockedListenersForUser(IZ)V
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_0
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    if-eqz p2, :cond_3
+    if-eqz p2, :cond_1
 
-    :try_start_7
+    :try_start_3
     invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;
 
     move-result-object p2
 
     invoke-interface {p2, p1}, Landroid/app/IActivityManager;->notifyLockedProfile(I)V
-    :try_end_7
-    .catch Landroid/os/RemoteException; {:try_start_7 .. :try_end_7} :catch_0
-    .catchall {:try_start_7 .. :try_end_7} :catchall_0
+    :try_end_3
+    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0
+    .catchall {:try_start_3 .. :try_end_3} :catchall_0
 
     :catch_0
-    :cond_3
-    :try_start_8
+    :cond_1
+    :try_start_4
     new-instance p2, Landroid/content/Intent;
 
     const-string/jumbo v0, "android.intent.action.DEVICE_LOCKED_CHANGED"
@@ -924,13 +842,13 @@
 
     iget-object v0, v0, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
 
-    sget-object v1, Landroid/os/UserHandle;->SYSTEM:Landroid/os/UserHandle;
+    sget-object v3, Landroid/os/UserHandle;->SYSTEM:Landroid/os/UserHandle;
 
     const-string/jumbo v4, "android.permission.TRUST_LISTENER"
 
     const/4 v5, 0x0
 
-    invoke-virtual {v0, p2, v1, v4, v5}, Landroid/content/Context;->sendBroadcastAsUser(Landroid/content/Intent;Landroid/os/UserHandle;Ljava/lang/String;Landroid/os/Bundle;)V
+    invoke-virtual {v0, p2, v3, v4, v5}, Landroid/content/Context;->sendBroadcastAsUser(Landroid/content/Intent;Landroid/os/UserHandle;Ljava/lang/String;Landroid/os/Bundle;)V
 
     iget-object p2, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
@@ -938,7 +856,7 @@
 
     move-result-object p2
 
-    if-eqz p2, :cond_4
+    if-eqz p2, :cond_2
 
     iget-object p0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
@@ -948,40 +866,40 @@
 
     invoke-virtual {p0, p1}, Lcom/samsung/android/knox/PersonaManagerInternal;->onDeviceLockedChanged(I)V
 
-    goto :goto_2
+    goto :goto_1
 
-    :cond_4
+    :cond_2
     const-string/jumbo p0, "TrustManagerService"
 
     const-string/jumbo p1, "onDeviceLockedChanged() - Service is not yet ready..."
 
     invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_8
-    .catchall {:try_start_8 .. :try_end_8} :catchall_0
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_0
 
-    goto :goto_2
+    goto :goto_1
 
-    :catchall_2
+    :catchall_1
     move-exception p0
 
-    :try_start_9
+    :try_start_5
     monitor-exit v0
-    :try_end_9
-    .catchall {:try_start_9 .. :try_end_9} :catchall_2
+    :try_end_5
+    .catchall {:try_start_5 .. :try_end_5} :catchall_1
 
-    :try_start_a
+    :try_start_6
     throw p0
-    :try_end_a
-    .catchall {:try_start_a .. :try_end_a} :catchall_0
+    :try_end_6
+    .catchall {:try_start_6 .. :try_end_6} :catchall_0
 
-    :cond_5
-    :goto_2
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :cond_3
+    :goto_1
+    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return-void
 
-    :goto_3
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :goto_2
+    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw p0
 .end method
diff --git a/smali_classes2/com/android/server/trust/TrustManagerService$4.smali b/smali_classes2/com/android/server/trust/TrustManagerService$4.smali
index 6b915727b..39ba0ce55 100644
--- a/smali_classes2/com/android/server/trust/TrustManagerService$4.smali
+++ b/smali_classes2/com/android/server/trust/TrustManagerService$4.smali
@@ -465,23 +465,11 @@
     return-void
 
     :pswitch_a
-    iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$4;->this$0:Lcom/android/server/trust/TrustManagerService;
-
-    iget v1, p1, Landroid/os/Message;->arg1:I
-
-    invoke-virtual {v0, v1}, Lcom/android/server/trust/TrustManagerService;->refreshAgentList(I)V
-
-    iget v0, p1, Landroid/os/Message;->what:I
-
-    const/16 v1, 0xb
-
-    if-ne v0, v1, :cond_14
-
     iget-object p0, p0, Lcom/android/server/trust/TrustManagerService$4;->this$0:Lcom/android/server/trust/TrustManagerService;
 
     iget p1, p1, Landroid/os/Message;->arg1:I
 
-    invoke-virtual {p0, p1}, Lcom/android/server/trust/TrustManagerService;->updateDualDARStateAndUnlockIfNeeded(I)V
+    invoke-virtual {p0, p1}, Lcom/android/server/trust/TrustManagerService;->refreshAgentList(I)V
 
     return-void
 
@@ -889,6 +877,8 @@
 
     return-void
 
+    nop
+
     :pswitch_data_0
     .packed-switch 0x1
         :pswitch_f
diff --git a/smali_classes2/com/android/server/trust/TrustManagerService.smali b/smali_classes2/com/android/server/trust/TrustManagerService.smali
index b2a3090e3..58e66fdc9 100644
--- a/smali_classes2/com/android/server/trust/TrustManagerService.smali
+++ b/smali_classes2/com/android/server/trust/TrustManagerService.smali
@@ -937,56 +937,6 @@
     throw p0
 .end method
 
-.method public final handleDualDARDeviceLockedChangedForUser(IZ)V
-    .locals 3
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->isDualDAREnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    const-string/jumbo v0, "handleDualDARDeviceLockedChangedForUser() - userId : "
-
-    const-string v1, ", locked : "
-
-    invoke-static {p1, v0, v1, p2}, Lcom/android/server/accessibility/AbstractAccessibilityServiceConnection$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Z)Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v1, 0x0
-
-    new-array v1, v1, [Ljava/lang/Object;
-
-    const-string/jumbo v2, "TrustManagerService"
-
-    invoke-static {v2, v0, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    if-nez p1, :cond_1
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARUser()I
-
-    move-result v0
-
-    const/4 v1, -0x1
-
-    if-eq v0, v1, :cond_1
-
-    if-eqz p2, :cond_0
-
-    sget-object p0, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DEVICE_LOCKED:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v0, p0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    return-void
-
-    :cond_0
-    invoke-virtual {p0, p1}, Lcom/android/server/trust/TrustManagerService;->updateDualDARStateAndUnlockIfNeeded(I)V
-
-    :cond_1
-    return-void
-.end method
-
 .method public final handleScheduleTrustableTimeouts(IZZ)V
     .locals 17
 
@@ -1926,80 +1876,6 @@
     return-void
 .end method
 
-.method public final onPassword2Auth(I)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 4
-
-    const/4 v0, 0x0
-
-    new-array v1, v0, [Ljava/lang/Object;
-
-    const-string/jumbo v2, "onPassword2Auth()"
-
-    const-string/jumbo v3, "TrustManagerService"
-
-    invoke-static {v3, v2, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_0
-
-    const-string/jumbo p0, "User is not DualDAR eligible. so no need to verify DualDAR Passwords"
-
-    invoke-static {p1, p0}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p0
-
-    const/4 v1, 0x0
-
-    invoke-virtual {p0, p1, v1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Auth(I[B)Z
-
-    move-result p0
-
-    if-nez p0, :cond_1
-
-    const-string p0, "Authentication Failure by dual dar client"
-
-    new-array p1, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-
-    :cond_1
-    const-string/jumbo p0, "onPassword2Auth completed successfully"
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    sget-object p0, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {p1, p0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-.end method
-
 .method public final onStart()V
     .locals 2
 
@@ -3713,7 +3589,7 @@
     :catchall_0
     move-exception p0
 
-    goto/16 :goto_5
+    goto :goto_5
 
     :cond_1
     :goto_1
@@ -3723,30 +3599,11 @@
 
     if-nez v2, :cond_2
 
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    const-string/jumbo v0, "TrustManagerService"
-
-    const-string/jumbo v1, "setDeviceLockedForUser - locked state is not changed though"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/trust/TrustManagerService;->handleDualDARDeviceLockedChangedForUser(IZ)V
-
-    :cond_2
-    if-nez v2, :cond_3
-
     iget-boolean v0, p0, Lcom/android/server/trust/TrustManagerService;->mIsUnlockedByFP:Z
 
-    if-eqz v0, :cond_8
-
-    :cond_3
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/trust/TrustManagerService;->handleDualDARDeviceLockedChangedForUser(IZ)V
+    if-eqz v0, :cond_7
 
+    :cond_2
     move v0, v3
 
     :goto_2
@@ -3756,7 +3613,7 @@
 
     move-result v1
 
-    if-ge v0, v1, :cond_6
+    if-ge v0, v1, :cond_5
 
     iget-object v1, p0, Lcom/android/server/trust/TrustManagerService;->mActiveAgents:Landroid/util/ArraySet;
 
@@ -3768,9 +3625,9 @@
 
     iget v2, v1, Lcom/android/server/trust/TrustManagerService$AgentInfo;->userId:I
 
-    if-ne v2, p1, :cond_5
+    if-ne v2, p1, :cond_4
 
-    if-eqz p2, :cond_4
+    if-eqz p2, :cond_3
 
     iget-object v1, v1, Lcom/android/server/trust/TrustManagerService$AgentInfo;->agent:Lcom/android/server/trust/TrustAgentWrapper;
 
@@ -3779,7 +3636,7 @@
     :try_start_1
     iget-object v1, v1, Lcom/android/server/trust/TrustAgentWrapper;->mTrustAgentService:Landroid/service/trust/ITrustAgentService;
 
-    if-eqz v1, :cond_5
+    if-eqz v1, :cond_4
 
     invoke-interface {v1}, Landroid/service/trust/ITrustAgentService;->onDeviceLocked()V
     :try_end_1
@@ -3794,7 +3651,7 @@
 
     goto :goto_3
 
-    :cond_4
+    :cond_3
     iget-object v1, v1, Lcom/android/server/trust/TrustManagerService$AgentInfo;->agent:Lcom/android/server/trust/TrustAgentWrapper;
 
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
@@ -3802,7 +3659,7 @@
     :try_start_2
     iget-object v1, v1, Lcom/android/server/trust/TrustAgentWrapper;->mTrustAgentService:Landroid/service/trust/ITrustAgentService;
 
-    if-eqz v1, :cond_5
+    if-eqz v1, :cond_4
 
     invoke-interface {v1}, Landroid/service/trust/ITrustAgentService;->onDeviceUnlocked()V
     :try_end_2
@@ -3815,13 +3672,13 @@
 
     invoke-static {v1}, Lcom/android/server/trust/TrustAgentWrapper;->onError(Ljava/lang/Exception;)V
 
-    :cond_5
+    :cond_4
     :goto_3
     add-int/lit8 v0, v0, 0x1
 
     goto :goto_2
 
-    :cond_6
+    :cond_5
     invoke-virtual {p0, p1, p2}, Lcom/android/server/trust/TrustManagerService;->notifyKeystoreOfDeviceLockState(IZ)V
 
     invoke-virtual {p0, p1, p2}, Lcom/android/server/trust/TrustManagerService;->notifyDeviceLockedListenersForUser(IZ)V
@@ -3835,7 +3692,7 @@
     array-length v0, p1
 
     :goto_4
-    if-ge v3, v0, :cond_8
+    if-ge v3, v0, :cond_7
 
     aget v1, p1, v3
 
@@ -3845,16 +3702,16 @@
 
     move-result v2
 
-    if-eqz v2, :cond_7
+    if-eqz v2, :cond_6
 
     invoke-virtual {p0, v1, p2}, Lcom/android/server/trust/TrustManagerService;->notifyKeystoreOfDeviceLockState(IZ)V
 
-    :cond_7
+    :cond_6
     add-int/lit8 v3, v3, 0x1
 
     goto :goto_4
 
-    :cond_8
+    :cond_7
     return-void
 
     :goto_5
@@ -3866,298 +3723,6 @@
     throw p0
 .end method
 
-.method public final updateDualDARStateAndUnlockIfNeeded(I)V
-    .locals 7
-
-    const-string/jumbo v0, "fetch outer layer key and unlock DualDAR user "
-
-    const-string/jumbo v1, "updateDualDARStateAndUnlockIfNeeded() - userId : "
-
-    invoke-static {p1, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    const/4 v2, 0x0
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    const-string/jumbo v4, "TrustManagerService"
-
-    invoke-static {v4, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->isDualDAREnabled()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_6
-
-    const-class v1, Lcom/android/server/SystemServiceManager;
-
-    invoke-static {v1}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Lcom/android/server/SystemServiceManager;
-
-    iget v1, v1, Lcom/android/server/SystemServiceManager;->mCurrentPhase:I
-
-    const/16 v3, 0x3e8
-
-    if-lt v1, v3, :cond_0
-
-    invoke-static {p1}, Landroid/os/storage/StorageManager;->isCeStorageUnlocked(I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_1
-
-    :cond_0
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_6
-
-    const-string/jumbo v1, "Update dualdar state early for DO"
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_1
-    if-nez p1, :cond_6
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARUser()I
-
-    move-result v1
-
-    const/4 v3, -0x1
-
-    if-eq v1, v3, :cond_6
-
-    sget-object v3, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DEVICE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v1, v3}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    iget-object v3, p0, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v5, "keyguard"
-
-    invoke-virtual {v3, v5}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Landroid/app/KeyguardManager;
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v6, "Trying to unlock DualDAR user (TMS), isSecure? "
-
-    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v3, v1}, Landroid/app/KeyguardManager;->isDeviceSecure(I)Z
-
-    move-result v6
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    new-array v6, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, v5, v6}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v5
-
-    if-eqz v5, :cond_4
-
-    const-string v0, "DualDAR on DO is enabled"
-
-    new-array v5, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, v0, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {v3, v1}, Landroid/app/KeyguardManager;->isDeviceSecure(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_6
-
-    iget-object v0, p0, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
-
-    move-result-object v0
-
-    invoke-virtual {v0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isInnerLayerUnlocked(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncrypted(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_6
-
-    :cond_2
-    invoke-virtual {p0, v1}, Lcom/android/server/trust/TrustManagerService;->onPassword2Auth(I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p0
-
-    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    if-ne p0, v0, :cond_3
-
-    const-string p0, "Inner layer for user "
-
-    const-string v0, " authenticated"
-
-    invoke-static {p1, p0, v0}, Lcom/android/server/BinaryTransparencyService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return-void
-
-    :cond_3
-    const-string p0, "Failed in inner layer authentication for user "
-
-    invoke-static {p1, p0}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    return-void
-
-    :cond_4
-    invoke-virtual {v3, v1}, Landroid/app/KeyguardManager;->isDeviceSecure(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_6
-
-    iget-object p1, p0, Lcom/android/server/trust/TrustManagerService;->mUserManager:Landroid/os/UserManager;
-
-    invoke-virtual {p1, v1}, Landroid/os/UserManager;->isUserUnlockingOrUnlocked(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_6
-
-    invoke-virtual {v3, v2}, Landroid/app/KeyguardManager;->isDeviceLocked(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_6
-
-    const-string/jumbo p1, "Trying to unlock DualDAR user "
-
-    invoke-static {v1, p1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, p1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0, v1}, Lcom/android/server/trust/TrustManagerService;->onPassword2Auth(I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p1
-
-    sget-object v3, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    if-ne p1, v3, :cond_5
-
-    :try_start_0
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array v0, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    new-array p1, v2, [Ljava/lang/Object;
-
-    const-string/jumbo v0, "fetchOuterLayerKey()"
-
-    invoke-static {v4, v0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    iget-object p0, p0, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p0
-
-    invoke-virtual {p0, v1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->fetchOuterLayerKey(I)[B
-
-    move-result-object p0
-
-    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;
-
-    move-result-object p1
-
-    const/4 v0, 0x0
-
-    invoke-interface {p1, v1, v0, p0, v0}, Landroid/app/IActivityManager;->unlockUser(I[B[BLandroid/os/IProgressListener;)Z
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-void
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string p1, "Failed to unlock DualDAR user !"
-
-    invoke-direct {p0, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    goto :goto_0
-
-    :cond_5
-    const-string p0, "Default Authentication Failure by DualDAR client"
-
-    new-array p1, v2, [Ljava/lang/Object;
-
-    invoke-static {v4, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    :cond_6
-    :goto_0
-    return-void
-.end method
-
 .method public final updateTrust(I)V
     .locals 2
 
diff --git a/smali_classes2/vendor/samsung/hardware/tlc/ddar/ISehDdar$Stub$Proxy.smali b/smali_classes2/vendor/samsung/hardware/tlc/ddar/ISehDdar$Stub$Proxy.smali
deleted file mode 100644
index 33faf3363..000000000
--- a/smali_classes2/vendor/samsung/hardware/tlc/ddar/ISehDdar$Stub$Proxy.smali
+++ /dev/null
@@ -1,20 +0,0 @@
-.class public final Lvendor/samsung/hardware/tlc/ddar/ISehDdar$Stub$Proxy;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Lvendor/samsung/hardware/tlc/ddar/ISehDdar;
-
-
-# instance fields
-.field public mRemote:Landroid/os/IBinder;
-
-
-# virtual methods
-.method public final asBinder()Landroid/os/IBinder;
-    .locals 0
-
-    iget-object p0, p0, Lvendor/samsung/hardware/tlc/ddar/ISehDdar$Stub$Proxy;->mRemote:Landroid/os/IBinder;
-
-    return-object p0
-.end method
diff --git a/smali_classes2/vendor/samsung/hardware/tlc/ddar/ISehDdar$Stub.smali b/smali_classes2/vendor/samsung/hardware/tlc/ddar/ISehDdar$Stub.smali
deleted file mode 100644
index b6701cdae..000000000
--- a/smali_classes2/vendor/samsung/hardware/tlc/ddar/ISehDdar$Stub.smali
+++ /dev/null
@@ -1,10 +0,0 @@
-.class public abstract Lvendor/samsung/hardware/tlc/ddar/ISehDdar$Stub;
-.super Landroid/os/Binder;
-.source "SourceFile"
-
-# interfaces
-.implements Lvendor/samsung/hardware/tlc/ddar/ISehDdar;
-
-
-# static fields
-.field public static final synthetic $r8$clinit:I
diff --git a/smali_classes2/vendor/samsung/hardware/tlc/ddar/ISehDdar.smali b/smali_classes2/vendor/samsung/hardware/tlc/ddar/ISehDdar.smali
deleted file mode 100644
index 0c4e82415..000000000
--- a/smali_classes2/vendor/samsung/hardware/tlc/ddar/ISehDdar.smali
+++ /dev/null
@@ -1,30 +0,0 @@
-.class public interface abstract Lvendor/samsung/hardware/tlc/ddar/ISehDdar;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Landroid/os/IInterface;
-
-
-# static fields
-.field public static final DESCRIPTOR:Ljava/lang/String;
-
-
-# direct methods
-.method static constructor <clinit>()V
-    .locals 3
-
-    const/16 v0, 0x24
-
-    const/16 v1, 0x2e
-
-    const-string/jumbo v2, "vendor$samsung$hardware$tlc$ddar$ISehDdar"
-
-    invoke-virtual {v2, v0, v1}, Ljava/lang/String;->replace(CC)Ljava/lang/String;
-
-    move-result-object v0
-
-    sput-object v0, Lvendor/samsung/hardware/tlc/ddar/ISehDdar;->DESCRIPTOR:Ljava/lang/String;
-
-    return-void
-.end method
-- 
2.51.1

