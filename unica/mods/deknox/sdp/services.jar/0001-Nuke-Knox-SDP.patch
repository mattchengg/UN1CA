From bd321e3c176604957deef59554a565d6db76584b Mon Sep 17 00:00:00 2001
From: Salvo Giangreco <giangrecosalvo9@gmail.com>
Date: Sat, 30 Aug 2025 00:37:42 +0200
Subject: [PATCH] Nuke Knox SDP

UN1CA: this patch is not complete! Please check unica/mods/deknox/customize.sh for more info.
---
 .../StorageManagerService$Callbacks.smali     |  107 +-
 smali/com/android/server/am/ProcessList.smali |  290 +-
 ...Controller$$ExternalSyntheticLambda2.smali |  285 +-
 .../android/server/am/UserController.smali    |  428 +-
 .../DevicePolicyManagerService$Injector.smali |   57 -
 .../DevicePolicyManagerService.smali          |    4 -
 .../server/enterprise/EDMProxyService.smali   |    4 +-
 .../container/KnoxMUMContainerPolicy.smali    | 1057 +--
 ...wordPolicy$$ExternalSyntheticLambda1.smali |   66 +
 ...rdPolicy$$ExternalSyntheticLambda11.smali} |   18 +-
 ...rdPolicy$$ExternalSyntheticLambda14.smali} |   22 +-
 ...rdPolicy$$ExternalSyntheticLambda17.smali} |   18 +-
 ...wordPolicy$$ExternalSyntheticLambda2.smali |  192 +-
 ...rdPolicy$$ExternalSyntheticLambda20.smali} |   42 +-
 ...rdPolicy$$ExternalSyntheticLambda24.smali} |   10 +-
 ...rdPolicy$$ExternalSyntheticLambda26.smali} |   22 +-
 ...wordPolicy$$ExternalSyntheticLambda3.smali |  192 +-
 ...wordPolicy$$ExternalSyntheticLambda4.smali |  352 +-
 ...rdPolicy$$ExternalSyntheticLambda42.smali} |   26 +-
 ...rdPolicy$$ExternalSyntheticLambda46.smali} |    2 +-
 ...wordPolicy$$ExternalSyntheticLambda5.smali |  360 +-
 ...ordPolicy$$ExternalSyntheticLambda51.smali |  100 +
 ...ordPolicy$$ExternalSyntheticLambda52.smali |   86 +-
 ...ordPolicy$$ExternalSyntheticLambda53.smali |   40 -
 ...wordPolicy$$ExternalSyntheticLambda6.smali |  200 +-
 ...wordPolicy$$ExternalSyntheticLambda7.smali |  587 +-
 ...wordPolicy$$ExternalSyntheticLambda8.smali |  639 --
 ...ordPolicy$$ExternalSyntheticLambda9.smali} |   56 +-
 ...ordPolicy$$ExternalSyntheticOutline0.smali |   18 -
 .../enterprise/security/PasswordPolicy.smali  |  265 +-
 .../knox/ContainerDependencyWrapper.smali     |    4 -
 ...gerService$$ExternalSyntheticLambda0.smali |    8 +-
 .../server/knox/dar/DarManagerService.smali   | 8097 ++++-------------
 .../com/android/server/knox/dar/DarUtil.smali |  229 +-
 .../server/knox/dar/KeyProtector.smali        |  178 +-
 .../android/server/knox/dar/SecureUtil.smali  |   97 -
 .../nativedaemon/DualDARDaemonProxy.smali     |    4 +-
 .../knox/dar/sdp/SdpDatabaseCache$1.smali     |   63 -
 .../sdp/SdpDatabaseCache$DatabaseHelper.smali |   49 -
 .../knox/dar/sdp/SdpDatabaseCache.smali       |  556 --
 ...anagerImpl$$ExternalSyntheticLambda0.smali |   90 -
 ...anagerImpl$$ExternalSyntheticLambda1.smali |  154 -
 ...anagerImpl$$ExternalSyntheticLambda2.smali |   74 -
 ...anagerImpl$$ExternalSyntheticLambda3.smali |   57 -
 ...anagerImpl$$ExternalSyntheticLambda4.smali |   64 -
 .../knox/dar/sdp/SdpManagerImpl$1.smali       |  287 -
 .../knox/dar/sdp/SdpManagerImpl$3.smali       |  326 -
 .../dar/sdp/SdpManagerImpl$ListenerRoll.smali |   23 -
 .../SdpManagerImpl$SdpEngineDatabase.smali    | 1300 ---
 .../dar/sdp/SdpManagerImpl$SdpHandler.smali   |  916 --
 .../sdp/SdpManagerImpl$SdpLocalService.smali  |   78 -
 ...gerImpl$SdpManagerImplBinderListener.smali |  111 -
 ...nagerProxy$$ExternalSyntheticLambda0.smali |   42 -
 .../sdp/SdpManagerImpl$SdpManagerProxy.smali  |  148 -
 ...teListener$$ExternalSyntheticLambda0.smali |  114 -
 .../sdp/SdpManagerImpl$StateListener.smali    |  200 -
 ...LockClient$$ExternalSyntheticLambda0.smali |   66 -
 ...LockClient$$ExternalSyntheticLambda1.smali |   54 -
 ...LockClient$$ExternalSyntheticLambda2.smali |   66 -
 .../SdpManagerImpl$VirtualLockClient.smali    |  326 -
 .../server/knox/dar/sdp/SdpManagerImpl.smali  | 6297 +------------
 .../knox/dar/sdp/SdpManagerInternal.smali     |    3 +
 .../knox/dar/sdp/engine/SdpPolicy.smali       |  325 -
 ...r$SdpPolicyDatabase$PolicyXmlHandler.smali |  285 -
 .../SdpServiceKeeper$SdpPolicyDatabase.smali  |  922 --
 .../dar/sdp/engine/SdpServiceKeeper.smali     |  888 --
 ...gsService$$ExternalSyntheticLambda12.smali |   14 -
 ...gsService$$ExternalSyntheticLambda13.smali |  518 +-
 ...gsService$$ExternalSyntheticLambda14.smali |  532 ++
 ...gsService$$ExternalSyntheticLambda20.smali |   64 -
 ...gsService$$ExternalSyntheticLambda21.smali |   22 +-
 ...ngsService$$ExternalSyntheticLambda4.smali |  114 +-
 .../locksettings/LockSettingsService$2.smali  |   93 +-
 .../LockSettingsService$DarLockSettings.smali |  192 +-
 .../LockSettingsService$Injector$1.smali      |  462 +-
 .../LockSettingsService$Lifecycle.smali       |  585 +-
 ...ckSettings$$ExternalSyntheticLambda0.smali |   42 -
 ...ckSettings$$ExternalSyntheticLambda5.smali |  266 -
 ...ckSettings$$ExternalSyntheticLambda6.smali |   96 -
 .../locksettings/LockSettingsService.smali    | 3521 ++++---
 .../locksettings/LockSettingsStorage.smali    |   45 +-
 .../locksettings/RebootEscrowManager.smali    |  114 +-
 .../SyntheticPasswordCrypto.smali             |  407 -
 ...sswordManager$AuthenticationSdpToken.smali |    7 -
 ...yntheticPasswordManager$PasswordData.smali |   49 +-
 ...ordManager$$ExternalSyntheticLambda0.smali |   50 -
 ...ordManager$$ExternalSyntheticLambda1.smali |  116 -
 ...dManager$SdpSyntheticPasswordManager.smali | 1756 +---
 ...ticPasswordManager$SyntheticPassword.smali |  225 -
 .../SyntheticPasswordManager$TokenData.smali  |    2 -
 .../SyntheticPasswordManager.smali            | 3499 +++----
 ...yntheticPasswordMdfpp$KeyingMaterial.smali |  128 -
 .../SyntheticPasswordMdfpp$Utils.smali        |   26 -
 .../locksettings/SyntheticPasswordMdfpp.smali |  195 -
 .../android/server/pm/ComputerEngine.smali    |    8 +-
 ...geManagerService$IPackageManagerImpl.smali |  165 +-
 .../server/pm/PackageManagerService.smali     |   73 -
 .../server/pm/PersonaManagerService$2.smali   |    6 +-
 .../server/pm/PersonaManagerService.smali     |  113 +-
 ...viceHelper$$ExternalSyntheticLambda0.smali |  147 +-
 ...viceHelper$$ExternalSyntheticLambda1.smali |   24 -
 ...viceHelper$$ExternalSyntheticLambda2.smali |  131 +-
 ...viceHelper$$ExternalSyntheticLambda3.smali |   44 +
 ...viceHelper$$ExternalSyntheticLambda4.smali |   52 +-
 .../server/pm/PersonaServiceHelper.smali      |    8 +-
 .../server/pm/RemovePackageHelper.smali       |  246 +-
 ...erService$$ExternalSyntheticLambda11.smali |   36 -
 ...gerService$$ExternalSyntheticLambda2.smali |   72 +-
 ...gerService$$ExternalSyntheticLambda3.smali |   72 +-
 ...gerService$$ExternalSyntheticLambda4.smali |   33 +-
 ...gerService$$ExternalSyntheticLambda5.smali |   41 +-
 ...gerService$$ExternalSyntheticLambda6.smali |   66 +-
 ...gerService$$ExternalSyntheticLambda7.smali |   84 -
 ...erService$$ExternalSyntheticLambda8.smali} |   14 +-
 ...gerService$$ExternalSyntheticLambda9.smali |  100 +-
 .../pm/UserManagerService$LifeCycle.smali     |    8 +-
 .../server/pm/UserManagerService.smali        | 1066 ++-
 .../server/trust/TrustAgentWrapper$3.smali    |    4 +-
 ...gerService$$ExternalSyntheticLambda0.smali |   34 +-
 ...gerService$$ExternalSyntheticLambda1.smali |   75 +-
 ...gerService$$ExternalSyntheticLambda2.smali |   65 +-
 ...gerService$$ExternalSyntheticLambda3.smali |   82 -
 .../server/trust/TrustManagerService$3.smali  |   83 +-
 .../server/trust/TrustManagerService.smali    |   64 +-
 ...ServiceExt$$ExternalSyntheticLambda5.smali |   84 +-
 .../wm/ActivityTaskManagerServiceExt.smali    |   66 +-
 126 files changed, 9276 insertions(+), 35076 deletions(-)
 create mode 100644 smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1.smali
 rename smali/com/android/server/enterprise/security/{PasswordPolicy$$ExternalSyntheticLambda12.smali => PasswordPolicy$$ExternalSyntheticLambda11.smali} (82%)
 rename smali/com/android/server/enterprise/security/{PasswordPolicy$$ExternalSyntheticLambda15.smali => PasswordPolicy$$ExternalSyntheticLambda14.smali} (90%)
 rename smali/com/android/server/enterprise/security/{PasswordPolicy$$ExternalSyntheticLambda18.smali => PasswordPolicy$$ExternalSyntheticLambda17.smali} (79%)
 rename smali/com/android/server/enterprise/security/{PasswordPolicy$$ExternalSyntheticLambda21.smali => PasswordPolicy$$ExternalSyntheticLambda20.smali} (82%)
 rename smali/com/android/server/enterprise/security/{PasswordPolicy$$ExternalSyntheticLambda25.smali => PasswordPolicy$$ExternalSyntheticLambda24.smali} (96%)
 rename smali/com/android/server/enterprise/security/{PasswordPolicy$$ExternalSyntheticLambda27.smali => PasswordPolicy$$ExternalSyntheticLambda26.smali} (77%)
 rename smali/com/android/server/enterprise/security/{PasswordPolicy$$ExternalSyntheticLambda43.smali => PasswordPolicy$$ExternalSyntheticLambda42.smali} (82%)
 rename smali/com/android/server/enterprise/security/{PasswordPolicy$$ExternalSyntheticLambda47.smali => PasswordPolicy$$ExternalSyntheticLambda46.smali} (91%)
 create mode 100644 smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51.smali
 delete mode 100644 smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda53.smali
 delete mode 100644 smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8.smali
 rename smali/com/android/server/enterprise/security/{PasswordPolicy$$ExternalSyntheticLambda10.smali => PasswordPolicy$$ExternalSyntheticLambda9.smali} (76%)
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpDatabaseCache$1.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpDatabaseCache$DatabaseHelper.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpDatabaseCache.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$1.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$3.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy$$ExternalSyntheticLambda0.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$StateListener.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda1.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient.smali
 create mode 100644 smali/com/android/server/knox/dar/sdp/SdpManagerInternal.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/engine/SdpPolicy.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase.smali
 delete mode 100644 smali/com/android/server/knox/dar/sdp/engine/SdpServiceKeeper.smali
 create mode 100644 smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14.smali
 delete mode 100644 smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20.smali
 delete mode 100644 smali/com/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda0.smali
 delete mode 100644 smali/com/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5.smali
 delete mode 100644 smali/com/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6.smali
 delete mode 100644 smali/com/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken.smali
 delete mode 100644 smali/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda0.smali
 delete mode 100644 smali/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1.smali
 delete mode 100644 smali/com/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial.smali
 delete mode 100644 smali/com/android/server/locksettings/SyntheticPasswordMdfpp$Utils.smali
 delete mode 100644 smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1.smali
 create mode 100644 smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3.smali
 delete mode 100644 smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda11.smali
 delete mode 100644 smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda7.smali
 rename smali_classes2/com/android/server/pm/{UserManagerService$$ExternalSyntheticLambda10.smali => UserManagerService$$ExternalSyntheticLambda8.smali} (82%)
 delete mode 100644 smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda3.smali

diff --git a/smali/com/android/server/StorageManagerService$Callbacks.smali b/smali/com/android/server/StorageManagerService$Callbacks.smali
index e0a028051..fc1dc7c33 100644
--- a/smali/com/android/server/StorageManagerService$Callbacks.smali
+++ b/smali/com/android/server/StorageManagerService$Callbacks.smali
@@ -475,7 +475,7 @@
     move-result v5
 
     :goto_4
-    if-ge v2, v5, :cond_21
+    if-ge v2, v5, :cond_20
 
     invoke-virtual {v3, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
@@ -672,7 +672,7 @@
 
     move-result v3
 
-    if-eqz v3, :cond_21
+    if-eqz v3, :cond_20
 
     invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -1236,9 +1236,9 @@
 
     iget-object v0, v0, Landroid/os/storage/VolumeInfo;->path:Ljava/lang/String;
 
-    const/4 v4, 0x2
+    const/4 v3, 0x2
 
-    invoke-virtual {v2, v4, v0}, Landroid/os/Handler;->obtainMessage(ILjava/lang/Object;)Landroid/os/Message;
+    invoke-virtual {v2, v3, v0}, Landroid/os/Handler;->obtainMessage(ILjava/lang/Object;)Landroid/os/Message;
 
     move-result-object v0
 
@@ -1251,49 +1251,6 @@
     :try_end_a
     .catchall {:try_start_a .. :try_end_a} :catchall_3
 
-    iget-object v0, v5, Lcom/android/server/storage/WatchedVolumeInfo;->mVolumeInfo:Landroid/os/storage/VolumeInfo;
-
-    iget v2, v0, Landroid/os/storage/VolumeInfo;->type:I
-
-    const/4 v4, 0x2
-
-    if-ne v2, v4, :cond_16
-
-    if-ne v8, v4, :cond_16
-
-    iget v0, v0, Landroid/os/storage/VolumeInfo;->mountUserId:I
-
-    invoke-static {v0}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_16
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v2
-
-    if-nez v2, :cond_16
-
-    const-string/jumbo v2, "StorageManagerService.SDP"
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string v5, "Emulated volume mounted for user "
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-static {v2, v4}, Landroid/util/sysfwutil/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v3, v0}, Lcom/android/server/StorageManagerService;->mountSdpMediaStorageCmd(I)Z
-
-    :cond_16
     :goto_10
     invoke-virtual {v1}, Lcom/android/internal/os/SomeArgs;->recycle()V
 
@@ -1604,7 +1561,7 @@
 
     move-result-object v2
 
-    if-eqz v2, :cond_21
+    if-eqz v2, :cond_20
 
     new-instance v3, Landroid/content/Intent;
 
@@ -1657,7 +1614,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_17
+    if-eqz v2, :cond_16
 
     const-string/jumbo v0, "StorageManagerService"
 
@@ -1685,7 +1642,7 @@
 
     goto/16 :goto_1f
 
-    :cond_17
+    :cond_16
     iget-object v0, v0, Lcom/android/server/StorageManagerService$Callbacks;->mCallbacks:Ljava/lang/Object;
 
     check-cast v0, Lcom/android/server/StorageManagerService;
@@ -1750,7 +1707,7 @@
 
     check-cast v0, Ljava/lang/Runnable;
 
-    if-eqz v0, :cond_21
+    if-eqz v0, :cond_20
 
     invoke-interface {v0}, Ljava/lang/Runnable;->run()V
 
@@ -1790,13 +1747,13 @@
     move v4, v2
 
     :goto_14
-    if-eqz v1, :cond_21
+    if-eqz v1, :cond_20
 
-    if-eqz v4, :cond_18
+    if-eqz v4, :cond_17
 
     goto :goto_15
 
-    :cond_18
+    :cond_17
     move v2, v3
 
     :goto_15
@@ -1894,16 +1851,16 @@
     move v0, v2
 
     :goto_16
-    if-nez v0, :cond_19
+    if-nez v0, :cond_18
 
     goto :goto_19
 
-    :cond_19
+    :cond_18
     invoke-static {v3}, Lcom/android/server/NandswapManager;->makeNandswapBigdataManager(Landroid/content/Context;)Z
 
     move-result v0
 
-    if-nez v0, :cond_1a
+    if-nez v0, :cond_19
 
     const-string v0, "Bigdata is not supported"
 
@@ -1916,7 +1873,7 @@
 
     goto :goto_18
 
-    :cond_1a
+    :cond_19
     :goto_17
     sput-object v3, Lcom/android/server/NandswapManager;->mContext:Landroid/content/Context;
 
@@ -1996,7 +1953,7 @@
 
     move-result v0
 
-    if-nez v0, :cond_1b
+    if-nez v0, :cond_1a
 
     iget-object v0, v1, Lcom/android/server/StorageManagerService;->mContext:Landroid/content/Context;
 
@@ -2010,13 +1967,13 @@
 
     move-result v0
 
-    if-eqz v0, :cond_1b
+    if-eqz v0, :cond_1a
 
     iget-object v0, v1, Lcom/android/server/StorageManagerService;->mContext:Landroid/content/Context;
 
     invoke-static {v0}, Lcom/android/server/ZramWriteback;->scheduleZramWriteback(Landroid/content/Context;)V
 
-    :cond_1b
+    :cond_1a
     new-instance v0, Landroid/media/MediaCodecList;
 
     invoke-direct {v0, v2}, Landroid/media/MediaCodecList;-><init>(I)V
@@ -2030,7 +1987,7 @@
     move v5, v2
 
     :goto_1a
-    if-ge v5, v3, :cond_1f
+    if-ge v5, v3, :cond_1e
 
     aget-object v6, v0, v5
 
@@ -2038,11 +1995,11 @@
 
     move-result v7
 
-    if-eqz v7, :cond_1c
+    if-eqz v7, :cond_1b
 
     goto :goto_1c
 
-    :cond_1c
+    :cond_1b
     invoke-virtual {v6}, Landroid/media/MediaCodecInfo;->getSupportedTypes()[Ljava/lang/String;
 
     move-result-object v6
@@ -2052,7 +2009,7 @@
     move v8, v2
 
     :goto_1b
-    if-ge v8, v7, :cond_1e
+    if-ge v8, v7, :cond_1d
 
     aget-object v9, v6, v8
 
@@ -2062,22 +2019,22 @@
 
     move-result v9
 
-    if-eqz v9, :cond_1d
+    if-eqz v9, :cond_1c
 
     goto :goto_1d
 
-    :cond_1d
+    :cond_1c
     add-int/2addr v8, v4
 
     goto :goto_1b
 
-    :cond_1e
+    :cond_1d
     :goto_1c
     add-int/2addr v5, v4
 
     goto :goto_1a
 
-    :cond_1f
+    :cond_1e
     move v4, v2
 
     :goto_1d
@@ -2087,7 +2044,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_20
+    if-eqz v0, :cond_1f
 
     const-string/jumbo v0, "persist.sys.fuse.transcode_enabled"
 
@@ -2097,7 +2054,7 @@
 
     goto :goto_1e
 
-    :cond_20
+    :cond_1f
     const-string/jumbo v0, "storage_native_boot"
 
     const-string/jumbo v2, "transcode_enabled"
@@ -2115,7 +2072,7 @@
 
     invoke-static {v2, v3}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
 
-    if-eqz v0, :cond_21
+    if-eqz v0, :cond_20
 
     const-class v0, Landroid/app/ActivityManagerInternal;
 
@@ -2132,7 +2089,7 @@
     invoke-virtual {v0, v2}, Landroid/app/ActivityManagerInternal;->registerAnrController(Landroid/app/AnrController;)V
 
     :catch_b
-    :cond_21
+    :cond_20
     :goto_1f
     return-void
 
@@ -2155,7 +2112,7 @@
     move-result v5
 
     :goto_20
-    if-ge v2, v5, :cond_22
+    if-ge v2, v5, :cond_21
 
     iget-object v6, v0, Lcom/android/server/StorageManagerService$Callbacks;->mCallbacks:Ljava/lang/Object;
 
@@ -2179,7 +2136,7 @@
 
     goto :goto_20
 
-    :cond_22
+    :cond_21
     iget-object v0, v0, Lcom/android/server/StorageManagerService$Callbacks;->mCallbacks:Ljava/lang/Object;
 
     check-cast v0, Landroid/os/RemoteCallbackList;
diff --git a/smali/com/android/server/am/ProcessList.smali b/smali/com/android/server/am/ProcessList.smali
index a0e761dc7..a96d769e4 100644
--- a/smali/com/android/server/am/ProcessList.smali
+++ b/smali/com/android/server/am/ProcessList.smali
@@ -15034,7 +15034,7 @@
 
     invoke-interface {v9, v10, v8}, Landroid/content/pm/IPackageManager;->checkPackageStartable(Ljava/lang/String;I)V
     :try_end_1
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_9
+    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_5
     .catch Ljava/lang/RuntimeException; {:try_start_1 .. :try_end_1} :catch_0
 
     :try_start_2
@@ -15146,7 +15146,7 @@
     :goto_0
     move-object v1, v7
 
-    goto/16 :goto_1f
+    goto/16 :goto_19
 
     :catch_0
     move-exception v0
@@ -16088,237 +16088,75 @@
 
     invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V
 
-    move-object/from16 v20, v0
+    move-object/from16 v18, v1
 
-    const-string/jumbo v0, "SELinux tag not defined for "
+    const-string/jumbo v1, "SELinux tag not defined for "
 
-    invoke-virtual {v10, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-object v0, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    iget-object v1, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    invoke-virtual {v10, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string v0, " (uid "
+    const-string v1, " (uid "
 
-    invoke-virtual {v10, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget v0, v4, Lcom/android/server/am/ProcessRecord;->uid:I
+    iget v1, v4, Lcom/android/server/am/ProcessRecord;->uid:I
 
-    invoke-virtual {v10, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v0, ")"
+    const-string v1, ")"
 
-    invoke-virtual {v10, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v0
+    move-result-object v1
 
-    invoke-direct {v9, v0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
+    invoke-direct {v9, v1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
 
     invoke-static {v7, v8, v9}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
     goto :goto_17
 
     :cond_2c
-    move-object/from16 v20, v0
+    move-object/from16 v18, v1
 
     :goto_17
     invoke-virtual/range {p0 .. p1}, Lcom/android/server/am/ProcessList;->updateSeInfo(Lcom/android/server/am/ProcessRecord;)Ljava/lang/String;
 
     move-result-object v10
 
-    const/4 v0, 0x2
-
-    new-array v8, v0, [I
-
-    const/16 v19, 0x0
-
-    aput v19, v8, v19
-
-    const/16 v21, 0x1
-
-    aput v19, v8, v21
-    :try_end_8
-    .catch Ljava/lang/RuntimeException; {:try_start_8 .. :try_end_8} :catch_0
-
-    :try_start_9
-    invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
-
-    move-result-object v0
-
-    iget-object v9, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
-
-    iget-object v9, v9, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
-    :try_end_9
-    .catch Landroid/os/RemoteException; {:try_start_9 .. :try_end_9} :catch_7
-    .catch Ljava/lang/RuntimeException; {:try_start_9 .. :try_end_9} :catch_0
-
-    move-object/from16 v22, v1
-
-    :try_start_a
-    iget v1, v4, Lcom/android/server/am/ProcessRecord;->userId:I
-    :try_end_a
-    .catch Landroid/os/RemoteException; {:try_start_a .. :try_end_a} :catch_6
-    .catch Ljava/lang/RuntimeException; {:try_start_a .. :try_end_a} :catch_0
-
-    move/from16 v23, v5
-
-    move/from16 p4, v6
-
-    const-wide/16 v5, 0x80
-
-    :try_start_b
-    invoke-interface {v0, v9, v5, v6, v1}, Landroid/content/pm/IPackageManager;->getApplicationInfo(Ljava/lang/String;JI)Landroid/content/pm/ApplicationInfo;
-
-    move-result-object v0
-
-    if-eqz v0, :cond_2d
-
-    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->metaData:Landroid/os/Bundle;
-
-    if-eqz v0, :cond_2d
-
-    const-string/jumbo v1, "enabled"
-
-    const-string/jumbo v5, "sdp"
-
-    invoke-virtual {v0, v5}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v1, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z
-
-    move-result v0
-    :try_end_b
-    .catch Landroid/os/RemoteException; {:try_start_b .. :try_end_b} :catch_5
-    .catch Ljava/lang/RuntimeException; {:try_start_b .. :try_end_b} :catch_0
-
-    if-eqz v0, :cond_2d
-
-    const/16 v0, 0x1f41
-
-    const/16 v19, 0x0
-
-    :try_start_c
-    aput v0, v8, v19
-    :try_end_c
-    .catch Landroid/os/RemoteException; {:try_start_c .. :try_end_c} :catch_4
-    .catch Ljava/lang/RuntimeException; {:try_start_c .. :try_end_c} :catch_0
-
-    const/4 v0, 0x1
-
-    goto :goto_1b
-
-    :catch_4
-    const/4 v0, 0x1
-
-    goto :goto_1a
-
-    :catch_5
-    :goto_18
-    const/4 v0, 0x0
-
-    goto :goto_1a
-
-    :cond_2d
-    const/4 v0, 0x0
-
-    goto :goto_1b
-
-    :catch_6
-    :goto_19
-    move/from16 v23, v5
-
-    move/from16 p4, v6
-
-    goto :goto_18
-
-    :catch_7
-    move-object/from16 v22, v1
-
-    goto :goto_19
-
-    :goto_1a
-    :try_start_d
-    const-string v1, "Failed to get metadata for sdp "
-
-    invoke-static {v7, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_1b
-    if-lez v0, :cond_2f
-
-    const/4 v5, 0x2
-
-    if-gt v0, v5, :cond_2f
-
-    if-nez v20, :cond_2e
-
-    const/4 v9, 0x0
-
-    new-array v1, v9, [I
-
-    goto :goto_1c
-
-    :cond_2e
-    move-object/from16 v1, v20
-
-    :goto_1c
-    array-length v5, v1
-
-    add-int/2addr v5, v0
-
-    new-array v5, v5, [I
-
-    array-length v6, v1
-
-    const/4 v9, 0x0
-
-    invoke-static {v1, v9, v5, v9, v6}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
-
-    array-length v1, v1
-
-    invoke-static {v8, v9, v5, v1, v0}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
-
-    iput-object v5, v4, Lcom/android/server/am/ProcessRecord;->mGids:[I
-
-    move-object v0, v5
-
-    goto :goto_1d
-
-    :cond_2f
-    move-object/from16 v0, v20
-
-    :goto_1d
     iget v1, v4, Lcom/android/server/am/ProcessRecord;->userId:I
 
     invoke-static {v1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
 
     move-result v1
 
-    if-eqz v1, :cond_31
+    if-eqz v1, :cond_2e
 
     iget v1, v4, Lcom/android/server/am/ProcessRecord;->userId:I
 
     invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARPolicyService()Ljava/util/Optional;
 
-    move-result-object v5
+    move-result-object v8
 
-    new-instance v6, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;
+    new-instance v9, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;
 
-    const/4 v9, 0x0
+    const/4 v3, 0x0
 
-    invoke-direct {v6, v1, v9}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;-><init>(II)V
+    invoke-direct {v9, v1, v3}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;-><init>(II)V
 
-    invoke-virtual {v5, v6}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
+    invoke-virtual {v8, v9}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
     move-result-object v1
 
-    sget-object v5, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
+    sget-object v3, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
 
-    invoke-virtual {v1, v5}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {v1, v3}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
 
     move-result-object v1
 
@@ -16328,37 +16166,37 @@
 
     move-result v1
 
-    if-eqz v1, :cond_31
+    if-eqz v1, :cond_2e
 
     iget-object v1, v2, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
 
     iget-object v1, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    iget-object v5, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    iget-object v3, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    iget v6, v4, Lcom/android/server/am/ProcessRecord;->userId:I
+    iget v8, v4, Lcom/android/server/am/ProcessRecord;->userId:I
 
-    invoke-static {v1, v5, v6}, Lcom/android/server/pm/PersonaServiceHelper;->isPackageAllowlistedForDEAccessForDualDAR(Landroid/content/Context;Ljava/lang/String;I)Z
+    invoke-static {v1, v3, v8}, Lcom/android/server/pm/PersonaServiceHelper;->isPackageAllowlistedForDEAccessForDualDAR(Landroid/content/Context;Ljava/lang/String;I)Z
 
     move-result v1
 
-    if-nez v1, :cond_31
+    if-nez v1, :cond_2e
 
     new-instance v1, Ljava/lang/StringBuilder;
 
     invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
 
-    const-string v5, "DE Restriction for package "
+    const-string v3, "DE Restriction for package "
 
-    invoke-virtual {v1, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-object v5, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+    iget-object v3, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
 
-    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    invoke-virtual {v1, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
@@ -16366,72 +16204,72 @@
 
     invoke-static {v7, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    if-nez v0, :cond_30
+    if-nez v0, :cond_2d
 
     const/4 v1, 0x1
 
     new-array v0, v1, [I
 
-    goto :goto_1e
+    goto :goto_18
 
-    :cond_30
+    :cond_2d
     const/4 v1, 0x1
 
-    array-length v5, v0
+    array-length v3, v0
 
-    add-int/2addr v5, v1
+    add-int/2addr v3, v1
 
-    new-array v5, v5, [I
+    new-array v3, v3, [I
 
-    array-length v6, v0
+    array-length v8, v0
 
     const/4 v9, 0x0
 
-    invoke-static {v0, v9, v5, v9, v6}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
+    invoke-static {v0, v9, v3, v9, v8}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
 
-    move-object v0, v5
+    move-object v0, v3
 
-    :goto_1e
-    array-length v5, v0
+    :goto_18
+    array-length v3, v0
 
-    sub-int/2addr v5, v1
+    sub-int/2addr v3, v1
 
     const/16 v1, 0x14b4
 
-    aput v1, v0, v5
+    aput v1, v0, v3
 
     iput-object v0, v4, Lcom/android/server/am/ProcessRecord;->mGids:[I
-    :try_end_d
-    .catch Ljava/lang/RuntimeException; {:try_start_d .. :try_end_d} :catch_0
+    :try_end_8
+    .catch Ljava/lang/RuntimeException; {:try_start_8 .. :try_end_8} :catch_0
 
-    :cond_31
-    move/from16 v8, p3
+    :cond_2e
+    move-object/from16 v3, p2
 
-    move-object v6, v0
+    move/from16 v8, p3
 
     move-object v1, v7
 
     move v9, v12
 
-    move-object/from16 v12, v22
+    move-object/from16 v12, v18
 
-    move/from16 v5, v23
+    move v7, v6
 
-    move/from16 v7, p4
+    move-object v6, v0
 
-    :try_start_e
+    :try_start_9
     invoke-virtual/range {v2 .. v17}, Lcom/android/server/am/ProcessList;->startProcessLocked(Lcom/android/server/am/HostingRecord;Lcom/android/server/am/ProcessRecord;I[IIIILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;JJ)Z
 
     move-result v0
 
     return v0
 
-    :catch_8
+    :catch_4
     move-exception v0
 
-    goto :goto_1f
+    goto :goto_19
 
-    :catch_9
+    :catch_5
     move-exception v0
 
     move-object v1, v7
@@ -16441,10 +16279,10 @@
     move-result-object v0
 
     throw v0
-    :try_end_e
-    .catch Ljava/lang/RuntimeException; {:try_start_e .. :try_end_e} :catch_8
+    :try_end_9
+    .catch Ljava/lang/RuntimeException; {:try_start_9 .. :try_end_9} :catch_4
 
-    :goto_1f
+    :goto_19
     new-instance v3, Ljava/lang/StringBuilder;
 
     const-string v5, "Failure starting process "
diff --git a/smali/com/android/server/am/UserController$$ExternalSyntheticLambda2.smali b/smali/com/android/server/am/UserController$$ExternalSyntheticLambda2.smali
index f4753ccad..e001f693e 100644
--- a/smali/com/android/server/am/UserController$$ExternalSyntheticLambda2.smali
+++ b/smali/com/android/server/am/UserController$$ExternalSyntheticLambda2.smali
@@ -36,7 +36,7 @@
 
 # virtual methods
 .method public final run()V
-    .locals 12
+    .locals 11
 
     iget v0, p0, Lcom/android/server/am/UserController$$ExternalSyntheticLambda2;->$r8$classId:I
 
@@ -155,7 +155,7 @@
 
     invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    goto/16 :goto_1
+    goto :goto_0
 
     :cond_0
     iget v2, p0, Lcom/android/server/am/UserState;->state:I
@@ -192,245 +192,8 @@
 
     move-result-object v3
 
-    invoke-virtual {v3, v1}, Lcom/android/server/pm/UserManagerService;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v4
-
-    const/4 v6, 0x2
-
-    if-nez v4, :cond_1
-
-    goto/16 :goto_0
-
-    :cond_1
-    sget-object v7, Landroid/content/pm/PackagePartitions;->FINGERPRINT:Ljava/lang/String;
-
-    iget-object v8, v4, Landroid/content/pm/UserInfo;->lastLoggedInFingerprint:Ljava/lang/String;
-
-    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v7
-
-    xor-int/2addr v7, v5
-
-    new-instance v8, Lcom/android/server/utils/TimingsTraceAndSlog;
-
-    invoke-direct {v8}, Lcom/android/server/utils/TimingsTraceAndSlog;-><init>()V
-
-    new-instance v9, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v10, "prepareUserData-"
-
-    invoke-direct {v9, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v9, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v9
-
-    invoke-virtual {v8, v9}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
-
-    iget-object v9, v3, Lcom/android/server/pm/UserManagerService;->mUserDataPreparer:Lcom/android/server/pm/UserDataPreparer;
-
-    invoke-virtual {v9, v6, v4}, Lcom/android/server/pm/UserDataPreparer;->prepareUserData(ILandroid/content/pm/UserInfo;)V
-
-    invoke-virtual {v8}, Landroid/util/TimingsTraceLog;->traceEnd()V
-
-    invoke-virtual {v4}, Landroid/content/pm/UserInfo;->isManagedProfile()Z
-
-    move-result v9
-
-    const-string/jumbo v10, "UserManagerService"
-
-    if-eqz v9, :cond_2
-
-    iget v9, v4, Landroid/content/pm/UserInfo;->flags:I
-
-    const/high16 v11, 0x6000000
-
-    and-int/2addr v9, v11
-
-    if-lez v9, :cond_2
-
-    const-string v9, "Apply policies on CE storage for dualdar user "
-
-    invoke-static {v1, v9, v10}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object v9, v3, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v9}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v9
-
-    invoke-virtual {v9, v1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->handleBeforeUnlockUser(I)Z
-
-    move-result v9
-
-    if-nez v9, :cond_2
-
-    const-string/jumbo v4, "To set DualDAR Policy on CE storage was failed."
-
-    invoke-static {v10, v4}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v3, v1}, Lcom/android/server/pm/UserManagerService;->removeInvalidEnterpriseUser(I)V
-
-    goto/16 :goto_0
-
-    :cond_2
-    invoke-virtual {v4}, Landroid/content/pm/UserInfo;->isManagedProfile()Z
-
-    move-result v4
-
-    if-eqz v4, :cond_5
-
-    iget-object v4, v3, Lcom/android/server/pm/UserManagerService;->mSdpManagerInternal:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    if-nez v4, :cond_4
-
-    iget-object v4, v3, Lcom/android/server/pm/UserManagerService;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    if-nez v4, :cond_3
-
-    const-string/jumbo v4, "dar"
-
-    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v4
-
-    check-cast v4, Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v4, :cond_3
-
-    iget-object v4, v4, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iput-object v4, v3, Lcom/android/server/pm/UserManagerService;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    :cond_3
-    iget-object v4, v3, Lcom/android/server/pm/UserManagerService;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {v4}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object v4
-
-    new-instance v9, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6;
-
-    const/4 v11, 0x1
-
-    invoke-direct {v9, v11}, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6;-><init>(I)V
-
-    invoke-virtual {v4, v9}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object v4
-
-    sget-object v9, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {v4, v9}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v4
-
-    check-cast v4, Ljava/lang/Boolean;
-
-    invoke-virtual {v4}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result v4
-
-    if-eqz v4, :cond_4
-
-    const-class v4, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
+    invoke-virtual {v3, v1}, Lcom/android/server/pm/UserManagerService;->onBeforeUnlockUser(I)V
 
-    invoke-static {v4}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v4
-
-    check-cast v4, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    iput-object v4, v3, Lcom/android/server/pm/UserManagerService;->mSdpManagerInternal:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    :cond_4
-    iget-object v4, v3, Lcom/android/server/pm/UserManagerService;->mSdpManagerInternal:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    invoke-static {v4}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object v4
-
-    new-instance v9, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda9;
-
-    invoke-direct {v9, v1}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda9;-><init>(I)V
-
-    invoke-virtual {v4, v9}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object v4
-
-    sget-object v9, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {v4, v9}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v4
-
-    check-cast v4, Ljava/lang/Boolean;
-
-    invoke-virtual {v4}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result v4
-
-    if-nez v4, :cond_5
-
-    const-string v4, "Failed to set sdp policy"
-
-    invoke-static {v10, v4}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v3, v1}, Lcom/android/server/pm/UserManagerService;->removeInvalidEnterpriseUser(I)V
-
-    goto :goto_0
-
-    :cond_5
-    const-class v4, Landroid/os/storage/StorageManagerInternal;
-
-    invoke-static {v4}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v4
-
-    check-cast v4, Landroid/os/storage/StorageManagerInternal;
-
-    invoke-virtual {v4, v1}, Landroid/os/storage/StorageManagerInternal;->markCeStoragePrepared(I)V
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v9, "reconcileAppsData-"
-
-    invoke-direct {v4, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {v8, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
-
-    iget-object v4, v3, Lcom/android/server/pm/UserManagerService;->mPmInternal:Landroid/content/pm/PackageManagerInternal;
-
-    if-nez v4, :cond_6
-
-    const-class v4, Landroid/content/pm/PackageManagerInternal;
-
-    invoke-static {v4}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v4
-
-    check-cast v4, Landroid/content/pm/PackageManagerInternal;
-
-    iput-object v4, v3, Lcom/android/server/pm/UserManagerService;->mPmInternal:Landroid/content/pm/PackageManagerInternal;
-
-    :cond_6
-    iget-object v3, v3, Lcom/android/server/pm/UserManagerService;->mPmInternal:Landroid/content/pm/PackageManagerInternal;
-
-    invoke-virtual {v3, v1, v6, v7}, Landroid/content/pm/PackageManagerInternal;->reconcileAppsData(IIZ)V
-
-    invoke-virtual {v8}, Landroid/util/TimingsTraceLog;->traceEnd()V
-
-    :goto_0
     invoke-virtual {v2}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
     iget v2, p0, Lcom/android/server/am/UserState;->state:I
@@ -445,25 +208,27 @@
 
     monitor-enter v2
 
+    const/4 v3, 0x2
+
     :try_start_0
-    invoke-virtual {p0, v5, v6}, Lcom/android/server/am/UserState;->setState(II)Z
+    invoke-virtual {p0, v5, v3}, Lcom/android/server/am/UserState;->setState(II)Z
 
     move-result v3
 
-    if-nez v3, :cond_7
+    if-nez v3, :cond_1
 
     monitor-exit v2
 
-    goto :goto_1
+    goto :goto_0
 
     :catchall_0
     move-exception v0
 
     move-object p0, v0
 
-    goto :goto_2
+    goto :goto_1
 
-    :cond_7
+    :cond_1
     monitor-exit v2
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
@@ -510,10 +275,10 @@
 
     invoke-static {v1, p0, v5, v0, v2}, Lcom/android/server/am/UserController;->showEventLog(IIILjava/lang/String;Ljava/lang/String;)V
 
-    :goto_1
+    :goto_0
     return-void
 
-    :goto_2
+    :goto_1
     :try_start_1
     monitor-exit v2
     :try_end_1
@@ -543,7 +308,7 @@
 
     move-result-object v4
 
-    if-eqz v4, :cond_8
+    if-eqz v4, :cond_2
 
     const-string p0, "ActivityManager"
 
@@ -553,16 +318,16 @@
 
     monitor-exit v3
 
-    goto :goto_4
+    goto :goto_3
 
     :catchall_1
     move-exception v0
 
     move-object p0, v0
 
-    goto :goto_5
+    goto :goto_4
 
-    :cond_8
+    :cond_2
     monitor-exit v3
     :try_end_2
     .catchall {:try_start_2 .. :try_end_2} :catchall_1
@@ -600,19 +365,19 @@
     :try_end_3
     .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0
 
-    if-nez p0, :cond_9
+    if-nez p0, :cond_3
 
-    goto :goto_4
+    goto :goto_3
 
-    :cond_9
+    :cond_3
     const/4 v0, 0x0
 
-    :goto_3
+    :goto_2
     invoke-interface {p0}, Ljava/util/List;->size()I
 
     move-result v2
 
-    if-ge v0, v2, :cond_a
+    if-ge v0, v2, :cond_4
 
     invoke-interface {p0, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
@@ -636,10 +401,10 @@
 
     add-int/lit8 v0, v0, 0x1
 
-    goto :goto_3
+    goto :goto_2
 
-    :cond_a
-    :goto_4
+    :cond_4
+    :goto_3
     return-void
 
     :catch_0
@@ -653,7 +418,7 @@
 
     throw p0
 
-    :goto_5
+    :goto_4
     :try_start_4
     monitor-exit v3
     :try_end_4
diff --git a/smali/com/android/server/am/UserController.smali b/smali/com/android/server/am/UserController.smali
index bbc237a8e..174dffdb7 100644
--- a/smali/com/android/server/am/UserController.smali
+++ b/smali/com/android/server/am/UserController.smali
@@ -2413,7 +2413,7 @@
     :catchall_0
     move-exception v0
 
-    goto/16 :goto_9
+    goto/16 :goto_8
 
     :cond_1
     move/from16 v1, p2
@@ -2690,7 +2690,7 @@
     :cond_8
     const/16 v7, 0xc8
 
-    if-eqz v2, :cond_11
+    if-eqz v2, :cond_e
 
     new-instance v2, Ljava/lang/StringBuilder;
 
@@ -2739,96 +2739,6 @@
     :try_end_2
     .catchall {:try_start_2 .. :try_end_2} :catchall_3
 
-    const-string/jumbo v2, "dar"
-
-    invoke-static {v2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v9
-
-    invoke-static {v9}, Lcom/samsung/android/knox/dar/IDarManagerService$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/dar/IDarManagerService;
-
-    move-result-object v9
-
-    check-cast v9, Lcom/android/server/knox/dar/DarManagerService;
-
-    const/4 v10, 0x0
-
-    if-eqz v9, :cond_9
-
-    invoke-static {v2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v2
-
-    invoke-static {v2}, Lcom/samsung/android/knox/dar/IDarManagerService$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/dar/IDarManagerService;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/server/knox/dar/DarManagerService;
-
-    iget-object v2, v2, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    goto :goto_5
-
-    :cond_9
-    move-object v2, v10
-
-    :goto_5
-    if-eqz v2, :cond_b
-
-    const-string/jumbo v2, "dar"
-
-    invoke-static {v2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v9
-
-    invoke-static {v9}, Lcom/samsung/android/knox/dar/IDarManagerService$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/dar/IDarManagerService;
-
-    move-result-object v9
-
-    check-cast v9, Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v9, :cond_a
-
-    invoke-static {v2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v2
-
-    invoke-static {v2}, Lcom/samsung/android/knox/dar/IDarManagerService$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/dar/IDarManagerService;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/server/knox/dar/DarManagerService;
-
-    iget-object v10, v2, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    :cond_a
-    invoke-virtual {v10}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string v9, "Cleaning up user - "
-
-    invoke-direct {v2, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    const-string/jumbo v9, "SdpManagerImpl"
-
-    invoke-static {v9, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo v2, "onCleanupUser"
-
-    invoke-virtual {v10, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkCallerPermissionFor(Ljava/lang/String;)V
-
-    const/16 v2, 0x9
-
-    invoke-virtual {v10, v2, v4}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->quickMessage(II)V
-
-    :cond_b
     invoke-virtual {v6}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
     new-instance v2, Ljava/lang/StringBuilder;
@@ -2892,11 +2802,11 @@
 
     move-result v2
 
-    if-eqz v2, :cond_c
+    if-eqz v2, :cond_9
 
     iget-boolean v2, v5, Landroid/content/pm/UserInfo;->preCreated:Z
 
-    if-nez v2, :cond_c
+    if-nez v2, :cond_9
 
     iget-object v2, v0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
 
@@ -2906,7 +2816,7 @@
 
     invoke-virtual {v2, v4}, Lcom/android/server/pm/UserManagerService;->removeUserEvenWhenDisallowed(I)Z
 
-    :cond_c
+    :cond_9
     iget-object v2, v0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
 
     invoke-virtual {v2}, Lcom/android/server/am/UserController$Injector;->getUserManager()Lcom/android/server/pm/UserManagerService;
@@ -2921,14 +2831,14 @@
 
     move-result-object v2
 
-    if-eqz v2, :cond_d
+    if-eqz v2, :cond_a
 
     iget-object v5, v0, Lcom/android/server/am/UserController;->mHandler:Landroid/os/Handler;
 
     invoke-virtual {v5, v7, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
 
-    :cond_d
-    if-eqz v3, :cond_e
+    :cond_a
+    if-eqz v3, :cond_b
 
     invoke-static {}, Lcom/android/server/FgThread;->getHandler()Landroid/os/Handler;
 
@@ -2942,7 +2852,7 @@
 
     invoke-virtual {v2, v3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    :cond_e
+    :cond_b
     iget-object v1, v0, Lcom/android/server/am/UserController;->mLock:Ljava/lang/Object;
 
     monitor-enter v1
@@ -2960,9 +2870,9 @@
 
     move-result v5
 
-    :cond_f
-    :goto_6
-    if-ge v12, v5, :cond_10
+    :cond_c
+    :goto_5
+    if-ge v12, v5, :cond_d
 
     invoke-virtual {v3, v12}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
@@ -2974,7 +2884,7 @@
 
     iget v7, v6, Lcom/android/server/am/UserController$PendingUserStart;->userId:I
 
-    if-ne v7, v4, :cond_f
+    if-ne v7, v4, :cond_c
 
     const-string v7, "ActivityManager"
 
@@ -3006,14 +2916,14 @@
 
     invoke-virtual {v2, v6}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
 
-    goto :goto_6
+    goto :goto_5
 
     :catchall_1
     move-exception v0
 
-    goto :goto_7
+    goto :goto_6
 
-    :cond_10
+    :cond_d
     iget-object v3, v0, Lcom/android/server/am/UserController;->mPendingUserStarts:Ljava/util/List;
 
     check-cast v3, Ljava/util/ArrayList;
@@ -3022,9 +2932,9 @@
 
     monitor-exit v1
 
-    goto :goto_8
+    goto :goto_7
 
-    :goto_7
+    :goto_6
     monitor-exit v1
     :try_end_4
     .catchall {:try_start_4 .. :try_end_4} :catchall_1
@@ -3053,7 +2963,7 @@
 
     throw v0
 
-    :cond_11
+    :cond_e
     iget-object v1, v0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
 
     invoke-virtual {v1}, Lcom/android/server/am/UserController$Injector;->getUserManager()Lcom/android/server/pm/UserManagerService;
@@ -3066,19 +2976,19 @@
 
     move-result-object v1
 
-    if-eqz v1, :cond_12
+    if-eqz v1, :cond_f
 
     iget-object v2, v0, Lcom/android/server/am/UserController;->mHandler:Landroid/os/Handler;
 
     invoke-virtual {v2, v7, v1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
 
-    :cond_12
-    :goto_8
+    :cond_f
+    :goto_7
     invoke-static {v4}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
 
     move-result v1
 
-    if-eqz v1, :cond_13
+    if-eqz v1, :cond_10
 
     iget-object v0, v0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
 
@@ -3098,10 +3008,10 @@
 
     invoke-virtual {v0, v4}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onUserStopped(I)V
 
-    :cond_13
+    :cond_10
     return-void
 
-    :goto_9
+    :goto_8
     :try_start_7
     monitor-exit v6
     :try_end_7
@@ -4231,9 +4141,9 @@
 
     const/16 v8, 0x1388
 
-    const/4 v9, 0x2
+    const/4 v9, 0x0
 
-    const/4 v10, 0x0
+    const/4 v10, 0x2
 
     const/4 v11, 0x1
 
@@ -4241,9 +4151,9 @@
 
     :cond_0
     :goto_0
-    move v9, v10
+    move/from16 v21, v9
 
-    goto/16 :goto_1a
+    goto/16 :goto_17
 
     :sswitch_0
     iget-object v0, v0, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -4262,17 +4172,17 @@
 
     iget-object v3, v0, Landroid/util/Pair;->first:Ljava/lang/Object;
 
-    move-object v13, v3
+    move-object v12, v3
 
-    check-cast v13, Landroid/content/pm/UserInfo;
+    check-cast v12, Landroid/content/pm/UserInfo;
 
     iget-object v3, v0, Landroid/util/Pair;->second:Ljava/lang/Object;
 
-    move-object v14, v3
+    move-object v13, v3
 
-    check-cast v14, Landroid/content/pm/UserInfo;
+    check-cast v13, Landroid/content/pm/UserInfo;
 
-    iget v3, v13, Landroid/content/pm/UserInfo;->id:I
+    iget v3, v12, Landroid/content/pm/UserInfo;->id:I
 
     iget-object v4, v1, Lcom/android/server/am/UserController;->mLock:Ljava/lang/Object;
 
@@ -4285,9 +4195,9 @@
 
     move-result-object v3
 
-    move-object/from16 v16, v3
+    move-object v15, v3
 
-    check-cast v16, Ljava/lang/String;
+    check-cast v15, Ljava/lang/String;
 
     monitor-exit v4
     :try_end_0
@@ -4310,9 +4220,9 @@
 
     move-result-object v3
 
-    move-object/from16 v17, v3
+    move-object/from16 v16, v3
 
-    check-cast v17, Ljava/lang/String;
+    check-cast v16, Ljava/lang/String;
 
     monitor-exit v5
     :try_end_1
@@ -4354,23 +4264,23 @@
     :try_start_2
     invoke-virtual {v2, v6}, Lcom/android/server/am/UserController$Injector;->dismissUserSwitchingDialog(Ljava/lang/Runnable;)V
 
-    new-instance v11, Lcom/android/server/am/UserSwitchingDialog;
+    new-instance v10, Lcom/android/server/am/UserSwitchingDialog;
 
     iget-object v0, v2, Lcom/android/server/am/UserController$Injector;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    iget-object v12, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
+    iget-object v11, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
 
-    iget-object v15, v2, Lcom/android/server/am/UserController$Injector;->mHandler:Landroid/os/Handler;
+    iget-object v14, v2, Lcom/android/server/am/UserController$Injector;->mHandler:Landroid/os/Handler;
 
-    invoke-direct/range {v11 .. v17}, Lcom/android/server/am/UserSwitchingDialog;-><init>(Landroid/content/Context;Landroid/content/pm/UserInfo;Landroid/content/pm/UserInfo;Landroid/os/Handler;Ljava/lang/String;Ljava/lang/String;)V
+    invoke-direct/range {v10 .. v16}, Lcom/android/server/am/UserSwitchingDialog;-><init>(Landroid/content/Context;Landroid/content/pm/UserInfo;Landroid/content/pm/UserInfo;Landroid/os/Handler;Ljava/lang/String;Ljava/lang/String;)V
 
-    iput-object v11, v2, Lcom/android/server/am/UserController$Injector;->mUserSwitchingDialog:Lcom/android/server/am/UserSwitchingDialog;
+    iput-object v10, v2, Lcom/android/server/am/UserController$Injector;->mUserSwitchingDialog:Lcom/android/server/am/UserSwitchingDialog;
 
-    invoke-virtual {v11, v3}, Lcom/android/server/am/UserSwitchingDialog;->show(Lcom/android/server/am/UserController$$ExternalSyntheticLambda3;)V
+    invoke-virtual {v10, v3}, Lcom/android/server/am/UserSwitchingDialog;->show(Lcom/android/server/am/UserController$$ExternalSyntheticLambda3;)V
 
     monitor-exit v1
 
-    return v10
+    return v9
 
     :catchall_0
     move-exception v0
@@ -4422,7 +4332,7 @@
 
     invoke-virtual {v1, v5, v0}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
 
-    return v10
+    return v9
 
     :sswitch_2
     iget-object v0, v0, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -4431,7 +4341,7 @@
 
     invoke-virtual {v1, v0}, Lcom/android/server/am/UserController;->processScheduledStopOfBackgroundUser(Ljava/lang/Integer;)V
 
-    return v10
+    return v9
 
     :sswitch_3
     iget-object v0, v0, Landroid/os/Message;->obj:Ljava/lang/Object;
@@ -4440,7 +4350,7 @@
 
     invoke-virtual {v1, v0}, Lcom/android/server/am/UserController;->reportOnUserCompletedEvent(Ljava/lang/Integer;)V
 
-    return v10
+    return v9
 
     :sswitch_4
     iget v2, v0, Landroid/os/Message;->arg1:I
@@ -4449,12 +4359,12 @@
 
     invoke-virtual {v1, v2, v0}, Lcom/android/server/am/UserController;->completeUserSwitch(II)V
 
-    return v10
+    return v9
 
     :sswitch_5
     iget v2, v0, Landroid/os/Message;->arg1:I
 
-    invoke-virtual {v1, v2, v9}, Lcom/android/server/am/UserController;->logUserJourneyBegin(II)V
+    invoke-virtual {v1, v2, v10}, Lcom/android/server/am/UserController;->logUserJourneyBegin(II)V
 
     iget v0, v0, Landroid/os/Message;->arg1:I
 
@@ -4474,7 +4384,7 @@
 
     iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/wm/WindowManagerService;
 
-    invoke-virtual {v0, v10}, Lcom/android/server/wm/WindowManagerService;->setSwitchingUser(Z)V
+    invoke-virtual {v0, v9}, Lcom/android/server/wm/WindowManagerService;->setSwitchingUser(Z)V
 
     new-instance v0, Lcom/android/server/am/UserController$$ExternalSyntheticLambda13;
 
@@ -4492,7 +4402,7 @@
 
     invoke-virtual {v2, v3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    return v10
+    return v9
 
     :sswitch_6
     iget v0, v0, Landroid/os/Message;->arg1:I
@@ -4503,7 +4413,7 @@
 
     move-result v2
 
-    move v3, v10
+    move v3, v9
 
     :goto_1
     if-ge v3, v2, :cond_2
@@ -4566,7 +4476,7 @@
     const/16 v8, 0x3e8
 
     :goto_2
-    invoke-virtual {v1, v2, v9, v8}, Lcom/android/server/am/UserController;->scheduleOnUserCompletedEvent(III)V
+    invoke-virtual {v1, v2, v10, v8}, Lcom/android/server/am/UserController;->scheduleOnUserCompletedEvent(III)V
 
     iget-object v1, v1, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
 
@@ -4578,9 +4488,9 @@
 
     iget v0, v0, Landroid/os/Message;->arg1:I
 
-    invoke-virtual {v1, v0, v4, v9}, Lcom/android/server/pm/UserJourneyLogger;->logUserLifecycleEvent(III)V
+    invoke-virtual {v1, v0, v4, v10}, Lcom/android/server/pm/UserJourneyLogger;->logUserLifecycleEvent(III)V
 
-    return v10
+    return v9
 
     :sswitch_8
     iget v2, v0, Landroid/os/Message;->arg1:I
@@ -4589,7 +4499,7 @@
 
     const-string/jumbo v6, "NULL"
 
-    invoke-static {v2, v3, v10, v5, v6}, Lcom/android/server/am/UserController;->showEventLog(IIILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {v2, v3, v9, v5, v6}, Lcom/android/server/am/UserController;->showEventLog(IIILjava/lang/String;Ljava/lang/String;)V
 
     iget-object v5, v1, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
 
@@ -4637,7 +4547,7 @@
 
     const/4 v8, 0x5
 
-    invoke-virtual {v5, v6, v8, v9}, Lcom/android/server/pm/UserJourneyLogger;->logUserLifecycleEvent(III)V
+    invoke-virtual {v5, v6, v8, v10}, Lcom/android/server/pm/UserJourneyLogger;->logUserLifecycleEvent(III)V
 
     iget-object v5, v1, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
 
@@ -4691,7 +4601,7 @@
 
     const-string/jumbo v12, "NULL"
 
-    invoke-static {v6, v0, v10, v8, v12}, Lcom/android/server/am/UserController;->showEventLog(IIILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {v6, v0, v9, v8, v12}, Lcom/android/server/am/UserController;->showEventLog(IIILjava/lang/String;Ljava/lang/String;)V
 
     iget v0, v5, Lcom/android/server/am/UserState;->state:I
 
@@ -4789,7 +4699,7 @@
 
     :cond_4
     :goto_3
-    move v5, v9
+    move v5, v10
 
     goto/16 :goto_10
 
@@ -4831,7 +4741,7 @@
     goto/16 :goto_13
 
     :cond_6
-    invoke-virtual {v5, v9, v7}, Lcom/android/server/am/UserState;->setState(II)Z
+    invoke-virtual {v5, v10, v7}, Lcom/android/server/am/UserState;->setState(II)Z
 
     move-result v0
 
@@ -4900,7 +4810,7 @@
 
     move-result v12
 
-    move v13, v10
+    move v13, v9
 
     :goto_4
     if-ge v13, v12, :cond_c
@@ -4915,7 +4825,7 @@
 
     move-result v15
 
-    move v3, v10
+    move v3, v9
 
     :goto_5
     if-ge v3, v15, :cond_b
@@ -4924,32 +4834,32 @@
 
     move-result-object v16
 
-    move-object/from16 v9, v16
+    move-object/from16 v10, v16
 
-    check-cast v9, Lcom/android/server/am/ProcessRecord;
+    check-cast v10, Lcom/android/server/am/ProcessRecord;
 
-    iget v10, v9, Lcom/android/server/am/ProcessRecord;->userId:I
+    iget v9, v10, Lcom/android/server/am/ProcessRecord;->userId:I
 
-    if-ne v10, v6, :cond_a
+    if-ne v9, v6, :cond_a
 
-    iget-object v10, v9, Lcom/android/server/am/ProcessRecord;->mThread:Lcom/android/server/am/ApplicationThreadDeferred;
+    iget-object v9, v10, Lcom/android/server/am/ProcessRecord;->mThread:Lcom/android/server/am/ApplicationThreadDeferred;
 
-    if-eqz v10, :cond_a
+    if-eqz v9, :cond_a
 
-    iget-boolean v10, v9, Lcom/android/server/am/ProcessRecord;->mUnlocked:Z
+    iget-boolean v9, v10, Lcom/android/server/am/ProcessRecord;->mUnlocked:Z
 
-    if-eqz v10, :cond_9
+    if-eqz v9, :cond_9
 
     goto :goto_6
 
     :cond_9
-    iget-object v10, v9, Lcom/android/server/am/ProcessRecord;->mPkgList:Lcom/android/server/am/PackageList;
+    iget-object v9, v10, Lcom/android/server/am/ProcessRecord;->mPkgList:Lcom/android/server/am/PackageList;
 
     new-instance v11, Lcom/android/server/am/ContentProviderHelper$$ExternalSyntheticLambda4;
 
-    invoke-direct {v11, v0, v9}, Lcom/android/server/am/ContentProviderHelper$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/am/ContentProviderHelper;Lcom/android/server/am/ProcessRecord;)V
+    invoke-direct {v11, v0, v10}, Lcom/android/server/am/ContentProviderHelper$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/am/ContentProviderHelper;Lcom/android/server/am/ProcessRecord;)V
 
-    invoke-virtual {v10, v11}, Lcom/android/server/am/PackageList;->forEachPackage(Ljava/util/function/Consumer;)V
+    invoke-virtual {v9, v11}, Lcom/android/server/am/PackageList;->forEachPackage(Ljava/util/function/Consumer;)V
 
     goto :goto_6
 
@@ -4962,9 +4872,9 @@
     :goto_6
     add-int/lit8 v3, v3, 0x1
 
-    const/4 v9, 0x2
+    const/4 v9, 0x0
 
-    const/4 v10, 0x0
+    const/4 v10, 0x2
 
     const/4 v11, 0x1
 
@@ -4975,9 +4885,9 @@
 
     const/4 v3, -0x1
 
-    const/4 v9, 0x2
+    const/4 v9, 0x0
 
-    const/4 v10, 0x0
+    const/4 v10, 0x2
 
     const/4 v11, 0x1
 
@@ -5418,9 +5328,9 @@
 
     :cond_15
     :goto_11
-    const/4 v9, 0x0
+    const/16 v21, 0x0
 
-    goto/16 :goto_1a
+    goto/16 :goto_17
 
     :goto_12
     :try_start_11
@@ -5547,7 +5457,6 @@
 
     invoke-virtual {v1, v5, v0}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
 
-    :goto_16
     const/16 v21, 0x0
 
     return v21
@@ -5563,7 +5472,7 @@
 
     const/4 v3, 0x0
 
-    :goto_17
+    :goto_16
     if-ge v3, v2, :cond_17
 
     :try_start_14
@@ -5582,7 +5491,7 @@
     :catch_5
     add-int/lit8 v3, v3, 0x1
 
-    goto :goto_17
+    goto :goto_16
 
     :cond_17
     iget-object v0, v1, Lcom/android/server/am/UserController;->mUserSwitchObservers:Landroid/os/RemoteCallbackList;
@@ -5591,6 +5500,9 @@
 
     goto/16 :goto_11
 
+    :goto_17
+    return v21
+
     :sswitch_c
     iget-object v2, v1, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
 
@@ -5650,7 +5562,9 @@
 
     invoke-virtual {v1, v0, v2, v8}, Lcom/android/server/am/UserController;->scheduleOnUserCompletedEvent(III)V
 
-    goto :goto_16
+    const/16 v21, 0x0
+
+    return v21
 
     :sswitch_d
     iget-object v2, v1, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
@@ -5695,167 +5609,33 @@
 
     iget-object v2, v2, Lcom/android/server/pm/UserManagerService;->mUserJourneyLogger:Lcom/android/server/pm/UserJourneyLogger;
 
-    iget v3, v0, Landroid/os/Message;->arg1:I
-
-    invoke-virtual {v1, v3}, Lcom/android/server/am/UserController;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v3
-
-    const/4 v4, -0x1
-
-    invoke-virtual {v2, v4, v3, v7, v4}, Lcom/android/server/pm/UserJourneyLogger;->logUserJourneyFinishWithError(ILandroid/content/pm/UserInfo;II)Lcom/android/server/pm/UserJourneyLogger$UserJourneySession;
-
-    iget-object v2, v1, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v2, "dar"
-
-    invoke-static {v2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v3
-
-    invoke-static {v3}, Lcom/samsung/android/knox/dar/IDarManagerService$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/dar/IDarManagerService;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v3, :cond_18
-
-    invoke-static {v2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v2
-
-    invoke-static {v2}, Lcom/samsung/android/knox/dar/IDarManagerService$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/dar/IDarManagerService;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/server/knox/dar/DarManagerService;
-
-    iget-object v2, v2, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    goto :goto_18
-
-    :cond_18
-    move-object v2, v6
-
-    :goto_18
-    if-eqz v2, :cond_15
-
-    iget-object v1, v1, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v1, "dar"
-
-    invoke-static {v1}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v2
-
-    invoke-static {v2}, Lcom/samsung/android/knox/dar/IDarManagerService$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/dar/IDarManagerService;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v2, :cond_19
-
-    invoke-static {v1}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/samsung/android/knox/dar/IDarManagerService$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/dar/IDarManagerService;
-
-    move-result-object v1
-
-    check-cast v1, Lcom/android/server/knox/dar/DarManagerService;
-
-    iget-object v6, v1, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    :cond_19
     iget v0, v0, Landroid/os/Message;->arg1:I
 
-    invoke-virtual {v6}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "Starting user "
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    const-string/jumbo v2, "SdpManagerImpl"
-
-    invoke-static {v2, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo v1, "onStartUser"
-
-    invoke-virtual {v6, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkCallerPermissionFor(Ljava/lang/String;)V
-
-    const-string/jumbo v1, "ro.build.PDA"
-
-    const-string/jumbo v3, "Unknown"
-
-    invoke-static {v1, v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    if-eqz v1, :cond_1a
-
-    const/16 v3, 0x5f
-
-    invoke-virtual {v1, v3}, Ljava/lang/String;->indexOf(I)I
-
-    move-result v4
-
-    const/4 v5, -0x1
-
-    if-eq v4, v5, :cond_1a
-
-    invoke-virtual {v1, v3}, Ljava/lang/String;->indexOf(I)I
-
-    move-result v3
-
-    const/4 v9, 0x0
-
-    invoke-virtual {v1, v9, v3}, Ljava/lang/String;->substring(II)Ljava/lang/String;
-
-    move-result-object v1
-
-    goto :goto_19
+    invoke-virtual {v1, v0}, Lcom/android/server/am/UserController;->getUserInfo(I)Landroid/content/pm/UserInfo;
 
-    :cond_1a
-    const/4 v9, 0x0
+    move-result-object v0
 
-    :goto_19
-    const-string/jumbo v3, "Mark the beginning of sdp service! [Version : "
+    const/4 v3, -0x1
 
-    const-string/jumbo v4, "]"
+    invoke-virtual {v2, v3, v0, v7, v3}, Lcom/android/server/pm/UserJourneyLogger;->logUserJourneyFinishWithError(ILandroid/content/pm/UserInfo;II)Lcom/android/server/pm/UserJourneyLogger$UserJourneySession;
 
-    invoke-static {v3, v1, v4, v2}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
+    iget-object v0, v1, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
 
-    const/4 v1, 0x7
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v6, v1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->quickMessage(II)V
+    const/16 v21, 0x0
 
-    :goto_1a
-    return v9
+    return v21
 
     :sswitch_e
-    move v9, v10
+    move/from16 v21, v9
 
     invoke-virtual {v1}, Lcom/android/server/am/UserController;->startProfiles()V
 
-    return v9
+    return v21
 
     :sswitch_f
-    move v9, v10
+    move/from16 v21, v9
 
     iget-object v2, v0, Landroid/os/Message;->obj:Ljava/lang/Object;
 
@@ -5867,10 +5647,10 @@
 
     invoke-virtual {v1, v2, v3, v0}, Lcom/android/server/am/UserController;->timeoutUserSwitch(Lcom/android/server/am/UserState;II)V
 
-    return v9
+    return v21
 
     :sswitch_10
-    move v9, v10
+    move/from16 v21, v9
 
     iget-object v2, v0, Landroid/os/Message;->obj:Ljava/lang/Object;
 
@@ -5882,10 +5662,10 @@
 
     invoke-virtual {v1, v2, v3, v0}, Lcom/android/server/am/UserController;->continueUserSwitch(Lcom/android/server/am/UserState;II)V
 
-    return v9
+    return v21
 
     :sswitch_11
-    move v9, v10
+    move/from16 v21, v9
 
     iget-object v2, v0, Landroid/os/Message;->obj:Ljava/lang/Object;
 
@@ -5897,7 +5677,7 @@
 
     invoke-virtual {v1, v2, v3, v0}, Lcom/android/server/am/UserController;->dispatchUserSwitch(Lcom/android/server/am/UserState;II)V
 
-    return v9
+    return v21
 
     nop
 
diff --git a/smali/com/android/server/devicepolicy/DevicePolicyManagerService$Injector.smali b/smali/com/android/server/devicepolicy/DevicePolicyManagerService$Injector.smali
index fd61e369f..0e0d56a1c 100644
--- a/smali/com/android/server/devicepolicy/DevicePolicyManagerService$Injector.smali
+++ b/smali/com/android/server/devicepolicy/DevicePolicyManagerService$Injector.smali
@@ -167,63 +167,6 @@
     return-void
 .end method
 
-.method public static notifyDeviceOwnerChanged()V
-    .locals 3
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    const-string/jumbo v2, "dar"
-
-    invoke-static {v2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v2, :cond_0
-
-    invoke-virtual {v2}, Lcom/android/server/knox/dar/DarManagerService;->handleDeviceOwnerChanged()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v2
-
-    goto :goto_2
-
-    :catch_0
-    move-exception v2
-
-    goto :goto_1
-
-    :cond_0
-    :goto_0
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :goto_1
-    :try_start_1
-    invoke-virtual {v2}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :goto_2
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw v2
-.end method
-
 .method public static userHandleGetCallingUserId()I
     .locals 1
 
diff --git a/smali/com/android/server/devicepolicy/DevicePolicyManagerService.smali b/smali/com/android/server/devicepolicy/DevicePolicyManagerService.smali
index cc40dd358..6798bf57a 100644
--- a/smali/com/android/server/devicepolicy/DevicePolicyManagerService.smali
+++ b/smali/com/android/server/devicepolicy/DevicePolicyManagerService.smali
@@ -10682,8 +10682,6 @@
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {}, Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;->notifyDeviceOwnerChanged()V
-
     return-void
 
     :goto_4
@@ -63491,8 +63489,6 @@
 
     invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {}, Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;->notifyDeviceOwnerChanged()V
-
     invoke-static {v0}, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->isAdb(Lcom/android/server/devicepolicy/CallerIdentity;)Z
 
     move-result v0
diff --git a/smali/com/android/server/enterprise/EDMProxyService.smali b/smali/com/android/server/enterprise/EDMProxyService.smali
index 69e92a7e0..887d1233a 100644
--- a/smali/com/android/server/enterprise/EDMProxyService.smali
+++ b/smali/com/android/server/enterprise/EDMProxyService.smali
@@ -3065,11 +3065,11 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;
 
     const/4 v1, 0x1
 
-    invoke-direct {v0, p0, p2, v1}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
+    invoke-direct {v0, p0, p2, v1}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
diff --git a/smali/com/android/server/enterprise/container/KnoxMUMContainerPolicy.smali b/smali/com/android/server/enterprise/container/KnoxMUMContainerPolicy.smali
index 9d1590706..4b5baa5ce 100644
--- a/smali/com/android/server/enterprise/container/KnoxMUMContainerPolicy.smali
+++ b/smali/com/android/server/enterprise/container/KnoxMUMContainerPolicy.smali
@@ -67,8 +67,6 @@
 
 .field public mSEAMS:Lcom/android/server/SEAMService;
 
-.field public mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
 .field public final mTypeList:Ljava/util/List;
 
 .field public mUms:Landroid/os/UserManager;
@@ -4882,13 +4880,19 @@
 .end method
 
 .method public final createContainer(Lcom/samsung/android/knox/ContextInfo;Lcom/samsung/android/knox/container/CreationParams;I)I
-    .locals 17
+    .locals 19
 
     move-object/from16 v0, p0
 
     move-object/from16 v1, p1
 
-    const/16 v2, -0x402
+    const-string/jumbo v2, "adminUid : "
+
+    const-string/jumbo v3, "provisioning not allowed: "
+
+    const-string/jumbo v4, "admin : "
+
+    const/16 v5, -0x402
 
     if-nez p2, :cond_0
 
@@ -4898,64 +4902,64 @@
 
     invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    return v2
+    return v5
 
     :cond_0
     invoke-virtual/range {p2 .. p2}, Lcom/samsung/android/knox/container/CreationParams;->getConfigurationName()Ljava/lang/String;
 
-    move-result-object v3
+    move-result-object v6
 
-    const/4 v4, 0x0
+    const/4 v7, 0x0
 
-    invoke-virtual {v0, v4, v3}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->getConfigurationTypeByName(Lcom/samsung/android/knox/ContextInfo;Ljava/lang/String;)Ljava/util/List;
+    invoke-virtual {v0, v7, v6}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->getConfigurationTypeByName(Lcom/samsung/android/knox/ContextInfo;Ljava/lang/String;)Ljava/util/List;
 
-    move-result-object v3
+    move-result-object v6
 
-    if-eqz v3, :cond_1d
+    if-eqz v6, :cond_17
 
-    invoke-interface {v3}, Ljava/util/List;->isEmpty()Z
+    invoke-interface {v6}, Ljava/util/List;->isEmpty()Z
 
-    move-result v5
+    move-result v8
 
-    if-eqz v5, :cond_1
+    if-eqz v8, :cond_1
 
-    goto/16 :goto_d
+    goto/16 :goto_b
 
     :cond_1
-    const/4 v5, 0x0
+    const/4 v8, 0x0
 
-    invoke-interface {v3, v5}, Ljava/util/List;->get(I)Ljava/lang/Object;
+    invoke-interface {v6, v8}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
-    move-result-object v3
+    move-result-object v6
 
-    check-cast v3, Lcom/samsung/android/knox/container/KnoxConfigurationType;
+    check-cast v6, Lcom/samsung/android/knox/container/KnoxConfigurationType;
 
-    instance-of v6, v3, Lcom/samsung/android/knox/container/SecureFolderConfigurationType;
+    instance-of v9, v6, Lcom/samsung/android/knox/container/SecureFolderConfigurationType;
 
-    const/16 v7, -0x3f6
+    const/16 v10, -0x3f6
 
-    if-eqz v6, :cond_2
+    if-eqz v9, :cond_2
 
     invoke-virtual {v0}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->getUserManagerService()Landroid/os/UserManager;
 
-    move-result-object v8
+    move-result-object v11
 
-    const-string/jumbo v9, "no_add_managed_profile"
+    const-string/jumbo v12, "no_add_managed_profile"
 
-    sget-object v10, Landroid/os/UserHandle;->SYSTEM:Landroid/os/UserHandle;
+    sget-object v13, Landroid/os/UserHandle;->SYSTEM:Landroid/os/UserHandle;
 
-    invoke-virtual {v8, v9, v10}, Landroid/os/UserManager;->hasUserRestriction(Ljava/lang/String;Landroid/os/UserHandle;)Z
+    invoke-virtual {v11, v12, v13}, Landroid/os/UserManager;->hasUserRestriction(Ljava/lang/String;Landroid/os/UserHandle;)Z
 
-    move-result v8
+    move-result v11
 
-    if-eqz v8, :cond_3
+    if-eqz v11, :cond_3
 
     :cond_2
-    invoke-static {v5}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
+    invoke-static {v8}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
 
-    move-result v8
+    move-result v11
 
-    if-eqz v8, :cond_3
+    if-eqz v11, :cond_3
 
     const-string v1, "KnoxMUMContainerPolicy"
 
@@ -4975,67 +4979,67 @@
 
     invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z
 
-    return v7
+    return v10
 
     :cond_3
-    sget-object v8, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
+    sget-object v11, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
 
-    new-instance v9, Ljava/util/ArrayList;
+    new-instance v12, Ljava/util/ArrayList;
 
-    const-string/jumbo v10, "com.samsung.android.knox.permission.KNOX_CONTAINER"
+    const-string/jumbo v13, "com.samsung.android.knox.permission.KNOX_CONTAINER"
 
-    filled-new-array {v10}, [Ljava/lang/String;
+    filled-new-array {v13}, [Ljava/lang/String;
 
-    move-result-object v10
+    move-result-object v13
 
-    invoke-static {v10}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
+    invoke-static {v13}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
 
-    move-result-object v10
+    move-result-object v13
 
-    invoke-direct {v9, v10}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
+    invoke-direct {v12, v13}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
 
-    invoke-static {v8, v9}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->enforceCallingCheckPermission(Landroid/content/Context;Ljava/util/List;)V
+    invoke-static {v11, v12}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->enforceCallingCheckPermission(Landroid/content/Context;Ljava/util/List;)V
 
-    iget-object v8, v0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mRIdGenerator:Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$RequestIdGenerator;
+    iget-object v11, v0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mRIdGenerator:Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$RequestIdGenerator;
 
-    iget v9, v8, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$RequestIdGenerator;->fraction:I
+    iget v12, v11, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$RequestIdGenerator;->fraction:I
 
-    const/4 v10, 0x1
+    const/4 v13, 0x1
 
-    add-int/2addr v9, v10
+    add-int/2addr v12, v13
 
-    iput v9, v8, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$RequestIdGenerator;->fraction:I
+    iput v12, v11, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$RequestIdGenerator;->fraction:I
 
-    const/16 v11, 0xa
+    const/16 v14, 0xa
 
-    if-le v9, v11, :cond_4
+    if-le v12, v14, :cond_4
 
-    iput v10, v8, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$RequestIdGenerator;->fraction:I
+    iput v13, v11, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$RequestIdGenerator;->fraction:I
 
     :cond_4
-    iget v9, v8, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$RequestIdGenerator;->fraction:I
+    iget v12, v11, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$RequestIdGenerator;->fraction:I
 
-    iget-object v8, v8, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$RequestIdGenerator;->random:Ljava/util/Random;
+    iget-object v11, v11, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$RequestIdGenerator;->random:Ljava/util/Random;
 
-    const v11, 0x186a0
+    const v14, 0x186a0
 
-    invoke-virtual {v8, v11}, Ljava/util/Random;->nextInt(I)I
+    invoke-virtual {v11, v14}, Ljava/util/Random;->nextInt(I)I
 
-    move-result v8
+    move-result v11
 
-    mul-int/2addr v8, v9
+    mul-int/2addr v11, v12
 
     invoke-virtual/range {p2 .. p2}, Lcom/samsung/android/knox/container/CreationParams;->getAdminPackageName()Ljava/lang/String;
 
-    move-result-object v9
+    move-result-object v12
 
     invoke-virtual/range {p2 .. p2}, Lcom/samsung/android/knox/container/CreationParams;->getConfigurationName()Ljava/lang/String;
 
-    move-result-object v11
+    move-result-object v14
 
     invoke-virtual/range {p2 .. p2}, Lcom/samsung/android/knox/container/CreationParams;->getPasswordResetToken()Ljava/lang/String;
 
-    move-result-object v12
+    move-result-object v15
 
     if-eqz v1, :cond_5
 
@@ -5043,28 +5047,33 @@
 
     if-lez v1, :cond_5
 
-    goto :goto_0
+    :goto_0
+    move/from16 p3, v5
+
+    goto :goto_1
 
     :cond_5
     invoke-static {}, Landroid/os/Binder;->getCallingUid()I
 
     move-result v1
 
-    :goto_0
+    goto :goto_0
+
+    :goto_1
     invoke-static {}, Landroid/os/Binder;->getCallingPid()I
 
-    move-result v13
+    move-result v5
 
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v14
+    move-result-wide v16
 
     :try_start_0
     invoke-static {v1}, Landroid/os/UserHandle;->getUserId(I)I
 
-    move-result v16
+    move-result v18
 
-    if-eqz v16, :cond_6
+    if-eqz v18, :cond_6
 
     const-string v0, "KnoxMUMContainerPolicy"
 
@@ -5074,178 +5083,87 @@
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return v7
+    return v10
 
     :catchall_0
     move-exception v0
 
-    goto/16 :goto_c
+    goto/16 :goto_a
 
     :cond_6
     :try_start_1
-    invoke-static {v12}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result v7
-
-    if-nez v7, :cond_d
-
-    if-eqz v12, :cond_c
-
-    move/from16 p3, v2
+    invoke-static {v15}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
 
-    move v7, v5
-
-    :goto_1
-    invoke-virtual {v12}, Ljava/lang/String;->length()I
-
-    move-result v2
-
-    if-ge v7, v2, :cond_a
-
-    invoke-virtual {v12, v7}, Ljava/lang/String;->charAt(I)C
-
-    move-result v2
-
-    const/16 v4, 0x41
-
-    if-lt v2, v4, :cond_7
-
-    const/16 v4, 0x5a
-
-    if-gt v2, v4, :cond_7
-
-    goto :goto_2
-
-    :cond_7
-    const/16 v4, 0x61
-
-    if-lt v2, v4, :cond_8
-
-    const/16 v4, 0x7a
-
-    if-gt v2, v4, :cond_8
-
-    goto :goto_2
-
-    :cond_8
-    const/16 v4, 0x30
-
-    if-lt v2, v4, :cond_9
-
-    const/16 v4, 0x39
-
-    :cond_9
-    :goto_2
-    add-int/lit8 v7, v7, 0x1
-
-    const/4 v4, 0x0
-
-    goto :goto_1
-
-    :cond_a
-    invoke-virtual {v12}, Ljava/lang/String;->length()I
-
-    move-result v2
-
-    const-string v4, "KnoxMUMContainerPolicy"
-
-    const/16 v7, 0x80
-
-    if-gt v2, v7, :cond_b
-
-    invoke-virtual {v12}, Ljava/lang/String;->length()I
-
-    move-result v2
-
-    const/16 v7, 0x20
-
-    if-lt v2, v7, :cond_b
-
-    const-string v2, " inside validateResetPwdKey password is validated"
-
-    invoke-static {v4, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_3
-
-    :cond_b
-    const-string v0, " inside validateResetPwdKey password is not per requirement "
-
-    invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    move-result v10
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :cond_c
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    if-nez v10, :cond_7
 
-    const/16 v0, -0x401
+    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return v0
+    const/16 v0, -0x400
 
-    :cond_d
-    move/from16 p3, v2
+    return v0
 
-    :goto_3
-    if-eqz v9, :cond_f
+    :cond_7
+    if-eqz v12, :cond_9
 
     :try_start_2
-    invoke-virtual {v9}, Ljava/lang/String;->isEmpty()Z
+    invoke-virtual {v12}, Ljava/lang/String;->isEmpty()Z
 
-    move-result v2
+    move-result v10
     :try_end_2
     .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    if-eqz v2, :cond_e
+    if-eqz v10, :cond_8
 
-    goto :goto_4
+    goto :goto_2
 
-    :cond_e
+    :cond_8
     :try_start_3
-    const-string v2, "KnoxMUMContainerPolicy"
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+    const-string v5, "KnoxMUMContainerPolicy"
 
-    const-string/jumbo v7, "admin : "
+    new-instance v10, Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-direct {v10, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v4, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string v7, ", callingUid - "
+    const-string v4, ", callingUid - "
 
-    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object v4
 
-    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    sget-object v2, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
+    sget-object v4, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v2}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
 
-    move-result-object v2
+    move-result-object v4
 
     invoke-static {v1}, Landroid/os/UserHandle;->getUserId(I)I
 
     move-result v1
 
-    invoke-virtual {v2, v9, v1}, Landroid/content/pm/PackageManager;->getPackageUidAsUser(Ljava/lang/String;I)I
+    invoke-virtual {v4, v12, v1}, Landroid/content/pm/PackageManager;->getPackageUidAsUser(Ljava/lang/String;I)I
 
     move-result v1
     :try_end_3
     .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_3 .. :try_end_3} :catch_0
     .catchall {:try_start_3 .. :try_end_3} :catchall_0
 
-    move v2, v5
+    move v4, v8
 
-    goto :goto_5
+    goto :goto_3
 
     :catch_0
     move-exception v0
@@ -5253,75 +5171,71 @@
     :try_start_4
     invoke-virtual {v0}, Landroid/content/pm/PackageManager$NameNotFoundException;->printStackTrace()V
 
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V
     :try_end_4
     .catchall {:try_start_4 .. :try_end_4} :catchall_0
 
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return p3
 
-    :cond_f
-    :goto_4
+    :cond_9
+    :goto_2
     :try_start_5
-    iget-object v2, v0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mActivityManager:Landroid/app/ActivityManager;
+    iget-object v4, v0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mActivityManager:Landroid/app/ActivityManager;
 
-    if-nez v2, :cond_10
+    if-nez v4, :cond_a
 
-    sget-object v2, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
+    sget-object v4, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
 
-    const-string/jumbo v4, "activity"
+    const-string/jumbo v10, "activity"
 
-    invoke-virtual {v2, v4}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
+    invoke-virtual {v4, v10}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
 
-    move-result-object v2
+    move-result-object v4
 
-    check-cast v2, Landroid/app/ActivityManager;
+    check-cast v4, Landroid/app/ActivityManager;
 
-    iput-object v2, v0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mActivityManager:Landroid/app/ActivityManager;
+    iput-object v4, v0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mActivityManager:Landroid/app/ActivityManager;
 
-    :cond_10
-    iget-object v2, v0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mActivityManager:Landroid/app/ActivityManager;
+    :cond_a
+    iget-object v4, v0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mActivityManager:Landroid/app/ActivityManager;
 
-    if-eqz v2, :cond_11
+    if-eqz v4, :cond_b
 
-    invoke-virtual {v2, v13}, Landroid/app/ActivityManager;->getPackageFromAppProcesses(I)Ljava/lang/String;
+    invoke-virtual {v4, v5}, Landroid/app/ActivityManager;->getPackageFromAppProcesses(I)Ljava/lang/String;
 
-    move-result-object v9
+    move-result-object v12
 
-    :cond_11
-    move v2, v10
+    :cond_b
+    move v4, v13
 
-    :goto_5
-    instance-of v4, v3, Lcom/samsung/android/knox/container/SecureFolderConfigurationType;
+    :goto_3
+    instance-of v5, v6, Lcom/samsung/android/knox/container/SecureFolderConfigurationType;
 
-    if-eqz v4, :cond_12
+    if-eqz v5, :cond_c
 
-    const v4, 0x10020060
+    const v5, 0x10020060
 
-    goto :goto_6
+    goto :goto_4
 
-    :cond_12
-    const v4, 0x10000060
+    :cond_c
+    const v5, 0x10000060
 
-    :goto_6
-    invoke-virtual {v0, v4, v11, v5}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->checkProvisioningPreCondition(ILjava/lang/String;Z)I
+    :goto_4
+    invoke-virtual {v0, v5, v14, v8}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->checkProvisioningPreCondition(ILjava/lang/String;Z)I
 
-    move-result v4
+    move-result v5
 
-    if-eqz v4, :cond_13
+    if-eqz v5, :cond_d
 
     const-string v0, "KnoxMUMContainerPolicy"
 
     new-instance v1, Ljava/lang/StringBuilder;
 
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v2, "provisioning not allowed: "
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-direct {v1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
@@ -5331,71 +5245,67 @@
     :try_end_5
     .catchall {:try_start_5 .. :try_end_5} :catchall_0
 
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return v4
+    return v5
 
-    :cond_13
+    :cond_d
     :try_start_6
-    instance-of v3, v3, Lcom/samsung/android/knox/container/ContainerModeConfigurationType;
+    instance-of v3, v6, Lcom/samsung/android/knox/container/ContainerModeConfigurationType;
 
-    if-eqz v3, :cond_15
+    if-eqz v3, :cond_f
 
-    if-nez v2, :cond_14
+    if-nez v4, :cond_e
 
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V
     :try_end_6
     .catchall {:try_start_6 .. :try_end_6} :catchall_0
 
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     const/16 v0, -0x3ff
 
     return v0
 
-    :cond_14
+    :cond_e
     :try_start_7
     invoke-virtual {v0}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->isContainerOnlyModeAllowed()Z
 
     move-result v3
 
-    if-nez v3, :cond_15
+    if-nez v3, :cond_f
 
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V
     :try_end_7
     .catchall {:try_start_7 .. :try_end_7} :catchall_0
 
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     const/16 v0, -0x3fd
 
     return v0
 
-    :cond_15
+    :cond_f
     :try_start_8
     const-string v3, "KnoxMUMContainerPolicy"
 
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v7, "adminUid : "
+    new-instance v5, Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-direct {v5, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v5, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v2
 
-    invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
     :try_end_8
     .catchall {:try_start_8 .. :try_end_8} :catchall_0
 
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    if-eqz v6, :cond_16
+    if-eqz v9, :cond_10
 
     const-string v2, "KnoxMUMContainerPolicy"
 
@@ -5409,19 +5319,19 @@
 
     const-string/jumbo v3, "type"
 
-    invoke-virtual {v2, v3, v11}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-virtual {v2, v3, v14}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
 
     const-string/jumbo v3, "requestId"
 
-    invoke-virtual {v2, v3, v8}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
+    invoke-virtual {v2, v3, v11}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
 
     const-string/jumbo v3, "isCLType"
 
-    invoke-virtual {v2, v3, v5}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
+    invoke-virtual {v2, v3, v8}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
 
     const-string/jumbo v3, "pwdRstToken"
 
-    invoke-virtual {v2, v3, v12}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-virtual {v2, v3, v15}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
 
     const-string/jumbo v3, "creatorUid"
 
@@ -5429,11 +5339,11 @@
 
     const-string/jumbo v1, "state"
 
-    invoke-virtual {v2, v1, v10}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
+    invoke-virtual {v2, v1, v13}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
 
     const-string/jumbo v1, "adminPackageName"
 
-    invoke-virtual {v2, v1, v9}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-virtual {v2, v1, v12}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
 
     new-instance v1, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$ProvisioningState;
 
@@ -5474,7 +5384,7 @@
 
     invoke-virtual {v1, v0, v2}, Landroid/content/Context;->startServiceAsUser(Landroid/content/Intent;Landroid/os/UserHandle;)Landroid/content/ComponentName;
 
-    return v8
+    return v11
 
     :catchall_1
     move-exception v0
@@ -5486,14 +5396,14 @@
 
     throw v0
 
-    :cond_16
-    new-instance v3, Landroid/content/Intent;
+    :cond_10
+    new-instance v2, Landroid/content/Intent;
 
-    const-string/jumbo v4, "android.app.action.PROVISION_MANAGED_PROFILE"
+    const-string/jumbo v3, "android.app.action.PROVISION_MANAGED_PROFILE"
 
-    invoke-direct {v3, v4}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V
+    invoke-direct {v2, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V
 
-    if-eqz v2, :cond_18
+    if-eqz v4, :cond_12
 
     invoke-virtual {v0}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->getDevicePolicyService()Landroid/app/admin/DevicePolicyManager;
 
@@ -5503,90 +5413,90 @@
 
     move-result-object v0
 
-    if-eqz v0, :cond_18
+    if-eqz v0, :cond_12
 
     invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;
 
     move-result-object v0
 
-    :cond_17
+    :cond_11
     invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
 
-    move-result v4
+    move-result v3
 
-    if-eqz v4, :cond_18
+    if-eqz v3, :cond_12
 
     invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
-    move-result-object v4
+    move-result-object v3
 
-    check-cast v4, Landroid/content/ComponentName;
+    check-cast v3, Landroid/content/ComponentName;
 
-    invoke-virtual {v4}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
+    invoke-virtual {v3}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v5
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    new-instance v6, Ljava/lang/StringBuilder;
 
-    const-string v10, "Checking : "
+    const-string v9, "Checking : "
 
-    invoke-direct {v7, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v6, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v7
+    move-result-object v6
 
-    const-string v10, "KnoxMUMContainerPolicy"
+    const-string v9, "KnoxMUMContainerPolicy"
 
-    invoke-static {v10, v7}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v9, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {v6, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v5, v12}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v6
+    move-result v5
 
-    if-eqz v6, :cond_17
+    if-eqz v5, :cond_11
 
-    goto :goto_7
+    goto :goto_5
 
-    :cond_18
-    const/4 v4, 0x0
+    :cond_12
+    move-object v3, v7
 
-    :goto_7
-    if-eqz v4, :cond_19
+    :goto_5
+    if-eqz v3, :cond_13
 
     const-string/jumbo v0, "android.app.extra.PROVISIONING_DEVICE_ADMIN_COMPONENT_NAME"
 
-    invoke-virtual {v3, v0, v4}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;
+    invoke-virtual {v2, v0, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;
 
-    goto :goto_8
+    goto :goto_6
 
-    :cond_19
+    :cond_13
     const-string/jumbo v0, "android.app.extra.PROVISIONING_DEVICE_ADMIN_PACKAGE_NAME"
 
-    invoke-virtual {v3, v0, v9}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
+    invoke-virtual {v2, v0, v12}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
 
-    :goto_8
+    :goto_6
     const-string/jumbo v0, "com.samsung.knox.container.configType"
 
-    invoke-virtual {v3, v0, v11}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
+    invoke-virtual {v2, v0, v14}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
 
     const-string/jumbo v0, "com.samsung.knox.container.requestId"
 
-    invoke-virtual {v3, v0, v8}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
+    invoke-virtual {v2, v0, v11}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
 
     const-string/jumbo v0, "com.samsung.knox.container.isCLType"
 
-    invoke-virtual {v3, v0, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
+    invoke-virtual {v2, v0, v4}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
 
     const-string/jumbo v0, "com.samsung.knox.container.pwdRstToken"
 
-    invoke-virtual {v3, v0, v12}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
+    invoke-virtual {v2, v0, v15}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
 
     const-string/jumbo v0, "com.samsung.knox.container.adminUid"
 
-    invoke-virtual {v3, v0, v1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
+    invoke-virtual {v2, v0, v1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
 
     :try_start_b
     sget-object v0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
@@ -5595,28 +5505,28 @@
 
     move-result-object v0
 
-    invoke-virtual {v0, v9, v5}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;
+    invoke-virtual {v0, v12, v8}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;
 
-    move-result-object v4
+    move-result-object v7
     :try_end_b
     .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_b .. :try_end_b} :catch_1
 
-    goto :goto_9
+    goto :goto_7
 
     :catch_1
     const-string v0, "KnoxMUMContainerPolicy"
 
     new-instance v1, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v2, "Package \'"
+    const-string/jumbo v3, "Package \'"
 
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v1, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string v2, "\' is not found"
+    const-string v3, "\' is not found"
 
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
@@ -5624,24 +5534,22 @@
 
     invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/4 v4, 0x0
-
-    :goto_9
-    if-eqz v4, :cond_1a
+    :goto_7
+    if-eqz v7, :cond_14
 
-    iget v0, v4, Landroid/content/pm/ApplicationInfo;->icon:I
+    iget v0, v7, Landroid/content/pm/ApplicationInfo;->icon:I
 
-    if-eqz v0, :cond_1a
+    if-eqz v0, :cond_14
 
     const-string/jumbo v0, "android.resource://"
 
     const-string v1, "/"
 
-    invoke-static {v0, v9, v1}, Lcom/android/internal/util/jobs/DumpUtils$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-static {v0, v12, v1}, Lcom/android/internal/util/jobs/DumpUtils$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     move-result-object v0
 
-    iget v1, v4, Landroid/content/pm/ApplicationInfo;->icon:I
+    iget v1, v7, Landroid/content/pm/ApplicationInfo;->icon:I
 
     invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
@@ -5655,9 +5563,9 @@
 
     const-string/jumbo v1, "android.app.extra.PROVISIONING_LOGO_URI"
 
-    invoke-virtual {v3, v1, v0}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;
+    invoke-virtual {v2, v1, v0}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;
 
-    :cond_1a
+    :cond_14
     const-string/jumbo v0, "android.app.extra.PROVISIONING_MAIN_COLOR"
 
     const-string v1, "#3D6DCC"
@@ -5666,11 +5574,11 @@
 
     move-result v1
 
-    invoke-virtual {v3, v0, v1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
+    invoke-virtual {v2, v0, v1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
 
     const/high16 v0, 0x34020000
 
-    invoke-virtual {v3, v0}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;
+    invoke-virtual {v2, v0}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;
 
     sget-object v0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
 
@@ -5678,11 +5586,11 @@
 
     move-result-object v0
 
-    invoke-virtual {v3, v0}, Landroid/content/Intent;->resolveActivity(Landroid/content/pm/PackageManager;)Landroid/content/ComponentName;
+    invoke-virtual {v2, v0}, Landroid/content/Intent;->resolveActivity(Landroid/content/pm/PackageManager;)Landroid/content/ComponentName;
 
     move-result-object v0
 
-    if-eqz v0, :cond_1c
+    if-eqz v0, :cond_16
 
     sget-object v0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
 
@@ -5690,36 +5598,36 @@
 
     invoke-static {}, Landroid/os/UserHandle;->myUserId()I
 
-    move-result v2
+    move-result v3
 
-    invoke-direct {v1, v2}, Landroid/os/UserHandle;-><init>(I)V
+    invoke-direct {v1, v3}, Landroid/os/UserHandle;-><init>(I)V
 
-    sget-object v2, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
+    sget-object v3, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
 
-    if-eqz v2, :cond_1b
+    if-eqz v3, :cond_15
 
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v4
+    move-result-wide v3
 
     :try_start_c
-    invoke-virtual {v0, v3, v1}, Landroid/content/Context;->startActivityAsUser(Landroid/content/Intent;Landroid/os/UserHandle;)V
+    invoke-virtual {v0, v2, v1}, Landroid/content/Context;->startActivityAsUser(Landroid/content/Intent;Landroid/os/UserHandle;)V
     :try_end_c
     .catchall {:try_start_c .. :try_end_c} :catchall_2
 
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    goto :goto_a
+    goto :goto_8
 
     :catchall_2
     move-exception v0
 
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw v0
 
-    :cond_1b
-    :goto_a
+    :cond_15
+    :goto_8
     const-string v0, "KnoxMUMContainerPolicy"
 
     new-instance v1, Ljava/lang/StringBuilder;
@@ -5738,7 +5646,7 @@
 
     invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v1, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
@@ -5746,25 +5654,25 @@
 
     invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_b
+    goto :goto_9
 
-    :cond_1c
+    :cond_16
     const-string v0, "KnoxMUMContainerPolicy"
 
     const-string v1, "Device provisioning is not enabled"
 
     invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_b
-    return v8
+    :goto_9
+    return v11
 
-    :goto_c
-    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :goto_a
+    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw v0
 
-    :cond_1d
-    :goto_d
+    :cond_17
+    :goto_b
     const-string v0, "KnoxMUMContainerPolicy"
 
     const-string v1, "Invalid Knox Configuration Type!"
@@ -8136,96 +8044,94 @@
 .end method
 
 .method public final forceResetPassword(Lcom/samsung/android/knox/ContextInfo;Ljava/lang/String;I)I
-    .locals 12
-
-    const-string/jumbo v0, "Reset password result: "
+    .locals 6
 
-    const/4 v1, -0x2
+    const/4 p2, -0x2
 
     if-nez p1, :cond_0
 
-    goto/16 :goto_7
+    goto/16 :goto_0
 
     :cond_0
-    new-instance v2, Ljava/lang/StringBuilder;
+    new-instance p3, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v3, "forceResetPassword: containerId: "
+    const-string/jumbo v0, "forceResetPassword: containerId: "
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {p3, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget v3, p1, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
+    iget v0, p1, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
 
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {p3, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {p3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object p3
 
-    const-string v3, "KnoxMUMContainerPolicy"
+    const-string v0, "KnoxMUMContainerPolicy"
 
-    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, p3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    new-instance v2, Ljava/util/ArrayList;
+    new-instance p3, Ljava/util/ArrayList;
 
-    const-string/jumbo v4, "com.samsung.android.knox.permission.KNOX_CONTAINER"
+    const-string/jumbo v1, "com.samsung.android.knox.permission.KNOX_CONTAINER"
 
-    filled-new-array {v4}, [Ljava/lang/String;
+    filled-new-array {v1}, [Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v1
 
-    invoke-static {v4}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
+    invoke-static {v1}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
 
-    move-result-object v4
+    move-result-object v1
 
-    invoke-direct {v2, v4}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
+    invoke-direct {p3, v1}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
 
-    invoke-virtual {p0, p1, v2}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->enforceContainerOwnershipPermission(Lcom/samsung/android/knox/ContextInfo;Ljava/util/List;)Lcom/samsung/android/knox/ContextInfo;
+    invoke-virtual {p0, p1, p3}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->enforceContainerOwnershipPermission(Lcom/samsung/android/knox/ContextInfo;Ljava/util/List;)Lcom/samsung/android/knox/ContextInfo;
 
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v4
+    move-result-wide v1
 
-    iget v2, p1, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
+    iget p3, p1, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
 
-    new-instance v6, Lcom/android/internal/widget/LockPatternUtils;
+    new-instance v3, Lcom/android/internal/widget/LockPatternUtils;
 
-    sget-object v7, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
+    sget-object v4, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mContext:Landroid/content/Context;
 
-    invoke-direct {v6, v7}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
+    invoke-direct {v3, v4}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
 
-    invoke-virtual {v6, v2}, Lcom/android/internal/widget/LockPatternUtils;->getActivePasswordQuality(I)I
+    invoke-virtual {v3, p3}, Lcom/android/internal/widget/LockPatternUtils;->getActivePasswordQuality(I)I
 
-    move-result v6
+    move-result v3
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v8, "UCS enabled for user = "
+    const-string/jumbo v5, "UCS enabled for user = "
 
-    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v4, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v7
+    move-result-object v4
 
-    invoke-static {v3, v7}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v8, "current quality = "
+    const-string/jumbo v5, "current quality = "
 
-    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v4, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v8, ", SMART CARD Quality = 458752"
+    const-string v5, ", SMART CARD Quality = 458752"
 
-    invoke-static {v7, v8, v3}, Lcom/android/server/accessibility/FlashNotificationsController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v4, v5, v0}, Lcom/android/server/accessibility/FlashNotificationsController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
 
-    const/high16 v7, 0x70000
+    const/high16 v4, 0x70000
 
-    if-ne v6, v7, :cond_1
+    if-ne v3, v4, :cond_1
 
     new-instance p0, Ljava/lang/StringBuilder;
 
@@ -8233,408 +8139,75 @@
 
     invoke-direct {p0, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {p0, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {p0, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object p0
 
-    invoke-static {v3, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return v1
+    return p2
 
     :cond_1
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    new-instance v2, Ljava/lang/StringBuilder;
+    new-instance p3, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v3, "Reset Password requested for container "
+    const-string/jumbo v0, "Reset Password requested for container "
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {p3, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget v3, p1, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
+    iget p1, p1, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
 
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {p3, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {p3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object p1
 
-    invoke-static {v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
+    invoke-static {p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    iget-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
+    iget-object p1, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
 
-    const-string/jumbo v3, "lock_settings"
+    if-nez p1, :cond_2
 
-    if-nez v2, :cond_2
+    const-string/jumbo p1, "lock_settings"
 
-    invoke-static {v3}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
+    invoke-static {p1}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
 
-    move-result-object v2
+    move-result-object p1
 
-    invoke-static {v2}, Lcom/android/internal/widget/ILockSettings$Stub;->asInterface(Landroid/os/IBinder;)Lcom/android/internal/widget/ILockSettings;
+    invoke-static {p1}, Lcom/android/internal/widget/ILockSettings$Stub;->asInterface(Landroid/os/IBinder;)Lcom/android/internal/widget/ILockSettings;
 
-    move-result-object v2
+    move-result-object p1
 
-    iput-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
+    iput-object p1, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
 
     :cond_2
-    iget-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
+    iget-object p1, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
 
-    if-eqz v2, :cond_12
-
-    iget-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    const-string/jumbo v4, "dar"
+    if-eqz p1, :cond_3
 
-    if-nez v2, :cond_4
+    iget-object p1, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
 
-    iget-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
+    if-nez p1, :cond_3
 
-    if-nez v2, :cond_3
+    const-string/jumbo p1, "dar"
 
-    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
+    invoke-static {p1}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
 
-    move-result-object v2
+    move-result-object p1
 
-    check-cast v2, Lcom/android/server/knox/dar/DarManagerService;
+    check-cast p1, Lcom/android/server/knox/dar/DarManagerService;
 
-    iput-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
+    iput-object p1, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
 
     :cond_3
-    iget-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v2, :cond_4
-
-    iget-object v2, v2, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iput-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    :cond_4
-    iget-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    if-nez v2, :cond_5
-
-    goto/16 :goto_7
-
-    :cond_5
-    sget-object v5, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    if-nez v2, :cond_7
-
-    iget-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
-
-    if-nez v2, :cond_6
-
-    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/server/knox/dar/DarManagerService;
-
-    iput-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
-
-    :cond_6
-    iget-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v2, :cond_7
-
-    iget-object v2, v2, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iput-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    :cond_7
-    iget-object v2, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget p1, p1, Lcom/samsung/android/knox/ContextInfo;->mContainerId:I
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v6
-
-    const/4 v4, 0x0
-
-    :try_start_0
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
-
-    move-result v8
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-nez v8, :cond_8
-
-    invoke-virtual {v5}, Lcom/android/internal/widget/VerifyCredentialResponse;->destroy()V
-
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return v1
-
-    :cond_8
-    :try_start_1
-    invoke-virtual {v2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->cancelLegacyResetTimeout(I)V
-
-    invoke-virtual {v2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->clearLegacyResetStatus(I)V
-
-    const-string/jumbo v8, "Prepare escrow token"
-
-    invoke-static {v4, v8}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getTokenHandle(I)J
-
-    move-result-wide v8
-
-    if-eqz p2, :cond_9
-
-    invoke-virtual {p2}, Ljava/lang/String;->getBytes()[B
-
-    move-result-object p2
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto/16 :goto_6
-
-    :catch_0
-    move-exception p0
-
-    goto/16 :goto_5
-
-    :cond_9
-    invoke-virtual {v2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getResetToken(I)[B
-
-    move-result-object p2
-
     :goto_0
-    const-string/jumbo v10, "Verify token with token handle"
-
-    invoke-static {v4, v10}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    const-wide/16 v10, 0x0
-
-    cmp-long v10, v8, v10
-
-    const/4 v11, -0x1
-
-    if-eqz v10, :cond_11
-
-    if-nez p2, :cond_a
-
-    goto/16 :goto_4
-
-    :cond_a
-    iget-object v10, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
-
-    if-nez v10, :cond_b
-
-    invoke-static {v3}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v3
-
-    invoke-static {v3}, Lcom/android/internal/widget/ILockSettings$Stub;->asInterface(Landroid/os/IBinder;)Lcom/android/internal/widget/ILockSettings;
-
-    move-result-object v3
-
-    iput-object v3, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
-
-    :cond_b
-    iget-object p0, p0, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
-
-    invoke-interface {p0, p2, v8, v9, p1}, Lcom/android/internal/widget/ILockSettings;->verifyToken([BJI)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p0
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :try_start_2
-    invoke-virtual {p0}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
-
-    move-result v3
-
-    if-nez v3, :cond_c
-
-    const-string/jumbo p1, "Reset password failed (Invalid legacy token)"
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    :goto_1
-    invoke-virtual {p0}, Lcom/android/internal/widget/VerifyCredentialResponse;->destroy()V
-
-    :goto_2
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return v11
-
-    :catchall_1
-    move-exception p1
-
-    move-object v5, p0
-
-    move-object p0, p1
-
-    goto/16 :goto_6
-
-    :catch_1
-    move-exception p1
-
-    move-object v5, p0
-
-    move-object p0, p1
-
-    goto :goto_5
-
-    :cond_c
-    if-ne p0, v5, :cond_d
-
-    goto :goto_1
-
-    :cond_d
-    :try_start_3
-    const-string/jumbo v3, "Reset password start"
-
-    invoke-static {v3}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    invoke-virtual {v2, p1, p3, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->onLegacyResetCredentialRequested(II[B)V
-
-    invoke-static {p2}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    new-instance p2, Landroid/os/Bundle;
-
-    invoke-direct {p2}, Landroid/os/Bundle;-><init>()V
-
-    const-string/jumbo p3, "android.intent.extra.user_handle"
-
-    invoke-virtual {p2, p3, p1}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    const-string/jumbo p3, "knox.container.proxy.COMMAND_RESET_PASSWORD"
-
-    invoke-static {p3, p2}, Lcom/samsung/android/knox/ContainerProxy;->sendCommand(Ljava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
-
-    move-result-object p2
-
-    if-eqz p2, :cond_e
-
-    const-string/jumbo p3, "android.intent.extra.RETURN_RESULT"
-
-    invoke-virtual {p2, p3}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I
-
-    move-result p2
-
-    goto :goto_3
-
-    :cond_e
-    const/16 p2, 0x63
-
-    :goto_3
-    new-instance p3, Ljava/lang/StringBuilder;
-
-    invoke-direct {p3, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p3, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p3
-
-    invoke-static {p3}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    if-nez p2, :cond_10
-
-    iget-boolean p2, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mIsHandlerReady:Z
-
-    if-eqz p2, :cond_f
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p2
-
-    const/16 p3, 0xd
-
-    const-wide/16 v8, 0x0
-
-    invoke-virtual {v2, p3, v8, v9, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->quickMessageDelayed(IJLjava/lang/Object;)V
-
-    const-string/jumbo p2, "Legacy force Reset Password for user "
-
-    const/4 p3, 0x0
-
-    invoke-static {p1, p2, p3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-    :try_end_3
-    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_1
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    :cond_f
-    invoke-virtual {p0}, Lcom/android/internal/widget/VerifyCredentialResponse;->destroy()V
-
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    const/4 p0, 0x0
-
-    return p0
-
-    :cond_10
-    :try_start_4
-    invoke-virtual {v2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->cancelLegacyResetTimeout(I)V
-
-    invoke-virtual {v2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->clearLegacyResetStatus(I)V
-    :try_end_4
-    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_1
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
-
-    invoke-virtual {p0}, Lcom/android/internal/widget/VerifyCredentialResponse;->destroy()V
-
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return v1
-
-    :cond_11
-    :goto_4
-    :try_start_5
-    const-string/jumbo p0, "Reset password failed (Legacy token not found)"
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-    :try_end_5
-    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_0
-    .catchall {:try_start_5 .. :try_end_5} :catchall_0
-
-    invoke-virtual {v5}, Lcom/android/internal/widget/VerifyCredentialResponse;->destroy()V
-
-    goto :goto_2
-
-    :goto_5
-    :try_start_6
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    const-string/jumbo p1, "Unexpected exception while force reset password"
-
-    invoke-static {p0, v4, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_0
-
-    invoke-virtual {v5}, Lcom/android/internal/widget/VerifyCredentialResponse;->destroy()V
-
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    goto :goto_7
-
-    :goto_6
-    invoke-virtual {v5}, Lcom/android/internal/widget/VerifyCredentialResponse;->destroy()V
-
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-
-    :cond_12
-    :goto_7
-    return v1
+    return p2
 .end method
 
 .method public final getAppSeparationConfig()Landroid/os/Bundle;
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1.smali
new file mode 100644
index 000000000..6ab63c9c3
--- /dev/null
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1.smali
@@ -0,0 +1,66 @@
+.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1;
+.super Ljava/lang/Object;
+.source "SourceFile"
+
+# interfaces
+.implements Lcom/android/internal/util/FunctionalUtils$ThrowingSupplier;
+
+
+# instance fields
+.field public final synthetic f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+.field public final synthetic f$1:I
+
+.field public final synthetic f$2:Landroid/content/ComponentName;
+
+.field public final synthetic f$3:[B
+
+
+# direct methods
+.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;[B)V
+    .locals 0
+
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+
+    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1;->f$1:I
+
+    iput-object p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1;->f$2:Landroid/content/ComponentName;
+
+    iput-object p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1;->f$3:[B
+
+    return-void
+.end method
+
+
+# virtual methods
+.method public final getOrThrow()Ljava/lang/Object;
+    .locals 3
+
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1;->f$1:I
+
+    iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1;->f$2:Landroid/content/ComponentName;
+
+    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1;->f$3:[B
+
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    invoke-static {v1}, Landroid/os/UserHandle;->getUserId(I)I
+
+    move-result v1
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+
+    invoke-virtual {v0, v2, p0, v1}, Landroid/app/admin/DevicePolicyManagerInternal;->setResetPasswordTokenMDM(Landroid/content/ComponentName;[BI)Z
+
+    move-result p0
+
+    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+
+    move-result-object p0
+
+    return-object p0
+.end method
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11.smali
similarity index 82%
rename from smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12.smali
rename to smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11.smali
index db40114ac..1267c5e51 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11.smali
@@ -1,4 +1,4 @@
-.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12;
+.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11;
 .super Ljava/lang/Object;
 .source "SourceFile"
 
@@ -22,13 +22,13 @@
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12;->f$1:I
+    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11;->f$1:I
 
-    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12;->f$2:I
+    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11;->f$2:I
 
-    iput-object p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12;->f$3:Landroid/os/Bundle;
+    iput-object p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11;->f$3:Landroid/os/Bundle;
 
     return-void
 .end method
@@ -38,13 +38,13 @@
 .method public final getOrThrow()Ljava/lang/Object;
     .locals 5
 
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12;->f$1:I
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11;->f$1:I
 
-    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12;->f$2:I
+    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11;->f$2:I
 
-    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12;->f$3:Landroid/os/Bundle;
+    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11;->f$3:Landroid/os/Bundle;
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14.smali
similarity index 90%
rename from smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15.smali
rename to smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14.smali
index 54ebb66a7..49786b8dd 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14.smali
@@ -1,4 +1,4 @@
-.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;
+.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;
 .super Ljava/lang/Object;
 .source "SourceFile"
 
@@ -18,11 +18,11 @@
 .method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
     .locals 0
 
-    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;->$r8$classId:I
+    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;->$r8$classId:I
 
-    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;->f$1:I
+    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;->f$1:I
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
@@ -34,13 +34,13 @@
 .method public final runOrThrow()V
     .locals 9
 
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;->$r8$classId:I
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;->$r8$classId:I
 
     packed-switch v0, :pswitch_data_0
 
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;->f$1:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;->f$1:I
 
     iget-object v1, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
@@ -83,11 +83,11 @@
 
     iget-object v6, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v7, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;
+    new-instance v7, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
 
     const/4 v8, 0x1
 
-    invoke-direct {v7, v0, v4, v5, v8}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
+    invoke-direct {v7, v0, v4, v5, v8}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
 
     invoke-virtual {v6}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -102,9 +102,9 @@
     return-void
 
     :pswitch_0
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;->f$1:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;->f$1:I
 
     iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17.smali
similarity index 79%
rename from smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18.smali
rename to smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17.smali
index edf8d5d40..ad6903956 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17.smali
@@ -1,4 +1,4 @@
-.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18;
+.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17;
 .super Ljava/lang/Object;
 .source "SourceFile"
 
@@ -22,13 +22,13 @@
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18;->f$1:I
+    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17;->f$1:I
 
-    iput-boolean p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18;->f$2:Z
+    iput-boolean p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17;->f$2:Z
 
-    iput-boolean p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18;->f$3:Z
+    iput-boolean p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17;->f$3:Z
 
     return-void
 .end method
@@ -38,13 +38,13 @@
 .method public final runOrThrow()V
     .locals 3
 
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18;->f$1:I
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17;->f$1:I
 
-    iget-boolean v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18;->f$2:Z
+    iget-boolean v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17;->f$2:Z
 
-    iget-boolean p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18;->f$3:Z
+    iget-boolean p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17;->f$3:Z
 
     iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2.smali
index 6ef0d49e3..f9d82230f 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2.smali
@@ -7,28 +7,24 @@
 
 
 # instance fields
+.field public final synthetic $r8$classId:I
+
 .field public final synthetic f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
 .field public final synthetic f$1:I
 
-.field public final synthetic f$2:Landroid/content/ComponentName;
-
-.field public final synthetic f$3:[B
-
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;[B)V
+.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
     .locals 0
 
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->$r8$classId:I
 
     iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
     iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$1:I
 
-    iput-object p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$2:Landroid/content/ComponentName;
-
-    iput-object p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$3:[B
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
     return-void
 .end method
@@ -38,23 +34,50 @@
 .method public final getOrThrow()Ljava/lang/Object;
     .locals 3
 
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->$r8$classId:I
+
+    packed-switch v0, :pswitch_data_0
+
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$1:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$1:I
 
-    iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$2:Landroid/content/ComponentName;
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mService:Landroid/app/admin/IDevicePolicyManager;
 
-    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$3:[B
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
 
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    move-result p0
+
+    const/4 v1, 0x0
+
+    const/4 v2, 0x0
+
+    invoke-interface {v0, v2, p0, v1}, Landroid/app/admin/IDevicePolicyManager;->getCurrentFailedPasswordAttempts(Ljava/lang/String;IZ)I
+
+    move-result p0
+
+    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+
+    move-result-object p0
+
+    return-object p0
+
+    :pswitch_0
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$1:I
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mService:Landroid/app/admin/IDevicePolicyManager;
+
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
 
-    invoke-static {v1}, Landroid/os/UserHandle;->getUserId(I)I
+    move-result p0
 
-    move-result v1
+    const/4 v1, 0x0
 
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+    const/4 v2, 0x0
 
-    invoke-virtual {v0, v2, p0, v1}, Landroid/app/admin/DevicePolicyManagerInternal;->setResetPasswordTokenMDM(Landroid/content/ComponentName;[BI)Z
+    invoke-interface {v0, v2, p0, v1}, Landroid/app/admin/IDevicePolicyManager;->isActivePasswordSufficient(Ljava/lang/String;IZ)Z
 
     move-result p0
 
@@ -63,4 +86,139 @@
     move-result-object p0
 
     return-object p0
+
+    :pswitch_1
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$1:I
+
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    new-instance v1, Lcom/android/internal/widget/LockPatternUtils;
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
+
+    invoke-direct {v1, v0}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
+
+    invoke-virtual {v1, p0}, Lcom/android/internal/widget/LockPatternUtils;->getActivePasswordQuality(I)I
+
+    move-result v0
+
+    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+
+    move-result-object v0
+
+    new-instance v1, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v2, "UCS enabled for user = "
+
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object p0
+
+    const-string/jumbo v1, "PasswordPolicy"
+
+    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    new-instance p0, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v2, "current quality = "
+
+    invoke-direct {p0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+
+    const-string v2, ", SMART CARD Quality = 458752"
+
+    invoke-static {p0, v2, v1}, Lcom/android/server/accessibility/FlashNotificationsController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
+
+    return-object v0
+
+    :pswitch_2
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$1:I
+
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    new-instance v1, Lcom/android/internal/widget/LockPatternUtils;
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
+
+    invoke-direct {v1, v0}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
+
+    invoke-virtual {v1, p0}, Lcom/android/internal/widget/LockPatternUtils;->getActivePasswordQuality(I)I
+
+    move-result v0
+
+    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+
+    move-result-object v0
+
+    new-instance v1, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v2, "UCS enabled for user = "
+
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object p0
+
+    const-string/jumbo v1, "PasswordPolicy"
+
+    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    new-instance p0, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v2, "current quality = "
+
+    invoke-direct {p0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+
+    const-string v2, ", SMART CARD Quality = 458752"
+
+    invoke-static {p0, v2, v1}, Lcom/android/server/accessibility/FlashNotificationsController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
+
+    return-object v0
+
+    :pswitch_3
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;->f$1:I
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mService:Landroid/app/admin/IDevicePolicyManager;
+
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+
+    move-result p0
+
+    const/4 v1, 0x0
+
+    const/4 v2, 0x0
+
+    invoke-interface {v0, v2, p0, v1}, Landroid/app/admin/IDevicePolicyManager;->getCurrentFailedPasswordAttempts(Ljava/lang/String;IZ)I
+
+    move-result p0
+
+    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+
+    move-result-object p0
+
+    return-object p0
+
+    :pswitch_data_0
+    .packed-switch 0x0
+        :pswitch_3
+        :pswitch_2
+        :pswitch_1
+        :pswitch_0
+    .end packed-switch
 .end method
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20.smali
similarity index 82%
rename from smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21.smali
rename to smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20.smali
index 43b7fed8c..c5ffac8d4 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20.smali
@@ -1,4 +1,4 @@
-.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;
+.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;
 .super Ljava/lang/Object;
 .source "SourceFile"
 
@@ -20,13 +20,13 @@
 .method public synthetic constructor <init>(IIII)V
     .locals 0
 
-    iput p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->$r8$classId:I
+    iput p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->$r8$classId:I
 
-    iput p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$0:I
+    iput p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$0:I
 
-    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$1:I
+    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$1:I
 
-    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$2:I
+    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$2:I
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
@@ -38,15 +38,15 @@
 .method public final runOrThrow()V
     .locals 2
 
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->$r8$classId:I
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->$r8$classId:I
 
     packed-switch v0, :pswitch_data_0
 
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$0:I
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$0:I
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$1:I
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$1:I
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$2:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$2:I
 
     invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -67,11 +67,11 @@
     return-void
 
     :pswitch_0
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$0:I
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$0:I
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$1:I
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$1:I
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$2:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$2:I
 
     invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -92,11 +92,11 @@
     return-void
 
     :pswitch_1
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$0:I
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$0:I
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$1:I
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$1:I
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$2:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$2:I
 
     invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -117,11 +117,11 @@
     return-void
 
     :pswitch_2
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$0:I
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$0:I
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$1:I
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$1:I
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$2:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$2:I
 
     invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -142,11 +142,11 @@
     return-void
 
     :pswitch_3
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$0:I
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$0:I
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$1:I
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$1:I
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;->f$2:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;->f$2:I
 
     invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda25.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda24.smali
similarity index 96%
rename from smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda25.smali
rename to smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda24.smali
index 408ef3ff1..505d33ee8 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda25.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda24.smali
@@ -1,4 +1,4 @@
-.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda25;
+.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda24;
 .super Ljava/lang/Object;
 .source "SourceFile"
 
@@ -16,9 +16,9 @@
 .method public synthetic constructor <init>(ILjava/lang/Object;)V
     .locals 0
 
-    iput p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda25;->$r8$classId:I
+    iput p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda24;->$r8$classId:I
 
-    iput-object p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda25;->f$0:Ljava/lang/Object;
+    iput-object p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda24;->f$0:Ljava/lang/Object;
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
@@ -30,9 +30,9 @@
 .method public final getOrThrow()Ljava/lang/Object;
     .locals 11
 
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda25;->$r8$classId:I
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda24;->$r8$classId:I
 
-    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda25;->f$0:Ljava/lang/Object;
+    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda24;->f$0:Ljava/lang/Object;
 
     packed-switch v0, :pswitch_data_0
 
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26.smali
similarity index 77%
rename from smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27.smali
rename to smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26.smali
index e83ab6822..75ad10a93 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26.smali
@@ -1,4 +1,4 @@
-.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;
+.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;
 .super Ljava/lang/Object;
 .source "SourceFile"
 
@@ -24,15 +24,15 @@
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;->f$1:I
+    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;->f$1:I
 
-    iput-object p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;->f$2:Landroid/content/ComponentName;
+    iput-object p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;->f$2:Landroid/content/ComponentName;
 
-    iput-object p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;->f$3:Landroid/content/ComponentName;
+    iput-object p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;->f$3:Landroid/content/ComponentName;
 
-    iput-object p5, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;->f$4:Landroid/os/PersistableBundle;
+    iput-object p5, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;->f$4:Landroid/os/PersistableBundle;
 
     return-void
 .end method
@@ -42,15 +42,15 @@
 .method public final runOrThrow()V
     .locals 4
 
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;->f$1:I
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;->f$1:I
 
-    iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;->f$2:Landroid/content/ComponentName;
+    iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;->f$2:Landroid/content/ComponentName;
 
-    iget-object v3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;->f$3:Landroid/content/ComponentName;
+    iget-object v3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;->f$3:Landroid/content/ComponentName;
 
-    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;->f$4:Landroid/os/PersistableBundle;
+    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;->f$4:Landroid/os/PersistableBundle;
 
     iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
 
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3.smali
index 09c0f1e9f..c07e1882c 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3.smali
@@ -3,27 +3,31 @@
 .source "SourceFile"
 
 # interfaces
-.implements Lcom/android/internal/util/FunctionalUtils$ThrowingSupplier;
+.implements Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;
 
 
 # instance fields
 .field public final synthetic $r8$classId:I
 
-.field public final synthetic f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+.field public final synthetic f$0:I
 
 .field public final synthetic f$1:I
 
+.field public final synthetic f$2:Ljava/lang/String;
+
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
+.method public synthetic constructor <init>(IIILjava/lang/String;)V
     .locals 0
 
     iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->$r8$classId:I
 
-    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iput p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$0:I
 
     iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$1:I
 
+    iput-object p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$2:Ljava/lang/String;
+
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
     return-void
@@ -31,194 +35,58 @@
 
 
 # virtual methods
-.method public final getOrThrow()Ljava/lang/Object;
-    .locals 3
+.method public final runOrThrow()V
+    .locals 2
 
     iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->$r8$classId:I
 
     packed-switch v0, :pswitch_data_0
 
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$1:I
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mService:Landroid/app/admin/IDevicePolicyManager;
-
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
-
-    move-result p0
-
-    const/4 v1, 0x0
-
-    const/4 v2, 0x0
-
-    invoke-interface {v0, v2, p0, v1}, Landroid/app/admin/IDevicePolicyManager;->getCurrentFailedPasswordAttempts(Ljava/lang/String;IZ)I
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_0
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$1:I
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mService:Landroid/app/admin/IDevicePolicyManager;
-
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
-
-    move-result p0
-
-    const/4 v1, 0x0
-
-    const/4 v2, 0x0
-
-    invoke-interface {v0, v2, p0, v1}, Landroid/app/admin/IDevicePolicyManager;->isActivePasswordSufficient(Ljava/lang/String;IZ)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_1
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$1:I
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v1, Lcom/android/internal/widget/LockPatternUtils;
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-direct {v1, v0}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {v1, p0}, Lcom/android/internal/widget/LockPatternUtils;->getActivePasswordQuality(I)I
-
-    move-result v0
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$0:I
 
-    move-result-object v0
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$1:I
 
-    new-instance v1, Ljava/lang/StringBuilder;
+    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$2:Ljava/lang/String;
 
-    const-string/jumbo v2, "UCS enabled for user = "
+    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    move-result-object v1
 
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    filled-new-array {v1, p0}, [Ljava/lang/Object;
 
     move-result-object p0
 
-    const-string/jumbo v1, "PasswordPolicy"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "current quality = "
-
-    invoke-direct {p0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    const-string v2, ", SMART CARD Quality = 458752"
-
-    invoke-static {p0, v2, v1}, Lcom/android/server/accessibility/FlashNotificationsController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
-
-    return-object v0
-
-    :pswitch_2
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    const/16 v1, 0xb0
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$1:I
+    invoke-static {v0, v1, p0}, Landroid/sec/enterprise/auditlog/AuditLog;->logEventAsUser(II[Ljava/lang/Object;)V
 
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v1, Lcom/android/internal/widget/LockPatternUtils;
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-direct {v1, v0}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {v1, p0}, Lcom/android/internal/widget/LockPatternUtils;->getActivePasswordQuality(I)I
-
-    move-result v0
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    return-void
 
-    move-result-object v0
+    :pswitch_0
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$0:I
 
-    new-instance v1, Ljava/lang/StringBuilder;
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$1:I
 
-    const-string/jumbo v2, "UCS enabled for user = "
+    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$2:Ljava/lang/String;
 
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    move-result-object v1
 
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    filled-new-array {v1, p0}, [Ljava/lang/Object;
 
     move-result-object p0
 
-    const-string/jumbo v1, "PasswordPolicy"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    const/16 v1, 0xb3
 
-    new-instance p0, Ljava/lang/StringBuilder;
+    invoke-static {v0, v1, p0}, Landroid/sec/enterprise/auditlog/AuditLog;->logEventAsUser(II[Ljava/lang/Object;)V
 
-    const-string/jumbo v2, "current quality = "
-
-    invoke-direct {p0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    const-string v2, ", SMART CARD Quality = 458752"
-
-    invoke-static {p0, v2, v1}, Lcom/android/server/accessibility/FlashNotificationsController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
-
-    return-object v0
-
-    :pswitch_3
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;->f$1:I
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mService:Landroid/app/admin/IDevicePolicyManager;
-
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
-
-    move-result p0
-
-    const/4 v1, 0x0
-
-    const/4 v2, 0x0
-
-    invoke-interface {v0, v2, p0, v1}, Landroid/app/admin/IDevicePolicyManager;->getCurrentFailedPasswordAttempts(Ljava/lang/String;IZ)I
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
+    return-void
 
-    return-object p0
+    nop
 
     :pswitch_data_0
     .packed-switch 0x0
-        :pswitch_3
-        :pswitch_2
-        :pswitch_1
         :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4.smali
index ce63e1fb1..321056db0 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4.smali
@@ -9,24 +9,24 @@
 # instance fields
 .field public final synthetic $r8$classId:I
 
-.field public final synthetic f$0:I
+.field public final synthetic f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
 .field public final synthetic f$1:I
 
-.field public final synthetic f$2:Ljava/lang/String;
+.field public final synthetic f$2:I
 
 
 # direct methods
-.method public synthetic constructor <init>(IIILjava/lang/String;)V
+.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
     .locals 0
 
-    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->$r8$classId:I
+    iput p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->$r8$classId:I
 
-    iput p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$0:I
+    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
     iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$1:I
 
-    iput-object p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$2:Ljava/lang/String;
+    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$2:I
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
@@ -36,57 +36,367 @@
 
 # virtual methods
 .method public final runOrThrow()V
-    .locals 2
+    .locals 7
 
     iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->$r8$classId:I
 
     packed-switch v0, :pswitch_data_0
 
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$0:I
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
     iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$1:I
 
-    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$2:Ljava/lang/String;
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$2:I
 
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
+
+    invoke-static {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;
+
+    move-result-object v0
+
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    new-instance v2, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v3, "setPasswordLockDelayAsUser() userId = "
+
+    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    const-string v3, ", time = "
+
+    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string/jumbo v3, "SystemUIAdapter"
+
+    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-static {}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->isCalledFromSystem()Z
+
+    move-result v2
+
+    if-nez v2, :cond_0
+
+    goto :goto_1
+
+    :cond_0
+    new-instance v2, Lcom/android/internal/widget/LockPatternUtils;
+
+    sget-object v4, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mContext:Landroid/content/Context;
+
+    invoke-direct {v2, v4}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
+
+    invoke-virtual {v2, v1}, Lcom/android/internal/widget/LockPatternUtils;->isSeparateProfileChallengeEnabled(I)Z
+
+    move-result v2
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v5, "setMultifactorAuthEnabled() setPasswordLockDelayAsUser = "
+
+    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getCurrentUserId()I
+
+    move-result v4
+
+    if-eq v1, v4, :cond_1
+
+    if-eqz v2, :cond_1
+
+    goto :goto_1
+
+    :cond_1
+    :try_start_0
+    iget-object v0, v0, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mCallbacks:Ljava/util/HashMap;
+
+    invoke-virtual {v0}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;
+
+    move-result-object v0
+
+    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
+
+    move-result-object v0
+
+    :cond_2
+    :goto_0
+    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
+
+    move-result v1
+
+    if-eqz v1, :cond_3
+
+    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+
+    move-result-object v1
+
+    check-cast v1, Ljava/util/Map$Entry;
+
+    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
 
     move-result-object v1
 
-    filled-new-array {v1, p0}, [Ljava/lang/Object;
+    check-cast v1, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;
+
+    if-eqz v1, :cond_2
+
+    invoke-interface {v1, p0}, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;->setPasswordLockDelay(I)V
+    :try_end_0
+    .catch Ljava/lang/NullPointerException; {:try_start_0 .. :try_end_0} :catch_1
+    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
+    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_2
+
+    goto :goto_0
+
+    :catch_0
+    move-exception p0
+
+    const-string/jumbo v0, "setPasswordLockDelay() Failed with RemoteException"
+
+    invoke-static {v3, v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    move-result-object p0
+    goto :goto_1
 
-    const/16 v1, 0xb0
+    :catch_1
+    const-string/jumbo p0, "setPasswordLockDelay() failed with NullPointerException."
 
-    invoke-static {v0, v1, p0}, Landroid/sec/enterprise/auditlog/AuditLog;->logEventAsUser(II[Ljava/lang/Object;)V
+    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
+    :catch_2
+    :cond_3
+    :goto_1
     return-void
 
     :pswitch_0
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$0:I
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
     iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$1:I
 
-    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$2:Ljava/lang/String;
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$2:I
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
+
+    invoke-static {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;
+
+    move-result-object v0
+
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    new-instance v2, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v3, "setPwdChangeRequestedAsUser() userId = "
+
+    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    const-string v3, ", flag = "
+
+    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string/jumbo v3, "SystemUIAdapter"
+
+    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-static {}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->isCalledFromSystem()Z
+
+    move-result v2
+
+    if-nez v2, :cond_4
 
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    goto :goto_3
+
+    :cond_4
+    invoke-virtual {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getCurrentUserId()I
+
+    move-result v2
+
+    if-eq v1, v2, :cond_5
+
+    goto :goto_3
+
+    :cond_5
+    :try_start_1
+    iget-object v0, v0, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mCallbacks:Ljava/util/HashMap;
+
+    invoke-virtual {v0}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;
+
+    move-result-object v0
+
+    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
+
+    move-result-object v0
+
+    :cond_6
+    :goto_2
+    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
+
+    move-result v1
+
+    if-eqz v1, :cond_7
+
+    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
     move-result-object v1
 
-    filled-new-array {v1, p0}, [Ljava/lang/Object;
+    check-cast v1, Ljava/util/Map$Entry;
+
+    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
+
+    move-result-object v1
+
+    check-cast v1, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;
+
+    if-eqz v1, :cond_6
+
+    invoke-interface {v1, p0}, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;->setPwdChangeRequested(I)V
+    :try_end_1
+    .catch Ljava/lang/NullPointerException; {:try_start_1 .. :try_end_1} :catch_4
+    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_3
+    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_5
+
+    goto :goto_2
+
+    :catch_3
+    move-exception p0
+
+    const-string/jumbo v0, "setPwdChangeRequested() Failed with RemoteException"
+
+    invoke-static {v3, v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto :goto_3
+
+    :catch_4
+    const-string/jumbo p0, "setPwdChangeRequested() failed with NullPointerException."
+
+    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+
+    :catch_5
+    :cond_7
+    :goto_3
+    return-void
+
+    :pswitch_1
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$1:I
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$2:I
+
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    new-instance v2, Lcom/android/internal/widget/LockPatternUtils;
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
+
+    invoke-direct {v2, v0}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
+
+    const-string/jumbo v0, "PasswordPolicy"
+
+    const-string/jumbo v3, "removeBiometricAuthentication()"
+
+    invoke-static {v0, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    and-int/lit8 v0, v1, 0x1
+
+    const/4 v3, 0x0
+
+    if-eqz v0, :cond_8
+
+    const/4 v0, 0x1
+
+    invoke-virtual {v2, v0, v3, p0}, Lcom/android/internal/widget/LockPatternUtils;->setBiometricState(III)V
+
+    :cond_8
+    and-int/lit8 v0, v1, 0x4
+
+    if-eqz v0, :cond_9
+
+    const/16 v0, 0x100
+
+    invoke-virtual {v2, v0, v3, p0}, Lcom/android/internal/widget/LockPatternUtils;->setBiometricState(III)V
+
+    :cond_9
+    return-void
+
+    :pswitch_2
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$1:I
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;->f$2:I
+
+    iget-object v2, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
+
+    invoke-static {v2}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;
+
+    move-result-object v2
+
+    if-lez v1, :cond_a
+
+    iget-object v3, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mEdmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
+
+    invoke-static {v1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
+
+    move-result-object v4
+
+    const-string/jumbo v5, "PASSWORD"
+
+    const-string/jumbo v6, "passwordAttemptDeviceDisable"
+
+    invoke-virtual {v3, v5, v6, v4}, Lcom/android/server/enterprise/storage/EdmStorageProvider;->getAdminByField(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)I
+
+    move-result v3
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
+
+    invoke-virtual {v0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+
+    move-result-object v0
+
+    invoke-virtual {v0, v3}, Landroid/content/pm/PackageManager;->getNameForUid(I)Ljava/lang/String;
+
+    move-result-object v0
+
+    invoke-virtual {v2, p0, v1, v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->setMaximumFailedPasswordsForDisableAsUser(IILjava/lang/String;)V
 
-    move-result-object p0
+    goto :goto_4
 
-    const/16 v1, 0xb3
+    :cond_a
+    const/4 v0, 0x0
 
-    invoke-static {v0, v1, p0}, Landroid/sec/enterprise/auditlog/AuditLog;->logEventAsUser(II[Ljava/lang/Object;)V
+    invoke-virtual {v2, p0, v1, v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->setMaximumFailedPasswordsForDisableAsUser(IILjava/lang/String;)V
 
+    :goto_4
     return-void
 
     nop
 
     :pswitch_data_0
     .packed-switch 0x0
+        :pswitch_2
+        :pswitch_1
         :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42.smali
similarity index 82%
rename from smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43.smali
rename to smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42.smali
index 6c131daf6..b81e51bcc 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42.smali
@@ -1,4 +1,4 @@
-.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;
+.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;
 .super Ljava/lang/Object;
 .source "SourceFile"
 
@@ -26,17 +26,17 @@
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;->f$1:I
+    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;->f$1:I
 
-    iput-object p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;->f$2:Landroid/content/ComponentName;
+    iput-object p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;->f$2:Landroid/content/ComponentName;
 
-    iput-object p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;->f$3:Ljava/lang/String;
+    iput-object p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;->f$3:Ljava/lang/String;
 
-    iput-object p5, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;->f$4:[B
+    iput-object p5, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;->f$4:[B
 
-    iput p6, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;->f$5:I
+    iput p6, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;->f$5:I
 
     return-void
 .end method
@@ -46,17 +46,17 @@
 .method public final getOrThrow()Ljava/lang/Object;
     .locals 8
 
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;->f$1:I
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;->f$1:I
 
-    iget-object v3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;->f$2:Landroid/content/ComponentName;
+    iget-object v3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;->f$2:Landroid/content/ComponentName;
 
-    iget-object v4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;->f$3:Ljava/lang/String;
+    iget-object v4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;->f$3:Ljava/lang/String;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;->f$4:[B
+    iget-object v5, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;->f$4:[B
 
-    iget v6, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;->f$5:I
+    iget v6, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;->f$5:I
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda47.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda46.smali
similarity index 91%
rename from smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda47.smali
rename to smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda46.smali
index 2de1ff9c1..a67be1ab5 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda47.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda46.smali
@@ -1,4 +1,4 @@
-.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda47;
+.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda46;
 .super Ljava/lang/Object;
 .source "SourceFile"
 
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5.smali
index a00db2253..4172a40b4 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5.smali
@@ -11,22 +11,26 @@
 
 .field public final synthetic f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-.field public final synthetic f$1:I
+.field public final synthetic f$1:Landroid/content/ComponentName;
 
-.field public final synthetic f$2:I
+.field public final synthetic f$2:J
+
+.field public final synthetic f$3:I
 
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
+.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;JII)V
     .locals 0
 
-    iput p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->$r8$classId:I
+    iput p6, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->$r8$classId:I
 
     iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$1:I
+    iput-object p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$1:Landroid/content/ComponentName;
+
+    iput-wide p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$2:J
 
-    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$2:I
+    iput p5, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$3:I
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
@@ -36,7 +40,7 @@
 
 # virtual methods
 .method public final runOrThrow()V
-    .locals 7
+    .locals 4
 
     iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->$r8$classId:I
 
@@ -44,359 +48,45 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$1:I
-
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$2:I
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "setPasswordLockDelayAsUser() userId = "
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v3, ", time = "
-
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    const-string/jumbo v3, "SystemUIAdapter"
-
-    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->isCalledFromSystem()Z
-
-    move-result v2
-
-    if-nez v2, :cond_0
-
-    goto :goto_1
-
-    :cond_0
-    new-instance v2, Lcom/android/internal/widget/LockPatternUtils;
-
-    sget-object v4, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mContext:Landroid/content/Context;
-
-    invoke-direct {v2, v4}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {v2, v1}, Lcom/android/internal/widget/LockPatternUtils;->isSeparateProfileChallengeEnabled(I)Z
-
-    move-result v2
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "setMultifactorAuthEnabled() setPasswordLockDelayAsUser = "
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getCurrentUserId()I
-
-    move-result v4
-
-    if-eq v1, v4, :cond_1
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$1:Landroid/content/ComponentName;
 
-    if-eqz v2, :cond_1
+    iget-wide v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$2:J
 
-    goto :goto_1
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$3:I
 
-    :cond_1
-    :try_start_0
-    iget-object v0, v0, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mCallbacks:Ljava/util/HashMap;
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
 
-    invoke-virtual {v0}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
 
-    move-result-object v0
+    move-result p0
 
-    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
+    invoke-virtual {v0, v1, v2, v3, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordExpirationTimeoutMDM(Landroid/content/ComponentName;JI)V
 
-    move-result-object v0
-
-    :cond_2
-    :goto_0
-    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_3
-
-    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Ljava/util/Map$Entry;
-
-    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;
-
-    if-eqz v1, :cond_2
-
-    invoke-interface {v1, p0}, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;->setPasswordLockDelay(I)V
-    :try_end_0
-    .catch Ljava/lang/NullPointerException; {:try_start_0 .. :try_end_0} :catch_1
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_2
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    const-string/jumbo v0, "setPasswordLockDelay() Failed with RemoteException"
-
-    invoke-static {v3, v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    goto :goto_1
-
-    :catch_1
-    const-string/jumbo p0, "setPasswordLockDelay() failed with NullPointerException."
-
-    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :catch_2
-    :cond_3
-    :goto_1
     return-void
 
     :pswitch_0
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$1:I
-
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$2:I
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "setPwdChangeRequestedAsUser() userId = "
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v3, ", flag = "
-
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    const-string/jumbo v3, "SystemUIAdapter"
-
-    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->isCalledFromSystem()Z
-
-    move-result v2
-
-    if-nez v2, :cond_4
-
-    goto :goto_3
-
-    :cond_4
-    invoke-virtual {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getCurrentUserId()I
-
-    move-result v2
-
-    if-eq v1, v2, :cond_5
-
-    goto :goto_3
-
-    :cond_5
-    :try_start_1
-    iget-object v0, v0, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mCallbacks:Ljava/util/HashMap;
-
-    invoke-virtual {v0}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;
-
-    move-result-object v0
-
-    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
-
-    move-result-object v0
-
-    :cond_6
-    :goto_2
-    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_7
-
-    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Ljava/util/Map$Entry;
-
-    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;
-
-    if-eqz v1, :cond_6
-
-    invoke-interface {v1, p0}, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;->setPwdChangeRequested(I)V
-    :try_end_1
-    .catch Ljava/lang/NullPointerException; {:try_start_1 .. :try_end_1} :catch_4
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_3
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_5
-
-    goto :goto_2
-
-    :catch_3
-    move-exception p0
-
-    const-string/jumbo v0, "setPwdChangeRequested() Failed with RemoteException"
-
-    invoke-static {v3, v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    goto :goto_3
-
-    :catch_4
-    const-string/jumbo p0, "setPwdChangeRequested() failed with NullPointerException."
-
-    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :catch_5
-    :cond_7
-    :goto_3
-    return-void
-
-    :pswitch_1
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$1:I
-
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$2:I
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v2, Lcom/android/internal/widget/LockPatternUtils;
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-direct {v2, v0}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    const-string/jumbo v0, "PasswordPolicy"
-
-    const-string/jumbo v3, "removeBiometricAuthentication()"
-
-    invoke-static {v0, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    and-int/lit8 v0, v1, 0x1
-
-    const/4 v3, 0x0
-
-    if-eqz v0, :cond_8
-
-    const/4 v0, 0x1
-
-    invoke-virtual {v2, v0, v3, p0}, Lcom/android/internal/widget/LockPatternUtils;->setBiometricState(III)V
-
-    :cond_8
-    and-int/lit8 v0, v1, 0x4
-
-    if-eqz v0, :cond_9
-
-    const/16 v0, 0x100
-
-    invoke-virtual {v2, v0, v3, p0}, Lcom/android/internal/widget/LockPatternUtils;->setBiometricState(III)V
-
-    :cond_9
-    return-void
-
-    :pswitch_2
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$1:I
-
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$2:I
-
-    iget-object v2, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-static {v2}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;
-
-    move-result-object v2
-
-    if-lez v1, :cond_a
-
-    iget-object v3, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mEdmStorageProvider:Lcom/android/server/enterprise/storage/EdmStorageProvider;
-
-    invoke-static {v1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v4
-
-    const-string/jumbo v5, "PASSWORD"
-
-    const-string/jumbo v6, "passwordAttemptDeviceDisable"
-
-    invoke-virtual {v3, v5, v6, v4}, Lcom/android/server/enterprise/storage/EdmStorageProvider;->getAdminByField(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)I
-
-    move-result v3
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
-
-    move-result-object v0
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$1:Landroid/content/ComponentName;
 
-    invoke-virtual {v0, v3}, Landroid/content/pm/PackageManager;->getNameForUid(I)Ljava/lang/String;
+    iget-wide v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$2:J
 
-    move-result-object v0
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;->f$3:I
 
-    invoke-virtual {v2, p0, v1, v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->setMaximumFailedPasswordsForDisableAsUser(IILjava/lang/String;)V
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
 
-    goto :goto_4
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
 
-    :cond_a
-    const/4 v0, 0x0
+    move-result p0
 
-    invoke-virtual {v2, p0, v1, v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->setMaximumFailedPasswordsForDisableAsUser(IILjava/lang/String;)V
+    invoke-virtual {v0, v1, v2, v3, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setMaximumTimeToLockMDM(Landroid/content/ComponentName;JI)V
 
-    :goto_4
     return-void
 
     nop
 
     :pswitch_data_0
     .packed-switch 0x0
-        :pswitch_2
-        :pswitch_1
         :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51.smali
new file mode 100644
index 000000000..668b26048
--- /dev/null
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51.smali
@@ -0,0 +1,100 @@
+.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51;
+.super Ljava/lang/Object;
+.source "SourceFile"
+
+# interfaces
+.implements Lcom/android/internal/util/FunctionalUtils$ThrowingSupplier;
+
+
+# instance fields
+.field public final synthetic $r8$classId:I
+
+.field public final synthetic f$0:Landroid/content/Context;
+
+
+# direct methods
+.method public synthetic constructor <init>(Landroid/content/Context;I)V
+    .locals 0
+
+    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51;->$r8$classId:I
+
+    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51;->f$0:Landroid/content/Context;
+
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+
+    return-void
+.end method
+
+
+# virtual methods
+.method public final getOrThrow()Ljava/lang/Object;
+    .locals 2
+
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51;->$r8$classId:I
+
+    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51;->f$0:Landroid/content/Context;
+
+    packed-switch v0, :pswitch_data_0
+
+    invoke-virtual {p0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+
+    move-result-object p0
+
+    const-string/jumbo v0, "android.hardware.biometrics.iris"
+
+    invoke-virtual {p0, v0}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z
+
+    move-result p0
+
+    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+
+    move-result-object p0
+
+    return-object p0
+
+    :pswitch_0
+    invoke-virtual {p0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+
+    move-result-object v0
+
+    const-string/jumbo v1, "android.hardware.fingerprint"
+
+    invoke-virtual {v0, v1}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z
+
+    move-result v0
+
+    if-eqz v0, :cond_0
+
+    const-class v0, Landroid/hardware/fingerprint/FingerprintManager;
+
+    invoke-virtual {p0, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object p0
+
+    check-cast p0, Landroid/hardware/fingerprint/FingerprintManager;
+
+    invoke-virtual {p0}, Landroid/hardware/fingerprint/FingerprintManager;->isHardwareDetected()Z
+
+    move-result p0
+
+    if-eqz p0, :cond_0
+
+    const/4 p0, 0x1
+
+    goto :goto_0
+
+    :cond_0
+    const/4 p0, 0x0
+
+    :goto_0
+    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+
+    move-result-object p0
+
+    return-object p0
+
+    :pswitch_data_0
+    .packed-switch 0x0
+        :pswitch_0
+    .end packed-switch
+.end method
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52.smali
index 24949ca69..85ae0a3a7 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52.smali
@@ -3,98 +3,38 @@
 .source "SourceFile"
 
 # interfaces
-.implements Lcom/android/internal/util/FunctionalUtils$ThrowingSupplier;
+.implements Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;
 
 
 # instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:Landroid/content/Context;
+.field public final synthetic f$0:Landroid/os/Bundle;
 
 
 # direct methods
-.method public synthetic constructor <init>(Landroid/content/Context;I)V
+.method public synthetic constructor <init>(Landroid/os/Bundle;)V
     .locals 0
 
-    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52;->$r8$classId:I
-
-    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52;->f$0:Landroid/content/Context;
-
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
+    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52;->f$0:Landroid/os/Bundle;
+
     return-void
 .end method
 
 
 # virtual methods
-.method public final getOrThrow()Ljava/lang/Object;
-    .locals 2
-
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52;->$r8$classId:I
-
-    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52;->f$0:Landroid/content/Context;
-
-    packed-switch v0, :pswitch_data_0
-
-    invoke-virtual {p0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
-
-    move-result-object p0
-
-    const-string/jumbo v0, "android.hardware.biometrics.iris"
-
-    invoke-virtual {p0, v0}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
+.method public final runOrThrow()V
+    .locals 1
 
-    :pswitch_0
-    invoke-virtual {p0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52;->f$0:Landroid/os/Bundle;
 
-    move-result-object v0
+    const-string/jumbo v0, "knox.container.proxy.EVENT_LOCK_TIMEOUT"
 
-    const-string/jumbo v1, "android.hardware.fingerprint"
+    invoke-static {v0, p0}, Lcom/samsung/android/knox/ContainerProxy;->sendEvent(Ljava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
 
-    invoke-virtual {v0, v1}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z
+    const-string/jumbo v0, "knox.container.proxy.COMMAND_ENFORCE_PASSWORD"
 
-    move-result v0
+    invoke-static {v0, p0}, Lcom/samsung/android/knox/ContainerProxy;->sendCommand(Ljava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
 
-    if-eqz v0, :cond_0
-
-    const-class v0, Landroid/hardware/fingerprint/FingerprintManager;
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/hardware/fingerprint/FingerprintManager;
-
-    invoke-virtual {p0}, Landroid/hardware/fingerprint/FingerprintManager;->isHardwareDetected()Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    :goto_0
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
+    return-void
 .end method
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda53.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda53.smali
deleted file mode 100644
index 92dfcc43a..000000000
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda53.smali
+++ /dev/null
@@ -1,40 +0,0 @@
-.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda53;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;
-
-
-# instance fields
-.field public final synthetic f$0:Landroid/os/Bundle;
-
-
-# direct methods
-.method public synthetic constructor <init>(Landroid/os/Bundle;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda53;->f$0:Landroid/os/Bundle;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final runOrThrow()V
-    .locals 1
-
-    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda53;->f$0:Landroid/os/Bundle;
-
-    const-string/jumbo v0, "knox.container.proxy.EVENT_LOCK_TIMEOUT"
-
-    invoke-static {v0, p0}, Lcom/samsung/android/knox/ContainerProxy;->sendEvent(Ljava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
-
-    const-string/jumbo v0, "knox.container.proxy.COMMAND_ENFORCE_PASSWORD"
-
-    invoke-static {v0, p0}, Lcom/samsung/android/knox/ContainerProxy;->sendCommand(Ljava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
-
-    return-void
-.end method
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6.smali
index 20ee21f06..dc42fd692 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6.smali
@@ -13,24 +13,24 @@
 
 .field public final synthetic f$1:Landroid/content/ComponentName;
 
-.field public final synthetic f$2:J
+.field public final synthetic f$2:I
 
 .field public final synthetic f$3:I
 
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;JII)V
+.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
     .locals 0
 
-    iput p6, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->$r8$classId:I
+    iput p5, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->$r8$classId:I
 
     iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
     iput-object p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$1:Landroid/content/ComponentName;
 
-    iput-wide p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:J
+    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:I
 
-    iput p5, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
+    iput p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
@@ -40,7 +40,7 @@
 
 # virtual methods
 .method public final runOrThrow()V
-    .locals 4
+    .locals 3
 
     iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->$r8$classId:I
 
@@ -50,7 +50,7 @@
 
     iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$1:Landroid/content/ComponentName;
 
-    iget-wide v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:J
+    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:I
 
     iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
 
@@ -60,7 +60,7 @@
 
     move-result p0
 
-    invoke-virtual {v0, v1, v2, v3, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordExpirationTimeoutMDM(Landroid/content/ComponentName;JI)V
+    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumSymbolsMDM(Landroid/content/ComponentName;II)V
 
     return-void
 
@@ -69,7 +69,7 @@
 
     iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$1:Landroid/content/ComponentName;
 
-    iget-wide v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:J
+    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:I
 
     iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
 
@@ -79,7 +79,178 @@
 
     move-result p0
 
-    invoke-virtual {v0, v1, v2, v3, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setMaximumTimeToLockMDM(Landroid/content/ComponentName;JI)V
+    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setKeyguardDisabledFeaturesMDM(Landroid/content/ComponentName;II)V
+
+    return-void
+
+    :pswitch_1
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$1:Landroid/content/ComponentName;
+
+    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:I
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+
+    move-result p0
+
+    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumNumericMDM(Landroid/content/ComponentName;II)V
+
+    return-void
+
+    :pswitch_2
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$1:Landroid/content/ComponentName;
+
+    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:I
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+
+    move-result p0
+
+    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumLengthMDM(Landroid/content/ComponentName;II)V
+
+    return-void
+
+    :pswitch_3
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$1:Landroid/content/ComponentName;
+
+    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:I
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+
+    move-result p0
+
+    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumLettersMDM(Landroid/content/ComponentName;II)V
+
+    return-void
+
+    :pswitch_4
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$1:Landroid/content/ComponentName;
+
+    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:I
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+
+    move-result p0
+
+    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumUpperCaseMDM(Landroid/content/ComponentName;II)V
+
+    return-void
+
+    :pswitch_5
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$1:Landroid/content/ComponentName;
+
+    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:I
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+
+    move-result p0
+
+    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumNonLetterMDM(Landroid/content/ComponentName;II)V
+
+    return-void
+
+    :pswitch_6
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$1:Landroid/content/ComponentName;
+
+    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:I
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+
+    move-result p0
+
+    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordHistoryLengthMDM(Landroid/content/ComponentName;II)V
+
+    return-void
+
+    :pswitch_7
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$1:Landroid/content/ComponentName;
+
+    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:I
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+
+    move-result p0
+
+    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumLowerCaseMDM(Landroid/content/ComponentName;II)V
+
+    return-void
+
+    :pswitch_8
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$1:Landroid/content/ComponentName;
+
+    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:I
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+
+    move-result p0
+
+    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordQualityMDM(Landroid/content/ComponentName;II)V
+
+    return-void
+
+    :pswitch_9
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$1:Landroid/content/ComponentName;
+
+    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$2:I
+
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;->f$3:I
+
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+
+    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+
+    move-result p0
+
+    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setMaximumFailedPasswordsForWipeMDM(Landroid/content/ComponentName;II)V
 
     return-void
 
@@ -87,6 +258,15 @@
 
     :pswitch_data_0
     .packed-switch 0x0
+        :pswitch_9
+        :pswitch_8
+        :pswitch_7
+        :pswitch_6
+        :pswitch_5
+        :pswitch_4
+        :pswitch_3
+        :pswitch_2
+        :pswitch_1
         :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7.smali
index 889e3a7dc..722d3f436 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7.smali
@@ -11,36 +11,50 @@
 
 .field public final synthetic f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-.field public final synthetic f$1:Landroid/content/ComponentName;
+.field public final synthetic f$1:I
 
-.field public final synthetic f$2:I
-
-.field public final synthetic f$3:I
+.field public final synthetic f$2:Z
 
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
+.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
     .locals 0
 
-    iput p5, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->$r8$classId:I
+    iput p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->$r8$classId:I
 
     iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iput-object p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:Landroid/content/ComponentName;
+    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:I
+
+    iput-boolean p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:Z
+
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+
+    return-void
+.end method
 
-    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:I
+.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;ZI)V
+    .locals 1
 
-    iput p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$3:I
+    const/4 v0, 0x1
+
+    iput v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->$r8$classId:I
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
+    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+
+    iput-boolean p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:Z
+
+    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:I
+
     return-void
 .end method
 
 
 # virtual methods
 .method public final runOrThrow()V
-    .locals 3
+    .locals 6
 
     iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->$r8$classId:I
 
@@ -48,222 +62,575 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:Landroid/content/ComponentName;
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:I
 
-    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:I
+    iget-boolean p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:Z
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$3:I
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+    invoke-static {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;
 
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+    move-result-object v0
 
-    move-result p0
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    new-instance v2, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v3, "excludeExternalStorageForFailedPasswordsWipeAsUser() userId = "
+
+    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    const-string v3, ", exclude = "
+
+    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string/jumbo v3, "SystemUIAdapter"
+
+    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-static {}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->isCalledFromSystem()Z
+
+    move-result v2
+
+    if-nez v2, :cond_0
+
+    goto :goto_1
+
+    :cond_0
+    new-instance v2, Lcom/android/internal/widget/LockPatternUtils;
+
+    sget-object v4, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mContext:Landroid/content/Context;
+
+    invoke-direct {v2, v4}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
+
+    invoke-virtual {v2, v1}, Lcom/android/internal/widget/LockPatternUtils;->isSeparateProfileChallengeEnabled(I)Z
+
+    move-result v2
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v5, "setMultifactorAuthEnabled() excludeExternalStorageForFailedPasswordsWipeAsUser = "
+
+    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getCurrentUserId()I
+
+    move-result v4
+
+    if-eq v1, v4, :cond_1
+
+    if-eqz v2, :cond_1
+
+    goto :goto_1
+
+    :cond_1
+    :try_start_0
+    iget-object v0, v0, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mCallbacks:Ljava/util/HashMap;
+
+    invoke-virtual {v0}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;
+
+    move-result-object v0
+
+    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
 
-    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumSymbolsMDM(Landroid/content/ComponentName;II)V
+    move-result-object v0
 
+    :cond_2
+    :goto_0
+    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
+
+    move-result v1
+
+    if-eqz v1, :cond_3
+
+    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+
+    move-result-object v1
+
+    check-cast v1, Ljava/util/Map$Entry;
+
+    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
+
+    move-result-object v1
+
+    check-cast v1, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;
+
+    if-eqz v1, :cond_2
+
+    invoke-interface {v1, p0}, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;->excludeExternalStorageForFailedPasswordsWipe(Z)V
+    :try_end_0
+    .catch Ljava/lang/NullPointerException; {:try_start_0 .. :try_end_0} :catch_1
+    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
+    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_2
+
+    goto :goto_0
+
+    :catch_0
+    move-exception p0
+
+    const-string/jumbo v0, "excludeExternalStorageForFailedPasswordsWipe() Failed with RemoteException"
+
+    invoke-static {v3, v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto :goto_1
+
+    :catch_1
+    const-string/jumbo p0, "excludeExternalStorageForFailedPasswordsWipe() failed with NullPointerException."
+
+    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+
+    :catch_2
+    :cond_3
+    :goto_1
     return-void
 
     :pswitch_0
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:Landroid/content/ComponentName;
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:I
 
-    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:I
+    iget-boolean p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:Z
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$3:I
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+    invoke-static {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;
 
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+    move-result-object v0
 
-    move-result p0
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    new-instance v2, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v3, "setPasswordVisibilityEnabledAsUser() userId = "
+
+    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    const-string v3, ", allow = "
+
+    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string/jumbo v3, "SystemUIAdapter"
+
+    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-static {}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->isCalledFromSystem()Z
+
+    move-result v2
+
+    if-nez v2, :cond_4
+
+    goto :goto_3
+
+    :cond_4
+    new-instance v2, Lcom/android/internal/widget/LockPatternUtils;
+
+    sget-object v4, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mContext:Landroid/content/Context;
+
+    invoke-direct {v2, v4}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
+
+    invoke-virtual {v2, v1}, Lcom/android/internal/widget/LockPatternUtils;->isSeparateProfileChallengeEnabled(I)Z
+
+    move-result v2
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v5, "setPasswordVisibilityEnabledAsUser() isSeparateProfileChallengeEnabled = "
+
+    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getCurrentUserId()I
+
+    move-result v4
+
+    if-eq v1, v4, :cond_5
 
-    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setKeyguardDisabledFeaturesMDM(Landroid/content/ComponentName;II)V
+    if-eqz v2, :cond_5
 
+    goto :goto_3
+
+    :cond_5
+    :try_start_1
+    iget-object v0, v0, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mCallbacks:Ljava/util/HashMap;
+
+    invoke-virtual {v0}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;
+
+    move-result-object v0
+
+    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
+
+    move-result-object v0
+
+    :cond_6
+    :goto_2
+    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
+
+    move-result v1
+
+    if-eqz v1, :cond_7
+
+    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+
+    move-result-object v1
+
+    check-cast v1, Ljava/util/Map$Entry;
+
+    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
+
+    move-result-object v1
+
+    check-cast v1, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;
+
+    if-eqz v1, :cond_6
+
+    invoke-interface {v1, p0}, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;->setPasswordVisibilityEnabled(Z)V
+    :try_end_1
+    .catch Ljava/lang/NullPointerException; {:try_start_1 .. :try_end_1} :catch_4
+    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_3
+    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_5
+
+    goto :goto_2
+
+    :catch_3
+    move-exception p0
+
+    const-string/jumbo v0, "setPasswordVisibilityEnabled() Failed with RemoteException"
+
+    invoke-static {v3, v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto :goto_3
+
+    :catch_4
+    const-string/jumbo p0, "setPasswordVisibilityEnabled() failed with NullPointerException."
+
+    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+
+    :catch_5
+    :cond_7
+    :goto_3
     return-void
 
     :pswitch_1
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:Landroid/content/ComponentName;
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:I
+
+    iget-boolean p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:Z
 
-    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:I
+    invoke-virtual {v0, v1}, Lcom/android/server/enterprise/security/PasswordPolicy;->isPasswordVisibilityEnabledAsUser(I)Z
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$3:I
+    move-result v2
 
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+    const/4 v3, 0x0
 
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+    const-string/jumbo v4, "show_password"
+
+    const-string/jumbo v5, "PasswordPolicy"
+
+    if-eqz v2, :cond_8
+
+    if-nez p0, :cond_8
+
+    invoke-virtual {v0, v1}, Lcom/android/server/enterprise/security/PasswordPolicy;->isPersona(I)Z
 
     move-result p0
 
-    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumNumericMDM(Landroid/content/ComponentName;II)V
+    if-nez p0, :cond_8
 
-    return-void
+    const-string/jumbo p0, "do not putIntForUser"
 
-    :pswitch_2
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    invoke-static {v5, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:Landroid/content/ComponentName;
+    iget-object p0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
-    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:I
+    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$3:I
+    move-result-object p0
 
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+    invoke-static {p0, v4, v3, v1}, Landroid/provider/Settings$System;->putIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)Z
 
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+    :cond_8
+    iget-object p0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
-    move-result p0
+    const-string/jumbo v2, "user"
 
-    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumLengthMDM(Landroid/content/ComponentName;II)V
+    invoke-virtual {p0, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
 
-    return-void
+    move-result-object p0
 
-    :pswitch_3
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    check-cast p0, Landroid/os/UserManager;
+
+    invoke-virtual {p0, v1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:Landroid/content/ComponentName;
+    move-result-object p0
 
-    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:I
+    invoke-virtual {p0}, Landroid/content/pm/UserInfo;->isManagedProfile()Z
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$3:I
+    move-result v2
 
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+    if-nez v2, :cond_9
 
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+    invoke-virtual {p0}, Landroid/content/pm/UserInfo;->isPrivateProfile()Z
 
     move-result p0
 
-    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumLettersMDM(Landroid/content/ComponentName;II)V
+    if-eqz p0, :cond_a
 
-    return-void
+    :cond_9
+    new-instance p0, Lcom/android/internal/widget/LockPatternUtils;
 
-    :pswitch_4
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v2, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
+
+    invoke-direct {p0, v2}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:Landroid/content/ComponentName;
+    invoke-virtual {p0, v1}, Lcom/android/internal/widget/LockPatternUtils;->isSeparateProfileChallengeEnabled(I)Z
 
-    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:I
+    move-result p0
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$3:I
+    if-nez p0, :cond_a
 
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+    const-string p0, "!hasSeparateChallenge"
 
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+    invoke-static {v5, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result p0
+    iget-object p0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
+
+    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
 
-    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumUpperCaseMDM(Landroid/content/ComponentName;II)V
+    move-result-object p0
 
+    invoke-static {p0, v4, v3, v1}, Landroid/provider/Settings$System;->putIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)Z
+
+    :cond_a
     return-void
 
-    :pswitch_5
+    :pswitch_2
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:Landroid/content/ComponentName;
+    iget-boolean v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:Z
 
-    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:I
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$3:I
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+    new-instance v2, Lcom/android/internal/widget/LockPatternUtils;
 
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+    iget-object v3, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
-    move-result p0
+    invoke-direct {v2, v3}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
 
-    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumNonLetterMDM(Landroid/content/ComponentName;II)V
+    invoke-virtual {v2, v1, p0}, Lcom/android/internal/widget/LockPatternUtils;->setVisiblePatternEnabled(ZI)V
 
-    return-void
+    iget-object v2, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
-    :pswitch_6
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    const-string/jumbo v3, "user"
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:Landroid/content/ComponentName;
+    invoke-virtual {v2, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
 
-    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:I
+    move-result-object v2
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$3:I
+    check-cast v2, Landroid/os/UserManager;
 
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+    invoke-virtual {v2, p0}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
 
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+    move-result-object v3
 
-    move-result p0
+    invoke-virtual {v3}, Landroid/content/pm/UserInfo;->isManagedProfile()Z
 
-    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordHistoryLengthMDM(Landroid/content/ComponentName;II)V
+    move-result v4
 
-    return-void
+    if-nez v4, :cond_b
 
-    :pswitch_7
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    invoke-virtual {v3}, Landroid/content/pm/UserInfo;->isPrivateProfile()Z
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:Landroid/content/ComponentName;
+    move-result v3
 
-    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:I
+    if-eqz v3, :cond_c
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$3:I
+    :cond_b
+    new-instance v3, Lcom/android/internal/widget/LockPatternUtils;
 
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+    iget-object v4, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+    invoke-direct {v3, v4}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
 
-    move-result p0
+    invoke-virtual {v3, p0}, Lcom/android/internal/widget/LockPatternUtils;->isSeparateProfileChallengeEnabled(I)Z
 
-    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordMinimumLowerCaseMDM(Landroid/content/ComponentName;II)V
+    move-result v3
 
-    return-void
+    if-nez v3, :cond_c
 
-    :pswitch_8
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    invoke-virtual {v2, p0}, Landroid/os/UserManager;->getProfileParent(I)Landroid/content/pm/UserInfo;
+
+    move-result-object p0
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:Landroid/content/ComponentName;
+    new-instance v2, Lcom/android/internal/widget/LockPatternUtils;
 
-    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:I
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$3:I
+    invoke-direct {v2, v0}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
 
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+    invoke-virtual {p0}, Landroid/content/pm/UserInfo;->getUserHandle()Landroid/os/UserHandle;
 
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+    move-result-object p0
+
+    invoke-virtual {p0}, Landroid/os/UserHandle;->getIdentifier()I
 
     move-result p0
 
-    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setPasswordQualityMDM(Landroid/content/ComponentName;II)V
+    invoke-virtual {v2, v1, p0}, Lcom/android/internal/widget/LockPatternUtils;->setVisiblePatternEnabled(ZI)V
 
+    :cond_c
     return-void
 
-    :pswitch_9
+    :pswitch_3
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:Landroid/content/ComponentName;
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$1:I
 
-    iget v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:I
+    iget-boolean p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$2:Z
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;->f$3:I
+    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
 
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mDevicePolicyManagerInternal:Landroid/app/admin/DevicePolicyManagerInternal;
+    invoke-static {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;
 
-    invoke-static {p0}, Landroid/os/UserHandle;->getUserId(I)I
+    move-result-object v0
 
-    move-result p0
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    const-string/jumbo v2, "setMultifactorAuthEnabled()"
+
+    const-string/jumbo v3, "SystemUIAdapter"
+
+    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-static {}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->isCalledFromSystem()Z
+
+    move-result v2
+
+    if-nez v2, :cond_d
+
+    goto :goto_7
+
+    :cond_d
+    invoke-virtual {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getCurrentUserId()I
+
+    move-result v2
+
+    if-eq v1, v2, :cond_e
+
+    goto :goto_7
+
+    :cond_e
+    :try_start_2
+    iget-object v0, v0, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mCallbacks:Ljava/util/HashMap;
+
+    invoke-virtual {v0}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;
+
+    move-result-object v0
+
+    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
+
+    move-result-object v0
+
+    :cond_f
+    :goto_4
+    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
+
+    move-result v1
+
+    if-eqz v1, :cond_10
+
+    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+
+    move-result-object v1
+
+    check-cast v1, Ljava/util/Map$Entry;
+
+    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
+
+    move-result-object v1
+
+    check-cast v1, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;
+
+    if-eqz v1, :cond_f
+
+    invoke-interface {v1, p0}, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;->setMultifactorAuthEnabled(Z)V
+    :try_end_2
+    .catch Ljava/lang/NullPointerException; {:try_start_2 .. :try_end_2} :catch_8
+    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_7
+    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_6
+
+    goto :goto_4
+
+    :catch_6
+    move-exception p0
+
+    goto :goto_5
+
+    :catch_7
+    move-exception p0
+
+    goto :goto_6
+
+    :goto_5
+    const-string/jumbo v0, "setMultifactorAuthEnabled() Failed with Exception"
+
+    invoke-static {v3, v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto :goto_7
+
+    :goto_6
+    const-string/jumbo v0, "setMultifactorAuthEnabled() Failed with RemoteException"
+
+    invoke-static {v3, v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto :goto_7
+
+    :catch_8
+    const-string/jumbo p0, "setMultifactorAuthEnabled() failed with NullPointerException."
 
-    invoke-virtual {v0, v1, v2, p0}, Landroid/app/admin/DevicePolicyManagerInternal;->setMaximumFailedPasswordsForWipeMDM(Landroid/content/ComponentName;II)V
+    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
+    :cond_10
+    :goto_7
     return-void
 
     nop
 
     :pswitch_data_0
     .packed-switch 0x0
-        :pswitch_9
-        :pswitch_8
-        :pswitch_7
-        :pswitch_6
-        :pswitch_5
-        :pswitch_4
         :pswitch_3
         :pswitch_2
         :pswitch_1
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8.smali
deleted file mode 100644
index a898fcbe5..000000000
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8.smali
+++ /dev/null
@@ -1,639 +0,0 @@
-.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-.field public final synthetic f$1:I
-
-.field public final synthetic f$2:Z
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
-    .locals 0
-
-    iput p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->$r8$classId:I
-
-    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$1:I
-
-    iput-boolean p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$2:Z
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-.method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;ZI)V
-    .locals 1
-
-    const/4 v0, 0x1
-
-    iput v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->$r8$classId:I
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iput-boolean p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$2:Z
-
-    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$1:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final runOrThrow()V
-    .locals 6
-
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->$r8$classId:I
-
-    packed-switch v0, :pswitch_data_0
-
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$1:I
-
-    iget-boolean p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$2:Z
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "excludeExternalStorageForFailedPasswordsWipeAsUser() userId = "
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v3, ", exclude = "
-
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    const-string/jumbo v3, "SystemUIAdapter"
-
-    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->isCalledFromSystem()Z
-
-    move-result v2
-
-    if-nez v2, :cond_0
-
-    goto :goto_1
-
-    :cond_0
-    new-instance v2, Lcom/android/internal/widget/LockPatternUtils;
-
-    sget-object v4, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mContext:Landroid/content/Context;
-
-    invoke-direct {v2, v4}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {v2, v1}, Lcom/android/internal/widget/LockPatternUtils;->isSeparateProfileChallengeEnabled(I)Z
-
-    move-result v2
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "setMultifactorAuthEnabled() excludeExternalStorageForFailedPasswordsWipeAsUser = "
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getCurrentUserId()I
-
-    move-result v4
-
-    if-eq v1, v4, :cond_1
-
-    if-eqz v2, :cond_1
-
-    goto :goto_1
-
-    :cond_1
-    :try_start_0
-    iget-object v0, v0, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mCallbacks:Ljava/util/HashMap;
-
-    invoke-virtual {v0}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;
-
-    move-result-object v0
-
-    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
-
-    move-result-object v0
-
-    :cond_2
-    :goto_0
-    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_3
-
-    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Ljava/util/Map$Entry;
-
-    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;
-
-    if-eqz v1, :cond_2
-
-    invoke-interface {v1, p0}, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;->excludeExternalStorageForFailedPasswordsWipe(Z)V
-    :try_end_0
-    .catch Ljava/lang/NullPointerException; {:try_start_0 .. :try_end_0} :catch_1
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_2
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    const-string/jumbo v0, "excludeExternalStorageForFailedPasswordsWipe() Failed with RemoteException"
-
-    invoke-static {v3, v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    goto :goto_1
-
-    :catch_1
-    const-string/jumbo p0, "excludeExternalStorageForFailedPasswordsWipe() failed with NullPointerException."
-
-    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :catch_2
-    :cond_3
-    :goto_1
-    return-void
-
-    :pswitch_0
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$1:I
-
-    iget-boolean p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$2:Z
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "setPasswordVisibilityEnabledAsUser() userId = "
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v3, ", allow = "
-
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    const-string/jumbo v3, "SystemUIAdapter"
-
-    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->isCalledFromSystem()Z
-
-    move-result v2
-
-    if-nez v2, :cond_4
-
-    goto :goto_3
-
-    :cond_4
-    new-instance v2, Lcom/android/internal/widget/LockPatternUtils;
-
-    sget-object v4, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mContext:Landroid/content/Context;
-
-    invoke-direct {v2, v4}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {v2, v1}, Lcom/android/internal/widget/LockPatternUtils;->isSeparateProfileChallengeEnabled(I)Z
-
-    move-result v2
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "setPasswordVisibilityEnabledAsUser() isSeparateProfileChallengeEnabled = "
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getCurrentUserId()I
-
-    move-result v4
-
-    if-eq v1, v4, :cond_5
-
-    if-eqz v2, :cond_5
-
-    goto :goto_3
-
-    :cond_5
-    :try_start_1
-    iget-object v0, v0, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mCallbacks:Ljava/util/HashMap;
-
-    invoke-virtual {v0}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;
-
-    move-result-object v0
-
-    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
-
-    move-result-object v0
-
-    :cond_6
-    :goto_2
-    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_7
-
-    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Ljava/util/Map$Entry;
-
-    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;
-
-    if-eqz v1, :cond_6
-
-    invoke-interface {v1, p0}, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;->setPasswordVisibilityEnabled(Z)V
-    :try_end_1
-    .catch Ljava/lang/NullPointerException; {:try_start_1 .. :try_end_1} :catch_4
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_3
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_5
-
-    goto :goto_2
-
-    :catch_3
-    move-exception p0
-
-    const-string/jumbo v0, "setPasswordVisibilityEnabled() Failed with RemoteException"
-
-    invoke-static {v3, v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    goto :goto_3
-
-    :catch_4
-    const-string/jumbo p0, "setPasswordVisibilityEnabled() failed with NullPointerException."
-
-    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :catch_5
-    :cond_7
-    :goto_3
-    return-void
-
-    :pswitch_1
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$1:I
-
-    iget-boolean p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$2:Z
-
-    invoke-virtual {v0, v1}, Lcom/android/server/enterprise/security/PasswordPolicy;->isPasswordVisibilityEnabledAsUser(I)Z
-
-    move-result v2
-
-    const/4 v3, 0x0
-
-    const-string/jumbo v4, "show_password"
-
-    const-string/jumbo v5, "PasswordPolicy"
-
-    if-eqz v2, :cond_8
-
-    if-nez p0, :cond_8
-
-    invoke-virtual {v0, v1}, Lcom/android/server/enterprise/security/PasswordPolicy;->isPersona(I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_8
-
-    const-string/jumbo p0, "do not putIntForUser"
-
-    invoke-static {v5, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object p0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object p0
-
-    invoke-static {p0, v4, v3, v1}, Landroid/provider/Settings$System;->putIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)Z
-
-    :cond_8
-    iget-object p0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v2, "user"
-
-    invoke-virtual {p0, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/os/UserManager;
-
-    invoke-virtual {p0, v1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Landroid/content/pm/UserInfo;->isManagedProfile()Z
-
-    move-result v2
-
-    if-nez v2, :cond_9
-
-    invoke-virtual {p0}, Landroid/content/pm/UserInfo;->isPrivateProfile()Z
-
-    move-result p0
-
-    if-eqz p0, :cond_a
-
-    :cond_9
-    new-instance p0, Lcom/android/internal/widget/LockPatternUtils;
-
-    iget-object v2, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-direct {p0, v2}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {p0, v1}, Lcom/android/internal/widget/LockPatternUtils;->isSeparateProfileChallengeEnabled(I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_a
-
-    const-string p0, "!hasSeparateChallenge"
-
-    invoke-static {v5, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object p0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object p0
-
-    invoke-static {p0, v4, v3, v1}, Landroid/provider/Settings$System;->putIntForUser(Landroid/content/ContentResolver;Ljava/lang/String;II)Z
-
-    :cond_a
-    return-void
-
-    :pswitch_2
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iget-boolean v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$2:Z
-
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$1:I
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v2, Lcom/android/internal/widget/LockPatternUtils;
-
-    iget-object v3, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-direct {v2, v3}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {v2, v1, p0}, Lcom/android/internal/widget/LockPatternUtils;->setVisiblePatternEnabled(ZI)V
-
-    iget-object v2, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v3, "user"
-
-    invoke-virtual {v2, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Landroid/os/UserManager;
-
-    invoke-virtual {v2, p0}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v3
-
-    invoke-virtual {v3}, Landroid/content/pm/UserInfo;->isManagedProfile()Z
-
-    move-result v4
-
-    if-nez v4, :cond_b
-
-    invoke-virtual {v3}, Landroid/content/pm/UserInfo;->isPrivateProfile()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_c
-
-    :cond_b
-    new-instance v3, Lcom/android/internal/widget/LockPatternUtils;
-
-    iget-object v4, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-direct {v3, v4}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {v3, p0}, Lcom/android/internal/widget/LockPatternUtils;->isSeparateProfileChallengeEnabled(I)Z
-
-    move-result v3
-
-    if-nez v3, :cond_c
-
-    invoke-virtual {v2, p0}, Landroid/os/UserManager;->getProfileParent(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    new-instance v2, Lcom/android/internal/widget/LockPatternUtils;
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-direct {v2, v0}, Lcom/android/internal/widget/LockPatternUtils;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {p0}, Landroid/content/pm/UserInfo;->getUserHandle()Landroid/os/UserHandle;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Landroid/os/UserHandle;->getIdentifier()I
-
-    move-result p0
-
-    invoke-virtual {v2, v1, p0}, Lcom/android/internal/widget/LockPatternUtils;->setVisiblePatternEnabled(ZI)V
-
-    :cond_c
-    return-void
-
-    :pswitch_3
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
-
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$1:I
-
-    iget-boolean p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;->f$2:Z
-
-    iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v2, "setMultifactorAuthEnabled()"
-
-    const-string/jumbo v3, "SystemUIAdapter"
-
-    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->isCalledFromSystem()Z
-
-    move-result v2
-
-    if-nez v2, :cond_d
-
-    goto :goto_7
-
-    :cond_d
-    invoke-virtual {v0}, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->getCurrentUserId()I
-
-    move-result v2
-
-    if-eq v1, v2, :cond_e
-
-    goto :goto_7
-
-    :cond_e
-    :try_start_2
-    iget-object v0, v0, Lcom/android/server/enterprise/adapterlayer/SystemUIAdapter;->mCallbacks:Ljava/util/HashMap;
-
-    invoke-virtual {v0}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;
-
-    move-result-object v0
-
-    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
-
-    move-result-object v0
-
-    :cond_f
-    :goto_4
-    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_10
-
-    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Ljava/util/Map$Entry;
-
-    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;
-
-    if-eqz v1, :cond_f
-
-    invoke-interface {v1, p0}, Landroid/sec/enterprise/adapterlayer/ISystemUIAdapterCallback;->setMultifactorAuthEnabled(Z)V
-    :try_end_2
-    .catch Ljava/lang/NullPointerException; {:try_start_2 .. :try_end_2} :catch_8
-    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_7
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_6
-
-    goto :goto_4
-
-    :catch_6
-    move-exception p0
-
-    goto :goto_5
-
-    :catch_7
-    move-exception p0
-
-    goto :goto_6
-
-    :goto_5
-    const-string/jumbo v0, "setMultifactorAuthEnabled() Failed with Exception"
-
-    invoke-static {v3, v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    goto :goto_7
-
-    :goto_6
-    const-string/jumbo v0, "setMultifactorAuthEnabled() Failed with RemoteException"
-
-    invoke-static {v3, v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    goto :goto_7
-
-    :catch_8
-    const-string/jumbo p0, "setMultifactorAuthEnabled() failed with NullPointerException."
-
-    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_10
-    :goto_7
-    return-void
-
-    nop
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_3
-        :pswitch_2
-        :pswitch_1
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9.smali
similarity index 76%
rename from smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10.smali
rename to smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9.smali
index 40f812c78..2b4af3d6a 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9.smali
@@ -1,4 +1,4 @@
-.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;
+.class public final synthetic Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;
 .super Ljava/lang/Object;
 .source "SourceFile"
 
@@ -20,13 +20,13 @@
 .method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;I)V
     .locals 0
 
-    iput p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->$r8$classId:I
+    iput p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->$r8$classId:I
 
-    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$2:I
+    iput p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$2:I
 
-    iput-object p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$1:Landroid/content/ComponentName;
+    iput-object p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$1:Landroid/content/ComponentName;
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
@@ -36,13 +36,13 @@
 .method public synthetic constructor <init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;II)V
     .locals 0
 
-    iput p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->$r8$classId:I
+    iput p4, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->$r8$classId:I
 
-    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iput-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iput-object p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$1:Landroid/content/ComponentName;
+    iput-object p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$1:Landroid/content/ComponentName;
 
-    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$2:I
+    iput p3, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$2:I
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
@@ -54,15 +54,15 @@
 .method public final getOrThrow()Ljava/lang/Object;
     .locals 3
 
-    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->$r8$classId:I
+    iget v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->$r8$classId:I
 
     packed-switch v0, :pswitch_data_0
 
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$1:Landroid/content/ComponentName;
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$1:Landroid/content/ComponentName;
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$2:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$2:I
 
     iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mService:Landroid/app/admin/IDevicePolicyManager;
 
@@ -83,11 +83,11 @@
     return-object p0
 
     :pswitch_0
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$2:I
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$2:I
 
-    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$1:Landroid/content/ComponentName;
+    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$1:Landroid/content/ComponentName;
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -108,11 +108,11 @@
     return-object p0
 
     :pswitch_1
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$1:Landroid/content/ComponentName;
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$1:Landroid/content/ComponentName;
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$2:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$2:I
 
     iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mService:Landroid/app/admin/IDevicePolicyManager;
 
@@ -133,11 +133,11 @@
     return-object p0
 
     :pswitch_2
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$2:I
+    iget v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$2:I
 
-    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$1:Landroid/content/ComponentName;
+    iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$1:Landroid/content/ComponentName;
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -158,11 +158,11 @@
     return-object p0
 
     :pswitch_3
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$1:Landroid/content/ComponentName;
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$1:Landroid/content/ComponentName;
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$2:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$2:I
 
     iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mService:Landroid/app/admin/IDevicePolicyManager;
 
@@ -183,11 +183,11 @@
     return-object p0
 
     :pswitch_4
-    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$0:Lcom/android/server/enterprise/security/PasswordPolicy;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$1:Landroid/content/ComponentName;
+    iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$1:Landroid/content/ComponentName;
 
-    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;->f$2:I
+    iget p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;->f$2:I
 
     iget-object v0, v0, Lcom/android/server/enterprise/security/PasswordPolicy;->mService:Landroid/app/admin/IDevicePolicyManager;
 
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0.smali b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0.smali
index 34134795f..1879f0c37 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0.smali
@@ -19,21 +19,3 @@
 
     return-object p0
 .end method
-
-.method public static m(ILjava/lang/String;Ljava/lang/String;)V
-    .locals 1
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p2, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-.end method
diff --git a/smali/com/android/server/enterprise/security/PasswordPolicy.smali b/smali/com/android/server/enterprise/security/PasswordPolicy.smali
index b18efff36..debddedfc 100644
--- a/smali/com/android/server/enterprise/security/PasswordPolicy.smali
+++ b/smali/com/android/server/enterprise/security/PasswordPolicy.smali
@@ -834,11 +834,11 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;
 
     const/4 v2, 0x4
 
-    invoke-direct {v1, p0, p1, p2, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;I)V
+    invoke-direct {v1, p0, p1, p2, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;I)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -1288,11 +1288,11 @@
 
     iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;
+    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;
 
     const/4 v3, 0x2
 
-    invoke-direct {v2, p0, v0, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
+    invoke-direct {v2, p0, v0, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
 
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -1597,11 +1597,11 @@
 
     iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;
+    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
 
     const/4 v3, 0x4
 
-    invoke-direct {v2, p0, v0, p1, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
+    invoke-direct {v2, p0, v0, p1, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
 
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -1845,11 +1845,11 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;
 
     const/4 v2, 0x0
 
-    invoke-direct {v1, p0, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
+    invoke-direct {v1, p0, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -1908,11 +1908,11 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;
 
     const/4 v2, 0x4
 
-    invoke-direct {v1, p0, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
+    invoke-direct {v1, p0, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -2213,11 +2213,11 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;
 
     const/4 v2, 0x5
 
-    invoke-direct {v1, p0, p2, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;II)V
+    invoke-direct {v1, p0, p2, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;II)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -2620,11 +2620,11 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;
 
     const/4 v2, 0x3
 
-    invoke-direct {v1, p0, p2, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;II)V
+    invoke-direct {v1, p0, p2, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;II)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -2762,11 +2762,11 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;
 
     const/4 v2, 0x0
 
-    invoke-direct {v1, p0, p2, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;II)V
+    invoke-direct {v1, p0, p2, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;II)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -3814,11 +3814,11 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;
 
     const/4 v2, 0x1
 
-    invoke-direct {v1, p0, p2, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;II)V
+    invoke-direct {v1, p0, p2, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;II)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -4839,11 +4839,11 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;
 
     const/4 v2, 0x3
 
-    invoke-direct {v1, p0, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
+    invoke-direct {v1, p0, p1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -5193,7 +5193,7 @@
     :cond_3
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda47;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda46;
 
     invoke-direct {v0}, Ljava/lang/Object;-><init>()V
 
@@ -5302,11 +5302,11 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda25;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda24;
 
     const/4 v2, 0x0
 
-    invoke-direct {v1, v2, p0}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda25;-><init>(ILjava/lang/Object;)V
+    invoke-direct {v1, v2, p0}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda24;-><init>(ILjava/lang/Object;)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -5848,11 +5848,11 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;
 
     const/4 v2, 0x2
 
-    invoke-direct {v1, p0, p1, p2, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda10;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;I)V
+    invoke-direct {v1, p0, p1, p2, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;I)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -6075,11 +6075,11 @@
 
     iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda25;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda24;
 
     const/4 v1, 0x1
 
-    invoke-direct {v0, v1, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda25;-><init>(ILjava/lang/Object;)V
+    invoke-direct {v0, v1, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda24;-><init>(ILjava/lang/Object;)V
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -6261,9 +6261,9 @@
 
     iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda53;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52;
 
-    invoke-direct {v1, v0}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda53;-><init>(Landroid/os/Bundle;)V
+    invoke-direct {v1, v0}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52;-><init>(Landroid/os/Bundle;)V
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -6291,33 +6291,6 @@
 
     check-cast p0, Lcom/android/server/knox/dar/DarManagerService;
 
-    if-eqz p0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    if-eqz p0, :cond_4
-
-    iget-boolean v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mIsHandlerReady:Z
-
-    if-eqz v0, :cond_4
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    const/16 v1, 0xe
-
-    const-wide/16 v2, 0x0
-
-    invoke-virtual {p0, v1, v2, v3, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->quickMessageDelayed(IJLjava/lang/Object;)V
-
-    const-string p0, "Enforce change password for user "
-
-    const/4 v0, 0x0
-
-    invoke-static {p1, p0, v0}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    :cond_4
     return-void
 .end method
 
@@ -6548,7 +6521,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;
+    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;
 
     move-object v3, p0
 
@@ -6560,7 +6533,7 @@
 
     move v8, p5
 
-    invoke-direct/range {v2 .. v8}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda43;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;Ljava/lang/String;[BI)V
+    invoke-direct/range {v2 .. v8}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda42;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;Ljava/lang/String;[BI)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -6760,9 +6733,9 @@
     :cond_5
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17;
 
-    invoke-direct {v1, p0, p1, p2, p3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda18;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZZ)V
+    invoke-direct {v1, p0, p1, p2, p3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda17;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZZ)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -6916,11 +6889,11 @@
 
     iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v3, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;
+    new-instance v3, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
 
     const/4 v4, 0x1
 
-    invoke-direct {v3, p0, p2, v1, v4}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
+    invoke-direct {v3, p0, p2, v1, v4}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
 
     invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -6998,11 +6971,11 @@
 
     iget-object v5, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v6, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;
+    new-instance v6, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
 
     const/4 v7, 0x1
 
-    invoke-direct {v6, p0, p2, v4, v7}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
+    invoke-direct {v6, p0, p2, v4, v7}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
 
     invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -7246,11 +7219,11 @@
 
     iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;
 
     const/4 v2, 0x0
 
-    invoke-direct {v1, p2, p1, v2, v8}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(IIILjava/lang/String;)V
+    invoke-direct {v1, p2, p1, v2, v8}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;-><init>(IIILjava/lang/String;)V
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -7466,7 +7439,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
 
     const/16 v6, 0x9
 
@@ -7476,7 +7449,7 @@
 
     move v4, p3
 
-    invoke-direct/range {v1 .. v6}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
+    invoke-direct/range {v1 .. v6}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -7626,11 +7599,11 @@
 
     iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;
 
     const/4 v2, 0x2
 
-    invoke-direct {v1, v0, p1, v3, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;-><init>(IIII)V
+    invoke-direct {v1, v0, p1, v3, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;-><init>(IIII)V
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -7680,11 +7653,11 @@
 
     iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;
 
     const/4 v2, 0x0
 
-    invoke-direct {v1, v0, p1, v3, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;-><init>(IIII)V
+    invoke-direct {v1, v0, p1, v3, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;-><init>(IIII)V
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -7734,11 +7707,11 @@
 
     iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v4, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;
+    new-instance v4, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;
 
     const/4 v5, 0x3
 
-    invoke-direct {v4, v0, v1, v3, v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;-><init>(IIII)V
+    invoke-direct {v4, v0, v1, v3, v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;-><init>(IIII)V
 
     invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -7750,11 +7723,11 @@
 
     iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;
+    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
 
     const/4 v3, 0x0
 
-    invoke-direct {v2, p0, p1, v0, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
+    invoke-direct {v2, p0, p1, v0, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
 
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -7779,7 +7752,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
 
     const/4 v5, 0x0
 
@@ -7789,7 +7762,7 @@
 
     move v3, p3
 
-    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
+    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -7839,11 +7812,11 @@
 
     iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;
 
     const/4 v2, 0x4
 
-    invoke-direct {v1, v0, p1, v3, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;-><init>(IIII)V
+    invoke-direct {v1, v0, p1, v3, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;-><init>(IIII)V
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -7868,7 +7841,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;
 
     const/4 v7, 0x0
 
@@ -7878,7 +7851,7 @@
 
     move-wide v4, p3
 
-    invoke-direct/range {v1 .. v7}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;JII)V
+    invoke-direct/range {v1 .. v7}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;JII)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -7947,11 +7920,11 @@
 
     iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;
 
     const/4 v2, 0x1
 
-    invoke-direct {v1, v0, p1, v3, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda21;-><init>(IIII)V
+    invoke-direct {v1, v0, p1, v3, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda20;-><init>(IIII)V
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -7976,11 +7949,11 @@
 
     iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v3, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52;
+    new-instance v3, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51;
 
     const/4 v4, 0x0
 
-    invoke-direct {v3, v1, v4}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52;-><init>(Landroid/content/Context;I)V
+    invoke-direct {v3, v1, v4}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51;-><init>(Landroid/content/Context;I)V
 
     invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8004,11 +7977,11 @@
 
     iget-object v4, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v5, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52;
+    new-instance v5, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51;
 
     const/4 v6, 0x1
 
-    invoke-direct {v5, v1, v6}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda52;-><init>(Landroid/content/Context;I)V
+    invoke-direct {v5, v1, v6}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda51;-><init>(Landroid/content/Context;I)V
 
     invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8035,11 +8008,11 @@
 
     iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v4, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;
+    new-instance v4, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;
 
     const/4 v5, 0x1
 
-    invoke-direct {v4, p0, v0, v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
+    invoke-direct {v4, p0, v0, v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
 
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8114,11 +8087,11 @@
 
     iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v4, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;
+    new-instance v4, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
 
     const/4 v5, 0x0
 
-    invoke-direct {v4, p0, v0, v7, v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
+    invoke-direct {v4, p0, v0, v7, v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
 
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8283,7 +8256,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;
 
     const/4 v6, 0x1
 
@@ -8293,7 +8266,7 @@
 
     move-wide v3, p3
 
-    invoke-direct/range {v0 .. v6}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;JII)V
+    invoke-direct/range {v0 .. v6}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;JII)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8318,7 +8291,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
 
     const/4 v5, 0x3
 
@@ -8328,7 +8301,7 @@
 
     move v3, p3
 
-    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
+    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8457,11 +8430,11 @@
 
     iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;
+    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
 
     const/4 v3, 0x3
 
-    invoke-direct {v2, p0, v0, p1, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
+    invoke-direct {v2, p0, v0, p1, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
 
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8486,7 +8459,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
 
     const/4 v5, 0x7
 
@@ -8496,7 +8469,7 @@
 
     move v3, p3
 
-    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
+    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8521,7 +8494,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
 
     const/4 v5, 0x6
 
@@ -8531,7 +8504,7 @@
 
     move v3, p3
 
-    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
+    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8556,7 +8529,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
 
     const/4 v5, 0x2
 
@@ -8566,7 +8539,7 @@
 
     move v3, p3
 
-    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
+    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8591,7 +8564,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
 
     const/4 v5, 0x4
 
@@ -8601,7 +8574,7 @@
 
     move v3, p3
 
-    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
+    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8626,7 +8599,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
 
     const/16 v5, 0x8
 
@@ -8636,7 +8609,7 @@
 
     move v3, p3
 
-    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
+    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8661,7 +8634,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
 
     const/16 v5, 0xa
 
@@ -8671,7 +8644,7 @@
 
     move v3, p3
 
-    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
+    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8696,7 +8669,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
 
     const/4 v5, 0x5
 
@@ -8706,7 +8679,7 @@
 
     move v3, p3
 
-    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
+    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8731,7 +8704,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;
 
     const/4 v5, 0x1
 
@@ -8741,7 +8714,7 @@
 
     move v3, p3
 
-    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
+    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;Landroid/content/ComponentName;III)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8764,11 +8737,11 @@
 
     iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;
+    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
 
     const/4 v3, 0x2
 
-    invoke-direct {v2, p0, v0, p2, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
+    invoke-direct {v2, p0, v0, p2, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
 
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8794,11 +8767,11 @@
 
     iget-object p2, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
 
     const/4 v2, 0x3
 
-    invoke-direct {v1, p0, v0, v7, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
+    invoke-direct {v1, p0, v0, v7, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
 
     invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -8993,11 +8966,11 @@
 
     iget-object v4, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v5, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;
+    new-instance v5, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
 
     const/4 v6, 0x2
 
-    invoke-direct {v5, p0, p2, v2, v6}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
+    invoke-direct {v5, p0, p2, v2, v6}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
 
     invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9055,11 +9028,11 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;
+    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;
 
     const/4 v3, 0x0
 
-    invoke-direct {v2, p0, p2, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda15;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
+    invoke-direct {v2, p0, p2, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda14;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;II)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9208,11 +9181,11 @@
 
     iget-object p0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;
 
     const/4 v2, 0x1
 
-    invoke-direct {v1, v0, p1, v2, v6}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(IIILjava/lang/String;)V
+    invoke-direct {v1, v0, p1, v2, v6}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda3;-><init>(IIILjava/lang/String;)V
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9245,9 +9218,9 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1;
 
-    invoke-direct {v1, p0, p1, p2, p3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;[B)V
+    invoke-direct {v1, p0, p1, p2, p3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;[B)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9296,9 +9269,9 @@
 
     iget-object v0, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;
+    new-instance v1, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
 
-    invoke-direct {v1, p0, v3, p1}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;ZI)V
+    invoke-direct {v1, p0, v3, p1}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;ZI)V
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9328,7 +9301,7 @@
 
     iget-object p1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;
+    new-instance v0, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;
 
     move-object v1, p0
 
@@ -9338,7 +9311,7 @@
 
     move-object v5, p4
 
-    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda27;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;Landroid/content/ComponentName;Landroid/os/PersistableBundle;)V
+    invoke-direct/range {v0 .. v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda26;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;ILandroid/content/ComponentName;Landroid/content/ComponentName;Landroid/os/PersistableBundle;)V
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9415,9 +9388,9 @@
 
     iget-object v3, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v4, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12;
+    new-instance v4, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11;
 
-    invoke-direct {v4, p0, p1, v0, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda12;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IILandroid/os/Bundle;)V
+    invoke-direct {v4, p0, p1, v0, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda11;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IILandroid/os/Bundle;)V
 
     invoke-virtual {v3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9487,11 +9460,11 @@
 
     iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;
+    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
 
     const/4 v3, 0x3
 
-    invoke-direct {v2, p0, p1, v0, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
+    invoke-direct {v2, p0, p1, v0, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
 
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9503,11 +9476,11 @@
 
     iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;
+    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
 
     const/4 v3, 0x2
 
-    invoke-direct {v2, p0, p1, v0, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
+    invoke-direct {v2, p0, p1, v0, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
 
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9519,11 +9492,11 @@
 
     iget-object v1, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;
+    new-instance v2, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
 
     const/4 v3, 0x0
 
-    invoke-direct {v2, p0, v0, p1, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
+    invoke-direct {v2, p0, v0, p1, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
 
     invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9584,11 +9557,11 @@
 
     iget-object v6, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v7, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;
+    new-instance v7, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;
 
     const/4 v8, 0x0
 
-    invoke-direct {v7, p0, v4, v5, v8}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
+    invoke-direct {v7, p0, v4, v5, v8}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;III)V
 
     invoke-virtual {v6}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9603,11 +9576,11 @@
 
     iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v3, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;
+    new-instance v3, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
 
     const/4 v4, 0x4
 
-    invoke-direct {v3, p0, p1, v0, v4}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
+    invoke-direct {v3, p0, p1, v0, v4}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
 
     invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9619,11 +9592,11 @@
 
     iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v3, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;
+    new-instance v3, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
 
     const/4 v4, 0x0
 
-    invoke-direct {v3, p0, p1, v0, v4}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
+    invoke-direct {v3, p0, p1, v0, v4}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
 
     invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -9635,11 +9608,11 @@
 
     iget-object v2, p0, Lcom/android/server/enterprise/security/PasswordPolicy;->mInjector:Lcom/android/server/enterprise/security/PasswordPolicy$Injector;
 
-    new-instance v3, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;
+    new-instance v3, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;
 
     const/4 v4, 0x3
 
-    invoke-direct {v3, p0, p1, v0, v4}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
+    invoke-direct {v3, p0, p1, v0, v4}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/enterprise/security/PasswordPolicy;IZI)V
 
     invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
diff --git a/smali/com/android/server/knox/ContainerDependencyWrapper.smali b/smali/com/android/server/knox/ContainerDependencyWrapper.smali
index b24e0ed4d..d7063829f 100644
--- a/smali/com/android/server/knox/ContainerDependencyWrapper.smali
+++ b/smali/com/android/server/knox/ContainerDependencyWrapper.smali
@@ -13,10 +13,6 @@
 .field public static sInstance:Lcom/android/server/knox/ContainerDependencyWrapper;
 
 
-# instance fields
-.field public mDarService:Lcom/android/server/knox/dar/DarManagerService;
-
-
 # direct methods
 .method public static addAppPackageNameToAllowList(ILandroid/content/Context;Ljava/util/List;)V
     .locals 4
diff --git a/smali/com/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0.smali b/smali/com/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0.smali
index 0a291ca76..6f077e937 100644
--- a/smali/com/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0.smali
+++ b/smali/com/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0.smali
@@ -248,9 +248,9 @@
 
     move-result-object v8
 
-    new-instance v11, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;
+    new-instance v11, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;
 
-    invoke-direct {v11, v6, v0}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;-><init>(II)V
+    invoke-direct {v11, v6, v0}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;-><init>(II)V
 
     invoke-virtual {v8, v11}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
@@ -339,7 +339,7 @@
 
     move-result-object v1
 
-    new-instance v4, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;
+    new-instance v4, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3;
 
     invoke-direct {v4}, Ljava/lang/Object;-><init>()V
 
@@ -347,7 +347,7 @@
 
     move-result-object v1
 
-    new-instance v4, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1;
+    new-instance v4, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;
 
     invoke-direct {v4}, Ljava/lang/Object;-><init>()V
 
diff --git a/smali/com/android/server/knox/dar/DarManagerService.smali b/smali/com/android/server/knox/dar/DarManagerService.smali
index 2c50d66b4..a33441302 100644
--- a/smali/com/android/server/knox/dar/DarManagerService.smali
+++ b/smali/com/android/server/knox/dar/DarManagerService.smali
@@ -26,8 +26,6 @@
 
 .field public final mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-.field public final mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
 .field public mUserManager:Landroid/os/UserManager;
 
 .field public final mUserSwitchObserver:Lcom/android/server/knox/dar/DarManagerService$1;
@@ -91,9 +89,48 @@
 
     iput-object p1, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    invoke-static {}, Lcom/android/server/knox/dar/KeyProtector;->getInstance()Lcom/android/server/knox/dar/KeyProtector;
+    sget-object v2, Lcom/android/server/knox/dar/KeyProtector;->sInstance:Lcom/android/server/knox/dar/KeyProtector;
 
-    move-result-object v2
+    if-nez v2, :cond_1
+
+    const-class v2, Lcom/android/server/knox/dar/KeyProtector;
+
+    monitor-enter v2
+
+    :try_start_0
+    sget-object v3, Lcom/android/server/knox/dar/KeyProtector;->sInstance:Lcom/android/server/knox/dar/KeyProtector;
+
+    if-nez v3, :cond_0
+
+    new-instance v3, Lcom/android/server/knox/dar/KeyProtector;
+
+    invoke-direct {v3}, Ljava/lang/Object;-><init>()V
+
+    sput-object v3, Lcom/android/server/knox/dar/KeyProtector;->sInstance:Lcom/android/server/knox/dar/KeyProtector;
+
+    goto :goto_0
+
+    :catchall_0
+    move-exception p0
+
+    goto :goto_1
+
+    :cond_0
+    :goto_0
+    monitor-exit v2
+
+    goto :goto_2
+
+    :goto_1
+    monitor-exit v2
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+
+    throw p0
+
+    :cond_1
+    :goto_2
+    sget-object v2, Lcom/android/server/knox/dar/KeyProtector;->sInstance:Lcom/android/server/knox/dar/KeyProtector;
 
     iput-object v2, p0, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
 
@@ -123,29 +160,17 @@
 
     iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
 
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-direct {v0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;-><init>(Lcom/android/server/knox/dar/DarManagerService$Injector;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    const-string v0, "DarManagerService_SDP"
+    new-instance v0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    const-string/jumbo v2, "prepare Sdp Service"
+    invoke-direct {v0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;-><init>(Lcom/android/server/knox/dar/DarManagerService$Injector;)V
 
-    invoke-static {v0, v2}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v2, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-direct {v2, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;-><init>(Lcom/android/server/knox/dar/DarManagerService$Injector;)V
-
-    iput-object v2, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
+    iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
     const-string p1, "DarManagerService_DUAL_DAR"
 
-    const-string/jumbo v2, "prepare DualDAR DO Service"
+    const-string/jumbo v0, "prepare DualDAR DO Service"
 
-    invoke-static {p1, v2}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {p1, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
     const-class p1, Landroid/app/ActivityManagerInternal;
 
@@ -163,9 +188,11 @@
 
     iput-object p1, p0, Lcom/android/server/knox/dar/DarManagerService;->mEndpointMonitorImpl:Lcom/android/server/knox/zt/devicetrust/EndpointMonitorImpl;
 
-    const-string/jumbo p0, "prepare EndpointMonitor Service"
+    const-string p0, "DarManagerService_SDP"
+
+    const-string/jumbo p1, "prepare EndpointMonitor Service"
 
-    invoke-static {v0, p0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {p0, p1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
     return-void
 .end method
@@ -405,7753 +432,2987 @@
 .end method
 
 .method public final addEngine(Lcom/samsung/android/knox/sdp/core/SdpCreationParam;Ljava/lang/String;Ljava/lang/String;)I
-    .locals 18
-
-    move-object/from16 v0, p1
-
-    const/4 v1, 0x1
+    .locals 0
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    move-result v2
+    const/16 p0, -0xa
 
-    if-eqz v2, :cond_18
+    return p0
+.end method
 
-    move-object/from16 v2, p0
+.method public final allow(Ljava/lang/String;Ljava/lang/String;)I
+    .locals 0
 
-    iget-object v2, v2, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    const/16 p0, -0xa
 
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
+    return p0
+.end method
 
-    move-result v3
+.method public final checkDeviceIntegrity([Ljava/security/cert/Certificate;)Z
+    .locals 3
 
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
+    const/4 v0, 0x0
 
-    move-result v4
+    aget-object p1, p1, v0
 
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
+    check-cast p1, Ljava/security/cert/X509Certificate;
 
-    move-result v5
+    :try_start_0
+    new-instance v1, Lcom/android/server/knox/dar/AttestedCertParser;
 
-    invoke-static {v5}, Landroid/os/UserHandle;->getUserId(I)I
+    invoke-direct {v1, p1}, Lcom/android/server/knox/dar/AttestedCertParser;-><init>(Ljava/security/cert/X509Certificate;)V
 
-    move-result v9
+    iget-object p1, v1, Lcom/android/server/knox/dar/AttestedCertParser;->mKnoxIngetrity:Lcom/android/server/knox/dar/IntegrityStatus;
 
-    const-string/jumbo v5, "SdpManagerImpl"
+    const/4 v1, 0x1
 
-    const-string/jumbo v6, "add engine :: calling by the process %d %d"
+    if-eqz p1, :cond_0
 
-    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    iget v2, p1, Lcom/android/server/knox/dar/IntegrityStatus;->mWarranty:I
 
-    move-result-object v7
+    if-nez v2, :cond_0
 
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    iget p1, p1, Lcom/android/server/knox/dar/IntegrityStatus;->mTrustBoot:I
 
-    move-result-object v8
+    if-nez p1, :cond_0
 
-    filled-new-array {v7, v8}, [Ljava/lang/Object;
+    return v1
 
-    move-result-object v7
+    :cond_0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isEmTokenAllowed()Z
 
-    invoke-static {v6, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    move-result p0
 
-    move-result-object v6
+    if-eqz p0, :cond_1
 
-    invoke-static {v5, v6}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    const-string p0, "DarManagerService"
 
-    const/4 v5, -0x3
+    const-string p1, "Failed in device integrity check. But, EM Token is allowed. Continue - "
 
-    if-eqz v0, :cond_17
+    invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    :try_end_0
+    .catch Ljava/security/cert/CertificateParsingException; {:try_start_0 .. :try_end_0} :catch_0
 
-    invoke-virtual {v0}, Lcom/samsung/android/knox/sdp/core/SdpCreationParam;->getAlias()Ljava/lang/String;
+    return v1
 
-    move-result-object v6
+    :catch_0
+    move-exception p0
 
-    if-eqz v6, :cond_17
+    invoke-virtual {p0}, Ljava/security/cert/CertificateParsingException;->printStackTrace()V
 
-    invoke-virtual {v0}, Lcom/samsung/android/knox/sdp/core/SdpCreationParam;->getAlias()Ljava/lang/String;
+    :cond_1
+    return v0
+.end method
 
-    move-result-object v6
+.method public final checkSystemPermission()V
+    .locals 3
 
-    invoke-virtual {v6}, Ljava/lang/String;->isEmpty()Z
+    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    move-result v6
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    if-nez v6, :cond_17
+    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
 
-    invoke-virtual {v0}, Lcom/samsung/android/knox/sdp/core/SdpCreationParam;->getPrivilegedApps()Ljava/util/ArrayList;
+    move-result v0
 
-    move-result-object v6
+    const/16 v1, 0x3e8
 
-    if-nez v6, :cond_0
+    if-ne v0, v1, :cond_0
 
-    goto/16 :goto_f
+    return-void
 
     :cond_0
-    const-string/jumbo v6, "SdpManagerImpl"
+    const-string v0, "DarManagerService"
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    const-string/jumbo v1, "Require system permission."
+
+    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    const-string/jumbo v8, "add engine :: "
+    new-instance v0, Ljava/lang/SecurityException;
 
-    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    new-instance v1, Ljava/lang/StringBuilder;
 
-    invoke-virtual {v7, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+    const-string/jumbo v2, "Security Exception Occurred in pid["
 
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    move-result-object v7
+    iget-object v2, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    invoke-static {v6, v7}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v0}, Lcom/samsung/android/knox/sdp/core/SdpCreationParam;->getAlias()Ljava/lang/String;
+    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
 
-    move-result-object v7
+    move-result v2
 
-    iget-object v6, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v6}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+    const-string/jumbo v2, "] with uid["
 
-    move-result-object v6
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v6, v4}, Landroid/content/pm/PackageManager;->getPackagesForUid(I)[Ljava/lang/String;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    move-result-object v6
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v8, "SdpManagerImpl"
+    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
 
-    const-string v10, ""
+    move-result p0
 
-    if-nez v6, :cond_2
+    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string/jumbo v6, "getPackage :: Not found with caller "
+    const-string/jumbo p0, "]"
 
-    invoke-static {v4, v6, v8}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    :cond_1
-    move-object v4, v10
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    goto :goto_1
+    move-result-object p0
 
-    :cond_2
-    array-length v11, v6
+    invoke-direct {v0, p0}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
 
-    const/4 v12, 0x0
+    throw v0
+.end method
 
-    :goto_0
-    if-ge v12, v11, :cond_1
+.method public final clearResetPasswordToken(I)Z
+    .locals 6
 
-    aget-object v13, v6, v12
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
 
-    const-string/jumbo v14, "getPackage :: found name for caller "
+    move-result v0
 
-    invoke-static {v4, v14, v8}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    const/4 v1, 0x0
 
-    if-eqz v13, :cond_3
+    if-eqz v0, :cond_2
 
-    invoke-virtual {v10}, Ljava/lang/String;->isEmpty()Z
+    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
 
-    move-result v14
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    if-eqz v14, :cond_3
+    new-instance v2, Ljava/lang/StringBuilder;
 
-    move-object v10, v13
+    const-string v3, "Clear Reset password token for user "
 
-    :cond_3
-    add-int/2addr v12, v1
+    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    goto :goto_0
+    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    :goto_1
-    invoke-static {v7}, Lcom/samsung/android/knox/sdp/SdpUtil;->extractAndroidDefaultUserId(Ljava/lang/String;)I
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result v6
+    move-result-object v2
 
-    if-gez v6, :cond_5
+    const-string/jumbo v3, "VirtualLockImpl"
 
-    const-string/jumbo v6, "SdpManagerImpl"
+    invoke-static {v3, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    const-string/jumbo v8, "custom engine. assign custom engine id"
+    invoke-static {p1}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
 
-    invoke-static {v6, v8}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    move-result v2
 
-    iget-object v8, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
+    if-nez v2, :cond_0
 
-    monitor-enter v8
+    move v0, v1
 
-    const/16 v6, 0x3e8
+    goto :goto_0
 
-    :goto_2
-    :try_start_0
-    iget-object v10, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
+    :cond_0
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    invoke-virtual {v10, v6}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
+    move-result-wide v2
 
-    move-result-object v10
+    :try_start_0
+    iget-object v4, v0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
 
-    if-eqz v10, :cond_4
+    invoke-virtual {v4, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->getLong(I)J
 
-    add-int/2addr v6, v1
+    move-result-wide v4
 
-    goto :goto_2
+    invoke-virtual {v0, p1, v4, v5}, Lcom/android/server/knox/dar/VirtualLockImpl;->clearResetPasswordTokenInternal(IJ)Z
 
-    :cond_4
-    monitor-exit v8
+    move-result v0
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    const-string/jumbo v8, "SdpManagerImpl"
+    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    const-string/jumbo v10, "custom engine : "
+    :goto_0
+    if-eqz v0, :cond_1
 
-    const-string v11, ", id assigned. ["
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
 
-    const-string/jumbo v12, "]"
+    move-result v2
 
-    invoke-static {v6, v10, v7, v11, v12}, Lcom/android/server/AppStateTrackerImpl$MyHandler$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
+    if-eqz v2, :cond_1
 
-    move-result-object v10
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    invoke-static {v8, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :cond_5
-    move v8, v6
+    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
 
-    goto :goto_3
+    move-result v2
 
-    :catchall_0
-    move-exception v0
+    if-eqz v2, :cond_1
 
-    :try_start_1
-    monitor-exit v8
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
 
-    throw v0
+    move-result v2
 
-    :goto_3
-    invoke-virtual {v0}, Lcom/samsung/android/knox/sdp/core/SdpCreationParam;->getFlags()I
+    if-ne v2, p1, :cond_1
 
-    move-result v11
+    iget-boolean p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
 
-    const-string/jumbo v6, "SdpManagerImpl"
+    if-eqz p1, :cond_1
 
-    const-string/jumbo v10, "add engine :: alias : %s, id : %d"
+    iput-boolean v1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
 
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    new-instance p1, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;
 
-    move-result-object v12
+    invoke-direct {p1, p0}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;)V
 
-    filled-new-array {v7, v12}, [Ljava/lang/Object;
+    invoke-static {p1}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
 
-    move-result-object v12
+    :cond_1
+    return v0
 
-    invoke-static {v10, v12}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    :catchall_0
+    move-exception p0
 
-    move-result-object v10
+    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    invoke-static {v6, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    throw p0
 
-    new-instance v6, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
+    :cond_2
+    return v1
+.end method
 
-    const/4 v10, 0x1
+.method public final createEncPkgDir(ILjava/lang/String;)I
+    .locals 0
 
-    const/4 v12, 0x6
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    const/4 v13, 0x0
+    const/4 p0, 0x0
 
-    invoke-direct/range {v6 .. v13}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;-><init>(Ljava/lang/String;IIIIIZ)V
+    return p0
+.end method
 
-    invoke-virtual {v6, v4}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->setPackageName(Ljava/lang/String;)V
+.method public final deleteToeknFromTrusted(Ljava/lang/String;)I
+    .locals 0
 
-    invoke-virtual {v6}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isAndroidDefaultEngine()Z
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    move-result v4
+    const/16 p0, -0xa
 
-    if-eqz v4, :cond_6
+    return p0
+.end method
 
-    const-string/jumbo v0, "SdpManagerImpl"
+.method public final disallow(Ljava/lang/String;Ljava/lang/String;)I
+    .locals 0
 
-    const-string/jumbo v1, "add engine :: not supported anymore to "
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    invoke-static {v1, v7, v0}, Lcom/android/server/StorageManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
+    const/16 p0, -0xa
 
-    return v5
+    return p0
+.end method
 
-    :cond_6
-    invoke-static/range {p2 .. p2}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
+.method public doesSpecificKeyExist(Ljava/lang/String;I)Z
+    .locals 2
 
-    move-result v4
+    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
 
-    const/4 v5, -0x1
+    move-result v0
 
-    if-eqz v4, :cond_7
+    if-eqz v0, :cond_0
 
-    return v5
+    const/4 p0, 0x0
 
-    :cond_7
-    invoke-virtual {v6}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isMdfpp()Z
+    return p0
 
-    move-result v4
+    :cond_0
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
 
-    const/16 v9, 0x20
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    if-eqz v4, :cond_9
+    invoke-static {p2, p1}, Lcom/android/server/knox/dar/KeyProtector;->attach(ILjava/lang/String;)Ljava/lang/String;
 
-    invoke-static/range {p3 .. p3}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
+    move-result-object p0
 
-    move-result v4
+    invoke-static {p0}, Lcom/android/server/knox/dar/KeyProtector;->checkSecretKey(Ljava/lang/String;)Z
 
-    if-nez v4, :cond_8
+    move-result p1
 
-    invoke-virtual/range {p3 .. p3}, Ljava/lang/String;->length()I
+    if-eqz p1, :cond_1
 
-    move-result v4
+    const-string p2, "Key exists in keystore("
 
-    if-ge v4, v9, :cond_9
+    const-string v0, ")"
 
-    :cond_8
-    const/4 v0, -0x2
+    const-string v1, "KeyProtector"
 
-    return v0
+    invoke-static {p2, p0, v0, v1}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
 
-    :cond_9
-    iget-object v4, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
+    :cond_1
+    return p1
+.end method
 
-    monitor-enter v4
+.method public final dump(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
+    .locals 3
 
-    :try_start_2
-    invoke-virtual {v2, v7}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
+    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mContext:Landroid/content/Context;
 
-    move-result-object v7
+    const-string v1, "DarManagerService"
 
-    if-nez v7, :cond_16
+    invoke-static {v0, v1, p2}, Lcom/android/internal/util/DumpUtils;->checkDumpPermission(Landroid/content/Context;Ljava/lang/String;Ljava/io/PrintWriter;)Z
 
-    invoke-virtual {v2, v8}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
+    move-result v0
 
-    move-result-object v7
+    if-nez v0, :cond_0
 
-    if-eqz v7, :cond_a
+    goto/16 :goto_7
 
-    goto/16 :goto_d
+    :cond_0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    :cond_a
-    monitor-exit v4
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_3
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
 
-    invoke-virtual {v6}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isMdfpp()Z
+    move-result v0
 
-    move-result v4
+    if-eqz v0, :cond_1
 
-    if-eqz v4, :cond_b
+    const-string/jumbo v0, "dualdar_dump"
 
-    const-string/jumbo v4, "UTF-8"
+    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-static {v4}, Ljava/nio/charset/Charset;->forName(Ljava/lang/String;)Ljava/nio/charset/Charset;
+    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    move-result-object v4
+    new-instance v1, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;
 
-    move-object/from16 v7, p3
+    invoke-direct {v1, p0, p1, p2, p3}, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/knox/dar/DarManagerService;Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
 
-    invoke-virtual {v7, v4}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    move-result-object v4
+    invoke-static {v1}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
 
-    :goto_4
-    move-object v15, v4
+    :cond_1
+    if-eqz p3, :cond_8
 
-    goto :goto_5
+    array-length p0, p3
 
-    :cond_b
-    sget-object v4, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
+    if-lez p0, :cond_8
 
-    invoke-virtual {v4, v9}, Ljava/security/SecureRandom;->generateSeed(I)[B
+    invoke-static {p3}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
 
-    move-result-object v4
+    move-result-object p0
 
-    goto :goto_4
+    const-string p1, "-a"
 
-    :goto_5
-    sget-object v4, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
+    invoke-interface {p0, p1}, Ljava/util/List;->contains(Ljava/lang/Object;)Z
 
-    invoke-virtual {v4, v9}, Ljava/security/SecureRandom;->generateSeed(I)[B
+    move-result p0
 
-    move-result-object v4
+    if-nez p0, :cond_2
 
-    invoke-virtual {v6}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
+    invoke-static {p3}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
 
-    move-result v11
+    move-result-object p0
 
-    const-string/jumbo v7, "SdpManagerImpl"
+    const-string/jumbo p1, "sdplog"
 
-    const-string/jumbo v8, "try to add engine internal for virtual user : "
+    invoke-interface {p0, p1}, Ljava/util/List;->contains(Ljava/lang/Object;)Z
 
-    invoke-static {v11, v8, v7}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    move-result p0
 
-    iget-object v7, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
+    if-eqz p0, :cond_8
 
-    invoke-virtual {v7, v11}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->clean(I)V
+    :cond_2
+    const-string/jumbo p0, "sdplog_dump"
 
-    iget-object v7, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
+    invoke-virtual {p2, p0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v7, v11}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->clearLock(I)V
+    const-string p0, "-------------------------------------------------- START DUMP --------------------------------------------------"
 
-    iget-object v10, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
+    invoke-virtual {p2, p0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
 
-    iget-object v7, v10, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->this$0:Ljava/lang/Object;
+    sget-object p0, Lcom/android/server/knox/dar/sdp/SDPLogger;->mLogger:Lcom/android/server/knox/dar/sdp/SDPLogger$Logger;
 
-    check-cast v7, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    const-string p0, "Failed to dump: "
 
-    invoke-static {v7, v11}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$misVirtualUserId(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)Z
+    sget-object p1, Lcom/android/server/knox/dar/sdp/SDPLogFile;->FILE_LOCK:Ljava/util/concurrent/locks/Lock;
 
-    move-result v8
+    check-cast p1, Ljava/util/concurrent/locks/ReentrantLock;
 
-    const-wide/16 v16, 0x0
+    invoke-virtual {p1}, Ljava/util/concurrent/locks/ReentrantLock;->tryLock()Z
 
-    if-nez v8, :cond_d
+    move-result p1
 
-    :cond_c
-    :goto_6
-    move-wide/from16 v8, v16
+    const-string/jumbo p3, "SDPLogFile"
 
-    goto/16 :goto_9
+    if-nez p1, :cond_3
 
-    :cond_d
-    invoke-virtual {v10, v11}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->clearLock(I)V
+    const-string p0, "Failed to dump: Maybe target file is already being used..."
 
-    invoke-static {v11}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    invoke-static {p3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result v8
+    const-string/jumbo p0, "Target file busy"
 
-    if-nez v8, :cond_e
+    invoke-virtual {p2, p0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
 
     goto :goto_6
 
-    :cond_e
-    new-instance v8, Ljava/io/File;
-
-    new-instance v9, Ljava/io/File;
-
-    invoke-static {}, Landroid/os/Environment;->getDataSystemDirectory()Ljava/io/File;
+    :cond_3
+    const/4 p1, 0x0
 
-    move-result-object v12
+    :try_start_0
+    new-instance v0, Ljava/io/RandomAccessFile;
 
-    const-string/jumbo v13, "users"
+    const-string v1, "/data/log/sdp_log"
 
-    invoke-direct {v9, v12, v13}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
+    const-string/jumbo v2, "r"
 
-    invoke-static {v11}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
+    invoke-direct {v0, v1, v2}, Ljava/io/RandomAccessFile;-><init>(Ljava/lang/String;Ljava/lang/String;)V
+    :try_end_0
+    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
 
-    move-result-object v12
+    :try_start_1
+    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLogFile;->check(Ljava/io/RandomAccessFile;)V
+    :try_end_1
+    .catch Ljava/lang/SecurityException; {:try_start_1 .. :try_end_1} :catch_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    invoke-direct {v8, v9, v12}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
+    const-wide/16 v1, 0x11
 
-    invoke-virtual {v8}, Ljava/io/File;->exists()Z
+    :try_start_2
+    invoke-virtual {v0, v1, v2}, Ljava/io/RandomAccessFile;->seek(J)V
 
-    move-result v9
+    const/4 p0, 0x0
 
-    const-string/jumbo v12, "SdpManagerImpl.VirtualLock"
+    :goto_0
+    invoke-virtual {v0}, Ljava/io/RandomAccessFile;->readLine()Ljava/lang/String;
 
-    if-nez v9, :cond_f
+    move-result-object p3
 
-    invoke-virtual {v8}, Ljava/io/File;->mkdir()Z
+    if-eqz p3, :cond_5
 
-    move-result v9
+    add-int/lit8 v1, p0, 0x1
 
-    if-nez v9, :cond_f
+    const/16 v2, 0x1770
 
-    const-string/jumbo v5, "prepare - failed to create sp state path for user "
+    if-lt p0, v2, :cond_4
 
-    invoke-static {v11, v5, v12}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    const-string p1, "Dump line count reached to the limit: 6000"
 
-    goto :goto_6
+    goto :goto_1
 
-    :cond_f
-    invoke-virtual {v8}, Ljava/io/File;->getPath()Ljava/lang/String;
+    :catchall_0
+    move-exception p0
 
-    move-result-object v8
+    goto :goto_2
 
-    const/16 v9, 0x1f9
+    :cond_4
+    invoke-virtual {p2, p3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    invoke-static {v8, v9, v5, v5}, Landroid/os/FileUtils;->setPermissions(Ljava/lang/String;III)I
+    move p0, v1
 
-    new-instance v5, Ljava/lang/StringBuilder;
+    goto :goto_0
 
-    const-string v8, "Engine info initialized for engine "
+    :cond_5
+    :goto_1
+    :try_start_3
+    invoke-virtual {v0}, Ljava/io/RandomAccessFile;->close()V
+    :try_end_3
+    .catch Ljava/io/IOException; {:try_start_3 .. :try_end_3} :catch_0
 
-    invoke-direct {v5, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    goto :goto_5
 
-    invoke-virtual {v5, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    :catch_0
+    move-exception p0
 
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    goto :goto_4
 
-    move-result-object v5
+    :catch_1
+    move-exception v1
 
-    const/4 v8, 0x0
+    :try_start_4
+    new-instance v2, Ljava/lang/StringBuilder;
 
-    invoke-static {v8, v5}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-direct {v2, p0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget-object v5, v7, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
+    invoke-virtual {v1}, Ljava/lang/SecurityException;->getMessage()Ljava/lang/String;
 
-    invoke-virtual {v5, v11}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->destroy(I)V
+    move-result-object p0
 
-    invoke-static {v1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
+    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v9
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    const-string/jumbo v13, "smk_ver"
+    move-result-object p1
 
-    invoke-virtual {v5, v11, v13, v9}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
+    if-eqz p1, :cond_6
 
-    new-instance v5, Ljava/lang/StringBuilder;
+    invoke-static {p3, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    const-string/jumbo v9, "Set reset password token for user "
+    :cond_6
+    new-instance p0, Ljava/io/IOException;
 
-    invoke-direct {v5, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {p0, p1}, Ljava/io/IOException;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v5, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    throw p0
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_0
 
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    :goto_2
+    :try_start_5
+    invoke-virtual {v0}, Ljava/io/RandomAccessFile;->close()V
+    :try_end_5
+    .catchall {:try_start_5 .. :try_end_5} :catchall_1
 
-    move-result-object v5
+    goto :goto_3
 
-    invoke-static {v12, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    :catchall_1
+    move-exception p3
 
-    invoke-static {v11}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    :try_start_6
+    invoke-virtual {p0, p3}, Ljava/lang/Throwable;->addSuppressed(Ljava/lang/Throwable;)V
 
-    move-result v5
+    :goto_3
+    throw p0
+    :try_end_6
+    .catch Ljava/io/IOException; {:try_start_6 .. :try_end_6} :catch_0
 
-    if-nez v5, :cond_10
+    :goto_4
+    invoke-virtual {p0}, Ljava/io/IOException;->printStackTrace()V
 
-    move-object v5, v12
+    :goto_5
+    sget-object p0, Lcom/android/server/knox/dar/sdp/SDPLogFile;->FILE_LOCK:Ljava/util/concurrent/locks/Lock;
 
-    move-wide/from16 v12, v16
+    check-cast p0, Ljava/util/concurrent/locks/ReentrantLock;
 
-    :goto_7
-    move-object/from16 v14, p2
+    invoke-virtual {p0}, Ljava/util/concurrent/locks/ReentrantLock;->unlock()V
 
-    goto :goto_8
+    if-eqz p1, :cond_7
 
-    :cond_10
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
+    invoke-virtual {p2, p1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
 
-    move-result-wide v13
+    :cond_7
+    invoke-virtual {p2}, Ljava/io/PrintWriter;->println()V
 
-    :try_start_3
-    iget-object v5, v7, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
+    :goto_6
+    const-string p0, "-------------------------------------------------- END DUMP --------------------------------------------------"
 
-    invoke-virtual {v5, v15, v11, v8}, Lcom/android/internal/widget/LockPatternUtils;->addEscrowToken([BILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
+    invoke-virtual {p2, p0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
 
-    move-result-wide v7
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_2
+    :cond_8
+    :goto_7
+    return-void
+.end method
 
-    invoke-static {v13, v14}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+.method public final exists(Ljava/lang/String;)I
+    .locals 0
 
-    move-object v5, v12
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    move-wide v12, v7
+    const/16 p0, -0xa
 
-    goto :goto_7
+    return p0
+.end method
 
-    :goto_8
-    invoke-virtual/range {v10 .. v15}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->setPasswordWithToken(IJLjava/lang/String;[B)Z
+.method public generateAndSaveSpecificKey(Ljava/lang/String;I)Z
+    .locals 2
 
-    move-result v7
+    sget-object v0, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
 
-    move-wide v8, v12
+    const/16 v1, 0x20
 
-    if-eqz v7, :cond_c
+    invoke-virtual {v0, v1}, Ljava/security/SecureRandom;->generateSeed(I)[B
 
-    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    move-result-object v0
 
-    move-result-object v7
+    :try_start_0
+    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
 
-    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    move-result v1
 
-    move-result-object v10
+    if-nez v1, :cond_0
 
-    filled-new-array {v7, v10}, [Ljava/lang/Object;
+    invoke-virtual {p0, v0, p1, p2}, Lcom/android/server/knox/dar/DarManagerService;->saveSpecificKeyViaProtector([BLjava/lang/String;I)Z
 
-    move-result-object v7
+    move-result p0
 
-    const-string/jumbo v10, "establish - sp based credential established for user %d with %d"
+    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-static {v10, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    if-eqz p0, :cond_0
 
-    move-result-object v7
+    const/4 p0, 0x1
 
-    invoke-static {v5, v7}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    goto :goto_0
 
-    :goto_9
-    iget-object v5, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
+    :catchall_0
+    move-exception p0
 
-    move-object/from16 v14, p2
+    goto :goto_1
 
-    invoke-virtual {v5, v11, v14}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->checkPassword(ILjava/lang/String;)Lcom/android/internal/widget/VerifyCredentialResponse;
+    :cond_0
+    const/4 p0, 0x0
 
-    move-result-object v5
+    :goto_0
+    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
 
-    invoke-virtual {v5}, Lcom/android/internal/widget/VerifyCredentialResponse;->getSecret()[B
+    return p0
 
-    move-result-object v5
+    :goto_1
+    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
 
-    invoke-static {v5}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
+    throw p0
+.end method
 
-    move-result v7
+.method public final getAvailableUserId()I
+    .locals 1
 
-    if-eqz v7, :cond_11
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
 
-    goto :goto_a
+    move-result v0
 
-    :cond_11
-    sget-object v7, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
+    if-eqz v0, :cond_0
 
-    const/16 v7, 0x8
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
 
-    invoke-static {v7}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/VirtualLockImpl;->getAvailableUserId()I
 
-    move-result-object v7
+    move-result p0
 
-    sget-object v10, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
+    return p0
 
-    invoke-virtual {v7, v10}, Ljava/nio/ByteBuffer;->order(Ljava/nio/ByteOrder;)Ljava/nio/ByteBuffer;
+    :cond_0
+    const/16 p0, -0x2710
 
-    invoke-virtual {v7, v8, v9}, Ljava/nio/ByteBuffer;->putLong(J)Ljava/nio/ByteBuffer;
+    return p0
+.end method
 
-    invoke-virtual {v7}, Ljava/nio/ByteBuffer;->array()[B
+.method public final getBlockedClearablePackages(I)Ljava/util/List;
+    .locals 3
 
-    move-result-object v7
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
 
-    iget-object v8, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
+    move-result v0
 
-    const-string/jumbo v9, "SdpTokenHandle"
+    if-eqz v0, :cond_2
 
-    invoke-virtual {v8}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    invoke-static {v11, v9, v7}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
+    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    move-result v7
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v7}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
+    const-string/jumbo v1, "getBlockedClearablePackages"
 
-    invoke-static {v7}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+    invoke-static {v1}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
 
-    move-result-object v7
+    new-instance v1, Ljava/util/ArrayList;
 
-    invoke-static {v7}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
+    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V
 
-    move-result v7
+    const-string/jumbo v2, "pkg_blocked_clearable"
 
-    if-eqz v7, :cond_12
+    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
 
-    :goto_a
-    const/16 v0, -0xe
+    invoke-virtual {v0, p1, v2}, Lcom/android/server/knox/dar/DarDatabaseCache;->getInternal(ILjava/lang/String;)Ljava/lang/String;
 
-    goto :goto_b
+    move-result-object p1
 
-    :cond_12
-    invoke-static {v6, v5}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->addEngineNative(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;[B)I
+    const-string/jumbo v0, "empty"
 
-    move-result v7
+    if-eqz p1, :cond_0
 
-    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    goto :goto_0
 
-    move-result-object v8
+    :cond_0
+    move-object p1, v0
 
-    invoke-static {v8}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
+    :goto_0
+    invoke-virtual {p1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v8
+    move-result v0
 
-    if-eqz v8, :cond_13
+    if-nez v0, :cond_1
 
-    move v0, v7
+    const-string v0, ","
 
-    goto :goto_b
+    invoke-virtual {p1, v0}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;
 
-    :cond_13
-    iget-object v7, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
+    move-result-object p1
 
-    invoke-virtual {v0}, Lcom/samsung/android/knox/sdp/core/SdpCreationParam;->getPrivilegedApps()Ljava/util/ArrayList;
+    invoke-static {p1}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
 
-    move-result-object v0
+    move-result-object p1
 
-    invoke-virtual {v7, v3, v6, v0}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->addPolicy(ILcom/samsung/android/knox/sdp/core/SdpEngineInfo;Ljava/util/List;)I
+    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z
 
-    move-result v0
+    :cond_1
+    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mNonClearablePackages:Ljava/util/List;
 
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-virtual {v1, p0}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z
 
-    move-result-object v3
+    return-object v1
 
-    invoke-static {v3}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
+    :cond_2
+    const/4 p0, 0x0
 
-    :goto_b
-    if-eqz v0, :cond_14
+    return-object p0
+.end method
 
-    const-string/jumbo v1, "SdpManagerImpl"
+.method public final getEngineInfo(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
+    .locals 0
 
-    const-string/jumbo v3, "add engine :: Failed with error code "
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    invoke-static {v0, v3, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    const/4 p0, 0x0
 
-    iget-object v1, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
+    return-object p0
+.end method
 
-    invoke-virtual {v1, v11}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->clean(I)V
+.method public final getInnerAuthUserId(I)I
+    .locals 1
 
-    iget-object v1, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
 
-    invoke-virtual {v1, v11}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->clearLock(I)V
+    move-result v0
 
-    iget-object v1, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
+    if-eqz v0, :cond_0
 
-    invoke-virtual {v1, v6}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->removePolicy(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    goto :goto_c
+    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
 
-    :cond_14
-    const-string/jumbo v3, "SdpManagerImpl"
+    move-result p0
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    return p0
 
-    const-string/jumbo v8, "add engine - Sucessfully done with "
+    :cond_0
+    const/16 p0, -0x2710
 
-    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    return p0
+.end method
 
-    invoke-virtual {v6}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->toString()Ljava/lang/String;
+.method public final getMainUserId(I)I
+    .locals 2
 
-    move-result-object v8
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
 
-    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    move-result v0
 
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    const/16 v1, -0x2710
 
-    move-result-object v7
+    if-eqz v0, :cond_0
 
-    invoke-static {v3, v7}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    invoke-virtual {v6, v1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->setState(I)V
+    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    iget-object v1, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
 
-    monitor-enter v1
+    const-string/jumbo v0, "ddar.inner.main.userid"
 
-    :try_start_4
-    iget-object v3, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v3, v11, v6}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
+    :try_start_0
+    invoke-virtual {p0, p1, v0}, Lcom/android/server/knox/dar/DarDatabaseCache;->getInternal(ILjava/lang/String;)Ljava/lang/String;
 
-    iget-object v3, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
+    move-result-object p0
 
-    invoke-static {v3, v6}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mstoreEngineInfoLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
+    if-eqz p0, :cond_0
 
-    iget-object v3, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
+    invoke-static {p0}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
 
-    invoke-static {v3}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mupdateEngineListLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;)V
-
-    monitor-exit v1
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
+    move-result p0
+    :try_end_0
+    .catch Ljava/lang/NumberFormatException; {:try_start_0 .. :try_end_0} :catch_0
 
-    iget-object v1, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
+    return p0
 
-    const-string/jumbo v3, "SdpSessionKey"
+    :catch_0
+    :cond_0
+    return v1
+.end method
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+.method public final getPackageListForDualDarPolicy(Ljava/lang/String;)Ljava/util/List;
+    .locals 1
 
-    invoke-static {v11, v3, v4}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
 
-    iget-object v1, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
+    move-result v0
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    if-eqz v0, :cond_1
 
-    const-string v1, "KeyProtector"
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    const-string/jumbo v3, "Wrong input parameter..."
+    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    invoke-static {v1, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v6}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isMinor()Z
+    const-string/jumbo p0, "getPackageListForDualDarPolicy"
 
-    move-result v1
+    invoke-static {p0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
 
-    if-eqz v1, :cond_15
+    :try_start_0
+    invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
 
-    iget-object v1, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
+    move-result-object p0
 
-    const-string/jumbo v2, "SdpResetToken"
+    if-eqz p0, :cond_0
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-interface {p0, p1}, Landroid/content/pm/IPackageManager;->getPackageListForDualDarPolicy(Ljava/lang/String;)Ljava/util/List;
 
-    invoke-static {v11, v2, v15}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
+    move-result-object p0
+    :try_end_0
+    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
 
-    :cond_15
-    :goto_c
-    filled-new-array {v5, v4, v15}, [Ljava/lang/Object;
+    return-object p0
 
-    move-result-object v1
+    :catch_0
+    move-exception p0
 
-    invoke-static {v1}, Lcom/android/server/knox/dar/SecureUtil;->clearAll([Ljava/lang/Object;)V
+    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
 
-    return v0
+    :cond_0
+    new-instance p0, Ljava/util/ArrayList;
 
-    :catchall_1
-    move-exception v0
+    invoke-direct {p0}, Ljava/util/ArrayList;-><init>()V
 
-    :try_start_5
-    monitor-exit v1
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_1
+    return-object p0
 
-    throw v0
+    :cond_1
+    const/4 p0, 0x0
 
-    :catchall_2
-    move-exception v0
+    return-object p0
+.end method
 
-    invoke-static {v13, v14}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+.method public final getPasswordMinimumLengthForInner()I
+    .locals 1
 
-    throw v0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
 
-    :catchall_3
-    move-exception v0
+    move-result v0
 
-    goto :goto_e
+    if-eqz v0, :cond_0
 
-    :cond_16
-    :goto_d
-    :try_start_6
-    const-string/jumbo v0, "SdpManagerImpl"
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    const-string/jumbo v1, "add engine :: failed to create engine due to pre-existing engine"
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getPasswordMinimumLengthForInner()I
 
-    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    move-result p0
 
-    const/4 v0, -0x4
+    return p0
 
-    monitor-exit v4
+    :cond_0
+    const/4 p0, 0x0
 
-    return v0
+    return p0
+.end method
 
-    :goto_e
-    monitor-exit v4
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_3
+.method public final getReservedUserIdForSystem()I
+    .locals 1
 
-    throw v0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
 
-    :cond_17
-    :goto_f
-    const-string/jumbo v0, "SdpManagerImpl"
+    move-result v0
 
-    const-string/jumbo v1, "add engine :: failed to create engine due to invalid parameters"
+    if-eqz v0, :cond_0
 
-    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
 
-    return v5
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/VirtualLockImpl;->getReservedUserIdForSystem()I
 
-    :cond_18
-    const/16 v0, -0xa
+    move-result p0
 
-    return v0
-.end method
+    return p0
 
-.method public final allow(Ljava/lang/String;Ljava/lang/String;)I
-    .locals 2
+    :cond_0
+    const/16 p0, -0x2710
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
+    return p0
+.end method
 
-    move-result v0
+.method public getSpecificKeyViaProtector(Ljava/lang/String;I)[B
+    .locals 3
 
-    if-eqz v0, :cond_4
+    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    monitor-enter v0
+    move-result-wide v0
 
     :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v1
+    iget-object v2, p0, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
 
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
+    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    if-nez v1, :cond_0
+    invoke-static {p2, p1}, Lcom/android/server/knox/dar/KeyProtector;->release(ILjava/lang/String;)[B
 
-    const/4 p0, -0x5
+    move-result-object p1
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    return p0
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    :cond_0
-    new-instance v0, Lcom/samsung/android/knox/sdp/core/SdpDomain;
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-direct {v0, p1, p2}, Lcom/samsung/android/knox/sdp/core/SdpDomain;-><init>(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
+    return-object p1
 
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
+    :catchall_0
+    move-exception p1
 
-    move-result p1
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    move-result p2
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    invoke-virtual {p0, p1, p2, v1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->isEngineOwner(IILcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
+    throw p1
+.end method
 
-    move-result p1
+.method public final getSupportedSDKVersion()D
+    .locals 2
 
-    if-eqz p1, :cond_3
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMapLock:Ljava/lang/Object;
+    const-wide/16 v0, 0x0
 
-    monitor-enter p1
+    return-wide v0
+.end method
 
-    :try_start_1
-    invoke-virtual {v1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
+.method public final getUserManager()Landroid/os/UserManager;
+    .locals 2
 
-    move-result-object p2
+    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mUserManager:Landroid/os/UserManager;
 
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->getSdpPolicyLocked(Ljava/lang/String;)Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;
+    if-nez v0, :cond_0
 
-    move-result-object p2
+    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mContext:Landroid/content/Context;
 
-    if-eqz p2, :cond_1
+    const-string/jumbo v1, "user"
 
-    invoke-virtual {p2, v0}, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->addPrivilegedApp(Lcom/samsung/android/knox/sdp/core/SdpDomain;)Z
+    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
 
-    move-result v0
+    move-result-object v0
 
-    if-eqz v0, :cond_1
+    check-cast v0, Landroid/os/UserManager;
 
-    const/4 v0, 0x0
+    iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mUserManager:Landroid/os/UserManager;
 
-    goto :goto_0
+    :cond_0
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mUserManager:Landroid/os/UserManager;
 
-    :catchall_0
-    move-exception p0
+    return-object p0
+.end method
 
-    goto :goto_1
+.method public handleUnlockSecureFolderWithToken(I)V
+    .locals 5
 
-    :cond_1
-    const/16 v0, -0x63
+    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isSecureFolderId(I)Z
 
-    :goto_0
-    monitor-exit p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    move-result v0
 
-    if-nez v0, :cond_2
+    if-nez v0, :cond_0
 
-    invoke-virtual {p0, v1, p2}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->updatePolicy(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;)I
+    return-void
 
-    move-result p0
+    :cond_0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
 
-    return p0
+    const-string/jumbo v0, "SdpTokenHandle"
 
-    :cond_2
-    return v0
+    invoke-virtual {p0, v0, p1}, Lcom/android/server/knox/dar/DarManagerService;->getSpecificKeyViaProtector(Ljava/lang/String;I)[B
 
-    :goto_1
-    :try_start_2
-    monitor-exit p1
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+    move-result-object v0
 
-    throw p0
+    const-string v1, "DarManagerService"
 
-    :cond_3
-    const/4 p0, -0x7
+    if-eqz v0, :cond_1
 
-    return p0
+    sget-object v2, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
 
-    :catchall_1
-    move-exception p0
+    const/16 v2, 0x8
 
-    :try_start_3
-    monitor-exit v0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    invoke-static {v2}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
 
-    throw p0
+    move-result-object v2
 
-    :cond_4
-    const/16 p0, -0xa
+    sget-object v3, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
 
-    return p0
-.end method
+    invoke-virtual {v2, v3}, Ljava/nio/ByteBuffer;->order(Ljava/nio/ByteOrder;)Ljava/nio/ByteBuffer;
 
-.method public final checkDeviceIntegrity([Ljava/security/cert/Certificate;)Z
-    .locals 3
+    invoke-virtual {v2, v0}, Ljava/nio/ByteBuffer;->put([B)Ljava/nio/ByteBuffer;
 
-    const/4 v0, 0x0
+    invoke-virtual {v2}, Ljava/nio/ByteBuffer;->flip()Ljava/nio/Buffer;
 
-    aget-object p1, p1, v0
+    invoke-virtual {v2}, Ljava/nio/ByteBuffer;->getLong()J
 
-    check-cast p1, Ljava/security/cert/X509Certificate;
+    move-result-wide v2
 
-    :try_start_0
-    new-instance v1, Lcom/android/server/knox/dar/AttestedCertParser;
+    goto :goto_0
 
-    invoke-direct {v1, p1}, Lcom/android/server/knox/dar/AttestedCertParser;-><init>(Ljava/security/cert/X509Certificate;)V
+    :cond_1
+    const-string/jumbo v0, "get SecureFolder Token Handle Failed"
 
-    iget-object p1, v1, Lcom/android/server/knox/dar/AttestedCertParser;->mKnoxIngetrity:Lcom/android/server/knox/dar/IntegrityStatus;
+    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/4 v1, 0x1
+    const-wide/16 v2, 0x0
 
-    if-eqz p1, :cond_0
+    :goto_0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
 
-    iget v2, p1, Lcom/android/server/knox/dar/IntegrityStatus;->mWarranty:I
+    const-string/jumbo v0, "SdpResetToken"
 
-    if-nez v2, :cond_0
+    invoke-virtual {p0, v0, p1}, Lcom/android/server/knox/dar/DarManagerService;->getSpecificKeyViaProtector(Ljava/lang/String;I)[B
 
-    iget p1, p1, Lcom/android/server/knox/dar/IntegrityStatus;->mTrustBoot:I
+    move-result-object v0
 
-    if-nez p1, :cond_0
+    iget-object v4, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    return v1
+    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :cond_0
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isEmTokenAllowed()Z
+    const-class v4, Lcom/android/internal/widget/LockSettingsInternal;
 
-    move-result p0
+    invoke-static {v4}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
 
-    if-eqz p0, :cond_1
+    move-result-object v4
 
-    const-string p0, "DarManagerService"
+    check-cast v4, Lcom/android/internal/widget/LockSettingsInternal;
 
-    const-string p1, "Failed in device integrity check. But, EM Token is allowed. Continue - "
+    if-eqz v4, :cond_2
 
-    invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    :try_start_0
+    invoke-virtual {v4, v2, v3, v0, p1}, Lcom/android/internal/widget/LockSettingsInternal;->unlockUserWithToken(J[BI)Z
     :try_end_0
-    .catch Ljava/security/cert/CertificateParsingException; {:try_start_0 .. :try_end_0} :catch_0
+    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
 
-    return v1
+    goto :goto_1
 
     :catch_0
-    move-exception p0
+    move-exception v2
 
-    invoke-virtual {p0}, Ljava/security/cert/CertificateParsingException;->printStackTrace()V
+    const-string/jumbo v3, "Unexpected failure while unlock secure folder with token"
 
-    :cond_1
-    return v0
-.end method
+    invoke-static {v2, v3, v1}, Lcom/android/server/DirEncryptServiceHelper$$ExternalSyntheticOutline0;->m(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
 
-.method public final checkSystemPermission()V
-    .locals 3
+    :cond_2
+    :goto_1
+    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
+    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;
 
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->getUserManager()Landroid/os/UserManager;
 
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
+    move-result-object p0
 
-    move-result v0
+    invoke-virtual {p0, p1}, Landroid/os/UserManager;->isUserUnlocked(I)Z
 
-    const/16 v1, 0x3e8
+    move-result p0
 
-    if-ne v0, v1, :cond_0
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    return-void
+    const-string/jumbo v2, "SecureFolder user "
 
-    :cond_0
-    const-string v0, "DarManagerService"
+    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    const-string/jumbo v1, "Require system permission."
+    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    const-string p1, " has been unlocked [ res : "
 
-    new-instance v0, Ljava/lang/SecurityException;
+    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    new-instance v1, Ljava/lang/StringBuilder;
+    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    const-string/jumbo v2, "Security Exception Occurred in pid["
+    const-string p0, " ]"
 
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-object v2, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    move-result-object p0
 
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
+    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result v2
+    return-void
+.end method
 
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+.method public final isDarSupported()Z
+    .locals 0
 
-    const-string/jumbo v2, "] with uid["
+    const/4 p0, 0x1
 
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    return p0
+.end method
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
+.method public final isDefaultPathUser(I)Z
+    .locals 0
 
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
+    const/4 p0, 0x0
 
-    move-result p0
+    return p0
+.end method
 
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+.method public final isDeviceRootKeyInstalled()Z
+    .locals 10
 
-    const-string/jumbo p0, "]"
+    const-string/jumbo v0, "ro.hardware.virtual_device"
 
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    move-result-object v0
 
-    move-result-object p0
+    const-string v1, "1"
 
-    invoke-direct {v0, p0}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
+    invoke-virtual {v1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    throw v0
-.end method
+    move-result v0
 
-.method public final clearResetPasswordToken(I)Z
-    .locals 6
+    const/4 v1, 0x1
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
+    const-string v2, "DarManagerService"
 
-    move-result v0
+    if-eqz v0, :cond_0
 
-    const/4 v1, 0x0
+    const-string/jumbo p0, "Will be Failed in device integrity check. But, running on VirtualDevice. Continue .. "
 
-    if-eqz v0, :cond_2
+    invoke-static {v2, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
+    return v1
 
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    :cond_0
+    const-string/jumbo v0, "ro.security.keystore.keytype"
 
-    new-instance v2, Ljava/lang/StringBuilder;
+    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    const-string v3, "Clear Reset password token for user "
+    move-result-object v0
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    const-string/jumbo v3, "sakm"
 
-    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v3}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z
 
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    move-result v0
 
-    move-result-object v2
+    const/4 v3, 0x0
 
-    const-string/jumbo v3, "VirtualLockImpl"
+    if-eqz v0, :cond_4
 
-    invoke-static {v3, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    const-string v0, "Check SAK instead for JDM with GRDM or KnoxVault2"
 
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
+    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result v2
+    const-string v0, "KnoxTestKey"
 
-    if-nez v2, :cond_0
+    const-string v4, "Failed while check SAK : "
 
-    move v0, v1
+    iget-object v5, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    goto :goto_0
+    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :cond_0
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v2
+    move-result-wide v5
 
     :try_start_0
-    iget-object v4, v0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    invoke-virtual {v4, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->getLong(I)J
+    new-instance v7, Lcom/samsung/android/security/keystore/AttestationUtils;
 
-    move-result-wide v4
+    invoke-direct {v7}, Lcom/samsung/android/security/keystore/AttestationUtils;-><init>()V
 
-    invoke-virtual {v0, p1, v4, v5}, Lcom/android/server/knox/dar/VirtualLockImpl;->clearResetPasswordTokenInternal(IJ)Z
+    sget-object v8, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
 
-    move-result v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    const/16 v9, 0x8
 
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-virtual {v8, v9}, Ljava/security/SecureRandom;->generateSeed(I)[B
 
-    :goto_0
-    if-eqz v0, :cond_1
+    move-result-object v8
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
+    invoke-virtual {v7, v0, v8}, Lcom/samsung/android/security/keystore/AttestationUtils;->generateKeyPair(Ljava/lang/String;[B)Ljava/security/KeyPair;
 
-    move-result v2
+    move-result-object v7
 
-    if-eqz v2, :cond_1
+    if-eqz v7, :cond_1
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
+    move v3, v1
 
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    :cond_1
+    if-eqz v3, :cond_2
 
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
+    const-string v7, "Generated keypair is protected by SAK"
 
-    move-result v2
+    invoke-static {v2, v7}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    if-eqz v2, :cond_1
+    invoke-static {v0}, Lcom/samsung/android/security/keystore/AttestationUtils;->deleteKey(Ljava/lang/String;)V
+    :try_end_0
+    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
+    goto :goto_0
 
-    move-result v2
+    :catchall_0
+    move-exception v0
 
-    if-ne v2, p1, :cond_1
+    goto :goto_4
 
-    iget-boolean p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
+    :catch_0
+    move-exception v0
 
-    if-eqz p1, :cond_1
+    goto :goto_1
 
-    iput-boolean v1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
+    :cond_2
+    :goto_0
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    new-instance p1, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-direct {p1, p0}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;)V
+    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    invoke-static {p1}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
+    goto :goto_3
 
-    :cond_1
-    return v0
+    :goto_1
+    :try_start_1
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isEmTokenAllowed()Z
 
-    :catchall_0
-    move-exception p0
+    move-result v7
 
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    if-eqz v7, :cond_3
 
-    throw p0
+    const-string v0, "Failed while check SAK. But, EM Token is allowed. Continue - "
 
-    :cond_2
-    return v1
-.end method
+    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-.method public final createEncPkgDir(ILjava/lang/String;)I
-    .locals 2
+    goto :goto_2
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
+    :cond_3
+    new-instance v1, Ljava/lang/StringBuilder;
 
-    move-result v0
+    invoke-direct {v1, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    if-eqz v0, :cond_0
+    invoke-virtual {v0}, Ljava/lang/Exception;->toString()Ljava/lang/String;
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    move-result-object v4
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getPackageManagerImpl()Ljava/util/Optional;
+    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object p0
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;
+    move-result-object v1
 
-    const/4 v1, 0x0
+    invoke-static {v2, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-direct {v0, p2, p1, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;-><init>(Ljava/lang/String;II)V
+    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
+    move v1, v3
 
-    move-result-object p0
+    :goto_2
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    sget-object p1, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {p0, p1}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    move-result-object p0
+    move v3, v1
 
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
+    :goto_3
+    invoke-static {v3}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
 
-    move-result p0
+    return v3
 
-    if-eqz p0, :cond_0
+    :goto_4
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    const/16 p0, -0xb
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    return p0
+    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :cond_0
-    const/4 p0, 0x0
+    throw v0
 
-    return p0
-.end method
+    :cond_4
+    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-.method public final deleteToeknFromTrusted(Ljava/lang/String;)I
-    .locals 6
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result v0
+    move-result-wide v4
 
-    if-eqz v0, :cond_3
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    const-string/jumbo v0, "deleteToeknFromTrusted"
-
-    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkCallerPermissionFor(Ljava/lang/String;)V
-
-    invoke-static {p1}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
+    :try_start_2
+    new-instance v0, Lcom/samsung/android/service/DeviceRootKeyService/DeviceRootKeyServiceManager;
 
-    const/4 p0, -0x3
+    iget-object v6, p0, Lcom/android/server/knox/dar/DarManagerService;->mContext:Landroid/content/Context;
 
-    return p0
+    invoke-direct {v0, v6}, Lcom/samsung/android/service/DeviceRootKeyService/DeviceRootKeyServiceManager;-><init>(Landroid/content/Context;)V
 
-    :cond_0
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
+    invoke-virtual {v0}, Lcom/samsung/android/service/DeviceRootKeyService/DeviceRootKeyServiceManager;->isAliveDeviceRootKeyService()Z
 
-    move-result v0
+    move-result v6
 
-    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I
+    if-nez v6, :cond_5
 
-    move-result v0
+    const-string v0, "DRK service is not ready..."
 
-    new-instance v1, Ljava/lang/StringBuilder;
+    invoke-static {v2, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
+    goto :goto_5
 
-    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    :catchall_1
+    move-exception v0
 
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    goto :goto_9
 
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    :catch_1
+    move-exception v0
 
-    move-result-object p1
+    goto :goto_7
 
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
+    :cond_5
+    invoke-virtual {v0, v1}, Lcom/samsung/android/service/DeviceRootKeyService/DeviceRootKeyServiceManager;->isExistDeviceRootKey(I)Z
 
-    move-result-wide v1
+    move-result v3
+    :try_end_2
+    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_1
+    .catchall {:try_start_2 .. :try_end_2} :catchall_1
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
+    :goto_5
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
+    :goto_6
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v0, p1}, Lcom/android/server/knox/dar/KeyProtector;->exists(ILjava/lang/String;)Z
-
-    move-result p0
-
-    const/4 v3, 0x0
-
-    if-eqz p0, :cond_1
+    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
+    goto :goto_8
 
-    move-result-wide v4
+    :goto_7
+    :try_start_3
+    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_1
 
-    :try_start_0
-    invoke-static {v0, p1}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    move-result p0
+    goto :goto_6
 
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    :goto_8
+    invoke-static {v3}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
 
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    return v3
 
-    goto :goto_0
+    :goto_9
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    :catchall_0
-    move-exception p0
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    throw p0
-
-    :cond_1
-    move p0, v3
+    throw v0
+.end method
 
-    :goto_0
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+.method public final isDualDarDoSupported()Z
+    .locals 0
 
-    if-eqz p0, :cond_2
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    return v3
+    if-eqz p0, :cond_0
 
-    :cond_2
-    const/16 p0, -0x63
+    const/4 p0, 0x1
 
     return p0
 
-    :cond_3
-    const/16 p0, -0xa
+    :cond_0
+    const/4 p0, 0x0
 
     return p0
 .end method
 
-.method public final disallow(Ljava/lang/String;Ljava/lang/String;)I
+.method public final isEmTokenAllowed()Z
     .locals 2
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
+    new-instance v0, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;
 
-    move-result v0
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mContext:Landroid/content/Context;
 
-    if-eqz v0, :cond_4
+    invoke-direct {v0, p0}, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;-><init>(Landroid/content/Context;)V
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    invoke-virtual {v0}, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;->isConnected()Z
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
+    move-result p0
 
-    monitor-enter v0
+    if-eqz p0, :cond_0
 
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
+    const/4 p0, 0x7
 
-    move-result-object v1
+    invoke-virtual {v0, p0}, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;->getStatus(I)I
 
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
+    move-result p0
 
-    if-nez v1, :cond_0
+    const/4 v0, 0x1
 
-    const/4 p0, -0x5
+    if-ne p0, v0, :cond_0
 
-    return p0
+    goto :goto_0
 
     :cond_0
-    new-instance v0, Lcom/samsung/android/knox/sdp/core/SdpDomain;
+    const/4 v0, 0x0
 
-    invoke-direct {v0, p1, p2}, Lcom/samsung/android/knox/sdp/core/SdpDomain;-><init>(Ljava/lang/String;Ljava/lang/String;)V
+    :goto_0
+    const-string p0, "EM Token status : "
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
+    const-string v1, "DarManagerService"
 
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
+    invoke-static {p0, v1, v0}, Lcom/android/server/accessibility/AccessibilityManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Z)V
 
-    move-result p1
+    return v0
+.end method
 
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
+.method public final isInnerAuthRequired(I)Z
+    .locals 5
+
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
 
-    move-result p2
+    move-result v0
 
-    invoke-virtual {p0, p1, p2, v1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->isEngineOwner(IILcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
+    const/4 v1, 0x0
 
-    move-result p1
+    if-eqz v0, :cond_4
 
-    if-eqz p1, :cond_3
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMapLock:Ljava/lang/Object;
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    monitor-enter p1
+    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
 
-    :try_start_1
-    invoke-virtual {v1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
+    move-result v0
 
-    move-result-object p2
+    if-nez v0, :cond_0
 
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->getSdpPolicyLocked(Ljava/lang/String;)Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;
+    goto :goto_1
 
-    move-result-object p2
+    :cond_0
+    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    if-eqz p2, :cond_1
+    iget-object v2, v0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mContext:Landroid/content/Context;
 
-    invoke-virtual {p2, v0}, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->removePrivilegedApp(Lcom/samsung/android/knox/sdp/core/SdpDomain;)Z
+    invoke-static {v2}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
 
-    move-result v0
+    move-result-object v2
 
-    if-eqz v0, :cond_1
+    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const/4 v0, 0x0
+    invoke-static {}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getDualDARLockstate()Z
 
-    goto :goto_0
+    move-result v2
 
-    :catchall_0
-    move-exception p0
+    const-string/jumbo v3, "isInnerLayerLockedState - result : "
 
-    goto :goto_1
+    const-string v4, "DualDarManagerImpl"
 
-    :cond_1
-    const/16 v0, -0x63
+    invoke-static {v3, v4, v2}, Lcom/android/server/accessibility/AccessibilityManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Z)V
 
-    :goto_0
-    monitor-exit p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    if-eqz v2, :cond_1
 
-    if-nez v0, :cond_2
+    goto :goto_0
 
-    invoke-virtual {p0, v1, p2}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->updatePolicy(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;)I
+    :cond_1
+    iget-boolean v2, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
 
-    move-result p0
+    if-nez v2, :cond_2
 
-    return p0
+    goto :goto_1
 
     :cond_2
-    return v0
+    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
 
-    :goto_1
-    :try_start_2
-    monitor-exit p1
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+    move-result p1
 
-    throw p0
+    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    :cond_3
-    const/4 p0, -0x7
+    invoke-virtual {v0, p1}, Lcom/android/internal/widget/LockPatternUtils;->hasPendingEscrowToken(I)Z
 
-    return p0
+    move-result p1
 
-    :catchall_1
-    move-exception p0
+    if-eqz p1, :cond_3
 
-    :try_start_3
-    monitor-exit v0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    :goto_0
+    const/4 p0, 0x1
 
-    throw p0
+    return p0
 
-    :cond_4
-    const/16 p0, -0xa
+    :cond_3
+    iput-boolean v1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
 
-    return p0
+    :cond_4
+    :goto_1
+    return v1
 .end method
 
-.method public doesSpecificKeyExist(Ljava/lang/String;I)Z
-    .locals 1
+.method public final isKnoxKeyInstallable()Z
+    .locals 15
 
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
+    const-string v0, "KnoxTestKey"
 
-    move-result v0
+    const-string/jumbo v1, "ro.hardware.virtual_device"
 
-    if-eqz v0, :cond_0
+    invoke-static {v1}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    const/4 p0, 0x0
+    move-result-object v1
 
-    return p0
+    const-string v2, "1"
 
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
+    invoke-virtual {v2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    move-result v1
 
-    invoke-static {p2, p1}, Lcom/android/server/knox/dar/KeyProtector;->exists(ILjava/lang/String;)Z
+    const/4 v2, 0x1
 
-    move-result p0
+    if-eqz v1, :cond_0
 
-    return p0
-.end method
+    const-string p0, "DarManagerService"
 
-.method public final dump(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
-    .locals 18
+    const-string/jumbo v0, "Will be Failed in device integrity check. But, running on VirtualDevice. Continue - "
 
-    move-object/from16 v0, p0
+    invoke-static {p0, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-object/from16 v1, p2
+    return v2
 
-    move-object/from16 v2, p3
+    :cond_0
+    iget-object v1, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    iget-object v3, v0, Lcom/android/server/knox/dar/DarManagerService;->mContext:Landroid/content/Context;
+    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string v4, "DarManagerService"
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    invoke-static {v3, v4, v1}, Lcom/android/internal/util/DumpUtils;->checkDumpPermission(Landroid/content/Context;Ljava/lang/String;Ljava/io/PrintWriter;)Z
+    move-result-wide v3
 
-    move-result v3
+    const/4 v1, 0x0
 
-    if-nez v3, :cond_0
+    :try_start_0
+    new-instance v5, Lcom/samsung/android/security/keystore/AttestationUtils;
 
-    goto/16 :goto_10
+    invoke-direct {v5}, Lcom/samsung/android/security/keystore/AttestationUtils;-><init>()V
 
-    :cond_0
-    invoke-virtual {v0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
+    sget-object v6, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
 
-    move-result v3
+    const/16 v7, 0x8
 
-    const/4 v4, 0x0
+    invoke-virtual {v6, v7}, Ljava/security/SecureRandom;->generateSeed(I)[B
 
-    if-eqz v3, :cond_7
+    move-result-object v6
 
-    const-string/jumbo v3, "sdp_dump"
+    if-eqz v6, :cond_2
 
-    invoke-virtual {v1, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
+    new-instance v7, Landroid/security/keystore/KeyGenParameterSpec$Builder;
 
-    iget-object v3, v0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    const/4 v8, 0x4
 
-    iget-object v5, v3, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
+    invoke-direct {v7, v0, v8}, Landroid/security/keystore/KeyGenParameterSpec$Builder;-><init>(Ljava/lang/String;I)V
 
-    const-string/jumbo v6, "android.permission.DUMP"
+    const-string/jumbo v13, "SHA-384"
 
-    invoke-virtual {v5, v6}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I
+    const-string/jumbo v14, "SHA-512"
 
-    move-result v5
+    const-string/jumbo v9, "NONE"
 
-    if-eqz v5, :cond_1
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "Permission Denial: Can\'t dump SDP from pid="
-
-    invoke-direct {v3, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v5
-
-    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v5, ", uid="
-
-    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v5
-
-    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v5, " without permission android.permission.DUMP"
-
-    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-virtual {v1, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
-
-    goto/16 :goto_8
-
-    :cond_1
-    iget-object v5, v3, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v5
-
-    :try_start_0
-    const-string/jumbo v6, "SDP Engine List :"
-
-    invoke-virtual {v1, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
-
-    iget-object v6, v3, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v6}, Landroid/util/SparseArray;->size()I
-
-    move-result v6
-
-    if-gtz v6, :cond_2
-
-    const-string v3, "EMPTY"
-
-    invoke-virtual {v1, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
-
-    goto/16 :goto_6
-
-    :catchall_0
-    move-exception v0
-
-    goto/16 :goto_7
-
-    :cond_2
-    iget-object v6, v3, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v6}, Landroid/util/SparseArray;->size()I
-
-    move-result v6
-
-    move v7, v4
-
-    :goto_0
-    if-ge v7, v6, :cond_6
-
-    iget-object v8, v3, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v8, v7}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;
-
-    move-result-object v8
-
-    check-cast v8, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    if-nez v8, :cond_3
-
-    goto :goto_5
-
-    :cond_3
-    const-string v9, "Engine Id : %5d   User ID : %5d   Version : %d   State : %s   Flag : %10s ( %d )   Alias : %s"
-
-    invoke-virtual {v8}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v10
-
-    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v11
-
-    invoke-virtual {v8}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v10
-
-    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v12
-
-    invoke-virtual {v8}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getVersion()I
-
-    move-result v10
-
-    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v13
-
-    invoke-virtual {v8}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getState()I
-
-    move-result v10
-
-    const/4 v14, 0x2
-
-    if-ne v10, v14, :cond_4
-
-    const-string/jumbo v10, "UNLOCKED"
-
-    :goto_1
-    move-object v14, v10
-
-    goto :goto_2
-
-    :cond_4
-    const-string v10, "LOCKED"
-
-    goto :goto_1
-
-    :goto_2
-    invoke-virtual {v8}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isMinor()Z
-
-    move-result v10
-
-    if-eqz v10, :cond_5
-
-    const-string/jumbo v10, "SDP_MINOR"
-
-    :goto_3
-    move-object v15, v10
-
-    goto :goto_4
-
-    :cond_5
-    const-string/jumbo v10, "SDP_MDFPP"
-
-    goto :goto_3
-
-    :goto_4
-    invoke-virtual {v8}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getFlag()I
-
-    move-result v10
-
-    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v16
-
-    invoke-virtual {v8}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v17
-
-    filled-new-array/range {v11 .. v17}, [Ljava/lang/Object;
-
-    move-result-object v8
-
-    invoke-static {v9, v8}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-virtual {v1, v8}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
-
-    invoke-virtual {v1}, Ljava/io/PrintWriter;->println()V
-
-    :goto_5
-    add-int/lit8 v7, v7, 0x1
-
-    goto :goto_0
-
-    :cond_6
-    invoke-virtual {v1}, Ljava/io/PrintWriter;->println()V
-
-    :goto_6
-    monitor-exit v5
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-virtual {v1}, Ljava/io/PrintWriter;->flush()V
-
-    goto :goto_8
-
-    :goto_7
-    :try_start_1
-    monitor-exit v5
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw v0
-
-    :cond_7
-    :goto_8
-    invoke-virtual {v0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_8
-
-    const-string/jumbo v3, "dualdar_dump"
-
-    invoke-virtual {v1, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
-
-    iget-object v3, v0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    new-instance v5, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;
-
-    move-object/from16 v6, p1
-
-    invoke-direct {v5, v0, v6, v1, v2}, Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/knox/dar/DarManagerService;Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
-
-    invoke-virtual {v3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v5}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
-
-    :cond_8
-    if-eqz v2, :cond_f
-
-    array-length v0, v2
-
-    if-lez v0, :cond_f
-
-    invoke-static {v2}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
-
-    move-result-object v0
-
-    const-string v3, "-a"
-
-    invoke-interface {v0, v3}, Ljava/util/List;->contains(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_9
-
-    invoke-static {v2}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
-
-    move-result-object v0
-
-    const-string/jumbo v2, "sdplog"
-
-    invoke-interface {v0, v2}, Ljava/util/List;->contains(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_f
-
-    :cond_9
-    const-string/jumbo v0, "sdplog_dump"
-
-    invoke-virtual {v1, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
-
-    const-string v0, "-------------------------------------------------- START DUMP --------------------------------------------------"
-
-    invoke-virtual {v1, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
-
-    sget-object v0, Lcom/android/server/knox/dar/sdp/SDPLogger;->mLogger:Lcom/android/server/knox/dar/sdp/SDPLogger$Logger;
-
-    const-string v2, "Failed to dump: "
-
-    const-string/jumbo v0, "SDPLogFile"
-
-    sget-object v3, Lcom/android/server/knox/dar/sdp/SDPLogFile;->FILE_LOCK:Ljava/util/concurrent/locks/Lock;
-
-    check-cast v3, Ljava/util/concurrent/locks/ReentrantLock;
-
-    invoke-virtual {v3}, Ljava/util/concurrent/locks/ReentrantLock;->tryLock()Z
-
-    move-result v3
-
-    if-nez v3, :cond_a
-
-    const-string v2, "Failed to dump: Maybe target file is already being used..."
-
-    invoke-static {v0, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo v0, "Target file busy"
-
-    invoke-virtual {v1, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
-
-    goto :goto_f
-
-    :cond_a
-    const/4 v3, 0x0
-
-    :try_start_2
-    new-instance v5, Ljava/io/RandomAccessFile;
-
-    const-string v0, "/data/log/sdp_log"
-
-    const-string/jumbo v6, "r"
-
-    invoke-direct {v5, v0, v6}, Ljava/io/RandomAccessFile;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-    :try_end_2
-    .catch Ljava/io/IOException; {:try_start_2 .. :try_end_2} :catch_0
-
-    :try_start_3
-    invoke-static {v5}, Lcom/android/server/knox/dar/sdp/SDPLogFile;->check(Ljava/io/RandomAccessFile;)V
-    :try_end_3
-    .catch Ljava/lang/SecurityException; {:try_start_3 .. :try_end_3} :catch_1
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    const-wide/16 v6, 0x11
-
-    :try_start_4
-    invoke-virtual {v5, v6, v7}, Ljava/io/RandomAccessFile;->seek(J)V
-
-    :goto_9
-    invoke-virtual {v5}, Ljava/io/RandomAccessFile;->readLine()Ljava/lang/String;
-
-    move-result-object v0
-
-    if-eqz v0, :cond_c
-
-    add-int/lit8 v2, v4, 0x1
-
-    const/16 v6, 0x1770
-
-    if-lt v4, v6, :cond_b
-
-    const-string v3, "Dump line count reached to the limit: 6000"
-
-    goto :goto_a
-
-    :catchall_1
-    move-exception v0
-
-    move-object v2, v0
-
-    goto :goto_b
-
-    :cond_b
-    invoke-virtual {v1, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
-
-    move v4, v2
-
-    goto :goto_9
-
-    :cond_c
-    :goto_a
-    :try_start_5
-    invoke-virtual {v5}, Ljava/io/RandomAccessFile;->close()V
-    :try_end_5
-    .catch Ljava/io/IOException; {:try_start_5 .. :try_end_5} :catch_0
-
-    goto :goto_e
-
-    :catch_0
-    move-exception v0
-
-    goto :goto_d
-
-    :catch_1
-    move-exception v0
-
-    :try_start_6
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    invoke-direct {v4, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/lang/SecurityException;->getMessage()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    if-eqz v3, :cond_d
-
-    const-string/jumbo v0, "SDPLogFile"
-
-    invoke-static {v0, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_d
-    new-instance v0, Ljava/io/IOException;
-
-    invoke-direct {v0, v3}, Ljava/io/IOException;-><init>(Ljava/lang/String;)V
-
-    throw v0
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_1
-
-    :goto_b
-    :try_start_7
-    invoke-virtual {v5}, Ljava/io/RandomAccessFile;->close()V
-    :try_end_7
-    .catchall {:try_start_7 .. :try_end_7} :catchall_2
-
-    goto :goto_c
-
-    :catchall_2
-    move-exception v0
-
-    :try_start_8
-    invoke-virtual {v2, v0}, Ljava/lang/Throwable;->addSuppressed(Ljava/lang/Throwable;)V
-
-    :goto_c
-    throw v2
-    :try_end_8
-    .catch Ljava/io/IOException; {:try_start_8 .. :try_end_8} :catch_0
-
-    :goto_d
-    invoke-virtual {v0}, Ljava/io/IOException;->printStackTrace()V
-
-    :goto_e
-    sget-object v0, Lcom/android/server/knox/dar/sdp/SDPLogFile;->FILE_LOCK:Ljava/util/concurrent/locks/Lock;
-
-    check-cast v0, Ljava/util/concurrent/locks/ReentrantLock;
-
-    invoke-virtual {v0}, Ljava/util/concurrent/locks/ReentrantLock;->unlock()V
-
-    if-eqz v3, :cond_e
-
-    invoke-virtual {v1, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
-
-    :cond_e
-    invoke-virtual {v1}, Ljava/io/PrintWriter;->println()V
-
-    :goto_f
-    const-string v0, "-------------------------------------------------- END DUMP --------------------------------------------------"
-
-    invoke-virtual {v1, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
-
-    :cond_f
-    :goto_10
-    return-void
-.end method
-
-.method public final exists(Ljava/lang/String;)I
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object p0
-
-    monitor-exit v0
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, -0x4
-
-    return p0
-
-    :cond_0
-    const/4 p0, -0x5
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-
-    :cond_1
-    const/16 p0, -0xa
-
-    return p0
-.end method
-
-.method public generateAndSaveSpecificKey(Ljava/lang/String;I)Z
-    .locals 2
-
-    sget-object v0, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
-
-    const/16 v1, 0x20
-
-    invoke-virtual {v0, v1}, Ljava/security/SecureRandom;->generateSeed(I)[B
-
-    move-result-object v0
-
-    :try_start_0
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v1
-
-    if-nez v1, :cond_0
-
-    invoke-virtual {p0, v0, p1, p2}, Lcom/android/server/knox/dar/DarManagerService;->saveSpecificKeyViaProtector([BLjava/lang/String;I)Z
-
-    move-result p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    const/4 p0, 0x0
-
-    :goto_0
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    return p0
-
-    :goto_1
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    throw p0
-.end method
-
-.method public final getAvailableUserId()I
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/VirtualLockImpl;->getAvailableUserId()I
-
-    move-result p0
-
-    return p0
-
-    :cond_0
-    const/16 p0, -0x2710
-
-    return p0
-.end method
-
-.method public final getBlockedClearablePackages(I)Ljava/util/List;
-    .locals 3
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v1, "getBlockedClearablePackages"
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
-
-    new-instance v1, Ljava/util/ArrayList;
-
-    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V
-
-    const-string/jumbo v2, "pkg_blocked_clearable"
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    invoke-virtual {v0, p1, v2}, Lcom/android/server/knox/dar/DarDatabaseCache;->getInternal(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo v0, "empty"
-
-    if-eqz p1, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    move-object p1, v0
-
-    :goto_0
-    invoke-virtual {p1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    const-string v0, ","
-
-    invoke-virtual {p1, v0}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p1}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;
-
-    move-result-object p1
-
-    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z
-
-    :cond_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mNonClearablePackages:Ljava/util/List;
-
-    invoke-virtual {v1, p0}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z
-
-    return-object v1
-
-    :cond_2
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
-
-.method public final getEngineInfo(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object p0
-
-    monitor-exit v0
-
-    return-object p0
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
-
-.method public final getInnerAuthUserId(I)I
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
-
-    move-result p0
-
-    return p0
-
-    :cond_0
-    const/16 p0, -0x2710
-
-    return p0
-.end method
-
-.method public final getMainUserId(I)I
-    .locals 2
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    const/16 v1, -0x2710
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    const-string/jumbo v0, "ddar.inner.main.userid"
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    :try_start_0
-    invoke-virtual {p0, p1, v0}, Lcom/android/server/knox/dar/DarDatabaseCache;->getInternal(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    invoke-static {p0}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
-
-    move-result p0
-    :try_end_0
-    .catch Ljava/lang/NumberFormatException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return p0
-
-    :catch_0
-    :cond_0
-    return v1
-.end method
-
-.method public final getPackageListForDualDarPolicy(Ljava/lang/String;)Ljava/util/List;
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p0, "getPackageListForDualDarPolicy"
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
-
-    :try_start_0
-    invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    invoke-interface {p0, p1}, Landroid/content/pm/IPackageManager;->getPackageListForDualDarPolicy(Ljava/lang/String;)Ljava/util/List;
-
-    move-result-object p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-object p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :cond_0
-    new-instance p0, Ljava/util/ArrayList;
-
-    invoke-direct {p0}, Ljava/util/ArrayList;-><init>()V
-
-    return-object p0
-
-    :cond_1
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
-
-.method public final getPasswordMinimumLengthForInner()I
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getPasswordMinimumLengthForInner()I
-
-    move-result p0
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final getReservedUserIdForSystem()I
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/VirtualLockImpl;->getReservedUserIdForSystem()I
-
-    move-result p0
-
-    return p0
-
-    :cond_0
-    const/16 p0, -0x2710
-
-    return p0
-.end method
-
-.method public getSpecificKeyViaProtector(Ljava/lang/String;I)[B
-    .locals 3
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    iget-object v2, p0, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p2, p1}, Lcom/android/server/knox/dar/KeyProtector;->release(ILjava/lang/String;)[B
-
-    move-result-object p1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-object p1
-
-    :catchall_0
-    move-exception p1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p1
-.end method
-
-.method public final getSupportedSDKVersion()D
-    .locals 2
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-wide v0, 0x3ff4cccccccccccdL    # 1.3
-
-    return-wide v0
-
-    :cond_0
-    const-wide/16 v0, 0x0
-
-    return-wide v0
-.end method
-
-.method public final getUserInfo(I)Landroid/content/pm/UserInfo;
-    .locals 3
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/DarManagerService;->mUserManager:Landroid/os/UserManager;
-
-    if-eqz v2, :cond_0
-
-    invoke-virtual {v2, p1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p1
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p1, 0x0
-
-    :goto_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    if-eqz p1, :cond_1
-
-    return-object p1
-
-    :cond_1
-    sget-object p0, Lcom/android/server/knox/dar/DarManagerService;->NULL_USER:Landroid/content/pm/UserInfo;
-
-    return-object p0
-.end method
-
-.method public final getUserManager()Landroid/os/UserManager;
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mUserManager:Landroid/os/UserManager;
-
-    if-nez v0, :cond_0
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v1, "user"
-
-    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/os/UserManager;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mUserManager:Landroid/os/UserManager;
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mUserManager:Landroid/os/UserManager;
-
-    return-object p0
-.end method
-
-.method public final handleDeviceOwnerChanged()V
-    .locals 8
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    const/4 v2, 0x0
-
-    const/4 v3, 0x1
-
-    if-eqz v0, :cond_0
-
-    sput-boolean v3, Lcom/android/server/knox/dar/DarUtil;->mIsDeviceOwnerEnabled:Z
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {p0, v2}, Lcom/android/internal/widget/LockPatternUtils;->setDeviceOwner(I)V
-
-    const-string/jumbo p0, "Skip sdp engine creation for dual-dar do"
-
-    invoke-static {v1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkSystemPermission()V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mDevicePolicyManager:Landroid/app/admin/DevicePolicyManager;
-
-    invoke-virtual {v0}, Landroid/app/admin/DevicePolicyManager;->getDeviceOwner()Ljava/lang/String;
-
-    move-result-object v0
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mDevicePolicyManager:Landroid/app/admin/DevicePolicyManager;
-
-    invoke-virtual {v4}, Landroid/app/admin/DevicePolicyManager;->getDeviceOwnerUserId()I
-
-    move-result v4
-
-    const-string v5, "Device Owner has been changed!"
-
-    invoke-static {v1, v5}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    const-string v5, "Confirming Device Owner information [ Owner : %s, User : %d ]"
-
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v6
-
-    filled-new-array {v0, v6}, [Ljava/lang/Object;
-
-    move-result-object v6
-
-    invoke-static {v5, v6}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v1, v5}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_9
-
-    if-eqz v4, :cond_1
-
-    goto/16 :goto_5
-
-    :cond_1
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-    const-string/jumbo v5, "do_cleared"
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string v6, "0"
-
-    invoke-virtual {v0, v2, v5, v6}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, v4}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v5
-
-    if-eqz v5, :cond_2
-
-    const-string/jumbo p0, "Unexpected condition as per DO\' already has engine"
-
-    invoke-static {v1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    goto/16 :goto_4
-
-    :cond_2
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    sput-boolean v3, Lcom/android/server/knox/dar/DarUtil;->mIsDeviceOwnerEnabled:Z
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {v0, v4}, Lcom/android/internal/widget/LockPatternUtils;->setDeviceOwner(I)V
-
-    invoke-virtual {p0, v4}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->welcomeNewUser(I)V
-
-    const/4 v0, 0x4
-
-    invoke-virtual {p0, v4, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->unlockSdpIfUnsecuredOrBiometricAuthenticated(II)V
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v5
-
-    :try_start_1
-    const-string/jumbo v0, "ro.crypto.type"
-
-    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v7, "file"
-
-    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    goto :goto_0
-
-    :catchall_1
-    move-exception p0
-
-    goto/16 :goto_3
-
-    :catch_0
-    move-exception v0
-
-    :try_start_2
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    move v0, v2
-
-    :goto_0
-    if-eqz v0, :cond_7
-
-    invoke-virtual {p0, v4}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isUcmUser(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_7
-
-    new-instance v0, Ljava/io/File;
-
-    const-string v5, "/data/knox/secure_fs/enc_media"
-
-    invoke-static {v4}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-direct {v0, v5, v6}, Ljava/io/File;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/io/File;->exists()Z
-
-    move-result v5
-
-    if-nez v5, :cond_3
-
-    const-string v0, "Failed to set sdp policy due to non-existent target"
-
-    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto/16 :goto_2
-
-    :cond_3
-    iget-object v5, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpManagerInternal:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    if-nez v5, :cond_4
-
-    const-class v5, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    invoke-static {v5}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v5
-
-    check-cast v5, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    iput-object v5, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpManagerInternal:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    :cond_4
-    iget-object v5, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpManagerInternal:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    invoke-static {v5}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object v5
-
-    new-instance v6, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;
-
-    const/4 v7, 0x0
-
-    invoke-direct {v6, v4, v7, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;-><init>(IILjava/io/File;)V
-
-    invoke-virtual {v5, v6}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object v5
-
-    sget-object v6, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {v5, v6}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v5
-
-    check-cast v5, Ljava/lang/Boolean;
-
-    invoke-virtual {v5}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result v5
-
-    if-eqz v5, :cond_6
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v6, "Successfully set sdp policy to "
-
-    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/io/File;->getPath()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
-
-    const-class v5, Landroid/os/storage/StorageManager;
-
-    invoke-virtual {v0, v5}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/os/storage/StorageManager;
-
-    if-eqz v0, :cond_5
-
-    invoke-virtual {v0, v4}, Landroid/os/storage/StorageManager;->mountSdpMediaStorage(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_5
-
-    goto :goto_1
-
-    :cond_5
-    move v3, v2
-
-    :goto_1
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "Result of mount sdp media storage : "
-
-    invoke-direct {v0, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_2
-
-    :cond_6
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    const-string v5, "Failed to set sdp policy to "
-
-    invoke-direct {v3, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/io/File;->getPath()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_7
-    :goto_2
-    invoke-static {v2}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_8
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    const-string/jumbo v1, "Update SdpMdfpp for System."
-
-    invoke-static {v0, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkSystemPermission()V
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getLockSettings()Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3;
-
-    const-wide/16 v1, 0x1
-
-    invoke-direct {v0, v4, v1, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3;-><init>(IJ)V
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    :cond_8
-    return-void
-
-    :goto_3
-    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-
-    :goto_4
-    :try_start_3
-    monitor-exit v0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    throw p0
-
-    :cond_9
-    :goto_5
-    const-string v0, "Device Owner turned out to be ejected..."
-
-    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-    const-string/jumbo v1, "do_cleared"
-
-    const-string v3, "1"
-
-    invoke-virtual {v0, v2, v1, v3}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->updateDeviceOwnerStatus()V
-
-    return-void
-.end method
-
-.method public handleUnlockSecureFolderWithToken(I)V
-    .locals 5
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isSecureFolderId(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    return-void
-
-    :cond_0
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
-
-    const-string/jumbo v0, "SdpTokenHandle"
-
-    invoke-virtual {p0, v0, p1}, Lcom/android/server/knox/dar/DarManagerService;->getSpecificKeyViaProtector(Ljava/lang/String;I)[B
-
-    move-result-object v0
-
-    const-string v1, "DarManagerService"
-
-    if-eqz v0, :cond_1
-
-    sget-object v2, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
-
-    const/16 v2, 0x8
-
-    invoke-static {v2}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
-
-    move-result-object v2
-
-    sget-object v3, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
-
-    invoke-virtual {v2, v3}, Ljava/nio/ByteBuffer;->order(Ljava/nio/ByteOrder;)Ljava/nio/ByteBuffer;
-
-    invoke-virtual {v2, v0}, Ljava/nio/ByteBuffer;->put([B)Ljava/nio/ByteBuffer;
-
-    invoke-virtual {v2}, Ljava/nio/ByteBuffer;->flip()Ljava/nio/Buffer;
-
-    invoke-virtual {v2}, Ljava/nio/ByteBuffer;->getLong()J
-
-    move-result-wide v2
-
-    goto :goto_0
-
-    :cond_1
-    const-string/jumbo v0, "get SecureFolder Token Handle Failed"
-
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-wide/16 v2, 0x0
-
-    :goto_0
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
-
-    const-string/jumbo v0, "SdpResetToken"
-
-    invoke-virtual {p0, v0, p1}, Lcom/android/server/knox/dar/DarManagerService;->getSpecificKeyViaProtector(Ljava/lang/String;I)[B
-
-    move-result-object v0
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-class v4, Lcom/android/internal/widget/LockSettingsInternal;
-
-    invoke-static {v4}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v4
-
-    check-cast v4, Lcom/android/internal/widget/LockSettingsInternal;
-
-    if-eqz v4, :cond_2
-
-    :try_start_0
-    invoke-virtual {v4, v2, v3, v0, p1}, Lcom/android/internal/widget/LockSettingsInternal;->unlockUserWithToken(J[BI)Z
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_1
-
-    :catch_0
-    move-exception v2
-
-    const-string/jumbo v3, "Unexpected failure while unlock secure folder with token"
-
-    invoke-static {v2, v3, v1}, Lcom/android/server/DirEncryptServiceHelper$$ExternalSyntheticOutline0;->m(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_2
-    :goto_1
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->getUserManager()Landroid/os/UserManager;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1}, Landroid/os/UserManager;->isUserUnlocked(I)Z
-
-    move-result p0
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "SecureFolder user "
-
-    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string p1, " has been unlocked [ res : "
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string p0, " ]"
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-.end method
-
-.method public final isDarSupported()Z
-    .locals 0
-
-    const/4 p0, 0x1
-
-    return p0
-.end method
-
-.method public final isDefaultPathUser(I)Z
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
-
-    move-result p0
-
-    xor-int/lit8 p0, p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final isDeviceRootKeyInstalled()Z
-    .locals 10
-
-    const-string/jumbo v0, "ro.hardware.virtual_device"
-
-    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string v1, "1"
-
-    invoke-virtual {v1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    const/4 v1, 0x1
-
-    const-string v2, "DarManagerService"
-
-    if-eqz v0, :cond_0
-
-    const-string/jumbo p0, "Will be Failed in device integrity check. But, running on VirtualDevice. Continue .. "
-
-    invoke-static {v2, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_0
-    const-string/jumbo v0, "ro.security.keystore.keytype"
-
-    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v3, "sakm"
-
-    invoke-virtual {v0, v3}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z
-
-    move-result v0
-
-    const/4 v3, 0x0
-
-    if-eqz v0, :cond_4
-
-    const-string v0, "Check SAK instead for JDM with GRDM or KnoxVault2"
-
-    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string v0, "KnoxTestKey"
-
-    const-string v4, "Failed while check SAK : "
-
-    iget-object v5, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v5
-
-    :try_start_0
-    new-instance v7, Lcom/samsung/android/security/keystore/AttestationUtils;
-
-    invoke-direct {v7}, Lcom/samsung/android/security/keystore/AttestationUtils;-><init>()V
-
-    sget-object v8, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
-
-    const/16 v9, 0x8
-
-    invoke-virtual {v8, v9}, Ljava/security/SecureRandom;->generateSeed(I)[B
-
-    move-result-object v8
-
-    invoke-virtual {v7, v0, v8}, Lcom/samsung/android/security/keystore/AttestationUtils;->generateKeyPair(Ljava/lang/String;[B)Ljava/security/KeyPair;
-
-    move-result-object v7
-
-    if-eqz v7, :cond_1
-
-    move v3, v1
-
-    :cond_1
-    if-eqz v3, :cond_2
-
-    const-string v7, "Generated keypair is protected by SAK"
-
-    invoke-static {v2, v7}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {v0}, Lcom/samsung/android/security/keystore/AttestationUtils;->deleteKey(Ljava/lang/String;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    goto :goto_4
-
-    :catch_0
-    move-exception v0
-
-    goto :goto_1
-
-    :cond_2
-    :goto_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    goto :goto_3
-
-    :goto_1
-    :try_start_1
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isEmTokenAllowed()Z
-
-    move-result v7
-
-    if-eqz v7, :cond_3
-
-    const-string v0, "Failed while check SAK. But, EM Token is allowed. Continue - "
-
-    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_2
-
-    :cond_3
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/lang/Exception;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v2, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    move v1, v3
-
-    :goto_2
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    move v3, v1
-
-    :goto_3
-    invoke-static {v3}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-
-    return v3
-
-    :goto_4
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw v0
-
-    :cond_4
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v4
-
-    :try_start_2
-    new-instance v0, Lcom/samsung/android/service/DeviceRootKeyService/DeviceRootKeyServiceManager;
-
-    iget-object v6, p0, Lcom/android/server/knox/dar/DarManagerService;->mContext:Landroid/content/Context;
-
-    invoke-direct {v0, v6}, Lcom/samsung/android/service/DeviceRootKeyService/DeviceRootKeyServiceManager;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {v0}, Lcom/samsung/android/service/DeviceRootKeyService/DeviceRootKeyServiceManager;->isAliveDeviceRootKeyService()Z
-
-    move-result v6
-
-    if-nez v6, :cond_5
-
-    const-string v0, "DRK service is not ready..."
-
-    invoke-static {v2, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_5
-
-    :catchall_1
-    move-exception v0
-
-    goto :goto_9
-
-    :catch_1
-    move-exception v0
-
-    goto :goto_7
-
-    :cond_5
-    invoke-virtual {v0, v1}, Lcom/samsung/android/service/DeviceRootKeyService/DeviceRootKeyServiceManager;->isExistDeviceRootKey(I)Z
-
-    move-result v3
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    :goto_5
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    :goto_6
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    goto :goto_8
-
-    :goto_7
-    :try_start_3
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    goto :goto_6
-
-    :goto_8
-    invoke-static {v3}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-
-    return v3
-
-    :goto_9
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw v0
-.end method
-
-.method public final isDualDarDoSupported()Z
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final isEmTokenAllowed()Z
-    .locals 2
-
-    new-instance v0, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mContext:Landroid/content/Context;
-
-    invoke-direct {v0, p0}, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;-><init>(Landroid/content/Context;)V
-
-    invoke-virtual {v0}, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;->isConnected()Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x7
-
-    invoke-virtual {v0, p0}, Lcom/samsung/android/service/EngineeringMode/EngineeringModeManager;->getStatus(I)I
-
-    move-result p0
-
-    const/4 v0, 0x1
-
-    if-ne p0, v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 v0, 0x0
-
-    :goto_0
-    const-string p0, "EM Token status : "
-
-    const-string v1, "DarManagerService"
-
-    invoke-static {p0, v1, v0}, Lcom/android/server/accessibility/AccessibilityManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Z)V
-
-    return v0
-.end method
-
-.method public final isInnerAuthRequired(I)Z
-    .locals 5
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    goto :goto_1
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    iget-object v2, v0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mContext:Landroid/content/Context;
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
-
-    move-result-object v2
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getDualDARLockstate()Z
-
-    move-result v2
-
-    const-string/jumbo v3, "isInnerLayerLockedState - result : "
-
-    const-string v4, "DualDarManagerImpl"
-
-    invoke-static {v3, v4, v2}, Lcom/android/server/accessibility/AccessibilityManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Z)V
-
-    if-eqz v2, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    iget-boolean v2, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    if-nez v2, :cond_2
-
-    goto :goto_1
-
-    :cond_2
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
-
-    move-result p1
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {v0, p1}, Lcom/android/internal/widget/LockPatternUtils;->hasPendingEscrowToken(I)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_3
-
-    :goto_0
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_3
-    iput-boolean v1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    :cond_4
-    :goto_1
-    return v1
-.end method
-
-.method public final isKnoxKeyInstallable()Z
-    .locals 15
-
-    const-string v0, "KnoxTestKey"
-
-    const-string/jumbo v1, "ro.hardware.virtual_device"
-
-    invoke-static {v1}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    const-string v2, "1"
-
-    invoke-virtual {v2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v1
-
-    const/4 v2, 0x1
-
-    if-eqz v1, :cond_0
-
-    const-string p0, "DarManagerService"
-
-    const-string/jumbo v0, "Will be Failed in device integrity check. But, running on VirtualDevice. Continue - "
-
-    invoke-static {p0, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v2
-
-    :cond_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v3
-
-    const/4 v1, 0x0
-
-    :try_start_0
-    new-instance v5, Lcom/samsung/android/security/keystore/AttestationUtils;
-
-    invoke-direct {v5}, Lcom/samsung/android/security/keystore/AttestationUtils;-><init>()V
-
-    sget-object v6, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
-
-    const/16 v7, 0x8
-
-    invoke-virtual {v6, v7}, Ljava/security/SecureRandom;->generateSeed(I)[B
-
-    move-result-object v6
-
-    if-eqz v6, :cond_2
-
-    new-instance v7, Landroid/security/keystore/KeyGenParameterSpec$Builder;
-
-    const/4 v8, 0x4
-
-    invoke-direct {v7, v0, v8}, Landroid/security/keystore/KeyGenParameterSpec$Builder;-><init>(Ljava/lang/String;I)V
-
-    const-string/jumbo v13, "SHA-384"
-
-    const-string/jumbo v14, "SHA-512"
-
-    const-string/jumbo v9, "NONE"
-
-    const-string/jumbo v10, "SHA-1"
-
-    const-string/jumbo v11, "SHA-224"
-
-    const-string/jumbo v12, "SHA-256"
-
-    filled-new-array/range {v9 .. v14}, [Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-virtual {v7, v8}, Landroid/security/keystore/KeyGenParameterSpec$Builder;->setDigests([Ljava/lang/String;)Landroid/security/keystore/KeyGenParameterSpec$Builder;
-
-    move-result-object v7
-
-    invoke-virtual {v7}, Landroid/security/keystore/KeyGenParameterSpec$Builder;->build()Landroid/security/keystore/KeyGenParameterSpec;
-
-    move-result-object v7
-
-    new-instance v8, Lcom/samsung/android/security/keystore/AttestParameterSpec;
-
-    invoke-direct {v8, v6, v2, v1, v7}, Lcom/samsung/android/security/keystore/AttestParameterSpec;-><init>([BZZLandroid/security/keystore/KeyGenParameterSpec;)V
-
-    invoke-virtual {v5, v8}, Lcom/samsung/android/security/keystore/AttestationUtils;->generateKeyPair(Lcom/samsung/android/security/keystore/AttestParameterSpec;)Ljava/security/KeyPair;
-
-    move-result-object v2
-
-    if-eqz v2, :cond_1
-
-    invoke-static {v0}, Lcom/samsung/android/security/keystore/AttestationUtils;->getCertificateChain(Ljava/lang/String;)[Ljava/security/cert/Certificate;
-
-    move-result-object v2
-
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/DarManagerService;->checkDeviceIntegrity([Ljava/security/cert/Certificate;)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_1
-
-    invoke-static {v0}, Lcom/samsung/android/security/keystore/AttestationUtils;->deleteKey(Ljava/lang/String;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    goto :goto_2
-
-    :catch_0
-    move-exception v0
-
-    goto :goto_1
-
-    :cond_1
-    :goto_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return v1
-
-    :cond_2
-    :try_start_1
-    new-instance v0, Ljava/lang/NullPointerException;
-
-    const-string/jumbo v2, "challenge == null"
-
-    invoke-direct {v0, v2}, Ljava/lang/NullPointerException;-><init>(Ljava/lang/String;)V
-
-    throw v0
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :goto_1
-    :try_start_2
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return v1
-
-    :goto_2
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw v0
-.end method
-
-.method public final isLicensed()I
-    .locals 10
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_7
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v0
-
-    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I
-
-    move-result v0
-
-    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-nez v0, :cond_6
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v2
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v3
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
-
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->getPackageName(I)Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-static {v3}, Landroid/os/UserHandle;->getUserId(I)I
-
-    move-result v5
-
-    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v2
-
-    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v3
-
-    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v6
-
-    filled-new-array {v4, v2, v3, v6}, [Ljava/lang/Object;
-
-    move-result-object v2
-
-    const-string v3, "Check permission { Package : %s, PID : %d, UID : %d, UserId : %d }"
-
-    invoke-static {v3, v2}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v2
-
-    const-string/jumbo v3, "SdpServiceKeeper"
-
-    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 v2, 0x1
-
-    if-eqz v4, :cond_1
-
-    sget-object v6, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mWhitelist:Ljava/util/List;
-
-    check-cast v6, Ljava/util/ArrayList;
-
-    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I
-
-    move-result v7
-
-    move v8, v1
-
-    :cond_0
-    if-ge v8, v7, :cond_1
-
-    invoke-virtual {v6, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v9
-
-    add-int/lit8 v8, v8, 0x1
-
-    check-cast v9, Ljava/lang/String;
-
-    invoke-virtual {v4, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v9
-
-    if-eqz v9, :cond_0
-
-    const-string p0, "Identified as whitelisted"
-
-    invoke-static {v3, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_1
-
-    :cond_1
-    invoke-virtual {p0, v5, v4}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->isSystemApp(ILjava/lang/String;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_2
-
-    const-string p0, "Identified as system app"
-
-    invoke-static {v3, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_1
-
-    :cond_2
-    if-eqz v0, :cond_3
-
-    const-string/jumbo p0, "com.samsung.android.knox.permission.KNOX_SENSITIVE_DATA_PROTECTION"
-
-    const/4 v4, 0x0
-
-    :try_start_0
-    invoke-virtual {v0, p0, v4}, Landroid/content/Context;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V
-    :try_end_0
-    .catch Ljava/lang/SecurityException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    :cond_3
-    move v2, v1
-
-    :goto_0
-    if-nez v2, :cond_4
-
-    const-string/jumbo p0, "License activation required"
-
-    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_4
-    :goto_1
-    if-eqz v2, :cond_5
-
-    goto :goto_2
-
-    :cond_5
-    const/16 v1, -0x9
-
-    :cond_6
-    :goto_2
-    return v1
-
-    :cond_7
-    const/16 p0, -0xa
-
-    return p0
-.end method
-
-.method public final isResetPasswordTokenActive(I)Z
-    .locals 4
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    iget-object v2, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    invoke-virtual {v2, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->getLong(I)J
-
-    move-result-wide v2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {p0, v2, v3, p1}, Lcom/android/internal/widget/LockPatternUtils;->isEscrowTokenActive(JI)Z
-
-    move-result p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-
-    :cond_1
-    :goto_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final isSDPEnabled(I)Z
-    .locals 2
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    return v1
-.end method
-
-.method public final isSdpSupported()Z
-    .locals 4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    const/4 v0, 0x0
-
-    if-eqz p0, :cond_9
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v1
-
-    invoke-static {v1}, Landroid/os/UserHandle;->getUserId(I)I
-
-    move-result v1
-
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v2
-
-    invoke-virtual {v2}, Landroid/content/pm/UserInfo;->isGuest()Z
-
-    move-result v3
-
-    if-nez v3, :cond_8
-
-    invoke-virtual {v2}, Landroid/content/pm/UserInfo;->isDualAppProfile()Z
-
-    move-result v3
-
-    if-nez v3, :cond_8
-
-    invoke-virtual {v2}, Landroid/content/pm/UserInfo;->isBMode()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_0
-
-    goto :goto_2
-
-    :cond_0
-    invoke-static {v1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_1
-
-    goto :goto_2
-
-    :cond_1
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isUcmUser(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_2
-
-    goto :goto_2
-
-    :cond_2
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string v1, ""
-
-    :try_start_0
-    const-string/jumbo v2, "persist.omc.sales_code"
-
-    invoke-static {v2}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v2
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz v2, :cond_3
-
-    :try_start_1
-    invoke-virtual {v2}, Ljava/lang/String;->isEmpty()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_5
-
-    :cond_3
-    const-string/jumbo v3, "ro.csc.sales_code"
-
-    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v2
-
-    if-eqz v2, :cond_4
-
-    invoke-virtual {v2}, Ljava/lang/String;->isEmpty()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_5
-
-    :cond_4
-    const-string/jumbo v3, "ril.sales_code"
-
-    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v2
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1
-
-    goto :goto_0
-
-    :catch_0
-    move-object v2, v1
-
-    :catch_1
-    const-string/jumbo v3, "readOMCSalesCode failed"
-
-    invoke-static {p0, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_5
-    :goto_0
-    if-nez v2, :cond_6
-
-    goto :goto_1
-
-    :cond_6
-    move-object v1, v2
-
-    :goto_1
-    const-string/jumbo v2, "isLDUModel : sales code : "
-
-    invoke-virtual {v2, v1}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {p0, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo p0, "PAP"
-
-    invoke-virtual {p0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p0
-
-    if-nez p0, :cond_8
-
-    const-string p0, "FOP"
-
-    invoke-virtual {p0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p0
-
-    if-nez p0, :cond_8
-
-    const-string p0, "LDU"
-
-    invoke-virtual {p0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_7
-
-    goto :goto_2
-
-    :cond_7
-    const/4 v0, 0x1
-
-    :cond_8
-    :goto_2
-    return v0
-
-    :cond_9
-    const-string p0, "DarManagerService_SDP"
-
-    const-string/jumbo v1, "SDP not supported"
-
-    invoke-static {p0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v0
-.end method
-
-.method public final isSdpSupportedSecureFolder(I)Z
-    .locals 0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/DarManagerService;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    invoke-virtual {p0}, Landroid/content/pm/UserInfo;->isSecureFolder()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    invoke-virtual {p0}, Landroid/content/pm/UserInfo;->isSdpNotSupportedSecureFolder()Z
-
-    move-result p0
-
-    if-nez p0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final isSensitive(Ljava/lang/String;)Z
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpManagerProxy:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    if-nez v0, :cond_0
-
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    invoke-direct {v0, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;-><init>(Ljava/lang/Object;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpManagerProxy:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpManagerProxy:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;->this$0:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
-
-    const-class v0, Landroid/os/storage/StorageManager;
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/os/storage/StorageManager;
-
-    invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy$$ExternalSyntheticLambda0;
-
-    invoke-direct {v0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy$$ExternalSyntheticLambda0;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    sget-object p1, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {p0, p1}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Ljava/lang/Boolean;
-
-    invoke-virtual {p0}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result p0
-
-    return p0
-
-    :cond_1
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final isVirtualLockSupported()Z
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final lock(Ljava/lang/String;)I
-    .locals 4
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    const-string/jumbo v0, "lock :: Can\'t find engine info "
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v1
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v2
-
-    if-nez v2, :cond_0
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    invoke-direct {v2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, -0x5
-
-    monitor-exit v1
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    goto/16 :goto_0
-
-    :cond_0
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isAndroidDefaultEngine()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo v0, "lock :: Not supported anymore to "
-
-    invoke-static {v0, p1, p0}, Lcom/android/server/StorageManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    const/16 p0, -0x63
-
-    return p0
-
-    :cond_1
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isEngineOwner(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isPrivileged(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSystemComponent(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo p1, "lock :: Permission denied to invoke engine control API"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, -0x7
-
-    return p0
-
-    :cond_2
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result p1
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "lock :: Lock engine for user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->lockFinal(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)I
-
-    move-result v0
-
-    if-nez v0, :cond_3
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v2
-
-    filled-new-array {v2}, [Ljava/lang/Object;
-
-    move-result-object v2
-
-    const-string/jumbo v3, "lock :: Successfully done for user %d"
-
-    invoke-static {v3, v2}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v1, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedCredentialMap:Ljava/util/Map;
-
-    const-string/jumbo v1, "credential"
-
-    invoke-static {p0, v1, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->clearCached(Ljava/util/Map;Ljava/lang/String;I)V
-
-    return v0
-
-    :cond_3
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    filled-new-array {p0, p1}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string/jumbo p1, "lock :: Failed to lock for user %d... [ rc : %d ]"
-
-    invoke-static {p1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v0
-
-    :goto_0
-    :try_start_1
-    monitor-exit v1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_4
-    const/16 p0, -0xa
-
-    return p0
-.end method
-
-.method public final migrate(Ljava/lang/String;)I
-    .locals 0
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const/4 p0, -0x1
-
-    return p0
-
-    :cond_0
-    const/16 p0, -0xa
-
-    return p0
-.end method
-
-.method public final onBiometricsAuthenticated(I)V
-    .locals 2
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    filled-new-array {v0}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "User %d has been authenticated with biometrics"
-
-    invoke-static {v1, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->hasBiometricTypeTraced(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    const/16 v0, 0x8
-
-    invoke-virtual {p0, p1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->unlockSdpIfUnsecuredOrBiometricAuthenticated(II)V
-
-    :cond_0
-    return-void
-.end method
-
-.method public final onDeviceOwnerLocked(I)V
-    .locals 3
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    filled-new-array {v0}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "User %d has been locked"
-
-    invoke-static {v1, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 v0, 0x0
-
-    if-nez p1, :cond_1
-
-    sget-boolean v1, Lcom/android/server/knox/dar/DarUtil;->mIsDeviceOwnerEnabled:Z
-
-    if-nez v1, :cond_0
-
-    const-string v1, "DARUtil"
-
-    const-string v2, "Device owner status not updated yet..."
-
-    invoke-static {v1, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {v0}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
-
-    move-result v1
-
-    :cond_0
-    if-eqz v1, :cond_1
-
-    const/4 v0, 0x1
-
-    :cond_1
-    if-eqz v0, :cond_3
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->hasNoSecurity(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    goto :goto_0
-
-    :cond_2
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->lockSdpIfRequired(I)V
-
-    :cond_3
-    :goto_0
-    return-void
-.end method
-
-.method public prepareSecuredDataKey(I)V
-    .locals 2
-
-    const-string/jumbo v0, "SdpSecureDataKey"
-
-    invoke-virtual {p0, v0, p1}, Lcom/android/server/knox/dar/DarManagerService;->doesSpecificKeyExist(Ljava/lang/String;I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_0
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    invoke-virtual {p0, v0, p1}, Lcom/android/server/knox/dar/DarManagerService;->generateAndSaveSpecificKey(Ljava/lang/String;I)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    filled-new-array {v1, p0}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string p1, "Generate secure data key for user %d [ res : %b ]"
-
-    invoke-static {p1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string p1, "DarManagerService"
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_0
-    return-void
-.end method
-
-.method public final registerClient(ILcom/samsung/android/knox/dar/sdp/ISdpListener;)V
-    .locals 4
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    if-eqz p2, :cond_3
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v0
-
-    if-nez v0, :cond_0
-
-    goto :goto_3
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v2
-
-    check-cast v1, Ljava/util/HashMap;
-
-    invoke-virtual {v1, v2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;
-
-    if-nez v1, :cond_1
-
-    new-instance v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;
-
-    invoke-direct {v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;-><init>()V
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v3
-
-    check-cast v2, Ljava/util/HashMap;
-
-    invoke-virtual {v2, v3, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_2
-
-    :cond_1
-    :goto_0
-    new-instance v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;
-
-    invoke-direct {v2, p0, p1, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;-><init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;ILcom/samsung/android/knox/dar/sdp/ISdpListener;)V
-
-    iget-boolean p0, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mIsValid:Z
-
-    if-eqz p0, :cond_2
-
-    iget-object p0, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;->mStateListeners:Ljava/util/ArrayList;
-
-    invoke-virtual {p0, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    move-result p0
-
-    goto :goto_1
-
-    :cond_2
-    const/4 p0, 0x0
-
-    :goto_1
-    const-string/jumbo p2, "SdpManagerImpl"
-
-    const-string/jumbo v2, "registerClient :: Engine Id = %d, Roll Size = %d, Result = %s"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    iget-object v1, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;->mStateListeners:Ljava/util/ArrayList;
-
-    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I
-
-    move-result v1
-
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    filled-new-array {p1, v1, p0}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    invoke-static {v2, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p2, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    monitor-exit v0
-
-    return-void
-
-    :goto_2
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-
-    :cond_3
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    :cond_4
-    :goto_3
-    return-void
-.end method
-
-.method public final registerListener(Ljava/lang/String;Lcom/samsung/android/knox/dar/sdp/ISdpListener;)I
-    .locals 3
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    const-string/jumbo v1, "registerListener"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object p1
-
-    if-nez p1, :cond_0
-
-    const/4 p0, -0x5
-
-    monitor-exit v0
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_2
-
-    :cond_0
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "registerListener from pid = "
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v2
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v2, ", uid = "
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v2
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v1
-
-    check-cast v0, Ljava/util/HashMap;
-
-    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Ljava/util/ArrayList;
-
-    if-nez v0, :cond_1
-
-    new-instance v0, Ljava/util/ArrayList;
-
-    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v2
-
-    check-cast v1, Ljava/util/HashMap;
-
-    invoke-virtual {v1, v2, v0}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    :cond_1
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
-
-    monitor-enter v1
-
-    :try_start_1
-    new-instance v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-direct {v2, p0, p1, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;-><init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Ljava/lang/String;Lcom/samsung/android/knox/dar/sdp/ISdpListener;)V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    const/4 p0, 0x0
-
-    :try_start_2
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    invoke-interface {p2}, Lcom/samsung/android/knox/dar/sdp/ISdpListener;->asBinder()Landroid/os/IBinder;
-
-    move-result-object p1
-
-    invoke-interface {p1, v2, p0}, Landroid/os/IBinder;->linkToDeath(Landroid/os/IBinder$DeathRecipient;I)V
-
-    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-    :try_end_2
-    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    goto :goto_0
-
-    :catchall_1
-    move-exception p0
-
-    goto :goto_1
-
-    :catch_0
-    :try_start_3
-    const-string/jumbo p1, "SdpManagerImpl"
-
-    const-string p2, "Failed to link to listener death"
-
-    invoke-static {p1, p2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_0
-    monitor-exit v1
-
-    return p0
-
-    :goto_1
-    monitor-exit v1
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    throw p0
-
-    :goto_2
-    :try_start_4
-    monitor-exit v0
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    throw p0
-
-    :cond_2
-    const/16 p0, -0xa
-
-    return p0
-.end method
-
-.method public final removeEngine(Ljava/lang/String;)I
-    .locals 2
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v1
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-nez v1, :cond_0
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo p1, "removeEngine :: no engine found"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, -0x5
-
-    return p0
-
-    :cond_0
-    invoke-virtual {v1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isAndroidDefaultEngine()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo v0, "remove :: Not supported anymore to "
-
-    invoke-static {v0, p1, p0}, Lcom/android/server/StorageManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    const/16 p0, -0x63
-
-    return p0
-
-    :cond_1
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isEngineOwner(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSystemComponent(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo p1, "remove :: Permission denied to invoke engine control API"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, -0x7
-
-    return p0
-
-    :cond_2
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->removeEngineInternal(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)I
-
-    move-result p0
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_3
-    const/16 p0, -0xa
-
-    return p0
-.end method
-
-.method public final reportApplicationBinding(JIILjava/lang/String;Ljava/lang/String;)V
-    .locals 7
-
-    invoke-static {}, Lcom/android/server/knox/zt/devicetrust/AppMonitor;->get()Lcom/android/server/knox/zt/devicetrust/AppMonitor;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Lcom/android/server/knox/zt/devicetrust/AppMonitor;->isOn()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v0
-
-    const-string v1, "DarManagerService"
-
-    if-eq v0, p3, :cond_0
-
-    const-string/jumbo p0, "reportApplicationBinding: pid is not matched"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mActivityManagerInternal:Landroid/app/ActivityManagerInternal;
-
-    invoke-virtual {p0, p3}, Landroid/app/ActivityManagerInternal;->getPackageNameByPid(I)Ljava/lang/String;
-
-    move-result-object p0
-
-    if-nez p0, :cond_1
-
-    const-string/jumbo p0, "reportApplicationBinding: Package is not valid with pid : "
-
-    invoke-static {p3, p0, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :cond_1
-    invoke-static {}, Lcom/android/internal/os/BackgroundThread;->getHandler()Landroid/os/Handler;
-
-    move-result-object p0
-
-    new-instance v0, Lcom/android/server/knox/dar/DarManagerService$2;
-
-    move-wide v5, p1
-
-    move v1, p3
-
-    move v2, p4
-
-    move-object v3, p5
-
-    move-object v4, p6
-
-    invoke-direct/range {v0 .. v6}, Lcom/android/server/knox/dar/DarManagerService$2;-><init>(IILjava/lang/String;Ljava/lang/String;J)V
-
-    invoke-virtual {p0, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
-
-    :cond_2
-    return-void
-.end method
-
-.method public final reserveUserIdForSystem()I
-    .locals 4
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
-
-    move-result v0
-
-    const/16 v1, -0x2710
-
-    if-eqz v0, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    const-string/jumbo v0, "reserveUserIdForSystem"
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/VirtualLockImpl;->getReservedUserIdForSystem()I
-
-    move-result v0
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/VirtualLockImpl;->getReservedUserIdForSystem()I
-
-    move-result v2
-
-    if-eq v2, v1, :cond_0
-
-    return v0
-
-    :cond_0
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/VirtualLockImpl;->getAvailableUserId()I
-
-    move-result v0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
-
-    move-result-object v1
-
-    const/4 v2, 0x0
-
-    const-string/jumbo v3, "vl.reserved.userid"
-
-    invoke-virtual {p0, v2, v3, v1}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
-
-    return v0
-
-    :cond_1
-    return v1
-.end method
-
-.method public final resetPassword(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)I
-    .locals 8
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_8
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    const-string/jumbo v0, "reset :: Can\'t find engine info "
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v1
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v2
-
-    if-nez v2, :cond_0
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, -0x5
-
-    monitor-exit v1
-
-    return p0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto/16 :goto_3
-
-    :cond_0
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isAndroidDefaultEngine()Z
-
-    move-result v0
-
-    const/16 v1, -0x63
-
-    if-eqz v0, :cond_1
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo p2, "reset :: Not supported anymore to "
-
-    invoke-static {p2, p1, p0}, Lcom/android/server/StorageManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    return v1
-
-    :cond_1
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isEngineOwner(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isPrivileged(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSystemComponent(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo p1, "reset :: Permission denied to invoke engine control API"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, -0x7
-
-    return p0
-
-    :cond_2
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v3
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "Reset password for user "
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    invoke-static {v0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isMinor()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_3
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide p1
-
-    :try_start_1
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    const-string/jumbo v2, "SdpResetToken"
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v3, v2}, Lcom/android/server/knox/dar/KeyProtector;->release(ILjava/lang/String;)[B
-
-    move-result-object v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    invoke-static {p1, p2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    :goto_0
-    move-object v7, v0
-
-    goto :goto_2
-
-    :catchall_1
-    move-exception v0
-
-    move-object p0, v0
-
-    invoke-static {p1, p2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-
-    :cond_3
-    if-eqz p2, :cond_4
-
-    const-string/jumbo p1, "UTF-8"
-
-    invoke-static {p1}, Ljava/nio/charset/Charset;->forName(Ljava/lang/String;)Ljava/nio/charset/Charset;
-
-    move-result-object p1
-
-    invoke-virtual {p2, p1}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
-
-    move-result-object p1
-
-    :goto_1
-    move-object v0, p1
-
-    goto :goto_0
-
-    :cond_4
-    const/4 p1, 0x0
-
-    goto :goto_1
-
-    :goto_2
-    invoke-static {v7}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_5
-
-    const/4 p0, -0x2
-
-    return p0
-
-    :cond_5
-    invoke-static {p3}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_6
-
-    const/4 p0, -0x1
-
-    return p0
-
-    :cond_6
-    invoke-virtual {p0, v3}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getTokenHandleViaProtector(I)J
-
-    move-result-wide v4
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-
-    move-object v6, p3
-
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->setPasswordWithToken(IJLjava/lang/String;[B)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_7
-
-    const/4 p0, 0x0
-
-    return p0
-
-    :cond_7
-    return v1
-
-    :goto_3
-    :try_start_2
-    monitor-exit v1
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :cond_8
-    const/16 p0, -0xa
-
-    return p0
-.end method
-
-.method public final resetPasswordWithToken(Ljava/lang/String;[BI)Z
-    .locals 9
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "Reset password with token for user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "VirtualLockImpl"
-
-    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-static {p3}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    goto :goto_4
-
-    :cond_0
-    if-eqz p1, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    const-string p1, ""
-
-    :goto_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    invoke-virtual {v0, p3}, Lcom/android/server/knox/dar/DarDatabaseCache;->getLong(I)J
-
-    move-result-wide v3
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v7
-
-    :try_start_0
-    invoke-static {p1}, Landroid/app/admin/PasswordMetrics;->isNumericOnly(Ljava/lang/String;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    invoke-static {p1}, Lcom/android/internal/widget/LockscreenCredential;->createPin(Ljava/lang/CharSequence;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object p1
-
-    :goto_1
-    move-object v2, p1
-
-    goto :goto_2
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_3
-
-    :cond_2
-    invoke-static {p1}, Lcom/android/internal/widget/LockscreenCredential;->createPasswordOrNone(Ljava/lang/CharSequence;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object p1
-
-    goto :goto_1
-
-    :goto_2
-    iget-object p1, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-    if-nez p1, :cond_3
-
-    const-class p1, Lcom/android/internal/widget/LockSettingsInternal;
-
-    invoke-static {p1}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Lcom/android/internal/widget/LockSettingsInternal;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-    :cond_3
-    iget-object p0, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-    invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v1, Lcom/android/server/knox/dar/VirtualLockImpl$$ExternalSyntheticLambda0;
-
-    move-object v5, p2
-
-    move v6, p3
-
-    invoke-direct/range {v1 .. v6}, Lcom/android/server/knox/dar/VirtualLockImpl$$ExternalSyntheticLambda0;-><init>(Lcom/android/internal/widget/LockscreenCredential;J[BI)V
-
-    invoke-virtual {p0, v1}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    sget-object p1, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {p0, p1}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Ljava/lang/Boolean;
-
-    invoke-virtual {p0}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return p0
-
-    :goto_3
-    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-
-    :cond_4
-    :goto_4
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public saveResetTokenViaProtectorForLegacy([BI)Z
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p0, "SdpResetToken"
-
-    invoke-static {p2, p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
-
-    move-result p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-
-    return p0
-.end method
-
-.method public saveSpecificKeyViaProtector([BLjava/lang/String;I)Z
-    .locals 3
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    filled-new-array {p1, p2}, [Ljava/lang/Object;
-
-    move-result-object v2
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/SecureUtil;->isAnyoneEmptyHere([Ljava/lang/Object;)Z
-
-    move-result v2
-
-    if-nez v2, :cond_0
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p3, p2, p1}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
-
-    move-result p1
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-eqz p1, :cond_0
-
-    const/4 p1, 0x1
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p1
-
-    goto :goto_1
-
-    :cond_0
-    const/4 p1, 0x0
-
-    :goto_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return p1
-
-    :goto_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p1
-.end method
-
-.method public saveTokenHandleViaProtectorForLegacy(JI)Z
-    .locals 2
-
-    sget-object v0, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
-
-    const/16 v0, 0x8
-
-    invoke-static {v0}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
-
-    move-result-object v0
-
-    sget-object v1, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
-
-    invoke-virtual {v0, v1}, Ljava/nio/ByteBuffer;->order(Ljava/nio/ByteOrder;)Ljava/nio/ByteBuffer;
-
-    invoke-virtual {v0, p1, p2}, Ljava/nio/ByteBuffer;->putLong(J)Ljava/nio/ByteBuffer;
-
-    invoke-virtual {v0}, Ljava/nio/ByteBuffer;->array()[B
-
-    move-result-object p1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p0, "SdpTokenHandle"
-
-    invoke-static {p3, p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
-
-    move-result p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-
-    return p0
-.end method
-
-.method public final saveTokenIntoTrusted(Ljava/lang/String;Ljava/lang/String;)I
-    .locals 5
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    const-string/jumbo v0, "saveTokenIntoTrusted"
-
-    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkCallerPermissionFor(Ljava/lang/String;)V
-
-    invoke-static {p1}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_3
-
-    invoke-static {p2}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto :goto_3
-
-    :cond_0
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v0
-
-    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I
-
-    move-result v0
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo v1, "UTF-8"
-
-    invoke-static {v1}, Ljava/nio/charset/Charset;->forName(Ljava/lang/String;)Ljava/nio/charset/Charset;
-
-    move-result-object v1
-
-    invoke-virtual {p2, v1}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
-
-    move-result-object p2
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v1
-
-    :try_start_0
-    filled-new-array {p2, p1}, [Ljava/lang/Object;
-
-    move-result-object v3
-
-    invoke-static {v3}, Lcom/android/server/knox/dar/SecureUtil;->isAnyoneEmptyHere([Ljava/lang/Object;)Z
-
-    move-result v3
-
-    const/4 v4, 0x0
-
-    if-nez v3, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0, p1, p2}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
-
-    move-result p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-eqz p0, :cond_1
-
-    const/4 p0, 0x1
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_2
-
-    :cond_1
-    move p0, v4
-
-    :goto_0
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    if-eqz p0, :cond_2
-
-    goto :goto_1
-
-    :cond_2
-    const/16 v4, -0x63
-
-    :goto_1
-    invoke-static {p2}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    return v4
-
-    :goto_2
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-
-    :cond_3
-    :goto_3
-    const/4 p0, -0x3
-
-    return p0
-
-    :cond_4
-    const/16 p0, -0xa
-
-    return p0
-.end method
-
-.method public final setDualDarInfo(II)Z
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p0, "setDualDarInfo"
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
-
-    const-class p0, Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/pm/UserManagerInternal;
-
-    if-eqz v0, :cond_0
-
-    invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/pm/UserManagerInternal;->setDualDarInfo(II)Z
-
-    move-result p0
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final setInnerAuthUserId(II)V
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v0, "setInnerAuthUserId"
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo v0, "ddar.inner.auth.userid"
-
-    invoke-virtual {p0, p2, v0, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
-
-    :cond_0
-    return-void
-.end method
-
-.method public final setMainUserId(II)V
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v0, "setMainUserId"
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo v0, "ddar.inner.main.userid"
-
-    invoke-virtual {p0, p2, v0, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
-
-    :cond_0
-    return-void
-.end method
-
-.method public final setPassword(Ljava/lang/String;Ljava/lang/String;)I
-    .locals 9
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_a
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    const-string/jumbo v0, "set password :: Can\'t find engine info "
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v1
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v2
-
-    if-nez v2, :cond_0
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, -0x5
-
-    monitor-exit v1
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    goto/16 :goto_3
-
-    :cond_0
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isAndroidDefaultEngine()Z
-
-    move-result v0
-
-    const/16 v1, -0x63
-
-    if-eqz v0, :cond_1
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo p2, "set password :: Not supported anymore to "
-
-    invoke-static {p2, p1, p0}, Lcom/android/server/StorageManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    return v1
-
-    :cond_1
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isEngineOwner(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isPrivileged(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSystemComponent(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo p1, "set password :: Permission denied to invoke engine control API"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, -0x7
-
-    return p0
-
-    :cond_2
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result p1
-
-    invoke-static {p2}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    const/4 p0, -0x1
-
-    return p0
-
-    :cond_3
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getState()I
-
-    move-result v0
-
-    const/4 v2, 0x2
-
-    const/4 v3, -0x6
-
-    if-eq v0, v2, :cond_4
-
-    return v3
-
-    :cond_4
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedCredentialMap:Ljava/util/Map;
-
-    const-string/jumbo v2, "credential"
-
-    invoke-virtual {p0, v0, v2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getCached(Ljava/util/Map;Ljava/lang/String;I)[B
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    const-string/jumbo v4, "SdpManagerImpl"
-
-    if-eqz v2, :cond_5
-
-    const-string/jumbo p0, "set password :: Unexpected condition while derive managed creential for user "
-
-    invoke-static {p1, p0, v4}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return v3
-
-    :cond_5
-    new-instance v2, Ljava/lang/String;
-
-    sget-object v3, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;
-
-    invoke-direct {v2, v0, v3}, Ljava/lang/String;-><init>([BLjava/nio/charset/Charset;)V
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-
-    invoke-virtual {v3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    const-string v6, "Change password for user "
-
-    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    const-string/jumbo v6, "SdpManagerImpl.VirtualLock"
-
-    invoke-static {v6, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v5, v3, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->this$0:Ljava/lang/Object;
-
-    check-cast v5, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {v5, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$misVirtualUserId(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)Z
-
-    move-result v7
-
-    if-nez v7, :cond_6
-
-    sget-object v3, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    goto :goto_1
-
-    :cond_6
-    new-instance v7, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v8, "Set password for user "
-
-    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v7, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-static {v6, v7}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v6
-
-    if-nez v6, :cond_7
-
-    goto :goto_0
-
-    :cond_7
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v6
-
-    :try_start_1
-    invoke-virtual {v5}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getLockSettings()Ljava/util/Optional;
-
-    move-result-object v5
-
-    new-instance v8, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2;
-
-    invoke-direct {v8, p1, p2, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2;-><init>(ILjava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v5, v8}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    :goto_0
-    invoke-virtual {v3, p1, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->checkPassword(ILjava/lang/String;)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object v3
-
-    :goto_1
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
-
-    move-result v5
-
-    if-eqz v5, :cond_8
-
-    const/4 v1, 0x0
-
-    :cond_8
-    if-nez v1, :cond_9
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v5
-
-    filled-new-array {v5}, [Ljava/lang/Object;
-
-    move-result-object v5
-
-    const-string/jumbo v6, "set password :: Successfully done for user %d"
-
-    invoke-static {v6, v5}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v4, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo v4, "UTF-8"
-
-    invoke-static {v4}, Ljava/nio/charset/Charset;->forName(Ljava/lang/String;)Ljava/nio/charset/Charset;
-
-    move-result-object v4
-
-    invoke-virtual {p2, v4}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
-
-    move-result-object p2
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedCredentialMap:Ljava/util/Map;
-
-    const-string/jumbo v5, "credential"
-
-    invoke-virtual {p0, v4, v5, p2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->cacheSafe(Ljava/util/Map;Ljava/lang/String;[BI)V
-
-    goto :goto_2
-
-    :cond_9
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    filled-new-array {p0, p1}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string/jumbo p1, "set password :: Failed to set password for user %d... [ rc : %d ]"
-
-    invoke-static {p1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_2
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->destroy()V
-
-    filled-new-array {v0, v2}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->clearAll([Ljava/lang/Object;)V
-
-    return v1
-
-    :catchall_1
-    move-exception p0
-
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-
-    :goto_3
-    :try_start_2
-    monitor-exit v1
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :cond_a
-    const/16 p0, -0xa
-
-    return p0
-.end method
-
-.method public final setResetPasswordToken([BI)Z
-    .locals 10
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_4
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
-
-    const-string/jumbo v2, "vl.rst.token.handle"
-
-    iget-object v3, v0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "Set reset password token for user "
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    const-string/jumbo v5, "VirtualLockImpl"
-
-    invoke-static {v5, v4}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-static {p2}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
-
-    move-result v4
-
-    const/4 v5, 0x1
-
-    if-nez v4, :cond_0
+    const-string/jumbo v10, "SHA-1"
 
-    move p1, v1
+    const-string/jumbo v11, "SHA-224"
 
-    goto :goto_1
+    const-string/jumbo v12, "SHA-256"
 
-    :cond_0
-    if-eqz p1, :cond_3
+    filled-new-array/range {v9 .. v14}, [Ljava/lang/String;
 
-    array-length v4, p1
+    move-result-object v8
 
-    const/16 v6, 0x20
+    invoke-virtual {v7, v8}, Landroid/security/keystore/KeyGenParameterSpec$Builder;->setDigests([Ljava/lang/String;)Landroid/security/keystore/KeyGenParameterSpec$Builder;
 
-    if-lt v4, v6, :cond_3
+    move-result-object v7
 
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
+    invoke-virtual {v7}, Landroid/security/keystore/KeyGenParameterSpec$Builder;->build()Landroid/security/keystore/KeyGenParameterSpec;
 
-    move-result-wide v6
+    move-result-object v7
 
-    :try_start_0
-    invoke-virtual {v3, p2}, Lcom/android/server/knox/dar/DarDatabaseCache;->getLong(I)J
+    new-instance v8, Lcom/samsung/android/security/keystore/AttestParameterSpec;
 
-    move-result-wide v8
+    invoke-direct {v8, v6, v2, v1, v7}, Lcom/samsung/android/security/keystore/AttestParameterSpec;-><init>([BZZLandroid/security/keystore/KeyGenParameterSpec;)V
 
-    invoke-virtual {v0, p2, v8, v9}, Lcom/android/server/knox/dar/VirtualLockImpl;->clearResetPasswordTokenInternal(IJ)Z
+    invoke-virtual {v5, v8}, Lcom/samsung/android/security/keystore/AttestationUtils;->generateKeyPair(Lcom/samsung/android/security/keystore/AttestParameterSpec;)Ljava/security/KeyPair;
 
-    iget-object v4, v0, Lcom/android/server/knox/dar/VirtualLockImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
+    move-result-object v2
 
-    iget-object v0, v0, Lcom/android/server/knox/dar/VirtualLockImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
+    if-eqz v2, :cond_1
 
-    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;
+    invoke-static {v0}, Lcom/samsung/android/security/keystore/AttestationUtils;->getCertificateChain(Ljava/lang/String;)[Ljava/security/cert/Certificate;
 
-    invoke-virtual {v4, p1, p2, v0}, Lcom/android/internal/widget/LockPatternUtils;->addEscrowToken([BILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
+    move-result-object v2
 
-    move-result-wide v8
+    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/DarManagerService;->checkDeviceIntegrity([Ljava/security/cert/Certificate;)Z
 
-    invoke-static {v8, v9}, Ljava/lang/String;->valueOf(J)Ljava/lang/String;
+    move-result v1
 
-    move-result-object p1
+    if-eqz v1, :cond_1
 
-    invoke-virtual {v3, p2, v2, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {v0}, Lcom/samsung/android/security/keystore/AttestationUtils;->deleteKey(Ljava/lang/String;)V
     :try_end_0
+    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    const-wide/16 v2, 0x0
+    goto :goto_0
 
-    cmp-long p1, v8, v2
+    :catchall_0
+    move-exception v0
 
-    if-eqz p1, :cond_1
+    goto :goto_2
 
-    move p1, v5
+    :catch_0
+    move-exception v0
 
-    goto :goto_0
+    goto :goto_1
 
     :cond_1
-    move p1, v1
-
     :goto_0
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    :goto_1
-    if-eqz p1, :cond_2
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
-
-    move-result v0
-
-    if-ne v0, p2, :cond_2
-
-    iget-boolean p2, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    if-nez p2, :cond_2
-
-    iput-boolean v5, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
-
-    new-instance p2, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;
-
-    invoke-direct {p2, p0}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;)V
+    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    invoke-static {p2}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
+    return v1
 
     :cond_2
-    return p1
+    :try_start_1
+    new-instance v0, Ljava/lang/NullPointerException;
 
-    :catchall_0
-    move-exception p0
+    const-string/jumbo v2, "challenge == null"
 
-    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-direct {v0, v2}, Ljava/lang/NullPointerException;-><init>(Ljava/lang/String;)V
 
-    throw p0
+    throw v0
+    :try_end_1
+    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :cond_3
-    new-instance p0, Ljava/lang/IllegalArgumentException;
+    :goto_1
+    :try_start_2
+    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    const-string/jumbo p1, "token must be at least 32-byte long"
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    throw p0
+    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :cond_4
     return v1
-.end method
-
-.method public setResetTokenForLegacy([BI)Z
-    .locals 8
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "Set reset token for Legacy user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    const/4 v2, 0x0
-
-    const/4 v3, 0x0
-
-    :try_start_0
-    iget-object v4, p0, Lcom/android/server/knox/dar/DarManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {v4, p1, p2, v2}, Lcom/android/internal/widget/LockPatternUtils;->addEscrowToken([BILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
-
-    move-result-wide v4
-
-    const-wide/16 v6, 0x0
-
-    cmp-long p1, v4, v6
-
-    if-eqz p1, :cond_0
-
-    invoke-virtual {p0, v4, v5, p2}, Lcom/android/server/knox/dar/DarManagerService;->saveTokenHandleViaProtectorForLegacy(JI)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    const/4 v3, 0x1
 
-    goto :goto_0
+    :goto_2
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    :catchall_0
-    move-exception p1
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    goto :goto_4
+    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :catch_0
-    move-exception p1
+    throw v0
+.end method
 
-    goto :goto_2
+.method public final isLicensed()I
+    .locals 0
 
-    :cond_0
-    :goto_0
-    invoke-static {v3}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    move-result-object p1
+    const/16 p0, -0xa
 
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
+    return p0
+.end method
 
-    move-result p1
+.method public final isResetPasswordTokenActive(I)Z
+    .locals 4
 
-    if-eqz p1, :cond_1
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
 
-    iget-object p1, p0, Lcom/android/server/knox/dar/DarManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
+    move-result v0
 
-    invoke-virtual {p1, v4, v5, p2}, Lcom/android/internal/widget/LockPatternUtils;->removeEscrowToken(JI)Z
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    if-eqz v0, :cond_1
 
-    :cond_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
 
-    :goto_1
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    goto :goto_3
-
-    :goto_2
-    :try_start_1
-    invoke-virtual {p1}, Ljava/lang/Exception;->printStackTrace()V
+    invoke-static {p1}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
 
-    const-string/jumbo p2, "Unexpected exception while set reset token for Legacy"
+    move-result v0
 
-    invoke-static {p1, v2, p2}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    if-nez v0, :cond_0
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
+    goto :goto_0
 
-    goto :goto_1
+    :cond_0
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    :goto_3
-    new-instance p0, Ljava/lang/StringBuilder;
+    move-result-wide v0
 
-    const-string/jumbo p1, "Result of set reset token for Legacy : "
+    :try_start_0
+    iget-object v2, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
 
-    invoke-direct {p0, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-virtual {v2, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->getLong(I)J
 
-    invoke-virtual {p0, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    move-result-wide v2
 
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    iget-object p0, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    move-result-object p0
+    invoke-virtual {p0, v2, v3, p1}, Lcom/android/internal/widget/LockPatternUtils;->isEscrowTokenActive(JI)Z
 
-    invoke-static {v2, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    move-result p0
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    return v3
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :goto_4
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
+    return p0
 
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    :catchall_0
+    move-exception p0
 
     invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    throw p1
+    throw p0
+
+    :cond_1
+    :goto_0
+    const/4 p0, 0x0
+
+    return p0
 .end method
 
-.method public final setSensitive(ILjava/lang/String;)Z
-    .locals 2
+.method public final isSDPEnabled(I)Z
+    .locals 0
 
     invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    move-result v0
+    const/4 p0, 0x0
 
-    if-eqz v0, :cond_1
+    return p0
+.end method
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+.method public final isSdpSupported()Z
+    .locals 1
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpManagerProxy:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
+    const-string p0, "DarManagerService_SDP"
 
-    if-nez v0, :cond_0
+    const-string/jumbo v0, "SDP not supported"
 
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
+    invoke-static {p0, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-direct {v0, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;-><init>(Ljava/lang/Object;)V
+    const/4 p0, 0x0
 
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpManagerProxy:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
+    return p0
+.end method
 
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpManagerProxy:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
+.method public final isSdpSupportedSecureFolder(I)Z
+    .locals 3
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;->this$0:Ljava/lang/Object;
+    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    check-cast p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    const-class v0, Landroid/os/storage/StorageManager;
+    move-result-wide v0
 
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
+    iget-object v2, p0, Lcom/android/server/knox/dar/DarManagerService;->mUserManager:Landroid/os/UserManager;
 
-    move-result-object p0
+    if-eqz v2, :cond_0
 
-    check-cast p0, Landroid/os/storage/StorageManager;
+    invoke-virtual {v2, p1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
 
-    invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
+    move-result-object p1
 
-    move-result-object p0
+    goto :goto_0
 
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;
+    :cond_0
+    const/4 p1, 0x0
 
-    const/4 v1, 0x2
+    :goto_0
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    invoke-direct {v0, p1, p2, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;-><init>(ILjava/lang/String;I)V
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    move-result-object p0
+    if-eqz p1, :cond_1
 
-    sget-object p1, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
+    goto :goto_1
 
-    invoke-virtual {p0, p1}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
+    :cond_1
+    sget-object p1, Lcom/android/server/knox/dar/DarManagerService;->NULL_USER:Landroid/content/pm/UserInfo;
 
-    move-result-object p0
+    :goto_1
+    if-eqz p1, :cond_2
 
-    check-cast p0, Ljava/lang/Boolean;
+    invoke-virtual {p1}, Landroid/content/pm/UserInfo;->isSecureFolder()Z
 
-    invoke-virtual {p0}, Ljava/lang/Boolean;->booleanValue()Z
+    move-result p0
+
+    if-eqz p0, :cond_2
+
+    invoke-virtual {p1}, Landroid/content/pm/UserInfo;->isSdpNotSupportedSecureFolder()Z
 
     move-result p0
 
+    if-nez p0, :cond_2
+
+    const/4 p0, 0x1
+
     return p0
 
-    :cond_1
+    :cond_2
     const/4 p0, 0x0
 
     return p0
 .end method
 
-.method public final startMonitoring(IILandroid/os/Bundle;Lcom/samsung/android/knox/zt/devicetrust/IEndpointMonitorListener;)I
+.method public final isSensitive(Ljava/lang/String;)Z
     .locals 0
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mEndpointMonitorImpl:Lcom/android/server/knox/zt/devicetrust/EndpointMonitorImpl;
+    const/4 p0, 0x0
 
-    if-eqz p0, :cond_0
+    return p0
+.end method
 
-    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/knox/zt/devicetrust/EndpointMonitorImpl;->startMonitoring(IILandroid/os/Bundle;Lcom/samsung/android/knox/zt/devicetrust/IEndpointMonitorListener;)I
+.method public final isVirtualLockSupported()Z
+    .locals 0
 
-    move-result p0
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
+
+    if-eqz p0, :cond_0
+
+    const/4 p0, 0x1
 
     return p0
 
     :cond_0
-    const/4 p0, -0x6
+    const/4 p0, 0x0
 
     return p0
 .end method
 
-.method public final startTracing(IILandroid/os/Bundle;Lcom/samsung/android/knox/zt/devicetrust/IEndpointMonitorListener;)I
+.method public final lock(Ljava/lang/String;)I
     .locals 0
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
-
-    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/knox/dar/DarManagerService;->startMonitoring(IILandroid/os/Bundle;Lcom/samsung/android/knox/zt/devicetrust/IEndpointMonitorListener;)I
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    move-result p0
+    const/16 p0, -0xa
 
     return p0
 .end method
 
-.method public final stopMonitoring(II)I
+.method public final migrate(Ljava/lang/String;)I
     .locals 0
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mEndpointMonitorImpl:Lcom/android/server/knox/zt/devicetrust/EndpointMonitorImpl;
-
-    if-eqz p0, :cond_0
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/knox/zt/devicetrust/EndpointMonitorImpl;->stopMonitoring(II)I
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    move-result p0
+    const/16 p0, -0xa
 
     return p0
+.end method
 
-    :cond_0
-    const/4 p0, -0x6
+.method public final onBiometricsAuthenticated(I)V
+    .locals 0
 
-    return p0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
+
+    return-void
 .end method
 
-.method public final stopTracing(II)I
+.method public final onDeviceOwnerLocked(I)V
     .locals 0
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/knox/dar/DarManagerService;->stopMonitoring(II)I
+    return-void
+.end method
 
-    move-result p0
+.method public prepareSecuredDataKey(I)V
+    .locals 2
 
-    return p0
-.end method
+    const-string/jumbo v0, "SdpSecureDataKey"
 
-.method public final systemReady()V
-    .locals 3
+    invoke-virtual {p0, v0, p1}, Lcom/android/server/knox/dar/DarManagerService;->doesSpecificKeyExist(Ljava/lang/String;I)Z
 
-    const-string v0, "DarManagerService"
+    move-result v1
 
-    const-string/jumbo v1, "systemReady for DarManagerService"
+    if-nez v1, :cond_0
 
-    invoke-static {v0, v1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    new-instance v0, Landroid/os/HandlerThread;
+    move-result-object v1
 
-    const-string v1, "DarManagerService"
+    invoke-virtual {p0, v0, p1}, Lcom/android/server/knox/dar/DarManagerService;->generateAndSaveSpecificKey(Ljava/lang/String;I)Z
 
-    const/16 v2, 0xa
+    move-result p0
 
-    invoke-direct {v0, v1, v2}, Landroid/os/HandlerThread;-><init>(Ljava/lang/String;I)V
+    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
 
-    invoke-virtual {v0}, Landroid/os/HandlerThread;->start()V
+    move-result-object p0
 
-    new-instance v1, Lcom/android/server/knox/dar/DarManagerService$DarHandler;
+    filled-new-array {v1, p0}, [Ljava/lang/Object;
 
-    invoke-virtual {v0}, Landroid/os/HandlerThread;->getLooper()Landroid/os/Looper;
+    move-result-object p0
 
-    move-result-object v0
+    const-string p1, "Generate secure data key for user %d [ res : %b ]"
 
-    invoke-direct {v1, p0, v0}, Lcom/android/server/knox/dar/DarManagerService$DarHandler;-><init>(Lcom/android/server/knox/dar/DarManagerService;Landroid/os/Looper;)V
+    invoke-static {p1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    iput-object v1, p0, Lcom/android/server/knox/dar/DarManagerService;->mDarHandler:Lcom/android/server/knox/dar/DarManagerService$DarHandler;
+    move-result-object p0
 
-    const/4 v0, 0x0
+    const-string p1, "DarManagerService"
 
-    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/DarManagerService;->prepareSecuredDataKey(I)V
+    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    const-class p0, Lcom/android/server/knox/dar/DarManagerService;
+    :cond_0
+    return-void
+.end method
 
-    monitor-enter p0
+.method public final registerClient(ILcom/samsung/android/knox/dar/sdp/ISdpListener;)V
+    .locals 0
 
-    :try_start_0
-    monitor-exit p0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
     return-void
+.end method
 
-    :catchall_0
-    move-exception v0
+.method public final registerListener(Ljava/lang/String;Lcom/samsung/android/knox/dar/sdp/ISdpListener;)I
+    .locals 0
 
-    monitor-exit p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    throw v0
+    const/16 p0, -0xa
+
+    return p0
 .end method
 
-.method public final unlock(Ljava/lang/String;Ljava/lang/String;)I
-    .locals 8
+.method public final removeEngine(Ljava/lang/String;)I
+    .locals 0
 
     invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    move-result v0
+    const/16 p0, -0xa
+
+    return p0
+.end method
 
-    if-eqz v0, :cond_9
+.method public final reportApplicationBinding(JIILjava/lang/String;Ljava/lang/String;)V
+    .locals 7
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    invoke-static {}, Lcom/android/server/knox/zt/devicetrust/AppMonitor;->get()Lcom/android/server/knox/zt/devicetrust/AppMonitor;
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
+    move-result-object v0
 
-    monitor-enter v0
+    invoke-virtual {v0}, Lcom/android/server/knox/zt/devicetrust/AppMonitor;->isOn()Z
 
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
+    move-result v0
 
-    move-result-object v1
+    if-eqz v0, :cond_2
 
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
+    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
 
-    if-nez v1, :cond_0
+    move-result v0
 
-    const-string/jumbo p0, "SdpManagerImpl"
+    const-string v1, "DarManagerService"
 
-    const-string/jumbo p2, "unlock :: Can\'t find engine info for "
+    if-eq v0, p3, :cond_0
 
-    invoke-static {p2, p1, p0}, Lcom/android/server/StorageManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
+    const-string/jumbo p0, "reportApplicationBinding: pid is not matched"
 
-    const/4 p0, -0x5
+    invoke-static {v1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    return p0
+    return-void
 
     :cond_0
-    invoke-virtual {v1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isAndroidDefaultEngine()Z
-
-    move-result v0
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mActivityManagerInternal:Landroid/app/ActivityManagerInternal;
 
-    const/16 v2, -0x63
+    invoke-virtual {p0, p3}, Landroid/app/ActivityManagerInternal;->getPackageNameByPid(I)Ljava/lang/String;
 
-    if-eqz v0, :cond_1
+    move-result-object p0
 
-    const-string/jumbo p0, "SdpManagerImpl"
+    if-nez p0, :cond_1
 
-    const-string/jumbo p2, "unlock :: Not supported anymore to "
+    const-string/jumbo p0, "reportApplicationBinding: Package is not valid with pid : "
 
-    invoke-static {p2, p1, p0}, Lcom/android/server/StorageManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {p3, p0, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
 
-    return v2
+    return-void
 
     :cond_1
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isEngineOwner(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
+    invoke-static {}, Lcom/android/internal/os/BackgroundThread;->getHandler()Landroid/os/Handler;
 
-    move-result p1
+    move-result-object p0
 
-    if-nez p1, :cond_2
+    new-instance v0, Lcom/android/server/knox/dar/DarManagerService$2;
 
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isPrivileged(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
+    move-wide v5, p1
 
-    move-result p1
+    move v1, p3
 
-    if-nez p1, :cond_2
+    move v2, p4
 
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSystemComponent(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
+    move-object v3, p5
 
-    move-result p1
+    move-object v4, p6
 
-    if-nez p1, :cond_2
+    invoke-direct/range {v0 .. v6}, Lcom/android/server/knox/dar/DarManagerService$2;-><init>(IILjava/lang/String;Ljava/lang/String;J)V
 
-    const-string/jumbo p0, "SdpManagerImpl"
+    invoke-virtual {p0, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    const-string/jumbo p1, "unlock :: Permission denied to invoke engine control API"
+    :cond_2
+    return-void
+.end method
 
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+.method public final reserveUserIdForSystem()I
+    .locals 4
 
-    const/4 p0, -0x7
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
 
-    return p0
+    move-result v0
 
-    :cond_2
-    invoke-virtual {v1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
+    const/16 v1, -0x2710
 
-    move-result p1
+    if-eqz v0, :cond_1
 
-    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
 
-    invoke-static {p2}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
+    iget-object v0, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    move-result v3
+    const-string/jumbo v0, "reserveUserIdForSystem"
 
-    const/4 v4, -0x1
+    invoke-static {v0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
 
-    if-nez v3, :cond_3
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/VirtualLockImpl;->getReservedUserIdForSystem()I
 
-    :try_start_1
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
+    move-result v0
 
-    invoke-virtual {v0, p1, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->checkPassword(ILjava/lang/String;)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/VirtualLockImpl;->getReservedUserIdForSystem()I
 
-    move-result-object v0
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
+    move-result v2
 
-    goto :goto_0
+    if-eq v2, v1, :cond_0
 
-    :catch_0
-    move-exception p0
+    return v0
 
-    const-string/jumbo p2, "SdpManagerImpl"
+    :cond_0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/VirtualLockImpl;->getAvailableUserId()I
 
-    new-instance v0, Ljava/lang/StringBuilder;
+    move-result v0
 
-    const-string/jumbo v1, "unlock :: Failed to check password user "
+    iget-object p0, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
 
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-static {v0}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
 
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    move-result-object v1
 
-    move-result-object p1
+    const/4 v2, 0x0
 
-    invoke-static {p2, p1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    const-string/jumbo v3, "vl.reserved.userid"
 
-    return v4
+    invoke-virtual {p0, v2, v3, v1}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
 
-    :cond_3
-    :goto_0
-    const-string/jumbo v3, "SdpManagerImpl"
+    return v0
 
-    const-string/jumbo v5, "unlock :: Result of virtual user %d verification : %s"
+    :cond_1
+    return v1
+.end method
 
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+.method public final resetPassword(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)I
+    .locals 0
 
-    move-result-object v6
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->toString()Ljava/lang/String;
+    const/16 p0, -0xa
 
-    move-result-object v7
+    return p0
+.end method
 
-    filled-new-array {v6, v7}, [Ljava/lang/Object;
+.method public final resetPasswordWithToken(Ljava/lang/String;[BI)Z
+    .locals 9
 
-    move-result-object v6
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
 
-    invoke-static {v5, v6}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    move-result v0
 
-    move-result-object v5
+    if-eqz v0, :cond_4
 
-    invoke-static {v3, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
 
-    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    move-result v3
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    if-eq v3, v4, :cond_7
+    const-string/jumbo v1, "Reset password with token for user "
 
-    if-eqz v3, :cond_5
+    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    const/4 v4, 0x1
+    invoke-virtual {v0, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    if-eq v3, v4, :cond_4
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    goto :goto_2
+    move-result-object v0
 
-    :cond_4
-    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->getTimeout()I
+    const-string/jumbo v1, "VirtualLockImpl"
 
-    move-result v2
+    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    const-string/jumbo v0, "SdpManagerImpl"
+    invoke-static {p3}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
 
-    const-string/jumbo v3, "unlock :: User %d throttled! Please try %d ms later..."
+    move-result v0
 
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    if-nez v0, :cond_0
 
-    move-result-object v4
+    goto :goto_4
 
-    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    :cond_0
+    if-eqz p1, :cond_1
 
-    move-result-object v5
+    goto :goto_0
 
-    filled-new-array {v4, v5}, [Ljava/lang/Object;
+    :cond_1
+    const-string p1, ""
 
-    move-result-object v4
+    :goto_0
+    iget-object v0, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
 
-    invoke-static {v3, v4}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-virtual {v0, p3}, Lcom/android/server/knox/dar/DarDatabaseCache;->getLong(I)J
 
-    move-result-object v3
+    move-result-wide v3
 
-    invoke-static {v0, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    goto :goto_2
+    move-result-wide v7
 
-    :cond_5
-    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->getSecret()[B
+    :try_start_0
+    invoke-static {p1}, Landroid/app/admin/PasswordMetrics;->isNumericOnly(Ljava/lang/String;)Z
 
-    move-result-object v0
+    move-result v0
 
-    invoke-static {p1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->unlockNative(I[B)I
+    if-eqz v0, :cond_2
 
-    move-result v3
+    invoke-static {p1}, Lcom/android/internal/widget/LockscreenCredential;->createPin(Ljava/lang/CharSequence;)Lcom/android/internal/widget/LockscreenCredential;
 
-    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    move-result-object p1
 
-    move-result-object v3
+    :goto_1
+    move-object v2, p1
 
-    invoke-static {v3}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
+    goto :goto_2
 
-    move-result v3
+    :catchall_0
+    move-exception v0
 
-    if-eqz v3, :cond_6
+    move-object p0, v0
 
-    const-string/jumbo v3, "SdpManagerImpl"
+    goto :goto_3
 
-    const-string/jumbo v4, "unlock :: Failed in native unlock with user "
+    :cond_2
+    invoke-static {p1}, Lcom/android/internal/widget/LockscreenCredential;->createPasswordOrNone(Ljava/lang/CharSequence;)Lcom/android/internal/widget/LockscreenCredential;
 
-    invoke-static {p1, v4, v3}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    move-result-object p1
 
     goto :goto_1
 
-    :cond_6
-    const/4 v2, 0x0
+    :goto_2
+    iget-object p1, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
 
-    :goto_1
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
+    if-nez p1, :cond_3
 
-    goto :goto_2
+    const-class p1, Lcom/android/internal/widget/LockSettingsInternal;
 
-    :cond_7
-    move v2, v4
+    invoke-static {p1}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
 
-    :goto_2
-    if-nez v2, :cond_8
+    move-result-object p1
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
+    check-cast p1, Lcom/android/internal/widget/LockSettingsInternal;
 
-    monitor-enter v0
+    iput-object p1, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
 
-    const/4 v3, 0x2
+    :cond_3
+    iget-object p0, p0, Lcom/android/server/knox/dar/VirtualLockImpl;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
 
-    :try_start_2
-    invoke-virtual {p0, v1, v3}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->setEngineStateLocked(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;I)V
+    invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
 
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+    move-result-object p0
 
-    const-string/jumbo v0, "UTF-8"
+    new-instance v1, Lcom/android/server/knox/dar/VirtualLockImpl$$ExternalSyntheticLambda0;
 
-    invoke-static {v0}, Ljava/nio/charset/Charset;->forName(Ljava/lang/String;)Ljava/nio/charset/Charset;
+    move-object v5, p2
 
-    move-result-object v0
+    move v6, p3
 
-    invoke-virtual {p2, v0}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
+    invoke-direct/range {v1 .. v6}, Lcom/android/server/knox/dar/VirtualLockImpl$$ExternalSyntheticLambda0;-><init>(Lcom/android/internal/widget/LockscreenCredential;J[BI)V
 
-    move-result-object p2
+    invoke-virtual {p0, v1}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedCredentialMap:Ljava/util/Map;
+    move-result-object p0
 
-    const-string/jumbo v1, "credential"
+    sget-object p1, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
 
-    invoke-virtual {p0, v0, v1, p2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->cacheSafe(Ljava/util/Map;Ljava/lang/String;[BI)V
+    invoke-virtual {p0, p1}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
 
-    return v2
+    move-result-object p0
 
-    :catchall_0
-    move-exception p0
+    check-cast p0, Ljava/lang/Boolean;
 
-    :try_start_3
-    monitor-exit v0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
+    invoke-virtual {p0}, Ljava/lang/Boolean;->booleanValue()Z
 
-    throw p0
+    move-result p0
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    :cond_8
-    return v2
+    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :catchall_1
-    move-exception p0
+    return p0
 
-    :try_start_4
-    monitor-exit v0
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
+    :goto_3
+    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw p0
 
-    :cond_9
-    const/16 p0, -0xa
+    :cond_4
+    :goto_4
+    const/4 p0, 0x0
 
     return p0
 .end method
 
-.method public final unlockViaTrusted(Ljava/lang/String;Ljava/lang/String;)I
-    .locals 7
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_8
+.method public saveResetTokenViaProtectorForLegacy([BI)Z
+    .locals 0
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
 
-    const-string/jumbo v0, "unlockViaTrusted :: Can\'t find engine info with "
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v1, "unlockViaTrusted"
+    const-string/jumbo p0, "SdpResetToken"
 
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkCallerPermissionFor(Ljava/lang/String;)V
+    invoke-static {p2, p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
 
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
+    move-result p0
 
-    monitor-enter v1
+    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
 
-    :try_start_0
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
+    return p0
+.end method
 
-    move-result-object v2
+.method public saveSpecificKeyViaProtector([BLjava/lang/String;I)Z
+    .locals 3
 
-    if-nez v2, :cond_0
+    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    const-string/jumbo p0, "SdpManagerImpl"
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    new-instance p1, Ljava/lang/StringBuilder;
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    move-result-wide v0
 
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    :try_start_0
+    filled-new-array {p1, p2}, [Ljava/lang/Object;
 
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    move-result-object v2
 
-    move-result-object p1
+    invoke-static {v2}, Lcom/android/server/knox/dar/SecureUtil;->isAnyoneEmptyHere([Ljava/lang/Object;)Z
 
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    move-result v2
 
-    const/4 p0, -0x5
+    if-nez v2, :cond_0
 
-    monitor-exit v1
+    iget-object v2, p0, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
 
-    return p0
+    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :catchall_0
-    move-exception p0
+    invoke-static {p3, p2, p1}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
 
-    goto/16 :goto_2
+    move-result p1
 
-    :cond_0
-    monitor-exit v1
+    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isAndroidDefaultEngine()Z
-
-    move-result p2
-
-    const/4 v0, -0x7
-
-    if-eqz p2, :cond_1
-
-    return v0
+    if-eqz p1, :cond_0
 
-    :cond_1
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isEngineOwner(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
+    const/4 p1, 0x1
 
-    move-result p2
+    goto :goto_0
 
-    if-nez p2, :cond_2
+    :catchall_0
+    move-exception p1
 
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isPrivileged(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
+    goto :goto_1
 
-    move-result p2
+    :cond_0
+    const/4 p1, 0x0
 
-    if-nez p2, :cond_2
+    :goto_0
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSystemComponent(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    move-result p2
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    if-nez p2, :cond_2
+    return p1
 
-    const-string/jumbo p0, "SdpManagerImpl"
+    :goto_1
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    const-string/jumbo p1, "unlockViaTrusted :: Permission denied to invoke engine control API"
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return v0
+    throw p1
+.end method
 
-    :cond_2
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
+.method public saveTokenHandleViaProtectorForLegacy(JI)Z
+    .locals 2
 
-    move-result p2
+    sget-object v0, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
 
-    invoke-static {p2}, Landroid/os/UserHandle;->getUserId(I)I
+    const/16 v0, 0x8
 
-    move-result p2
+    invoke-static {v0}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
 
-    new-instance v0, Ljava/lang/StringBuilder;
+    move-result-object v0
 
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
+    sget-object v1, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
 
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v1}, Ljava/nio/ByteBuffer;->order(Ljava/nio/ByteOrder;)Ljava/nio/ByteBuffer;
 
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, p1, p2}, Ljava/nio/ByteBuffer;->putLong(J)Ljava/nio/ByteBuffer;
 
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v0}, Ljava/nio/ByteBuffer;->array()[B
 
     move-result-object p1
 
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
 
-    move-result v0
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
+    const-string/jumbo p0, "SdpTokenHandle"
 
-    move-result-wide v3
+    invoke-static {p3, p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
 
-    :try_start_1
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
+    move-result p0
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
 
-    invoke-static {p2, p1}, Lcom/android/server/knox/dar/KeyProtector;->release(ILjava/lang/String;)[B
+    return p0
+.end method
 
-    move-result-object p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_3
+.method public final saveTokenIntoTrusted(Ljava/lang/String;Ljava/lang/String;)I
+    .locals 0
 
-    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
+    const/16 p0, -0xa
 
-    move-result p2
+    return p0
+.end method
 
-    if-eqz p2, :cond_3
+.method public final setDualDarInfo(II)Z
+    .locals 1
 
-    const-string/jumbo p0, "SdpManagerImpl"
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
 
-    const-string/jumbo p1, "unlockViaTrusted :: Failed to get token for user "
+    move-result v0
 
-    invoke-static {v0, p1, p0}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    if-eqz v0, :cond_0
 
-    const/4 p0, -0x2
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    return p0
+    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    :cond_3
-    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getTokenHandleViaProtector(I)J
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    move-result-wide v3
+    const-string/jumbo p0, "setDualDarInfo"
 
-    const-wide/16 v5, 0x0
+    invoke-static {p0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
 
-    cmp-long p2, v3, v5
+    const-class p0, Lcom/android/server/pm/UserManagerInternal;
 
-    if-nez p2, :cond_4
+    invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
 
-    const-string/jumbo p1, "SdpManagerImpl"
+    move-result-object v0
 
-    const-string/jumbo p2, "unlockViaTrusted :: Failed to get token handle for user"
+    check-cast v0, Lcom/android/server/pm/UserManagerInternal;
 
-    invoke-static {v0, p2, p1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    if-eqz v0, :cond_0
 
-    sget-object p1, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
 
-    goto :goto_0
+    move-result-object p0
 
-    :cond_4
-    iget-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
+    check-cast p0, Lcom/android/server/pm/UserManagerInternal;
 
-    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {p0, p1, p2}, Lcom/android/server/pm/UserManagerInternal;->setDualDarInfo(II)Z
 
-    new-instance v1, Ljava/lang/StringBuilder;
+    move-result p0
 
-    const-string/jumbo v5, "Verify token for user "
+    return p0
 
-    invoke-direct {v1, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    :cond_0
+    const/4 p0, 0x0
 
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    return p0
+.end method
 
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+.method public final setInnerAuthUserId(II)V
+    .locals 1
 
-    move-result-object v1
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
 
-    const-string/jumbo v5, "SdpManagerImpl.VirtualLock"
+    move-result v0
 
-    invoke-static {v5, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    if-eqz v0, :cond_0
 
-    iget-object v1, p2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->this$0:Ljava/lang/Object;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    check-cast v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$misVirtualUserId(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)Z
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    move-result v1
+    const-string/jumbo v0, "setInnerAuthUserId"
 
-    if-nez v1, :cond_5
+    invoke-static {v0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
 
-    sget-object p1, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
 
-    goto :goto_0
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :cond_5
-    iget-object p2, p2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    invoke-static {p1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
 
-    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    move-result-object p1
 
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
+    const-string/jumbo v0, "ddar.inner.auth.userid"
 
-    move-result-wide v5
+    invoke-virtual {p0, p2, v0, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
 
-    :try_start_2
-    invoke-virtual {p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getLockSettings()Ljava/util/Optional;
+    :cond_0
+    return-void
+.end method
 
-    move-result-object p2
+.method public final setMainUserId(II)V
+    .locals 1
 
-    new-instance v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4;
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
 
-    invoke-direct {v1, v3, v4, p1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4;-><init>(J[BI)V
+    move-result v0
 
-    invoke-virtual {p2, v1}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
+    if-eqz v0, :cond_0
 
-    move-result-object p1
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    sget-object p2, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    invoke-virtual {p1, p2}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    move-result-object p1
+    const-string/jumbo v0, "setMainUserId"
 
-    check-cast p1, Lcom/android/internal/widget/VerifyCredentialResponse;
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_2
+    invoke-static {v0}, Lcom/android/server/knox/dar/DarManagerService$Injector;->enforceCallerKnoxCoreOrSelf(Ljava/lang/String;)V
 
-    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
 
-    :goto_0
-    invoke-virtual {p1}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    move-result p2
+    invoke-static {p1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
 
-    if-eqz p2, :cond_7
+    move-result-object p1
 
-    invoke-virtual {p1}, Lcom/android/internal/widget/VerifyCredentialResponse;->getSecret()[B
+    const-string/jumbo v0, "ddar.inner.main.userid"
 
-    move-result-object p2
+    invoke-virtual {p0, p2, v0, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
 
-    invoke-static {v0, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->unlockNative(I[B)I
+    :cond_0
+    return-void
+.end method
 
-    move-result v1
+.method public final setPassword(Ljava/lang/String;Ljava/lang/String;)I
+    .locals 0
 
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    move-result-object v1
+    const/16 p0, -0xa
 
-    invoke-static {v1}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
+    return p0
+.end method
 
-    move-result v1
+.method public final setResetPasswordToken([BI)Z
+    .locals 10
 
-    if-eqz v1, :cond_6
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isVirtualLockSupported()Z
 
-    const-string/jumbo v1, "SdpManagerImpl"
+    move-result v0
 
-    const-string/jumbo v3, "unlockViaTrusted :: Failed in native unlock with user "
+    const/4 v1, 0x0
 
-    invoke-static {v0, v3, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    if-eqz v0, :cond_4
 
-    :cond_6
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
+    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
 
-    monitor-enter v1
+    const-string/jumbo v2, "vl.rst.token.handle"
 
-    const/4 v3, 0x2
+    iget-object v3, v0, Lcom/android/server/knox/dar/VirtualLockImpl;->mDarDatabaseCache:Lcom/android/server/knox/dar/DarDatabaseCache;
 
-    :try_start_3
-    invoke-virtual {p0, v2, v3}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->setEngineStateLocked(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;I)V
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    monitor-exit v1
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    const-string/jumbo v5, "Set reset password token for user "
 
-    invoke-static {p2}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
+    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    const/4 p0, 0x0
+    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    goto :goto_1
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    :catchall_1
-    move-exception p0
+    move-result-object v4
 
-    :try_start_4
-    monitor-exit v1
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
+    const-string/jumbo v5, "VirtualLockImpl"
 
-    throw p0
+    invoke-static {v5, v4}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    :cond_7
-    const/16 p0, -0x63
+    invoke-static {p2}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
 
-    :goto_1
-    const-string/jumbo p2, "SdpManagerImpl"
+    move-result v4
 
-    const-string/jumbo v1, "unlockViaTrusted :: Result of virtual user %d verification : %s"
+    const/4 v5, 0x1
 
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    if-nez v4, :cond_0
 
-    move-result-object v0
+    move p1, v1
 
-    invoke-virtual {p1}, Lcom/android/internal/widget/VerifyCredentialResponse;->toString()Ljava/lang/String;
+    goto :goto_1
 
-    move-result-object p1
+    :cond_0
+    if-eqz p1, :cond_3
 
-    filled-new-array {v0, p1}, [Ljava/lang/Object;
+    array-length v4, p1
 
-    move-result-object p1
+    const/16 v6, 0x20
 
-    invoke-static {v1, p1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    if-lt v4, v6, :cond_3
 
-    move-result-object p1
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    invoke-static {p2, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    move-result-wide v6
 
-    return p0
+    :try_start_0
+    invoke-virtual {v3, p2}, Lcom/android/server/knox/dar/DarDatabaseCache;->getLong(I)J
 
-    :catchall_2
-    move-exception p0
+    move-result-wide v8
 
-    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-virtual {v0, p2, v8, v9}, Lcom/android/server/knox/dar/VirtualLockImpl;->clearResetPasswordTokenInternal(IJ)Z
 
-    throw p0
+    iget-object v4, v0, Lcom/android/server/knox/dar/VirtualLockImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    :catchall_3
-    move-exception p0
+    iget-object v0, v0, Lcom/android/server/knox/dar/VirtualLockImpl;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService$Injector;->mEscrowTokenStateChangeCallback:Lcom/android/server/knox/dar/DarManagerService$$ExternalSyntheticLambda1;
 
-    throw p0
+    invoke-virtual {v4, p1, p2, v0}, Lcom/android/internal/widget/LockPatternUtils;->addEscrowToken([BILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
 
-    :goto_2
-    :try_start_5
-    monitor-exit v1
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_0
+    move-result-wide v8
 
-    throw p0
+    invoke-static {v8, v9}, Ljava/lang/String;->valueOf(J)Ljava/lang/String;
 
-    :cond_8
-    const/16 p0, -0xa
+    move-result-object p1
 
-    return p0
-.end method
+    invoke-virtual {v3, p2, v2, p1}, Lcom/android/server/knox/dar/DarDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-.method public final unregisterClient(ILcom/samsung/android/knox/dar/sdp/ISdpListener;)V
-    .locals 9
+    const-wide/16 v2, 0x0
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
+    cmp-long p1, v8, v2
 
-    move-result v0
+    if-eqz p1, :cond_1
 
-    if-eqz v0, :cond_7
+    move p1, v5
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    goto :goto_0
 
-    if-eqz p2, :cond_6
+    :cond_1
+    move p1, v1
 
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
+    :goto_0
+    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    move-result-object v0
+    :goto_1
+    if-eqz p1, :cond_2
 
-    if-nez v0, :cond_0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isDualDarDoSupported()Z
 
-    goto/16 :goto_5
+    move-result v0
 
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
+    if-eqz v0, :cond_2
 
-    monitor-enter v0
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
 
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
 
-    move-result-object v2
+    move-result v0
 
-    check-cast v1, Ljava/util/HashMap;
+    if-eqz v0, :cond_2
 
-    invoke-virtual {v1, v2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->getInnerAuthUserId(I)I
 
-    move-result-object v1
+    move-result v0
 
-    check-cast v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;
+    if-ne v0, p2, :cond_2
 
-    const/4 v2, 0x0
+    iget-boolean p2, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
 
-    if-nez v1, :cond_1
+    if-nez p2, :cond_2
 
-    const-string/jumbo p2, "SdpManagerImpl"
+    iput-boolean v5, p0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;->mHasTokenSetForInner:Z
 
-    const-string/jumbo v1, "unregisterClient :: Already cleared..."
+    new-instance p2, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;
 
-    invoke-static {p2, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-direct {p2, p0}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;)V
 
-    move v4, v2
+    invoke-static {p2}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
 
-    goto :goto_2
+    :cond_2
+    return p1
 
     :catchall_0
     move-exception p0
 
-    goto/16 :goto_4
+    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :cond_1
-    iget-object v1, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;->mStateListeners:Ljava/util/ArrayList;
+    throw p0
 
-    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I
+    :cond_3
+    new-instance p0, Ljava/lang/IllegalArgumentException;
 
-    move-result v3
+    const-string/jumbo p1, "token must be at least 32-byte long"
 
-    move v4, v2
+    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
 
-    move v5, v4
+    throw p0
 
-    :cond_2
-    :goto_0
-    if-ge v5, v3, :cond_4
+    :cond_4
+    return v1
+.end method
 
-    invoke-virtual {v1, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+.method public setResetTokenForLegacy([BI)Z
+    .locals 8
 
-    move-result-object v6
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    add-int/lit8 v5, v5, 0x1
+    const-string/jumbo v1, "Set reset token for Legacy user "
 
-    check-cast v6, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;
+    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-interface {p2}, Lcom/samsung/android/knox/dar/sdp/ISdpListener;->asBinder()Landroid/os/IBinder;
+    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    move-result-object v7
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    iget-object v8, v6, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mWeakListener:Ljava/lang/ref/WeakReference;
+    move-result-object v0
 
-    invoke-virtual {v8}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;
+    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    move-result-object v8
+    iget-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    check-cast v8, Lcom/samsung/android/knox/dar/sdp/ISdpListener;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    if-nez v8, :cond_3
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    const/4 v8, 0x0
+    move-result-wide v0
 
-    goto :goto_1
+    const/4 v2, 0x0
 
-    :cond_3
-    invoke-interface {v8}, Lcom/samsung/android/knox/dar/sdp/ISdpListener;->asBinder()Landroid/os/IBinder;
+    const/4 v3, 0x0
 
-    move-result-object v8
+    :try_start_0
+    iget-object v4, p0, Lcom/android/server/knox/dar/DarManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    :goto_1
-    invoke-interface {v7, v8}, Landroid/os/IBinder;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v4, p1, p2, v3}, Lcom/android/internal/widget/LockPatternUtils;->addEscrowToken([BILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
 
-    move-result v7
+    move-result-wide v4
 
-    if-eqz v7, :cond_2
+    const-wide/16 v6, 0x0
 
-    invoke-virtual {v6}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->dispose()V
+    cmp-long p1, v4, v6
 
-    add-int/lit8 v4, v4, 0x1
+    const/4 v6, 0x1
 
-    goto :goto_0
+    if-eqz p1, :cond_0
 
-    :cond_4
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->handleEmptyListenerRoll(I)V
+    invoke-virtual {p0, v4, v5, p2}, Lcom/android/server/knox/dar/DarManagerService;->saveTokenHandleViaProtectorForLegacy(JI)Z
 
-    :goto_2
-    iget-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
+    move-result p1
 
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    if-eqz p1, :cond_0
 
-    move-result-object v1
+    move v2, v6
 
-    check-cast p2, Ljava/util/HashMap;
+    goto :goto_0
 
-    invoke-virtual {p2, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
+    :catchall_0
+    move-exception p1
 
-    move-result-object p2
+    goto :goto_4
 
-    if-nez p2, :cond_5
+    :catch_0
+    move-exception p1
 
-    goto :goto_3
+    goto :goto_2
 
-    :cond_5
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
+    :cond_0
+    :goto_0
+    invoke-static {v2}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
 
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    move-result-object p1
 
-    move-result-object p2
+    sget-object v6, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
 
-    check-cast p0, Ljava/util/HashMap;
+    invoke-virtual {p1}, Ljava/lang/Boolean;->booleanValue()Z
 
-    invoke-virtual {p0, p2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
+    move-result p1
 
-    move-result-object p0
+    if-nez p1, :cond_1
 
-    check-cast p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;
+    iget-object p1, p0, Lcom/android/server/knox/dar/DarManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;->mStateListeners:Ljava/util/ArrayList;
+    invoke-virtual {p1, v4, v5, p2}, Lcom/android/internal/widget/LockPatternUtils;->removeEscrowToken(JI)Z
+    :try_end_0
+    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-virtual {p0}, Ljava/util/ArrayList;->size()I
+    :cond_1
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    move-result v2
+    :goto_1
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :goto_3
-    const-string/jumbo p0, "SdpManagerImpl"
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    const-string/jumbo p2, "unregisterClient :: Engine Id = %d, Roll Size = %d, Result = %d"
+    goto :goto_3
 
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    :goto_2
+    :try_start_1
+    invoke-virtual {p1}, Ljava/lang/Exception;->printStackTrace()V
 
-    move-result-object p1
+    const-string/jumbo p2, "Unexpected exception while set reset token for Legacy"
 
-    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {p1, v3, p2}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    move-result-object v1
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    goto :goto_1
 
-    move-result-object v2
+    :goto_3
+    new-instance p0, Ljava/lang/StringBuilder;
 
-    filled-new-array {p1, v1, v2}, [Ljava/lang/Object;
+    const-string/jumbo p1, "Result of set reset token for Legacy : "
 
-    move-result-object p1
+    invoke-direct {p0, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-static {p2, p1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-virtual {p0, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    move-result-object p1
+    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    move-result-object p0
 
-    monitor-exit v0
+    invoke-static {v3, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    return-void
+    return v2
 
     :goto_4
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mInjector:Lcom/android/server/knox/dar/DarManagerService$Injector;
 
-    :cond_6
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :cond_7
-    :goto_5
-    return-void
+    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+
+    throw p1
 .end method
 
-.method public final unregisterListener(Ljava/lang/String;Lcom/samsung/android/knox/dar/sdp/ISdpListener;)I
-    .locals 8
+.method public final setSensitive(ILjava/lang/String;)Z
+    .locals 0
 
     invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    move-result v0
-
-    if-eqz v0, :cond_5
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    const/4 p0, 0x0
 
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    return p0
+.end method
 
-    const-string/jumbo v0, "SdpManagerImpl"
+.method public final startMonitoring(IILandroid/os/Bundle;Lcom/samsung/android/knox/zt/devicetrust/IEndpointMonitorListener;)I
+    .locals 0
 
-    const-string/jumbo v1, "unregisterListener"
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
 
-    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mEndpointMonitorImpl:Lcom/android/server/knox/zt/devicetrust/EndpointMonitorImpl;
 
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
+    if-eqz p0, :cond_0
 
-    monitor-enter v0
+    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/knox/zt/devicetrust/EndpointMonitorImpl;->startMonitoring(IILandroid/os/Bundle;Lcom/samsung/android/knox/zt/devicetrust/IEndpointMonitorListener;)I
 
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
+    move-result p0
 
-    move-result-object p1
+    return p0
 
-    if-nez p1, :cond_0
+    :cond_0
+    const/4 p0, -0x6
 
-    const/4 p0, -0x5
+    return p0
+.end method
 
-    monitor-exit v0
+.method public final startTracing(IILandroid/os/Bundle;Lcom/samsung/android/knox/zt/devicetrust/IEndpointMonitorListener;)I
+    .locals 0
 
-    return p0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
 
-    :catchall_0
-    move-exception p0
+    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/knox/dar/DarManagerService;->startMonitoring(IILandroid/os/Bundle;Lcom/samsung/android/knox/zt/devicetrust/IEndpointMonitorListener;)I
 
-    goto :goto_2
+    move-result p0
 
-    :cond_0
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    return p0
+.end method
 
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
+.method public final stopMonitoring(II)I
+    .locals 0
 
-    monitor-enter v1
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
 
-    :try_start_1
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
+    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mEndpointMonitorImpl:Lcom/android/server/knox/zt/devicetrust/EndpointMonitorImpl;
 
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
+    if-eqz p0, :cond_0
 
-    move-result-object v2
+    invoke-virtual {p0, p1, p2}, Lcom/android/server/knox/zt/devicetrust/EndpointMonitorImpl;->stopMonitoring(II)I
 
-    check-cast v0, Ljava/util/HashMap;
+    move-result p0
 
-    invoke-virtual {v0, v2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
+    return p0
 
-    move-result-object v0
+    :cond_0
+    const/4 p0, -0x6
 
-    check-cast v0, Ljava/util/ArrayList;
+    return p0
+.end method
 
-    const/4 v2, 0x0
+.method public final stopTracing(II)I
+    .locals 0
 
-    if-nez v0, :cond_1
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->checkSystemPermission()V
 
-    monitor-exit v1
+    invoke-virtual {p0, p1, p2}, Lcom/android/server/knox/dar/DarManagerService;->stopMonitoring(II)I
 
-    return v2
+    move-result p0
 
-    :catchall_1
-    move-exception p0
+    return p0
+.end method
 
-    goto :goto_1
+.method public final systemReady()V
+    .locals 3
 
-    :cond_1
-    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I
+    const-string v0, "DarManagerService"
 
-    move-result v3
+    const-string/jumbo v1, "systemReady for DarManagerService"
 
-    move v4, v2
+    invoke-static {v0, v1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_2
-    :goto_0
-    if-ge v4, v3, :cond_3
+    new-instance v0, Landroid/os/HandlerThread;
 
-    invoke-virtual {v0, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    const-string v1, "DarManagerService"
 
-    move-result-object v5
+    const/16 v2, 0xa
 
-    add-int/lit8 v4, v4, 0x1
+    invoke-direct {v0, v1, v2}, Landroid/os/HandlerThread;-><init>(Ljava/lang/String;I)V
 
-    check-cast v5, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;
+    invoke-virtual {v0}, Landroid/os/HandlerThread;->start()V
 
-    iget-object v6, v5, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;->mListener:Lcom/samsung/android/knox/dar/sdp/ISdpListener;
+    new-instance v1, Lcom/android/server/knox/dar/DarManagerService$DarHandler;
 
-    invoke-interface {v6}, Lcom/samsung/android/knox/dar/sdp/ISdpListener;->asBinder()Landroid/os/IBinder;
+    invoke-virtual {v0}, Landroid/os/HandlerThread;->getLooper()Landroid/os/Looper;
 
-    move-result-object v6
+    move-result-object v0
 
-    invoke-interface {p2}, Lcom/samsung/android/knox/dar/sdp/ISdpListener;->asBinder()Landroid/os/IBinder;
+    invoke-direct {v1, p0, v0}, Lcom/android/server/knox/dar/DarManagerService$DarHandler;-><init>(Lcom/android/server/knox/dar/DarManagerService;Landroid/os/Looper;)V
 
-    move-result-object v7
+    iput-object v1, p0, Lcom/android/server/knox/dar/DarManagerService;->mDarHandler:Lcom/android/server/knox/dar/DarManagerService$DarHandler;
 
-    if-ne v6, v7, :cond_2
+    const/4 v0, 0x0
 
-    invoke-virtual {v0, v5}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I
+    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/DarManagerService;->prepareSecuredDataKey(I)V
 
-    move-result v6
+    const-class p0, Lcom/android/server/knox/dar/DarManagerService;
 
-    invoke-virtual {v0, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
+    monitor-enter p0
 
-    invoke-interface {p2}, Lcom/samsung/android/knox/dar/sdp/ISdpListener;->asBinder()Landroid/os/IBinder;
+    :try_start_0
+    monitor-exit p0
 
-    move-result-object v6
+    return-void
 
-    invoke-interface {v6, v5, v2}, Landroid/os/IBinder;->unlinkToDeath(Landroid/os/IBinder$DeathRecipient;I)Z
+    :catchall_0
+    move-exception v0
 
-    goto :goto_0
+    monitor-exit p0
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    :cond_3
-    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I
+    throw v0
+.end method
 
-    move-result p2
+.method public final unlock(Ljava/lang/String;Ljava/lang/String;)I
+    .locals 0
 
-    if-nez p2, :cond_4
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
+    const/16 p0, -0xa
 
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
+    return p0
+.end method
 
-    move-result-object p1
+.method public final unlockViaTrusted(Ljava/lang/String;Ljava/lang/String;)I
+    .locals 0
 
-    check-cast p0, Ljava/util/HashMap;
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    invoke-virtual {p0, p1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
+    const/16 p0, -0xa
 
-    :cond_4
-    monitor-exit v1
+    return p0
+.end method
 
-    return v2
+.method public final unregisterClient(ILcom/samsung/android/knox/dar/sdp/ISdpListener;)V
+    .locals 0
 
-    :goto_1
-    monitor-exit v1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    throw p0
+    return-void
+.end method
 
-    :goto_2
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+.method public final unregisterListener(Ljava/lang/String;Lcom/samsung/android/knox/dar/sdp/ISdpListener;)I
+    .locals 0
 
-    throw p0
+    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
 
-    :cond_5
     const/16 p0, -0xa
 
     return p0
diff --git a/smali/com/android/server/knox/dar/DarUtil.smali b/smali/com/android/server/knox/dar/DarUtil.smali
index 3308a909d..05d69054b 100644
--- a/smali/com/android/server/knox/dar/DarUtil.smali
+++ b/smali/com/android/server/knox/dar/DarUtil.smali
@@ -3,10 +3,6 @@
 .source "SourceFile"
 
 
-# static fields
-.field public static mIsDeviceOwnerEnabled:Z = false
-
-
 # direct methods
 .method public static credentialTypeToString(I)Ljava/lang/String;
     .locals 1
@@ -56,98 +52,87 @@
     return-object p0
 .end method
 
-.method public static isDaemonRunning(Ljava/lang/String;)Z
-    .locals 5
-
-    invoke-virtual {p0}, Ljava/lang/String;->isEmpty()Z
-
-    move-result v0
-
-    const-string v1, "DARUtil"
-
-    const/4 v2, 0x0
-
-    if-eqz v0, :cond_0
-
-    const-string/jumbo p0, "isDaemonRunning() - Invalid service name"
+.method public static isDaemonRunning()Z
+    .locals 6
 
-    invoke-static {v1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    const-string v0, "DARUtil"
 
-    return v2
+    const-string/jumbo v1, "init.svc."
 
-    :cond_0
-    const-string/jumbo v0, "init.svc."
+    const-string/jumbo v2, "dualdard"
 
-    invoke-virtual {v0, p0}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
+    invoke-virtual {v1, v2}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object p0
+    move-result-object v1
 
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v3
+    move-result-wide v2
+
+    const/4 v4, 0x0
 
     :try_start_0
-    invoke-static {p0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+    invoke-static {v1}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
 
-    move-result-object p0
+    move-result-object v1
 
-    if-eqz p0, :cond_2
+    if-eqz v1, :cond_1
 
-    invoke-virtual {p0}, Ljava/lang/String;->isEmpty()Z
+    invoke-virtual {v1}, Ljava/lang/String;->isEmpty()Z
 
-    move-result v0
+    move-result v5
 
-    if-eqz v0, :cond_1
+    if-eqz v5, :cond_0
 
     goto :goto_0
 
-    :cond_1
+    :cond_0
     const-string/jumbo v0, "running"
 
-    invoke-virtual {v0, p0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v2
+    move-result v4
 
     goto :goto_1
 
     :catchall_0
-    move-exception p0
+    move-exception v0
 
     goto :goto_3
 
     :catch_0
-    move-exception p0
+    move-exception v0
 
     goto :goto_2
 
-    :cond_2
+    :cond_1
     :goto_0
-    const-string/jumbo p0, "isDaemonRunning() - Service not found"
+    const-string/jumbo v1, "isDaemonRunning() - Service not found"
 
-    invoke-static {v1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
     :try_end_0
     .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     :goto_1
-    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return v2
+    return v4
 
     :goto_2
     :try_start_1
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
+    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return v2
+    return v4
 
     :goto_3
-    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    throw p0
+    throw v0
 .end method
 
 .method public static isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
@@ -157,9 +142,7 @@
 
     move-result v0
 
-    const/4 v1, 0x1
-
-    const-string v2, "DARUtil"
+    const-string v1, "DARUtil"
 
     if-nez v0, :cond_0
 
@@ -192,48 +175,30 @@
 
     move-result v0
 
-    if-eqz v0, :cond_5
+    if-eqz v0, :cond_2
 
     :cond_1
     iget v0, p0, Landroid/content/pm/UserInfo;->id:I
 
-    const/4 v3, 0x0
+    const/4 v2, 0x0
 
     if-nez v0, :cond_3
 
-    sget-boolean v0, Lcom/android/server/knox/dar/DarUtil;->mIsDeviceOwnerEnabled:Z
-
-    if-nez v0, :cond_2
-
     const-string v0, "Device owner status not updated yet..."
 
-    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {v3}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
+    invoke-static {v2}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
 
     move-result v0
 
-    :cond_2
     if-eqz v0, :cond_3
 
-    move v0, v1
-
-    goto :goto_0
+    :cond_2
+    const/4 v2, 0x1
 
     :cond_3
-    move v0, v3
-
-    :goto_0
-    if-eqz v0, :cond_4
-
-    goto :goto_1
-
-    :cond_4
-    move v1, v3
-
-    :cond_5
-    :goto_1
-    if-nez v1, :cond_6
+    if-nez v2, :cond_4
 
     new-instance v0, Ljava/lang/StringBuilder;
 
@@ -243,11 +208,11 @@
 
     iget p0, p0, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-static {v0, p0, v2}, Lcom/android/server/accessibility/GestureWakeup$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
+    invoke-static {v0, p0, v1}, Lcom/android/server/accessibility/GestureWakeup$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
 
-    return v1
+    return v2
 
-    :cond_6
+    :cond_4
     new-instance v0, Ljava/lang/StringBuilder;
 
     const-string/jumbo v3, "is enterprise user : "
@@ -256,113 +221,7 @@
 
     iget p0, p0, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-static {v0, p0, v2}, Lcom/android/server/accessibility/GestureWakeup$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
-
-    return v1
-.end method
-
-.method public static updateDeviceOwnerStatus(Z)V
-    .locals 9
-
-    const-string v0, "DARUtil"
-
-    const-string v1, "Extra factor               : "
-
-    const-string v2, "DPM device_owner property  : "
-
-    const-string v3, "Knox device_owner property : "
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v4
-
-    const/4 v6, 0x0
-
-    :try_start_0
-    invoke-static {v6}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
-
-    move-result v7
-
-    new-instance v8, Ljava/lang/StringBuilder;
-
-    invoke-direct {v8, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v8, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-static {v0, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo v3, "ro.device_owner"
-
-    invoke-static {v3, v6}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z
-
-    move-result v3
-
-    new-instance v8, Ljava/lang/StringBuilder;
-
-    invoke-direct {v8, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v8, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v0, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    invoke-direct {v2, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, p0, v1}, Lcom/android/server/accessibility/GestureWakeup$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
 
-    if-nez v7, :cond_0
-
-    if-nez v3, :cond_0
-
-    if-eqz p0, :cond_1
-
-    :cond_0
-    const/4 v6, 0x1
-
-    :cond_1
-    sput-boolean v6, Lcom/android/server/knox/dar/DarUtil;->mIsDeviceOwnerEnabled:Z
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    :try_start_1
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :goto_0
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
+    return v2
 .end method
diff --git a/smali/com/android/server/knox/dar/KeyProtector.smali b/smali/com/android/server/knox/dar/KeyProtector.smali
index f608be774..ce98aaf10 100644
--- a/smali/com/android/server/knox/dar/KeyProtector.smali
+++ b/smali/com/android/server/knox/dar/KeyProtector.smali
@@ -157,8 +157,8 @@
     return-object v1
 .end method
 
-.method public static delete(ILjava/lang/String;)Z
-    .locals 7
+.method public static delete(ILjava/lang/String;)V
+    .locals 5
 
     invoke-static {p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->attach(ILjava/lang/String;)Ljava/lang/String;
 
@@ -168,9 +168,7 @@
 
     move-result v1
 
-    const/4 v2, 0x1
-
-    const/4 v3, 0x0
+    const/4 v2, 0x0
 
     if-eqz v1, :cond_1
 
@@ -189,13 +187,13 @@
     goto :goto_0
 
     :cond_0
-    move v0, v3
+    move v0, v2
 
     goto :goto_1
 
     :cond_1
     :goto_0
-    move v0, v2
+    const/4 v0, 0x1
 
     :goto_1
     new-instance v1, Ljava/lang/StringBuilder;
@@ -204,23 +202,23 @@
 
     invoke-static {p0}, Landroid/os/Environment;->getUserSystemDirectory(I)Ljava/io/File;
 
-    move-result-object v4
+    move-result-object v3
 
-    invoke-virtual {v4}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
+    invoke-virtual {v3}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v3
 
-    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string v4, "/ENCRYPTED_KEY_"
+    const-string v3, "/ENCRYPTED_KEY_"
 
-    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string/jumbo v4, "_"
+    const-string/jumbo v3, "_"
 
-    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
@@ -228,36 +226,36 @@
 
     move-result-object v1
 
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v3, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v5, "deleteFile - File path : "
+    const-string/jumbo v4, "deleteFile - File path : "
 
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v3
 
-    const-string v5, "KeyProtector"
+    const-string v4, "KeyProtector"
 
-    invoke-static {v5, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    new-instance v4, Ljava/io/File;
+    new-instance v3, Ljava/io/File;
 
-    invoke-direct {v4, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V
+    invoke-direct {v3, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v4}, Ljava/io/File;->exists()Z
+    invoke-virtual {v3}, Ljava/io/File;->exists()Z
 
     move-result v1
 
     if-eqz v1, :cond_2
 
     :try_start_0
-    invoke-virtual {v4}, Ljava/io/File;->delete()Z
+    invoke-virtual {v3}, Ljava/io/File;->delete()Z
 
-    move-result v1
+    move-result v2
     :try_end_0
     .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
 
@@ -269,62 +267,50 @@
     invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V
 
     :cond_2
-    move v1, v3
-
     :goto_2
     if-nez v0, :cond_3
 
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v6, "Unexpected failure while delete key with "
+    const-string/jumbo v1, "Unexpected failure while delete key with "
 
-    invoke-direct {v4, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
     invoke-static {p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->attach(ILjava/lang/String;)Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v1
 
-    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v0
 
-    invoke-static {v5, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     :cond_3
-    if-nez v1, :cond_4
+    if-nez v2, :cond_4
 
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v6, "Unexpected failure while delete file with "
+    const-string/jumbo v1, "Unexpected failure while delete file with "
 
-    invoke-direct {v4, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
     invoke-static {p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->attach(ILjava/lang/String;)Ljava/lang/String;
 
     move-result-object p0
 
-    invoke-virtual {v4, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object p0
 
-    invoke-static {v5, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     :cond_4
-    if-eqz v0, :cond_5
-
-    if-eqz v1, :cond_5
-
-    goto :goto_3
-
-    :cond_5
-    move v2, v3
-
-    :goto_3
-    return v2
+    return-void
 .end method
 
 .method public static deleteSecretKey(Ljava/lang/String;)Z
@@ -483,80 +469,6 @@
     return-object v1
 .end method
 
-.method public static exists(ILjava/lang/String;)Z
-    .locals 3
-
-    invoke-static {p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->attach(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/KeyProtector;->checkSecretKey(Ljava/lang/String;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    const-string v0, "Key exists in keystore("
-
-    const-string v1, ")"
-
-    const-string v2, "KeyProtector"
-
-    invoke-static {v0, p0, v1, v2}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_0
-    return p1
-.end method
-
-.method public static getInstance()Lcom/android/server/knox/dar/KeyProtector;
-    .locals 2
-
-    sget-object v0, Lcom/android/server/knox/dar/KeyProtector;->sInstance:Lcom/android/server/knox/dar/KeyProtector;
-
-    if-nez v0, :cond_1
-
-    const-class v0, Lcom/android/server/knox/dar/KeyProtector;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/KeyProtector;->sInstance:Lcom/android/server/knox/dar/KeyProtector;
-
-    if-nez v1, :cond_0
-
-    new-instance v1, Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-direct {v1}, Ljava/lang/Object;-><init>()V
-
-    sput-object v1, Lcom/android/server/knox/dar/KeyProtector;->sInstance:Lcom/android/server/knox/dar/KeyProtector;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v1
-
-    goto :goto_1
-
-    :cond_0
-    :goto_0
-    monitor-exit v0
-
-    goto :goto_2
-
-    :goto_1
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw v1
-
-    :cond_1
-    :goto_2
-    sget-object v0, Lcom/android/server/knox/dar/KeyProtector;->sInstance:Lcom/android/server/knox/dar/KeyProtector;
-
-    return-object v0
-.end method
-
 .method public static getKeyStore()Ljava/security/KeyStore;
     .locals 3
 
@@ -707,7 +619,7 @@
 
     invoke-static {v1, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
+    invoke-static {p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)V
 
     return v2
 
@@ -876,7 +788,7 @@
 
     invoke-static {v1, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
+    invoke-static {p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)V
 
     goto :goto_7
 
@@ -899,7 +811,7 @@
 
     invoke-virtual {p2}, Ljava/io/IOException;->printStackTrace()V
 
-    invoke-static {p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
+    invoke-static {p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)V
 
     :goto_7
     return v2
diff --git a/smali/com/android/server/knox/dar/SecureUtil.smali b/smali/com/android/server/knox/dar/SecureUtil.smali
index d01e3b6b7..28593dfb2 100644
--- a/smali/com/android/server/knox/dar/SecureUtil.smali
+++ b/smali/com/android/server/knox/dar/SecureUtil.smali
@@ -37,62 +37,6 @@
     return-void
 .end method
 
-.method public static varargs clearAll([Ljava/lang/Object;)V
-    .locals 4
-
-    array-length v0, p0
-
-    if-nez v0, :cond_0
-
-    goto :goto_2
-
-    :cond_0
-    array-length v0, p0
-
-    const/4 v1, 0x0
-
-    :goto_0
-    if-ge v1, v0, :cond_2
-
-    aget-object v2, p0, v1
-
-    instance-of v3, v2, [B
-
-    if-eqz v3, :cond_1
-
-    check-cast v2, [B
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    goto :goto_1
-
-    :cond_1
-    instance-of v2, v2, Ljava/lang/String;
-
-    :goto_1
-    add-int/lit8 v1, v1, 0x1
-
-    goto :goto_0
-
-    :cond_2
-    :goto_2
-    return-void
-.end method
-
-.method public static generateRandomBytes()[B
-    .locals 2
-
-    sget-object v0, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
-
-    const/16 v1, 0x8
-
-    invoke-virtual {v0, v1}, Ljava/security/SecureRandom;->generateSeed(I)[B
-
-    move-result-object v0
-
-    return-object v0
-.end method
-
 .method public static varargs isAnyoneEmptyHere([Ljava/lang/Object;)Z
     .locals 4
 
@@ -178,47 +122,6 @@
     return p0
 .end method
 
-.method public static isFailed(Ljava/lang/Object;)Z
-    .locals 1
-
-    instance-of v0, p0, Ljava/lang/Boolean;
-
-    if-eqz v0, :cond_0
-
-    move-object v0, p0
-
-    check-cast v0, Ljava/lang/Boolean;
-
-    invoke-virtual {v0}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    :cond_0
-    instance-of v0, p0, Ljava/lang/Integer;
-
-    if-eqz v0, :cond_2
-
-    check-cast p0, Ljava/lang/Integer;
-
-    invoke-virtual {p0}, Ljava/lang/Integer;->intValue()I
-
-    move-result p0
-
-    if-eqz p0, :cond_2
-
-    :cond_1
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_2
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
 .method public static record(Z)V
     .locals 1
 
diff --git a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy.smali b/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy.smali
index d9ccf929b..b7393b4c7 100644
--- a/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy.smali
+++ b/smali/com/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy.smali
@@ -2889,9 +2889,7 @@
     .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
 
     :try_start_1
-    const-string/jumbo v1, "dualdard"
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/DarUtil;->isDaemonRunning(Ljava/lang/String;)Z
+    invoke-static {}, Lcom/android/server/knox/dar/DarUtil;->isDaemonRunning()Z
 
     move-result v1
 
diff --git a/smali/com/android/server/knox/dar/sdp/SdpDatabaseCache$1.smali b/smali/com/android/server/knox/dar/sdp/SdpDatabaseCache$1.smali
deleted file mode 100644
index 190262065..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpDatabaseCache$1.smali
+++ /dev/null
@@ -1,63 +0,0 @@
-.class Lcom/android/server/knox/dar/sdp/SdpDatabaseCache$1;
-.super Ljava/util/LinkedHashMap;
-.source "SourceFile"
-
-
-# annotations
-.annotation system Ldalvik/annotation/Signature;
-    value = {
-        "Ljava/util/LinkedHashMap<",
-        "Ljava/lang/String;",
-        "Ljava/lang/String;",
-        ">;"
-    }
-.end annotation
-
-
-# static fields
-.field private static final serialVersionUID:J = -0x5abdaf4ca421d56aL
-
-
-# instance fields
-.field final synthetic this$0:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;)V
-    .locals 2
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache$1;->this$0:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-    const/16 p1, 0xa
-
-    const/high16 v0, 0x3f400000    # 0.75f
-
-    const/4 v1, 0x1
-
-    invoke-direct {p0, p1, v0, v1}, Ljava/util/LinkedHashMap;-><init>(IFZ)V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final removeEldestEntry(Ljava/util/Map$Entry;)Z
-    .locals 0
-
-    invoke-virtual {p0}, Ljava/util/LinkedHashMap;->size()I
-
-    move-result p0
-
-    const/16 p1, 0x1e
-
-    if-lt p0, p1, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpDatabaseCache$DatabaseHelper.smali b/smali/com/android/server/knox/dar/sdp/SdpDatabaseCache$DatabaseHelper.smali
deleted file mode 100644
index ebf54cc1a..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpDatabaseCache$DatabaseHelper.smali
+++ /dev/null
@@ -1,49 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/SdpDatabaseCache$DatabaseHelper;
-.super Landroid/database/sqlite/SQLiteOpenHelper;
-.source "SourceFile"
-
-
-# virtual methods
-.method public final onCreate(Landroid/database/sqlite/SQLiteDatabase;)V
-    .locals 1
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string v0, "DB created! : "
-
-    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1}, Landroid/database/sqlite/SQLiteDatabase;->getPath()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string/jumbo v0, "SdpDatabaseCache"
-
-    invoke-static {v0, p0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string p0, "CREATE TABLE sdp_info (_id INTEGER PRIMARY KEY AUTOINCREMENT,name TEXT,user INTEGER,value TEXT);"
-
-    invoke-virtual {p1, p0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V
-
-    return-void
-.end method
-
-.method public final onUpgrade(Landroid/database/sqlite/SQLiteDatabase;II)V
-    .locals 1
-
-    const-string p0, "DB upgraded! : "
-
-    const-string p1, " to "
-
-    const-string/jumbo v0, "SdpDatabaseCache"
-
-    invoke-static {p2, p3, p0, p1, v0}, Lcom/android/server/accounts/AccountsDb$CeDatabaseHelper$$ExternalSyntheticOutline0;->m(IILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpDatabaseCache.smali b/smali/com/android/server/knox/dar/sdp/SdpDatabaseCache.smali
deleted file mode 100644
index 634f01819..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpDatabaseCache.smali
+++ /dev/null
@@ -1,556 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public final mCache:Ljava/util/HashMap;
-
-.field public final mDbReadable:Landroid/database/sqlite/SQLiteDatabase;
-
-.field public final mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-
-# direct methods
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 4
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache$1;
-
-    invoke-direct {v0, p0}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache$1;-><init>(Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mCache:Ljava/util/HashMap;
-
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache$DatabaseHelper;
-
-    const-string/jumbo v1, "sdp.db"
-
-    const/4 v2, 0x0
-
-    const/4 v3, 0x1
-
-    invoke-direct {v0, p1, v1, v2, v3}, Landroid/database/sqlite/SQLiteOpenHelper;-><init>(Landroid/content/Context;Ljava/lang/String;Landroid/database/sqlite/SQLiteDatabase$CursorFactory;I)V
-
-    invoke-virtual {v0, v3}, Landroid/database/sqlite/SQLiteOpenHelper;->setWriteAheadLoggingEnabled(Z)V
-
-    invoke-virtual {v0}, Landroid/database/sqlite/SQLiteOpenHelper;->getReadableDatabase()Landroid/database/sqlite/SQLiteDatabase;
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbReadable:Landroid/database/sqlite/SQLiteDatabase;
-
-    invoke-virtual {v0}, Landroid/database/sqlite/SQLiteOpenHelper;->getWritableDatabase()Landroid/database/sqlite/SQLiteDatabase;
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    return-void
-.end method
-
-.method public static reportError(Ljava/lang/Exception;Ljava/lang/String;)V
-    .locals 1
-
-    const-string v0, "Error occurred in "
-
-    invoke-virtual {v0, p1}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo v0, "SdpDatabaseCache"
-
-    invoke-static {v0, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    const/4 p1, 0x0
-
-    invoke-static {p0, p1, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final destroy(I)V
-    .locals 4
-
-    const-string/jumbo v0, "user=\'"
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    invoke-virtual {v1}, Landroid/database/sqlite/SQLiteDatabase;->beginTransaction()V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    const-string/jumbo v2, "sdp_info"
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v0, "\'"
-
-    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v3, 0x0
-
-    invoke-virtual {v1, v2, v0, v3}, Landroid/database/sqlite/SQLiteDatabase;->delete(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)I
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    invoke-virtual {v0}, Landroid/database/sqlite/SQLiteDatabase;->setTransactionSuccessful()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    invoke-virtual {v0}, Landroid/database/sqlite/SQLiteDatabase;->endTransaction()V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mCache:Ljava/util/HashMap;
-
-    monitor-enter v0
-
-    :try_start_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mCache:Ljava/util/HashMap;
-
-    invoke-virtual {p0}, Ljava/util/HashMap;->keySet()Ljava/util/Set;
-
-    move-result-object p0
-
-    invoke-interface {p0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
-
-    move-result-object p0
-
-    invoke-static {p1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
-
-    move-result-object p1
-
-    :cond_0
-    :goto_0
-    invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_1
-
-    invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Ljava/lang/String;
-
-    invoke-virtual {v1, p1}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    invoke-interface {p0}, Ljava/util/Iterator;->remove()V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_1
-    monitor-exit v0
-
-    return-void
-
-    :goto_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :catchall_1
-    move-exception p1
-
-    goto :goto_2
-
-    :catch_0
-    move-exception p1
-
-    :try_start_2
-    const-string/jumbo v0, "remove"
-
-    invoke-static {p1, v0}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->reportError(Ljava/lang/Exception;Ljava/lang/String;)V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    invoke-virtual {p0}, Landroid/database/sqlite/SQLiteDatabase;->endTransaction()V
-
-    return-void
-
-    :goto_2
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    invoke-virtual {p0}, Landroid/database/sqlite/SQLiteDatabase;->endTransaction()V
-
-    throw p1
-.end method
-
-.method public final getInternal(ILjava/lang/String;)Ljava/lang/String;
-    .locals 12
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "_"
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mCache:Ljava/util/HashMap;
-
-    monitor-enter v1
-
-    :try_start_0
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mCache:Ljava/util/HashMap;
-
-    invoke-virtual {v2, v0}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    const/4 v3, 0x0
-
-    if-eqz v2, :cond_0
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mCache:Ljava/util/HashMap;
-
-    invoke-virtual {v2, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Ljava/lang/String;
-
-    monitor-exit v1
-
-    move-object v1, v0
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto/16 :goto_7
-
-    :cond_0
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    move-object v1, v3
-
-    :goto_0
-    if-eqz v1, :cond_1
-
-    return-object v1
-
-    :cond_1
-    const/4 v2, 0x0
-
-    :try_start_1
-    iget-object v4, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbReadable:Landroid/database/sqlite/SQLiteDatabase;
-
-    const-string/jumbo v5, "sdp_info"
-
-    const-string/jumbo v0, "value"
-
-    filled-new-array {v0}, [Ljava/lang/String;
-
-    move-result-object v6
-
-    const-string/jumbo v7, "name=? AND user=?"
-
-    invoke-static {p1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v0
-
-    filled-new-array {p2, v0}, [Ljava/lang/String;
-
-    move-result-object v8
-
-    const/4 v11, 0x0
-
-    const/4 v9, 0x0
-
-    const/4 v10, 0x0
-
-    invoke-virtual/range {v4 .. v11}, Landroid/database/sqlite/SQLiteDatabase;->query(Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;
-
-    move-result-object v3
-
-    if-eqz v3, :cond_2
-
-    invoke-interface {v3}, Landroid/database/Cursor;->moveToFirst()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    invoke-interface {v3, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;
-
-    move-result-object v1
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    if-eqz v1, :cond_2
-
-    const/4 v2, 0x1
-
-    goto :goto_1
-
-    :catchall_1
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_6
-
-    :catch_0
-    move-exception v0
-
-    goto :goto_3
-
-    :cond_2
-    :goto_1
-    if-eqz v3, :cond_3
-
-    :goto_2
-    invoke-interface {v3}, Landroid/database/Cursor;->close()V
-
-    goto :goto_4
-
-    :goto_3
-    :try_start_2
-    const-string/jumbo v4, "get"
-
-    invoke-static {v0, v4}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->reportError(Ljava/lang/Exception;Ljava/lang/String;)V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    if-eqz v3, :cond_3
-
-    goto :goto_2
-
-    :cond_3
-    :goto_4
-    if-eqz v2, :cond_4
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string/jumbo p1, "_"
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    iget-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mCache:Ljava/util/HashMap;
-
-    monitor-enter p2
-
-    :try_start_3
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mCache:Ljava/util/HashMap;
-
-    invoke-virtual {p0, p1, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    monitor-exit p2
-
-    goto :goto_5
-
-    :catchall_2
-    move-exception v0
-
-    move-object p0, v0
-
-    monitor-exit p2
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_2
-
-    throw p0
-
-    :cond_4
-    :goto_5
-    return-object v1
-
-    :goto_6
-    if-eqz v3, :cond_5
-
-    invoke-interface {v3}, Landroid/database/Cursor;->close()V
-
-    :cond_5
-    throw p0
-
-    :goto_7
-    :try_start_4
-    monitor-exit v1
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    throw p0
-.end method
-
-.method public final putInternal(ILjava/lang/String;Ljava/lang/String;)V
-    .locals 5
-
-    const-string/jumbo v0, "sdp_info"
-
-    if-eqz p2, :cond_1
-
-    if-nez p3, :cond_0
-
-    goto :goto_1
-
-    :cond_0
-    const-string/jumbo v1, "name"
-
-    invoke-static {v1, p2}, Lcom/android/server/accounts/AccountManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Landroid/content/ContentValues;
-
-    move-result-object v1
-
-    const-string/jumbo v2, "user"
-
-    const-string/jumbo v3, "value"
-
-    invoke-static {p1, v1, v2, v3, p3}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy$$ExternalSyntheticOutline0;->m(ILandroid/content/ContentValues;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    :try_start_0
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    invoke-virtual {v2}, Landroid/database/sqlite/SQLiteDatabase;->beginTransaction()V
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    const-string/jumbo v3, "name=? AND user=?"
-
-    invoke-static {p1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v4
-
-    filled-new-array {p2, v4}, [Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {v2, v0, v3, v4}, Landroid/database/sqlite/SQLiteDatabase;->delete(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)I
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    const/4 v3, 0x0
-
-    invoke-virtual {v2, v0, v3, v1}, Landroid/database/sqlite/SQLiteDatabase;->insert(Ljava/lang/String;Ljava/lang/String;Landroid/content/ContentValues;)J
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    invoke-virtual {v0}, Landroid/database/sqlite/SQLiteDatabase;->setTransactionSuccessful()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    invoke-virtual {v0}, Landroid/database/sqlite/SQLiteDatabase;->endTransaction()V
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string/jumbo p1, "_"
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    iget-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mCache:Ljava/util/HashMap;
-
-    monitor-enter p2
-
-    :try_start_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mCache:Ljava/util/HashMap;
-
-    invoke-virtual {p0, p1, p3}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    monitor-exit p2
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit p2
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :catchall_1
-    move-exception p1
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p1
-
-    :try_start_2
-    const-string/jumbo p2, "put"
-
-    invoke-static {p1, p2}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->reportError(Ljava/lang/Exception;Ljava/lang/String;)V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    invoke-virtual {p0}, Landroid/database/sqlite/SQLiteDatabase;->endTransaction()V
-
-    goto :goto_1
-
-    :goto_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbWritable:Landroid/database/sqlite/SQLiteDatabase;
-
-    invoke-virtual {p0}, Landroid/database/sqlite/SQLiteDatabase;->endTransaction()V
-
-    throw p1
-
-    :cond_1
-    :goto_1
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0.smali
deleted file mode 100644
index 7857ced29..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0.smali
+++ /dev/null
@@ -1,90 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:I
-
-.field public final synthetic f$1:Ljava/io/File;
-
-
-# direct methods
-.method public synthetic constructor <init>(IILjava/io/File;)V
-    .locals 0
-
-    iput p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;->$r8$classId:I
-
-    iput p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;->f$0:I
-
-    iput-object p3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;->f$1:Ljava/io/File;
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 2
-
-    iget v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;->$r8$classId:I
-
-    packed-switch v0, :pswitch_data_0
-
-    iget v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;->f$0:I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;->f$1:Ljava/io/File;
-
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    invoke-virtual {p0}, Ljava/io/File;->getPath()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {p1, v0, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;->setSdpPolicyToPath(ILjava/lang/String;)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_0
-    iget v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;->f$0:I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;->f$1:Ljava/io/File;
-
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    sget-boolean v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    invoke-virtual {p0}, Ljava/io/File;->getPath()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {p1, v0, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;->setSdpPolicyToPath(ILjava/lang/String;)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-
-    nop
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1.smali
deleted file mode 100644
index 7703eae28..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1.smali
+++ /dev/null
@@ -1,154 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:Ljava/lang/String;
-
-.field public final synthetic f$1:I
-
-
-# direct methods
-.method public synthetic constructor <init>(ILjava/lang/String;I)V
-    .locals 0
-
-    iput p3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->$r8$classId:I
-
-    iput p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->f$1:I
-
-    iput-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->f$0:Ljava/lang/String;
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-.method public synthetic constructor <init>(Ljava/lang/String;II)V
-    .locals 0
-
-    iput p3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->$r8$classId:I
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->f$0:Ljava/lang/String;
-
-    iput p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->f$1:I
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 3
-
-    iget v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->$r8$classId:I
-
-    packed-switch v0, :pswitch_data_0
-
-    iget v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->f$1:I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->f$0:Ljava/lang/String;
-
-    check-cast p1, Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;
-
-    iget-object p1, p1, Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;->this$0:Lcom/android/server/pm/PackageManagerService;
-
-    invoke-virtual {p1, v0, p0}, Lcom/android/server/pm/PackageManagerService;->removeEncPkgDir(ILjava/lang/String;)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_0
-    iget v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->f$1:I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->f$0:Ljava/lang/String;
-
-    check-cast p1, Landroid/os/storage/StorageManager;
-
-    invoke-virtual {p1, v0, p0}, Landroid/os/storage/StorageManager;->setSensitive(ILjava/lang/String;)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_1
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->f$0:Ljava/lang/String;
-
-    iget p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->f$1:I
-
-    check-cast p1, Lcom/android/internal/widget/ILockSettings;
-
-    sget-boolean v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    :try_start_0
-    invoke-static {v0}, Lcom/android/internal/widget/LockscreenCredential;->createPassword(Ljava/lang/CharSequence;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v0
-
-    if-eqz v0, :cond_0
-
-    const/4 v2, 0x0
-
-    invoke-interface {p1, v0, p0, v2}, Lcom/android/internal/widget/ILockSettings;->checkCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object v1
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
-
-    :cond_0
-    :goto_0
-    return-object v1
-
-    :pswitch_2
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->f$0:Ljava/lang/String;
-
-    iget p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;->f$1:I
-
-    check-cast p1, Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;
-
-    sget-boolean v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    invoke-virtual {p1, v0, p0}, Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;->createEncAppData(Ljava/lang/String;I)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-
-    nop
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_2
-        :pswitch_1
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2.smali
deleted file mode 100644
index 7c332fa53..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2.smali
+++ /dev/null
@@ -1,74 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:I
-
-
-# direct methods
-.method public synthetic constructor <init>(II)V
-    .locals 0
-
-    iput p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2;->$r8$classId:I
-
-    iput p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2;->f$0:I
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 1
-
-    iget v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2;->$r8$classId:I
-
-    iget p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2;->f$0:I
-
-    packed-switch v0, :pswitch_data_0
-
-    check-cast p1, Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;
-
-    sget-boolean v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    invoke-virtual {p1, p0}, Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;->removeEncUserDir(I)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_0
-    check-cast p1, Lcom/android/internal/widget/LockSettingsInternal;
-
-    sget-boolean v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    invoke-virtual {p1, p0}, Lcom/android/internal/widget/LockSettingsInternal;->getCredentialType(I)I
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    return-object p0
-
-    nop
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3.smali
deleted file mode 100644
index 3720fdab7..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3.smali
+++ /dev/null
@@ -1,57 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic f$0:I
-
-.field public final synthetic f$1:J
-
-
-# direct methods
-.method public synthetic constructor <init>(IJ)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3;->f$0:I
-
-    iput-wide p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3;->f$1:J
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 3
-
-    iget v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3;->f$0:I
-
-    iget-wide v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3;->f$1:J
-
-    check-cast p1, Lcom/android/internal/widget/ILockSettings;
-
-    sget-boolean p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    :try_start_0
-    invoke-interface {p1, v0, v1, v2}, Lcom/android/internal/widget/ILockSettings;->updateSdpMdfppForSystem(IJ)V
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
-
-    :goto_0
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4.smali
deleted file mode 100644
index 1d4649d69..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4.smali
+++ /dev/null
@@ -1,64 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic f$0:[B
-
-.field public final synthetic f$1:J
-
-.field public final synthetic f$2:I
-
-
-# direct methods
-.method public synthetic constructor <init>(J[BI)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4;->f$0:[B
-
-    iput-wide p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4;->f$1:J
-
-    iput p4, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4;->f$2:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 4
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4;->f$0:[B
-
-    iget-wide v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4;->f$1:J
-
-    iget p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda4;->f$2:I
-
-    check-cast p1, Lcom/android/internal/widget/ILockSettings;
-
-    sget-boolean v3, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    :try_start_0
-    invoke-interface {p1, v0, v1, v2, p0}, Lcom/android/internal/widget/ILockSettings;->verifyToken([BJI)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p0
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-object p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$1.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$1.smali
deleted file mode 100644
index 9a39957a6..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$1.smali
+++ /dev/null
@@ -1,287 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;
-.super Landroid/content/BroadcastReceiver;
-.source "SourceFile"
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)V
-    .locals 0
-
-    iput p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;->$r8$classId:I
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-direct {p0}, Landroid/content/BroadcastReceiver;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final onReceive(Landroid/content/Context;Landroid/content/Intent;)V
-    .locals 7
-
-    const-string/jumbo p1, "SdpManagerImpl.receiver"
-
-    const-string/jumbo v0, "onReceive - "
-
-    iget v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;->$r8$classId:I
-
-    packed-switch v1, :pswitch_data_0
-
-    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
-
-    move-result-object v1
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    invoke-direct {v2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {p1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo v0, "android.intent.action.PACKAGE_REMOVED"
-
-    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    const-string/jumbo v0, "android.intent.extra.UID"
-
-    const/4 v2, -0x1
-
-    invoke-virtual {p2, v0, v2}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
-
-    move-result v0
-
-    if-ltz v0, :cond_0
-
-    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I
-
-    move-result v2
-
-    :cond_0
-    const-string/jumbo v3, "android.intent.extra.REPLACING"
-
-    const/4 v4, 0x0
-
-    invoke-virtual {p2, v3, v4}, Landroid/content/Intent;->getBooleanExtra(Ljava/lang/String;Z)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_1
-
-    const-string/jumbo v3, "android.intent.extra.DATA_REMOVED"
-
-    invoke-virtual {p2, v3, v4}, Landroid/content/Intent;->getBooleanExtra(Ljava/lang/String;Z)Z
-
-    move-result v3
-
-    if-nez v3, :cond_1
-
-    const/4 v4, 0x1
-
-    :cond_1
-    invoke-virtual {p2}, Landroid/content/Intent;->getData()Landroid/net/Uri;
-
-    move-result-object v3
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v5
-
-    invoke-static {v4}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object v6
-
-    filled-new-array {v1, v3, v0, v5, v6}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    const-string/jumbo v3, "On %s : DATA = %s, UID = %d, UserId = %d, Is replacing? %s"
-
-    invoke-static {v3, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {p1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    if-eqz v4, :cond_2
-
-    const-string/jumbo p0, "On "
-
-    const-string p2, " : Skipped!"
-
-    invoke-static {p0, v1, p2, p1}, Lcom/android/server/DualAppManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_2
-    invoke-virtual {p2}, Landroid/content/Intent;->getData()Landroid/net/Uri;
-
-    move-result-object p2
-
-    if-eqz p2, :cond_3
-
-    invoke-virtual {p2}, Landroid/net/Uri;->getSchemeSpecificPart()Ljava/lang/String;
-
-    move-result-object p2
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string v1, "ACTION_PACKAGE_REMOVED packageName:: "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {p1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance p1, Landroid/os/Bundle;
-
-    invoke-direct {p1}, Landroid/os/Bundle;-><init>()V
-
-    const-string/jumbo v0, "userId"
-
-    invoke-virtual {p1, v0, v2}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    const-string/jumbo v0, "pkgName"
-
-    invoke-virtual {p1, v0, p2}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    sget-boolean p2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    const/4 p2, 0x4
-
-    invoke-virtual {p0, p2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->quickMessage(ILandroid/os/Bundle;)V
-
-    :cond_3
-    :goto_0
-    return-void
-
-    :pswitch_0
-    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
-
-    move-result-object v1
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    invoke-direct {v2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {p1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo v0, "android.intent.action.USER_ADDED"
-
-    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    const-string/jumbo v2, "On %s : UserId = %d"
-
-    const/16 v3, -0x2710
-
-    const-string/jumbo v4, "android.intent.extra.user_handle"
-
-    if-eqz v0, :cond_4
-
-    invoke-virtual {p2, v4, v3}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
-
-    move-result p2
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    filled-new-array {v1, v0}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    invoke-static {v2, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {p1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    sget-boolean p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    const/4 p1, 0x5
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->quickMessage(II)V
-
-    goto :goto_1
-
-    :cond_4
-    const-string/jumbo v0, "android.intent.action.USER_REMOVED"
-
-    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_5
-
-    invoke-virtual {p2, v4, v3}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
-
-    move-result p2
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    filled-new-array {v1, v0}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    invoke-static {v2, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {p1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    sget-boolean p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    const/4 p1, 0x6
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->quickMessage(II)V
-
-    :cond_5
-    :goto_1
-    return-void
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$3.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$3.smali
deleted file mode 100644
index a670792fe..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$3.smali
+++ /dev/null
@@ -1,326 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;
-.super Landroid/os/ContainerStateReceiver;
-.source "SourceFile"
-
-
-# instance fields
-.field public final synthetic this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;)V
-    .locals 0
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-direct {p0}, Landroid/os/ContainerStateReceiver;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final onContainerCreated(Landroid/content/Context;ILandroid/os/Bundle;)V
-    .locals 5
-
-    const-string/jumbo p1, "Unexpected condition while find engine info with id "
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "onContainerCreated :: user: "
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo v0, "Workspace for user %d has been created"
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    filled-new-array {v1}, [Ljava/lang/Object;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    invoke-static {p2}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto/16 :goto_0
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {v1, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v1
-
-    const/4 v2, 0x0
-
-    if-nez v1, :cond_1
-
-    new-instance p0, Ljava/lang/Exception;
-
-    new-instance p3, Ljava/lang/StringBuilder;
-
-    invoke-direct {p3, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p3, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-direct {p0, p1}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
-
-    invoke-static {p0, v2, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
-
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_1
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p1, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p1
-
-    invoke-virtual {p1}, Landroid/content/pm/UserInfo;->isSecureFolder()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    const-string v4, "Identified as legacy type container user : "
-
-    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget p1, p1, Landroid/content/pm/UserInfo;->id:I
-
-    const-string v4, "DARUtil"
-
-    invoke-static {v3, p1, v4}, Lcom/android/server/accessibility/GestureWakeup$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
-
-    :cond_2
-    if-eqz v0, :cond_3
-
-    const-string/jumbo p1, "On created - User %d workspace identified as old-fashioned"
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p2
-
-    filled-new-array {p2}, [Ljava/lang/Object;
-
-    move-result-object p2
-
-    invoke-static {p1, p2}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v2, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    const-string p1, "EXTRA_RESET_TOKEN"
-
-    invoke-virtual {p3, p1, v2}, Landroid/os/Bundle;->getString(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_3
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object p1, p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter p1
-
-    :try_start_1
-    invoke-virtual {v1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getFlag()I
-
-    move-result p2
-
-    or-int/lit8 p2, p2, 0x1
-
-    invoke-virtual {v1, p2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->setFlag(I)V
-
-    iget-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object p2, p2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result p3
-
-    invoke-virtual {p2, p3, v1}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mstoreEngineInfoLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-
-    monitor-exit p1
-
-    return-void
-
-    :catchall_1
-    move-exception p0
-
-    monitor-exit p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    throw p0
-
-    :cond_3
-    :goto_0
-    return-void
-
-    :goto_1
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-.end method
-
-.method public final onContainerLocked(Landroid/content/Context;ILandroid/os/Bundle;)V
-    .locals 0
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p3, "onContainerLocked :: user: "
-
-    invoke-direct {p1, p3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo p3, "SdpManagerImpl"
-
-    invoke-static {p3, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {p2}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    invoke-static {p2}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_0
-
-    const-string p1, "Immediately lock sdp for user "
-
-    invoke-static {p2, p1, p3}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->lockSdpIfRequired(I)V
-
-    :cond_0
-    return-void
-.end method
-
-.method public final onContainerShutdown(Landroid/content/Context;ILandroid/os/Bundle;)V
-    .locals 0
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p3, "onContainerShutdown :: user: "
-
-    invoke-direct {p1, p3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo p3, "SdpManagerImpl"
-
-    invoke-static {p3, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {p2}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    invoke-static {p2}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_0
-
-    const-string p1, "Container has been shut down for user "
-
-    const/4 p3, 0x0
-
-    invoke-static {p2, p1, p3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->lockSdpIfRequired(I)V
-
-    :cond_0
-    return-void
-.end method
-
-.method public final onContainerUnlocked(Landroid/content/Context;ILandroid/os/Bundle;)V
-    .locals 0
-
-    const-string/jumbo p0, "onContainerUnlocked :: user: "
-
-    const-string/jumbo p1, "SdpManagerImpl"
-
-    invoke-static {p2, p0, p1}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll.smali
deleted file mode 100644
index 802eb7a9b..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll.smali
+++ /dev/null
@@ -1,23 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public final mStateListeners:Ljava/util/ArrayList;
-
-
-# direct methods
-.method public constructor <init>()V
-    .locals 1
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    new-instance v0, Ljava/util/ArrayList;
-
-    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;->mStateListeners:Ljava/util/ArrayList;
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase.smali
deleted file mode 100644
index 4bc117bb8..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase.smali
+++ /dev/null
@@ -1,1300 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public final mEngineInfoXmlHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-.field public final mEngineListXMLHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-.field public final synthetic this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-
-# direct methods
-.method public static -$$Nest$mgetEngineInfoLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-    .locals 20
-
-    move-object/from16 v0, p0
-
-    iget-object v1, v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->mEngineInfoXmlHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    const/4 v0, 0x3
-
-    const/4 v4, 0x0
-
-    const/4 v5, 0x0
-
-    const/4 v6, 0x0
-
-    :goto_0
-    add-int/lit8 v7, v0, -0x1
-
-    if-lez v0, :cond_a
-
-    :try_start_0
-    invoke-static/range {p1 .. p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;->getEngineInfoXmlFile(I)Landroid/util/AtomicFile;
-
-    move-result-object v5
-
-    invoke-virtual {v5}, Landroid/util/AtomicFile;->openRead()Ljava/io/FileInputStream;
-
-    move-result-object v6
-
-    invoke-static {}, Lorg/xmlpull/v1/XmlPullParserFactory;->newInstance()Lorg/xmlpull/v1/XmlPullParserFactory;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Lorg/xmlpull/v1/XmlPullParserFactory;->newPullParser()Lorg/xmlpull/v1/XmlPullParser;
-
-    move-result-object v0
-
-    const-string/jumbo v8, "UTF-8"
-
-    invoke-interface {v0, v6, v8}, Lorg/xmlpull/v1/XmlPullParser;->setInput(Ljava/io/InputStream;Ljava/lang/String;)V
-
-    invoke-interface {v0}, Lorg/xmlpull/v1/XmlPullParser;->getEventType()I
-
-    move-result v8
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    const/4 v9, -0x1
-
-    const-string v10, ""
-
-    const/4 v11, 0x0
-
-    move v12, v9
-
-    move v13, v12
-
-    move-object v14, v10
-
-    move-object v15, v14
-
-    move/from16 v16, v11
-
-    move/from16 v17, v16
-
-    move v10, v13
-
-    :goto_1
-    const/4 v2, 0x1
-
-    if-eq v8, v2, :cond_5
-
-    const/4 v3, 0x2
-
-    if-eq v8, v3, :cond_1
-
-    :cond_0
-    const/4 v8, 0x3
-
-    goto/16 :goto_4
-
-    :cond_1
-    :try_start_1
-    invoke-interface {v0}, Lorg/xmlpull/v1/XmlPullParser;->getName()Ljava/lang/String;
-
-    move-result-object v8
-
-    const-string/jumbo v3, "user"
-
-    invoke-virtual {v3, v8}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_0
-
-    const-string/jumbo v3, "alias"
-
-    invoke-interface {v0, v11}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeName(I)Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-virtual {v3, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_3
-
-    const-string/jumbo v3, "pkgName"
-
-    invoke-interface {v0, v2}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeName(I)Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-virtual {v3, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_3
-
-    const-string/jumbo v3, "id"
-
-    const/4 v8, 0x2
-
-    invoke-interface {v0, v8}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeName(I)Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v3, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_3
-
-    const-string/jumbo v2, "userid"
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    const/4 v3, 0x3
-
-    :try_start_2
-    invoke-interface {v0, v3}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeName(I)Ljava/lang/String;
-
-    move-result-object v8
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    :try_start_3
-    invoke-virtual {v2, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_3
-
-    const-string/jumbo v2, "flags"
-
-    const/4 v3, 0x4
-
-    invoke-interface {v0, v3}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeName(I)Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-virtual {v2, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_3
-
-    const-string/jumbo v2, "version"
-
-    const/4 v8, 0x5
-
-    invoke-interface {v0, v8}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeName(I)Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-virtual {v2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_3
-
-    const-string/jumbo v2, "isMigrating"
-
-    const/4 v3, 0x6
-
-    invoke-interface {v0, v3}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeName(I)Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-virtual {v2, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_3
-
-    invoke-interface {v0, v11}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeValue(I)Ljava/lang/String;
-
-    move-result-object v14
-
-    const/4 v2, 0x1
-
-    invoke-interface {v0, v2}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeValue(I)Ljava/lang/String;
-
-    move-result-object v15
-
-    const/4 v8, 0x2
-
-    invoke-interface {v0, v8}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeValue(I)Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;
-
-    move-result-object v8
-
-    invoke-virtual {v8}, Ljava/lang/Integer;->intValue()I
-
-    move-result v9
-    :try_end_3
-    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_1
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    const/4 v8, 0x3
-
-    :try_start_4
-    invoke-interface {v0, v8}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeValue(I)Ljava/lang/String;
-
-    move-result-object v10
-
-    invoke-static {v10}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;
-
-    move-result-object v10
-
-    invoke-virtual {v10}, Ljava/lang/Integer;->intValue()I
-
-    move-result v10
-
-    const/4 v12, 0x4
-
-    invoke-interface {v0, v12}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeValue(I)Ljava/lang/String;
-
-    move-result-object v12
-
-    invoke-static {v12}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;
-
-    move-result-object v12
-
-    invoke-virtual {v12}, Ljava/lang/Integer;->intValue()I
-
-    move-result v12
-
-    const/4 v13, 0x5
-
-    invoke-interface {v0, v13}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeValue(I)Ljava/lang/String;
-
-    move-result-object v13
-
-    invoke-static {v13}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;
-
-    move-result-object v13
-
-    invoke-virtual {v13}, Ljava/lang/Integer;->intValue()I
-
-    move-result v13
-
-    invoke-interface {v0, v3}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeValue(I)Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-static {v3}, Ljava/lang/Boolean;->valueOf(Ljava/lang/String;)Ljava/lang/Boolean;
-
-    move-result-object v3
-
-    invoke-virtual {v3}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result v17
-
-    invoke-virtual {v14}, Ljava/lang/String;->isEmpty()Z
-
-    move-result v3
-
-    if-nez v3, :cond_2
-
-    if-ltz v9, :cond_2
-
-    if-ltz v10, :cond_2
-
-    if-ltz v12, :cond_2
-
-    if-ltz v13, :cond_2
-
-    move/from16 v16, v2
-
-    goto :goto_2
-
-    :cond_2
-    move/from16 v16, v11
-
-    :goto_2
-    move/from16 v18, v13
-
-    move-object v13, v14
-
-    move-object v2, v15
-
-    move/from16 v3, v16
-
-    move/from16 v19, v17
-
-    move v14, v9
-
-    move v15, v10
-
-    move/from16 v17, v12
-
-    goto :goto_3
-
-    :catchall_0
-    move-exception v0
-
-    goto/16 :goto_6
-
-    :catch_0
-    move-exception v0
-
-    goto :goto_5
-
-    :catch_1
-    move-exception v0
-
-    const/4 v8, 0x3
-
-    goto :goto_5
-
-    :cond_3
-    const/4 v8, 0x3
-
-    goto :goto_2
-
-    :catch_2
-    move-exception v0
-
-    move v8, v3
-
-    goto :goto_5
-
-    :goto_3
-    if-eqz v3, :cond_4
-
-    new-instance v12, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    const/16 v16, 0x1
-
-    invoke-direct/range {v12 .. v19}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;-><init>(Ljava/lang/String;IIIIIZ)V
-    :try_end_4
-    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_0
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    :try_start_5
-    invoke-virtual {v12, v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->setPackageName(Ljava/lang/String;)V
-    :try_end_5
-    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_3
-    .catchall {:try_start_5 .. :try_end_5} :catchall_0
-
-    move/from16 v16, v3
-
-    move-object v4, v12
-
-    move v9, v14
-
-    move v10, v15
-
-    move/from16 v12, v17
-
-    move/from16 v17, v19
-
-    move-object v15, v2
-
-    move-object v14, v13
-
-    move/from16 v13, v18
-
-    goto :goto_4
-
-    :catch_3
-    move-exception v0
-
-    move-object v4, v12
-
-    goto :goto_5
-
-    :cond_4
-    :try_start_6
-    new-instance v0, Ljava/lang/Exception;
-
-    const-string/jumbo v2, "Suspicious of damaged file..."
-
-    invoke-direct {v0, v2}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
-
-    throw v0
-
-    :goto_4
-    invoke-interface {v0}, Lorg/xmlpull/v1/XmlPullParser;->next()I
-
-    move-result v2
-    :try_end_6
-    .catch Ljava/lang/Exception; {:try_start_6 .. :try_end_6} :catch_0
-    .catchall {:try_start_6 .. :try_end_6} :catchall_0
-
-    move v8, v2
-
-    goto/16 :goto_1
-
-    :cond_5
-    if-eqz v6, :cond_6
-
-    :try_start_7
-    invoke-virtual {v6}, Ljava/io/FileInputStream;->close()V
-    :try_end_7
-    .catch Ljava/io/IOException; {:try_start_7 .. :try_end_7} :catch_4
-
-    :catch_4
-    :cond_6
-    move-object v2, v4
-
-    goto :goto_7
-
-    :goto_5
-    :try_start_8
-    iget-object v2, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;->this$0:Ljava/lang/Object;
-
-    check-cast v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    iget-object v2, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v9, "EngineInfoXmlHandler :: Failed to get engine info... "
-
-    invoke-virtual {v3, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-static {v2, v0, v3}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$mrecordException(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Ljava/lang/Exception;Ljava/lang/String;)V
-    :try_end_8
-    .catchall {:try_start_8 .. :try_end_8} :catchall_0
-
-    if-eqz v5, :cond_7
-
-    const/4 v5, 0x0
-
-    :cond_7
-    if-eqz v6, :cond_8
-
-    :try_start_9
-    invoke-virtual {v6}, Ljava/io/FileInputStream;->close()V
-    :try_end_9
-    .catch Ljava/io/IOException; {:try_start_9 .. :try_end_9} :catch_5
-
-    :catch_5
-    :cond_8
-    move v0, v7
-
-    goto/16 :goto_0
-
-    :goto_6
-    if-eqz v6, :cond_9
-
-    :try_start_a
-    invoke-virtual {v6}, Ljava/io/FileInputStream;->close()V
-    :try_end_a
-    .catch Ljava/io/IOException; {:try_start_a .. :try_end_a} :catch_6
-
-    :catch_6
-    :cond_9
-    throw v0
-
-    :cond_a
-    const/4 v2, 0x0
-
-    :goto_7
-    return-object v2
-.end method
-
-.method public static -$$Nest$mgetEngineListLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;)Landroid/util/SparseArray;
-    .locals 11
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->mEngineListXMLHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    new-instance p0, Landroid/util/SparseArray;
-
-    invoke-direct {p0}, Landroid/util/SparseArray;-><init>()V
-
-    const/4 v0, 0x0
-
-    const/4 v1, 0x3
-
-    move-object v2, v0
-
-    :goto_0
-    add-int/lit8 v3, v1, -0x1
-
-    const-string/jumbo v4, "SdpManagerImpl"
-
-    if-lez v1, :cond_9
-
-    invoke-virtual {p0}, Landroid/util/SparseArray;->clear()V
-
-    const/4 v1, 0x0
-
-    :try_start_0
-    invoke-static {v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;->getEngineListXmlFile(I)Landroid/util/AtomicFile;
-
-    move-result-object v5
-
-    invoke-virtual {v5}, Landroid/util/AtomicFile;->openRead()Ljava/io/FileInputStream;
-
-    move-result-object v2
-
-    invoke-static {}, Lorg/xmlpull/v1/XmlPullParserFactory;->newInstance()Lorg/xmlpull/v1/XmlPullParserFactory;
-
-    move-result-object v5
-
-    invoke-virtual {v5}, Lorg/xmlpull/v1/XmlPullParserFactory;->newPullParser()Lorg/xmlpull/v1/XmlPullParser;
-
-    move-result-object v5
-
-    const-string/jumbo v6, "UTF-8"
-
-    invoke-interface {v5, v2, v6}, Lorg/xmlpull/v1/XmlPullParser;->setInput(Ljava/io/InputStream;Ljava/lang/String;)V
-
-    invoke-interface {v5}, Lorg/xmlpull/v1/XmlPullParser;->getEventType()I
-
-    move-result v6
-
-    const/4 v7, 0x1
-
-    move v8, v7
-
-    :goto_1
-    if-eq v6, v7, :cond_5
-
-    const/4 v9, 0x2
-
-    if-eq v6, v9, :cond_0
-
-    goto :goto_4
-
-    :cond_0
-    invoke-interface {v5}, Lorg/xmlpull/v1/XmlPullParser;->getName()Ljava/lang/String;
-
-    move-result-object v6
-
-    const-string/jumbo v9, "engine"
-
-    invoke-virtual {v9, v6}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z
-
-    move-result v6
-
-    if-eqz v6, :cond_4
-
-    const-string/jumbo v6, "alias"
-
-    invoke-interface {v5, v1}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeName(I)Ljava/lang/String;
-
-    move-result-object v9
-
-    invoke-virtual {v6, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v6
-
-    if-eqz v6, :cond_2
-
-    const-string/jumbo v6, "id"
-
-    invoke-interface {v5, v7}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeName(I)Ljava/lang/String;
-
-    move-result-object v9
-
-    invoke-virtual {v6, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v6
-
-    if-eqz v6, :cond_2
-
-    invoke-interface {v5, v1}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeValue(I)Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-interface {v5, v7}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeValue(I)Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;
-
-    move-result-object v8
-
-    invoke-virtual {v8}, Ljava/lang/Integer;->intValue()I
-
-    move-result v8
-
-    if-ltz v8, :cond_1
-
-    invoke-virtual {v6}, Ljava/lang/String;->isEmpty()Z
-
-    move-result v9
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-nez v9, :cond_1
-
-    move v9, v7
-
-    goto :goto_2
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_6
-
-    :catch_0
-    move-exception v1
-
-    goto :goto_5
-
-    :cond_1
-    move v9, v1
-
-    :goto_2
-    move v10, v9
-
-    move v9, v8
-
-    move v8, v10
-
-    goto :goto_3
-
-    :cond_2
-    const/4 v6, -0x1
-
-    const-string v9, ""
-
-    move-object v10, v9
-
-    move v9, v6
-
-    move-object v6, v10
-
-    :goto_3
-    if-eqz v8, :cond_3
-
-    :try_start_1
-    invoke-virtual {p0, v9, v6}, Landroid/util/SparseArray;->append(ILjava/lang/Object;)V
-
-    goto :goto_4
-
-    :cond_3
-    new-instance v1, Ljava/lang/Exception;
-
-    const-string/jumbo v5, "Suspicious of damaged file..."
-
-    invoke-direct {v1, v5}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
-
-    throw v1
-
-    :cond_4
-    :goto_4
-    invoke-interface {v5}, Lorg/xmlpull/v1/XmlPullParser;->next()I
-
-    move-result v6
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    goto :goto_1
-
-    :cond_5
-    if-eqz v2, :cond_a
-
-    :try_start_2
-    invoke-virtual {v2}, Ljava/io/FileInputStream;->close()V
-    :try_end_2
-    .catch Ljava/io/IOException; {:try_start_2 .. :try_end_2} :catch_3
-
-    goto :goto_7
-
-    :goto_5
-    :try_start_3
-    invoke-virtual {v1}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object v5
-
-    if-eqz v5, :cond_6
-
-    invoke-virtual {v1}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v4, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :cond_6
-    if-eqz v2, :cond_7
-
-    :try_start_4
-    invoke-virtual {v2}, Ljava/io/FileInputStream;->close()V
-    :try_end_4
-    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_1
-
-    :catch_1
-    :cond_7
-    move v1, v3
-
-    goto/16 :goto_0
-
-    :goto_6
-    if-eqz v2, :cond_8
-
-    :try_start_5
-    invoke-virtual {v2}, Ljava/io/FileInputStream;->close()V
-    :try_end_5
-    .catch Ljava/io/IOException; {:try_start_5 .. :try_end_5} :catch_2
-
-    :catch_2
-    :cond_8
-    throw p0
-
-    :cond_9
-    const-string/jumbo p0, "getEngineList :: No engine found"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    move-object p0, v0
-
-    :catch_3
-    :cond_a
-    :goto_7
-    if-nez p0, :cond_b
-
-    goto :goto_8
-
-    :cond_b
-    invoke-virtual {p0}, Landroid/util/SparseArray;->size()I
-
-    move-result v1
-
-    if-nez v1, :cond_c
-
-    const-string/jumbo p0, "getEngineListLocked :: no engine found"
-
-    invoke-static {v4, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_8
-
-    :cond_c
-    move-object v0, p0
-
-    :goto_8
-    return-object v0
-.end method
-
-.method public static -$$Nest$mremoveEngineInfoLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-    .locals 1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->mEngineInfoXmlHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    :try_start_0
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;->getEngineInfoXmlFile(I)Landroid/util/AtomicFile;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Landroid/util/AtomicFile;->delete()V
-    :try_end_0
-    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-void
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/io/IOException;->printStackTrace()V
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "can\'t remove engine info file "
-
-    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string/jumbo p1, "SdpManagerImpl"
-
-    invoke-static {p1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-.end method
-
-.method public static -$$Nest$mstoreEngineInfoLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-    .locals 8
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->mEngineInfoXmlHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    const-string/jumbo v0, "user"
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v1
-
-    :try_start_0
-    invoke-static {v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;->getEngineInfoXmlFile(I)Landroid/util/AtomicFile;
-
-    move-result-object v1
-    :try_end_0
-    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_4
-
-    const/4 v2, 0x0
-
-    :try_start_1
-    invoke-virtual {v1}, Landroid/util/AtomicFile;->startWrite()Ljava/io/FileOutputStream;
-
-    move-result-object v3
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_2
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    :try_start_2
-    new-instance v4, Ljava/io/BufferedOutputStream;
-
-    invoke-direct {v4, v3}, Ljava/io/BufferedOutputStream;-><init>(Ljava/io/OutputStream;)V
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    :try_start_3
-    new-instance v5, Lcom/android/internal/util/FastXmlSerializer;
-
-    invoke-direct {v5}, Lcom/android/internal/util/FastXmlSerializer;-><init>()V
-
-    const-string/jumbo v6, "UTF-8"
-
-    invoke-virtual {v5, v4, v6}, Lcom/android/internal/util/FastXmlSerializer;->setOutput(Ljava/io/OutputStream;Ljava/lang/String;)V
-
-    sget-object v6, Ljava/lang/Boolean;->TRUE:Ljava/lang/Boolean;
-
-    invoke-virtual {v5, v2, v6}, Lcom/android/internal/util/FastXmlSerializer;->startDocument(Ljava/lang/String;Ljava/lang/Boolean;)V
-
-    const-string/jumbo v6, "http://xmlpull.org/v1/doc/features.html#indent-output"
-
-    const/4 v7, 0x1
-
-    invoke-virtual {v5, v6, v7}, Lcom/android/internal/util/FastXmlSerializer;->setFeature(Ljava/lang/String;Z)V
-
-    invoke-virtual {v5, v2, v0}, Lcom/android/internal/util/FastXmlSerializer;->startTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    const-string/jumbo v6, "alias"
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v5, v2, v6, v7}, Lcom/android/internal/util/FastXmlSerializer;->attribute(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    const-string/jumbo v6, "pkgName"
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getPackageName()Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v5, v2, v6, v7}, Lcom/android/internal/util/FastXmlSerializer;->attribute(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    const-string/jumbo v6, "id"
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v7
-
-    invoke-static {v7}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v5, v2, v6, v7}, Lcom/android/internal/util/FastXmlSerializer;->attribute(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    const-string/jumbo v6, "userid"
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v7
-
-    invoke-static {v7}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v5, v2, v6, v7}, Lcom/android/internal/util/FastXmlSerializer;->attribute(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    const-string/jumbo v6, "flags"
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getFlag()I
-
-    move-result v7
-
-    invoke-static {v7}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v5, v2, v6, v7}, Lcom/android/internal/util/FastXmlSerializer;->attribute(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    const-string/jumbo v6, "version"
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getVersion()I
-
-    move-result v7
-
-    invoke-static {v7}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v5, v2, v6, v7}, Lcom/android/internal/util/FastXmlSerializer;->attribute(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    const-string/jumbo v6, "isMigrating"
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isMigrating()Z
-
-    move-result p1
-
-    invoke-static {p1}, Ljava/lang/Boolean;->toString(Z)Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-virtual {v5, v2, v6, p1}, Lcom/android/internal/util/FastXmlSerializer;->attribute(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    invoke-virtual {v5, v2, v0}, Lcom/android/internal/util/FastXmlSerializer;->endTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    invoke-virtual {v5}, Lcom/android/internal/util/FastXmlSerializer;->endDocument()V
-
-    invoke-virtual {v1, v3}, Landroid/util/AtomicFile;->finishWrite(Ljava/io/FileOutputStream;)V
-    :try_end_3
-    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_0
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :goto_0
-    :try_start_4
-    invoke-virtual {v4}, Ljava/io/BufferedOutputStream;->close()V
-    :try_end_4
-    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_5
-
-    goto :goto_4
-
-    :catchall_0
-    move-exception p0
-
-    move-object v2, v4
-
-    goto :goto_3
-
-    :catch_0
-    move-exception p1
-
-    :goto_1
-    move-object v2, v3
-
-    goto :goto_2
-
-    :catchall_1
-    move-exception p0
-
-    goto :goto_3
-
-    :catch_1
-    move-exception p1
-
-    move-object v4, v2
-
-    goto :goto_1
-
-    :catch_2
-    move-exception p1
-
-    move-object v4, v2
-
-    :goto_2
-    :try_start_5
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;->this$0:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    const-string v0, "Failed to update engine info..."
-
-    invoke-static {p0, p1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$mrecordException(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Ljava/lang/Exception;Ljava/lang/String;)V
-
-    invoke-virtual {p1}, Ljava/lang/Exception;->printStackTrace()V
-
-    if-eqz v2, :cond_0
-
-    invoke-virtual {v1, v2}, Landroid/util/AtomicFile;->failWrite(Ljava/io/FileOutputStream;)V
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_0
-
-    :cond_0
-    if-eqz v4, :cond_2
-
-    goto :goto_0
-
-    :goto_3
-    if-eqz v2, :cond_1
-
-    :try_start_6
-    invoke-virtual {v2}, Ljava/io/BufferedOutputStream;->close()V
-    :try_end_6
-    .catch Ljava/io/IOException; {:try_start_6 .. :try_end_6} :catch_3
-
-    :catch_3
-    :cond_1
-    throw p0
-
-    :catch_4
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/io/IOException;->printStackTrace()V
-
-    :catch_5
-    :cond_2
-    :goto_4
-    return-void
-.end method
-
-.method public static -$$Nest$mupdateEngineListLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;)V
-    .locals 12
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->mEngineListXMLHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    const-string/jumbo v0, "engine"
-
-    const-string/jumbo v1, "engine_list"
-
-    const/4 v2, 0x1
-
-    :try_start_0
-    invoke-static {v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;->getEngineListXmlFile(I)Landroid/util/AtomicFile;
-
-    move-result-object v3
-    :try_end_0
-    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;->this$0:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v4}, Landroid/util/SparseArray;->size()I
-
-    move-result v4
-
-    if-nez v4, :cond_0
-
-    invoke-virtual {v3}, Landroid/util/AtomicFile;->delete()V
-
-    return-void
-
-    :cond_0
-    const/4 v4, 0x0
-
-    :try_start_1
-    invoke-virtual {v3}, Landroid/util/AtomicFile;->startWrite()Ljava/io/FileOutputStream;
-
-    move-result-object v5
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_2
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    :try_start_2
-    new-instance v6, Ljava/io/BufferedOutputStream;
-
-    invoke-direct {v6, v5}, Ljava/io/BufferedOutputStream;-><init>(Ljava/io/OutputStream;)V
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    :try_start_3
-    new-instance v7, Lcom/android/internal/util/FastXmlSerializer;
-
-    invoke-direct {v7}, Lcom/android/internal/util/FastXmlSerializer;-><init>()V
-
-    const-string/jumbo v8, "UTF-8"
-
-    invoke-virtual {v7, v6, v8}, Lcom/android/internal/util/FastXmlSerializer;->setOutput(Ljava/io/OutputStream;Ljava/lang/String;)V
-
-    sget-object v8, Ljava/lang/Boolean;->TRUE:Ljava/lang/Boolean;
-
-    invoke-virtual {v7, v4, v8}, Lcom/android/internal/util/FastXmlSerializer;->startDocument(Ljava/lang/String;Ljava/lang/Boolean;)V
-
-    const-string/jumbo v8, "http://xmlpull.org/v1/doc/features.html#indent-output"
-
-    invoke-virtual {v7, v8, v2}, Lcom/android/internal/util/FastXmlSerializer;->setFeature(Ljava/lang/String;Z)V
-
-    invoke-virtual {v7, v4, v1}, Lcom/android/internal/util/FastXmlSerializer;->startTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v2}, Landroid/util/SparseArray;->size()I
-
-    move-result v2
-
-    const/4 v8, 0x0
-
-    :goto_0
-    if-ge v8, v2, :cond_1
-
-    iget-object v9, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v9, v8}, Landroid/util/SparseArray;->keyAt(I)I
-
-    move-result v9
-
-    iget-object v10, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v10, v8}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;
-
-    move-result-object v10
-
-    check-cast v10, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    invoke-virtual {v7, v4, v0}, Lcom/android/internal/util/FastXmlSerializer;->startTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    const-string/jumbo v11, "alias"
-
-    invoke-virtual {v10}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v10
-
-    invoke-virtual {v7, v4, v11, v10}, Lcom/android/internal/util/FastXmlSerializer;->attribute(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    const-string/jumbo v10, "id"
-
-    invoke-static {v9}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v9
-
-    invoke-virtual {v7, v4, v10, v9}, Lcom/android/internal/util/FastXmlSerializer;->attribute(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    invoke-virtual {v7, v4, v0}, Lcom/android/internal/util/FastXmlSerializer;->endTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    add-int/lit8 v8, v8, 0x1
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    move-object v4, v6
-
-    goto :goto_4
-
-    :catch_0
-    move-exception v0
-
-    :goto_1
-    move-object v4, v5
-
-    goto :goto_3
-
-    :cond_1
-    invoke-virtual {v7, v4, v1}, Lcom/android/internal/util/FastXmlSerializer;->endTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;
-
-    invoke-virtual {v7}, Lcom/android/internal/util/FastXmlSerializer;->endDocument()V
-
-    invoke-virtual {v3, v5}, Landroid/util/AtomicFile;->finishWrite(Ljava/io/FileOutputStream;)V
-    :try_end_3
-    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_0
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :goto_2
-    :try_start_4
-    invoke-virtual {v6}, Ljava/io/BufferedOutputStream;->close()V
-    :try_end_4
-    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_5
-
-    goto :goto_5
-
-    :catchall_1
-    move-exception p0
-
-    goto :goto_4
-
-    :catch_1
-    move-exception v0
-
-    move-object v6, v4
-
-    goto :goto_1
-
-    :catch_2
-    move-exception v0
-
-    move-object v6, v4
-
-    :goto_3
-    :try_start_5
-    const-string v1, "Failed to update engine list..."
-
-    invoke-static {p0, v0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$mrecordException(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Ljava/lang/Exception;Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
-
-    if-eqz v4, :cond_2
-
-    invoke-virtual {v3, v4}, Landroid/util/AtomicFile;->failWrite(Ljava/io/FileOutputStream;)V
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_0
-
-    :cond_2
-    if-eqz v6, :cond_4
-
-    goto :goto_2
-
-    :goto_4
-    if-eqz v4, :cond_3
-
-    :try_start_6
-    invoke-virtual {v4}, Ljava/io/BufferedOutputStream;->close()V
-    :try_end_6
-    .catch Ljava/io/IOException; {:try_start_6 .. :try_end_6} :catch_3
-
-    :catch_3
-    :cond_3
-    throw p0
-
-    :catch_4
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/io/IOException;->printStackTrace()V
-
-    :catch_5
-    :cond_4
-    :goto_5
-    return-void
-.end method
-
-.method public constructor <init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    new-instance p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    invoke-direct {p1, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;-><init>(Ljava/lang/Object;)V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->mEngineListXMLHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    new-instance p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    invoke-direct {p1, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;-><init>(Ljava/lang/Object;)V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->mEngineInfoXmlHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler.smali
deleted file mode 100644
index fbb4143d7..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler.smali
+++ /dev/null
@@ -1,916 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-.super Landroid/os/Handler;
-.source "SourceFile"
-
-
-# instance fields
-.field public final synthetic this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Landroid/os/Looper;)V
-    .locals 0
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-direct {p0, p2}, Landroid/os/Handler;-><init>(Landroid/os/Looper;)V
-
-    sget-boolean p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    const-string/jumbo p0, "SdpHandler"
-
-    invoke-virtual {p1, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkCallerPermissionFor(Ljava/lang/String;)V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final handleMessage(Landroid/os/Message;)V
-    .locals 11
-
-    const/4 v0, -0x1
-
-    const/4 v1, 0x1
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    const-string/jumbo v3, "SdpHandler"
-
-    sget-boolean v4, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    invoke-virtual {v2, v3}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkCallerPermissionFor(Ljava/lang/String;)V
-
-    iget v2, p1, Landroid/os/Message;->what:I
-
-    const/4 v3, 0x0
-
-    const/4 v4, 0x0
-
-    packed-switch v2, :pswitch_data_0
-
-    :pswitch_0
-    goto/16 :goto_5
-
-    :pswitch_1
-    invoke-virtual {p1}, Landroid/os/Message;->getData()Landroid/os/Bundle;
-
-    move-result-object p1
-
-    if-eqz p1, :cond_7
-
-    const-string/jumbo v1, "userId"
-
-    invoke-virtual {p1, v1, v0}, Landroid/os/Bundle;->getInt(Ljava/lang/String;I)I
-
-    move-result v1
-
-    const-string/jumbo v2, "engineId"
-
-    invoke-virtual {p1, v2, v0}, Landroid/os/Bundle;->getInt(Ljava/lang/String;I)I
-
-    move-result v2
-
-    const-string/jumbo v3, "state"
-
-    invoke-virtual {p1, v3, v0}, Landroid/os/Bundle;->getInt(Ljava/lang/String;I)I
-
-    move-result p1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance v0, Landroid/content/Intent;
-
-    const-string/jumbo v3, "com.sec.sdp.SDP_STATE_CHANGED"
-
-    invoke-direct {v0, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V
-
-    new-instance v3, Landroid/content/Intent;
-
-    const-string/jumbo v4, "com.samsung.android.knox.intent.action.SDP_STATE_CHANGED"
-
-    invoke-direct {v3, v4}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V
-
-    const-string/jumbo v4, "sendBroadcastAsUser(INTENT_SDP_STATE_CHANGED, state:"
-
-    const-string v5, ")"
-
-    const-string/jumbo v6, "SdpManagerImpl"
-
-    invoke-static {p1, v4, v5, v6}, Lcom/android/server/audio/AudioDeviceInventory$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    const-string/jumbo v4, "id"
-
-    invoke-virtual {v0, v4, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    const-string/jumbo v4, "state"
-
-    invoke-virtual {v0, v4, p1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    const/16 v4, 0x20
-
-    invoke-virtual {v0, v4}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;
-
-    const/high16 v7, 0x4000000
-
-    invoke-virtual {v0, v7}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;
-
-    const/high16 v8, 0x10000000
-
-    invoke-virtual {v0, v8}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;
-
-    iget-object v9, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
-
-    new-instance v10, Landroid/os/UserHandle;
-
-    invoke-direct {v10, v1}, Landroid/os/UserHandle;-><init>(I)V
-
-    invoke-virtual {v9, v0, v10}, Landroid/content/Context;->sendBroadcastAsUser(Landroid/content/Intent;Landroid/os/UserHandle;)V
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v9, "sendBroadcastAsUser(ACTION_SDP_STATE_CHANGED, state:"
-
-    invoke-direct {v0, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v6, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo v0, "com.samsung.android.knox.intent.extra.SDP_ENGINE_ID"
-
-    invoke-virtual {v3, v0, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    const-string/jumbo v0, "com.samsung.android.knox.intent.extra.SDP_ENGINE_STATE"
-
-    invoke-virtual {v3, v0, p1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    invoke-virtual {v3, v4}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;
-
-    invoke-virtual {v3, v7}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;
-
-    invoke-virtual {v3, v8}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
-
-    new-instance p1, Landroid/os/UserHandle;
-
-    invoke-direct {p1, v1}, Landroid/os/UserHandle;-><init>(I)V
-
-    invoke-virtual {p0, v3, p1}, Landroid/content/Context;->sendBroadcastAsUser(Landroid/content/Intent;Landroid/os/UserHandle;)V
-
-    return-void
-
-    :pswitch_2
-    iget-object p0, p1, Landroid/os/Message;->obj:Ljava/lang/Object;
-
-    instance-of p1, p0, Ljava/lang/Integer;
-
-    if-eqz p1, :cond_7
-
-    check-cast p0, Ljava/lang/Integer;
-
-    invoke-virtual {p0}, Ljava/lang/Integer;->intValue()I
-
-    move-result p0
-
-    const-string/jumbo p1, "activity_task"
-
-    invoke-static {p1}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object p1
-
-    check-cast p1, Lcom/android/server/wm/ActivityTaskManagerService;
-
-    if-eqz p1, :cond_7
-
-    invoke-static {p0}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_7
-
-    iget-object p1, p1, Lcom/android/server/wm/ActivityTaskManagerService;->mExt:Lcom/android/server/wm/ActivityTaskManagerServiceExt;
-
-    const-string v0, "Enforce change password"
-
-    invoke-virtual {p1, p0, v0}, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->removeTaskByCmpName(ILjava/lang/String;)V
-
-    return-void
-
-    :pswitch_3
-    iget-object p0, p1, Landroid/os/Message;->obj:Ljava/lang/Object;
-
-    instance-of p1, p0, Ljava/lang/Integer;
-
-    if-eqz p1, :cond_7
-
-    check-cast p0, Ljava/lang/Integer;
-
-    invoke-virtual {p0}, Ljava/lang/Integer;->intValue()I
-
-    move-result p0
-
-    const-string/jumbo p1, "activity_task"
-
-    invoke-static {p1}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object p1
-
-    check-cast p1, Lcom/android/server/wm/ActivityTaskManagerService;
-
-    if-eqz p1, :cond_7
-
-    invoke-static {p0}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_7
-
-    iget-object p1, p1, Lcom/android/server/wm/ActivityTaskManagerService;->mExt:Lcom/android/server/wm/ActivityTaskManagerServiceExt;
-
-    const-string/jumbo v0, "Legacy reset password"
-
-    invoke-virtual {p1, p0, v0}, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->removeTaskByCmpName(ILjava/lang/String;)V
-
-    return-void
-
-    :pswitch_4
-    iget-object p1, p1, Landroid/os/Message;->obj:Ljava/lang/Object;
-
-    if-eqz p1, :cond_7
-
-    instance-of v0, p1, Ljava/lang/Integer;
-
-    if-eqz v0, :cond_7
-
-    check-cast p1, Ljava/lang/Integer;
-
-    invoke-virtual {p1}, Ljava/lang/Integer;->intValue()I
-
-    move-result p1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->clearLegacyResetStatus(I)V
-
-    const-string/jumbo p0, "activity_task"
-
-    invoke-static {p0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/wm/ActivityTaskManagerService;
-
-    if-eqz p0, :cond_7
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_7
-
-    iget-object p0, p0, Lcom/android/server/wm/ActivityTaskManagerService;->mExt:Lcom/android/server/wm/ActivityTaskManagerServiceExt;
-
-    const-string/jumbo p1, "Legacy reset timeout"
-
-    invoke-virtual {p0, v4, p1}, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->removeTaskByCmpName(ILjava/lang/String;)V
-
-    return-void
-
-    :pswitch_5
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string p1, "Device Owner has been cleared!"
-
-    invoke-static {v3, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, v4}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object p1
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-nez p1, :cond_0
-
-    const-string p1, "Device Owner engine already cleared"
-
-    invoke-static {v3, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->removeEngineInternal(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)I
-
-    :goto_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-    const-string/jumbo p1, "do_cleared"
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string v0, "0"
-
-    invoke-virtual {p0, v4, p1, v0}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :pswitch_6
-    iget p1, p1, Landroid/os/Message;->arg1:I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->cancelLegacyResetTimeout(I)V
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->clearLegacyResetStatus(I)V
-
-    return-void
-
-    :pswitch_7
-    iget p1, p1, Landroid/os/Message;->arg1:I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result p0
-
-    if-nez p0, :cond_1
-
-    goto/16 :goto_5
-
-    :cond_1
-    const-string/jumbo p0, "Start user : "
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    invoke-static {p1, p0, v0}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :pswitch_8
-    iget p1, p1, Landroid/os/Message;->arg1:I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v2, "SdpManagerImpl"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v6, "Removing user "
-
-    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v2, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->removeInvalidEngines()V
-
-    new-instance v2, Ljava/util/ArrayList;
-
-    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V
-
-    iget-object v5, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v5
-
-    :try_start_2
-    iget-object v6, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v6}, Landroid/util/SparseArray;->size()I
-
-    move-result v6
-
-    sub-int/2addr v6, v1
-
-    :goto_1
-    if-ltz v6, :cond_3
-
-    iget-object v7, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v7, v6}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;
-
-    move-result-object v7
-
-    check-cast v7, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    if-eqz v7, :cond_2
-
-    invoke-virtual {v7}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v8
-
-    if-ne v8, p1, :cond_2
-
-    invoke-virtual {v7}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isCustomEngine()Z
-
-    move-result v8
-
-    if-eqz v8, :cond_2
-
-    const-string/jumbo v8, "SdpManagerImpl"
-
-    new-instance v9, Ljava/lang/StringBuilder;
-
-    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v10, "Remove user - Add Custom engine to Removing Engine "
-
-    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->toString()Ljava/lang/String;
-
-    move-result-object v10
-
-    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v9
-
-    invoke-static {v8, v9}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v2, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_2
-
-    :catchall_1
-    move-exception p0
-
-    goto/16 :goto_4
-
-    :cond_2
-    :goto_2
-    add-int/2addr v6, v0
-
-    goto :goto_1
-
-    :cond_3
-    monitor-exit v5
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I
-
-    move-result v0
-
-    move v5, v4
-
-    :goto_3
-    if-ge v5, v0, :cond_4
-
-    invoke-virtual {v2, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v6
-
-    add-int/2addr v5, v1
-
-    check-cast v6, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    const-string/jumbo v7, "SdpManagerImpl"
-
-    new-instance v8, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v9, "Remove user - Removing Custom engine "
-
-    invoke-direct {v8, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v6}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->toString()Ljava/lang/String;
-
-    move-result-object v9
-
-    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-static {v7, v8}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p0, v6}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->removeEngineInternal(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)I
-
-    goto :goto_3
-
-    :cond_4
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_3
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v2
-
-    monitor-exit v0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_3
-
-    if-nez v2, :cond_5
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo v0, "Remove user - Engine not found with id "
-
-    invoke-static {p1, v0, p0}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :cond_5
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v0
-
-    iget-object v5, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    invoke-virtual {v5, v2}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->removePolicy(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-
-    const-string/jumbo v5, "SdpManagerImpl"
-
-    const-string/jumbo v6, "Remove user - Policy removal with id %d successfully done? %s"
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v7
-
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v4
-
-    filled-new-array {v7, v4}, [Ljava/lang/Object;
-
-    move-result-object v4
-
-    invoke-static {v6, v4}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-static {v5, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v4
-
-    :try_start_4
-    iget-object v5, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v6
-
-    invoke-virtual {v5, v6}, Landroid/util/SparseArray;->remove(I)V
-
-    iget-object v5, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {v5, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mremoveEngineInfoLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-
-    iget-object v5, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {v5}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mupdateEngineListLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;)V
-
-    invoke-virtual {p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->onEngineRemoved(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-
-    monitor-exit v4
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_2
-
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v4
-
-    invoke-static {v0, v4}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->removeEngineNative(II)I
-
-    move-result v4
-
-    const-string/jumbo v5, "SdpManagerImpl"
-
-    const-string/jumbo v6, "Remove user - Native removal with id %d successfully done? %s"
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v7
-
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v4
-
-    filled-new-array {v7, v4}, [Ljava/lang/Object;
-
-    move-result-object v4
-
-    invoke-static {v6, v4}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-static {v5, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    const-string/jumbo v5, "SdpEphemeralKey"
-
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0, v5}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    const-string/jumbo v5, "SdpTokenHandle"
-
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0, v5}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    const-string/jumbo v5, "SdpResetToken"
-
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0, v5}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    const-string/jumbo v5, "SdpSessionKey"
-
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0, v5}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "Remove user - Engine remove! "
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v0, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    new-instance v0, Ljava/io/File;
-
-    new-instance v2, Ljava/io/File;
-
-    invoke-static {}, Landroid/os/Environment;->getDataDirectory()Ljava/io/File;
-
-    move-result-object v4
-
-    const-string/jumbo v5, "enc_user"
-
-    invoke-direct {v2, v4, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-static {p1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-direct {v0, v2, v4}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/io/File;->exists()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_7
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "Removing Enc user "
-
-    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v2, " directory."
-
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v3, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getPackageManagerImpl()Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2;
-
-    invoke-direct {v0, p1, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2;-><init>(II)V
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    sget-object v0, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_6
-
-    const-string p0, "Failed to clean enc user directory"
-
-    invoke-static {v3, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :cond_6
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "Removed Enc user "
-
-    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string p1, " directory."
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v3, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :catchall_2
-    move-exception p0
-
-    :try_start_5
-    monitor-exit v4
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_2
-
-    throw p0
-
-    :catchall_3
-    move-exception p0
-
-    :try_start_6
-    monitor-exit v0
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_3
-
-    throw p0
-
-    :goto_4
-    :try_start_7
-    monitor-exit v5
-    :try_end_7
-    .catchall {:try_start_7 .. :try_end_7} :catchall_1
-
-    throw p0
-
-    :pswitch_9
-    iget p1, p1, Landroid/os/Message;->arg1:I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$mhandleUserAdded(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)V
-
-    return-void
-
-    :pswitch_a
-    invoke-virtual {p1}, Landroid/os/Message;->getData()Landroid/os/Bundle;
-
-    move-result-object p1
-
-    if-eqz p1, :cond_7
-
-    const-string/jumbo v1, "userId"
-
-    invoke-virtual {p1, v1, v0}, Landroid/os/Bundle;->getInt(Ljava/lang/String;I)I
-
-    move-result v0
-
-    const-string/jumbo v1, "pkgName"
-
-    const-string v2, ""
-
-    invoke-virtual {p1, v1, v2}, Landroid/os/Bundle;->getString(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {p0, p1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$mhandlePackageRemoved(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Ljava/lang/String;I)V
-
-    :cond_7
-    :goto_5
-    return-void
-
-    :pswitch_b
-    iget v0, p1, Landroid/os/Message;->arg1:I
-
-    iget p1, p1, Landroid/os/Message;->arg2:I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0, v0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->unlockSdpIfUnsecuredOrBiometricAuthenticated(II)V
-
-    return-void
-
-    :pswitch_c
-    iget p1, p1, Landroid/os/Message;->arg1:I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->lockSdpIfRequired(I)V
-
-    return-void
-
-    :pswitch_d
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p1, "SdpManagerImpl.Handler"
-
-    const-string/jumbo v0, "received MSG_SYSTEM_READY. "
-
-    invoke-static {p1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$monSystemReady(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;)V
-
-    return-void
-
-    nop
-
-    :pswitch_data_0
-    .packed-switch 0x1
-        :pswitch_d
-        :pswitch_c
-        :pswitch_b
-        :pswitch_a
-        :pswitch_9
-        :pswitch_8
-        :pswitch_7
-        :pswitch_0
-        :pswitch_6
-        :pswitch_5
-        :pswitch_0
-        :pswitch_4
-        :pswitch_3
-        :pswitch_2
-        :pswitch_1
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService.smali
deleted file mode 100644
index 6311a6af4..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService.smali
+++ /dev/null
@@ -1,78 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public final synthetic this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final setSdpPolicyToPath(ILjava/lang/String;)Z
-    .locals 1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
-
-    move-result-object p0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mContext:Landroid/content/Context;
-
-    const-class v0, Landroid/os/storage/StorageManager;
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/os/storage/StorageManager;
-
-    const/4 v0, 0x0
-
-    if-eqz p0, :cond_0
-
-    invoke-virtual {p0, p1, p2}, Landroid/os/storage/StorageManager;->setSdpPolicyToPath(ILjava/lang/String;)Z
-
-    move-result p0
-
-    goto :goto_0
-
-    :cond_0
-    const-string p0, "EnterprisePartitionManager"
-
-    const-string/jumbo p1, "StorageManager instance is NULL"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    move p0, v0
-
-    :goto_0
-    if-nez p0, :cond_1
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo p1, "setSdpPolicyToPath failed!"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v0
-
-    :cond_1
-    const/4 p0, 0x1
-
-    return p0
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener.smali
deleted file mode 100644
index 19ceca917..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener.smali
+++ /dev/null
@@ -1,111 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Landroid/os/IBinder$DeathRecipient;
-
-
-# instance fields
-.field public final mAlias:Ljava/lang/String;
-
-.field public final mListener:Lcom/samsung/android/knox/dar/sdp/ISdpListener;
-
-.field public final synthetic this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Ljava/lang/String;Lcom/samsung/android/knox/dar/sdp/ISdpListener;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iput-object p3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;->mListener:Lcom/samsung/android/knox/dar/sdp/ISdpListener;
-
-    iput-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;->mAlias:Ljava/lang/String;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final binderDied()V
-    .locals 4
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    const-string v1, "An ISdpListener has died!"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v1, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;->mAlias:Ljava/lang/String;
-
-    check-cast v1, Ljava/util/HashMap;
-
-    invoke-virtual {v1, v2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Ljava/util/ArrayList;
-
-    invoke-virtual {v1, p0}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;->mListener:Lcom/samsung/android/knox/dar/sdp/ISdpListener;
-
-    invoke-interface {v2}, Lcom/samsung/android/knox/dar/sdp/ISdpListener;->asBinder()Landroid/os/IBinder;
-
-    move-result-object v2
-
-    const/4 v3, 0x0
-
-    invoke-interface {v2, p0, v3}, Landroid/os/IBinder;->unlinkToDeath(Landroid/os/IBinder$DeathRecipient;I)Z
-
-    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I
-
-    move-result v1
-
-    if-nez v1, :cond_0
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v1, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;->mAlias:Ljava/lang/String;
-
-    check-cast v1, Ljava/util/HashMap;
-
-    invoke-virtual {v1, p0}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    :goto_0
-    monitor-exit v0
-
-    return-void
-
-    :goto_1
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy$$ExternalSyntheticLambda0.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy$$ExternalSyntheticLambda0.smali
deleted file mode 100644
index 95976b7a7..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy$$ExternalSyntheticLambda0.smali
+++ /dev/null
@@ -1,42 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy$$ExternalSyntheticLambda0;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic f$0:Ljava/lang/String;
-
-
-# direct methods
-.method public synthetic constructor <init>(Ljava/lang/String;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy$$ExternalSyntheticLambda0;->f$0:Ljava/lang/String;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy$$ExternalSyntheticLambda0;->f$0:Ljava/lang/String;
-
-    check-cast p1, Landroid/os/storage/StorageManager;
-
-    invoke-virtual {p1, p0}, Landroid/os/storage/StorageManager;->isSensitive(Ljava/lang/String;)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy.smali
deleted file mode 100644
index 1bef76e54..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy.smali
+++ /dev/null
@@ -1,148 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public final synthetic this$0:Ljava/lang/Object;
-
-
-# direct methods
-.method public synthetic constructor <init>(Ljava/lang/Object;)V
-    .locals 0
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;->this$0:Ljava/lang/Object;
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-.method public static getEngineInfoXmlFile(I)Landroid/util/AtomicFile;
-    .locals 5
-
-    const-string/jumbo v0, "SdpUser"
-
-    const-string v1, ".xml"
-
-    invoke-static {p0, v0, v1}, Lcom/android/server/BinaryTransparencyService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    new-instance v1, Ljava/io/File;
-
-    const-string v2, "/data/system/users/"
-
-    const-string v3, "/"
-
-    invoke-static {p0, v2, v3}, Lcom/android/server/BinaryTransparencyService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-direct {v1, v4}, Ljava/io/File;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1}, Ljava/io/File;->exists()Z
-
-    move-result v4
-
-    if-nez v4, :cond_1
-
-    invoke-virtual {v1}, Ljava/io/File;->mkdir()Z
-
-    move-result v4
-
-    if-eqz v4, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string v0, "Can\'t make directory - "
-
-    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    invoke-static {v0, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    new-instance p0, Ljava/io/IOException;
-
-    invoke-direct {p0}, Ljava/io/IOException;-><init>()V
-
-    throw p0
-
-    :cond_1
-    :goto_0
-    new-instance v1, Ljava/io/File;
-
-    invoke-static {p0, v2, v3, v0}, Lcom/android/server/accessibility/AccessibilityManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-direct {v1, p0}, Ljava/io/File;-><init>(Ljava/lang/String;)V
-
-    new-instance p0, Landroid/util/AtomicFile;
-
-    invoke-direct {p0, v1}, Landroid/util/AtomicFile;-><init>(Ljava/io/File;)V
-
-    return-object p0
-.end method
-
-.method public static getEngineListXmlFile(I)Landroid/util/AtomicFile;
-    .locals 2
-
-    const/4 v0, 0x1
-
-    if-eq p0, v0, :cond_0
-
-    const/4 p0, 0x0
-
-    :cond_0
-    new-instance v0, Ljava/io/File;
-
-    const-string v1, "/data/system/users/sdp_engine_list.xml"
-
-    invoke-direct {v0, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/io/File;->exists()Z
-
-    move-result v1
-
-    if-nez v1, :cond_2
-
-    if-eqz p0, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string v0, "Failed to get engine list due to non-existence..."
-
-    invoke-static {p0, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance p0, Ljava/io/IOException;
-
-    invoke-direct {p0}, Ljava/io/IOException;-><init>()V
-
-    throw p0
-
-    :cond_2
-    :goto_0
-    new-instance p0, Landroid/util/AtomicFile;
-
-    invoke-direct {p0, v0}, Landroid/util/AtomicFile;-><init>(Ljava/io/File;)V
-
-    return-object p0
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0.smali
deleted file mode 100644
index 19db79a95..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0.smali
+++ /dev/null
@@ -1,114 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Consumer;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;I)V
-    .locals 0
-
-    iput p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0;->$r8$classId:I
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0;->f$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 3
-
-    iget v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0;->$r8$classId:I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0;->f$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;
-
-    check-cast p1, Landroid/os/IBinder;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    packed-switch v0, :pswitch_data_0
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    const/4 v1, 0x0
-
-    :try_start_0
-    invoke-interface {p1, p0, v1}, Landroid/os/IBinder;->unlinkToDeath(Landroid/os/IBinder$DeathRecipient;I)Z
-    :try_end_0
-    .catch Ljava/lang/NullPointerException; {:try_start_0 .. :try_end_0} :catch_1
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    const-string p1, "Failed to unlink death listener"
-
-    invoke-static {v0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    goto :goto_0
-
-    :catch_1
-    const-string/jumbo p0, "Listener might be already finalized..."
-
-    invoke-static {v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_0
-    return-void
-
-    :pswitch_0
-    const/4 v0, 0x0
-
-    :try_start_1
-    invoke-interface {p1, p0, v0}, Landroid/os/IBinder;->linkToDeath(Landroid/os/IBinder$DeathRecipient;I)V
-
-    const/4 p1, 0x1
-
-    iput-boolean p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mIsValid:Z
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_2
-
-    goto :goto_1
-
-    :catch_2
-    move-exception p1
-
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    const-string v2, "Failed to link death listener..."
-
-    invoke-static {v1, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p1}, Ljava/lang/Exception;->printStackTrace()V
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mWeakListener:Ljava/lang/ref/WeakReference;
-
-    invoke-virtual {p1}, Ljava/lang/ref/WeakReference;->clear()V
-
-    iput-boolean v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mIsValid:Z
-
-    :goto_1
-    return-void
-
-    nop
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$StateListener.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$StateListener.smali
deleted file mode 100644
index 131087607..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$StateListener.smali
+++ /dev/null
@@ -1,200 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Landroid/os/IBinder$DeathRecipient;
-
-
-# instance fields
-.field public final mEngineId:I
-
-.field public mIsValid:Z
-
-.field public final mWeakListener:Ljava/lang/ref/WeakReference;
-
-.field public final synthetic this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;ILcom/samsung/android/knox/dar/sdp/ISdpListener;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    const/4 p1, 0x0
-
-    iput-boolean p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mIsValid:Z
-
-    iput p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mEngineId:I
-
-    new-instance p1, Ljava/lang/ref/WeakReference;
-
-    invoke-direct {p1, p3}, Ljava/lang/ref/WeakReference;-><init>(Ljava/lang/Object;)V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mWeakListener:Ljava/lang/ref/WeakReference;
-
-    invoke-virtual {p1}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Lcom/samsung/android/knox/dar/sdp/ISdpListener;
-
-    if-nez p1, :cond_0
-
-    const/4 p1, 0x0
-
-    goto :goto_0
-
-    :cond_0
-    invoke-interface {p1}, Lcom/samsung/android/knox/dar/sdp/ISdpListener;->asBinder()Landroid/os/IBinder;
-
-    move-result-object p1
-
-    :goto_0
-    invoke-static {p1}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p1
-
-    new-instance p2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0;
-
-    const/4 p3, 0x0
-
-    invoke-direct {p2, p0, p3}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;I)V
-
-    invoke-virtual {p1, p2}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final binderDied()V
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->dispose()V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mEngineId:I
-
-    invoke-virtual {v1, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->handleEmptyListenerRoll(I)V
-
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
-.method public final dispose()V
-    .locals 3
-
-    iget-boolean v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mIsValid:Z
-
-    if-nez v0, :cond_0
-
-    return-void
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    iget v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mEngineId:I
-
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    check-cast v0, Ljava/util/HashMap;
-
-    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;
-
-    if-eqz v0, :cond_1
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    iget v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mEngineId:I
-
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    check-cast v0, Ljava/util/HashMap;
-
-    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;->mStateListeners:Ljava/util/ArrayList;
-
-    invoke-virtual {v0, p0}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z
-
-    :cond_1
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mWeakListener:Ljava/lang/ref/WeakReference;
-
-    invoke-virtual {v0}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/samsung/android/knox/dar/sdp/ISdpListener;
-
-    if-nez v0, :cond_2
-
-    const/4 v0, 0x0
-
-    goto :goto_0
-
-    :cond_2
-    invoke-interface {v0}, Lcom/samsung/android/knox/dar/sdp/ISdpListener;->asBinder()Landroid/os/IBinder;
-
-    move-result-object v0
-
-    :goto_0
-    invoke-static {v0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object v0
-
-    new-instance v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0;
-
-    const/4 v2, 0x1
-
-    invoke-direct {v1, p0, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;I)V
-
-    invoke-virtual {v0, v1}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mWeakListener:Ljava/lang/ref/WeakReference;
-
-    invoke-virtual {v0}, Ljava/lang/ref/WeakReference;->clear()V
-
-    const/4 v0, 0x0
-
-    iput-boolean v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mIsValid:Z
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0.smali
deleted file mode 100644
index 05ff1ea5f..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0.smali
+++ /dev/null
@@ -1,66 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic f$0:Ljava/lang/String;
-
-.field public final synthetic f$1:J
-
-.field public final synthetic f$2:[B
-
-.field public final synthetic f$3:I
-
-
-# direct methods
-.method public synthetic constructor <init>(IJLjava/lang/String;[B)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p4, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0;->f$0:Ljava/lang/String;
-
-    iput-wide p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0;->f$1:J
-
-    iput-object p5, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0;->f$2:[B
-
-    iput p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0;->f$3:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 7
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0;->f$0:Ljava/lang/String;
-
-    iget-wide v3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0;->f$1:J
-
-    iget-object v5, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0;->f$2:[B
-
-    iget v6, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0;->f$3:I
-
-    move-object v1, p1
-
-    check-cast v1, Lcom/android/internal/widget/LockSettingsInternal;
-
-    invoke-static {v0}, Lcom/android/internal/widget/LockscreenCredential;->createPassword(Ljava/lang/CharSequence;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v2
-
-    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/widget/LockSettingsInternal;->setLockCredentialWithToken(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda1.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda1.smali
deleted file mode 100644
index 766c1e4f4..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda1.smali
+++ /dev/null
@@ -1,54 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda1;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Consumer;
-
-
-# instance fields
-.field public final synthetic f$0:I
-
-
-# direct methods
-.method public synthetic constructor <init>(I)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda1;->f$0:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 2
-
-    iget p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda1;->f$0:I
-
-    check-cast p1, Lcom/android/internal/widget/ILockSettings;
-
-    :try_start_0
-    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v0
-
-    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v1
-
-    invoke-interface {p1, v0, v1, p0}, Lcom/android/internal/widget/ILockSettings;->setLockCredential(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)Z
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-void
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2.smali
deleted file mode 100644
index bad86c03c..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2.smali
+++ /dev/null
@@ -1,66 +0,0 @@
-.class public final synthetic Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Consumer;
-
-
-# instance fields
-.field public final synthetic f$0:Ljava/lang/String;
-
-.field public final synthetic f$1:Ljava/lang/String;
-
-.field public final synthetic f$2:I
-
-
-# direct methods
-.method public synthetic constructor <init>(ILjava/lang/String;Ljava/lang/String;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2;->f$0:Ljava/lang/String;
-
-    iput-object p3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2;->f$1:Ljava/lang/String;
-
-    iput p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2;->f$2:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2;->f$0:Ljava/lang/String;
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2;->f$1:Ljava/lang/String;
-
-    iget p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda2;->f$2:I
-
-    check-cast p1, Lcom/android/internal/widget/ILockSettings;
-
-    :try_start_0
-    invoke-static {v0}, Lcom/android/internal/widget/LockscreenCredential;->createPassword(Ljava/lang/CharSequence;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v0
-
-    invoke-static {v1}, Lcom/android/internal/widget/LockscreenCredential;->createPassword(Ljava/lang/CharSequence;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v1
-
-    invoke-interface {p1, v0, v1, p0}, Lcom/android/internal/widget/ILockSettings;->setLockCredential(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)Z
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-void
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient.smali
deleted file mode 100644
index 7efbabf0a..000000000
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient.smali
+++ /dev/null
@@ -1,326 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public final mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-.field public final this$0:Ljava/lang/Object;
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Landroid/content/Context;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iput-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->this$0:Ljava/lang/Object;
-
-    return-void
-.end method
-
-.method public constructor <init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Lcom/android/server/knox/dar/sdp/SdpManagerImpl;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->this$0:Ljava/lang/Object;
-
-    iput-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public checkPassword(ILjava/lang/String;)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 4
-
-    const-string v0, "Check password for user "
-
-    const-string/jumbo v1, "SdpManagerImpl.VirtualLock"
-
-    invoke-static {p1, v0, v1}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->this$0:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {v0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$misVirtualUserId(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getLockSettings()Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;
-
-    const/4 v3, 0x1
-
-    invoke-direct {v2, p2, p1, v3}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;-><init>(Ljava/lang/String;II)V
-
-    invoke-virtual {p0, v2}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    sget-object p1, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    invoke-virtual {p0, p1}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/internal/widget/VerifyCredentialResponse;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-object p0
-
-    :catchall_0
-    move-exception p0
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
-.method public clean(I)V
-    .locals 5
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->this$0:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$misVirtualUserId(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_0
-
-    return-void
-
-    :cond_0
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    new-instance p0, Ljava/io/File;
-
-    new-instance v2, Ljava/io/File;
-
-    invoke-static {}, Landroid/os/Environment;->getDataSystemDirectory()Ljava/io/File;
-
-    move-result-object v3
-
-    const-string/jumbo v4, "users"
-
-    invoke-direct {v2, v3, v4}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-static {p1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-direct {p0, v2, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-virtual {p0}, Ljava/io/File;->exists()Z
-
-    move-result v2
-
-    const-string/jumbo v3, "SdpManagerImpl.VirtualLock"
-
-    if-eqz v2, :cond_1
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v4, "clean - sp state path found with user "
-
-    invoke-direct {v2, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v3, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->removeDirectoryRecursive(Ljava/io/File;)V
-
-    goto :goto_0
-
-    :cond_1
-    const-string/jumbo p0, "clean - sp state path not found with user "
-
-    invoke-static {p1, p0, v3}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    :goto_0
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-.end method
-
-.method public clearLock(I)V
-    .locals 3
-
-    const-string v0, "Clear lock for user "
-
-    const-string/jumbo v1, "SdpManagerImpl.VirtualLock"
-
-    invoke-static {p1, v0, v1}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->this$0:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$misVirtualUserId(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    return-void
-
-    :cond_0
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getLockSettings()Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda1;
-
-    invoke-direct {v2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda1;-><init>(I)V
-
-    invoke-virtual {p0, v2}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
-.method public setPasswordWithToken(IJLjava/lang/String;[B)Z
-    .locals 9
-
-    const-string/jumbo v0, "Set password with token for user "
-
-    const-string/jumbo v1, "SdpManagerImpl.VirtualLock"
-
-    invoke-static {p1, v0, v1}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->this$0:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->-$$Nest$misVirtualUserId(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    const/4 p0, 0x0
-
-    return p0
-
-    :cond_0
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v1
-
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-    if-nez v0, :cond_1
-
-    const-class v0, Lcom/android/internal/widget/LockSettingsInternal;
-
-    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/internal/widget/LockSettingsInternal;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-    :cond_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-    invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v3, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0;
-
-    move v4, p1
-
-    move-wide v5, p2
-
-    move-object v7, p4
-
-    move-object v8, p5
-
-    invoke-direct/range {v3 .. v8}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient$$ExternalSyntheticLambda0;-><init>(IJLjava/lang/String;[B)V
-
-    invoke-virtual {p0, v3}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    sget-object p1, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {p0, p1}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Ljava/lang/Boolean;
-
-    invoke-virtual {p0}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return p0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl.smali
index d82b2b8ad..98d69c3a3 100644
--- a/smali/com/android/server/knox/dar/sdp/SdpManagerImpl.smali
+++ b/smali/com/android/server/knox/dar/sdp/SdpManagerImpl.smali
@@ -6,6241 +6,284 @@
 # static fields
 .field public static final NULL_USER:Landroid/content/pm/UserInfo;
 
-.field public static mSystemReady:Z = false
 
+# direct methods
+.method static constructor <clinit>()V
+    .locals 4
 
-# instance fields
-.field public final handlerThread:Landroid/os/HandlerThread;
-
-.field public final mBinderListeners:Ljava/util/Map;
-
-.field public final mBroadcastReceiver:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;
-
-.field public final mContainerStateReceiver:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;
-
-.field public final mContext:Landroid/content/Context;
-
-.field public final mDevicePolicyManager:Landroid/app/admin/DevicePolicyManager;
-
-.field public final mIsHandlerReady:Z
-
-.field public final mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-.field public final mListenerMap:Ljava/util/Map;
-
-.field public final mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-.field public mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-.field public mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
-
-.field public final mManagedCredentialMap:Ljava/util/Map;
-
-.field public final mManagedTokenMap:Ljava/util/Map;
-
-.field public mNeedToSetSdpPolicyForUser:I
-
-.field public final mPackageEventReceiver:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;
-
-.field public mPackageManagerImpl:Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;
-
-.field public final mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-.field public final mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-.field public final mSdpEngineDbLock:Ljava/lang/Object;
-
-.field public final mSdpEngineMap:Landroid/util/SparseArray;
-
-.field public final mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-.field public mSdpManagerInternal:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-.field public mSdpManagerProxy:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerProxy;
-
-.field public final mSecureFileSystemManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-
-.field public final mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
-
-.field public final mUserManager:Landroid/os/UserManager;
-
-.field public final mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-
-
-# direct methods
-.method public static -$$Nest$mhandlePackageRemoved(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Ljava/lang/String;I)V
-    .locals 7
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    if-ltz p2, :cond_6
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto/16 :goto_4
-
-    :cond_0
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    const-string/jumbo v1, "handlePackageRemoved - PackageName : %s, UserId : %d"
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v2
-
-    filled-new-array {p1, v2}, [Ljava/lang/Object;
-
-    move-result-object v2
-
-    invoke-static {v1, v2}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mDevicePolicyManager:Landroid/app/admin/DevicePolicyManager;
-
-    if-eqz v0, :cond_5
-
-    invoke-virtual {v0}, Landroid/app/admin/DevicePolicyManager;->isDeviceProvisioned()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_5
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v0}, Landroid/util/SparseArray;->size()I
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->readEngineList()V
-
-    :cond_1
-    new-instance v0, Ljava/util/ArrayList;
-
-    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v1
-
-    :try_start_0
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v2}, Landroid/util/SparseArray;->size()I
-
-    move-result v2
-
-    add-int/lit8 v2, v2, -0x1
-
-    :goto_0
-    if-ltz v2, :cond_3
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v3, v2}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    if-eqz v3, :cond_2
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getPackageName()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {v4, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_2
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v4
-
-    if-ne v4, p2, :cond_2
-
-    const-string/jumbo v4, "SdpManagerImpl"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v6, "handlePackageRemoved - Add package engine to Removing Engine "
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->toString()Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v4, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v0, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception p0
-
-    goto/16 :goto_3
-
-    :cond_2
-    :goto_1
-    add-int/lit8 v2, v2, -0x1
-
-    goto :goto_0
-
-    :cond_3
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I
-
-    move-result v1
-
-    const/4 v2, 0x0
-
-    :goto_2
-    if-ge v2, v1, :cond_4
-
-    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v3
-
-    add-int/lit8 v2, v2, 0x1
-
-    check-cast v3, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    const-string/jumbo v4, "SdpManagerImpl"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v6, "handlePackageRemoved - Removing Sdp Engine "
-
-    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->toString()Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v4, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, v3}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->removeEngineInternal(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)I
-
-    goto :goto_2
-
-    :cond_4
-    new-instance v0, Ljava/io/File;
-
-    new-instance v1, Ljava/io/File;
-
-    new-instance v2, Ljava/io/File;
-
-    invoke-static {}, Landroid/os/Environment;->getDataDirectory()Ljava/io/File;
-
-    move-result-object v3
-
-    const-string/jumbo v4, "enc_user"
-
-    invoke-direct {v2, v3, v4}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-static {p2}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-direct {v1, v2, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-direct {v0, v1, p1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/io/File;->exists()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_6
-
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    invoke-virtual {v0}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
-
-    move-result-object v0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSecureFileSystemManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getPackageManagerImpl()Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v4, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;
-
-    const/4 v5, 0x3
-
-    invoke-direct {v4, p2, p1, v5}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda1;-><init>(ILjava/lang/String;I)V
-
-    invoke-virtual {p0, v4}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    sget-object p1, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {p0, p1}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result p0
-
-    xor-int/lit8 p0, p0, 0x1
-
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p2, "handlePackageRemoved - Remove secure package dir : "
-
-    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string p2, " [ res : "
-
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string p0, " ]"
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-
-    :goto_3
-    :try_start_1
-    monitor-exit v1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_5
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo p1, "handlePackageRemoved - Device is not provisioned yet..."
-
-    invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_6
-    :goto_4
-    return-void
-.end method
-
-.method public static -$$Nest$mhandleUserAdded(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)V
-    .locals 5
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    const-string/jumbo v1, "User %d added"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v2
-
-    filled-new-array {v2}, [Ljava/lang/Object;
-
-    move-result-object v2
-
-    invoke-static {v1, v2}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    const-string/jumbo v2, "user added - Is user %d Bmode? %s"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v3
-
-    invoke-virtual {v0}, Landroid/content/pm/UserInfo;->isBMode()Z
-
-    move-result v4
-
-    invoke-static {v4}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object v4
-
-    filled-new-array {v3, v4}, [Ljava/lang/Object;
-
-    move-result-object v3
-
-    invoke-static {v2, v3}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v1, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    const-string/jumbo v2, "user added - Is user %d managed profile? %s"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v3
-
-    invoke-virtual {v0}, Landroid/content/pm/UserInfo;->isManagedProfile()Z
-
-    move-result v0
-
-    invoke-static {v0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object v0
-
-    filled-new-array {v3, v0}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    invoke-static {v2, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    const-string/jumbo v1, "user added - Has user %d sdp engine? %s"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    :goto_0
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    filled-new-array {p1, p0}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v0, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-.method public static -$$Nest$misVirtualUserId(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)Z
-    .locals 0
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result p0
-
-    return p0
-.end method
-
-.method public static -$$Nest$monSystemReady(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;)V
-    .locals 17
-
-    move-object/from16 v1, p0
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v0, "persist.sys.knox.sdp_cryptod"
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->isDaemonRunning(Ljava/lang/String;)Z
-
-    move-result v2
-
-    const-string/jumbo v3, "SdpManagerImpl"
-
-    const/4 v4, 0x1
-
-    if-eqz v2, :cond_0
-
-    const-string/jumbo v0, "SDP daemon is already running!"
-
-    invoke-static {v3, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_2
-
-    :cond_0
-    invoke-static {}, Lcom/samsung/android/knox/sdp/SdpFileSystem;->testSdpIoctl()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_1
-
-    const-string/jumbo v2, "Start SDP daemon!"
-
-    invoke-static {v3, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v2
-
-    :try_start_0
-    invoke-static {v4}, Ljava/lang/Boolean;->toString(Z)Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v0, v5}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    goto :goto_1
-
-    :catch_0
-    move-exception v0
-
-    :try_start_1
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :goto_0
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    goto :goto_2
-
-    :goto_1
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw v0
-
-    :cond_1
-    const-string v0, "Failed in fs ping test..."
-
-    invoke-static {v3, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :goto_2
-    const-string/jumbo v0, "android.intent.action.USER_ADDED"
-
-    const-string/jumbo v2, "android.intent.action.USER_REMOVED"
-
-    invoke-static {v0, v2}, Lcom/android/server/DirEncryptServiceHelper$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;
-
-    move-result-object v0
-
-    iget-object v2, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
-
-    iget-object v3, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBroadcastReceiver:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;
-
-    invoke-virtual {v2, v3, v0}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
-
-    const-string v0, "Broadcast receiver has been registered"
-
-    const-string/jumbo v2, "SdpManagerImpl.receiver"
-
-    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v0, Landroid/content/IntentFilter;
-
-    invoke-direct {v0}, Landroid/content/IntentFilter;-><init>()V
-
-    const-string/jumbo v3, "android.intent.action.PACKAGE_REMOVED"
-
-    invoke-virtual {v0, v3}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string/jumbo v3, "package"
-
-    invoke-virtual {v0, v3}, Landroid/content/IntentFilter;->addDataScheme(Ljava/lang/String;)V
-
-    iget-object v3, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
-
-    iget-object v5, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mPackageEventReceiver:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;
-
-    invoke-virtual {v3, v5, v0}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
-
-    const-string/jumbo v0, "Package event receiver has been registered"
-
-    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
-
-    iget-object v3, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContainerStateReceiver:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;
-
-    invoke-static {v0, v3}, Landroid/os/ContainerStateReceiver;->register(Landroid/content/Context;Landroid/os/ContainerStateReceiver;)V
-
-    const-string v0, "Container state receiver has been registered"
-
-    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->updateDeviceOwnerStatus()V
-
-    iget-object v0, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSecureFileSystemManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-
-    iget-object v2, v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->this$0:Ljava/lang/Object;
-
-    check-cast v2, Landroid/content/Context;
-
-    invoke-static {v2}, Landroid/os/UserManager;->get(Landroid/content/Context;)Landroid/os/UserManager;
-
-    move-result-object v2
-
-    invoke-virtual {v2}, Landroid/os/UserManager;->getUsers()Ljava/util/List;
-
-    move-result-object v2
-
-    invoke-interface {v2}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v2
-
-    :cond_2
-    :goto_3
-    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v3
-
-    const/4 v5, 0x0
-
-    const/4 v6, 0x0
-
-    if-eqz v3, :cond_7
-
-    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Landroid/content/pm/UserInfo;
-
-    iget v3, v3, Landroid/content/pm/UserInfo;->id:I
-
-    if-nez v3, :cond_2
-
-    new-instance v7, Ljava/io/File;
-
-    const-string v8, "/data/enc_user"
-
-    invoke-static {v3}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v9
-
-    invoke-direct {v7, v8, v9}, Ljava/io/File;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v7}, Ljava/io/File;->exists()Z
-
-    move-result v8
-
-    const-string/jumbo v9, "SecureFS.SDP"
-
-    if-nez v8, :cond_6
-
-    invoke-virtual {v7}, Ljava/io/File;->mkdir()Z
-
-    move-result v8
-
-    if-nez v8, :cond_3
-
-    const-string/jumbo v5, "setBaseDataUserDir :: Error - user dir creation failed... "
-
-    invoke-static {v3, v5, v9}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_5
-
-    :cond_3
-    invoke-virtual {v7}, Ljava/io/File;->getPath()Ljava/lang/String;
-
-    move-result-object v6
-
-    const/16 v10, 0x1f9
-
-    const/4 v11, -0x1
-
-    invoke-static {v6, v10, v11, v11}, Landroid/os/FileUtils;->setPermissions(Ljava/lang/String;III)I
-
-    iget-object v6, v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v10, v6, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpManagerInternal:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    if-nez v10, :cond_4
-
-    const-class v10, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    invoke-static {v10}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v10
-
-    check-cast v10, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    iput-object v10, v6, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpManagerInternal:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    :cond_4
-    iget-object v6, v6, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpManagerInternal:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    invoke-static {v6}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object v6
-
-    new-instance v10, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;
-
-    const/4 v11, 0x1
-
-    invoke-direct {v10, v3, v11, v7}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda0;-><init>(IILjava/io/File;)V
-
-    invoke-virtual {v6, v10}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object v6
-
-    sget-object v10, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {v6, v10}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v6
-
-    check-cast v6, Ljava/lang/Boolean;
-
-    invoke-virtual {v6}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result v6
-
-    if-eqz v6, :cond_5
-
-    new-instance v6, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v10, "Successfully set sdp policy to "
-
-    invoke-direct {v6, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v7}, Ljava/io/File;->getPath()Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-static {v5, v6}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_4
-
-    :cond_5
-    new-instance v6, Ljava/lang/StringBuilder;
-
-    const-string v10, "Failed to set sdp policy to "
-
-    invoke-direct {v6, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v7}, Ljava/io/File;->getPath()Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-static {v5, v6}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :goto_4
-    move v6, v8
-
-    goto :goto_5
-
-    :cond_6
-    move v6, v4
-
-    :goto_5
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v7, "setBaseDataUserDir :: User "
-
-    invoke-direct {v5, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v7, ", result : "
-
-    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v9, v5}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    if-nez v6, :cond_2
-
-    const-string/jumbo v5, "systemReady :: Error - Failed to set up base directory for user "
-
-    invoke-static {v3, v5, v9}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    goto/16 :goto_3
-
-    :cond_7
-    iget-object v0, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v0}, Landroid/util/SparseArray;->size()I
-
-    move-result v2
-
-    move v3, v6
-
-    :goto_6
-    if-ge v3, v2, :cond_15
-
-    iget-object v0, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v0, v3}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    invoke-virtual {v0}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v0
-
-    invoke-virtual {v1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v7
-
-    if-nez v7, :cond_9
-
-    const-string/jumbo v7, "SdpManagerImpl"
-
-    const-string/jumbo v8, "boot - Engine info not found in map with id "
-
-    invoke-static {v0, v8, v7}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object v8, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v8
-
-    :try_start_2
-    iget-object v7, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {v7, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mgetEngineInfoLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v7
-
-    if-eqz v7, :cond_8
-
-    iget-object v9, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v9, v0, v7}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
-
-    iget-object v9, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {v9, v7}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mstoreEngineInfoLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-
-    iget-object v9, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {v9}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mupdateEngineListLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;)V
-
-    goto :goto_7
-
-    :catchall_1
-    move-exception v0
-
-    goto :goto_8
-
-    :cond_8
-    :goto_7
-    monitor-exit v8
-
-    goto :goto_9
-
-    :goto_8
-    monitor-exit v8
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    throw v0
-
-    :cond_9
-    :goto_9
-    if-nez v7, :cond_a
-
-    const-string/jumbo v7, "SdpManagerImpl"
-
-    const-string/jumbo v8, "boot - Failed to find engine info with id "
-
-    invoke-static {v0, v8, v7}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    const/4 v0, -0x5
-
-    goto/16 :goto_10
-
-    :cond_a
-    invoke-virtual {v7}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v0
-
-    const-string/jumbo v8, "SdpManagerImpl"
-
-    new-instance v9, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v10, "boot - "
-
-    invoke-direct {v9, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v9, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v9
-
-    invoke-static {v8, v9}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v7}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v8
-
-    invoke-virtual {v7}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v9
-
-    invoke-static {v8, v9}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->nativeOnBoot(II)I
-
-    move-result v8
-
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v8
-
-    invoke-static {v8}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result v8
-
-    if-eqz v8, :cond_b
-
-    new-instance v8, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v9, "bootNative - Failed with id "
-
-    invoke-direct {v8, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v7}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v9
-
-    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v8
-
-    const-string/jumbo v9, "SdpManagerImpl"
-
-    invoke-static {v9, v8}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/16 v8, -0xb
-
-    goto :goto_a
-
-    :cond_b
-    move v8, v6
-
-    :goto_a
-    const-string/jumbo v9, "SdpManagerImpl"
-
-    const-string/jumbo v10, "boot - [ Detected version : %d, Latest version : %d ]"
-
-    invoke-virtual {v7}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getVersion()I
-
-    move-result v11
-
-    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v11
-
-    const/4 v12, 0x6
-
-    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v13
-
-    filled-new-array {v11, v13}, [Ljava/lang/Object;
-
-    move-result-object v11
-
-    invoke-static {v10, v11}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v10
-
-    invoke-static {v9, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v7}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getVersion()I
-
-    move-result v9
-
-    if-eq v9, v12, :cond_11
-
-    const-string/jumbo v9, "SdpManagerImpl"
-
-    new-instance v10, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v11, "onMigrationInternal :: "
-
-    invoke-direct {v10, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v7}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->toString()Ljava/lang/String;
-
-    move-result-object v11
-
-    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v10
-
-    invoke-static {v9, v10}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v7}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getVersion()I
-
-    move-result v9
-
-    if-ne v9, v4, :cond_c
-
-    add-int/lit8 v9, v9, 0x1
-
-    :cond_c
-    const/4 v10, 0x2
-
-    if-ne v9, v10, :cond_d
-
-    add-int/lit8 v9, v9, 0x1
-
-    :cond_d
-    const/4 v10, 0x3
-
-    if-ne v9, v10, :cond_e
-
-    add-int/lit8 v9, v9, 0x1
-
-    :cond_e
-    const/4 v10, 0x4
-
-    if-ne v9, v10, :cond_f
-
-    add-int/lit8 v9, v9, 0x1
-
-    :cond_f
-    const/4 v10, 0x5
-
-    if-ne v9, v10, :cond_10
-
-    const-string/jumbo v10, "SdpManagerImpl"
-
-    const-string/jumbo v11, "onMigrationInternal :: version 5 -> 6)"
-
-    invoke-static {v10, v11}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v10, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v10
-
-    add-int/lit8 v9, v9, 0x1
-
-    :try_start_3
-    invoke-virtual {v7, v9}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->setVersion(I)V
-
-    iget-object v9, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {v9, v7}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mstoreEngineInfoLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-
-    monitor-exit v10
-
-    goto :goto_b
-
-    :catchall_2
-    move-exception v0
-
-    monitor-exit v10
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_2
-
-    throw v0
-
-    :cond_10
-    :goto_b
-    const-string/jumbo v9, "SdpManagerImpl"
-
-    const-string/jumbo v10, "onMigrationInternal :: DONE"
-
-    invoke-static {v9, v10}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v9, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v9
-
-    :try_start_4
-    iget-object v10, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v10, v0, v7}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
-
-    monitor-exit v9
-
-    goto :goto_c
-
-    :catchall_3
-    move-exception v0
-
-    monitor-exit v9
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_3
-
-    throw v0
-
-    :cond_11
-    :goto_c
-    iget-object v9, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v9
-
-    :try_start_5
-    invoke-virtual {v1, v7, v4}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->setEngineStateLocked(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;I)V
-
-    monitor-exit v9
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_6
-
-    invoke-virtual {v1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->generateAndSaveSessionKey(I)Z
-
-    move-result v7
-
-    const-string v9, "Boot - Prepare session key for engine %d [ res : %s ]"
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v10
-
-    invoke-static {v7}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object v7
-
-    filled-new-array {v10, v7}, [Ljava/lang/Object;
-
-    move-result-object v7
-
-    invoke-static {v9, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-static {v5, v7}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    const-string v7, "Boot - Engine %d boot completed! [ rc : %d ]"
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v9
-
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v10
-
-    filled-new-array {v9, v10}, [Ljava/lang/Object;
-
-    move-result-object v9
-
-    invoke-static {v7, v9}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-static {v5, v7}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    new-instance v7, Ljava/lang/StringBuilder;
-
-    const-string v9, "Engine info loaded for engine "
-
-    invoke-direct {v7, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v7, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-static {v5, v7}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v7, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-    invoke-virtual {v7}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    :try_start_6
-    iget-object v9, v7, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->mDbReadable:Landroid/database/sqlite/SQLiteDatabase;
-
-    const-string/jumbo v10, "sdp_info"
-
-    const-string/jumbo v11, "name"
-
-    const-string/jumbo v12, "value"
-
-    filled-new-array {v11, v12}, [Ljava/lang/String;
-
-    move-result-object v11
-
-    const-string/jumbo v12, "user=?"
-
-    invoke-static {v0}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v13
-
-    filled-new-array {v13}, [Ljava/lang/String;
-
-    move-result-object v13
-
-    const/4 v15, 0x0
-
-    const/16 v16, 0x0
-
-    const/4 v14, 0x0
-
-    invoke-virtual/range {v9 .. v16}, Landroid/database/sqlite/SQLiteDatabase;->query(Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;
-
-    move-result-object v9
-    :try_end_6
-    .catch Ljava/lang/Exception; {:try_start_6 .. :try_end_6} :catch_2
-    .catchall {:try_start_6 .. :try_end_6} :catchall_5
-
-    if-eqz v9, :cond_12
-
-    :goto_d
-    :try_start_7
-    invoke-interface {v9}, Landroid/database/Cursor;->moveToNext()Z
-
-    move-result v10
-
-    if-eqz v10, :cond_12
-
-    invoke-interface {v9, v6}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;
-
-    move-result-object v10
-
-    invoke-interface {v9, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;
-
-    move-result-object v11
-
-    invoke-virtual {v7, v0, v10, v11}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
-    :try_end_7
-    .catch Ljava/lang/Exception; {:try_start_7 .. :try_end_7} :catch_1
-    .catchall {:try_start_7 .. :try_end_7} :catchall_4
-
-    goto :goto_d
-
-    :catchall_4
-    move-exception v0
-
-    move-object v5, v9
-
-    goto :goto_11
-
-    :catch_1
-    move-exception v0
-
-    goto :goto_f
-
-    :cond_12
-    if-eqz v9, :cond_13
-
-    :goto_e
-    invoke-interface {v9}, Landroid/database/Cursor;->close()V
-
-    :cond_13
-    move v0, v8
-
-    goto :goto_10
-
-    :catchall_5
-    move-exception v0
-
-    goto :goto_11
-
-    :catch_2
-    move-exception v0
-
-    move-object v9, v5
-
-    :goto_f
-    :try_start_8
-    const-string/jumbo v7, "preload"
-
-    invoke-static {v0, v7}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->reportError(Ljava/lang/Exception;Ljava/lang/String;)V
-    :try_end_8
-    .catchall {:try_start_8 .. :try_end_8} :catchall_4
-
-    if-eqz v9, :cond_13
-
-    goto :goto_e
-
-    :goto_10
-    const-string/jumbo v7, "SdpManagerImpl"
-
-    new-instance v8, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v9, "SdpEngine boot = "
-
-    invoke-direct {v8, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v8, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v7, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    add-int/lit8 v3, v3, 0x1
-
-    goto/16 :goto_6
-
-    :goto_11
-    if-eqz v5, :cond_14
-
-    invoke-interface {v5}, Landroid/database/Cursor;->close()V
-
-    :cond_14
-    throw v0
-
-    :catchall_6
-    move-exception v0
-
-    :try_start_9
-    monitor-exit v9
-    :try_end_9
-    .catchall {:try_start_9 .. :try_end_9} :catchall_6
-
-    throw v0
-
-    :cond_15
-    :try_start_a
-    invoke-virtual {v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->removeInvalidEngines()V
-    :try_end_a
-    .catch Ljava/lang/Exception; {:try_start_a .. :try_end_a} :catch_3
-
-    goto :goto_12
-
-    :catch_3
-    move-exception v0
-
-    const-string v1, "Failed to remove Invalid Engines!"
-
-    invoke-static {v0, v5, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :goto_12
-    sput-boolean v4, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    return-void
-.end method
-
-.method public static -$$Nest$mrecordException(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Ljava/lang/Exception;Ljava/lang/String;)V
-    .locals 2
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    invoke-static {p0, p2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    const-string/jumbo p2, "Leave a trace of the exception...!"
-
-    invoke-static {p0, p2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p1}, Ljava/lang/Exception;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-static {p0, p2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :try_start_0
-    invoke-virtual {p1}, Ljava/lang/Exception;->getStackTrace()[Ljava/lang/StackTraceElement;
-
-    move-result-object p1
-
-    array-length p2, p1
-
-    const/4 v0, 0x0
-
-    :goto_0
-    if-ge v0, p2, :cond_0
-
-    aget-object v1, p1, v0
-
-    invoke-virtual {v1}, Ljava/lang/StackTraceElement;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {p0, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    add-int/lit8 v0, v0, 0x1
-
-    goto :goto_0
-
-    :catch_0
-    :cond_0
-    return-void
-.end method
-
-.method static constructor <clinit>()V
-    .locals 4
-
-    new-instance v0, Landroid/content/pm/UserInfo;
-
-    const/4 v1, 0x0
-
-    const/4 v2, 0x0
-
-    const/16 v3, -0x2710
-
-    invoke-direct {v0, v3, v1, v1, v2}, Landroid/content/pm/UserInfo;-><init>(ILjava/lang/String;Ljava/lang/String;I)V
-
-    sput-object v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->NULL_USER:Landroid/content/pm/UserInfo;
-
-    return-void
-.end method
-
-.method public constructor <init>(Lcom/android/server/knox/dar/DarManagerService$Injector;)V
-    .locals 3
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    new-instance v0, Ljava/lang/Object;
-
-    invoke-direct {v0}, Ljava/lang/Object;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    new-instance v0, Landroid/util/SparseArray;
-
-    invoke-direct {v0}, Landroid/util/SparseArray;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    const/4 v0, 0x0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    const/16 v1, -0x2710
-
-    iput v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mNeedToSetSdpPolicyForUser:I
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->handlerThread:Landroid/os/HandlerThread;
-
-    new-instance v0, Ljava/util/HashMap;
-
-    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedCredentialMap:Ljava/util/Map;
-
-    new-instance v0, Ljava/util/HashMap;
-
-    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedTokenMap:Ljava/util/Map;
-
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;
-
-    const/4 v1, 0x0
-
-    invoke-direct {v0, p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;-><init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBroadcastReceiver:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;
-
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;
-
-    const/4 v1, 0x1
-
-    invoke-direct {v0, p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;-><init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;I)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mPackageEventReceiver:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$1;
-
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;
-
-    invoke-direct {v0, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;-><init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContainerStateReceiver:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$3;
-
-    new-instance v0, Ljava/util/HashMap;
-
-    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    new-instance v0, Ljava/util/HashMap;
-
-    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
-
-    iget-object v0, p1, Lcom/android/server/knox/dar/DarManagerService$Injector;->mContext:Landroid/content/Context;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
-
-    const/4 v1, 0x0
-
-    iput-boolean v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mIsHandlerReady:Z
-
-    const-string/jumbo v1, "user"
-
-    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Landroid/os/UserManager;
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mUserManager:Landroid/os/UserManager;
-
-    iget-object v1, p1, Lcom/android/server/knox/dar/DarManagerService$Injector;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v2, "device_policy"
-
-    invoke-virtual {v1, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Landroid/app/admin/DevicePolicyManager;
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mDevicePolicyManager:Landroid/app/admin/DevicePolicyManager;
-
-    new-instance v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-
-    invoke-direct {v1, p0, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;-><init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Lcom/android/server/knox/dar/sdp/SdpManagerImpl;)V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-
-    new-instance v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-direct {v1, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;-><init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;)V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    new-instance v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-
-    invoke-direct {v1, p0, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;-><init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Landroid/content/Context;)V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSecureFileSystemManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-
-    new-instance v1, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-    invoke-direct {v1, v0}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;-><init>(Landroid/content/Context;)V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-    iget-object v0, p1, Lcom/android/server/knox/dar/DarManagerService$Injector;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    new-instance v0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
-
-    invoke-direct {v0, p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;-><init>(Lcom/android/server/knox/dar/DarManagerService$Injector;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
-
-    invoke-static {}, Lcom/android/server/knox/dar/KeyProtector;->getInstance()Lcom/android/server/knox/dar/KeyProtector;
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    new-instance p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    invoke-direct {p1, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;-><init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;)V
-
-    const-class v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    invoke-static {v0, p1}, Lcom/android/server/LocalServices;->addService(Ljava/lang/Class;Ljava/lang/Object;)V
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->readEngineList()V
-
-    const-string/jumbo p1, "SdpManagerImpl ready"
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    invoke-static {v0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo p1, "systemReady"
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkCallerPermissionFor(Ljava/lang/String;)V
-
-    new-instance p1, Landroid/os/HandlerThread;
-
-    const/16 v1, 0xa
-
-    invoke-direct {p1, v0, v1}, Landroid/os/HandlerThread;-><init>(Ljava/lang/String;I)V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->handlerThread:Landroid/os/HandlerThread;
-
-    invoke-virtual {p1}, Landroid/os/HandlerThread;->start()V
-
-    new-instance p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->handlerThread:Landroid/os/HandlerThread;
-
-    invoke-virtual {v1}, Landroid/os/HandlerThread;->getLooper()Landroid/os/Looper;
-
-    move-result-object v1
-
-    invoke-direct {p1, p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;-><init>(Lcom/android/server/knox/dar/sdp/SdpManagerImpl;Landroid/os/Looper;)V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    const/4 p1, 0x1
-
-    iput-boolean p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mIsHandlerReady:Z
-
-    const-string/jumbo v1, "Sending message MSG_SYSTEM_READY to handler"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->quickMessage(I)V
-
-    const-string/jumbo p0, "systemReady done."
-
-    invoke-static {v0, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-.end method
-
-.method public static addEngineNative(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;[B)I
-    .locals 2
-
-    filled-new-array {p0, p1}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->isAnyoneEmptyHere([Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    const/16 p0, -0x63
-
-    return p0
-
-    :cond_0
-    invoke-virtual {p0}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v0
-
-    invoke-virtual {p0}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v1
-
-    invoke-static {v0, v1, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->nativeOnUserAdded(II[B)I
-
-    move-result p1
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_1
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "add engine - failed to create engine due to native error "
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result p0
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string/jumbo p1, "SdpManagerImpl"
-
-    invoke-static {p1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/16 p0, -0xb
-
-    return p0
-
-    :cond_1
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public static checkSystemPermission()V
-    .locals 3
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v0
-
-    const/16 v1, 0x3e8
-
-    if-ne v0, v1, :cond_0
-
-    return-void
-
-    :cond_0
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    const-string/jumbo v1, "Require system permission."
-
-    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v0, Ljava/lang/SecurityException;
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "Security Exception Occurred in pid["
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v2
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "] with uid["
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v2
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "]"
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
-
-    throw v0
-.end method
-
-.method public static clearCached(Ljava/util/Map;Ljava/lang/String;I)V
-    .locals 3
-
-    if-nez p0, :cond_0
-
-    return-void
-
-    :cond_0
-    monitor-enter p0
-
-    :try_start_0
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    move-object v1, p0
-
-    check-cast v1, Ljava/util/HashMap;
-
-    invoke-virtual {v1, v0}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    const/4 v2, 0x0
-
-    if-eqz v0, :cond_1
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    invoke-virtual {v1, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, [B
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    invoke-virtual {v1, v0}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
-
-    const-string/jumbo v0, "clear - Managed %s removed for user %d"
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p2
-
-    filled-new-array {p1, p2}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    invoke-static {v0, p1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v2, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p1
-
-    goto :goto_1
-
-    :cond_1
-    const-string/jumbo v0, "clear - Managed %s not found for user %d"
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p2
-
-    filled-new-array {p1, p2}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    invoke-static {v0, p1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v2, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :goto_0
-    monitor-exit p0
-
-    return-void
-
-    :goto_1
-    monitor-exit p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p1
-.end method
-
-.method public static native nativeOnBoot(II)I
-.end method
-
-.method public static native nativeOnChangePassword(I[B[B)I
-.end method
-
-.method public static native nativeOnDeviceLocked(II)I
-.end method
-
-.method public static native nativeOnDeviceUnlocked(I[B)I
-.end method
-
-.method public static native nativeOnMigration(IIII[B)I
-.end method
-
-.method public static native nativeOnUserAdded(II[B)I
-.end method
-
-.method public static native nativeOnUserRemoved(II)I
-.end method
-
-.method public static reWrapSdpKeys(I[B[B)Z
-    .locals 2
-
-    filled-new-array {p1, p2}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->isAnyoneEmptyHere([Ljava/lang/Object;)Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_0
-
-    const-string/jumbo p0, "reWrap - Failed to reWrap sdp keys due to invalid input"
-
-    invoke-static {v1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_0
-    invoke-static {p0, p2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->nativeOnChangePassword(I[B[B)I
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_1
-
-    const-string/jumbo p0, "reWrap - Failed to change password"
-
-    invoke-static {v1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :goto_0
-    const/4 p0, 0x0
-
-    goto :goto_1
-
-    :cond_1
-    const/4 p0, 0x1
-
-    :goto_1
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p2, "Result of reWrapping sdp keys : "
-
-    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v1, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return p0
-.end method
-
-.method public static removeDirectoryRecursive(Ljava/io/File;)V
-    .locals 5
-
-    invoke-virtual {p0}, Ljava/io/File;->isDirectory()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    invoke-virtual {p0}, Ljava/io/File;->list()[Ljava/lang/String;
-
-    move-result-object v0
-
-    if-eqz v0, :cond_0
-
-    array-length v1, v0
-
-    const/4 v2, 0x0
-
-    :goto_0
-    if-ge v2, v1, :cond_0
-
-    aget-object v3, v0, v2
-
-    new-instance v4, Ljava/io/File;
-
-    invoke-direct {v4, p0, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-static {v4}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->removeDirectoryRecursive(Ljava/io/File;)V
-
-    add-int/lit8 v2, v2, 0x1
-
-    goto :goto_0
-
-    :cond_0
-    invoke-virtual {p0}, Ljava/io/File;->delete()Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    const-string v0, "Failed to delete file: %s"
-
-    filled-new-array {p0}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    invoke-static {v0, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    invoke-static {v0, p0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_1
-    return-void
-.end method
-
-.method public static removeEngineNative(II)I
-    .locals 2
-
-    invoke-static {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->nativeOnUserRemoved(II)I
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "removeEngineNative :: failed "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string p0, "/"
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string/jumbo p1, "SdpManagerImpl"
-
-    invoke-static {p1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/16 p0, -0xb
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public static unlockNative(I[B)I
-    .locals 2
-
-    if-eqz p1, :cond_2
-
-    array-length v0, p1
-
-    const/16 v1, 0x20
-
-    if-eq v0, v1, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    invoke-static {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->nativeOnDeviceUnlocked(I[B)I
-
-    move-result p1
-
-    if-eqz p1, :cond_1
-
-    const-string/jumbo p1, "unlockNative :: failed. "
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    invoke-static {p0, p1, v0}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    const/16 p0, -0xb
-
-    return p0
-
-    :cond_1
-    const/4 p0, 0x0
-
-    return p0
-
-    :cond_2
-    :goto_0
-    const/4 p0, -0x3
-
-    return p0
-.end method
-
-
-# virtual methods
-.method public final cacheSafe(Ljava/util/Map;Ljava/lang/String;[BI)V
-    .locals 5
-
-    const-string/jumbo v0, "cache - Fast encryption failed with user "
-
-    const-string/jumbo v1, "cache - Session key not found for user "
-
-    if-eqz p1, :cond_3
-
-    if-nez p3, :cond_0
-
-    goto :goto_2
-
-    :cond_0
-    monitor-enter p1
-
-    :try_start_0
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v2, "SdpSessionKey"
-
-    invoke-static {p4, v2}, Lcom/android/server/knox/dar/KeyProtector;->release(ILjava/lang/String;)[B
-
-    move-result-object v2
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v3
-
-    const/4 v4, 0x0
-
-    if-eqz v3, :cond_1
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, p4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v4, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v2, p3}, Lcom/android/server/knox/dar/KeyProtector;->encryptFast([B[B)[B
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result p3
-
-    if-eqz p3, :cond_2
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, p4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v4, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_2
-    invoke-static {p4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p3
-
-    move-object v0, p1
-
-    check-cast v0, Ljava/util/HashMap;
-
-    invoke-virtual {v0, p3, p0}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    const-string/jumbo p0, "cache - Now %s is under secure management for user %d"
-
-    invoke-static {p4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p3
-
-    filled-new-array {p2, p3}, [Ljava/lang/Object;
-
-    move-result-object p2
-
-    invoke-static {p0, p2}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v4, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :goto_0
-    monitor-exit p1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    return-void
-
-    :goto_1
-    :try_start_1
-    monitor-exit p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_3
-    :goto_2
-    return-void
-.end method
-
-.method public final cancelLegacyResetTimeout(I)V
-    .locals 3
-
-    iget-boolean v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mIsHandlerReady:Z
-
-    if-eqz v0, :cond_0
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    const/16 v2, 0xc
-
-    invoke-virtual {v1, v2, v0}, Landroid/os/Handler;->hasMessages(ILjava/lang/Object;)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    invoke-virtual {p0, v2, v0}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "Legacy reset timout canceled for user "
-
-    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const/4 p1, 0x0
-
-    invoke-static {p1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_0
-    return-void
-.end method
-
-.method public final checkCallerPermissionFor(Ljava/lang/String;)V
-    .locals 3
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v0
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v1
-
-    const-string/jumbo v2, "SdpManagerImpl"
-
-    invoke-static {v0, v1, p0, v2, p1}, Lcom/android/server/ServiceKeeper;->isAuthorized(IILandroid/content/Context;Ljava/lang/String;Ljava/lang/String;)I
-
-    move-result p0
-
-    if-nez p0, :cond_0
-
-    return-void
-
-    :cond_0
-    new-instance p0, Ljava/lang/SecurityException;
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "Security Exception Occurred while pid["
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v1
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "] with uid["
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v1
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "] trying to access methodName ["
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string/jumbo p1, "] in [SdpManagerImpl] service"
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-direct {p0, p1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-.end method
-
-.method public final clearLegacyResetStatus(I)V
-    .locals 2
-
-    const-string v0, "Clear legacy reset status for user "
-
-    const/4 v1, 0x0
-
-    invoke-static {p1, v0, v1}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedTokenMap:Ljava/util/Map;
-
-    const-string/jumbo v0, "token"
-
-    invoke-static {p0, v0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->clearCached(Ljava/util/Map;Ljava/lang/String;I)V
-
-    return-void
-.end method
-
-.method public final generateAndSaveSessionKey(I)Z
-    .locals 2
-
-    sget-object v0, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
-
-    const/16 v1, 0x20
-
-    invoke-virtual {v0, v1}, Ljava/security/SecureRandom;->generateSeed(I)[B
-
-    move-result-object v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    const-string/jumbo v1, "SdpSessionKey"
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1, v1, v0}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
-
-    move-result p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    throw p0
-.end method
-
-.method public final getCached(Ljava/util/Map;Ljava/lang/String;I)[B
-    .locals 6
-
-    const-string/jumbo v0, "get - Fast decryption failed with user "
-
-    const-string/jumbo v1, "get - Session key not found for user "
-
-    monitor-enter p1
-
-    :try_start_0
-    invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v2
-
-    move-object v3, p1
-
-    check-cast v3, Ljava/util/HashMap;
-
-    invoke-virtual {v3, v2}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    const/4 v4, 0x0
-
-    if-nez v2, :cond_0
-
-    const-string/jumbo p0, "get - Managed %s not found for user %d"
-
-    invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p3
-
-    filled-new-array {p2, p3}, [Ljava/lang/Object;
-
-    move-result-object p2
-
-    invoke-static {p0, p2}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v4, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    move-object p0, v4
-
-    goto/16 :goto_2
-
-    :catchall_0
-    move-exception p0
-
-    goto/16 :goto_3
-
-    :cond_0
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v2, "SdpSessionKey"
-
-    invoke-static {p3, v2}, Lcom/android/server/knox/dar/KeyProtector;->release(ILjava/lang/String;)[B
-
-    move-result-object v2
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v5
-
-    if-eqz v5, :cond_1
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v4, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_1
-    invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    invoke-virtual {v3, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, [B
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_2
-
-    const-string/jumbo p0, "get - Empty managed %s found for user %d"
-
-    invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p3
-
-    filled-new-array {p2, p3}, [Ljava/lang/Object;
-
-    move-result-object p2
-
-    invoke-static {p0, p2}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v4, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :goto_0
-    move-object p0, v4
-
-    :goto_1
-    move-object v4, v2
-
-    goto :goto_2
-
-    :cond_2
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v2, v1}, Lcom/android/server/knox/dar/KeyProtector;->decryptFast([B[B)[B
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_3
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p2, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-static {v4, p2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_1
-
-    :cond_3
-    const-string/jumbo v0, "get - Managed %s given for user %d"
-
-    invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p3
-
-    filled-new-array {p2, p3}, [Ljava/lang/Object;
-
-    move-result-object p2
-
-    invoke-static {v0, p2}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-static {v4, p2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_1
-
-    :goto_2
-    monitor-exit p1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v4}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    return-object p0
-
-    :goto_3
-    :try_start_1
-    monitor-exit p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-.method public final getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-    .locals 2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {p0, p1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    if-nez p0, :cond_0
-
-    const-string/jumbo v0, "get - engine info not found in map  for "
-
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    invoke-static {p1, v0, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    :cond_0
-    return-object p0
-.end method
-
-.method public final getEngineInfoLocked(Ljava/lang/String;)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-    .locals 5
-
-    const/4 v0, 0x0
-
-    if-eqz p1, :cond_0
-
-    invoke-virtual {p1}, Ljava/lang/String;->isEmpty()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_3
-
-    :cond_0
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result p1
-
-    invoke-static {p1}, Landroid/os/UserHandle;->getUserId(I)I
-
-    move-result p1
-
-    invoke-static {p1}, Lcom/samsung/android/knox/sdp/SdpUtil;->isAndroidDefaultUser(I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_1
-
-    return-object v0
-
-    :cond_1
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v1
-
-    invoke-virtual {v1}, Landroid/content/pm/UserInfo;->isBMode()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_2
-
-    return-object v0
-
-    :cond_2
-    invoke-static {p1}, Lcom/samsung/android/knox/sdp/SdpUtil;->getAndroidDefaultAlias(I)Ljava/lang/String;
-
-    move-result-object p1
-
-    :cond_3
-    if-eqz p1, :cond_5
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v1}, Landroid/util/SparseArray;->size()I
-
-    move-result v1
-
-    const/4 v2, 0x0
-
-    :goto_0
-    if-ge v2, v1, :cond_5
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v3, v2}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {v4, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_4
-
-    return-object v3
-
-    :cond_4
-    add-int/lit8 v2, v2, 0x1
-
-    goto :goto_0
-
-    :cond_5
-    return-object v0
-.end method
-
-.method public final getLockSettings()Ljava/util/Optional;
-    .locals 1
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
-
-    if-nez v0, :cond_0
-
-    const-string/jumbo v0, "lock_settings"
-
-    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/internal/widget/ILockSettings$Stub;->asInterface(Landroid/os/IBinder;)Lcom/android/internal/widget/ILockSettings;
-
-    move-result-object v0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockSettingsService:Lcom/android/internal/widget/ILockSettings;
-
-    invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
-.method public final getPackageManagerImpl()Ljava/util/Optional;
-    .locals 1
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mPackageManagerImpl:Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;
-
-    if-nez v0, :cond_0
-
-    const-string/jumbo v0, "package"
-
-    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mPackageManagerImpl:Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mPackageManagerImpl:Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;
-
-    invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
-.method public getResetToken(I)[B
-    .locals 3
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkSystemPermission()V
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    const-string/jumbo v2, "SdpResetToken"
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1, v2}, Lcom/android/server/knox/dar/KeyProtector;->release(ILjava/lang/String;)[B
-
-    move-result-object p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-object p0
-
-    :catchall_0
-    move-exception p0
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
-.method public getResetTokenSafe(I)[B
-    .locals 2
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkSystemPermission()V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedTokenMap:Ljava/util/Map;
-
-    const-string/jumbo v1, "token"
-
-    invoke-virtual {p0, v0, v1, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getCached(Ljava/util/Map;Ljava/lang/String;I)[B
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
-.method public getTokenHandle(I)J
-    .locals 0
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkSystemPermission()V
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getTokenHandleViaProtector(I)J
-
-    move-result-wide p0
-
-    return-wide p0
-.end method
-
-.method public final getTokenHandleViaProtector(I)J
-    .locals 3
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    const-string/jumbo v2, "SdpTokenHandle"
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1, v2}, Lcom/android/server/knox/dar/KeyProtector;->release(ILjava/lang/String;)[B
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    sget-object p1, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
-
-    const/16 p1, 0x8
-
-    invoke-static {p1}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
-
-    move-result-object p1
-
-    sget-object v2, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
-
-    invoke-virtual {p1, v2}, Ljava/nio/ByteBuffer;->order(Ljava/nio/ByteOrder;)Ljava/nio/ByteBuffer;
-
-    invoke-virtual {p1, p0}, Ljava/nio/ByteBuffer;->put([B)Ljava/nio/ByteBuffer;
-
-    invoke-virtual {p1}, Ljava/nio/ByteBuffer;->flip()Ljava/nio/Buffer;
-
-    invoke-virtual {p1}, Ljava/nio/ByteBuffer;->getLong()J
-
-    move-result-wide p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_0
-
-    :cond_0
-    const-wide/16 p0, 0x0
-
-    :goto_0
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-wide p0
-
-    :catchall_0
-    move-exception p0
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
-.method public final getUserInfo(I)Landroid/content/pm/UserInfo;
-    .locals 2
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mUserManager:Landroid/os/UserManager;
-
-    if-eqz p0, :cond_0
-
-    invoke-virtual {p0, p1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    :goto_0
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    if-eqz p0, :cond_1
-
-    return-object p0
-
-    :cond_1
-    sget-object p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->NULL_USER:Landroid/content/pm/UserInfo;
-
-    return-object p0
-.end method
-
-.method public final handleEmptyListenerRoll(I)V
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    check-cast v0, Ljava/util/HashMap;
-
-    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;
-
-    if-eqz v0, :cond_0
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;->mStateListeners:Ljava/util/ArrayList;
-
-    invoke-virtual {v0}, Ljava/util/ArrayList;->isEmpty()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    check-cast p0, Ljava/util/HashMap;
-
-    invoke-virtual {p0, p1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
-
-    :cond_0
-    return-void
-.end method
-
-.method public final hasBiometricTypeTraced(I)Z
-    .locals 2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {p0, p1}, Lcom/android/internal/widget/LockPatternUtils;->getBiometricType(I)I
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const/4 v0, 0x1
-
-    goto :goto_0
-
-    :cond_0
-    const/4 v0, 0x0
-
-    :goto_0
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_1
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    filled-new-array {p1, p0}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string p1, "Biometrics detected for user %d [ Type : %d ]"
-
-    invoke-static {p1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return v0
-
-    :cond_1
-    const-string p0, "Biometrics not detected for user "
-
-    invoke-static {p1, p0, v1}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return v0
-.end method
-
-.method public final hasNoSecurity(I)Z
-    .locals 3
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {v0, p1}, Lcom/android/internal/widget/LockPatternUtils;->getActivePasswordQuality(I)I
-
-    move-result v0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {p0, p1}, Lcom/android/internal/widget/LockPatternUtils;->isLockScreenDisabled(I)Z
-
-    move-result p0
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object v2
-
-    filled-new-array {p1, v1, v2}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    const-string v1, "Check security - [ User ID : %d, Quality : %d, None type? %s ]"
-
-    invoke-static {v1, p1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    invoke-static {v1, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    if-nez p0, :cond_1
-
-    if-nez v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-
-    :cond_1
-    :goto_0
-    const/4 p0, 0x1
-
-    return p0
-.end method
-
-.method public initializeMasterKeyIfRequired([BI)V
-    .locals 6
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    return-void
-
-    :cond_0
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "sdp essential key initialized for user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v0, "SdpEphemeralKey"
-
-    invoke-static {p2, v0}, Lcom/android/server/knox/dar/KeyProtector;->release(ILjava/lang/String;)[B
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    const/4 v3, 0x0
-
-    if-eqz v2, :cond_1
-
-    const-string v1, "Failed to get ephemeral key"
-
-    invoke-static {v3, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_1
-    invoke-static {p2, p1, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->reWrapSdpKeys(I[B[B)Z
-
-    move-result v1
-
-    invoke-static {v1}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_2
-
-    const-string v1, "Failed to rewrap sdp essential key"
-
-    invoke-static {v3, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_2
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p2, v0}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
-
-    move-result v1
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-
-    invoke-static {v1}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_3
-
-    const-string v1, "Failed to delete ephemeral key"
-
-    invoke-static {v3, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :goto_0
-    const/4 v1, 0x0
-
-    goto :goto_1
-
-    :cond_3
-    const/4 v1, 0x1
-
-    :goto_1
-    if-eqz v1, :cond_5
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-    if-nez v2, :cond_4
-
-    const-class v2, Lcom/android/internal/widget/LockSettingsInternal;
-
-    invoke-static {v2}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/internal/widget/LockSettingsInternal;
-
-    iput-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-    :cond_4
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-    invoke-static {v2}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object v2
-
-    new-instance v4, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2;
-
-    const/4 v5, 0x0
-
-    invoke-direct {v4, p2, v5}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda2;-><init>(II)V
-
-    invoke-virtual {v2, v4}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object v2
-
-    const/4 v4, -0x1
-
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v5
-
-    invoke-virtual {v2, v5}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Ljava/lang/Integer;
-
-    invoke-virtual {v2}, Ljava/lang/Integer;->intValue()I
-
-    move-result v2
-
-    if-ne v2, v4, :cond_5
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v2
-
-    filled-new-array {v2}, [Ljava/lang/Object;
-
-    move-result-object v2
-
-    const-string/jumbo v4, "User %d has none type credential"
-
-    invoke-static {v4, v2}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v3, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p2, v0, p1}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
-
-    move-result p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-
-    :cond_5
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p1, "Result of key adjustment : "
-
-    invoke-direct {p0, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v3, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-.end method
-
-.method public final isEngineOwner(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-    .locals 2
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v0
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
-
-    invoke-virtual {p0, v0, v1, p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->isEngineOwner(IILcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-
-    move-result p0
-
-    return p0
-.end method
-
-.method public final isPrivileged(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-    .locals 3
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v0
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->getPackageName(I)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isAndroidDefaultEngine()Z
-
-    move-result v1
-
-    const/4 v2, 0x0
-
-    if-eqz v1, :cond_0
-
-    goto :goto_1
-
-    :cond_0
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isCustomEngine()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_3
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMapLock:Ljava/lang/Object;
-
-    monitor-enter v1
-
-    :try_start_0
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->getSdpPolicyLocked(Ljava/lang/String;)Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;
-
-    move-result-object p0
-
-    if-nez p0, :cond_1
-
-    monitor-exit v1
-
-    return v2
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_0
-
-    :cond_1
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :try_start_1
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->getPrivilegedApps()Ljava/util/List;
-
-    move-result-object p0
-
-    if-eqz v0, :cond_3
-
-    if-eqz p0, :cond_3
-
-    invoke-interface {p0}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object p0
-
-    :cond_2
-    invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_3
-
-    invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpDomain;->getPackageName()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-virtual {v0, p1}, Ljava/lang/String;->matches(Ljava/lang/String;)Z
-
-    move-result p1
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-
-    if-eqz p1, :cond_2
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    goto :goto_1
-
-    :goto_0
-    :try_start_2
-    monitor-exit v1
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :cond_3
-    :goto_1
-    return v2
-.end method
-
-.method public isSdpPackage(ILjava/lang/String;)Z
-    .locals 5
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v0}, Landroid/util/SparseArray;->size()I
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->readEngineList()V
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v0}, Landroid/util/SparseArray;->size()I
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    move v2, v1
-
-    :goto_0
-    if-ge v1, v0, :cond_2
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v3, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    if-eqz v3, :cond_1
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getPackageName()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {v4, p2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_1
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v3
-
-    if-ne v3, p1, :cond_1
-
-    const/4 v2, 0x1
-
-    :cond_1
-    add-int/lit8 v1, v1, 0x1
-
-    goto :goto_0
-
-    :cond_2
-    return v2
-.end method
-
-.method public final isSystemComponent(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-    .locals 2
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v0
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
-
-    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->getPackageName(I)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->isSystemServer(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result p1
-
-    invoke-virtual {p0, p1, v1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->isSystemApp(ILjava/lang/String;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-
-    :cond_1
-    :goto_0
-    const/4 p0, 0x1
-
-    return p0
-.end method
-
-.method public final isUcmUser(I)Z
-    .locals 4
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-    const-string/jumbo v0, "ucm_user"
-
-    invoke-virtual {p0, p1, v0}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->getInternal(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string v0, "1"
-
-    invoke-virtual {v0, p0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    const/4 v1, 0x1
-
-    const/4 v2, 0x0
-
-    if-nez v0, :cond_0
-
-    const-string v0, "0"
-
-    invoke-virtual {v0, p0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move p0, v2
-
-    goto :goto_0
-
-    :cond_0
-    move p0, v1
-
-    :goto_0
-    if-nez p0, :cond_3
-
-    if-nez p1, :cond_2
-
-    const-string/jumbo v0, "persist.security.ucm_fbe_mode"
-
-    invoke-static {v0, v2}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I
-
-    move-result v0
-
-    const/4 v3, 0x2
-
-    if-ne v0, v3, :cond_1
-
-    goto :goto_1
-
-    :cond_1
-    move v1, v2
-
-    goto :goto_1
-
-    :cond_2
-    const-string/jumbo v0, "persist.sys.knox.UCM_WPC"
-
-    invoke-static {v0, v2}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z
-
-    move-result v1
-
-    :goto_1
-    if-eqz v1, :cond_3
-
-    const-string/jumbo v0, "UCM with SDP user : "
-
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    invoke-static {p1, v0, v1}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    :cond_3
-    return p0
-.end method
-
-.method public final lockFinal(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)I
-    .locals 2
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    const/4 p0, -0x3
-
-    return p0
-
-    :cond_0
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v0
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v1
-
-    invoke-static {v0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->nativeOnDeviceLocked(II)I
-
-    move-result v0
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    const/16 p0, -0xb
-
-    return p0
-
-    :cond_1
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    const/4 v1, 0x1
-
-    :try_start_0
-    invoke-virtual {p0, p1, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->setEngineStateLocked(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;I)V
-
-    monitor-exit v0
-
-    const/4 p0, 0x0
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
-.method public lockSdpIfRequired(I)V
-    .locals 4
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    return-void
-
-    :cond_0
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "sdp essential key eviction required for user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v1
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    const/4 v2, 0x0
-
-    if-eqz v0, :cond_1
-
-    const-string v0, "Couldn\'t find engine info for user "
-
-    invoke-static {p1, v0, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    const/16 v0, -0x63
-
-    goto :goto_0
-
-    :cond_1
-    invoke-virtual {v1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getState()I
-
-    move-result v0
-
-    const/4 v3, 0x1
-
-    if-ne v0, v3, :cond_2
-
-    const-string v0, "Engine already locked for user "
-
-    invoke-static {p1, v0, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    const/4 v0, 0x0
-
-    goto :goto_0
-
-    :cond_2
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->lockFinal(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)I
-
-    move-result v0
-
-    :goto_0
-    if-nez v0, :cond_3
-
-    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    goto :goto_1
-
-    :cond_3
-    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    :goto_1
-    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_5
-
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v3
-
-    if-nez v3, :cond_5
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->hasBiometricTypeTraced(I)Z
-
-    move-result v3
-
-    if-nez v3, :cond_5
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->hasNoSecurity(I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_4
-
-    goto :goto_2
-
-    :cond_4
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedCredentialMap:Ljava/util/Map;
-
-    const-string/jumbo v3, "credential"
-
-    invoke-static {p0, v3, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->clearCached(Ljava/util/Map;Ljava/lang/String;I)V
-
-    :cond_5
-    :goto_2
-    const-string/jumbo p0, "Result of sdp lock : %s [ rc : %d ]"
-
-    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    filled-new-array {p1, v0}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    invoke-static {p0, p1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v2, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-.method public onCredentialChanged(II)V
-    .locals 2
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "Password has been changed for user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    const/4 v0, -0x1
-
-    const/4 v1, 0x0
-
-    if-ne p1, v0, :cond_1
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter p1
-
-    :try_start_0
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v0
-
-    monitor-exit p1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    invoke-virtual {v0}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getState()I
-
-    move-result p1
-
-    const/4 v0, 0x1
-
-    if-ne p1, v0, :cond_2
-
-    const-string p1, "Engine is locked after changing to none type."
-
-    invoke-static {v1, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    const/4 p1, 0x4
-
-    invoke-virtual {p0, p2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->unlockSdpIfUnsecuredOrBiometricAuthenticated(II)V
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_1
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    const-string/jumbo v0, "SdpEphemeralKey"
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p2, v0}, Lcom/android/server/knox/dar/KeyProtector;->exists(ILjava/lang/String;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_2
-
-    const-string p1, "According as user %d password changed, remove ephemeral key"
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    filled-new-array {v0}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    invoke-static {p1, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v1, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p0, "SdpEphemeralKey"
-
-    invoke-static {p2, p0}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
-
-    move-result p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-
-    :cond_2
-    :goto_0
-    return-void
-.end method
-
-.method public onDeviceLocked(I)V
-    .locals 3
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "onDeviceLocked : User "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    const/4 v0, 0x0
-
-    if-nez p1, :cond_1
-
-    sget-boolean v1, Lcom/android/server/knox/dar/DarUtil;->mIsDeviceOwnerEnabled:Z
-
-    if-nez v1, :cond_0
-
-    const-string v1, "DARUtil"
-
-    const-string v2, "Device owner status not updated yet..."
-
-    invoke-static {v1, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {v0}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
-
-    move-result v1
-
-    :cond_0
-    if-eqz v1, :cond_1
-
-    const/4 v0, 0x1
-
-    :cond_1
-    if-nez v0, :cond_2
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_2
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->lockSdpIfRequired(I)V
-
-    :cond_2
-    return-void
-.end method
-
-.method public onDeviceUnlocked(I)V
-    .locals 2
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "onDeviceUnLocked "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->hasBiometricTypeTraced(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    const/16 v0, 0x8
-
-    invoke-virtual {p0, p1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->unlockSdpIfUnsecuredOrBiometricAuthenticated(II)V
-
-    return-void
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {v0, p1}, Lcom/android/internal/widget/LockPatternUtils;->isLockScreenDisabled(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    const-string/jumbo v0, "User has no lock"
-
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 v0, 0x4
-
-    invoke-virtual {p0, p1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->unlockSdpIfUnsecuredOrBiometricAuthenticated(II)V
-
-    :cond_1
-    return-void
-.end method
-
-.method public final onEngineRemoved(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-    .locals 4
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v0
-
-    const-string v1, "Engine info cleared for engine "
-
-    const/4 v2, 0x0
-
-    invoke-static {v0, v1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-    invoke-virtual {v1, v0}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->destroy(I)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p1
-
-    check-cast p0, Ljava/util/HashMap;
-
-    invoke-virtual {p0, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Ljava/util/ArrayList;
-
-    if-nez p0, :cond_0
-
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_2
-
-    :cond_0
-    invoke-virtual {p0}, Ljava/util/ArrayList;->size()I
-
-    move-result p1
-
-    add-int/lit8 p1, p1, -0x1
-
-    :goto_0
-    if-ltz p1, :cond_1
-
-    invoke-virtual {p0, p1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :try_start_1
-    iget-object v1, v1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;->mListener:Lcom/samsung/android/knox/dar/sdp/ISdpListener;
-
-    invoke-interface {v1}, Lcom/samsung/android/knox/dar/sdp/ISdpListener;->onEngineRemoved()V
-    :try_end_1
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    goto :goto_1
-
-    :catch_0
-    move-exception v1
-
-    :try_start_2
-    const-string/jumbo v2, "SdpManagerImpl"
-
-    const-string/jumbo v3, "Listener failed"
-
-    invoke-static {v2, v3, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    goto :goto_1
-
-    :catch_1
-    const-string/jumbo v1, "SdpManagerImpl"
-
-    const-string/jumbo v2, "Listener dead"
-
-    invoke-static {v1, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, p1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
-
-    :goto_1
-    add-int/lit8 p1, p1, -0x1
-
-    goto :goto_0
-
-    :cond_1
-    monitor-exit v0
-
-    return-void
-
-    :goto_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-.end method
-
-.method public final onLegacyResetCredentialRequested(II[B)V
-    .locals 4
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "Legacy reset credential policy requested for user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v1, ", timeoutMins:"
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v1, 0x0
-
-    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-static {p3}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    const-string p0, "Failed due to invalid token"
-
-    invoke-static {v1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedTokenMap:Ljava/util/Map;
-
-    const-string/jumbo v2, "token"
-
-    invoke-virtual {p0, v0, v2, p3, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->cacheSafe(Ljava/util/Map;Ljava/lang/String;[BI)V
-
-    if-gtz p2, :cond_1
-
-    const-wide/32 p2, 0xdbba0
-
-    goto :goto_0
-
-    :cond_1
-    int-to-long p2, p2
-
-    const-wide/32 v2, 0xea60
-
-    mul-long/2addr p2, v2
-
-    :goto_0
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    const/16 v0, 0xc
-
-    invoke-virtual {p0, v0, p2, p3, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->quickMessageDelayed(IJLjava/lang/Object;)V
-
-    const-string/jumbo p0, "Ready to reset credential!"
-
-    invoke-static {v1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-.end method
-
-.method public final quickMessage(I)V
-    .locals 1
-
-    iget-boolean v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mIsHandlerReady:Z
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    invoke-virtual {p0, p1}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Landroid/os/Message;->sendToTarget()V
-
-    return-void
-
-    :cond_0
-    const-string p0, "Failed to send a message : "
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    invoke-static {p1, p0, v0}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-.end method
-
-.method public final quickMessage(II)V
-    .locals 1
-
-    iget-boolean v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mIsHandlerReady:Z
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    const/4 v0, 0x0
-
-    invoke-virtual {p0, p1, p2, v0}, Landroid/os/Handler;->obtainMessage(III)Landroid/os/Message;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Landroid/os/Message;->sendToTarget()V
-
-    return-void
-
-    :cond_0
-    const-string p0, "Failed to send a message : "
-
-    const-string/jumbo p2, "SdpManagerImpl"
-
-    invoke-static {p1, p0, p2}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-.end method
-
-.method public final quickMessage(ILandroid/os/Bundle;)V
-    .locals 1
-
-    iget-boolean v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mIsHandlerReady:Z
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    invoke-virtual {p0, p1}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p2}, Landroid/os/Message;->setData(Landroid/os/Bundle;)V
-
-    invoke-virtual {p0}, Landroid/os/Message;->sendToTarget()V
-
-    return-void
-
-    :cond_0
-    const-string p0, "Failed to send a message : "
-
-    const-string/jumbo p2, "SdpManagerImpl"
-
-    invoke-static {p1, p0, p2}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-.end method
-
-.method public final quickMessageDelayed(IJLjava/lang/Object;)V
-    .locals 2
-
-    iget-boolean v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mIsHandlerReady:Z
-
-    if-eqz v0, :cond_2
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    invoke-virtual {v0, p1, p4}, Landroid/os/Handler;->hasMessages(ILjava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    invoke-virtual {v0, p1, p4}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    invoke-virtual {v0, p1, p4}, Landroid/os/Handler;->obtainMessage(ILjava/lang/Object;)Landroid/os/Message;
-
-    move-result-object p4
-
-    const-wide/16 v0, 0x0
-
-    cmp-long v0, p2, v0
-
-    if-gtz v0, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    invoke-virtual {p0, p4}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z
-
-    move-result p0
-
-    goto :goto_0
-
-    :cond_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpHandler:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpHandler;
-
-    invoke-virtual {p0, p4, p2, p3}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z
-
-    move-result p0
-
-    goto :goto_0
-
-    :cond_2
-    const/4 p0, 0x0
-
-    :goto_0
-    if-nez p0, :cond_3
-
-    const-string p0, "Failed to send a message delayed : "
-
-    const-string/jumbo p2, "SdpManagerImpl"
-
-    invoke-static {p1, p0, p2}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    :cond_3
-    return-void
-.end method
-
-.method public final readEngineList()V
-    .locals 8
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mgetEngineListLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;)Landroid/util/SparseArray;
-
-    move-result-object v1
-
-    if-eqz v1, :cond_1
-
-    const/4 v2, 0x0
-
-    :goto_0
-    invoke-virtual {v1}, Landroid/util/SparseArray;->size()I
-
-    move-result v3
-
-    if-ge v2, v3, :cond_2
-
-    invoke-virtual {v1, v2}, Landroid/util/SparseArray;->keyAt(I)I
-
-    move-result v3
-
-    invoke-virtual {v1, v3}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
-
-    move-result-object v4
-
-    check-cast v4, Ljava/lang/String;
-
-    const-string/jumbo v5, "SdpManagerImpl"
-
-    const-string/jumbo v6, "read engine - [%s, %d] found in engine list"
-
-    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v7
-
-    filled-new-array {v4, v7}, [Ljava/lang/Object;
-
-    move-result-object v7
-
-    invoke-static {v6, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-static {v5, v6}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v5, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {v5, v3}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mgetEngineInfoLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v5
-
-    if-eqz v5, :cond_0
-
-    const-string/jumbo v4, "SdpManagerImpl"
-
-    new-instance v6, Ljava/lang/StringBuilder;
-
-    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v7, "read engine - Put "
-
-    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->toString()Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-static {v4, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v4, v3, v5}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
-
-    invoke-virtual {v3, v5}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->loadPolicy(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_2
-
-    :cond_0
-    const-string/jumbo v5, "SdpManagerImpl"
-
-    const-string/jumbo v6, "read engine - Can\'t find engine info with [%s, %d]"
-
-    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v3
-
-    filled-new-array {v4, v3}, [Ljava/lang/Object;
-
-    move-result-object v3
-
-    invoke-static {v6, v3}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-static {v5, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_1
-    add-int/lit8 v2, v2, 0x1
-
-    goto :goto_0
-
-    :cond_1
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo v1, "read engine - No any engine found"
-
-    invoke-static {p0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_2
-    monitor-exit v0
-
-    return-void
-
-    :goto_2
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
-.method public final removeEngineInternal(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)I
-    .locals 3
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v0
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    const-string/jumbo v2, "SdpEphemeralKey"
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0, v2}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    const-string/jumbo v2, "SdpSessionKey"
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v0, v2}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-
-    invoke-virtual {v1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->clearLock(I)V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mVirtualLock:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;
-
-    invoke-virtual {v1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$VirtualLockClient;->clean(I)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    invoke-virtual {v0, p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->removePolicy(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v2
-
-    invoke-virtual {v1, v2}, Landroid/util/SparseArray;->remove(I)V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {v1, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mremoveEngineInfoLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mupdateEngineListLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;)V
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->onEngineRemoved(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result p0
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v0
-
-    invoke-static {p0, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->removeEngineNative(II)I
-
-    move-result p0
-
-    const-string/jumbo v0, "SdpManagerImpl"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "remove :: successfully engine removed! "
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-.method public final removeInvalidEngines()V
-    .locals 7
-
-    new-instance v0, Ljava/util/ArrayList;
-
-    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v1
-
-    :try_start_0
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v2}, Landroid/util/SparseArray;->size()I
-
-    move-result v2
-
-    add-int/lit8 v2, v2, -0x1
-
-    :goto_0
-    if-ltz v2, :cond_1
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v3, v2}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    if-eqz v3, :cond_0
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v4
-
-    if-eqz v4, :cond_0
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v4
-
-    invoke-virtual {p0, v4}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v4
-
-    sget-object v5, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->NULL_USER:Landroid/content/pm/UserInfo;
-
-    if-ne v4, v5, :cond_0
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isCustomEngine()Z
-
-    move-result v4
-
-    if-eqz v4, :cond_0
-
-    const-string/jumbo v4, "SdpManagerImpl"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v6, "Invalid user - Add Custom engine to Removing Engine "
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->toString()Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v4, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v0, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_3
-
-    :cond_0
-    :goto_1
-    add-int/lit8 v2, v2, -0x1
-
-    goto :goto_0
-
-    :cond_1
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I
-
-    move-result v1
-
-    const/4 v2, 0x0
-
-    :goto_2
-    if-ge v2, v1, :cond_2
-
-    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v3
-
-    add-int/lit8 v2, v2, 0x1
-
-    check-cast v3, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    const-string/jumbo v4, "SdpManagerImpl"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    const-string v6, "Invalid user - Removing Custom engine "
-
-    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->toString()Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-static {v4, v5}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p0, v3}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->removeEngineInternal(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)I
-
-    goto :goto_2
-
-    :cond_2
-    return-void
-
-    :goto_3
-    :try_start_1
-    monitor-exit v1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-.method public saveMasterKeyIfUnsecured([BI)V
-    .locals 2
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    return-void
-
-    :cond_0
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "sdp essential key deserted with user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    filled-new-array {v0}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    const-string/jumbo v1, "User %d has none type credential"
-
-    invoke-static {v1, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v1, 0x0
-
-    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p0, "SdpEphemeralKey"
-
-    invoke-static {p2, p0, p1}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
-
-    move-result p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-
-    return-void
-.end method
-
-.method public saveResetTokenSafe([BI)V
-    .locals 2
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedTokenMap:Ljava/util/Map;
-
-    const-string/jumbo v1, "token"
-
-    invoke-virtual {p0, v0, v1, p1, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->cacheSafe(Ljava/util/Map;Ljava/lang/String;[BI)V
-
-    return-void
-.end method
-
-.method public final setEngineStateLocked(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;I)V
-    .locals 10
-
-    invoke-virtual {p1, p2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->setState(I)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mBinderListeners:Ljava/util/Map;
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v2
-
-    check-cast v1, Ljava/util/HashMap;
-
-    invoke-virtual {v1, v2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Ljava/util/ArrayList;
-
-    const/4 v2, 0x1
-
-    if-nez v1, :cond_0
-
-    monitor-exit v0
-
-    goto :goto_2
-
-    :catchall_0
-    move-exception p0
-
-    goto/16 :goto_9
-
-    :cond_0
-    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I
-
-    move-result v3
-
-    sub-int/2addr v3, v2
-
-    :goto_0
-    if-ltz v3, :cond_1
-
-    invoke-virtual {v1, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v4
-
-    check-cast v4, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :try_start_1
-    iget-object v4, v4, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpManagerImplBinderListener;->mListener:Lcom/samsung/android/knox/dar/sdp/ISdpListener;
-
-    invoke-interface {v4, p2}, Lcom/samsung/android/knox/dar/sdp/ISdpListener;->onStateChange(I)V
-    :try_end_1
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    goto :goto_1
-
-    :catch_0
-    move-exception v4
-
-    :try_start_2
-    const-string/jumbo v5, "SdpManagerImpl"
-
-    const-string/jumbo v6, "Listener failed"
-
-    invoke-static {v5, v6, v4}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    goto :goto_1
-
-    :catch_1
-    const-string/jumbo v4, "SdpManagerImpl"
-
-    const-string/jumbo v5, "Listener dead"
-
-    invoke-static {v4, v5}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v1, v3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
-
-    :goto_1
-    add-int/lit8 v3, v3, -0x1
-
-    goto :goto_0
-
-    :cond_1
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    :goto_2
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v0
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    monitor-enter v1
-
-    :try_start_3
-    iget-object v3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v4
-
-    check-cast v3, Ljava/util/HashMap;
-
-    invoke-virtual {v3, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;
-
-    const/4 v4, 0x0
-
-    if-eqz v3, :cond_6
-
-    iget-object v3, v3, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;->mStateListeners:Ljava/util/ArrayList;
-
-    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I
-
-    move-result v5
-
-    sub-int/2addr v5, v2
-
-    :goto_3
-    if-ltz v5, :cond_5
-
-    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v6
-
-    check-cast v6, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    :try_start_4
-    iget-object v7, v6, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->mWeakListener:Ljava/lang/ref/WeakReference;
-
-    invoke-virtual {v7}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;
-
-    move-result-object v7
-
-    check-cast v7, Lcom/samsung/android/knox/dar/sdp/ISdpListener;
-    :try_end_4
-    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_4
-    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_3
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
-
-    if-eqz v7, :cond_2
-
-    move v8, v2
-
-    goto :goto_4
-
-    :cond_2
-    move v8, v4
-
-    :goto_4
-    if-eqz v8, :cond_3
-
-    :try_start_5
-    invoke-interface {v7, p2}, Lcom/samsung/android/knox/dar/sdp/ISdpListener;->onStateChange(I)V
-    :try_end_5
-    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_5} :catch_5
-    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_2
-    .catchall {:try_start_5 .. :try_end_5} :catchall_1
-
-    goto :goto_6
-
-    :catchall_1
-    move-exception p0
-
-    goto/16 :goto_8
-
-    :catch_2
-    move-exception v7
-
-    goto :goto_5
-
-    :catch_3
-    move-exception v7
-
-    move v8, v4
-
-    :goto_5
-    :try_start_6
-    invoke-virtual {v7}, Ljava/lang/Exception;->printStackTrace()V
-
-    goto :goto_6
-
-    :catch_4
-    move v8, v4
-
-    :catch_5
-    const-string/jumbo v7, "SdpManagerImpl"
-
-    const-string/jumbo v9, "Listener might be dead..."
-
-    invoke-static {v7, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_3
-    :goto_6
-    if-nez v8, :cond_4
-
-    invoke-virtual {v6}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$StateListener;->dispose()V
-
-    :cond_4
-    add-int/lit8 v5, v5, -0x1
-
-    goto :goto_3
-
-    :cond_5
-    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->handleEmptyListenerRoll(I)V
-
-    :cond_6
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v3
-
-    check-cast v2, Ljava/util/HashMap;
-
-    invoke-virtual {v2, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v2
-
-    if-nez v2, :cond_7
-
-    goto :goto_7
-
-    :cond_7
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mListenerMap:Ljava/util/Map;
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v3
-
-    check-cast v2, Ljava/util/HashMap;
-
-    invoke-virtual {v2, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;
-
-    iget-object v2, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$ListenerRoll;->mStateListeners:Ljava/util/ArrayList;
-
-    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I
-
-    move-result v4
-
-    :goto_7
-    const-string/jumbo v2, "SdpManagerImpl"
-
-    const-string/jumbo v3, "onStateChange :: Engine Id : %d, State : %d, Roll Size : %d"
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v5
-
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v4
-
-    filled-new-array {v0, v5, v4}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    invoke-static {v3, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    monitor-exit v1
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_1
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getUserId()I
-
-    move-result v0
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result p1
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v1
-
-    iget-boolean v3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mIsHandlerReady:Z
-
-    if-eqz v3, :cond_8
-
-    new-instance v3, Landroid/os/Bundle;
-
-    invoke-direct {v3}, Landroid/os/Bundle;-><init>()V
-
-    const-string/jumbo v4, "userId"
-
-    invoke-virtual {v3, v4, v0}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    const-string/jumbo v4, "engineId"
-
-    invoke-virtual {v3, v4, p1}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    const-string/jumbo p1, "state"
-
-    invoke-virtual {v3, p1, p2}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    const/16 p1, 0xf
-
-    invoke-virtual {p0, p1, v3}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->quickMessage(ILandroid/os/Bundle;)V
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p1, "change state for user "
-
-    invoke-direct {p0, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const/4 p1, 0x0
-
-    invoke-static {p1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_8
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :goto_8
-    :try_start_7
-    monitor-exit v1
-    :try_end_7
-    .catchall {:try_start_7 .. :try_end_7} :catchall_1
-
-    throw p0
-
-    :goto_9
-    :try_start_8
-    monitor-exit v0
-    :try_end_8
-    .catchall {:try_start_8 .. :try_end_8} :catchall_0
-
-    throw p0
-.end method
-
-.method public final unlockFinal(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;[B)I
-    .locals 1
-
-    invoke-static {p2}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    const/4 p0, -0x1
-
-    return p0
-
-    :cond_0
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    const/4 p0, -0x3
-
-    return p0
-
-    :cond_1
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v0
-
-    invoke-static {v0, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->nativeOnDeviceUnlocked(I[B)I
-
-    move-result p2
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p2
-
-    invoke-static {p2}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_2
-
-    const/16 p0, -0xb
-
-    return p0
-
-    :cond_2
-    iget-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter p2
-
-    const/4 v0, 0x2
-
-    :try_start_0
-    invoke-virtual {p0, p1, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->setEngineStateLocked(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;I)V
-
-    monitor-exit p2
-
-    const/4 p0, 0x0
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit p2
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
-.method public unlockSdpIfUnsecuredOrBiometricAuthenticated(II)V
-    .locals 5
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    return-void
-
-    :cond_0
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "sdp essential key derivation required for user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string v1, "Issued order is identified as "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v1, 0x0
-
-    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v2
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    const/16 v3, -0x63
-
-    if-eqz v0, :cond_1
-
-    const-string p2, "Couldn\'t find engine info for user "
-
-    invoke-static {p1, p2, v1}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    move-object p2, v1
-
-    goto :goto_1
-
-    :cond_1
-    const/4 v0, 0x4
-
-    if-eq p2, v0, :cond_3
-
-    const/16 v0, 0x8
-
-    if-eq p2, v0, :cond_2
-
-    const/16 v0, 0x10
-
-    if-eq p2, v0, :cond_2
-
-    const-string/jumbo v0, "Unexpected condition while check order "
-
-    invoke-static {p2, v0, v1}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    move-object p2, v1
-
-    goto :goto_0
-
-    :cond_2
-    iget-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedCredentialMap:Ljava/util/Map;
-
-    const-string/jumbo v0, "credential"
-
-    invoke-virtual {p0, p2, v0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getCached(Ljava/util/Map;Ljava/lang/String;I)[B
-
-    move-result-object p2
-
-    invoke-static {p2}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    const-string/jumbo v0, "Managed credential not found for user "
-
-    invoke-static {p1, v0, v1}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_3
-    iget-object p2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p2, "SdpEphemeralKey"
-
-    invoke-static {p1, p2}, Lcom/android/server/knox/dar/KeyProtector;->release(ILjava/lang/String;)[B
-
-    move-result-object p2
-
-    invoke-static {p2}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    const-string v0, "Ephemeral key not found for user "
-
-    invoke-static {p1, v0, v1}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    :cond_4
-    :goto_0
-    invoke-static {p2}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_5
-
-    const-string v0, "Failed to unlock due to invalid key"
-
-    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_1
-
-    :cond_5
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getState()I
-
-    move-result v0
-
-    const/4 v3, 0x2
-
-    if-ne v0, v3, :cond_6
-
-    const-string v0, "Engine already unlocked for user "
-
-    invoke-static {p1, v0, v1}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    :cond_6
-    invoke-virtual {p0, v2, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->unlockFinal(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;[B)I
-
-    move-result v3
-
-    :goto_1
-    if-nez v3, :cond_7
-
-    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    goto :goto_2
-
-    :cond_7
-    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    :goto_2
-    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_8
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedCredentialMap:Ljava/util/Map;
-
-    const-string/jumbo v4, "credential"
-
-    invoke-virtual {p0, v2, v4, p2, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->cacheSafe(Ljava/util/Map;Ljava/lang/String;[BI)V
-
-    :cond_8
-    invoke-static {p2}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    const-string/jumbo p0, "Result of sdp unlock : %s [ rc : %d ]"
-
-    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p2
-
-    filled-new-array {p1, p2}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    invoke-static {p0, p1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-.method public unlockSdpOnCredentialVerified([BI)V
-    .locals 5
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    return-void
-
-    :cond_0
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "sdp essential key acquired for user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getEngineInfoLocked(I)Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    move-result-object v1
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    const/4 v2, 0x0
-
-    if-eqz v0, :cond_1
-
-    const-string v0, "Couldn\'t find engine info for user "
-
-    invoke-static {p2, v0, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_1
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    const-string v0, "Failed to unlock due to invalid key"
-
-    invoke-static {v2, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :goto_0
-    const/16 v0, -0x63
-
-    goto :goto_1
-
-    :cond_2
-    invoke-virtual {v1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getState()I
-
-    move-result v0
-
-    const/4 v3, 0x2
-
-    if-ne v0, v3, :cond_3
-
-    const-string v0, "Engine already unlocked for user "
-
-    invoke-static {p2, v0, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    :cond_3
-    invoke-virtual {p0, v1, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->unlockFinal(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;[B)I
-
-    move-result v0
-
-    :goto_1
-    if-nez v0, :cond_4
-
-    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    goto :goto_2
-
-    :cond_4
-    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    :goto_2
-    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_5
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mManagedCredentialMap:Ljava/util/Map;
-
-    const-string/jumbo v4, "credential"
-
-    invoke-virtual {p0, v3, v4, p1, p2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->cacheSafe(Ljava/util/Map;Ljava/lang/String;[BI)V
-
-    :cond_5
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    const-string/jumbo p0, "Result of sdp unlock : %s [ rc : %d ]"
-
-    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p2
-
-    filled-new-array {p1, p2}, [Ljava/lang/Object;
-
-    move-result-object p1
-
-    invoke-static {p0, p1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v2, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-.method public final updateDeviceOwnerStatus()V
-    .locals 4
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    const/4 v1, 0x0
-
-    invoke-virtual {v0, v1}, Lcom/android/internal/widget/LockPatternUtils;->isDeviceOwner(I)Z
-
-    move-result v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->updateDeviceOwnerStatus(Z)V
-
-    sget-boolean v0, Lcom/android/server/knox/dar/DarUtil;->mIsDeviceOwnerEnabled:Z
-
-    if-nez v0, :cond_0
-
-    const-string v0, "DARUtil"
-
-    const-string v2, "Device owner status not updated yet..."
-
-    invoke-static {v0, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {v1}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
-
-    move-result v0
-
-    :cond_0
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string v3, "Device owner status updated! [ Enabled : "
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string v0, " ]"
-
-    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string/jumbo v2, "SdpManagerImpl"
-
-    invoke-static {v2, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-    const-string/jumbo v2, "do_cleared"
-
-    invoke-virtual {v0, v1, v2}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->getInternal(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string v1, "1"
-
-    invoke-virtual {v1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v1
-
-    if-nez v1, :cond_1
-
-    const-string p0, "0"
+    new-instance v0, Landroid/content/pm/UserInfo;
 
-    invoke-virtual {p0, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    const/4 v1, 0x0
 
-    return-void
+    const/4 v2, 0x0
 
-    :cond_1
-    const/16 v0, 0xa
+    const/16 v3, -0x2710
 
-    invoke-virtual {p0, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->quickMessage(I)V
+    invoke-direct {v0, v3, v1, v1, v2}, Landroid/content/pm/UserInfo;-><init>(ILjava/lang/String;Ljava/lang/String;I)V
 
     return-void
 .end method
 
-.method public welcomeNewUser(I)V
-    .locals 13
-    .annotation runtime Landroid/annotation/SystemApi;
-    .end annotation
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "Welcome new user "
+.method public static checkSystemPermission()V
+    .locals 3
 
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
 
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    move-result v0
 
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    const/16 v1, 0x3e8
 
-    move-result-object v0
+    if-ne v0, v1, :cond_0
 
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
+    return-void
 
-    sget-object v0, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
+    :cond_0
+    const-string/jumbo v0, "SdpManagerImpl"
 
-    const/16 v1, 0x20
+    const-string/jumbo v1, "Require system permission."
 
-    invoke-virtual {v0, v1}, Ljava/security/SecureRandom;->generateSeed(I)[B
+    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result-object v0
+    new-instance v0, Ljava/lang/SecurityException;
 
     new-instance v1, Ljava/lang/StringBuilder;
 
-    const-string v2, "Establish new engine for user "
+    const-string/jumbo v2, "Security Exception Occurred in pid["
 
     invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    const/4 v2, 0x0
-
-    invoke-static {v2, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v1
-
-    const/4 v3, 0x0
-
-    const/4 v4, 0x1
-
-    if-eqz v1, :cond_0
-
-    :goto_0
-    move v7, p1
-
-    move p1, v3
-
-    goto/16 :goto_3
-
-    :cond_0
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    invoke-static {p1}, Lcom/samsung/android/knox/sdp/SdpUtil;->getAndroidDefaultAlias(I)Ljava/lang/String;
-
-    move-result-object v6
-
-    new-instance v5, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    const/4 v11, 0x6
-
-    const/4 v12, 0x0
+    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
 
-    const/4 v9, 0x1
+    move-result v2
 
-    const/4 v10, 0x0
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    move v8, p1
+    const-string/jumbo v2, "] with uid["
 
-    move v7, p1
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-direct/range {v5 .. v12}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;-><init>(Ljava/lang/String;IIIIIZ)V
+    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
 
-    new-instance p1, Ljava/util/ArrayList;
+    move-result v2
 
-    invoke-direct {p1}, Ljava/util/ArrayList;-><init>()V
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-static {v5, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->addEngineNative(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;[B)I
+    const-string/jumbo v2, "]"
 
-    move-result v1
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object v1
 
-    invoke-static {v1}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_2
-
-    const-string/jumbo p1, "establish - Unexpected failure while native setup"
-
-    invoke-static {v2, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_1
-
-    :cond_2
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mServiceKeeper:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v6
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    invoke-virtual {v1, v6, v5, p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->addPolicy(ILcom/samsung/android/knox/sdp/core/SdpEngineInfo;Ljava/util/List;)I
-
-    move-result p1
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
+    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
 
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
+    throw v0
+.end method
 
-    move-result p1
+.method public static isSupportedDevice()V
+    .locals 2
 
-    if-eqz p1, :cond_3
+    const-string/jumbo v0, "SdpManagerImpl"
 
-    const-string/jumbo p1, "establish - Unexpected failure while policy setup"
+    const-string/jumbo v1, "SDP not supported"
 
-    invoke-static {v2, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_1
-    move p1, v3
+    return-void
+.end method
 
-    goto :goto_2
+.method public static native nativeOnBoot(II)I
+.end method
 
-    :cond_3
-    invoke-virtual {v5}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
+.method public static native nativeOnChangePassword(I[B[B)I
+.end method
 
-    move-result p1
+.method public static native nativeOnDeviceLocked(II)I
+.end method
 
-    const-string v1, "Engine info initialized for engine "
+.method public static native nativeOnDeviceUnlocked(I[B)I
+.end method
 
-    invoke-static {p1, v1, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+.method public static native nativeOnMigration(IIII[B)I
+.end method
 
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
+.method public static native nativeOnUserAdded(II[B)I
+.end method
 
-    invoke-virtual {v1, p1}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->destroy(I)V
+.method public static native nativeOnUserRemoved(II)I
+.end method
 
-    invoke-static {v4}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
 
-    move-result-object v6
+# virtual methods
+.method public getResetToken(I)[B
+    .locals 1
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    const-string/jumbo v8, "smk_ver"
+    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkSystemPermission()V
 
-    invoke-virtual {v1, p1, v8, v6}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDbLock:Ljava/lang/Object;
+    move-result-wide p0
 
-    monitor-enter p1
+    const/4 v0, 0x0
 
     :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineMap:Landroid/util/SparseArray;
-
-    invoke-virtual {v5}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v6
-
-    invoke-virtual {v1, v6, v5}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {v1, v5}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mstoreEngineInfoLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpEngineDb:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;->-$$Nest$mupdateEngineListLocked(Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpEngineDatabase;)V
-
-    monitor-exit p1
+    throw v0
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    move p1, v4
-
-    :goto_2
-    const-string/jumbo v1, "Result of engine establishment for user %d : %s"
-
-    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v5
-
-    invoke-static {p1}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object v6
-
-    filled-new-array {v5, v6}, [Ljava/lang/Object;
-
-    move-result-object v5
-
-    invoke-static {v1, v5}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v2, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :goto_3
-    invoke-static {p1}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p1
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_4
-
-    const-string/jumbo p1, "Welcome - Failed to create new engine"
-
-    invoke-static {v2, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_4
-
-    :cond_4
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p1, "SdpEphemeralKey"
-
-    invoke-static {v7, p1, v0}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
-
-    move-result p1
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->record(Z)V
-
-    invoke-static {p1}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p1
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_5
-
-    const-string/jumbo p1, "Welcome - Failed to safekeep sdp ephemeral key"
+    :catchall_0
+    move-exception v0
 
-    invoke-static {v2, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {p0, p1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :goto_4
-    move p1, v3
+    throw v0
+.end method
 
-    goto :goto_5
+.method public getResetTokenSafe(I)[B
+    .locals 0
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    :cond_5
-    invoke-virtual {p0, v7}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->generateAndSaveSessionKey(I)Z
+    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkSystemPermission()V
 
-    move-result p1
+    const/4 p0, 0x0
 
-    invoke-static {p1}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+    throw p0
+.end method
 
-    move-result-object p1
+.method public getTokenHandle(I)J
+    .locals 1
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    invoke-static {p1}, Lcom/android/server/knox/dar/SecureUtil;->isFailed(Ljava/lang/Object;)Z
+    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkSystemPermission()V
 
-    move-result p1
+    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    if-eqz p1, :cond_6
+    move-result-wide p0
 
-    const-string/jumbo p1, "Welcome - Failed to prepare session key"
+    const/4 v0, 0x0
 
-    invoke-static {v2, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    :try_start_0
+    throw v0
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    :cond_6
-    iput v7, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mNeedToSetSdpPolicyForUser:I
+    :catchall_0
+    move-exception v0
 
-    move p1, v4
+    invoke-static {p0, p1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    :goto_5
-    invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
+    throw v0
+.end method
 
-    if-nez v7, :cond_7
+.method public initializeMasterKeyIfRequired([BI)V
+    .locals 0
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    const-string/jumbo v0, "persist.security.ucm_fbe_mode"
+    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSupportedDevice()V
 
-    invoke-static {v0, v3}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I
+    return-void
+.end method
 
-    move-result v0
+.method public isSdpPackage(ILjava/lang/String;)Z
+    .locals 0
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    const/4 v1, 0x2
+    const/4 p0, 0x0
 
-    if-ne v0, v1, :cond_8
+    throw p0
+.end method
 
-    move v3, v4
+.method public lockSdpIfRequired(I)V
+    .locals 0
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    goto :goto_6
+    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSupportedDevice()V
 
-    :cond_7
-    const-string/jumbo v0, "persist.sys.knox.UCM_WPC"
+    return-void
+.end method
 
-    invoke-static {v0, v3}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z
+.method public onCredentialChanged(II)V
+    .locals 0
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    move-result v3
+    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSupportedDevice()V
 
-    :cond_8
-    :goto_6
-    if-eqz v3, :cond_9
+    return-void
+.end method
 
-    const-string/jumbo v0, "UCM enabled for user "
+.method public onDeviceLocked(I)V
+    .locals 0
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    invoke-static {v7, v0, v2}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSupportedDevice()V
 
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
+    return-void
+.end method
 
-    const-string/jumbo v0, "ucm_user"
+.method public onDeviceUnlocked(I)V
+    .locals 0
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    const-string v1, "1"
+    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSupportedDevice()V
 
-    invoke-virtual {p0, v7, v0, v1}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
+    return-void
+.end method
 
-    :cond_9
-    const-string/jumbo p0, "Result of welcoming new user %d : %s"
+.method public saveMasterKeyIfUnsecured([BI)V
+    .locals 0
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSupportedDevice()V
 
-    move-result-object v0
+    return-void
+.end method
 
-    invoke-static {p1}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+.method public saveResetTokenSafe([BI)V
+    .locals 0
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    move-result-object p1
+    return-void
+.end method
 
-    filled-new-array {v0, p1}, [Ljava/lang/Object;
+.method public unlockSdpIfUnsecuredOrBiometricAuthenticated(II)V
+    .locals 0
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    move-result-object p1
+    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSupportedDevice()V
 
-    invoke-static {p0, p1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    return-void
+.end method
 
-    move-result-object p0
+.method public unlockSdpOnCredentialVerified([BI)V
+    .locals 0
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    invoke-static {v2, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSupportedDevice()V
 
     return-void
+.end method
 
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
+.method public welcomeNewUser(I)V
+    .locals 0
+    .annotation runtime Landroid/annotation/SystemApi;
+    .end annotation
 
-    :try_start_1
-    monitor-exit p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSupportedDevice()V
 
-    throw p0
+    return-void
 .end method
diff --git a/smali/com/android/server/knox/dar/sdp/SdpManagerInternal.smali b/smali/com/android/server/knox/dar/sdp/SdpManagerInternal.smali
new file mode 100644
index 000000000..f49f34625
--- /dev/null
+++ b/smali/com/android/server/knox/dar/sdp/SdpManagerInternal.smali
@@ -0,0 +1,3 @@
+.class public abstract Lcom/android/server/knox/dar/sdp/SdpManagerInternal;
+.super Ljava/lang/Object;
+.source "SourceFile"
diff --git a/smali/com/android/server/knox/dar/sdp/engine/SdpPolicy.smali b/smali/com/android/server/knox/dar/sdp/engine/SdpPolicy.smali
deleted file mode 100644
index cd1cf8186..000000000
--- a/smali/com/android/server/knox/dar/sdp/engine/SdpPolicy.smali
+++ /dev/null
@@ -1,325 +0,0 @@
-.class public Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/io/Serializable;
-
-
-# instance fields
-.field private mAlias:Ljava/lang/String;
-
-.field private mOwner:Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-.field private mPrivilegedApps:Ljava/util/List;
-    .annotation system Ldalvik/annotation/Signature;
-        value = {
-            "Ljava/util/List<",
-            "Lcom/samsung/android/knox/sdp/core/SdpDomain;",
-            ">;"
-        }
-    .end annotation
-.end field
-
-
-# direct methods
-.method public constructor <init>(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;Lcom/samsung/android/knox/sdp/core/SdpDomain;Ljava/util/List;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mAlias:Ljava/lang/String;
-
-    iput-object p2, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mOwner:Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    iput-object p3, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mPrivilegedApps:Ljava/util/List;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final addPrivilegedApp(Lcom/samsung/android/knox/sdp/core/SdpDomain;)Z
-    .locals 3
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpDomain;->getAlias()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpDomain;->getPackageName()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result v2
-
-    if-nez v2, :cond_2
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mAlias:Ljava/lang/String;
-
-    invoke-virtual {v0, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mPrivilegedApps:Ljava/util/List;
-
-    invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v0
-
-    :cond_0
-    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_1
-
-    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpDomain;->getPackageName()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_0
-
-    goto :goto_0
-
-    :cond_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mPrivilegedApps:Ljava/util/List;
-
-    invoke-interface {p0, p1}, Ljava/util/List;->add(Ljava/lang/Object;)Z
-
-    move-result p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    return p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :cond_2
-    :goto_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final getOwner()Lcom/samsung/android/knox/sdp/core/SdpDomain;
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mOwner:Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    return-object p0
-.end method
-
-.method public final getPrivilegedApps()Ljava/util/List;
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mPrivilegedApps:Ljava/util/List;
-
-    return-object p0
-.end method
-
-.method public final removePrivilegedApp(Lcom/samsung/android/knox/sdp/core/SdpDomain;)Z
-    .locals 3
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpDomain;->getAlias()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpDomain;->getPackageName()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {v0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result v1
-
-    if-nez v1, :cond_1
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mAlias:Ljava/lang/String;
-
-    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mPrivilegedApps:Ljava/util/List;
-
-    invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v0
-
-    :cond_0
-    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_1
-
-    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    invoke-virtual {v1}, Lcom/samsung/android/knox/sdp/core/SdpDomain;->getPackageName()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {p1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mPrivilegedApps:Ljava/util/List;
-
-    invoke-interface {p0, v1}, Ljava/util/List;->remove(Ljava/lang/Object;)Z
-
-    move-result p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    return p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :cond_1
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final toString()Ljava/lang/String;
-    .locals 5
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "SdpPolicy {\n"
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string v2, "Alias:"
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mAlias:Ljava/lang/String;
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v1, "\n"
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mOwner:Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    if-eqz v2, :cond_0
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "mOwner:"
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mOwner:Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    invoke-virtual {v3}, Lcom/samsung/android/knox/sdp/core/SdpDomain;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->mPrivilegedApps:Ljava/util/List;
-
-    invoke-interface {p0}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object p0
-
-    :goto_0
-    invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_1
-
-    invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v4, "mPrivilegedApps:"
-
-    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2}, Lcom/samsung/android/knox/sdp/core/SdpDomain;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    goto :goto_0
-
-    :cond_1
-    const-string/jumbo p0, "}"
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    return-object p0
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler.smali b/smali/com/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler.smali
deleted file mode 100644
index 305105d91..000000000
--- a/smali/com/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler.smali
+++ /dev/null
@@ -1,285 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;
-.super Lorg/xml/sax/helpers/DefaultHandler;
-.source "SourceFile"
-
-
-# instance fields
-.field public attrAlias:Ljava/lang/String;
-
-.field public attrPkgName:Ljava/lang/String;
-
-.field public elementStack:Ljava/util/Stack;
-
-.field public mInfo:Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-.field public owner:Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-.field public privilegedApps:Ljava/util/List;
-
-
-# virtual methods
-.method public final characters([CII)V
-    .locals 0
-
-    new-instance p0, Ljava/lang/String;
-
-    invoke-direct {p0, p1, p2, p3}, Ljava/lang/String;-><init>([CII)V
-
-    const-string/jumbo p1, "start characters : "
-
-    invoke-virtual {p1, p0}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string/jumbo p1, "SdpServiceKeeper"
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-.end method
-
-.method public final endDocument()V
-    .locals 1
-
-    const-string/jumbo p0, "SdpServiceKeeper"
-
-    const-string/jumbo v0, "end document     : "
-
-    invoke-static {p0, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-.end method
-
-.method public final endElement(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-    .locals 1
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->elementStack:Ljava/util/Stack;
-
-    invoke-virtual {p1}, Ljava/util/Stack;->pop()Ljava/lang/Object;
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p2, "end element      : "
-
-    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo p2, "SdpServiceKeeper"
-
-    invoke-static {p2, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo p1, "privileged_app"
-
-    invoke-virtual {p3, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->mInfo:Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p1
-
-    if-eqz p1, :cond_1
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->attrAlias:Ljava/lang/String;
-
-    iget-object p2, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->mInfo:Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    invoke-virtual {p2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-virtual {p1, p2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_1
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->privilegedApps:Ljava/util/List;
-
-    new-instance p2, Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    iget-object p3, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->attrAlias:Ljava/lang/String;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->attrPkgName:Ljava/lang/String;
-
-    invoke-direct {p2, p3, v0}, Lcom/samsung/android/knox/sdp/core/SdpDomain;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    check-cast p1, Ljava/util/ArrayList;
-
-    invoke-virtual {p1, p2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_0
-
-    :cond_0
-    const-string/jumbo p1, "owner"
-
-    invoke-virtual {p3, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_1
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->mInfo:Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p1
-
-    if-eqz p1, :cond_1
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->attrAlias:Ljava/lang/String;
-
-    iget-object p2, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->mInfo:Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    invoke-virtual {p2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-virtual {p1, p2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_1
-
-    new-instance p1, Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    iget-object p2, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->attrAlias:Ljava/lang/String;
-
-    iget-object p3, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->attrPkgName:Ljava/lang/String;
-
-    invoke-direct {p1, p2, p3}, Lcom/samsung/android/knox/sdp/core/SdpDomain;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->owner:Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    :cond_1
-    :goto_0
-    const/4 p1, 0x0
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->attrAlias:Ljava/lang/String;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->attrPkgName:Ljava/lang/String;
-
-    return-void
-.end method
-
-.method public final startDocument()V
-    .locals 1
-
-    const-string/jumbo p0, "SdpServiceKeeper"
-
-    const-string/jumbo v0, "start document   : "
-
-    invoke-static {p0, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-.end method
-
-.method public final startElement(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Lorg/xml/sax/Attributes;)V
-    .locals 2
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->elementStack:Ljava/util/Stack;
-
-    invoke-virtual {p1, p3}, Ljava/util/Stack;->push(Ljava/lang/Object;)Ljava/lang/Object;
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p2, "start element    : "
-
-    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string/jumbo p2, "SdpServiceKeeper"
-
-    invoke-static {p2, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo p1, "privileged_app"
-
-    invoke-virtual {p3, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_1
-
-    const-string/jumbo p1, "owner"
-
-    invoke-virtual {p3, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    return-void
-
-    :cond_1
-    :goto_0
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string p3, " attribte alias: "
-
-    invoke-direct {p1, p3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    const-string/jumbo p3, "alias"
-
-    invoke-interface {p4, p3}, Lorg/xml/sax/Attributes;->getValue(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p2, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string v0, " attribte pkg_name: "
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    const-string/jumbo v0, "pkg_name"
-
-    invoke-interface {p4, v0}, Lorg/xml/sax/Attributes;->getValue(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {p1, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p2, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-interface {p4, p3}, Lorg/xml/sax/Attributes;->getValue(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->attrAlias:Ljava/lang/String;
-
-    invoke-interface {p4, v0}, Lorg/xml/sax/Attributes;->getValue(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->attrPkgName:Ljava/lang/String;
-
-    return-void
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase.smali b/smali/com/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase.smali
deleted file mode 100644
index ae2a0e905..000000000
--- a/smali/com/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase.smali
+++ /dev/null
@@ -1,922 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# direct methods
-.method public static -$$Nest$mgetPolicyLocked(Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;
-    .locals 6
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    new-instance p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;
-
-    invoke-direct {p0}, Lorg/xml/sax/helpers/DefaultHandler;-><init>()V
-
-    new-instance v0, Ljava/util/Stack;
-
-    invoke-direct {v0}, Ljava/util/Stack;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->elementStack:Ljava/util/Stack;
-
-    const/4 v0, 0x0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->mInfo:Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    new-instance v1, Ljava/util/ArrayList;
-
-    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->privilegedApps:Ljava/util/List;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->owner:Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->mInfo:Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v1
-
-    invoke-static {}, Lcom/android/server/knox/dar/KeyProtector;->getInstance()Lcom/android/server/knox/dar/KeyProtector;
-
-    move-result-object v3
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "_sdp_policy_hash"
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v5
-
-    invoke-virtual {v3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v5, v4}, Lcom/android/server/knox/dar/KeyProtector;->release(ILjava/lang/String;)[B
-
-    move-result-object v3
-
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    :try_start_0
-    invoke-static {p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;->getPolicyXmlFile(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Ljava/io/File;
-
-    move-result-object p1
-    :try_end_0
-    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p1
-
-    invoke-virtual {p1}, Ljava/io/IOException;->printStackTrace()V
-
-    move-object p1, v0
-
-    :goto_0
-    const-string/jumbo v1, "SdpServiceKeeper"
-
-    if-eqz p1, :cond_3
-
-    if-nez v3, :cond_0
-
-    goto/16 :goto_7
-
-    :cond_0
-    const/16 v2, 0x20
-
-    new-array v2, v2, [B
-
-    const/4 v4, 0x0
-
-    invoke-static {v2, v4}, Ljava/util/Arrays;->fill([BB)V
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;->generateHash(Ljava/io/File;)[B
-
-    move-result-object v2
-
-    if-eqz v2, :cond_1
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "loadPolicy :: generated hash : "
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;->byteToHex([B)Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-static {v1, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "loadPolicy :: stored hash : "
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-static {v3}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;->byteToHex([B)Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-static {v1, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_1
-    invoke-static {v2, v3}, Ljava/util/Arrays;->equals([B[B)Z
-
-    move-result v2
-
-    if-nez v2, :cond_2
-
-    const-string/jumbo p0, "Policy file tempered!"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_8
-
-    :cond_2
-    :try_start_1
-    new-instance v2, Ljava/io/FileInputStream;
-
-    invoke-direct {v2, p1}, Ljava/io/FileInputStream;-><init>(Ljava/io/File;)V
-    :try_end_1
-    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_3
-
-    :try_start_2
-    invoke-static {}, Ljavax/xml/parsers/SAXParserFactory;->newInstance()Ljavax/xml/parsers/SAXParserFactory;
-
-    move-result-object p1
-
-    invoke-virtual {p1}, Ljavax/xml/parsers/SAXParserFactory;->newSAXParser()Ljavax/xml/parsers/SAXParser;
-
-    move-result-object p1
-
-    invoke-virtual {p1}, Ljavax/xml/parsers/SAXParser;->getXMLReader()Lorg/xml/sax/XMLReader;
-
-    move-result-object p1
-
-    invoke-interface {p1, p0}, Lorg/xml/sax/XMLReader;->setContentHandler(Lorg/xml/sax/ContentHandler;)V
-
-    new-instance v3, Lorg/xml/sax/InputSource;
-
-    invoke-direct {v3, v2}, Lorg/xml/sax/InputSource;-><init>(Ljava/io/InputStream;)V
-
-    invoke-interface {p1, v3}, Lorg/xml/sax/XMLReader;->parse(Lorg/xml/sax/InputSource;)V
-    :try_end_2
-    .catch Lorg/xml/sax/SAXException; {:try_start_2 .. :try_end_2} :catch_2
-    .catch Ljava/io/IOException; {:try_start_2 .. :try_end_2} :catch_2
-    .catch Ljavax/xml/parsers/ParserConfigurationException; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    goto :goto_3
-
-    :catch_1
-    move-exception p1
-
-    goto :goto_1
-
-    :catch_2
-    move-exception p1
-
-    goto :goto_2
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_4
-
-    :goto_1
-    :try_start_3
-    invoke-virtual {p1}, Ljavax/xml/parsers/ParserConfigurationException;->printStackTrace()V
-
-    goto :goto_3
-
-    :goto_2
-    invoke-virtual {p1}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :goto_3
-    :try_start_4
-    invoke-virtual {v2}, Ljava/io/FileInputStream;->close()V
-    :try_end_4
-    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_3
-
-    new-instance v0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->mInfo:Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->owner:Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase$PolicyXmlHandler;->privilegedApps:Ljava/util/List;
-
-    invoke-direct {v0, p1, v1, p0}, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;-><init>(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;Lcom/samsung/android/knox/sdp/core/SdpDomain;Ljava/util/List;)V
-
-    goto :goto_8
-
-    :catch_3
-    move-exception p0
-
-    goto :goto_6
-
-    :goto_4
-    :try_start_5
-    invoke-virtual {v2}, Ljava/io/FileInputStream;->close()V
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_1
-
-    goto :goto_5
-
-    :catchall_1
-    move-exception p1
-
-    :try_start_6
-    invoke-virtual {p0, p1}, Ljava/lang/Throwable;->addSuppressed(Ljava/lang/Throwable;)V
-
-    :goto_5
-    throw p0
-    :try_end_6
-    .catch Ljava/io/IOException; {:try_start_6 .. :try_end_6} :catch_3
-
-    :goto_6
-    invoke-virtual {p0}, Ljava/io/IOException;->printStackTrace()V
-
-    const-string/jumbo p0, "engine_poilcy xml io failed"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_8
-
-    :cond_3
-    :goto_7
-    const-string/jumbo p0, "No policy file or its hash"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_8
-    return-object v0
-.end method
-
-.method public static -$$Nest$mputPolicyLocked(Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;)I
-    .locals 12
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string p0, " putPolicyLocked failed"
-
-    const-string/jumbo v0, "pkg_name"
-
-    const-string/jumbo v1, "alias"
-
-    const-string/jumbo v2, "SdpServiceKeeper"
-
-    :try_start_0
-    invoke-static {p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;->getPolicyXmlFile(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Ljava/io/File;
-
-    move-result-object v3
-    :try_end_0
-    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_1
-
-    const/16 v4, -0x63
-
-    :try_start_1
-    invoke-static {}, Ljavax/xml/parsers/DocumentBuilderFactory;->newInstance()Ljavax/xml/parsers/DocumentBuilderFactory;
-
-    move-result-object v5
-
-    invoke-virtual {v5}, Ljavax/xml/parsers/DocumentBuilderFactory;->newDocumentBuilder()Ljavax/xml/parsers/DocumentBuilder;
-
-    move-result-object v5
-
-    invoke-virtual {v5}, Ljavax/xml/parsers/DocumentBuilder;->newDocument()Lorg/w3c/dom/Document;
-
-    move-result-object v5
-
-    const-string/jumbo v6, "engine_policy"
-
-    invoke-interface {v5, v6}, Lorg/w3c/dom/Document;->createElement(Ljava/lang/String;)Lorg/w3c/dom/Element;
-
-    move-result-object v6
-
-    invoke-interface {v5, v6}, Lorg/w3c/dom/Document;->appendChild(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
-
-    const-string/jumbo v7, "owner"
-
-    invoke-interface {v5, v7}, Lorg/w3c/dom/Document;->createElement(Ljava/lang/String;)Lorg/w3c/dom/Element;
-
-    move-result-object v7
-
-    invoke-interface {v5, v1}, Lorg/w3c/dom/Document;->createAttribute(Ljava/lang/String;)Lorg/w3c/dom/Attr;
-
-    move-result-object v8
-
-    invoke-interface {v5, v0}, Lorg/w3c/dom/Document;->createAttribute(Ljava/lang/String;)Lorg/w3c/dom/Attr;
-
-    move-result-object v9
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v10
-
-    invoke-interface {v8, v10}, Lorg/w3c/dom/Attr;->setValue(Ljava/lang/String;)V
-
-    invoke-interface {v7, v8}, Lorg/w3c/dom/Element;->setAttributeNode(Lorg/w3c/dom/Attr;)Lorg/w3c/dom/Attr;
-
-    invoke-virtual {p2}, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->getOwner()Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    move-result-object v8
-
-    invoke-virtual {v8}, Lcom/samsung/android/knox/sdp/core/SdpDomain;->getPackageName()Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-interface {v9, v8}, Lorg/w3c/dom/Attr;->setValue(Ljava/lang/String;)V
-
-    invoke-interface {v7, v9}, Lorg/w3c/dom/Element;->setAttributeNode(Lorg/w3c/dom/Attr;)Lorg/w3c/dom/Attr;
-
-    invoke-interface {v6, v7}, Lorg/w3c/dom/Element;->appendChild(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
-
-    invoke-virtual {p2}, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->getPrivilegedApps()Ljava/util/List;
-
-    move-result-object p2
-
-    if-eqz p2, :cond_0
-
-    invoke-interface {p2}, Ljava/util/List;->isEmpty()Z
-
-    move-result v7
-
-    if-nez v7, :cond_0
-
-    invoke-interface {p2}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object p2
-
-    :goto_0
-    invoke-interface {p2}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v7
-
-    if-eqz v7, :cond_0
-
-    invoke-interface {p2}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v7
-
-    check-cast v7, Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    const-string/jumbo v8, "privileged_app"
-
-    invoke-interface {v5, v8}, Lorg/w3c/dom/Document;->createElement(Ljava/lang/String;)Lorg/w3c/dom/Element;
-
-    move-result-object v8
-
-    invoke-interface {v5, v1}, Lorg/w3c/dom/Document;->createAttribute(Ljava/lang/String;)Lorg/w3c/dom/Attr;
-
-    move-result-object v9
-
-    invoke-interface {v5, v0}, Lorg/w3c/dom/Document;->createAttribute(Ljava/lang/String;)Lorg/w3c/dom/Attr;
-
-    move-result-object v10
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v11
-
-    invoke-interface {v9, v11}, Lorg/w3c/dom/Attr;->setValue(Ljava/lang/String;)V
-
-    invoke-interface {v8, v9}, Lorg/w3c/dom/Element;->setAttributeNode(Lorg/w3c/dom/Attr;)Lorg/w3c/dom/Attr;
-
-    invoke-virtual {v7}, Lcom/samsung/android/knox/sdp/core/SdpDomain;->getPackageName()Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-interface {v10, v7}, Lorg/w3c/dom/Attr;->setValue(Ljava/lang/String;)V
-
-    invoke-interface {v8, v10}, Lorg/w3c/dom/Element;->setAttributeNode(Lorg/w3c/dom/Attr;)Lorg/w3c/dom/Attr;
-
-    invoke-interface {v6, v8}, Lorg/w3c/dom/Element;->appendChild(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p1
-
-    goto :goto_1
-
-    :cond_0
-    invoke-static {}, Ljavax/xml/transform/TransformerFactory;->newInstance()Ljavax/xml/transform/TransformerFactory;
-
-    move-result-object p2
-
-    invoke-virtual {p2}, Ljavax/xml/transform/TransformerFactory;->newTransformer()Ljavax/xml/transform/Transformer;
-
-    move-result-object p2
-
-    const-string/jumbo v0, "indent"
-
-    const-string/jumbo v1, "yes"
-
-    invoke-virtual {p2, v0, v1}, Ljavax/xml/transform/Transformer;->setOutputProperty(Ljava/lang/String;Ljava/lang/String;)V
-
-    new-instance v0, Ljavax/xml/transform/dom/DOMSource;
-
-    invoke-direct {v0, v5}, Ljavax/xml/transform/dom/DOMSource;-><init>(Lorg/w3c/dom/Node;)V
-
-    new-instance v1, Ljavax/xml/transform/stream/StreamResult;
-
-    invoke-direct {v1, v3}, Ljavax/xml/transform/stream/StreamResult;-><init>(Ljava/io/File;)V
-
-    invoke-virtual {p2, v0, v1}, Ljavax/xml/transform/Transformer;->transform(Ljavax/xml/transform/Source;Ljavax/xml/transform/Result;)V
-    :try_end_1
-    .catch Ljavax/xml/parsers/ParserConfigurationException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljavax/xml/transform/TransformerException; {:try_start_1 .. :try_end_1} :catch_0
-
-    const/16 p0, 0x20
-
-    new-array p0, p0, [B
-
-    const/4 p2, 0x0
-
-    invoke-static {p0, p2}, Ljava/util/Arrays;->fill([BB)V
-
-    invoke-static {v3}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;->generateHash(Ljava/io/File;)[B
-
-    move-result-object p0
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    invoke-static {}, Lcom/android/server/knox/dar/KeyProtector;->getInstance()Lcom/android/server/knox/dar/KeyProtector;
-
-    move-result-object v3
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string/jumbo v6, "_sdp_policy_hash"
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v5
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result p1
-
-    invoke-virtual {v3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1, v5, p0}, Lcom/android/server/knox/dar/KeyProtector;->protect(ILjava/lang/String;[B)Z
-
-    move-result p0
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    if-eqz p0, :cond_1
-
-    const-string/jumbo p0, "putPolicyLocked :: SUCCESS"
-
-    invoke-static {v2, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    return p2
-
-    :cond_1
-    const-string/jumbo p0, "can\'t store hash to key protector"
-
-    invoke-static {v2, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v4
-
-    :goto_1
-    invoke-virtual {p1}, Ljava/lang/Exception;->printStackTrace()V
-
-    invoke-static {v2, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_2
-
-    :catch_1
-    move-exception p1
-
-    invoke-virtual {p1}, Ljava/io/IOException;->printStackTrace()V
-
-    invoke-static {v2, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/16 v4, -0xc
-
-    :goto_2
-    return v4
-.end method
-
-.method public static -$$Nest$mremovePolicyLocked(Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-    .locals 5
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo p0, "SdpServiceKeeper"
-
-    :try_start_0
-    invoke-static {p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;->getPolicyXmlFile(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Ljava/io/File;
-
-    move-result-object v0
-    :try_end_0
-    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
-
-    invoke-virtual {v0}, Ljava/io/File;->delete()Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    const-string v0, "Couldn\'t remove policy file!"
-
-    invoke-static {p0, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_0
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    invoke-static {}, Lcom/android/server/knox/dar/KeyProtector;->getInstance()Lcom/android/server/knox/dar/KeyProtector;
-
-    move-result-object v2
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string/jumbo v4, "_sdp_policy_hash"
-
-    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result p1
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {p1, v3}, Lcom/android/server/knox/dar/KeyProtector;->delete(ILjava/lang/String;)Z
-
-    move-result p1
-
-    if-nez p1, :cond_1
-
-    const-string/jumbo p1, "removePolicyLocked failure"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_1
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-void
-
-    :catch_0
-    move-exception p1
-
-    invoke-virtual {p1}, Ljava/io/IOException;->printStackTrace()V
-
-    const-string p1, " removePolicyLocked  failed"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-.end method
-
-.method public static byteToHex([B)Ljava/lang/String;
-    .locals 6
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    array-length v1, p0
-
-    const/4 v2, 0x0
-
-    :goto_0
-    if-ge v2, v1, :cond_0
-
-    aget-byte v3, p0, v2
-
-    invoke-static {v3}, Ljava/lang/Byte;->valueOf(B)Ljava/lang/Byte;
-
-    move-result-object v3
-
-    filled-new-array {v3}, [Ljava/lang/Object;
-
-    move-result-object v3
-
-    const-string v4, "%02X"
-
-    const/4 v5, 0x1
-
-    invoke-static {v4, v3, v0, v2, v5}, Lcom/android/server/TelephonyRegistry$$ExternalSyntheticOutline0;->m(Ljava/lang/String;[Ljava/lang/Object;Ljava/lang/StringBuilder;II)I
-
-    move-result v2
-
-    goto :goto_0
-
-    :cond_0
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
-.method public static generateHash(Ljava/io/File;)[B
-    .locals 7
-
-    const-string/jumbo v0, "SdpServiceKeeper"
-
-    const-string/jumbo v1, "SHA-256"
-
-    const/4 v2, 0x0
-
-    :try_start_0
-    invoke-static {v1}, Ljava/security/MessageDigest;->getInstance(Ljava/lang/String;)Ljava/security/MessageDigest;
-
-    move-result-object v3
-
-    new-instance v4, Ljava/io/FileInputStream;
-
-    invoke-direct {v4, p0}, Ljava/io/FileInputStream;-><init>(Ljava/io/File;)V
-    :try_end_0
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_0 .. :try_end_0} :catch_5
-    .catch Ljava/io/FileNotFoundException; {:try_start_0 .. :try_end_0} :catch_4
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_3
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    const/16 p0, 0x400
-
-    :try_start_1
-    new-array p0, p0, [B
-
-    :goto_0
-    invoke-virtual {v4, p0}, Ljava/io/FileInputStream;->read([B)I
-
-    move-result v5
-
-    const/4 v6, -0x1
-
-    if-eq v5, v6, :cond_0
-
-    const/4 v6, 0x0
-
-    invoke-virtual {v3, p0, v6, v5}, Ljava/security/MessageDigest;->update([BII)V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    move-object v2, v4
-
-    goto :goto_5
-
-    :catch_0
-    move-exception p0
-
-    goto :goto_1
-
-    :catch_1
-    move-exception p0
-
-    goto :goto_2
-
-    :cond_0
-    invoke-virtual {v3}, Ljava/security/MessageDigest;->digest()[B
-
-    move-result-object p0
-
-    array-length v3, p0
-
-    if-lez v3, :cond_1
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;->byteToHex([B)Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-static {v0, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_1
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_1 .. :try_end_1} :catch_7
-    .catch Ljava/io/FileNotFoundException; {:try_start_1 .. :try_end_1} :catch_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :cond_1
-    :try_start_2
-    invoke-virtual {v4}, Ljava/io/FileInputStream;->close()V
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_2
-
-    return-object p0
-
-    :catch_2
-    move-exception v0
-
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
-
-    return-object p0
-
-    :catchall_1
-    move-exception p0
-
-    goto :goto_5
-
-    :catch_3
-    move-exception p0
-
-    move-object v4, v2
-
-    goto :goto_1
-
-    :catch_4
-    move-exception p0
-
-    move-object v4, v2
-
-    goto :goto_2
-
-    :catch_5
-    move-object v4, v2
-
-    goto :goto_3
-
-    :goto_1
-    :try_start_3
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    if-eqz v4, :cond_2
-
-    :try_start_4
-    invoke-virtual {v4}, Ljava/io/FileInputStream;->close()V
-    :try_end_4
-    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_6
-
-    goto :goto_4
-
-    :catch_6
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    goto :goto_4
-
-    :goto_2
-    :try_start_5
-    const-string v1, "File Not found..."
-
-    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0}, Ljava/io/FileNotFoundException;->printStackTrace()V
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_0
-
-    if-eqz v4, :cond_2
-
-    :try_start_6
-    invoke-virtual {v4}, Ljava/io/FileInputStream;->close()V
-    :try_end_6
-    .catch Ljava/lang/Exception; {:try_start_6 .. :try_end_6} :catch_6
-
-    goto :goto_4
-
-    :catch_7
-    :goto_3
-    :try_start_7
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v3, "Failed to hash : missing algorithm: "
-
-    invoke-virtual {p0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v0, p0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_7
-    .catchall {:try_start_7 .. :try_end_7} :catchall_0
-
-    if-eqz v4, :cond_2
-
-    :try_start_8
-    invoke-virtual {v4}, Ljava/io/FileInputStream;->close()V
-    :try_end_8
-    .catch Ljava/lang/Exception; {:try_start_8 .. :try_end_8} :catch_6
-
-    :cond_2
-    :goto_4
-    return-object v2
-
-    :goto_5
-    if-eqz v2, :cond_3
-
-    :try_start_9
-    invoke-virtual {v2}, Ljava/io/FileInputStream;->close()V
-    :try_end_9
-    .catch Ljava/lang/Exception; {:try_start_9 .. :try_end_9} :catch_8
-
-    goto :goto_6
-
-    :catch_8
-    move-exception v0
-
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :cond_3
-    :goto_6
-    throw p0
-.end method
-
-.method public static getPolicyXmlFile(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Ljava/io/File;
-    .locals 3
-
-    new-instance v0, Ljava/io/File;
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string v2, "/data/system/users/"
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getId()I
-
-    move-result v2
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v2, "/sdp_engine_policy_"
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string p0, ".xml"
-
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-direct {v0, p0}, Ljava/io/File;-><init>(Ljava/lang/String;)V
-
-    return-object v0
-.end method
diff --git a/smali/com/android/server/knox/dar/sdp/engine/SdpServiceKeeper.smali b/smali/com/android/server/knox/dar/sdp/engine/SdpServiceKeeper.smali
deleted file mode 100644
index 81a1c6583..000000000
--- a/smali/com/android/server/knox/dar/sdp/engine/SdpServiceKeeper.smali
+++ /dev/null
@@ -1,888 +0,0 @@
-.class public final Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# static fields
-.field public static final mWhitelist:Ljava/util/List;
-
-
-# instance fields
-.field public final mAM:Landroid/app/ActivityManager;
-
-.field public final mContext:Landroid/content/Context;
-
-.field public mPM:Landroid/content/pm/IPackageManager;
-
-.field public final mSdpPolicyDb:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;
-
-.field public final mSdpPolicyDbLock:Ljava/lang/Object;
-
-.field public final mSdpPolicyMap:Ljava/util/Map;
-
-.field public final mSdpPolicyMapLock:Ljava/lang/Object;
-
-
-# direct methods
-.method static constructor <clinit>()V
-    .locals 1
-
-    new-instance v0, Ljava/util/ArrayList;
-
-    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V
-
-    sput-object v0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mWhitelist:Ljava/util/List;
-
-    return-void
-.end method
-
-.method public constructor <init>(Lcom/android/server/knox/dar/DarManagerService$Injector;)V
-    .locals 2
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    const/4 v0, 0x0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mContext:Landroid/content/Context;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mAM:Landroid/app/ActivityManager;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mPM:Landroid/content/pm/IPackageManager;
-
-    new-instance v1, Ljava/lang/Object;
-
-    invoke-direct {v1}, Ljava/lang/Object;-><init>()V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyDbLock:Ljava/lang/Object;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyDb:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;
-
-    new-instance v0, Ljava/lang/Object;
-
-    invoke-direct {v0}, Ljava/lang/Object;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMapLock:Ljava/lang/Object;
-
-    new-instance v0, Ljava/util/HashMap;
-
-    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMap:Ljava/util/Map;
-
-    iget-object v0, p1, Lcom/android/server/knox/dar/DarManagerService$Injector;->mContext:Landroid/content/Context;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mContext:Landroid/content/Context;
-
-    new-instance v1, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;
-
-    invoke-direct {v1}, Ljava/lang/Object;-><init>()V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyDb:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;
-
-    const-string/jumbo v1, "user"
-
-    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/os/UserManager;
-
-    iget-object p1, p1, Lcom/android/server/knox/dar/DarManagerService$Injector;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v0, "activity"
-
-    invoke-virtual {p1, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Landroid/app/ActivityManager;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mAM:Landroid/app/ActivityManager;
-
-    sget-object p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mWhitelist:Ljava/util/List;
-
-    check-cast p0, Ljava/util/ArrayList;
-
-    const-string/jumbo p1, "com.samsung.android.email.provider"
-
-    invoke-virtual {p0, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    const-string/jumbo p1, "com.samsung.android.spay"
-
-    invoke-virtual {p0, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    const-string/jumbo p1, "com.sec.android.app.sbrowser"
-
-    invoke-virtual {p0, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final addPolicy(ILcom/samsung/android/knox/sdp/core/SdpEngineInfo;Ljava/util/List;)I
-    .locals 4
-
-    const-string/jumbo v0, "addPolicy :: error, policy["
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMapLock:Ljava/lang/Object;
-
-    monitor-enter v1
-
-    :try_start_0
-    iget-object v2, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMap:Ljava/util/Map;
-
-    invoke-virtual {p2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v3
-
-    check-cast v2, Ljava/util/HashMap;
-
-    invoke-virtual {v2, v3}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_0
-
-    const-string/jumbo p0, "SdpServiceKeeper"
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string/jumbo p2, "] already exists!"
-
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, -0x4
-
-    monitor-exit v1
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-virtual {p2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isAndroidDefaultEngine()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->isSystemServer(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_1
-
-    const/4 p0, -0x7
-
-    return p0
-
-    :cond_1
-    invoke-virtual {p2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p1
-
-    new-instance v0, Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    const-string/jumbo v1, "system_server"
-
-    invoke-direct {v0, p1, v1}, Lcom/samsung/android/knox/sdp/core/SdpDomain;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_0
-
-    :cond_2
-    invoke-virtual {p2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isCustomEngine()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_4
-
-    new-instance v0, Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    invoke-virtual {p2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-virtual {p2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getPackageName()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-direct {v0, p1, v1}, Lcom/samsung/android/knox/sdp/core/SdpDomain;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    :goto_0
-    new-instance p1, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;
-
-    invoke-direct {p1, p2, v0, p3}, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;-><init>(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;Lcom/samsung/android/knox/sdp/core/SdpDomain;Ljava/util/List;)V
-
-    iget-object p3, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyDbLock:Ljava/lang/Object;
-
-    monitor-enter p3
-
-    :try_start_1
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyDb:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;
-
-    invoke-static {v0, p2, p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;->-$$Nest$mputPolicyLocked(Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;)I
-
-    move-result v0
-
-    monitor-exit p3
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_2
-
-    if-nez v0, :cond_3
-
-    iget-object p3, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMapLock:Ljava/lang/Object;
-
-    monitor-enter p3
-
-    :try_start_2
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMap:Ljava/util/Map;
-
-    invoke-virtual {p2}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p2
-
-    check-cast p0, Ljava/util/HashMap;
-
-    invoke-virtual {p0, p2, p1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    monitor-exit p3
-
-    return v0
-
-    :catchall_1
-    move-exception p0
-
-    monitor-exit p3
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    throw p0
-
-    :cond_3
-    return v0
-
-    :catchall_2
-    move-exception p0
-
-    :try_start_3
-    monitor-exit p3
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_2
-
-    throw p0
-
-    :cond_4
-    const/16 p0, -0x63
-
-    return p0
-
-    :goto_1
-    :try_start_4
-    monitor-exit v1
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    throw p0
-.end method
-
-.method public final getPackageName(I)Ljava/lang/String;
-    .locals 4
-
-    const-string/jumbo v0, "getPackageName exception: "
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v1
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v3, "activity"
-
-    invoke-virtual {p0, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/app/ActivityManager;
-
-    invoke-virtual {p0, p1}, Landroid/app/ActivityManager;->getPackageFromAppProcesses(I)Ljava/lang/String;
-
-    move-result-object p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-object p0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    :try_start_1
-    const-string/jumbo p1, "SdpServiceKeeper"
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v3, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    const/4 p0, 0x0
-
-    return-object p0
-
-    :goto_0
-    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
-.method public final getSdpPolicyLocked(Ljava/lang/String;)Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;
-    .locals 1
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMap:Ljava/util/Map;
-
-    check-cast v0, Ljava/util/HashMap;
-
-    invoke-virtual {v0, p1}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMap:Ljava/util/Map;
-
-    check-cast p0, Ljava/util/HashMap;
-
-    invoke-virtual {p0, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;
-
-    return-object p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
-
-.method public final isEngineOwner(IILcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Z
-    .locals 2
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->getPackageName(I)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->isSystemServer(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_4
-
-    invoke-static {p2}, Landroid/os/UserHandle;->getUserId(I)I
-
-    move-result p1
-
-    invoke-virtual {p0, p1, v0}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->isSystemApp(ILjava/lang/String;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    goto :goto_1
-
-    :cond_0
-    invoke-virtual {p3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isAndroidDefaultEngine()Z
-
-    move-result p1
-
-    const/4 p2, 0x0
-
-    if-eqz p1, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    invoke-virtual {p3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->isCustomEngine()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_3
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMapLock:Ljava/lang/Object;
-
-    monitor-enter p1
-
-    :try_start_0
-    invoke-virtual {p3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-virtual {p0, v1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->getSdpPolicyLocked(Ljava/lang/String;)Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;
-
-    move-result-object p0
-
-    monitor-exit p1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-nez p0, :cond_2
-
-    const-string/jumbo p0, "SdpServiceKeeper"
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "can\'t find policy for "
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p3}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p3
-
-    invoke-virtual {p1, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    return p2
-
-    :cond_2
-    :try_start_1
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->getOwner()Lcom/samsung/android/knox/sdp/core/SdpDomain;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Lcom/samsung/android/knox/sdp/core/SdpDomain;->getPackageName()Ljava/lang/String;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_3
-
-    if-eqz v0, :cond_3
-
-    invoke-virtual {v0, p0}, Ljava/lang/String;->matches(Ljava/lang/String;)Z
-
-    move-result p0
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-
-    if-eqz p0, :cond_3
-
-    goto :goto_1
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_2
-    monitor-exit p1
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :cond_3
-    :goto_0
-    return p2
-
-    :cond_4
-    :goto_1
-    const/4 p0, 0x1
-
-    return p0
-.end method
-
-.method public final isSystemApp(ILjava/lang/String;)Z
-    .locals 4
-
-    const/4 v0, 0x0
-
-    if-nez p2, :cond_0
-
-    goto :goto_2
-
-    :cond_0
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mPM:Landroid/content/pm/IPackageManager;
-
-    if-eqz v1, :cond_3
-
-    if-eqz v1, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
-
-    move-result-object v1
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mPM:Landroid/content/pm/IPackageManager;
-
-    :goto_0
-    const-wide/16 v2, 0x40
-
-    invoke-interface {v1, p2, v2, v3, p1}, Landroid/content/pm/IPackageManager;->getPackageInfo(Ljava/lang/String;JI)Landroid/content/pm/PackageInfo;
-
-    move-result-object p2
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mPM:Landroid/content/pm/IPackageManager;
-
-    if-eqz v1, :cond_2
-
-    goto :goto_1
-
-    :cond_2
-    invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
-
-    move-result-object v1
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mPM:Landroid/content/pm/IPackageManager;
-
-    :goto_1
-    const-string/jumbo p0, "android"
-
-    invoke-interface {v1, p0, v2, v3, p1}, Landroid/content/pm/IPackageManager;->getPackageInfo(Ljava/lang/String;JI)Landroid/content/pm/PackageInfo;
-
-    move-result-object p0
-
-    if-eqz p2, :cond_3
-
-    iget-object p1, p2, Landroid/content/pm/PackageInfo;->signatures:[Landroid/content/pm/Signature;
-
-    if-eqz p1, :cond_3
-
-    if-eqz p0, :cond_3
-
-    iget-object p0, p0, Landroid/content/pm/PackageInfo;->signatures:[Landroid/content/pm/Signature;
-
-    aget-object p0, p0, v0
-
-    aget-object p1, p1, v0
-
-    invoke-virtual {p0, p1}, Landroid/content/pm/Signature;->equals(Ljava/lang/Object;)Z
-
-    move-result p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz p0, :cond_3
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :cond_3
-    :goto_2
-    return v0
-.end method
-
-.method public final isSystemServer(I)Z
-    .locals 2
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mAM:Landroid/app/ActivityManager;
-
-    invoke-virtual {p0}, Landroid/app/ActivityManager;->getRunningAppProcesses()Ljava/util/List;
-
-    move-result-object p0
-
-    if-nez p0, :cond_0
-
-    sget-object p0, Ljava/util/Collections;->EMPTY_LIST:Ljava/util/List;
-
-    :cond_0
-    invoke-interface {p0}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object p0
-
-    :cond_1
-    invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/app/ActivityManager$RunningAppProcessInfo;
-
-    iget v1, v0, Landroid/app/ActivityManager$RunningAppProcessInfo;->pid:I
-
-    if-ne v1, p1, :cond_1
-
-    iget-object p0, v0, Landroid/app/ActivityManager$RunningAppProcessInfo;->processName:Ljava/lang/String;
-
-    if-eqz p0, :cond_2
-
-    const-string/jumbo p1, "system"
-
-    invoke-virtual {p0, p1}, Ljava/lang/String;->matches(Ljava/lang/String;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_2
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_2
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final loadPolicy(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-    .locals 4
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyDb:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;
-
-    invoke-static {v1, p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;->-$$Nest$mgetPolicyLocked(Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;
-
-    move-result-object v1
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    if-eqz v1, :cond_0
-
-    const-string/jumbo v0, "SdpServiceKeeper"
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "loadPolicy :: "
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1}, Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v0, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMapLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMap:Ljava/util/Map;
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p1
-
-    check-cast p0, Ljava/util/HashMap;
-
-    invoke-virtual {p0, p1, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_0
-    return-void
-
-    :catchall_1
-    move-exception p0
-
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    throw p0
-.end method
-
-.method public final removePolicy(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyDb:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;
-
-    invoke-static {v1, p1}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;->-$$Nest$mremovePolicyLocked(Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;)V
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMapLock:Ljava/lang/Object;
-
-    monitor-enter v1
-
-    :try_start_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMap:Ljava/util/Map;
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p1
-
-    check-cast p0, Ljava/util/HashMap;
-
-    invoke-virtual {p0, p1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
-
-    monitor-exit v1
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :catchall_1
-    move-exception p0
-
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    throw p0
-.end method
-
-.method public final updatePolicy(Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;)I
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyDbLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyDb:Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;
-
-    invoke-static {v1, p1, p2}, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;->-$$Nest$mputPolicyLocked(Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper$SdpPolicyDatabase;Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;Lcom/android/server/knox/dar/sdp/engine/SdpPolicy;)I
-
-    move-result v1
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    if-nez v1, :cond_0
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMapLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_1
-    iget-object p0, p0, Lcom/android/server/knox/dar/sdp/engine/SdpServiceKeeper;->mSdpPolicyMap:Ljava/util/Map;
-
-    invoke-virtual {p1}, Lcom/samsung/android/knox/sdp/core/SdpEngineInfo;->getAlias()Ljava/lang/String;
-
-    move-result-object p1
-
-    check-cast p0, Ljava/util/HashMap;
-
-    invoke-virtual {p0, p1, p2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    monitor-exit v0
-
-    return v1
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_0
-    return v1
-
-    :catchall_1
-    move-exception p0
-
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    throw p0
-.end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12.smali
index 25ac00f50..6d749b36a 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12.smali
@@ -304,17 +304,6 @@
     return-void
 
     :pswitch_0
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    const/4 v0, 0x4
-
-    invoke-virtual {p1, p0, v0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->unlockSdpIfUnsecuredOrBiometricAuthenticated(II)V
-
-    return-void
-
-    :pswitch_1
     check-cast p1, Lcom/android/server/pm/PersonaManagerService;
 
     sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
@@ -360,11 +349,8 @@
     :cond_5
     return-void
 
-    nop
-
     :pswitch_data_0
     .packed-switch 0x0
-        :pswitch_1
         :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13.smali
index eccf3f897..ec7c7024c 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13.smali
@@ -7,20 +7,28 @@
 
 
 # instance fields
-.field public final synthetic $r8$classId:I
-
 .field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
 
+.field public final synthetic f$1:Landroid/content/Intent;
+
+.field public final synthetic f$2:Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;
+
+.field public final synthetic f$3:I
+
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;Landroid/content/Intent;Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;I)V
     .locals 0
 
-    iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->$r8$classId:I
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
     iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+    iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$1:Landroid/content/Intent;
+
+    iput-object p3, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$2:Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;
+
+    iput p4, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$3:I
 
     return-void
 .end method
@@ -28,505 +36,29 @@
 
 # virtual methods
 .method public final run()V
-    .locals 13
-
-    const/4 v0, 0x0
-
-    const/4 v1, 0x1
-
-    iget v2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->$r8$classId:I
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    packed-switch v2, :pswitch_data_0
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
-
-    invoke-virtual {v2}, Ljava/util/ArrayList;->isEmpty()Z
-
-    move-result v2
-
-    if-nez v2, :cond_1
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v2
-
-    :try_start_0
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
-
-    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I
-
-    move-result v4
-
-    move v5, v0
-
-    :goto_0
-    if-ge v5, v4, :cond_0
-
-    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v6
-
-    add-int/2addr v5, v1
-
-    check-cast v6, Landroid/util/Pair;
-
-    iget-object v7, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    iget-object v8, v6, Landroid/util/Pair;->first:Ljava/lang/Object;
-
-    check-cast v8, Ljava/lang/Long;
-
-    invoke-virtual {v8}, Ljava/lang/Long;->longValue()J
-
-    move-result-wide v8
-
-    iget-object v6, v6, Landroid/util/Pair;->second:Ljava/lang/Object;
-
-    check-cast v6, Ljava/lang/Integer;
-
-    invoke-virtual {v6}, Ljava/lang/Integer;->intValue()I
-
-    move-result v6
-
-    invoke-virtual {v7, v6, v8, v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyLskfBasedProtector(IJ)V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    goto :goto_1
-
-    :cond_0
-    monitor-exit v2
-
-    goto :goto_2
-
-    :goto_1
-    monitor-exit v2
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-
-    :cond_1
-    :goto_2
-    const/4 v2, 0x0
-
-    iput-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mRebootEscrowManager:Lcom/android/server/locksettings/RebootEscrowManager;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
-
-    iget-object v3, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mUserManager:Landroid/os/UserManager;
-
-    invoke-virtual {v3}, Landroid/os/UserManager;->getUsers()Ljava/util/List;
-
-    move-result-object v3
-
-    iget-object v4, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mCallbacks:Lcom/android/server/locksettings/RebootEscrowManager$Callbacks;
-
-    check-cast v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    sget-boolean v5, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    iget-object v5, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v5, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v5, v0}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
-
-    move-result v5
-
-    const-string/jumbo v6, "RebootEscrowManager"
-
-    iget-object v7, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mInjector:Lcom/android/server/locksettings/RebootEscrowManager$Injector;
-
-    iget-object v8, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
-
-    if-eqz v5, :cond_2
-
-    invoke-virtual {v8, v0}, Lcom/android/server/locksettings/LockSettingsStorage;->getRebootEscrowFile(I)Ljava/io/File;
-
-    move-result-object v5
-
-    invoke-virtual {v8, v5}, Lcom/android/server/locksettings/LockSettingsStorage;->hasFile(Ljava/io/File;)Z
-
-    move-result v5
-
-    if-nez v5, :cond_2
-
-    const-string/jumbo v4, "No reboot escrow data found for system user"
-
-    invoke-static {v6, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    sget-object v4, Ljava/util/Collections;->EMPTY_LIST:Ljava/util/List;
-
-    goto/16 :goto_5
-
-    :cond_2
-    new-instance v5, Ljava/util/HashSet;
-
-    invoke-direct {v5}, Ljava/util/HashSet;-><init>()V
-
-    invoke-interface {v3}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v9
-
-    :cond_3
-    :goto_3
-    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v10
-
-    if-eqz v10, :cond_4
-
-    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v10
-
-    check-cast v10, Landroid/content/pm/UserInfo;
-
-    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
-
-    sget-boolean v12, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    iget-object v12, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v12, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v12, v11}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
-
-    move-result v11
-
-    if-eqz v11, :cond_3
-
-    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-virtual {v8, v11}, Lcom/android/server/locksettings/LockSettingsStorage;->getRebootEscrowFile(I)Ljava/io/File;
-
-    move-result-object v11
-
-    invoke-virtual {v8, v11}, Lcom/android/server/locksettings/LockSettingsStorage;->hasFile(Ljava/io/File;)Z
-
-    move-result v11
-
-    if-nez v11, :cond_3
-
-    new-instance v11, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v12, "No reboot escrow data found for user "
-
-    invoke-direct {v11, v12}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v11, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v11
-
-    invoke-static {v6, v11}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget v10, v10, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v10
-
-    invoke-virtual {v5, v10}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z
-
-    goto :goto_3
-
-    :cond_4
-    new-instance v8, Ljava/util/ArrayList;
-
-    invoke-direct {v8}, Ljava/util/ArrayList;-><init>()V
-
-    invoke-interface {v3}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v9
-
-    :cond_5
-    :goto_4
-    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v10
+    .locals 5
 
-    if-eqz v10, :cond_8
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$1:Landroid/content/Intent;
 
-    move-result-object v10
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$2:Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;
 
-    check-cast v10, Landroid/content/pm/UserInfo;
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$3:I
 
-    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
+    iget-object v3, v0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
-    sget-boolean v12, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+    const/4 v4, 0x1
 
-    iget-object v12, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    invoke-static {p0}, Landroid/os/UserHandle;->of(I)Landroid/os/UserHandle;
 
-    check-cast v12, Lcom/android/server/locksettings/LockSettingsService;
+    move-result-object p0
 
-    invoke-virtual {v12, v11}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
+    invoke-virtual {v3, v1, v2, v4, p0}, Landroid/content/Context;->bindServiceAsUser(Landroid/content/Intent;Landroid/content/ServiceConnection;ILandroid/os/UserHandle;)Z
 
-    move-result v11
+    move-result p0
 
-    if-nez v11, :cond_6
+    iput-boolean p0, v0, Lcom/android/server/locksettings/LockSettingsService;->mShouldUnbind:Z
 
-    goto :goto_4
-
-    :cond_6
-    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v12
-
-    invoke-virtual {v5, v12}, Ljava/util/HashSet;->contains(Ljava/lang/Object;)Z
-
-    move-result v12
-
-    if-nez v12, :cond_5
-
-    iget-object v12, v7, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->mUserManagerInternal:Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-virtual {v12, v11}, Lcom/android/server/pm/UserManagerInternal;->getProfileParentId(I)I
-
-    move-result v11
-
-    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v11
-
-    invoke-virtual {v5, v11}, Ljava/util/HashSet;->contains(Ljava/lang/Object;)Z
-
-    move-result v11
-
-    if-eqz v11, :cond_7
-
-    goto :goto_4
-
-    :cond_7
-    invoke-virtual {v8, v10}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
-
-    goto :goto_4
-
-    :cond_8
-    move-object v4, v8
-
-    :goto_5
-    invoke-interface {v4}, Ljava/util/List;->isEmpty()Z
-
-    move-result v5
-
-    if-eqz v5, :cond_9
-
-    const-string/jumbo p0, "No reboot escrow data found for users, skipping loading escrow data"
-
-    invoke-static {v6, p0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v2}, Lcom/android/server/locksettings/RebootEscrowManager;->clearMetricsStorage()V
-
-    goto :goto_6
-
-    :cond_9
-    iget-object v5, v7, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->mContext:Landroid/content/Context;
-
-    const-class v8, Landroid/os/PowerManager;
-
-    invoke-virtual {v5, v8}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v5
-
-    check-cast v5, Landroid/os/PowerManager;
-
-    invoke-virtual {v5, v1, v6}, Landroid/os/PowerManager;->newWakeLock(ILjava/lang/String;)Landroid/os/PowerManager$WakeLock;
-
-    move-result-object v1
-
-    iput-object v1, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mWakeLock:Landroid/os/PowerManager$WakeLock;
-
-    if-eqz v1, :cond_a
-
-    invoke-virtual {v1, v0}, Landroid/os/PowerManager$WakeLock;->setReferenceCounted(Z)V
-
-    iget-object v0, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mWakeLock:Landroid/os/PowerManager$WakeLock;
-
-    invoke-virtual {v7}, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->getWakeLockTimeoutMillis()I
-
-    move-result v1
-
-    int-to-long v5, v1
-
-    invoke-virtual {v0, v5, v6}, Landroid/os/PowerManager$WakeLock;->acquire(J)V
-
-    :cond_a
-    new-instance v0, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda1;
-
-    invoke-direct {v0, v2}, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/locksettings/RebootEscrowManager;)V
-
-    invoke-virtual {v7}, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->getLoadEscrowTimeoutMillis()I
-
-    move-result v1
-
-    int-to-long v5, v1
-
-    invoke-virtual {p0, v0, v5, v6}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
-
-    new-instance v0, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda2;
-
-    invoke-direct {v0, v2, p0, v3, v4}, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/locksettings/RebootEscrowManager;Landroid/os/Handler;Ljava/util/List;Ljava/util/List;)V
-
-    invoke-virtual {p0, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
-
-    :goto_6
     return-void
-
-    :pswitch_0
-    sget-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    invoke-static {v0}, Lcom/samsung/android/lock/LsLog;->getFailureCount(I)I
-
-    move-result v2
-
-    add-int/2addr v2, v1
-
-    sget v1, Lcom/samsung/android/lock/LsConstants;->SECURITY_DEBUG_ON_COUNT:I
-
-    if-lt v2, v1, :cond_d
-
-    const-string/jumbo v1, "LockSettingsService"
-
-    const-string v3, "!@ DoVerifySI called. failedCount = "
-
-    invoke-static {v2, v3, v1}, Lcom/android/server/AnyMotionDetector$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService;->getSICheckerId(I)J
-
-    move-result-wide v3
-
-    const-string/jumbo v1, "locksettings_si_protector_id"
-
-    const-wide/16 v5, 0x0
-
-    invoke-virtual {p0, v1, v5, v6, v0}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
-
-    move-result-wide v5
-
-    invoke-virtual {p0, v5, v6}, Lcom/android/server/locksettings/LockSettingsService;->hasSecurityIntegrity(J)B
-
-    move-result v1
-
-    const/4 v2, 0x3
-
-    if-eq v1, v2, :cond_b
-
-    const-string/jumbo p0, "[SI Checker] NO Security integrity key...."
-
-    invoke-static {p0}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
-
-    goto :goto_7
-
-    :cond_b
-    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
-
-    move-result-wide v1
-
-    cmp-long v7, v5, v1
-
-    if-eqz v7, :cond_c
-
-    const-string/jumbo v7, "[SI Checker]: Protector Mismatch! SICheckerID=%016x, SIProtectorID=%016x, ProtectorID=%016x"
-
-    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v8
-
-    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v9
-
-    invoke-static {v1, v2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v1
-
-    filled-new-array {v8, v9, v1}, [Ljava/lang/Object;
-
-    move-result-object v1
-
-    invoke-static {v7, v1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
-
-    :cond_c
-    invoke-static {}, Landroid/os/Process;->myPid()I
-
-    move-result v1
-
-    const-string/jumbo v2, "SI:%016x"
-
-    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v7
-
-    filled-new-array {v7}, [Ljava/lang/Object;
-
-    move-result-object v7
-
-    invoke-static {v2, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v0, v1, v2}, Lcom/samsung/android/lock/LsLog;->verifyRequest(IILjava/lang/String;)V
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v1
-
-    :try_start_1
-    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v7
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->checkSecurityIntegrity(JJLcom/android/internal/widget/LockscreenCredential;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
-
-    invoke-virtual {v7}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-
-    monitor-exit v1
-
-    goto :goto_7
-
-    :catchall_1
-    move-exception v0
-
-    move-object p0, v0
-
-    monitor-exit v1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    throw p0
-
-    :cond_d
-    :goto_7
-    return-void
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14.smali
new file mode 100644
index 000000000..b6b40dd70
--- /dev/null
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14.smali
@@ -0,0 +1,532 @@
+.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
+.super Ljava/lang/Object;
+.source "SourceFile"
+
+# interfaces
+.implements Ljava/lang/Runnable;
+
+
+# instance fields
+.field public final synthetic $r8$classId:I
+
+.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
+
+
+# direct methods
+.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+    .locals 0
+
+    iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;->$r8$classId:I
+
+    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+
+    return-void
+.end method
+
+
+# virtual methods
+.method public final run()V
+    .locals 13
+
+    const/4 v0, 0x0
+
+    const/4 v1, 0x1
+
+    iget v2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;->$r8$classId:I
+
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+
+    packed-switch v2, :pswitch_data_0
+
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
+
+    invoke-virtual {v2}, Ljava/util/ArrayList;->isEmpty()Z
+
+    move-result v2
+
+    if-nez v2, :cond_1
+
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+
+    monitor-enter v2
+
+    :try_start_0
+    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
+
+    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I
+
+    move-result v4
+
+    move v5, v0
+
+    :goto_0
+    if-ge v5, v4, :cond_0
+
+    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+
+    move-result-object v6
+
+    add-int/2addr v5, v1
+
+    check-cast v6, Landroid/util/Pair;
+
+    iget-object v7, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+
+    iget-object v8, v6, Landroid/util/Pair;->first:Ljava/lang/Object;
+
+    check-cast v8, Ljava/lang/Long;
+
+    invoke-virtual {v8}, Ljava/lang/Long;->longValue()J
+
+    move-result-wide v8
+
+    iget-object v6, v6, Landroid/util/Pair;->second:Ljava/lang/Object;
+
+    check-cast v6, Ljava/lang/Integer;
+
+    invoke-virtual {v6}, Ljava/lang/Integer;->intValue()I
+
+    move-result v6
+
+    invoke-virtual {v7, v6, v8, v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyLskfBasedProtector(IJ)V
+
+    goto :goto_0
+
+    :catchall_0
+    move-exception v0
+
+    move-object p0, v0
+
+    goto :goto_1
+
+    :cond_0
+    monitor-exit v2
+
+    goto :goto_2
+
+    :goto_1
+    monitor-exit v2
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+
+    throw p0
+
+    :cond_1
+    :goto_2
+    const/4 v2, 0x0
+
+    iput-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mProtectorsToDestroyOnBootCompleted:Ljava/util/ArrayList;
+
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mRebootEscrowManager:Lcom/android/server/locksettings/RebootEscrowManager;
+
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
+
+    iget-object v3, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mUserManager:Landroid/os/UserManager;
+
+    invoke-virtual {v3}, Landroid/os/UserManager;->getUsers()Ljava/util/List;
+
+    move-result-object v3
+
+    iget-object v4, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mCallbacks:Lcom/android/server/locksettings/RebootEscrowManager$Callbacks;
+
+    check-cast v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+
+    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    sget-boolean v5, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+
+    iget-object v5, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    check-cast v5, Lcom/android/server/locksettings/LockSettingsService;
+
+    invoke-virtual {v5, v0}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
+
+    move-result v5
+
+    const-string/jumbo v6, "RebootEscrowManager"
+
+    iget-object v7, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mInjector:Lcom/android/server/locksettings/RebootEscrowManager$Injector;
+
+    iget-object v8, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+
+    if-eqz v5, :cond_2
+
+    invoke-virtual {v8, v0}, Lcom/android/server/locksettings/LockSettingsStorage;->getRebootEscrowFile(I)Ljava/io/File;
+
+    move-result-object v5
+
+    invoke-virtual {v8, v5}, Lcom/android/server/locksettings/LockSettingsStorage;->hasFile(Ljava/io/File;)Z
+
+    move-result v5
+
+    if-nez v5, :cond_2
+
+    const-string/jumbo v4, "No reboot escrow data found for system user"
+
+    invoke-static {v6, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+
+    sget-object v4, Ljava/util/Collections;->EMPTY_LIST:Ljava/util/List;
+
+    goto/16 :goto_5
+
+    :cond_2
+    new-instance v5, Ljava/util/HashSet;
+
+    invoke-direct {v5}, Ljava/util/HashSet;-><init>()V
+
+    invoke-interface {v3}, Ljava/util/List;->iterator()Ljava/util/Iterator;
+
+    move-result-object v9
+
+    :cond_3
+    :goto_3
+    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z
+
+    move-result v10
+
+    if-eqz v10, :cond_4
+
+    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+
+    move-result-object v10
+
+    check-cast v10, Landroid/content/pm/UserInfo;
+
+    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
+
+    sget-boolean v12, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+
+    iget-object v12, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    check-cast v12, Lcom/android/server/locksettings/LockSettingsService;
+
+    invoke-virtual {v12, v11}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
+
+    move-result v11
+
+    if-eqz v11, :cond_3
+
+    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
+
+    invoke-virtual {v8, v11}, Lcom/android/server/locksettings/LockSettingsStorage;->getRebootEscrowFile(I)Ljava/io/File;
+
+    move-result-object v11
+
+    invoke-virtual {v8, v11}, Lcom/android/server/locksettings/LockSettingsStorage;->hasFile(Ljava/io/File;)Z
+
+    move-result v11
+
+    if-nez v11, :cond_3
+
+    new-instance v11, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v12, "No reboot escrow data found for user "
+
+    invoke-direct {v11, v12}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v11, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v11
+
+    invoke-static {v6, v11}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    iget v10, v10, Landroid/content/pm/UserInfo;->id:I
+
+    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+
+    move-result-object v10
+
+    invoke-virtual {v5, v10}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z
+
+    goto :goto_3
+
+    :cond_4
+    new-instance v8, Ljava/util/ArrayList;
+
+    invoke-direct {v8}, Ljava/util/ArrayList;-><init>()V
+
+    invoke-interface {v3}, Ljava/util/List;->iterator()Ljava/util/Iterator;
+
+    move-result-object v9
+
+    :cond_5
+    :goto_4
+    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z
+
+    move-result v10
+
+    if-eqz v10, :cond_8
+
+    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+
+    move-result-object v10
+
+    check-cast v10, Landroid/content/pm/UserInfo;
+
+    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
+
+    sget-boolean v12, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+
+    iget-object v12, v4, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+
+    check-cast v12, Lcom/android/server/locksettings/LockSettingsService;
+
+    invoke-virtual {v12, v11}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
+
+    move-result v11
+
+    if-nez v11, :cond_6
+
+    goto :goto_4
+
+    :cond_6
+    iget v11, v10, Landroid/content/pm/UserInfo;->id:I
+
+    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+
+    move-result-object v12
+
+    invoke-virtual {v5, v12}, Ljava/util/HashSet;->contains(Ljava/lang/Object;)Z
+
+    move-result v12
+
+    if-nez v12, :cond_5
+
+    iget-object v12, v7, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->mUserManagerInternal:Lcom/android/server/pm/UserManagerInternal;
+
+    invoke-virtual {v12, v11}, Lcom/android/server/pm/UserManagerInternal;->getProfileParentId(I)I
+
+    move-result v11
+
+    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+
+    move-result-object v11
+
+    invoke-virtual {v5, v11}, Ljava/util/HashSet;->contains(Ljava/lang/Object;)Z
+
+    move-result v11
+
+    if-eqz v11, :cond_7
+
+    goto :goto_4
+
+    :cond_7
+    invoke-virtual {v8, v10}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
+
+    goto :goto_4
+
+    :cond_8
+    move-object v4, v8
+
+    :goto_5
+    invoke-interface {v4}, Ljava/util/List;->isEmpty()Z
+
+    move-result v5
+
+    if-eqz v5, :cond_9
+
+    const-string/jumbo p0, "No reboot escrow data found for users, skipping loading escrow data"
+
+    invoke-static {v6, p0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual {v2}, Lcom/android/server/locksettings/RebootEscrowManager;->clearMetricsStorage()V
+
+    goto :goto_6
+
+    :cond_9
+    iget-object v5, v7, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->mContext:Landroid/content/Context;
+
+    const-class v8, Landroid/os/PowerManager;
+
+    invoke-virtual {v5, v8}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object v5
+
+    check-cast v5, Landroid/os/PowerManager;
+
+    invoke-virtual {v5, v1, v6}, Landroid/os/PowerManager;->newWakeLock(ILjava/lang/String;)Landroid/os/PowerManager$WakeLock;
+
+    move-result-object v1
+
+    iput-object v1, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mWakeLock:Landroid/os/PowerManager$WakeLock;
+
+    if-eqz v1, :cond_a
+
+    invoke-virtual {v1, v0}, Landroid/os/PowerManager$WakeLock;->setReferenceCounted(Z)V
+
+    iget-object v0, v2, Lcom/android/server/locksettings/RebootEscrowManager;->mWakeLock:Landroid/os/PowerManager$WakeLock;
+
+    invoke-virtual {v7}, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->getWakeLockTimeoutMillis()I
+
+    move-result v1
+
+    int-to-long v5, v1
+
+    invoke-virtual {v0, v5, v6}, Landroid/os/PowerManager$WakeLock;->acquire(J)V
+
+    :cond_a
+    new-instance v0, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda1;
+
+    invoke-direct {v0, v2}, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/locksettings/RebootEscrowManager;)V
+
+    invoke-virtual {v7}, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->getLoadEscrowTimeoutMillis()I
+
+    move-result v1
+
+    int-to-long v5, v1
+
+    invoke-virtual {p0, v0, v5, v6}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
+
+    new-instance v0, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda2;
+
+    invoke-direct {v0, v2, p0, v3, v4}, Lcom/android/server/locksettings/RebootEscrowManager$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/locksettings/RebootEscrowManager;Landroid/os/Handler;Ljava/util/List;Ljava/util/List;)V
+
+    invoke-virtual {p0, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+
+    :goto_6
+    return-void
+
+    :pswitch_0
+    sget-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+
+    invoke-static {v0}, Lcom/samsung/android/lock/LsLog;->getFailureCount(I)I
+
+    move-result v2
+
+    add-int/2addr v2, v1
+
+    sget v1, Lcom/samsung/android/lock/LsConstants;->SECURITY_DEBUG_ON_COUNT:I
+
+    if-lt v2, v1, :cond_d
+
+    const-string/jumbo v1, "LockSettingsService"
+
+    const-string v3, "!@ DoVerifySI called. failedCount = "
+
+    invoke-static {v2, v3, v1}, Lcom/android/server/AnyMotionDetector$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+
+    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
+
+    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService;->getSICheckerId(I)J
+
+    move-result-wide v3
+
+    const-string/jumbo v1, "locksettings_si_protector_id"
+
+    const-wide/16 v5, 0x0
+
+    invoke-virtual {p0, v1, v5, v6, v0}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+
+    move-result-wide v5
+
+    invoke-virtual {p0, v5, v6}, Lcom/android/server/locksettings/LockSettingsService;->hasSecurityIntegrity(J)B
+
+    move-result v1
+
+    const/4 v2, 0x3
+
+    if-eq v1, v2, :cond_b
+
+    const-string/jumbo p0, "[SI Checker] NO Security integrity key...."
+
+    invoke-static {p0}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
+
+    goto :goto_7
+
+    :cond_b
+    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
+
+    move-result-wide v1
+
+    cmp-long v7, v5, v1
+
+    if-eqz v7, :cond_c
+
+    const-string/jumbo v7, "[SI Checker]: Protector Mismatch! SICheckerID=%016x, SIProtectorID=%016x, ProtectorID=%016x"
+
+    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+
+    move-result-object v8
+
+    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+
+    move-result-object v9
+
+    invoke-static {v1, v2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+
+    move-result-object v1
+
+    filled-new-array {v8, v9, v1}, [Ljava/lang/Object;
+
+    move-result-object v1
+
+    invoke-static {v7, v1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+
+    move-result-object v1
+
+    invoke-static {v1}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
+
+    :cond_c
+    invoke-static {}, Landroid/os/Process;->myPid()I
+
+    move-result v1
+
+    const-string/jumbo v2, "SI:%016x"
+
+    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+
+    move-result-object v7
+
+    filled-new-array {v7}, [Ljava/lang/Object;
+
+    move-result-object v7
+
+    invoke-static {v2, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+
+    move-result-object v2
+
+    invoke-static {v0, v1, v2}, Lcom/samsung/android/lock/LsLog;->verifyRequest(IILjava/lang/String;)V
+
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+
+    monitor-enter v1
+
+    :try_start_1
+    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
+
+    move-result-object v7
+
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+
+    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->checkSecurityIntegrity(JJLcom/android/internal/widget/LockscreenCredential;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+
+    invoke-virtual {v7}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
+
+    monitor-exit v1
+
+    goto :goto_7
+
+    :catchall_1
+    move-exception v0
+
+    move-object p0, v0
+
+    monitor-exit v1
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_1
+
+    throw p0
+
+    :cond_d
+    :goto_7
+    return-void
+
+    :pswitch_data_0
+    .packed-switch 0x0
+        :pswitch_0
+    .end packed-switch
+.end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20.smali
deleted file mode 100644
index c949a46b9..000000000
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20.smali
+++ /dev/null
@@ -1,64 +0,0 @@
-.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/lang/Runnable;
-
-
-# instance fields
-.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-.field public final synthetic f$1:Landroid/content/Intent;
-
-.field public final synthetic f$2:Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;
-
-.field public final synthetic f$3:I
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;Landroid/content/Intent;Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;I)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;->f$1:Landroid/content/Intent;
-
-    iput-object p3, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;->f$2:Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;
-
-    iput p4, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;->f$3:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final run()V
-    .locals 5
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;->f$1:Landroid/content/Intent;
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;->f$2:Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;
-
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;->f$3:I
-
-    iget-object v3, v0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    const/4 v4, 0x1
-
-    invoke-static {p0}, Landroid/os/UserHandle;->of(I)Landroid/os/UserHandle;
-
-    move-result-object p0
-
-    invoke-virtual {v3, v1, v2, v4, p0}, Landroid/content/Context;->bindServiceAsUser(Landroid/content/Intent;Landroid/content/ServiceConnection;ILandroid/os/UserHandle;)Z
-
-    move-result p0
-
-    iput-boolean p0, v0, Lcom/android/server/locksettings/LockSettingsService;->mShouldUnbind:Z
-
-    return-void
-.end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21.smali
index 98be0d51d..f8ca6d2db 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21.smali
@@ -28,11 +28,20 @@
 
     iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;->$r8$classId:I
 
-    check-cast p1, Lcom/android/server/knox/dar/DarManagerService;
+    packed-switch p0, :pswitch_data_0
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    packed-switch p0, :pswitch_data_0
+    new-instance p0, Ljava/lang/ClassCastException;
+
+    invoke-direct {p0}, Ljava/lang/ClassCastException;-><init>()V
+
+    throw p0
+
+    :pswitch_0
+    check-cast p1, Lcom/android/server/knox/dar/DarManagerService;
+
+    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     :try_start_0
     invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
@@ -55,13 +64,18 @@
     invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
 
     :goto_0
-    :pswitch_0
     return-void
 
-    nop
+    :pswitch_1
+    check-cast p1, Lcom/android/server/knox/dar/DarManagerService;
+
+    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    return-void
 
     :pswitch_data_0
     .packed-switch 0x0
+        :pswitch_1
         :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4.smali b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4.smali
index a4e3a143d..0660151b4 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4.smali
@@ -9,7 +9,7 @@
 # instance fields
 .field public final synthetic $r8$classId:I
 
-.field public final synthetic f$0:Ljava/lang/Object;
+.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
 
 .field public final synthetic f$1:Ljava/lang/Object;
 
@@ -26,7 +26,7 @@
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Ljava/lang/Object;
+    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
     iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Ljava/lang/Object;
 
@@ -35,36 +35,34 @@
     return-void
 .end method
 
-.method public synthetic constructor <init>(Ljava/lang/Object;Lcom/android/internal/widget/LockscreenCredential;II)V
-    .locals 0
+.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
+    .locals 1
+
+    const/4 v0, 0x1
+
+    iput v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->$r8$classId:I
 
-    iput p4, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->$r8$classId:I
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Ljava/lang/Object;
+    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
     iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Ljava/lang/Object;
 
     iput p3, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$2:I
 
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
     return-void
 .end method
 
 
 # virtual methods
 .method public final run()V
-    .locals 3
-
-    const-class v0, Lcom/android/server/wm/WindowManagerInternal;
+    .locals 2
 
-    iget v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->$r8$classId:I
+    iget v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->$r8$classId:I
 
-    packed-switch v1, :pswitch_data_0
+    packed-switch v0, :pswitch_data_0
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
     iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Ljava/lang/Object;
 
@@ -72,70 +70,19 @@
 
     iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$2:I
 
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-virtual {v1}, Lcom/android/internal/widget/LockscreenCredential;->duplicate()Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v1
-
-    :try_start_0
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    sget-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    invoke-virtual {v0, v1, p0}, Lcom/android/server/locksettings/LockSettingsService;->updatePasswordHistory(Lcom/android/internal/widget/LockscreenCredential;I)V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-virtual {v1}, Lcom/android/internal/widget/LockscreenCredential;->close()V
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    if-eqz v1, :cond_0
+    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
-    :try_start_1
-    invoke-virtual {v1}, Lcom/android/internal/widget/LockscreenCredential;->close()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
+    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
 
-    goto :goto_0
-
-    :catchall_1
-    move-exception v0
-
-    invoke-virtual {p0, v0}, Ljava/lang/Throwable;->addSuppressed(Ljava/lang/Throwable;)V
-
-    :cond_0
-    :goto_0
-    throw p0
-
-    :pswitch_0
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Ljava/lang/Object;
-
-    check-cast v1, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Ljava/lang/Object;
-
-    check-cast v2, Lcom/android/internal/widget/LockscreenCredential;
-
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$2:I
-
-    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
+    move-result-object v0
 
-    invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
+    invoke-static {v1}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
 
     move-result-object v1
 
-    invoke-static {v2}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
-
-    move-result-object v2
+    invoke-virtual {v0, v1, p0}, Landroid/app/admin/DevicePolicyManager;->reportPasswordChanged(Landroid/app/admin/PasswordMetrics;I)V
 
-    invoke-virtual {v1, v2, p0}, Landroid/app/admin/DevicePolicyManager;->reportPasswordChanged(Landroid/app/admin/PasswordMetrics;I)V
+    const-class v0, Lcom/android/server/wm/WindowManagerInternal;
 
     invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
 
@@ -147,24 +94,24 @@
 
     return-void
 
-    :pswitch_1
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Ljava/lang/Object;
-
-    check-cast v1, Lcom/android/server/locksettings/LockSettingsService;
+    :pswitch_0
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Ljava/lang/Object;
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Ljava/lang/Object;
 
-    check-cast v2, Landroid/app/admin/PasswordMetrics;
+    check-cast v1, Landroid/app/admin/PasswordMetrics;
 
     iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$2:I
 
-    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
+    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
-    invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
+    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
 
-    move-result-object v1
+    move-result-object v0
 
-    invoke-virtual {v1, v2, p0}, Landroid/app/admin/DevicePolicyManager;->reportPasswordChanged(Landroid/app/admin/PasswordMetrics;I)V
+    invoke-virtual {v0, v1, p0}, Landroid/app/admin/DevicePolicyManager;->reportPasswordChanged(Landroid/app/admin/PasswordMetrics;I)V
+
+    const-class v0, Lcom/android/server/wm/WindowManagerInternal;
 
     invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
 
@@ -180,7 +127,6 @@
 
     :pswitch_data_0
     .packed-switch 0x0
-        :pswitch_1
         :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$2.smali b/smali/com/android/server/locksettings/LockSettingsService$2.smali
index 4d3d9ced8..9968225cf 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$2.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$2.smali
@@ -135,103 +135,30 @@
 
     move-result v1
 
-    const-string/jumbo v2, "LockSettingsService.SDP"
-
     if-eqz v1, :cond_1
 
     const-string/jumbo v0, "Unlocking user - Dualdar user "
 
-    invoke-static {p0, v0, v2}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :cond_1
-    invoke-virtual {v0, p0}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_2
-
-    invoke-virtual {v0, p0}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_4
+    const-string/jumbo v1, "LockSettingsService.SDP"
 
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    filled-new-array {v1}, [Ljava/lang/Object;
-
-    move-result-object v1
-
-    const-string/jumbo v3, "Unlocking user - User %d has non type credential"
-
-    invoke-static {v3, v1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v2, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->getSdpManager()Ljava/util/Optional;
-
-    move-result-object v1
-
-    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;
-
-    const/4 v4, 0x1
-
-    invoke-direct {v3, p0, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;-><init>(II)V
-
-    invoke-virtual {v1, v3}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "Unlocking user - Set device locked state (false) for user "
-
-    invoke-direct {v1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v2, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    const-class v1, Landroid/app/trust/TrustManager;
-
-    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/app/trust/TrustManager;
-
-    const/4 v1, 0x0
-
-    invoke-virtual {v0, p0, v1}, Landroid/app/trust/TrustManager;->setDeviceLockedForUser(IZ)V
+    invoke-static {p0, v0, v1}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
 
     return-void
 
-    :cond_2
-    if-nez p0, :cond_4
+    :cond_1
+    if-nez p0, :cond_3
 
     invoke-static {}, Landroid/os/storage/StorageManager;->isFileEncrypted()Z
 
     move-result v1
 
-    if-eqz v1, :cond_4
+    if-eqz v1, :cond_3
 
     invoke-virtual {v0, p0}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
 
     move-result v1
 
-    if-nez v1, :cond_4
+    if-nez v1, :cond_3
 
     iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
@@ -243,13 +170,13 @@
 
     move-result-object p0
 
-    :cond_3
+    :cond_2
     :goto_1
     invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
 
     move-result v1
 
-    if-eqz v1, :cond_4
+    if-eqz v1, :cond_3
 
     invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -261,13 +188,13 @@
 
     move-result v2
 
-    if-eqz v2, :cond_3
+    if-eqz v2, :cond_2
 
     invoke-virtual {v0, v1}, Lcom/android/server/locksettings/LockSettingsService;->UnlockSecureFolderIfAutoDataDecryption(Landroid/content/pm/UserInfo;)V
 
     goto :goto_1
 
-    :cond_4
+    :cond_3
     return-void
 
     :catchall_0
diff --git a/smali/com/android/server/locksettings/LockSettingsService$DarLockSettings.smali b/smali/com/android/server/locksettings/LockSettingsService$DarLockSettings.smali
index 541275cc1..72404f1cf 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$DarLockSettings.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$DarLockSettings.smali
@@ -54,9 +54,11 @@
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
+    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+
     const-string/jumbo v1, "pwd"
 
-    invoke-virtual {p0, p1, v1, v3, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {p0, p1, v1, v3, v4}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object p0
 
@@ -152,9 +154,9 @@
 
     move-result v0
 
-    const-string/jumbo v2, "p1"
+    const-string/jumbo v1, "p1"
 
-    const-string/jumbo v3, "e0"
+    const-string/jumbo v2, "e0"
 
     const/4 v7, 0x0
 
@@ -169,23 +171,23 @@
     goto/16 :goto_0
 
     :cond_3
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v3, Ljava/lang/StringBuilder;
 
-    const-string v5, "Get secured escrow data for user "
+    const-string v4, "Get secured escrow data for user "
 
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v3
 
-    const-string v5, "DarManagerService"
+    const-string v4, "DarManagerService"
 
-    invoke-static {v5, v4}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v3}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    new-instance v4, Ljava/io/File;
+    new-instance v3, Ljava/io/File;
 
     invoke-static {p1}, Landroid/os/Environment;->getDataSystemDeDirectory(I)Ljava/io/File;
 
@@ -193,7 +195,7 @@
 
     const-string/jumbo v9, "spblob"
 
-    invoke-direct {v4, v8, v9}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
+    invoke-direct {v3, v8, v9}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
 
     new-instance v8, Ljava/io/File;
 
@@ -215,7 +217,7 @@
 
     move-result-object v11
 
-    invoke-direct {v8, v4, v11}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
+    invoke-direct {v8, v3, v11}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
 
     new-instance v11, Ljava/io/File;
 
@@ -233,15 +235,15 @@
 
     move-result-object v9
 
-    invoke-direct {v11, v4, v9}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
+    invoke-direct {v11, v3, v9}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
 
     invoke-virtual {v8}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v3
 
-    invoke-static {v4}, Lcom/android/server/knox/dar/DarManagerService;->fileRead(Ljava/lang/String;)[B
+    invoke-static {v3}, Lcom/android/server/knox/dar/DarManagerService;->fileRead(Ljava/lang/String;)[B
 
-    move-result-object v4
+    move-result-object v3
 
     invoke-virtual {v11}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;
 
@@ -251,7 +253,7 @@
 
     move-result-object v8
 
-    filled-new-array {v4, v8}, [Ljava/lang/Object;
+    filled-new-array {v3, v8}, [Ljava/lang/Object;
 
     move-result-object v9
 
@@ -278,15 +280,15 @@
 
     new-instance v0, Ljava/lang/Exception;
 
-    const-string/jumbo v4, "Unexpected failure while get secure data key"
+    const-string/jumbo v3, "Unexpected failure while get secure data key"
 
-    invoke-direct {v0, v4}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v3}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
 
     invoke-virtual {v0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;
 
     move-result-object v0
 
-    invoke-static {v5, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
     goto :goto_0
 
@@ -295,9 +297,9 @@
 
     invoke-virtual {v10}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {v9, v4}, Lcom/android/server/knox/dar/KeyProtector;->decryptFast([B[B)[B
+    invoke-static {v9, v3}, Lcom/android/server/knox/dar/KeyProtector;->decryptFast([B[B)[B
 
-    move-result-object v4
+    move-result-object v3
 
     iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService;->mKeyProtector:Lcom/android/server/knox/dar/KeyProtector;
 
@@ -311,23 +313,23 @@
 
     invoke-direct {v8}, Landroid/os/Bundle;-><init>()V
 
-    invoke-virtual {v8, v3, v4}, Landroid/os/Bundle;->putByteArray(Ljava/lang/String;[B)V
+    invoke-virtual {v8, v2, v3}, Landroid/os/Bundle;->putByteArray(Ljava/lang/String;[B)V
 
-    invoke-virtual {v8, v2, v0}, Landroid/os/Bundle;->putByteArray(Ljava/lang/String;[B)V
+    invoke-virtual {v8, v1, v0}, Landroid/os/Bundle;->putByteArray(Ljava/lang/String;[B)V
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v9
 
-    invoke-static {v4}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
+    invoke-static {v3}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
 
-    move-result v4
+    move-result v3
 
-    xor-int/lit8 v4, v4, 0x1
+    xor-int/lit8 v3, v3, 0x1
 
-    invoke-static {v4}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+    invoke-static {v3}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
 
-    move-result-object v4
+    move-result-object v3
 
     invoke-static {v0}, Lcom/android/server/knox/dar/SecureUtil;->isEmpty(Ljava/lang/Object;)Z
 
@@ -339,17 +341,17 @@
 
     move-result-object v0
 
-    filled-new-array {v9, v4, v0}, [Ljava/lang/Object;
+    filled-new-array {v9, v3, v0}, [Ljava/lang/Object;
 
     move-result-object v0
 
-    const-string/jumbo v4, "Secured escrow data for user %d prepared [ Res : %b/%b ]"
+    const-string/jumbo v3, "Secured escrow data for user %d prepared [ Res : %b/%b ]"
 
-    invoke-static {v4, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v3, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
     move-result-object v0
 
-    invoke-static {v5, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     goto :goto_1
 
@@ -364,42 +366,42 @@
     return-void
 
     :cond_7
-    invoke-virtual {v8, v3}, Landroid/os/Bundle;->getByteArray(Ljava/lang/String;)[B
+    invoke-virtual {v8, v2}, Landroid/os/Bundle;->getByteArray(Ljava/lang/String;)[B
 
-    move-result-object v5
+    move-result-object v2
 
-    invoke-virtual {v8, v2}, Landroid/os/Bundle;->getByteArray(Ljava/lang/String;)[B
+    invoke-virtual {v8, v1}, Landroid/os/Bundle;->getByteArray(Ljava/lang/String;)[B
 
     move-result-object v8
 
-    if-eqz v5, :cond_8
+    if-eqz v2, :cond_8
 
     if-eqz v8, :cond_8
 
     iget-object v0, v6, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    const-string/jumbo v4, "e0"
+    const-string/jumbo v1, "e0"
 
-    const-wide/16 v2, 0x0
+    const-wide/16 v3, 0x0
 
-    move v1, p1
+    move v5, p1
 
-    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
-    const-string/jumbo v4, "p1"
+    const-string/jumbo v1, "p1"
 
-    move-object v5, v8
+    move-object v2, v8
 
-    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
     :cond_8
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v0
 
-    iget-object v2, v6, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v1, v6, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {v2, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasEscrowData(I)Z
+    invoke-virtual {v1, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasEscrowData(I)Z
 
     move-result v1
 
@@ -422,23 +424,11 @@
     return-void
 .end method
 
-.method public final saveEscrowDataIfNeededLocked(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-    .locals 9
-
-    const/4 v0, 0x0
-
-    if-eqz p2, :cond_0
+.method public final saveEscrowDataIfNeededLocked(I)V
+    .locals 10
 
-    invoke-virtual {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->isSdpMdfppMode()Z
+    const/4 v0, 0x1
 
-    move-result p2
-
-    goto :goto_0
-
-    :cond_0
-    move p2, v0
-
-    :goto_0
     sget-boolean v1, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
 
     iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->this$0:Lcom/android/server/locksettings/LockSettingsService;
@@ -447,78 +437,66 @@
 
     const-wide/16 v3, 0x0
 
-    invoke-virtual {v1, v2, v3, v4, v0}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+    const/4 v5, 0x0
 
-    move-result-wide v5
+    invoke-virtual {v1, v2, v3, v4, v5}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
-    const-wide/16 v7, 0x1
+    move-result-wide v6
 
-    cmp-long v5, v5, v7
+    const-wide/16 v8, 0x1
 
-    const/4 v6, 0x1
+    cmp-long v6, v6, v8
 
-    if-nez v5, :cond_1
-
-    move v5, v6
-
-    goto :goto_1
-
-    :cond_1
-    move v5, v0
+    if-nez v6, :cond_0
 
-    :goto_1
-    if-nez v5, :cond_3
+    goto :goto_0
 
-    invoke-virtual {v1, v2, v3, v4, v0}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+    :cond_0
+    invoke-virtual {v1, v2, v3, v4, v5}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
     move-result-wide v2
 
-    const-wide/16 v4, 0x2
+    const-wide/16 v6, 0x2
 
-    cmp-long v2, v2, v4
+    cmp-long v2, v2, v6
 
-    if-ltz v2, :cond_2
+    if-ltz v2, :cond_1
 
-    goto :goto_2
-
-    :cond_2
+    :goto_0
     move v2, v0
 
-    goto :goto_3
+    goto :goto_1
 
-    :cond_3
-    :goto_2
-    move v2, v6
+    :cond_1
+    move v2, v5
 
-    :goto_3
+    :goto_1
     invoke-virtual {v1, p1}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
 
     move-result v1
 
-    if-eqz v1, :cond_4
+    if-eqz v1, :cond_2
 
     invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
 
     move-result v1
 
-    if-nez v1, :cond_4
-
-    move v0, v6
+    if-nez v1, :cond_2
 
-    :cond_4
-    if-nez p2, :cond_5
+    move v5, v0
 
-    if-nez v2, :cond_5
+    :cond_2
+    if-nez v2, :cond_3
 
-    if-nez v0, :cond_5
+    if-nez v5, :cond_3
 
-    if-nez p1, :cond_5
+    if-nez p1, :cond_3
 
-    const/4 p2, 0x0
+    const/4 v1, 0x0
 
-    const-string/jumbo v0, "saveEscrowDataIfNeededLocked for system"
+    const-string/jumbo v2, "saveEscrowDataIfNeededLocked for system"
 
-    invoke-static {p2, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v1, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
 
@@ -526,15 +504,13 @@
 
     move-result-object p0
 
-    new-instance p2, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;
 
-    const/4 v0, 0x2
+    invoke-direct {v1, p1, v0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;-><init>(II)V
 
-    invoke-direct {p2, p1, v0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;-><init>(II)V
+    invoke-virtual {p0, v1}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
 
-    invoke-virtual {p0, p2}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    :cond_5
+    :cond_3
     return-void
 .end method
 
diff --git a/smali/com/android/server/locksettings/LockSettingsService$Injector$1.smali b/smali/com/android/server/locksettings/LockSettingsService$Injector$1.smali
index fdf534c4c..68b39d716 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$Injector$1.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$Injector$1.smali
@@ -11,84 +11,6 @@
 
 
 # direct methods
-.method public static -$$Nest$msetLockCredentialVariant(Lcom/android/server/locksettings/LockSettingsService$Injector$1;Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 5
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/LockSettingsService;
-
-    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->SKIP:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v2
-
-    :try_start_0
-    iget-object v4, v0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
-
-    invoke-virtual {v4, p3}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    invoke-static {p3}, Lcom/samsung/android/knox/SemPersonaManager;->isSecureFolderId(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_1
-
-    invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    filled-new-array {v1}, [Ljava/lang/Object;
-
-    move-result-object v1
-
-    const-string/jumbo v2, "User %d identified as secure folder user"
-
-    invoke-static {v2, v1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v1
-
-    const/4 v2, 0x0
-
-    invoke-static {v2, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
-
-    invoke-virtual {v0, p1, p2, p3}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->setSecureFolderLockCredential(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p2
-
-    invoke-virtual {p2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result p1
-
-    invoke-virtual {p0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->onCredentialChanged(II)V
-
-    :cond_0
-    return-object p2
-
-    :cond_1
-    return-object v1
-
-    :catchall_0
-    move-exception p0
-
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
 .method public synthetic constructor <init>(Ljava/lang/Object;)V
     .locals 0
 
@@ -738,86 +660,6 @@
     throw p0
 .end method
 
-.method public getSdpManager()Ljava/util/Optional;
-    .locals 2
-
-    sget-boolean v0, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getDarManagerService()Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6;
-
-    const/4 v1, 0x0
-
-    invoke-direct {v0, v1}, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6;-><init>(I)V
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    const/4 v0, 0x0
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
-.method public initializeMasterKeyIfRequired(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-    .locals 2
-
-    if-nez p2, :cond_0
-
-    const-string p0, " Initialize master key - Unexpected condition with user "
-
-    const-string/jumbo p2, "LockSettingsService.SDP"
-
-    invoke-static {p1, p0, p2}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :cond_0
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isSdpUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->getSdpManager()Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;
-
-    const/4 v1, 0x2
-
-    invoke-direct {v0, p1, v1, p2}, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;-><init>(IILjava/lang/Object;)V
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    :cond_1
-    return-void
-.end method
-
 .method public initializeSyntheticPasswordForVirtualUser(I)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
     .locals 11
 
@@ -992,122 +834,86 @@
     return p0
 .end method
 
-.method public isSdpUser(I)Z
-    .locals 1
+.method public migrateWithAuthToken(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
+    .locals 0
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    if-nez p2, :cond_0
 
-    move-result v0
+    goto :goto_0
 
-    if-nez v0, :cond_1
+    :cond_0
+    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+
+    move-result p2
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
     check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v0
+    if-nez p2, :cond_2
 
-    if-eqz v0, :cond_0
+    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    move-result p2
 
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
+    if-eqz p2, :cond_1
 
-    move-result p0
+    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
 
-    if-nez p0, :cond_0
+    invoke-virtual {p2, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
 
-    goto :goto_0
+    move-result p1
 
-    :cond_0
-    const/4 p0, 0x0
+    if-nez p1, :cond_1
 
-    return p0
+    goto :goto_1
 
     :cond_1
     :goto_0
-    const/4 p0, 0x1
-
-    return p0
-.end method
-
-.method public migrateWithAuthToken(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-    .locals 1
-
-    if-nez p2, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isSdpUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
+    return-void
 
+    :cond_2
+    :goto_1
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->isWeaverSupported()Z
+    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
 
-    move-result p0
+    move-result-object p0
 
-    if-eqz p0, :cond_1
+    if-eqz p0, :cond_4
 
-    const-class p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
+    const-class p0, Lcom/android/server/knox/dar/sdp/SdpManagerInternal;
 
     invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
 
     move-result-object p0
 
-    check-cast p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
+    if-nez p0, :cond_3
+
+    const/4 p0, 0x0
 
     invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
 
     move-result-object p0
 
-    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;
+    new-instance p1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;
 
-    invoke-direct {v0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;-><init>(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
+    const/4 p2, 0x2
 
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
+    invoke-direct {p1, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;-><init>(I)V
 
-    :cond_1
-    :goto_0
-    return-void
-.end method
-
-.method public onCredentialChanged(II)V
-    .locals 1
-
-    invoke-static {p2}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isSdpUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->getSdpManager()Ljava/util/Optional;
+    invoke-virtual {p0, p1}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
 
-    move-result-object p0
+    return-void
 
-    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda0;
+    :cond_3
+    new-instance p0, Ljava/lang/ClassCastException;
 
-    invoke-direct {v0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda0;-><init>(II)V
+    invoke-direct {p0}, Ljava/lang/ClassCastException;-><init>()V
 
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
+    throw p0
 
-    :cond_0
+    :cond_4
     return-void
 .end method
 
@@ -1425,7 +1231,7 @@
 .end method
 
 .method public onRebootEscrowRestored(B[BI)V
-    .locals 7
+    .locals 2
 
     new-instance v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
@@ -1456,19 +1262,9 @@
 
     invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    move-result-object v5
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
-
-    move-result-object v6
-
-    const-wide/16 v3, 0x0
-
-    move v2, p3
+    move-result-object p2
 
-    invoke-virtual/range {v1 .. v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallengeInternal(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {v1, p2, v0, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallenge(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)Lcom/android/internal/widget/VerifyCredentialResponse;
 
     monitor-exit p1
     :try_end_0
@@ -1478,32 +1274,30 @@
 
     const-string/jumbo p2, "Restored synthetic password for user %d using reboot escrow"
 
-    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object p3
+    move-result-object v1
 
-    filled-new-array {p3}, [Ljava/lang/Object;
+    filled-new-array {v1}, [Ljava/lang/Object;
 
-    move-result-object p3
+    move-result-object v1
 
-    invoke-static {p1, p2, p3}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {p1, p2, v1}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
     check-cast p0, Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-virtual {p0, v2, v0}, Lcom/android/server/locksettings/LockSettingsService;->loadPasswordMetrics(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Landroid/app/admin/PasswordMetrics;
+    invoke-virtual {p0, p3, v0}, Lcom/android/server/locksettings/LockSettingsService;->loadPasswordMetrics(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Landroid/app/admin/PasswordMetrics;
 
     move-result-object p1
 
-    invoke-virtual {p0, v0, p1, v2}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
+    invoke-virtual {p0, v0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
 
     return-void
 
     :catchall_0
-    move-exception v0
-
-    move-object p0, v0
+    move-exception p0
 
     :try_start_1
     monitor-exit p1
@@ -1812,50 +1606,8 @@
     return-void
 .end method
 
-.method public prepareMasterKeyIfUnsecured(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-    .locals 2
-
-    if-nez p2, :cond_0
-
-    const-string/jumbo p0, "SP deserted - Unexpected condition while desert sp with user "
-
-    const-string/jumbo p2, "LockSettingsService.SDP"
-
-    invoke-static {p1, p0, p2}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :cond_0
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isSdpUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->getSdpManager()Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;
-
-    const/4 v1, 0x1
-
-    invoke-direct {v0, p1, v1, p2}, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;-><init>(IILjava/lang/Object;)V
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    :cond_1
-    return-void
-.end method
-
 .method public setLockCredentialWithTokenInternalForDualDAR(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
-    .locals 10
+    .locals 9
 
     const-string/jumbo v0, "LockSettingsService: "
 
@@ -1869,9 +1621,7 @@
 
     move-result v1
 
-    const/4 v2, 0x1
-
-    if-eqz v1, :cond_7
+    if-eqz v1, :cond_5
 
     iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
@@ -1882,27 +1632,27 @@
     monitor-enter v1
 
     :try_start_0
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
-    check-cast v3, Lcom/android/server/locksettings/LockSettingsService;
+    check-cast v2, Lcom/android/server/locksettings/LockSettingsService;
 
-    iget-object v4, v3, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v3, v2, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {v3}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+    invoke-virtual {v2}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    move-result-object v8
+    move-result-object v7
 
-    move-wide v6, p2
+    move-wide v5, p2
 
-    move-object v9, p4
+    move-object v8, p4
 
-    move v5, p5
+    move v4, p5
 
-    invoke-virtual/range {v4 .. v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockTokenBasedProtector(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockTokenBasedProtector(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
     move-result-object p2
 
-    move p3, v5
+    move p3, v4
 
     iget-object p2, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
@@ -1947,7 +1697,7 @@
 
     move-object p0, v0
 
-    goto/16 :goto_4
+    goto/16 :goto_2
 
     :cond_0
     monitor-exit v1
@@ -1960,57 +1710,19 @@
 
     iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    iget-object p2, p2, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
-
-    invoke-virtual {p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSpecificProcessRequired(I)Z
-
-    move-result p5
+    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    if-eqz p5, :cond_2
-
-    invoke-virtual {p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->getSecureMode(I)I
+    sget-object p2, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mSecureModeCache:Landroid/util/SparseArray;
 
-    move-result p5
+    if-eqz v8, :cond_2
 
-    if-lez p5, :cond_1
+    array-length p2, v8
 
-    move p5, v2
+    if-nez p2, :cond_1
 
     goto :goto_0
 
     :cond_1
-    move p5, p4
-
-    :goto_0
-    if-eqz p5, :cond_2
-
-    invoke-virtual {p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->getSecureMode(I)I
-
-    move-result p2
-
-    const-string p5, "ForApplicationId"
-
-    invoke-static {p2, p5, v9}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->personalize(ILjava/lang/String;[B)[B
-
-    move-result-object p2
-
-    :goto_1
-    move-object v8, p2
-
-    goto :goto_3
-
-    :cond_2
-    sget-object p2, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mSecureModeCache:Landroid/util/SparseArray;
-
-    if-eqz v9, :cond_4
-
-    array-length p2, v9
-
-    if-nez p2, :cond_3
-
-    goto :goto_2
-
-    :cond_3
     sget-object p2, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;
 
     const-string p5, "KeyEncryptionKey"
@@ -2027,22 +1739,22 @@
 
     new-instance v0, Lcom/android/server/locksettings/SP800Derive;
 
-    invoke-direct {v0, v9}, Lcom/android/server/locksettings/SP800Derive;-><init>([B)V
+    invoke-direct {v0, v8}, Lcom/android/server/locksettings/SP800Derive;-><init>([B)V
 
     invoke-virtual {v0, p5, p2}, Lcom/android/server/locksettings/SP800Derive;->withContext([B[B)[B
 
     move-result-object p2
 
-    goto :goto_1
-
-    :cond_4
-    :goto_2
-    move-object p2, v9
+    move-object v7, p2
 
     goto :goto_1
 
-    :goto_3
-    if-nez v8, :cond_5
+    :cond_2
+    :goto_0
+    move-object v7, v8
+
+    :goto_1
+    if-nez v7, :cond_3
 
     const-string/jumbo p0, "LockSettingsService"
 
@@ -2058,7 +1770,7 @@
 
     return p4
 
-    :cond_5
+    :cond_3
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
     check-cast p2, Lcom/android/server/locksettings/LockSettingsService;
@@ -2067,7 +1779,7 @@
 
     invoke-static {p2}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
 
-    move-result-object v3
+    move-result-object v2
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
 
@@ -2077,17 +1789,17 @@
 
     invoke-virtual {p0, p3}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
 
-    move-result v4
+    move-result v3
 
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
 
-    move-result-object v5
+    move-result-object v4
 
-    invoke-virtual/range {v3 .. v8}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->resetPasswordWithToken(I[BJ[B)Z
+    invoke-virtual/range {v2 .. v7}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->resetPasswordWithToken(I[BJ[B)Z
 
     move-result p0
 
-    if-nez p0, :cond_6
+    if-nez p0, :cond_4
 
     const-string/jumbo p0, "LockSettingsService"
 
@@ -2103,7 +1815,7 @@
 
     return p4
 
-    :cond_6
+    :cond_4
     const-string/jumbo p0, "LockSettingsService"
 
     const-string p1, "Dual DAR Client successfully reset password with token for user: "
@@ -2116,9 +1828,9 @@
 
     invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    goto :goto_5
+    goto :goto_3
 
-    :goto_4
+    :goto_2
     :try_start_1
     monitor-exit v1
     :try_end_1
@@ -2126,7 +1838,9 @@
 
     throw p0
 
-    :cond_7
-    :goto_5
-    return v2
+    :cond_5
+    :goto_3
+    const/4 p0, 0x1
+
+    return p0
 .end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$Lifecycle.smali b/smali/com/android/server/locksettings/LockSettingsService$Lifecycle.smali
index 631ba5201..a9eb64e3a 100644
--- a/smali/com/android/server/locksettings/LockSettingsService$Lifecycle.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService$Lifecycle.smali
@@ -19,21 +19,19 @@
 
 # virtual methods
 .method public final onBootPhase(I)V
-    .locals 10
-
-    const/4 v0, 0x0
+    .locals 3
 
-    const/4 v1, 0x1
+    const/4 v0, 0x1
 
     invoke-super {p0, p1}, Lcom/android/server/SystemService;->onBootPhase(I)V
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Lifecycle;->mLockSettingsService:Lcom/android/server/locksettings/LockSettingsService;
 
-    sget-boolean v2, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+    sget-boolean v1, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
 
-    const/16 v2, 0x226
+    const/16 v1, 0x226
 
-    if-ne p1, v2, :cond_0
+    if-ne p1, v1, :cond_0
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->migrateOldDataAfterSystemReady()V
 
@@ -42,539 +40,48 @@
     return-void
 
     :cond_0
-    const/16 v2, 0x208
+    const/16 v1, 0x208
 
-    if-ne p1, v2, :cond_12
+    if-ne p1, v1, :cond_3
 
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    monitor-enter v2
+    monitor-enter v1
 
     :try_start_0
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     invoke-virtual {p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->checkWeaverStatus()V
 
-    monitor-exit v2
+    monitor-exit v1
     :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_5
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    iget-object v2, p1, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v2, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v2, v0}, Lcom/android/server/locksettings/LockSettingsService;->isDeviceOwner(I)Z
-
-    move-result v2
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/DarUtil;->updateDeviceOwnerStatus(Z)V
-
-    new-instance v2, Ljava/io/File;
-
-    const-string v3, "/data/system/users/sdp_engine_list.xml"
-
-    invoke-direct {v2, v3}, Ljava/io/File;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2}, Ljava/io/File;->exists()Z
-
-    move-result v3
-
-    if-nez v3, :cond_1
-
-    const-string/jumbo v2, "LockSettingsService"
-
-    const-string v3, "Failed to get engine list due to non-existence..."
-
-    invoke-static {v2, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    move v5, v0
-
-    goto/16 :goto_6
-
-    :cond_1
-    new-instance v3, Landroid/util/AtomicFile;
-
-    invoke-direct {v3, v2}, Landroid/util/AtomicFile;-><init>(Ljava/io/File;)V
-
-    :try_start_1
-    invoke-virtual {v3}, Landroid/util/AtomicFile;->openRead()Ljava/io/FileInputStream;
-
-    move-result-object v2
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1
-
-    :try_start_2
-    invoke-static {}, Lorg/xmlpull/v1/XmlPullParserFactory;->newInstance()Lorg/xmlpull/v1/XmlPullParserFactory;
-
-    move-result-object v3
-
-    invoke-virtual {v3}, Lorg/xmlpull/v1/XmlPullParserFactory;->newPullParser()Lorg/xmlpull/v1/XmlPullParser;
-
-    move-result-object v3
-
-    const-string/jumbo v4, "UTF-8"
-
-    invoke-interface {v3, v2, v4}, Lorg/xmlpull/v1/XmlPullParser;->setInput(Ljava/io/InputStream;Ljava/lang/String;)V
-
-    invoke-interface {v3}, Lorg/xmlpull/v1/XmlPullParser;->getEventType()I
-
-    move-result v4
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    move v5, v0
-
-    move v6, v1
-
-    :goto_0
-    if-nez v5, :cond_7
-
-    if-eq v4, v1, :cond_7
-
-    const/4 v7, 0x2
-
-    if-eq v4, v7, :cond_2
-
-    goto :goto_2
-
-    :cond_2
-    :try_start_3
-    invoke-interface {v3}, Lorg/xmlpull/v1/XmlPullParser;->getName()Ljava/lang/String;
-
-    move-result-object v4
-
-    const-string/jumbo v7, "engine"
-
-    invoke-virtual {v7, v4}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_6
-
-    const-string/jumbo v4, "alias"
-
-    invoke-interface {v3, v0}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeName(I)Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v4, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_4
-
-    const-string/jumbo v4, "id"
-
-    invoke-interface {v3, v1}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeName(I)Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v4, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_4
-
-    invoke-interface {v3, v0}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeValue(I)Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-interface {v3, v1}, Lorg/xmlpull/v1/XmlPullParser;->getAttributeValue(I)Ljava/lang/String;
-
-    move-result-object v6
-
-    invoke-static {v6}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
-
-    move-result v6
-
-    if-ltz v6, :cond_3
-
-    invoke-virtual {v4}, Ljava/lang/String;->isEmpty()Z
-
-    move-result v4
-
-    if-nez v4, :cond_3
-
-    move v6, v1
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception v3
-
-    goto :goto_3
-
-    :cond_3
-    move v6, v0
-
-    :cond_4
-    :goto_1
-    if-eqz v6, :cond_5
-
-    move v5, v1
-
-    goto :goto_2
-
-    :cond_5
-    new-instance v3, Ljava/lang/Exception;
-
-    const-string/jumbo v4, "Suspicious of damaged file..."
-
-    invoke-direct {v3, v4}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
-
-    throw v3
-
-    :cond_6
-    :goto_2
-    invoke-interface {v3}, Lorg/xmlpull/v1/XmlPullParser;->next()I
-
-    move-result v4
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    goto :goto_0
-
-    :cond_7
-    if-eqz v2, :cond_9
-
-    :try_start_4
-    invoke-virtual {v2}, Ljava/io/FileInputStream;->close()V
-    :try_end_4
-    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_0
-
-    goto :goto_6
-
-    :catch_0
-    move-exception v2
-
-    goto :goto_5
-
-    :catchall_1
-    move-exception v3
-
-    move v5, v0
-
-    :goto_3
-    if-eqz v2, :cond_8
-
-    :try_start_5
-    invoke-virtual {v2}, Ljava/io/FileInputStream;->close()V
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_2
-
-    goto :goto_4
-
-    :catchall_2
-    move-exception v2
-
-    :try_start_6
-    invoke-virtual {v3, v2}, Ljava/lang/Throwable;->addSuppressed(Ljava/lang/Throwable;)V
-
-    :cond_8
-    :goto_4
-    throw v3
-    :try_end_6
-    .catch Ljava/lang/Exception; {:try_start_6 .. :try_end_6} :catch_0
-
-    :catch_1
-    move-exception v2
-
-    move v5, v0
-
-    :goto_5
-    const-string/jumbo v3, "LockSettingsService.SDP"
-
-    const-string/jumbo v4, "read sdp engine failed."
-
-    invoke-static {v3, v4, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    :cond_9
-    :goto_6
-    if-eqz v5, :cond_a
-
-    invoke-virtual {p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->getSdpManager()Ljava/util/Optional;
-
-    move-result-object p1
-
-    new-instance v2, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6;
-
-    invoke-direct {v2, v1}, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6;-><init>(I)V
-
-    invoke-virtual {p1, v2}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p1
-
-    sget-object v2, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {p1, v2}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Ljava/lang/Boolean;
-
-    invoke-virtual {p1}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result p1
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "SdpEngineList Exists, Sdp service now ready [ res : "
-
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string v3, " ]"
-
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    goto :goto_7
-
-    :cond_a
-    const-string/jumbo p1, "SdpEngineList is Empty."
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    move p1, v0
-
-    :goto_7
-    if-eqz p1, :cond_d
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    iget-object v2, p1, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v2, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v2, v2, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
-
-    invoke-virtual {v2}, Landroid/os/UserManager;->getUsers()Ljava/util/List;
-
-    move-result-object v2
-
-    move v3, v0
-
-    :goto_8
-    invoke-interface {v2}, Ljava/util/List;->size()I
-
-    move-result v4
-
-    if-ge v3, v4, :cond_d
-
-    invoke-interface {v2, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;
-
-    move-result-object v4
-
-    check-cast v4, Landroid/content/pm/UserInfo;
-
-    iget v4, v4, Landroid/content/pm/UserInfo;->id:I
-
-    iget-object v5, p1, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v5, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v5, v4}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v5
-
-    if-eqz v5, :cond_c
-
-    iget-object v5, p1, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v5, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v5, v5, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v5
-
-    :try_start_7
-    iget-object v6, p1, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v6, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v6, v4}, Lcom/android/server/locksettings/LockSettingsService;->isSyntheticPasswordBasedCredentialLocked(I)Z
-
-    move-result v6
-
-    if-eqz v6, :cond_b
-
-    iget-object v6, p1, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v6, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v6, v4}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
-
-    move-result-wide v6
-
-    iget-object v8, p1, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast v8, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v8, v8, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v8, v4, v6, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getCredentialType(IJ)I
-
-    move-result v6
-
-    const-string/jumbo v7, "LockSettingsService.SDP"
-
-    new-instance v8, Ljava/lang/StringBuilder;
-
-    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v9, "Cached credential type("
-
-    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v6, ") for enterprise user "
-
-    invoke-virtual {v8, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
+    .catchall {:try_start_0 .. :try_end_0} :catchall_1
 
-    invoke-static {v7, v4}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_9
-
-    :catchall_3
-    move-exception p0
-
-    goto :goto_a
-
-    :cond_b
-    :goto_9
-    monitor-exit v5
-
-    goto :goto_b
-
-    :goto_a
-    monitor-exit v5
-    :try_end_7
-    .catchall {:try_start_7 .. :try_end_7} :catchall_3
-
-    throw p0
-
-    :cond_c
-    :goto_b
-    add-int/2addr v3, v1
-
-    goto :goto_8
-
-    :cond_d
     const-string/jumbo p1, "Refresh weaver slots"
 
-    const/4 v2, 0x0
+    const/4 v1, 0x0
 
-    invoke-static {v2, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v1, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     monitor-enter p1
 
-    :try_start_8
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getUsedWeaverSlots()Ljava/util/Set;
-
-    move-result-object v3
-
-    iget-object v2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager;->mPasswordSlotManager:Lcom/android/server/locksettings/PasswordSlotManager;
-
-    invoke-virtual {v2, v3}, Lcom/android/server/locksettings/PasswordSlotManager;->refreshActiveSlots(Ljava/util/Set;)V
-
-    monitor-exit p1
-    :try_end_8
-    .catchall {:try_start_8 .. :try_end_8} :catchall_4
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-string/jumbo v2, "ro.product.first_api_level"
-
-    invoke-static {v2, v0}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I
-
-    move-result v2
-
-    const/16 v3, 0x1d
-
-    if-ge v2, v3, :cond_f
-
-    iget-object p1, p1, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p1, Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v2, p1, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
+    :try_start_1
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {v2}, Landroid/os/UserManager;->getUsers()Ljava/util/List;
+    invoke-virtual {v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getUsedWeaverSlots()Ljava/util/Set;
 
     move-result-object v2
 
-    move v3, v0
-
-    :goto_c
-    invoke-interface {v2}, Ljava/util/List;->size()I
-
-    move-result v4
+    iget-object v1, v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->mPasswordSlotManager:Lcom/android/server/locksettings/PasswordSlotManager;
 
-    if-ge v3, v4, :cond_f
+    invoke-virtual {v1, v2}, Lcom/android/server/locksettings/PasswordSlotManager;->refreshActiveSlots(Ljava/util/Set;)V
 
-    invoke-interface {v2, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;
-
-    move-result-object v4
-
-    check-cast v4, Landroid/content/pm/UserInfo;
-
-    iget v4, v4, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-virtual {p1, v4}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v5
-
-    if-eqz v5, :cond_e
-
-    const-string/jumbo v5, "migrated_password_hash"
-
-    invoke-virtual {p1, v5, v0, v4}, Lcom/android/server/locksettings/LockSettingsService;->getBoolean(Ljava/lang/String;ZI)Z
-
-    move-result v6
-
-    if-nez v6, :cond_e
-
-    invoke-virtual {p1, v5, v0, v4}, Lcom/android/server/locksettings/LockSettingsService;->setBoolean(Ljava/lang/String;ZI)V
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v6, "Need password hash migration for enterprise user "
-
-    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    const-string/jumbo v6, "LockSettingsService.SDP"
-
-    invoke-static {v5, v4, v6}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
-
-    :cond_e
-    add-int/2addr v3, v1
-
-    goto :goto_c
+    monitor-exit p1
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :cond_f
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
     invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
@@ -583,19 +90,21 @@
 
     move-result p1
 
-    if-eqz p1, :cond_10
+    if-eqz p1, :cond_1
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getDarManagerService()Ljava/util/Optional;
 
     move-result-object p1
 
-    new-instance v2, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;
 
-    invoke-direct {v2, v0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;-><init>(I)V
+    const/4 v2, 0x0
+
+    invoke-direct {v1, v2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;-><init>(I)V
 
-    invoke-virtual {p1, v2}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
+    invoke-virtual {p1, v1}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
 
-    :cond_10
+    :cond_1
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
     iget-object p1, p1, Lcom/android/server/locksettings/LockSettingsService$Injector;->mContext:Landroid/content/Context;
@@ -604,7 +113,7 @@
 
     move-result p1
 
-    if-lez p1, :cond_11
+    if-lez p1, :cond_2
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getDarManagerService()Ljava/util/Optional;
 
@@ -612,49 +121,49 @@
 
     new-instance p1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;
 
-    invoke-direct {p1, v1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;-><init>(I)V
+    invoke-direct {p1, v0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda21;-><init>(I)V
 
     invoke-virtual {p0, p1}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
 
-    :cond_11
+    :cond_2
     return-void
 
-    :catchall_4
+    :catchall_0
     move-exception p0
 
-    :try_start_9
+    :try_start_2
     monitor-exit p1
-    :try_end_9
-    .catchall {:try_start_9 .. :try_end_9} :catchall_4
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
     throw p0
 
-    :catchall_5
+    :catchall_1
     move-exception p0
 
-    :try_start_a
-    monitor-exit v2
-    :try_end_a
-    .catchall {:try_start_a .. :try_end_a} :catchall_5
+    :try_start_3
+    monitor-exit v1
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_1
 
     throw p0
 
-    :cond_12
-    const/16 v0, 0x3e8
+    :cond_3
+    const/16 v1, 0x3e8
 
-    if-ne p1, v0, :cond_13
+    if-ne p1, v1, :cond_4
 
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
 
-    invoke-direct {v0, p0, v1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+    invoke-direct {v1, p0, v0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
 
-    invoke-virtual {p1, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+    invoke-virtual {p1, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
     return-void
 
-    :cond_13
+    :cond_4
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     return-void
diff --git a/smali/com/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda0.smali b/smali/com/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda0.smali
deleted file mode 100644
index cc9cc901d..000000000
--- a/smali/com/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda0.smali
+++ /dev/null
@@ -1,42 +0,0 @@
-.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda0;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Consumer;
-
-
-# instance fields
-.field public final synthetic f$0:I
-
-.field public final synthetic f$1:I
-
-
-# direct methods
-.method public synthetic constructor <init>(II)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda0;->f$0:I
-
-    iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda0;->f$1:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 1
-
-    iget v0, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda0;->f$0:I
-
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda0;->f$1:I
-
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p1, v0, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->onCredentialChanged(II)V
-
-    return-void
-.end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5.smali b/smali/com/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5.smali
deleted file mode 100644
index 741928c4a..000000000
--- a/smali/com/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5.smali
+++ /dev/null
@@ -1,266 +0,0 @@
-.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Consumer;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:I
-
-.field public final synthetic f$1:Ljava/lang/Object;
-
-
-# direct methods
-.method public synthetic constructor <init>(IILjava/lang/Object;)V
-    .locals 0
-
-    iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->$r8$classId:I
-
-    iput-object p3, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->f$1:Ljava/lang/Object;
-
-    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->f$0:I
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-.method public synthetic constructor <init>(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-    .locals 1
-
-    const/4 v0, 0x0
-
-    iput v0, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->$r8$classId:I
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->f$0:I
-
-    iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->f$1:Ljava/lang/Object;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 9
-
-    iget v0, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->$r8$classId:I
-
-    packed-switch v0, :pswitch_data_0
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->f$1:Ljava/lang/Object;
-
-    check-cast v0, [B
-
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->f$0:I
-
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p1, v0, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->unlockSdpOnCredentialVerified([BI)V
-
-    return-void
-
-    :pswitch_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->f$1:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->f$0:I
-
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSdpMasterKey()[B
-
-    move-result-object v0
-
-    invoke-virtual {p1, v0, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->initializeMasterKeyIfRequired([BI)V
-
-    return-void
-
-    :pswitch_1
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->f$1:Ljava/lang/Object;
-
-    check-cast v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->f$0:I
-
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSdpMasterKey()[B
-
-    move-result-object v0
-
-    invoke-virtual {p1, v0, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->saveMasterKeyIfUnsecured([BI)V
-
-    return-void
-
-    :pswitch_2
-    const-string/jumbo v0, "smk_ver"
-
-    iget v1, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->f$0:I
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;->f$1:Ljava/lang/Object;
-
-    check-cast p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    iget-object v2, p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget-object v2, v2, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const/4 v3, 0x0
-
-    :try_start_0
-    invoke-virtual {v2, v1, v0}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->getInternal(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v2
-
-    if-eqz v2, :cond_0
-
-    invoke-static {v2}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
-
-    move-result v2
-    :try_end_0
-    .catch Ljava/lang/NumberFormatException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    :cond_0
-    move v2, v3
-
-    :goto_0
-    if-nez v2, :cond_2
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v4, "MK migration required for user "
-
-    invoke-direct {v2, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    const-string/jumbo v4, "LockSettingsService"
-
-    invoke-static {v4, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSdpMasterKey()[B
-
-    move-result-object v2
-
-    sget-object v5, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SDP_MASTER_KEY:[B
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    filled-new-array {p0}, [[B
-
-    move-result-object p0
-
-    sget-object v6, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->PROTECTOR_SECRET_PERSONALIZATION:[B
-
-    :try_start_1
-    const-string/jumbo v6, "SHA-256"
-
-    invoke-static {v6}, Ljava/security/MessageDigest;->getInstance(Ljava/lang/String;)Ljava/security/MessageDigest;
-
-    move-result-object v6
-
-    array-length v7, v5
-
-    const/16 v8, 0x40
-
-    if-gt v7, v8, :cond_1
-
-    invoke-static {v5, v8}, Ljava/util/Arrays;->copyOf([BI)[B
-
-    move-result-object v5
-
-    invoke-virtual {v6, v5}, Ljava/security/MessageDigest;->update([B)V
-
-    aget-object p0, p0, v3
-
-    invoke-virtual {v6, p0}, Ljava/security/MessageDigest;->update([B)V
-
-    invoke-virtual {v6}, Ljava/security/MessageDigest;->digest()[B
-
-    move-result-object p0
-    :try_end_1
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_1 .. :try_end_1} :catch_1
-
-    sget-boolean v3, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    iget-object p1, p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v1, v2, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->reWrapSdpKeys(I[B[B)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_2
-
-    iget-object p0, p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSdpDatabaseCache:Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const/4 p1, 0x1
-
-    invoke-static {p1}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-virtual {p0, v1, v0, p1}, Lcom/android/server/knox/dar/sdp/SdpDatabaseCache;->putInternal(ILjava/lang/String;Ljava/lang/String;)V
-
-    const-string/jumbo p0, "MK migration success!"
-
-    invoke-static {v4, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_1
-
-    :cond_1
-    :try_start_2
-    new-instance p0, Ljava/lang/IllegalStateException;
-
-    const-string/jumbo p1, "Personalization too long"
-
-    invoke-direct {p0, p1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-    :try_end_2
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_2 .. :try_end_2} :catch_1
-
-    :catch_1
-    move-exception p0
-
-    new-instance p1, Ljava/lang/IllegalStateException;
-
-    const-string/jumbo v0, "NoSuchAlgorithmException for SHA-256"
-
-    invoke-direct {p1, v0, p0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    throw p1
-
-    :cond_2
-    :goto_1
-    return-void
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_2
-        :pswitch_1
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6.smali b/smali/com/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6.smali
deleted file mode 100644
index 308cde4dc..000000000
--- a/smali/com/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6.smali
+++ /dev/null
@@ -1,96 +0,0 @@
-.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-
-# direct methods
-.method public synthetic constructor <init>(I)V
-    .locals 0
-
-    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6;->$r8$classId:I
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 1
-
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda6;->$r8$classId:I
-
-    packed-switch p0, :pswitch_data_0
-
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-class p0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    monitor-enter p0
-
-    :try_start_0
-    sget-boolean v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mSystemReady:Z
-
-    if-nez v0, :cond_1
-
-    iget-boolean p1, p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mIsHandlerReady:Z
-
-    if-eqz p1, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p1, 0x0
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception p1
-
-    goto :goto_2
-
-    :cond_1
-    :goto_0
-    const/4 p1, 0x1
-
-    :goto_1
-    monitor-exit p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {p1}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-
-    :goto_2
-    :try_start_1
-    monitor-exit p0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p1
-
-    :pswitch_0
-    check-cast p1, Lcom/android/server/knox/dar/DarManagerService;
-
-    iget-object p0, p1, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    return-object p0
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/locksettings/LockSettingsService.smali b/smali/com/android/server/locksettings/LockSettingsService.smali
index 8eca6b243..d40038499 100644
--- a/smali/com/android/server/locksettings/LockSettingsService.smali
+++ b/smali/com/android/server/locksettings/LockSettingsService.smali
@@ -38,7 +38,7 @@
 
 .field public final mDeviceProvisionedObserver:Lcom/android/server/locksettings/LockSettingsService$DeviceProvisionedObserver;
 
-.field public final mDoVerifySI:Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
+.field public final mDoVerifySI:Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
 
 .field public final mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
 
@@ -376,7 +376,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_7
+    if-eqz v4, :cond_6
 
     invoke-virtual {p0, p2, p3, v1}, Lcom/android/server/locksettings/LockSettingsService;->isEscrowTokenActive(JI)Z
 
@@ -418,22 +418,11 @@
 
     move-result v0
 
-    if-eqz v0, :cond_4
-
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v5
-
-    invoke-virtual {v4, v5, v1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->onCredentialChanged(II)V
-
-    :cond_4
     monitor-exit v3
     :try_end_3
     .catchall {:try_start_3 .. :try_end_3} :catchall_1
 
-    if-eqz v0, :cond_6
+    if-eqz v0, :cond_5
 
     iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mSeparateChallengeLock:Ljava/lang/Object;
 
@@ -450,7 +439,7 @@
 
     move-result v3
 
-    if-eqz v3, :cond_5
+    if-eqz v3, :cond_4
 
     iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
@@ -462,7 +451,7 @@
 
     invoke-virtual {v3, v4}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    :cond_5
+    :cond_4
     invoke-virtual {p0, p1, v1}, Lcom/android/server/locksettings/LockSettingsService;->notifyPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
 
     invoke-virtual {p0, v1}, Lcom/android/server/locksettings/LockSettingsService;->notifySeparateProfileChallengeChanged(I)V
@@ -481,7 +470,7 @@
 
     throw p0
 
-    :cond_6
+    :cond_5
     :goto_5
     const-string/jumbo p0, "Result of setting credential with token for user %d : %s"
 
@@ -505,7 +494,7 @@
 
     return v0
 
-    :cond_7
+    :cond_6
     :try_start_6
     new-instance p0, Ljava/lang/SecurityException;
 
@@ -698,11 +687,11 @@
 
     iput-object v4, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpBackup:Lcom/android/server/locksettings/LockSettingsService$9;
 
-    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
+    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
 
-    invoke-direct {v4, v0, v3}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+    invoke-direct {v4, v0, v3}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
 
-    iput-object v4, v0, Lcom/android/server/locksettings/LockSettingsService;->mDoVerifySI:Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
+    iput-object v4, v0, Lcom/android/server/locksettings/LockSettingsService;->mDoVerifySI:Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
 
     new-instance v3, Lcom/android/server/locksettings/LockSettingsService$3;
 
@@ -1792,21 +1781,13 @@
 
     iget-object v1, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    const-string/jumbo v0, "addEscrowToken: initializeMasterKeyIfRequired"
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v0, v6, v1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->initializeMasterKeyIfRequired(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-
     const-string/jumbo v0, "addEscrowToken: saveEscrowDataIfNeededLocked"
 
     invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
 
-    invoke-virtual {v0, v6, v1}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->saveEscrowDataIfNeededLocked(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
+    invoke-virtual {v0, v6}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->saveEscrowDataIfNeededLocked(I)V
 
     goto :goto_3
 
@@ -2612,7 +2593,7 @@
 
     move-result-object p2
 
-    move v3, p1
+    move v7, p1
 
     goto/16 :goto_3
 
@@ -2740,17 +2721,17 @@
 
     invoke-static {p2, v0, p3}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->encrypt([B[B[B)[B
 
-    move-result-object v7
+    move-result-object v4
 
-    const-string/jumbo v6, "vendor_auth_secret"
+    const-string/jumbo v3, "vendor_auth_secret"
 
-    const-wide/16 v4, 0x0
+    const-wide/16 v5, 0x0
 
-    move v3, p1
+    move v7, p1
 
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
-    invoke-virtual {v2, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
+    invoke-virtual {v2, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
 
     move-object p2, p3
 
@@ -2769,15 +2750,17 @@
     throw p0
 
     :cond_7
-    move v3, p1
+    move v7, p1
 
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    const-string/jumbo p3, "vendor_auth_secret"
+    iget-object p1, p1, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-wide/16 v4, 0x0
+    const-wide/16 v2, 0x0
 
-    invoke-virtual {p1, v3, p3, v4, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    const-string/jumbo p3, "vendor_auth_secret"
+
+    invoke-virtual {p1, v7, p3, v2, v3}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object p1
 
@@ -2814,7 +2797,7 @@
 
     const-string/jumbo p1, "Unable to read vendor auth secret for user: "
 
-    invoke-static {v3, p1, p0}, Lcom/android/server/NandswapManager$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {v7, p1, p0}, Lcom/android/server/NandswapManager$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
 
     return-void
 
@@ -2835,7 +2818,7 @@
 
     const-string/jumbo p3, "Sending vendor auth secret to IAuthSecret HAL as user: "
 
-    invoke-static {v3, p3, p1}, Lcom/android/server/HermesService$3$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {v7, p3, p1}, Lcom/android/server/HermesService$3$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
 
     :try_start_4
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mAuthSecretService:Landroid/hardware/authsecret/IAuthSecret;
@@ -4272,13 +4255,13 @@
 .method public final doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
     .locals 10
 
-    if-eqz p1, :cond_21
+    if-eqz p1, :cond_1d
 
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v0
 
-    if-nez v0, :cond_21
+    if-nez v0, :cond_1d
 
     new-instance v0, Ljava/lang/StringBuilder;
 
@@ -4304,7 +4287,7 @@
 
     const/4 v1, 0x0
 
-    if-eqz v0, :cond_7
+    if-eqz v0, :cond_6
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
 
@@ -4314,7 +4297,7 @@
 
     move-result p4
 
-    if-nez p4, :cond_6
+    if-nez p4, :cond_5
 
     sget-object p4, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
 
@@ -4359,9 +4342,19 @@
 
     move v8, p2
 
-    const-string/jumbo p1, "Sp not yet applied to user "
+    new-instance p1, Ljava/lang/StringBuilder;
+
+    const-string/jumbo p2, "Sp not yet applied to user "
+
+    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {p1, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object p1
 
-    invoke-static {v8, p1, v1}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {v1, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
     move-object p1, v1
 
@@ -4416,52 +4409,11 @@
 
     if-eqz p1, :cond_4
 
-    const-string/jumbo p0, "set Sdp key"
-
-    invoke-static {v1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object p0, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSdpMasterKey()[B
-
-    move-result-object p0
-
-    invoke-virtual {p4, p0}, Lcom/android/internal/widget/VerifyCredentialResponse;->setSecret([B)V
-
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    invoke-virtual {p4}, Lcom/android/internal/widget/VerifyCredentialResponse;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    filled-new-array {p0, p2}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string/jumbo p2, "Result of verification of user %d : %s"
-
-    invoke-static {p2, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_4
-    invoke-virtual {p4}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
-
-    move-result p0
-
-    if-eqz p0, :cond_5
-
-    if-eqz p1, :cond_5
-
     invoke-virtual {v0, v8}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
 
     move-result p0
 
-    if-eqz p0, :cond_5
+    if-eqz p0, :cond_4
 
     iget-object p0, v0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
 
@@ -4473,10 +4425,10 @@
 
     invoke-virtual {p0, p1, v8, p2}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->activateEscrowTokensForDualDAR(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I[B)V
 
-    :cond_5
+    :cond_4
     return-object p4
 
-    :cond_6
+    :cond_5
     new-instance p0, Ljava/lang/IllegalArgumentException;
 
     const-string p1, "Credential can\'t be null or empty"
@@ -4485,7 +4437,7 @@
 
     throw p0
 
-    :cond_7
+    :cond_6
     move-object v6, p1
 
     move v8, p2
@@ -4496,7 +4448,7 @@
 
     const/16 p2, -0x270f
 
-    if-ne v8, p2, :cond_8
+    if-ne v8, p2, :cond_7
 
     iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
@@ -4510,7 +4462,7 @@
 
     move-result p3
 
-    if-eqz p3, :cond_8
+    if-eqz p3, :cond_7
 
     const-string/jumbo p0, "LockSettingsService"
 
@@ -4522,10 +4474,10 @@
 
     return-object p0
 
-    :cond_8
+    :cond_7
     const/16 p3, -0x270e
 
-    if-ne v8, p3, :cond_9
+    if-ne v8, p3, :cond_8
 
     iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
@@ -4533,7 +4485,7 @@
 
     move-result p3
 
-    if-nez p3, :cond_9
+    if-nez p3, :cond_8
 
     const-string/jumbo p0, "LockSettingsService"
 
@@ -4545,7 +4497,7 @@
 
     return-object p0
 
-    :cond_9
+    :cond_8
     const-string/jumbo p3, "LockSettingsService"
 
     const-string/jumbo v0, "Verifying lockscreen credential for user %d"
@@ -4571,7 +4523,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_a
+    if-eqz v0, :cond_9
 
     const-string/jumbo v0, "LockSettingsService"
 
@@ -4608,7 +4560,7 @@
 
     invoke-static {v0, p3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_a
+    :cond_9
     iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     monitor-enter p3
@@ -4618,7 +4570,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_d
+    if-eqz v0, :cond_c
 
     iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
@@ -4634,9 +4586,9 @@
 
     move-result v0
 
-    if-eqz v0, :cond_c
+    if-eqz v0, :cond_b
 
-    if-ne v8, p2, :cond_c
+    if-ne v8, p2, :cond_b
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
@@ -4644,7 +4596,7 @@
 
     move-result-object p0
 
-    if-eqz p0, :cond_b
+    if-eqz p0, :cond_a
 
     check-cast p0, Lcom/android/server/pdb/PersistentDataBlockService$InternalService;
 
@@ -4679,7 +4631,7 @@
     :try_start_3
     throw p0
 
-    :cond_b
+    :cond_a
     const-string/jumbo p0, "LockSettingsStorage"
 
     const-string p1, "Failed to get PersistentDataBlockManagerInternal"
@@ -4693,15 +4645,15 @@
 
     move-object p0, v0
 
-    goto/16 :goto_d
+    goto/16 :goto_c
 
-    :cond_c
+    :cond_b
     :goto_2
     monitor-exit p3
 
     return-object p4
 
-    :cond_d
+    :cond_c
     invoke-virtual {p0, v8}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
     move-result-wide v2
@@ -4712,11 +4664,11 @@
 
     const/4 v0, 0x1
 
-    if-eqz p2, :cond_e
+    if-eqz p2, :cond_d
 
     const/16 p2, -0x26ab
 
-    if-ne v8, p2, :cond_e
+    if-ne v8, p2, :cond_d
 
     const-string/jumbo p2, "LockSettingsService"
 
@@ -4737,7 +4689,7 @@
 
     goto :goto_4
 
-    :cond_e
+    :cond_d
     move p2, p1
 
     move v7, v8
@@ -4763,11 +4715,11 @@
 
     move-result v8
 
-    if-nez v8, :cond_10
+    if-nez v8, :cond_f
 
     and-int/lit8 v8, p4, 0x2
 
-    if-eqz v8, :cond_f
+    if-eqz v8, :cond_e
 
     iget-object v8, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
@@ -4775,7 +4727,7 @@
 
     move-result v4
 
-    if-nez v4, :cond_f
+    if-nez v4, :cond_e
 
     const-string/jumbo p0, "LockSettingsService"
 
@@ -4793,12 +4745,16 @@
 
     return-object p0
 
-    :cond_f
+    :cond_e
     iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mBiometricDeferredQueue:Lcom/android/server/locksettings/BiometricDeferredQueue;
 
     iget-object v5, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    invoke-virtual {v5}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
+    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    sget-object v8, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_GK_AUTH:[B
+
+    invoke-virtual {v5, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
 
     move-result-object v5
 
@@ -4812,7 +4768,7 @@
 
     invoke-virtual {v4, v8}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    :cond_10
+    :cond_f
     monitor-exit p3
     :try_end_3
     .catchall {:try_start_3 .. :try_end_3} :catchall_1
@@ -4821,7 +4777,7 @@
 
     move-result p3
 
-    if-nez p3, :cond_1b
+    if-nez p3, :cond_17
 
     const-string/jumbo p3, "LockSettingsService"
 
@@ -4837,32 +4793,30 @@
 
     invoke-static {p3, v4, v5}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    if-nez p2, :cond_11
+    if-nez p2, :cond_10
 
     invoke-static {v7, p1}, Lcom/samsung/android/lock/LsLog;->setFailureCount(II)V
 
-    :cond_11
+    :cond_10
     iget-object p3, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    if-eqz p2, :cond_12
-
-    move-object p2, v1
+    if-eqz p2, :cond_11
 
     goto :goto_5
 
-    :cond_12
+    :cond_11
     invoke-static {v6}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
 
-    move-result-object p2
+    move-result-object v1
 
     :goto_5
-    invoke-virtual {p0, p3, p2, v7}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
+    invoke-virtual {p0, p3, v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
 
     invoke-virtual {p0, v7}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
 
     move-result p2
 
-    if-eqz p2, :cond_13
+    if-eqz p2, :cond_12
 
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
 
@@ -4870,18 +4824,22 @@
 
     invoke-virtual {v6}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
 
-    move-result-object v4
+    move-result-object v1
 
-    invoke-virtual {p2, p3, v7, v4}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->activateEscrowTokensForDualDAR(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I[B)V
+    invoke-virtual {p2, p3, v7, v1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->activateEscrowTokensForDualDAR(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I[B)V
 
-    :cond_13
+    :cond_12
     and-int/lit8 p2, p4, 0x1
 
-    if-eqz p2, :cond_16
+    if-eqz p2, :cond_15
 
     iget-object p2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    invoke-virtual {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
+    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    sget-object p3, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_GK_AUTH:[B
+
+    invoke-virtual {p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
 
     move-result-object p2
 
@@ -4889,30 +4847,30 @@
 
     monitor-enter p3
 
-    const-wide/16 v3, 0x0
+    const-wide/16 v1, 0x0
 
-    move-wide v8, v3
+    move-wide v3, v1
 
     :goto_6
-    cmp-long p4, v8, v3
+    cmp-long p4, v3, v1
 
-    if-eqz p4, :cond_15
+    if-eqz p4, :cond_14
 
     :try_start_4
     iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mGatekeeperPasswords:Landroid/util/LongSparseArray;
 
-    invoke-virtual {p4, v8, v9}, Landroid/util/LongSparseArray;->get(J)Ljava/lang/Object;
+    invoke-virtual {p4, v3, v4}, Landroid/util/LongSparseArray;->get(J)Ljava/lang/Object;
 
     move-result-object p4
 
-    if-eqz p4, :cond_14
+    if-eqz p4, :cond_13
 
     goto :goto_7
 
-    :cond_14
+    :cond_13
     iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mGatekeeperPasswords:Landroid/util/LongSparseArray;
 
-    invoke-virtual {p4, v8, v9, p2}, Landroid/util/LongSparseArray;->put(JLjava/lang/Object;)V
+    invoke-virtual {p4, v3, v4, p2}, Landroid/util/LongSparseArray;->put(JLjava/lang/Object;)V
 
     monitor-exit p3
     :try_end_4
@@ -4922,17 +4880,17 @@
 
     new-instance p3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda0;
 
-    invoke-direct {p3, p0, v8, v9}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/locksettings/LockSettingsService;J)V
+    invoke-direct {p3, p0, v3, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/locksettings/LockSettingsService;J)V
 
-    const-wide/32 v3, 0x927c0
+    const-wide/32 v1, 0x927c0
 
-    invoke-virtual {p2, p3, v3, v4}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
+    invoke-virtual {p2, p3, v1, v2}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
 
     new-instance p2, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
 
     invoke-direct {p2}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;-><init>()V
 
-    invoke-virtual {p2, v8, v9}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->setGatekeeperPasswordHandle(J)Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
+    invoke-virtual {p2, v3, v4}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->setGatekeeperPasswordHandle(J)Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
 
     move-result-object p2
 
@@ -4949,14 +4907,14 @@
 
     goto :goto_8
 
-    :cond_15
+    :cond_14
     :goto_7
     :try_start_5
     sget-object p4, Lcom/android/server/locksettings/SecureRandomUtils;->RNG:Ljava/security/SecureRandom;
 
     invoke-virtual {p4}, Ljava/security/SecureRandom;->nextLong()J
 
-    move-result-wide v8
+    move-result-wide v3
 
     goto :goto_6
 
@@ -4967,86 +4925,15 @@
 
     throw p0
 
-    :cond_16
+    :cond_15
     :goto_9
-    const-string/jumbo p2, "Result of verification of user %d : %s"
-
-    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p3
-
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->toString()Ljava/lang/String;
-
-    move-result-object p4
-
-    filled-new-array {p3, p4}, [Ljava/lang/Object;
-
-    move-result-object p3
-
-    invoke-static {p2, p3}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-static {v1, p2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    iget-object p3, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    invoke-virtual {p3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSdpMasterKey()[B
-
-    move-result-object p3
-
-    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v7}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result p4
-
-    if-nez p4, :cond_18
-
-    invoke-virtual {p2, v7}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isSdpUser(I)Z
-
-    move-result p4
-
-    if-eqz p4, :cond_18
-
-    const-string/jumbo p4, "unlockSdpOnCredentialVerified."
-
-    invoke-static {v1, p4}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    if-eqz p3, :cond_17
-
-    invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->getSdpManager()Ljava/util/Optional;
-
-    move-result-object p2
-
-    new-instance p4, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;
-
-    const/4 v1, 0x3
-
-    invoke-direct {p4, v7, v1, p3}, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings$$ExternalSyntheticLambda5;-><init>(IILjava/lang/Object;)V
-
-    invoke-virtual {p2, p4}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    goto :goto_a
-
-    :cond_17
-    const-string/jumbo p2, "Unlock SDP on credential verified - Unexpected condition with user "
-
-    const-string/jumbo p3, "LockSettingsService.SDP"
-
-    invoke-static {v7, p2, p3}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    :cond_18
-    :goto_a
     invoke-virtual {p0, v6, v7}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnUnlockIfRequired(Lcom/android/internal/widget/LockscreenCredential;I)V
 
     invoke-static {v7}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
 
     move-result p2
 
-    if-eqz p2, :cond_19
+    if-eqz p2, :cond_16
 
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
@@ -5056,56 +4943,7 @@
 
     invoke-virtual {p2, v7}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->cancelDataLock(I)V
 
-    :cond_19
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    iget-object p3, p2, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Ljava/lang/Object;
-
-    check-cast p3, Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {p3, v7}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result p4
-
-    if-eqz p4, :cond_1a
-
-    const-string/jumbo p4, "ro.product.first_api_level"
-
-    invoke-static {p4, p1}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I
-
-    move-result p4
-
-    const/16 v1, 0x1d
-
-    if-ge p4, v1, :cond_1a
-
-    const-string/jumbo p4, "migrated_password_hash"
-
-    invoke-virtual {p3, p4, p1, v7}, Lcom/android/server/locksettings/LockSettingsService;->getBoolean(Ljava/lang/String;ZI)Z
-
-    move-result v1
-
-    if-nez v1, :cond_1a
-
-    const-string/jumbo v1, "Migrate password hash for enterprise user "
-
-    const-string/jumbo v2, "LockSettingsService.SDP"
-
-    invoke-static {v7, v1, v2}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p3, p4, v0, v7}, Lcom/android/server/locksettings/LockSettingsService;->setBoolean(Ljava/lang/String;ZI)V
-
-    iget-object p3, p3, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
-
-    new-instance p4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;
-
-    const/4 v1, 0x2
-
-    invoke-direct {p4, p2, v6, v7, v1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;-><init>(Ljava/lang/Object;Lcom/android/internal/widget/LockscreenCredential;II)V
-
-    invoke-virtual {p3, p4}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
-
-    :cond_1a
+    :cond_16
     const-string/jumbo p2, "persist.escrowvault.sa.signed"
 
     invoke-static {p2, p1}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z
@@ -5128,24 +4966,24 @@
 
     invoke-static {p4, p3}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    if-eqz p2, :cond_1d
+    if-eqz p2, :cond_19
 
     invoke-virtual {p0, v6, v7}, Lcom/android/server/locksettings/LockSettingsService;->updateVerifier(Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    goto :goto_b
+    goto :goto_a
 
-    :cond_1b
+    :cond_17
     invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
     move-result p2
 
-    if-ne p2, v0, :cond_1d
+    if-ne p2, v0, :cond_19
 
     invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getTimeout()I
 
     move-result p2
 
-    if-lez p2, :cond_1c
+    if-lez p2, :cond_18
 
     const/16 p2, 0x8
 
@@ -5175,36 +5013,36 @@
 
     invoke-static {v7, p3, p2}, Landroid/sec/enterprise/auditlog/AuditLog;->logEventAsUser(II[Ljava/lang/Object;)V
 
-    :cond_1c
+    :cond_18
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mDoVerifySI:Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
+    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mDoVerifySI:Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
 
     invoke-virtual {p2, p3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    :cond_1d
-    :goto_b
+    :cond_19
+    :goto_a
     invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
     move-result p2
 
-    if-nez p2, :cond_1e
+    if-nez p2, :cond_1a
 
     move p1, v0
 
-    :cond_1e
+    :cond_1a
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mLockSettingsStateListeners:Ljava/util/concurrent/CopyOnWriteArrayList;
 
     invoke-virtual {p0}, Ljava/util/concurrent/CopyOnWriteArrayList;->iterator()Ljava/util/Iterator;
 
     move-result-object p0
 
-    :goto_c
+    :goto_b
     invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
 
     move-result p2
 
-    if-eqz p2, :cond_20
+    if-eqz p2, :cond_1c
 
     invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -5212,21 +5050,21 @@
 
     check-cast p2, Lcom/android/internal/widget/LockSettingsStateListener;
 
-    if-eqz p1, :cond_1f
+    if-eqz p1, :cond_1b
 
     invoke-interface {p2, v7}, Lcom/android/internal/widget/LockSettingsStateListener;->onAuthenticationSucceeded(I)V
 
-    goto :goto_c
+    goto :goto_b
 
-    :cond_1f
+    :cond_1b
     invoke-interface {p2, v7}, Lcom/android/internal/widget/LockSettingsStateListener;->onAuthenticationFailed(I)V
 
-    goto :goto_c
+    goto :goto_b
 
-    :cond_20
+    :cond_1c
     return-object v3
 
-    :goto_d
+    :goto_c
     :try_start_6
     monitor-exit p3
     :try_end_6
@@ -5234,7 +5072,7 @@
 
     throw p0
 
-    :cond_21
+    :cond_1d
     new-instance p0, Ljava/lang/IllegalArgumentException;
 
     const-string p1, "Credential can\'t be null or empty"
@@ -5316,63 +5154,57 @@
 
     invoke-virtual/range {v2 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
-    move-result-object v0
+    move-result-object p1
 
-    iget-object v2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    invoke-virtual {v2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    iget-object p2, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    move-result v4
+    invoke-virtual {p2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    if-nez v4, :cond_3
+    move-result v0
 
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mBiometricDeferredQueue:Lcom/android/server/locksettings/BiometricDeferredQueue;
+    if-nez v0, :cond_3
 
-    iget-object v4, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mBiometricDeferredQueue:Lcom/android/server/locksettings/BiometricDeferredQueue;
 
-    invoke-virtual {v4}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
+    iget-object v0, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    move-result-object v4
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    sget-object v2, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_GK_AUTH:[B
 
-    new-instance v5, Lcom/android/server/locksettings/BiometricDeferredQueue$$ExternalSyntheticLambda0;
+    invoke-virtual {v0, v2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
 
-    invoke-direct {v5, v2, p2, v4}, Lcom/android/server/locksettings/BiometricDeferredQueue$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/locksettings/BiometricDeferredQueue;I[B)V
+    move-result-object v0
 
-    iget-object v2, v2, Lcom/android/server/locksettings/BiometricDeferredQueue;->mHandler:Landroid/os/Handler;
+    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {v2, v5}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+    new-instance v2, Lcom/android/server/locksettings/BiometricDeferredQueue$$ExternalSyntheticLambda0;
 
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    invoke-direct {v2, p2, v7, v0}, Lcom/android/server/locksettings/BiometricDeferredQueue$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/locksettings/BiometricDeferredQueue;I[B)V
 
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+    iget-object p2, p2, Lcom/android/server/locksettings/BiometricDeferredQueue;->mHandler:Landroid/os/Handler;
 
-    move-result-object v6
+    invoke-virtual {p2, v2}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    iget-object v4, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {v4}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    move-result-object v7
+    move-result-object v0
 
-    const-wide/16 v4, 0x0
+    iget-object v2, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    move v3, p2
+    invoke-virtual {p2, v0, v2, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallenge(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallengeInternal(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object v2
+    move-result-object p2
 
-    if-eqz v2, :cond_2
+    if-eqz p2, :cond_2
 
-    invoke-virtual {v2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    invoke-virtual {p2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    move-result v4
+    move-result v0
 
-    if-eqz v4, :cond_3
+    if-eqz v0, :cond_3
 
     goto :goto_0
 
@@ -5402,63 +5234,73 @@
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-virtual {v2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    invoke-virtual {p2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    move-result v1
+    move-result v0
 
-    const/4 v4, 0x1
+    const/4 v1, 0x1
 
-    if-nez v1, :cond_8
+    if-nez v0, :cond_8
 
-    const-string/jumbo v1, "LockSettingsService"
+    const-string/jumbo v0, "LockSettingsService"
 
-    const-string/jumbo v5, "Successfully verified lockscreen credential for user %d"
+    const-string/jumbo v2, "Successfully verified lockscreen credential for user %d"
 
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v6
+    move-result-object v3
 
-    filled-new-array {v6}, [Ljava/lang/Object;
+    filled-new-array {v3}, [Ljava/lang/Object;
 
-    move-result-object v6
+    move-result-object v3
 
-    invoke-static {v1, v5, v6}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v0, v2, v3}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    and-int/2addr p3, v4
+    and-int/2addr p3, v1
 
     if-eqz p3, :cond_6
 
-    iget-object p3, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    iget-object p1, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    invoke-static {p1}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
+    invoke-static {v6}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
 
-    move-result-object v0
+    move-result-object p3
 
-    if-nez p3, :cond_4
+    if-nez p1, :cond_4
 
-    goto :goto_2
+    goto/16 :goto_2
 
     :cond_4
+    new-instance v0, Ljava/lang/StringBuilder;
+
     const-string/jumbo v1, "Postpone credential verified event for user "
 
-    const/4 v4, 0x0
+    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-static {p2, v1, v4}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-virtual {v0, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    monitor-enter v1
+    move-result-object v0
+
+    const/4 v1, 0x0
+
+    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
+
+    monitor-enter v2
 
     :try_start_1
-    new-instance v5, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;
+    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;
 
-    invoke-direct {v5}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;-><init>()V
+    invoke-direct {v0}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;-><init>()V
 
-    iput-object p4, v5, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->mCallback:Ljava/lang/Object;
+    iput-object p4, v0, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->mCallback:Ljava/lang/Object;
 
     if-nez p4, :cond_5
 
-    move-object p4, v4
+    move-object p4, v1
 
     goto :goto_1
 
@@ -5472,63 +5314,63 @@
 
     move-result-object p4
 
-    new-instance v6, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback$$ExternalSyntheticLambda0;
+    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback$$ExternalSyntheticLambda0;
 
-    const/4 v7, 0x0
+    const/4 v4, 0x0
 
-    invoke-direct {v6, v5, v7}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;I)V
+    invoke-direct {v3, v0, v4}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;I)V
 
-    invoke-virtual {p4, v6}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
+    invoke-virtual {p4, v3}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
 
     new-instance p4, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;
 
-    invoke-direct {p4, p3, v0, v5}, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;-><init>(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;)V
+    invoke-direct {p4, p1, p3, v0}, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;-><init>(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;)V
 
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
+    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mPendingVerifiedResults:Landroid/util/SparseArray;
 
-    invoke-virtual {p3, p2, p4}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
+    invoke-virtual {p1, v7, p4}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
 
-    monitor-exit v1
+    monitor-exit v2
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_1
 
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
+    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
 
-    invoke-virtual {p3, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getInnerAuthUserId(I)I
+    invoke-virtual {p1, v7}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getInnerAuthUserId(I)I
 
-    move-result p3
+    move-result p1
 
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
+    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
 
-    move-result p4
+    move-result p3
 
-    if-nez p4, :cond_7
+    if-nez p3, :cond_7
 
-    new-instance p4, Ljava/lang/StringBuilder;
+    new-instance p3, Ljava/lang/StringBuilder;
 
-    const-string v0, "Auth user "
+    const-string p4, "Auth user "
 
-    invoke-direct {p4, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {p3, p4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {p4, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {p3, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v0, " has no credential"
+    const-string p4, " has no credential"
 
-    invoke-virtual {p4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {p3, p4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {p4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {p3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object p4
+    move-result-object p3
 
-    invoke-static {v4, p4}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v1, p3}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
+    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
 
     invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
 
-    move-result-object v0
+    move-result-object p4
 
-    invoke-virtual {p4, v0, p3}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->onCredentialVerifiedForInner(Lcom/android/internal/widget/LockscreenCredential;I)Z
+    invoke-virtual {p3, p4, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->onCredentialVerifiedForInner(Lcom/android/internal/widget/LockscreenCredential;I)Z
 
     goto :goto_2
 
@@ -5538,26 +5380,26 @@
     move-object p0, v0
 
     :try_start_2
-    monitor-exit v1
+    monitor-exit v2
     :try_end_2
     .catchall {:try_start_2 .. :try_end_2} :catchall_1
 
     throw p0
 
     :cond_6
-    iget-object p3, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    iget-object p1, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    invoke-static {p1}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
+    invoke-static {v6}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
 
-    move-result-object p4
+    move-result-object p3
 
-    invoke-virtual {p0, p3, p4, p2}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
+    invoke-virtual {p0, p1, p3, v7}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
 
     :cond_7
     :goto_2
-    invoke-virtual/range {p0 .. p2}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnUnlockIfRequired(Lcom/android/internal/widget/LockscreenCredential;I)V
+    invoke-virtual {p0, v6, v7}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnUnlockIfRequired(Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    invoke-static {p2}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
+    invoke-static {v7}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
 
     move-result p1
 
@@ -5569,18 +5411,18 @@
 
     move-result-object p0
 
-    invoke-virtual {p0, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->cancelDataLock(I)V
+    invoke-virtual {p0, v7}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->cancelDataLock(I)V
 
-    return-object v2
+    return-object p2
 
     :cond_8
-    invoke-virtual {v2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    invoke-virtual {p2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
     move-result p1
 
-    if-ne p1, v4, :cond_9
+    if-ne p1, v1, :cond_9
 
-    invoke-virtual {v2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getTimeout()I
+    invoke-virtual {p2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getTimeout()I
 
     move-result p1
 
@@ -5588,10 +5430,10 @@
 
     const/16 p1, 0x8
 
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->requireStrongAuth(II)V
+    invoke-virtual {p0, p1, v7}, Lcom/android/server/locksettings/LockSettingsService;->requireStrongAuth(II)V
 
     :cond_9
-    return-object v2
+    return-object p2
 
     :goto_3
     :try_start_3
@@ -5649,1400 +5491,1397 @@
 .end method
 
 .method public final dumpInternal(Ljava/io/PrintWriter;)V
-    .locals 14
-
-    new-instance v0, Lcom/android/internal/util/IndentingPrintWriter;
-
-    const-string v1, "  "
-
-    invoke-direct {v0, p1, v1}, Lcom/android/internal/util/IndentingPrintWriter;-><init>(Ljava/io/Writer;Ljava/lang/String;)V
-
-    const-string p1, "Current lock settings service state:"
-
-    invoke-virtual {v0, p1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
-
-    const/4 p1, 0x0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isDeviceOwner(I)Z
-
-    move-result v1
+    .locals 17
 
-    new-instance v2, Ljava/lang/StringBuilder;
+    move-object/from16 v1, p0
 
-    const-string v3, "DO Enabled: "
+    new-instance v2, Lcom/android/internal/util/IndentingPrintWriter;
 
-    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    const-string v0, "  "
 
-    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    move-object/from16 v3, p1
 
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-direct {v2, v3, v0}, Lcom/android/internal/util/IndentingPrintWriter;-><init>(Ljava/io/Writer;Ljava/lang/String;)V
 
-    move-result-object v2
+    const-string v0, "Current lock settings service state:"
 
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    const-wide/16 v2, 0x0
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
-    if-eqz v1, :cond_1
+    const-string/jumbo v0, "knox.device_owner"
 
-    const-string/jumbo v1, "sdp-mdfppmode-for-system"
+    const-wide/16 v3, 0x0
 
-    invoke-virtual {p0, v1, v2, v3, p1}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+    const/4 v5, 0x0
 
-    move-result-wide v4
+    invoke-virtual {v1, v0, v3, v4, v5}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
-    const-wide/16 v6, 0x1
+    move-result-wide v6
 
-    cmp-long v1, v4, v6
+    cmp-long v0, v6, v3
 
-    if-nez v1, :cond_0
+    const/4 v6, 0x1
 
-    const-string/jumbo v1, "SdpMdfppMode for System Applied: NeedToEnableSdpMdfppMode"
+    if-eqz v0, :cond_0
 
-    invoke-virtual {v0, v1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    move v0, v6
 
     goto :goto_0
 
     :cond_0
-    const-string/jumbo v1, "sdp-mdfppmode-for-system"
+    move v0, v5
 
-    invoke-virtual {p0, v1, v2, v3, p1}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+    :goto_0
+    new-instance v7, Ljava/lang/StringBuilder;
 
-    move-result-wide v4
+    const-string v8, "DO Enabled: "
 
-    const-wide/16 v6, 0x2
+    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    cmp-long v1, v4, v6
+    invoke-virtual {v7, v0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    if-ltz v1, :cond_1
+    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    const-string/jumbo v1, "SdpMdfppMode for System Applied: SdpMdfppModeEnabledForSystem"
+    move-result-object v0
 
-    invoke-virtual {v0, v1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    :cond_1
-    :goto_0
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
-    const-string/jumbo v1, "User State:"
+    const-string/jumbo v0, "User State:"
 
-    invoke-virtual {v0, v1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
+    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
-    invoke-virtual {v1}, Landroid/os/UserManager;->getUsers()Ljava/util/List;
+    invoke-virtual {v0}, Landroid/os/UserManager;->getUsers()Ljava/util/List;
 
-    move-result-object v1
+    move-result-object v0
 
-    move v4, p1
+    move v7, v5
 
     :goto_1
-    invoke-interface {v1}, Ljava/util/List;->size()I
+    invoke-interface {v0}, Ljava/util/List;->size()I
 
-    move-result v5
+    move-result v8
 
-    if-ge v4, v5, :cond_6
+    if-ge v7, v8, :cond_6
 
-    invoke-interface {v1, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;
+    invoke-interface {v0, v7}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v8
 
-    check-cast v5, Landroid/content/pm/UserInfo;
+    check-cast v8, Landroid/content/pm/UserInfo;
 
-    iget v5, v5, Landroid/content/pm/UserInfo;->id:I
+    iget v8, v8, Landroid/content/pm/UserInfo;->id:I
 
-    new-instance v6, Ljava/lang/StringBuilder;
+    new-instance v9, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v7, "User "
+    const-string/jumbo v10, "User "
 
-    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v9, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v9, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v9
 
-    invoke-virtual {v0, v6}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v9}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    iget-object v6, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v9, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    monitor-enter v6
+    monitor-enter v9
 
     :try_start_0
-    const-string v7, "LSKF-based SP protector ID: %016x"
+    const-string v10, "LSKF-based SP protector ID: %016x"
 
-    invoke-virtual {p0, v5}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
+    invoke-virtual {v1, v8}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
-    move-result-wide v8
+    move-result-wide v11
 
-    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    move-result-object v8
+    move-result-object v11
 
-    filled-new-array {v8}, [Ljava/lang/Object;
+    filled-new-array {v11}, [Ljava/lang/Object;
 
-    move-result-object v8
+    move-result-object v11
 
-    invoke-static {v7, v8}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v10, v11}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v7
+    move-result-object v10
 
-    invoke-virtual {v0, v7}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v10}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    const-string v7, "LSKF last changed: %s (previous protector: %016x)"
+    const-string v10, "LSKF last changed: %s (previous protector: %016x)"
 
-    const-string/jumbo v8, "sp-handle-ts"
+    const-string/jumbo v11, "sp-handle-ts"
 
-    invoke-virtual {p0, v8, v2, v3, v5}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+    invoke-virtual {v1, v11, v3, v4, v8}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
-    move-result-wide v8
+    move-result-wide v11
 
-    invoke-static {v8, v9}, Lcom/android/server/locksettings/LockSettingsService;->timestampToString(J)Ljava/lang/String;
+    invoke-static {v11, v12}, Lcom/android/server/locksettings/LockSettingsService;->timestampToString(J)Ljava/lang/String;
 
-    move-result-object v8
+    move-result-object v11
 
-    const-string/jumbo v9, "prev-sp-handle"
+    const-string/jumbo v12, "prev-sp-handle"
 
-    invoke-virtual {p0, v9, v2, v3, v5}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+    invoke-virtual {v1, v12, v3, v4, v8}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
-    move-result-wide v9
+    move-result-wide v12
 
-    invoke-static {v9, v10}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {v12, v13}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    move-result-object v9
+    move-result-object v12
 
-    filled-new-array {v8, v9}, [Ljava/lang/Object;
+    filled-new-array {v11, v12}, [Ljava/lang/Object;
 
-    move-result-object v8
+    move-result-object v11
 
-    invoke-static {v7, v8}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v10, v11}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v7
+    move-result-object v10
 
-    invoke-virtual {v0, v7}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v10}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    if-nez v5, :cond_2
+    if-nez v8, :cond_1
 
-    const-string v7, "Backup protector: %016x (set : %s, expire : %s)"
+    const-string v10, "Backup protector: %016x (set : %s, expire : %s)"
 
-    const-string/jumbo v8, "backup-protector-id"
+    const-string/jumbo v11, "backup-protector-id"
 
-    invoke-virtual {p0, v8, v2, v3, v5}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+    invoke-virtual {v1, v11, v3, v4, v8}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
-    move-result-wide v8
+    move-result-wide v11
 
-    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    move-result-object v8
+    move-result-object v11
 
-    const-string/jumbo v9, "backup-protector-ts"
+    const-string/jumbo v12, "backup-protector-ts"
 
-    invoke-virtual {p0, v9, v2, v3, v5}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+    invoke-virtual {v1, v12, v3, v4, v8}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
-    move-result-wide v9
+    move-result-wide v12
 
-    invoke-static {v9, v10}, Lcom/android/server/locksettings/LockSettingsService;->timestampToString(J)Ljava/lang/String;
+    invoke-static {v12, v13}, Lcom/android/server/locksettings/LockSettingsService;->timestampToString(J)Ljava/lang/String;
 
-    move-result-object v9
+    move-result-object v12
 
-    const-string/jumbo v10, "backup-expiration-ts"
+    const-string/jumbo v13, "backup-expiration-ts"
 
-    invoke-virtual {p0, v10, v2, v3, v5}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+    invoke-virtual {v1, v13, v3, v4, v8}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
-    move-result-wide v10
+    move-result-wide v13
 
-    invoke-static {v10, v11}, Lcom/android/server/locksettings/LockSettingsService;->timestampToString(J)Ljava/lang/String;
+    invoke-static {v13, v14}, Lcom/android/server/locksettings/LockSettingsService;->timestampToString(J)Ljava/lang/String;
 
-    move-result-object v10
+    move-result-object v13
 
-    filled-new-array {v8, v9, v10}, [Ljava/lang/Object;
+    filled-new-array {v11, v12, v13}, [Ljava/lang/Object;
 
-    move-result-object v8
+    move-result-object v11
 
-    invoke-static {v7, v8}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v10, v11}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v7
+    move-result-object v10
 
-    invoke-virtual {v0, v7}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v10}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
     goto :goto_2
 
     :catchall_0
-    move-exception p0
+    move-exception v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
-    :cond_2
+    :cond_1
     :goto_2
-    if-nez v5, :cond_3
+    if-nez v8, :cond_2
 
-    const-string/jumbo v7, "SI Checker: %016x (For %016x)"
+    const-string/jumbo v10, "SI Checker: %016x (For %016x)"
 
-    invoke-virtual {p0, v5}, Lcom/android/server/locksettings/LockSettingsService;->getSICheckerId(I)J
+    invoke-virtual {v1, v8}, Lcom/android/server/locksettings/LockSettingsService;->getSICheckerId(I)J
 
-    move-result-wide v8
+    move-result-wide v11
 
-    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    move-result-object v8
+    move-result-object v11
 
-    const-string/jumbo v9, "locksettings_si_protector_id"
+    const-string/jumbo v12, "locksettings_si_protector_id"
 
-    invoke-virtual {p0, v9, v2, v3, v5}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
+    invoke-virtual {v1, v12, v3, v4, v8}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
-    move-result-wide v9
+    move-result-wide v12
 
-    invoke-static {v9, v10}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {v12, v13}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    move-result-object v9
+    move-result-object v12
 
-    filled-new-array {v8, v9}, [Ljava/lang/Object;
+    filled-new-array {v11, v12}, [Ljava/lang/Object;
 
-    move-result-object v8
+    move-result-object v11
 
-    invoke-static {v7, v8}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v10, v11}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v7
+    move-result-object v10
 
-    invoke-virtual {v0, v7}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v10}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    :cond_3
-    monitor-exit v6
+    :cond_2
+    monitor-exit v9
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    const-string/jumbo v6, "Secure Mode: %d"
+    const-string/jumbo v9, "Secure Mode: %d"
 
-    iget-object v7, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
+    iget-object v10, v1, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
 
-    invoke-virtual {v7, v5}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->getSecureMode(I)I
+    invoke-virtual {v10, v8}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->getSecureMode(I)I
 
-    move-result v7
+    move-result v10
 
-    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v7
+    move-result-object v10
 
-    filled-new-array {v7}, [Ljava/lang/Object;
+    filled-new-array {v10}, [Ljava/lang/Object;
 
-    move-result-object v7
+    move-result-object v10
 
-    invoke-static {v6, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v9, v10}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v9
 
-    invoke-virtual {v0, v6}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v9}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
     :try_start_1
-    const-string/jumbo v6, "SID: %016x"
+    const-string/jumbo v9, "SID: %016x"
 
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+    invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    move-result-object v7
+    move-result-object v10
 
-    invoke-interface {v7, v5}, Landroid/service/gatekeeper/IGateKeeperService;->getSecureUserId(I)J
+    invoke-interface {v10, v8}, Landroid/service/gatekeeper/IGateKeeperService;->getSecureUserId(I)J
 
-    move-result-wide v7
+    move-result-wide v10
 
-    invoke-static {v7, v8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {v10, v11}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    move-result-object v7
+    move-result-object v10
 
-    filled-new-array {v7}, [Ljava/lang/Object;
+    filled-new-array {v10}, [Ljava/lang/Object;
 
-    move-result-object v7
+    move-result-object v10
 
-    invoke-static {v6, v7}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v9, v10}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v9
 
-    invoke-virtual {v0, v6}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v9}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
     :try_end_1
     .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0
 
     :catch_0
-    new-instance v6, Ljava/lang/StringBuilder;
+    new-instance v9, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v7, "Quality: "
+    const-string/jumbo v10, "Quality: "
 
-    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v9, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget-object v7, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    iget-object v10, v1, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string/jumbo v8, "lockscreen.password_type"
+    const/4 v11, 0x0
 
-    invoke-virtual {v7, v8, v2, v3, v5}, Lcom/android/server/locksettings/LockSettingsStorage;->getLong(Ljava/lang/String;JI)J
+    const-string/jumbo v12, "lockscreen.password_type"
 
-    move-result-wide v7
+    invoke-virtual {v10, v12, v11, v8}, Lcom/android/server/locksettings/LockSettingsStorage;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
 
-    long-to-int v7, v7
+    move-result-object v10
 
-    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-static {v10}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
 
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    move-result v11
 
-    move-result-object v6
+    if-eqz v11, :cond_3
 
-    invoke-virtual {v0, v6}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    move-wide v10, v3
 
-    invoke-virtual {p0, v5}, Lcom/android/server/locksettings/LockSettingsService;->getCredentialTypeInternal(I)I
+    goto :goto_3
 
-    move-result v6
+    :cond_3
+    invoke-static {v10}, Ljava/lang/Long;->parseLong(Ljava/lang/String;)J
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    move-result-wide v10
 
-    const-string v8, "CredentialType: "
+    :goto_3
+    long-to-int v10, v10
 
-    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-static {v6}, Lcom/android/internal/widget/LockPatternUtils;->credentialTypeToString(I)Ljava/lang/String;
+    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v8
+    move-result-object v9
 
-    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v9}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v1, v8}, Lcom/android/server/locksettings/LockSettingsService;->getCredentialTypeInternal(I)I
 
-    move-result-object v7
+    move-result v9
 
-    invoke-virtual {v0, v7}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    new-instance v10, Ljava/lang/StringBuilder;
 
-    const/4 v7, -0x1
+    const-string v11, "CredentialType: "
 
-    if-ne v6, v7, :cond_4
+    invoke-direct {v10, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    new-instance v6, Ljava/lang/StringBuilder;
+    invoke-static {v9}, Lcom/android/internal/widget/LockPatternUtils;->credentialTypeToString(I)Ljava/lang/String;
 
-    const-string v7, "IsLockScreenDisabled: "
+    move-result-object v11
 
-    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string/jumbo v7, "lockscreen.disabled"
+    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-virtual {p0, v7, p1, v5}, Lcom/android/server/locksettings/LockSettingsService;->getBoolean(Ljava/lang/String;ZI)Z
+    move-result-object v10
 
-    move-result v7
+    invoke-virtual {v2, v10}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    const/4 v10, -0x1
 
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    if-ne v9, v10, :cond_4
 
-    move-result-object v6
+    new-instance v9, Ljava/lang/StringBuilder;
+
+    const-string v10, "IsLockScreenDisabled: "
+
+    invoke-direct {v9, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    const-string/jumbo v10, "lockscreen.disabled"
+
+    invoke-virtual {v1, v10, v5, v8}, Lcom/android/server/locksettings/LockSettingsService;->getBoolean(Ljava/lang/String;ZI)Z
+
+    move-result v10
+
+    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v0, v6}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v9
+
+    invoke-virtual {v2, v9}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
     :cond_4
-    new-instance v6, Ljava/lang/StringBuilder;
+    new-instance v9, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v7, "SeparateChallenge: "
+    const-string/jumbo v10, "SeparateChallenge: "
 
-    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v9, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {p0, v5}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
+    invoke-virtual {v1, v8}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
 
-    move-result v7
+    move-result v10
 
-    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v9
 
-    invoke-virtual {v0, v6}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v9}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    const-string/jumbo v6, "Metrics: %s"
+    const-string/jumbo v9, "Metrics: %s"
 
-    invoke-virtual {p0, v5}, Lcom/android/server/locksettings/LockSettingsService;->getUserPasswordMetrics(I)Landroid/app/admin/PasswordMetrics;
+    invoke-virtual {v1, v8}, Lcom/android/server/locksettings/LockSettingsService;->getUserPasswordMetrics(I)Landroid/app/admin/PasswordMetrics;
 
-    move-result-object v7
+    move-result-object v10
 
-    if-eqz v7, :cond_5
+    if-eqz v10, :cond_5
 
-    const-string/jumbo v7, "known"
+    const-string/jumbo v10, "known"
 
-    goto :goto_3
+    goto :goto_4
 
     :cond_5
-    const-string/jumbo v7, "unknown"
+    const-string/jumbo v10, "unknown"
 
-    :goto_3
-    filled-new-array {v7}, [Ljava/lang/Object;
+    :goto_4
+    filled-new-array {v10}, [Ljava/lang/Object;
 
-    move-result-object v7
+    move-result-object v10
 
-    invoke-static {v6, v7}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v9, v10}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v9
 
-    invoke-virtual {v0, v6}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v9}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    new-instance v6, Ljava/lang/StringBuilder;
+    new-instance v9, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v7, "failed attempt = "
+    const-string/jumbo v10, "failed attempt = "
 
-    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v9, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget-object v7, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
+    iget-object v10, v1, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
-    invoke-virtual {v7}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
+    invoke-virtual {v10}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
 
-    move-result-object v7
+    move-result-object v10
 
-    invoke-virtual {v7, v5}, Landroid/app/admin/DevicePolicyManager;->getCurrentFailedPasswordAttempts(I)I
+    invoke-virtual {v10, v8}, Landroid/app/admin/DevicePolicyManager;->getCurrentFailedPasswordAttempts(I)I
 
-    move-result v5
+    move-result v8
 
-    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v9, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v8
 
-    invoke-virtual {v0, v5}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v8}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    add-int/lit8 v4, v4, 0x1
+    add-int/lit8 v7, v7, 0x1
 
     goto/16 :goto_1
 
-    :goto_4
+    :goto_5
     :try_start_2
-    monitor-exit v6
+    monitor-exit v9
     :try_end_2
     .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    throw p0
+    throw v0
 
     :cond_6
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    const-string v1, "Keys in namespace:"
+    const-string v0, "Keys in namespace:"
 
-    invoke-virtual {v0, v1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
     :try_start_3
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mKeyStore:Ljava/security/KeyStore;
+    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mKeyStore:Ljava/security/KeyStore;
 
-    invoke-virtual {v1}, Ljava/security/KeyStore;->aliases()Ljava/util/Enumeration;
+    invoke-virtual {v0}, Ljava/security/KeyStore;->aliases()Ljava/util/Enumeration;
 
-    move-result-object v1
+    move-result-object v0
 
-    :goto_5
-    invoke-interface {v1}, Ljava/util/Enumeration;->hasMoreElements()Z
+    :goto_6
+    invoke-interface {v0}, Ljava/util/Enumeration;->hasMoreElements()Z
 
-    move-result v4
+    move-result v7
 
-    if-eqz v4, :cond_7
+    if-eqz v7, :cond_7
 
-    invoke-interface {v1}, Ljava/util/Enumeration;->nextElement()Ljava/lang/Object;
+    invoke-interface {v0}, Ljava/util/Enumeration;->nextElement()Ljava/lang/Object;
 
-    move-result-object v4
+    move-result-object v7
 
-    check-cast v4, Ljava/lang/String;
+    check-cast v7, Ljava/lang/String;
 
-    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v7}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
     :try_end_3
     .catch Ljava/security/KeyStoreException; {:try_start_3 .. :try_end_3} :catch_1
 
-    goto :goto_5
+    goto :goto_6
 
     :catch_1
-    move-exception v1
+    move-exception v0
 
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v7, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v5, "Unable to get keys: "
+    const-string/jumbo v8, "Unable to get keys: "
 
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v1}, Ljava/security/KeyStoreException;->toString()Ljava/lang/String;
+    invoke-virtual {v0}, Ljava/security/KeyStoreException;->toString()Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v8
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v7
 
-    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v7}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    const-string/jumbo v4, "LockSettingsService"
+    const-string/jumbo v7, "LockSettingsService"
 
-    const-string v5, "Dump error"
+    const-string v8, "Dump error"
 
-    invoke-static {v4, v5, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    invoke-static {v7, v8, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
     :cond_7
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    const-string/jumbo v1, "Storage:"
+    const-string/jumbo v0, "Storage:"
 
-    invoke-virtual {v0, v1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    iget-object v4, v1, Lcom/android/server/locksettings/LockSettingsStorage;->mContext:Landroid/content/Context;
+    iget-object v7, v0, Lcom/android/server/locksettings/LockSettingsStorage;->mContext:Landroid/content/Context;
 
-    invoke-static {v4}, Landroid/os/UserManager;->get(Landroid/content/Context;)Landroid/os/UserManager;
+    invoke-static {v7}, Landroid/os/UserManager;->get(Landroid/content/Context;)Landroid/os/UserManager;
 
-    move-result-object v4
+    move-result-object v7
 
-    invoke-virtual {v4}, Landroid/os/UserManager;->getUsers()Ljava/util/List;
+    invoke-virtual {v7}, Landroid/os/UserManager;->getUsers()Ljava/util/List;
 
-    move-result-object v4
+    move-result-object v7
 
-    invoke-interface {v4}, Ljava/util/List;->iterator()Ljava/util/Iterator;
+    invoke-interface {v7}, Ljava/util/List;->iterator()Ljava/util/Iterator;
 
-    move-result-object v4
+    move-result-object v7
 
-    :goto_6
-    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z
+    :goto_7
+    invoke-interface {v7}, Ljava/util/Iterator;->hasNext()Z
 
-    move-result v5
+    move-result v8
 
-    const-string v6, "%6d %s %s"
+    const-string v9, "%6d %s %s"
 
-    if-eqz v5, :cond_a
+    if-eqz v8, :cond_a
 
-    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+    invoke-interface {v7}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v8
 
-    check-cast v5, Landroid/content/pm/UserInfo;
+    check-cast v8, Landroid/content/pm/UserInfo;
 
-    iget v7, v5, Landroid/content/pm/UserInfo;->id:I
+    iget v10, v8, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsStorage;->getSyntheticPasswordDirectoryForUser(I)Ljava/io/File;
+    invoke-virtual {v0, v10}, Lcom/android/server/locksettings/LockSettingsStorage;->getSyntheticPasswordDirectoryForUser(I)Ljava/io/File;
 
-    move-result-object v7
+    move-result-object v10
 
-    iget v8, v5, Landroid/content/pm/UserInfo;->id:I
+    iget v11, v8, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v8
+    move-result-object v11
 
-    filled-new-array {v8, v7}, [Ljava/lang/Object;
+    filled-new-array {v11, v10}, [Ljava/lang/Object;
 
-    move-result-object v8
+    move-result-object v11
 
-    const-string/jumbo v9, "User %d [%s]:"
+    const-string/jumbo v12, "User %d [%s]:"
 
-    invoke-static {v9, v8}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v12, v11}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v8
+    move-result-object v11
 
-    invoke-virtual {v0, v8}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v11}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    invoke-virtual {v7}, Ljava/io/File;->listFiles()[Ljava/io/File;
+    invoke-virtual {v10}, Ljava/io/File;->listFiles()[Ljava/io/File;
 
-    move-result-object v7
+    move-result-object v10
 
-    if-eqz v7, :cond_8
+    if-eqz v10, :cond_8
 
-    invoke-static {v7}, Ljava/util/Arrays;->sort([Ljava/lang/Object;)V
+    invoke-static {v10}, Ljava/util/Arrays;->sort([Ljava/lang/Object;)V
 
-    array-length v8, v7
+    array-length v11, v10
 
-    move v9, p1
+    move v12, v5
 
-    :goto_7
-    if-ge v9, v8, :cond_9
+    :goto_8
+    if-ge v12, v11, :cond_9
 
-    aget-object v10, v7, v9
+    aget-object v13, v10, v12
 
-    invoke-virtual {v10}, Ljava/io/File;->length()J
+    invoke-virtual {v13}, Ljava/io/File;->length()J
 
-    move-result-wide v11
+    move-result-wide v14
 
-    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {v14, v15}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    move-result-object v11
+    move-result-object v14
 
-    invoke-virtual {v10}, Ljava/io/File;->lastModified()J
+    invoke-virtual {v13}, Ljava/io/File;->lastModified()J
 
-    move-result-wide v12
+    move-result-wide v15
 
-    invoke-static {v12, v13}, Lcom/android/server/locksettings/LockSettingsService;->timestampToString(J)Ljava/lang/String;
+    invoke-static/range {v15 .. v16}, Lcom/android/server/locksettings/LockSettingsService;->timestampToString(J)Ljava/lang/String;
 
-    move-result-object v12
+    move-result-object v15
 
-    invoke-virtual {v10}, Ljava/io/File;->getName()Ljava/lang/String;
+    invoke-virtual {v13}, Ljava/io/File;->getName()Ljava/lang/String;
 
-    move-result-object v10
+    move-result-object v13
 
-    filled-new-array {v11, v12, v10}, [Ljava/lang/Object;
+    filled-new-array {v14, v15, v13}, [Ljava/lang/Object;
 
-    move-result-object v10
+    move-result-object v13
 
-    invoke-static {v6, v10}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v9, v13}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v10
+    move-result-object v13
 
-    invoke-virtual {v0, v10}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v13}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    add-int/lit8 v9, v9, 0x1
+    add-int/lit8 v12, v12, 0x1
 
-    goto :goto_7
+    goto :goto_8
 
     :cond_8
-    const-string/jumbo v6, "[Not found]"
+    const-string/jumbo v9, "[Not found]"
 
-    invoke-virtual {v0, v6}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v9}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
     :cond_9
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    iget v5, v5, Landroid/content/pm/UserInfo;->id:I
+    iget v8, v8, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-static {v0, v5}, Lcom/samsung/android/lock/SPBnRManager;->dump(Lcom/android/internal/util/IndentingPrintWriter;I)V
+    invoke-static {v2, v8}, Lcom/samsung/android/lock/SPBnRManager;->dump(Lcom/android/internal/util/IndentingPrintWriter;I)V
 
-    goto :goto_6
+    goto :goto_7
 
     :cond_a
-    invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsStorage;->getRepairModePersistentDataFile()Ljava/io/File;
+    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsStorage;->getRepairModePersistentDataFile()Ljava/io/File;
 
-    move-result-object v4
+    move-result-object v7
 
-    invoke-virtual {v4}, Ljava/io/File;->exists()Z
+    invoke-virtual {v7}, Ljava/io/File;->exists()Z
 
-    move-result v5
+    move-result v8
 
-    if-eqz v5, :cond_d
+    if-eqz v8, :cond_d
 
-    invoke-virtual {v4}, Ljava/io/File;->getParent()Ljava/lang/String;
+    invoke-virtual {v7}, Ljava/io/File;->getParent()Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v8
 
-    filled-new-array {v5}, [Ljava/lang/Object;
+    filled-new-array {v8}, [Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v8
 
-    const-string/jumbo v7, "Repair Mode [%s]:"
+    const-string/jumbo v10, "Repair Mode [%s]:"
 
-    invoke-static {v7, v5}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v10, v8}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v8
 
-    invoke-virtual {v0, v5}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v8}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    invoke-virtual {v4}, Ljava/io/File;->length()J
+    invoke-virtual {v7}, Ljava/io/File;->length()J
 
-    move-result-wide v7
+    move-result-wide v10
 
-    invoke-static {v7, v8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {v10, v11}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    move-result-object v5
+    move-result-object v8
 
-    invoke-virtual {v4}, Ljava/io/File;->lastModified()J
+    invoke-virtual {v7}, Ljava/io/File;->lastModified()J
 
-    move-result-wide v7
+    move-result-wide v10
 
-    invoke-static {v7, v8}, Lcom/android/server/locksettings/LockSettingsService;->timestampToString(J)Ljava/lang/String;
+    invoke-static {v10, v11}, Lcom/android/server/locksettings/LockSettingsService;->timestampToString(J)Ljava/lang/String;
 
-    move-result-object v7
+    move-result-object v10
 
-    invoke-virtual {v4}, Ljava/io/File;->getName()Ljava/lang/String;
+    invoke-virtual {v7}, Ljava/io/File;->getName()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v7
 
-    filled-new-array {v5, v7, v4}, [Ljava/lang/Object;
+    filled-new-array {v8, v10, v7}, [Ljava/lang/Object;
 
-    move-result-object v4
+    move-result-object v7
 
-    invoke-static {v6, v4}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v9, v7}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v7
 
-    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v7}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsStorage;->getRepairModePersistentDataFile()Ljava/io/File;
+    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsStorage;->getRepairModePersistentDataFile()Ljava/io/File;
 
-    move-result-object v4
+    move-result-object v7
 
-    invoke-virtual {v1, v4}, Lcom/android/server/locksettings/LockSettingsStorage;->readFile(Ljava/io/File;)[B
+    invoke-virtual {v0, v7}, Lcom/android/server/locksettings/LockSettingsStorage;->readFile(Ljava/io/File;)[B
 
-    move-result-object v1
+    move-result-object v0
 
-    if-nez v1, :cond_b
+    if-nez v0, :cond_b
 
-    sget-object v1, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->NONE:Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;
+    sget-object v0, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->NONE:Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;
 
-    goto :goto_8
+    goto :goto_9
 
     :cond_b
-    invoke-static {v1}, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->fromBytes([B)Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;
+    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->fromBytes([B)Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;
 
-    move-result-object v1
+    move-result-object v0
 
-    :goto_8
-    iget v4, v1, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->type:I
+    :goto_9
+    iget v7, v0, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->type:I
 
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v4
+    move-result-object v7
 
-    iget v5, v1, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->userId:I
+    iget v8, v0, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->userId:I
 
-    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v5
+    move-result-object v8
 
-    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->payload:[B
+    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->payload:[B
 
-    if-eqz v1, :cond_c
+    if-eqz v0, :cond_c
 
-    array-length v1, v1
+    array-length v0, v0
 
-    goto :goto_9
+    goto :goto_a
 
     :cond_c
-    move v1, p1
+    move v0, v5
 
-    :goto_9
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    :goto_a
+    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v1
+    move-result-object v0
 
-    filled-new-array {v4, v5, v1}, [Ljava/lang/Object;
+    filled-new-array {v7, v8, v0}, [Ljava/lang/Object;
 
-    move-result-object v1
+    move-result-object v0
 
-    const-string/jumbo v4, "type: %d, user id: %d, payload size: %d"
+    const-string/jumbo v7, "type: %d, user id: %d, payload size: %d"
 
-    invoke-static {v4, v1}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v7, v0}, Landroid/text/TextUtils;->formatSimple(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v1
+    move-result-object v0
 
-    invoke-virtual {v0, v1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
     :cond_d
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    const-string/jumbo v1, "StrongAuth:"
+    const-string/jumbo v0, "StrongAuth:"
 
-    invoke-virtual {v0, v1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mStrongAuth:Lcom/android/server/locksettings/LockSettingsStrongAuth;
+    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mStrongAuth:Lcom/android/server/locksettings/LockSettingsStrongAuth;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v4, "PrimaryAuthFlags state:"
+    const-string/jumbo v7, "PrimaryAuthFlags state:"
 
-    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v7}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    move v4, p1
+    move v7, v5
 
-    :goto_a
-    iget-object v5, v1, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mStrongAuthForUser:Landroid/util/SparseIntArray;
+    :goto_b
+    iget-object v8, v0, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mStrongAuthForUser:Landroid/util/SparseIntArray;
 
-    invoke-virtual {v5}, Landroid/util/SparseIntArray;->size()I
+    invoke-virtual {v8}, Landroid/util/SparseIntArray;->size()I
 
-    move-result v5
+    move-result v8
 
-    const-string/jumbo v6, "userId="
+    const-string/jumbo v9, "userId="
 
-    if-ge v4, v5, :cond_e
+    if-ge v7, v8, :cond_e
 
-    iget-object v5, v1, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mStrongAuthForUser:Landroid/util/SparseIntArray;
+    iget-object v8, v0, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mStrongAuthForUser:Landroid/util/SparseIntArray;
 
-    invoke-virtual {v5, v4}, Landroid/util/SparseIntArray;->keyAt(I)I
+    invoke-virtual {v8, v7}, Landroid/util/SparseIntArray;->keyAt(I)I
 
-    move-result v5
+    move-result v8
 
-    iget-object v7, v1, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mStrongAuthForUser:Landroid/util/SparseIntArray;
+    iget-object v10, v0, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mStrongAuthForUser:Landroid/util/SparseIntArray;
 
-    invoke-virtual {v7, v4}, Landroid/util/SparseIntArray;->valueAt(I)I
+    invoke-virtual {v10, v7}, Landroid/util/SparseIntArray;->valueAt(I)I
 
-    move-result v7
+    move-result v10
 
-    const-string v8, ", primaryAuthFlags="
+    const-string v11, ", primaryAuthFlags="
 
-    invoke-static {v5, v6, v8}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-static {v8, v9, v11}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v5
+    move-result-object v8
 
-    invoke-static {v7}, Ljava/lang/Integer;->toHexString(I)Ljava/lang/String;
+    invoke-static {v10}, Ljava/lang/Integer;->toHexString(I)Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v9
 
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v8
 
-    invoke-virtual {v0, v5}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v8}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    add-int/lit8 v4, v4, 0x1
+    add-int/lit8 v7, v7, 0x1
 
-    goto :goto_a
+    goto :goto_b
 
     :cond_e
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    const-string/jumbo v4, "NonStrongBiometricAllowed state:"
+    const-string/jumbo v7, "NonStrongBiometricAllowed state:"
 
-    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v7}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    move v4, p1
+    move v7, v5
 
-    :goto_b
-    iget-object v5, v1, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mIsNonStrongBiometricAllowedForUser:Landroid/util/SparseBooleanArray;
+    :goto_c
+    iget-object v8, v0, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mIsNonStrongBiometricAllowedForUser:Landroid/util/SparseBooleanArray;
 
-    invoke-virtual {v5}, Landroid/util/SparseBooleanArray;->size()I
+    invoke-virtual {v8}, Landroid/util/SparseBooleanArray;->size()I
 
-    move-result v5
+    move-result v8
 
-    if-ge v4, v5, :cond_f
+    if-ge v7, v8, :cond_f
 
-    iget-object v5, v1, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mIsNonStrongBiometricAllowedForUser:Landroid/util/SparseBooleanArray;
+    iget-object v8, v0, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mIsNonStrongBiometricAllowedForUser:Landroid/util/SparseBooleanArray;
 
-    invoke-virtual {v5, v4}, Landroid/util/SparseBooleanArray;->keyAt(I)I
+    invoke-virtual {v8, v7}, Landroid/util/SparseBooleanArray;->keyAt(I)I
 
-    move-result v5
+    move-result v8
 
-    iget-object v7, v1, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mIsNonStrongBiometricAllowedForUser:Landroid/util/SparseBooleanArray;
+    iget-object v10, v0, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mIsNonStrongBiometricAllowedForUser:Landroid/util/SparseBooleanArray;
 
-    invoke-virtual {v7, v4}, Landroid/util/SparseBooleanArray;->valueAt(I)Z
+    invoke-virtual {v10, v7}, Landroid/util/SparseBooleanArray;->valueAt(I)Z
 
-    move-result v7
+    move-result v10
 
-    new-instance v8, Ljava/lang/StringBuilder;
+    new-instance v11, Ljava/lang/StringBuilder;
 
-    invoke-direct {v8, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v11, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v8, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v11, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v5, ", allowed="
+    const-string v8, ", allowed="
 
-    invoke-virtual {v8, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v11, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v8, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v11, v10}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v8
 
-    invoke-virtual {v0, v5}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v8}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    add-int/lit8 v4, v4, 0x1
+    add-int/lit8 v7, v7, 0x1
 
-    goto :goto_b
+    goto :goto_c
 
     :cond_f
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    const-string/jumbo v4, "strong auth timeout state:"
+    const-string/jumbo v7, "strong auth timeout state:"
 
-    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v7}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    new-instance v4, Ljava/text/SimpleDateFormat;
+    new-instance v7, Ljava/text/SimpleDateFormat;
 
-    const-string/jumbo v5, "yyyy/MM/dd HH:mm:ss.SSS"
+    const-string/jumbo v8, "yyyy/MM/dd HH:mm:ss.SSS"
 
-    invoke-direct {v4, v5}, Ljava/text/SimpleDateFormat;-><init>(Ljava/lang/String;)V
+    invoke-direct {v7, v8}, Ljava/text/SimpleDateFormat;-><init>(Ljava/lang/String;)V
 
-    iget-object v5, v1, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
+    iget-object v8, v0, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    const-string/jumbo v6, "lockscreen.strong_bio_timeout"
+    const-string/jumbo v9, "lockscreen.strong_bio_timeout"
 
-    invoke-virtual {v5, v6, p1}, Lcom/android/internal/widget/LockPatternUtils;->getBiometricStrongAuthTimeout(Ljava/lang/String;I)J
+    invoke-virtual {v8, v9, v5}, Lcom/android/internal/widget/LockPatternUtils;->getBiometricStrongAuthTimeout(Ljava/lang/String;I)J
 
-    move-result-wide v5
+    move-result-wide v8
 
-    cmp-long v7, v5, v2
+    cmp-long v10, v8, v3
 
-    if-eqz v7, :cond_10
+    if-eqz v10, :cond_10
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    new-instance v10, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v8, "strong biometric timeout:"
+    const-string/jumbo v11, "strong biometric timeout:"
 
-    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v10, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    new-instance v8, Ljava/util/Date;
+    new-instance v11, Ljava/util/Date;
 
-    invoke-direct {v8, v5, v6}, Ljava/util/Date;-><init>(J)V
+    invoke-direct {v11, v8, v9}, Ljava/util/Date;-><init>(J)V
 
-    invoke-virtual {v4, v8}, Ljava/text/SimpleDateFormat;->format(Ljava/util/Date;)Ljava/lang/String;
+    invoke-virtual {v7, v11}, Ljava/text/SimpleDateFormat;->format(Ljava/util/Date;)Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v8
 
-    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v8
 
-    invoke-virtual {v0, v5}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v8}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
     :cond_10
-    iget-object v5, v1, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
+    iget-object v8, v0, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    const-string/jumbo v6, "lockscreen.non_strong_bio_timeout"
+    const-string/jumbo v9, "lockscreen.non_strong_bio_timeout"
 
-    invoke-virtual {v5, v6, p1}, Lcom/android/internal/widget/LockPatternUtils;->getBiometricStrongAuthTimeout(Ljava/lang/String;I)J
+    invoke-virtual {v8, v9, v5}, Lcom/android/internal/widget/LockPatternUtils;->getBiometricStrongAuthTimeout(Ljava/lang/String;I)J
 
-    move-result-wide v5
+    move-result-wide v8
 
-    cmp-long v7, v5, v2
+    cmp-long v10, v8, v3
 
-    if-eqz v7, :cond_11
+    if-eqz v10, :cond_11
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    new-instance v10, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v8, "non strong biometric timeout:"
+    const-string/jumbo v11, "non strong biometric timeout:"
 
-    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v10, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    new-instance v8, Ljava/util/Date;
+    new-instance v11, Ljava/util/Date;
 
-    invoke-direct {v8, v5, v6}, Ljava/util/Date;-><init>(J)V
+    invoke-direct {v11, v8, v9}, Ljava/util/Date;-><init>(J)V
 
-    invoke-virtual {v4, v8}, Ljava/text/SimpleDateFormat;->format(Ljava/util/Date;)Ljava/lang/String;
+    invoke-virtual {v7, v11}, Ljava/text/SimpleDateFormat;->format(Ljava/util/Date;)Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v8
 
-    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v10, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v8
 
-    invoke-virtual {v0, v5}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v8}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
     :cond_11
-    iget-object v1, v1, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
+    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    const-string/jumbo v5, "lockscreen.non_strong_bio_idle_timeout"
+    const-string/jumbo v8, "lockscreen.non_strong_bio_idle_timeout"
 
-    invoke-virtual {v1, v5, p1}, Lcom/android/internal/widget/LockPatternUtils;->getBiometricStrongAuthTimeout(Ljava/lang/String;I)J
+    invoke-virtual {v0, v8, v5}, Lcom/android/internal/widget/LockPatternUtils;->getBiometricStrongAuthTimeout(Ljava/lang/String;I)J
 
-    move-result-wide v5
+    move-result-wide v8
 
-    cmp-long v1, v5, v2
+    cmp-long v0, v8, v3
 
-    if-eqz v1, :cond_12
+    if-eqz v0, :cond_12
 
-    new-instance v1, Ljava/lang/StringBuilder;
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v2, "non strong biometric idle timeout:"
+    const-string/jumbo v3, "non strong biometric idle timeout:"
 
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    new-instance v2, Ljava/util/Date;
+    new-instance v3, Ljava/util/Date;
 
-    invoke-direct {v2, v5, v6}, Ljava/util/Date;-><init>(J)V
+    invoke-direct {v3, v8, v9}, Ljava/util/Date;-><init>(J)V
 
-    invoke-virtual {v4, v2}, Ljava/text/SimpleDateFormat;->format(Ljava/util/Date;)Ljava/lang/String;
+    invoke-virtual {v7, v3}, Ljava/text/SimpleDateFormat;->format(Ljava/util/Date;)Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object v3
 
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v1
+    move-result-object v0
 
-    invoke-virtual {v0, v1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
     :cond_12
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    const-string/jumbo v1, "RebootEscrow:"
+    const-string/jumbo v0, "RebootEscrow:"
 
-    invoke-virtual {v0, v1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mRebootEscrowManager:Lcom/android/server/locksettings/RebootEscrowManager;
+    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mRebootEscrowManager:Lcom/android/server/locksettings/RebootEscrowManager;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v2, "mRebootEscrowWanted="
+    const-string/jumbo v3, "mRebootEscrowWanted="
 
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
+    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
 
-    iget-boolean v2, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mRebootEscrowWanted:Z
+    iget-boolean v3, v0, Lcom/android/server/locksettings/RebootEscrowManager;->mRebootEscrowWanted:Z
 
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->println(Z)V
+    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->println(Z)V
 
-    const-string/jumbo v2, "mRebootEscrowReady="
+    const-string/jumbo v3, "mRebootEscrowReady="
 
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
+    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
 
-    iget-boolean v2, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mRebootEscrowReady:Z
+    iget-boolean v3, v0, Lcom/android/server/locksettings/RebootEscrowManager;->mRebootEscrowReady:Z
 
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->println(Z)V
+    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->println(Z)V
 
-    const-string/jumbo v2, "mRebootEscrowListener="
+    const-string/jumbo v3, "mRebootEscrowListener="
 
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
+    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
 
-    iget-object v2, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mRebootEscrowListener:Lcom/android/internal/widget/RebootEscrowListener;
+    iget-object v3, v0, Lcom/android/server/locksettings/RebootEscrowManager;->mRebootEscrowListener:Lcom/android/internal/widget/RebootEscrowListener;
 
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/Object;)V
+    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/Object;)V
 
-    const-string/jumbo v2, "mLoadEscrowDataErrorCode="
+    const-string/jumbo v3, "mLoadEscrowDataErrorCode="
 
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
+    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
 
-    iget v2, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mLoadEscrowDataErrorCode:I
+    iget v3, v0, Lcom/android/server/locksettings/RebootEscrowManager;->mLoadEscrowDataErrorCode:I
 
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->println(I)V
+    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->println(I)V
 
-    iget-object v2, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mKeyGenerationLock:Ljava/lang/Object;
+    iget-object v3, v0, Lcom/android/server/locksettings/RebootEscrowManager;->mKeyGenerationLock:Ljava/lang/Object;
 
-    monitor-enter v2
+    monitor-enter v3
 
     :try_start_4
-    iget-object v3, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mPendingRebootEscrowKey:Lcom/android/server/locksettings/RebootEscrowKey;
-
-    if-eqz v3, :cond_13
+    iget-object v4, v0, Lcom/android/server/locksettings/RebootEscrowManager;->mPendingRebootEscrowKey:Lcom/android/server/locksettings/RebootEscrowKey;
 
-    const/4 v3, 0x1
+    if-eqz v4, :cond_13
 
-    goto :goto_c
+    goto :goto_d
 
     :cond_13
-    move v3, p1
+    move v6, v5
 
-    :goto_c
-    monitor-exit v2
+    :goto_d
+    monitor-exit v3
     :try_end_4
     .catchall {:try_start_4 .. :try_end_4} :catchall_2
 
-    const-string/jumbo v2, "mPendingRebootEscrowKey is "
+    const-string/jumbo v3, "mPendingRebootEscrowKey is "
 
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
+    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
 
-    if-eqz v3, :cond_14
+    if-eqz v6, :cond_14
 
-    const-string/jumbo v2, "set"
+    const-string/jumbo v3, "set"
 
-    goto :goto_d
+    goto :goto_e
 
     :cond_14
-    const-string/jumbo v2, "not set"
+    const-string/jumbo v3, "not set"
 
-    :goto_d
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    :goto_e
+    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    iget-object v2, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mInjector:Lcom/android/server/locksettings/RebootEscrowManager$Injector;
+    iget-object v3, v0, Lcom/android/server/locksettings/RebootEscrowManager;->mInjector:Lcom/android/server/locksettings/RebootEscrowManager$Injector;
 
-    iget-object v2, v2, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->mRebootEscrowProvider:Lcom/android/server/locksettings/RebootEscrowProviderInterface;
+    iget-object v3, v3, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->mRebootEscrowProvider:Lcom/android/server/locksettings/RebootEscrowProviderInterface;
 
-    if-nez v2, :cond_15
+    if-nez v3, :cond_15
 
-    const-string/jumbo v2, "null"
+    const-string/jumbo v3, "null"
 
-    goto :goto_e
+    goto :goto_f
 
     :cond_15
-    invoke-interface {v2}, Lcom/android/server/locksettings/RebootEscrowProviderInterface;->getType()I
+    invoke-interface {v3}, Lcom/android/server/locksettings/RebootEscrowProviderInterface;->getType()I
 
-    move-result v2
+    move-result v3
 
-    invoke-static {v2}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
+    invoke-static {v3}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object v3
 
-    :goto_e
-    new-instance v3, Ljava/lang/StringBuilder;
+    :goto_f
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v4, "RebootEscrowProvider type is "
+    const-string/jumbo v6, "RebootEscrowProvider type is "
 
-    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v4, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v4, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object v3
 
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
+    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
-    const-string v2, "Event log:"
+    const-string v3, "Event log:"
 
-    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    iget-object v1, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mEventLog:Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEventLog;
+    iget-object v0, v0, Lcom/android/server/locksettings/RebootEscrowManager;->mEventLog:Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEventLog;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    new-instance v2, Ljava/text/SimpleDateFormat;
+    new-instance v3, Ljava/text/SimpleDateFormat;
 
-    const-string/jumbo v3, "yyyy-MM-dd HH:mm:ss.SSS"
+    const-string/jumbo v4, "yyyy-MM-dd HH:mm:ss.SSS"
 
-    sget-object v4, Ljava/util/Locale;->US:Ljava/util/Locale;
+    sget-object v6, Ljava/util/Locale;->US:Ljava/util/Locale;
 
-    invoke-direct {v2, v3, v4}, Ljava/text/SimpleDateFormat;-><init>(Ljava/lang/String;Ljava/util/Locale;)V
+    invoke-direct {v3, v4, v6}, Ljava/text/SimpleDateFormat;-><init>(Ljava/lang/String;Ljava/util/Locale;)V
 
-    :goto_f
-    iget-object v3, v1, Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEventLog;->mEntries:[Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEvent;
+    :goto_10
+    iget-object v4, v0, Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEventLog;->mEntries:[Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEvent;
 
-    array-length v4, v3
+    array-length v6, v4
 
-    if-ge p1, v4, :cond_18
+    if-ge v5, v6, :cond_18
 
-    iget v4, v1, Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEventLog;->mNextIndex:I
+    iget v6, v0, Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEventLog;->mNextIndex:I
 
-    add-int/2addr v4, p1
+    add-int/2addr v6, v5
 
-    array-length v5, v3
+    array-length v7, v4
 
-    rem-int/2addr v4, v5
+    rem-int/2addr v6, v7
 
-    aget-object v3, v3, v4
+    aget-object v4, v4, v6
 
-    if-nez v3, :cond_16
+    if-nez v4, :cond_16
 
-    goto :goto_11
+    goto :goto_12
 
     :cond_16
-    const-string v4, "Event #"
+    const-string v6, "Event #"
 
-    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
+    invoke-virtual {v2, v6}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
 
-    invoke-virtual {v0, p1}, Lcom/android/internal/util/IndentingPrintWriter;->println(I)V
+    invoke-virtual {v2, v5}, Lcom/android/internal/util/IndentingPrintWriter;->println(I)V
 
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v6, Ljava/lang/StringBuilder;
 
-    const-string v5, " time="
+    const-string v7, " time="
 
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    new-instance v5, Ljava/util/Date;
+    new-instance v7, Ljava/util/Date;
 
-    iget-wide v6, v3, Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEvent;->mWallTime:J
+    iget-wide v8, v4, Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEvent;->mWallTime:J
 
-    invoke-direct {v5, v6, v7}, Ljava/util/Date;-><init>(J)V
+    invoke-direct {v7, v8, v9}, Ljava/util/Date;-><init>(J)V
 
-    invoke-virtual {v2, v5}, Ljava/text/SimpleDateFormat;->format(Ljava/util/Date;)Ljava/lang/String;
+    invoke-virtual {v3, v7}, Ljava/text/SimpleDateFormat;->format(Ljava/util/Date;)Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v7
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string v5, " (timestamp="
+    const-string v7, " (timestamp="
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-wide v5, v3, Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEvent;->mTimestamp:J
+    iget-wide v7, v4, Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEvent;->mTimestamp:J
 
-    invoke-virtual {v4, v5, v6}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7, v8}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
 
-    const-string v5, ")"
+    const-string v7, ")"
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v6
 
-    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v6}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    const-string v4, " event="
+    const-string v6, " event="
 
-    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
+    invoke-virtual {v2, v6}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
 
-    iget v4, v3, Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEvent;->mEventId:I
+    iget v6, v4, Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEvent;->mEventId:I
 
-    packed-switch v4, :pswitch_data_0
+    packed-switch v6, :pswitch_data_0
 
-    const-string/jumbo v5, "Unknown event ID "
+    const-string/jumbo v7, "Unknown event ID "
 
-    invoke-static {v4, v5}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
+    invoke-static {v6, v7}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v6
 
-    goto :goto_10
+    goto :goto_11
 
     :pswitch_0
-    const-string/jumbo v4, "Retrieved LSKF for user"
+    const-string/jumbo v6, "Retrieved LSKF for user"
 
-    goto :goto_10
+    goto :goto_11
 
     :pswitch_1
-    const-string/jumbo v4, "Stored LSKF for user"
+    const-string/jumbo v6, "Stored LSKF for user"
 
-    goto :goto_10
+    goto :goto_11
 
     :pswitch_2
-    const-string/jumbo v4, "Requested LSKF"
+    const-string/jumbo v6, "Requested LSKF"
 
-    goto :goto_10
+    goto :goto_11
 
     :pswitch_3
-    const-string/jumbo v4, "Retrieved stored KEK"
+    const-string/jumbo v6, "Retrieved stored KEK"
 
-    goto :goto_10
+    goto :goto_11
 
     :pswitch_4
-    const-string v4, "Cleared request for LSKF"
+    const-string v6, "Cleared request for LSKF"
 
-    goto :goto_10
+    goto :goto_11
 
     :pswitch_5
-    const-string/jumbo v4, "Set armed status"
+    const-string/jumbo v6, "Set armed status"
 
-    goto :goto_10
+    goto :goto_11
 
     :pswitch_6
-    const-string v4, "Found escrow data"
+    const-string v6, "Found escrow data"
 
-    :goto_10
-    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    :goto_11
+    invoke-virtual {v2, v6}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    iget-object v3, v3, Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEvent;->mUserId:Ljava/lang/Integer;
+    iget-object v4, v4, Lcom/android/server/locksettings/RebootEscrowManager$RebootEscrowEvent;->mUserId:Ljava/lang/Integer;
 
-    if-eqz v3, :cond_17
+    if-eqz v4, :cond_17
 
-    const-string v4, " user="
+    const-string v6, " user="
 
-    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
+    invoke-virtual {v2, v6}, Lcom/android/internal/util/IndentingPrintWriter;->print(Ljava/lang/String;)V
 
-    invoke-virtual {v0, v3}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/Object;)V
+    invoke-virtual {v2, v4}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/Object;)V
 
     :cond_17
-    :goto_11
-    add-int/lit8 p1, p1, 0x1
+    :goto_12
+    add-int/lit8 v5, v5, 0x1
 
-    goto :goto_f
+    goto :goto_10
 
     :cond_18
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;
 
-    new-instance p1, Ljava/lang/StringBuilder;
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v1, "PasswordHandleCount: "
+    const-string/jumbo v3, "PasswordHandleCount: "
 
-    invoke-direct {p1, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mGatekeeperPasswords:Landroid/util/LongSparseArray;
+    iget-object v3, v1, Lcom/android/server/locksettings/LockSettingsService;->mGatekeeperPasswords:Landroid/util/LongSparseArray;
 
-    invoke-virtual {v1}, Landroid/util/LongSparseArray;->size()I
+    invoke-virtual {v3}, Landroid/util/LongSparseArray;->size()I
 
-    move-result v1
+    move-result v3
 
-    invoke-virtual {p1, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object p1
+    move-result-object v0
 
-    invoke-virtual {v0, p1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserCreationAndRemovalLock:Ljava/lang/Object;
+    iget-object v4, v1, Lcom/android/server/locksettings/LockSettingsService;->mUserCreationAndRemovalLock:Ljava/lang/Object;
 
-    monitor-enter p1
+    monitor-enter v4
 
     :try_start_5
-    new-instance v1, Ljava/lang/StringBuilder;
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
 
-    const-string/jumbo v2, "ThirdPartyAppsStarted: "
+    const-string/jumbo v3, "ThirdPartyAppsStarted: "
 
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-boolean p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mThirdPartyAppsStarted:Z
+    iget-boolean v1, v1, Lcom/android/server/locksettings/LockSettingsService;->mThirdPartyAppsStarted:Z
 
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object p0
+    move-result-object v0
 
-    invoke-virtual {v0, p0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    monitor-exit p1
+    monitor-exit v4
     :try_end_5
     .catchall {:try_start_5 .. :try_end_5} :catchall_1
 
-    const-string p0, "LSSLog:"
+    const-string v0, "LSSLog:"
 
-    invoke-virtual {v0, p0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
+    invoke-virtual {v2, v0}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V
 
-    invoke-static {v0}, Lcom/samsung/android/lock/LsLog;->dump(Ljava/io/PrintWriter;)V
+    invoke-static {v2}, Lcom/samsung/android/lock/LsLog;->dump(Ljava/io/PrintWriter;)V
 
-    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
+    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V
 
     return-void
 
     :catchall_1
-    move-exception p0
+    move-exception v0
 
     :try_start_6
-    monitor-exit p1
+    monitor-exit v4
     :try_end_6
     .catchall {:try_start_6 .. :try_end_6} :catchall_1
 
-    throw p0
+    throw v0
 
     :catchall_2
-    move-exception p0
+    move-exception v0
 
     :try_start_7
-    monitor-exit v2
+    monitor-exit v3
     :try_end_7
     .catchall {:try_start_7 .. :try_end_7} :catchall_2
 
-    throw p0
+    throw v0
 
     nop
 
@@ -7391,7 +7230,7 @@
 .end method
 
 .method public final getCredentialTypeInternal(I)I
-    .locals 8
+    .locals 10
 
     invoke-static {p1}, Lcom/android/internal/widget/LockPatternUtils;->isSpecialUserId(I)Z
 
@@ -7417,14 +7256,15 @@
 
     if-eq p1, v1, :cond_0
 
-    goto/16 :goto_2
+    goto :goto_0
 
     :cond_0
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->payload:[B
 
     if-nez p1, :cond_1
 
-    goto/16 :goto_2
+    :goto_0
+    return v2
 
     :cond_1
     invoke-static {p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
@@ -7451,13 +7291,13 @@
 
     const-wide/16 v3, 0x0
 
-    if-ne p1, v0, :cond_6
+    if-ne p1, v0, :cond_7
 
     invoke-static {}, Lcom/android/server/locksettings/LockSettingsService;->isEnablePrevCredential()Z
 
     move-result v0
 
-    if-eqz v0, :cond_6
+    if-eqz v0, :cond_7
 
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
@@ -7481,106 +7321,79 @@
     :catchall_0
     move-exception p0
 
-    goto :goto_0
+    goto :goto_2
 
     :cond_4
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {p0, p1, v5, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getCredentialType(IJ)I
-
-    move-result p0
-
-    if-eq p0, v1, :cond_5
-
-    monitor-exit v0
-
-    return p0
-
-    :cond_5
-    monitor-exit v0
+    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    return v2
+    const-string/jumbo v3, "pwd"
 
-    :goto_0
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    invoke-virtual {p0, p1, v3, v5, v6}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
-    throw p0
+    move-result-object p0
 
-    :cond_6
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
+    if-nez p0, :cond_5
 
-    move-result v0
+    move p0, v2
 
-    if-nez v0, :cond_8
+    goto :goto_1
 
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
+    :cond_5
+    invoke-static {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
 
-    move-result v0
+    move-result-object p0
 
-    if-eqz v0, :cond_8
+    iget p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->credentialType:I
 
-    :try_start_1
-    invoke-static {p1}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->getCredentialType(I)I
+    :goto_1
+    if-eq p0, v1, :cond_6
 
-    move-result p0
-    :try_end_1
-    .catch Lcom/android/server/locksettings/SyntheticPasswordMdfpp$EmptySlotException; {:try_start_1 .. :try_end_1} :catch_0
+    monitor-exit v0
 
     return p0
 
-    :catch_0
-    move-exception v0
-
-    iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->isWeaverSupported()Z
-
-    move-result v5
-
-    if-nez v5, :cond_8
-
-    sget-boolean v5, Lcom/android/server/locksettings/LockSettingsService;->DEBUG_DUMP:Z
+    :cond_6
+    monitor-exit v0
 
-    if-eqz v5, :cond_7
+    return v2
 
-    invoke-virtual {v0}, Ljava/lang/SecurityException;->printStackTrace()V
+    :goto_2
+    monitor-exit v0
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    goto :goto_1
+    throw p0
 
     :cond_7
-    const-string/jumbo v5, "LockSettingsService.SDP"
-
-    new-instance v6, Ljava/lang/StringBuilder;
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string v7, ""
+    const-string/jumbo v5, "lockscreen.password_type"
 
-    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    const/4 v6, 0x0
 
-    invoke-virtual {v0}, Ljava/lang/SecurityException;->getMessage()Ljava/lang/String;
+    invoke-virtual {v0, v5, v6, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
 
     move-result-object v0
 
-    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-static {v0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
 
-    move-result-object v0
+    move-result v5
 
-    invoke-static {v5, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    if-eqz v5, :cond_8
 
-    :cond_8
-    :goto_1
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    move-wide v7, v3
 
-    const-string/jumbo v5, "lockscreen.password_type"
+    goto :goto_3
 
-    invoke-virtual {v0, v5, v3, v4, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->getLong(Ljava/lang/String;JI)J
+    :cond_8
+    invoke-static {v0}, Ljava/lang/Long;->parseLong(Ljava/lang/String;)J
 
-    move-result-wide v5
+    move-result-wide v7
 
-    long-to-int v0, v5
+    :goto_3
+    long-to-int v0, v7
 
     invoke-static {v0}, Lcom/android/internal/widget/LockPatternUtils;->isQualitySmartCard(I)Z
 
@@ -7597,48 +7410,77 @@
 
     monitor-enter v0
 
-    :try_start_2
+    :try_start_1
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
-    move-result-wide v5
+    move-result-wide v7
 
-    cmp-long v7, v5, v3
+    cmp-long v5, v7, v3
 
-    if-nez v7, :cond_a
+    if-nez v5, :cond_a
 
     monitor-exit v0
 
-    :goto_2
     return v2
 
     :catchall_1
     move-exception p0
 
-    goto :goto_3
+    goto :goto_6
 
     :cond_a
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {v2, p1, v5, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getCredentialType(IJ)I
+    iget-object v5, v5, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    move-result v2
+    const-string/jumbo v9, "pwd"
+
+    invoke-virtual {v5, p1, v9, v7, v8}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
+
+    move-result-object v5
+
+    if-nez v5, :cond_b
+
+    goto :goto_4
+
+    :cond_b
+    invoke-static {v5}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
+
+    move-result-object v2
+
+    iget v2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->credentialType:I
 
-    if-eq v2, v1, :cond_b
+    :goto_4
+    if-eq v2, v1, :cond_c
 
     monitor-exit v0
 
     return v2
 
-    :cond_b
+    :cond_c
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
     const-string/jumbo v1, "lockscreen.password_type"
 
-    invoke-virtual {p0, v1, v3, v4, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->getLong(Ljava/lang/String;JI)J
+    invoke-virtual {p0, v1, v6, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
 
-    move-result-wide p0
+    move-result-object p0
+
+    invoke-static {p0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
+
+    move-result p1
+
+    if-eqz p1, :cond_d
+
+    goto :goto_5
+
+    :cond_d
+    invoke-static {p0}, Ljava/lang/Long;->parseLong(Ljava/lang/String;)J
+
+    move-result-wide v3
 
-    long-to-int p0, p0
+    :goto_5
+    long-to-int p0, v3
 
     invoke-static {p0}, Lcom/android/internal/widget/LockPatternUtils;->pinOrPasswordQualityToCredentialType(I)I
 
@@ -7648,10 +7490,10 @@
 
     return p0
 
-    :goto_3
+    :goto_6
     monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_1
 
     throw p0
 .end method
@@ -8437,13 +8279,28 @@
 .end method
 
 .method public final getLong(Ljava/lang/String;JI)J
-    .locals 0
+    .locals 1
 
     invoke-virtual {p0, p4, p1}, Lcom/android/server/locksettings/LockSettingsService;->checkDatabaseReadPermission(ILjava/lang/String;)V
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/locksettings/LockSettingsStorage;->getLong(Ljava/lang/String;JI)J
+    const/4 v0, 0x0
+
+    invoke-virtual {p0, p1, v0, p4}, Lcom/android/server/locksettings/LockSettingsStorage;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
+
+    move-result-object p0
+
+    invoke-static {p0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
+
+    move-result p1
+
+    if-eqz p1, :cond_0
+
+    return-wide p2
+
+    :cond_0
+    invoke-static {p0}, Ljava/lang/Long;->parseLong(Ljava/lang/String;)J
 
     move-result-wide p0
 
@@ -8507,9 +8364,11 @@
     :cond_1
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
+    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+
     const-string/jumbo v3, "pwd"
 
-    invoke-virtual {p0, p1, v3, v1, v2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {p0, p1, v3, v1, v2}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object p0
 
@@ -9205,7 +9064,15 @@
 
     const-string p0, "Failed to initialize Keystore super keys for user "
 
-    invoke-virtual {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveKeyStorePassword()[B
+    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    sget-object v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_KEY_STORE_PASSWORD:[B
+
+    invoke-virtual {p2, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
+
+    move-result-object p2
+
+    invoke-static {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->bytesToHex([B)[B
 
     move-result-object p2
 
@@ -9593,36 +9460,6 @@
     return p0
 .end method
 
-.method public final isDeviceOwner(I)Z
-    .locals 4
-
-    const/4 v0, 0x0
-
-    if-eqz p1, :cond_0
-
-    return v0
-
-    :cond_0
-    const-string/jumbo v1, "knox.device_owner"
-
-    const-wide/16 v2, 0x0
-
-    invoke-virtual {p0, v1, v2, v3, p1}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
-
-    move-result-wide p0
-
-    cmp-long p0, p0, v2
-
-    if-eqz p0, :cond_1
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_1
-    return v0
-.end method
-
 .method public final isDualDarAuthUserId(I)Z
     .locals 1
 
@@ -11959,7 +11796,7 @@
 .end method
 
 .method public final notifyPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
-    .locals 3
+    .locals 2
 
     invoke-static {p2}, Landroid/os/UserManager;->isVirtualUserId(I)Z
 
@@ -11995,9 +11832,7 @@
 
     new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;
 
-    const/4 v2, 0x1
-
-    invoke-direct {v1, p0, p1, p2, v2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;-><init>(Ljava/lang/Object;Lcom/android/internal/widget/LockscreenCredential;II)V
+    invoke-direct {v1, p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
 
     invoke-virtual {v0, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
@@ -12088,10 +11923,6 @@
 
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->unlockUser(I)V
 
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {p2, p3, p1}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->migrateWithAuthToken(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
 
     invoke-virtual {p2, p3}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->isDualDARUser(I)Z
@@ -12220,104 +12051,262 @@
     :try_end_2
     .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0
 
-    if-lez p2, :cond_6
+    if-lez p2, :cond_6
+
+    const-string/jumbo p2, "LockSettingsService"
+
+    const-string/jumbo v1, "Password change requested so avoid setDeviceLockedForUser false"
+
+    invoke-static {p2, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    goto :goto_2
+
+    :catch_0
+    move-exception p2
+
+    invoke-virtual {p2}, Ljava/lang/Exception;->printStackTrace()V
+
+    :cond_6
+    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+
+    const-class v1, Landroid/app/trust/TrustManager;
+
+    invoke-virtual {p2, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object p2
+
+    check-cast p2, Landroid/app/trust/TrustManager;
+
+    invoke-virtual {p2, p3, v0}, Landroid/app/trust/TrustManager;->setDeviceLockedForUser(IZ)V
+
+    goto :goto_2
+
+    :cond_7
+    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mStrongAuth:Lcom/android/server/locksettings/LockSettingsStrongAuth;
+
+    invoke-virtual {p2, v0, p3}, Lcom/android/server/locksettings/LockSettingsStrongAuth;->requireStrongAuth(II)V
+
+    :cond_8
+    :goto_2
+    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mStrongAuth:Lcom/android/server/locksettings/LockSettingsStrongAuth;
+
+    iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mHandler:Landroid/os/Handler;
+
+    const/4 v1, 0x5
+
+    invoke-virtual {p2, v1, p3, v0}, Landroid/os/Handler;->obtainMessage(III)Landroid/os/Message;
+
+    move-result-object p2
+
+    invoke-virtual {p2}, Landroid/os/Message;->sendToTarget()V
+
+    invoke-virtual {p0, p3, p1, v0}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordKnown(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Z)V
+
+    return-void
+
+    :goto_3
+    :try_start_3
+    monitor-exit p2
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+
+    throw p0
+.end method
+
+.method public final onPostPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
+    .locals 10
+
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+
+    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v0
+
+    const-string/jumbo v1, "ppp_enroll_timestamp"
+
+    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J
+
+    move-result-wide v2
+
+    invoke-static {v0, v1, v2, v3, p2}, Landroid/provider/Settings$Secure;->putLongForUser(Landroid/content/ContentResolver;Ljava/lang/String;JI)Z
+
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+
+    move-result v0
+
+    if-eqz v0, :cond_0
+
+    goto/16 :goto_3
+
+    :cond_0
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isPattern()Z
+
+    move-result v0
+
+    if-eqz v0, :cond_1
+
+    goto/16 :goto_3
+
+    :cond_1
+    const-string/jumbo v0, "lockscreen.passwordhistory"
+
+    const/4 v1, 0x0
+
+    invoke-virtual {p0, v0, v1, p2}, Lcom/android/server/locksettings/LockSettingsService;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string v3, ""
+
+    if-nez v2, :cond_2
+
+    move-object v2, v3
+
+    :cond_2
+    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
+
+    invoke-virtual {v4, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
+
+    move-result v4
+
+    if-eqz v4, :cond_3
+
+    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
+
+    invoke-virtual {v4, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
+
+    move-result v4
+
+    goto :goto_0
+
+    :cond_3
+    move v4, p2
+
+    :goto_0
+    iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
+
+    invoke-virtual {v5}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
+
+    move-result-object v5
+
+    invoke-virtual {v5, v1, v4}, Landroid/app/admin/DevicePolicyManager;->getPasswordHistoryLength(Landroid/content/ComponentName;I)I
+
+    move-result v1
+
+    if-nez v1, :cond_4
+
+    goto :goto_2
+
+    :cond_4
+    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+
+    move-result-object v3
+
+    filled-new-array {v3}, [Ljava/lang/Object;
+
+    move-result-object v3
+
+    const-string/jumbo v4, "LockSettingsService"
+
+    const-string v5, "Adding new password to password history for user %d"
+
+    invoke-static {v4, v5, v3}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    const-string/jumbo p2, "LockSettingsService"
+    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->getHashFactor(Lcom/android/internal/widget/LockscreenCredential;I)[B
 
-    const-string/jumbo v1, "Password change requested so avoid setDeviceLockedForUser false"
+    move-result-object v3
 
-    invoke-static {p2, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    const-string/jumbo v5, "lockscreen.password_salt"
 
-    goto :goto_2
+    const-wide/16 v6, 0x0
 
-    :catch_0
-    move-exception p2
+    invoke-virtual {p0, v5, v6, v7, p2}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
-    invoke-virtual {p2}, Ljava/lang/Exception;->printStackTrace()V
+    move-result-wide v8
 
-    :cond_6
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    cmp-long v6, v8, v6
 
-    const-class v1, Landroid/app/trust/TrustManager;
+    if-nez v6, :cond_5
 
-    invoke-virtual {p2, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
+    sget-object v6, Lcom/android/server/locksettings/SecureRandomUtils;->RNG:Ljava/security/SecureRandom;
 
-    move-result-object p2
+    invoke-virtual {v6}, Ljava/security/SecureRandom;->nextLong()J
 
-    check-cast p2, Landroid/app/trust/TrustManager;
+    move-result-wide v8
 
-    invoke-virtual {p2, p3, v0}, Landroid/app/trust/TrustManager;->setDeviceLockedForUser(IZ)V
+    invoke-virtual {p0, v5, v8, v9, p2}, Lcom/android/server/locksettings/LockSettingsService;->setLong(Ljava/lang/String;JI)V
 
-    goto :goto_2
+    :cond_5
+    invoke-static {v8, v9}, Ljava/lang/Long;->toHexString(J)Ljava/lang/String;
 
-    :cond_7
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mStrongAuth:Lcom/android/server/locksettings/LockSettingsStrongAuth;
+    move-result-object v5
 
-    invoke-virtual {p2, v0, p3}, Lcom/android/server/locksettings/LockSettingsStrongAuth;->requireStrongAuth(II)V
+    invoke-virtual {v5}, Ljava/lang/String;->getBytes()[B
 
-    :cond_8
-    :goto_2
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mStrongAuth:Lcom/android/server/locksettings/LockSettingsStrongAuth;
+    move-result-object v5
 
-    iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsStrongAuth;->mHandler:Landroid/os/Handler;
+    invoke-virtual {p1, v5, v3}, Lcom/android/internal/widget/LockscreenCredential;->passwordToHistoryHash([B[B)Ljava/lang/String;
 
-    const/4 v1, 0x5
+    move-result-object v3
 
-    invoke-virtual {p2, v1, p3, v0}, Landroid/os/Handler;->obtainMessage(III)Landroid/os/Message;
+    if-nez v3, :cond_6
 
-    move-result-object p2
+    const-string v0, "Failed to compute password hash; password history won\'t be updated"
 
-    invoke-virtual {p2}, Landroid/os/Message;->sendToTarget()V
+    invoke-static {v4, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {p0, p3, p1, v0}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordKnown(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Z)V
+    goto :goto_3
 
-    return-void
+    :cond_6
+    invoke-static {v2}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
 
-    :goto_3
-    :try_start_3
-    monitor-exit p2
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    move-result v4
 
-    throw p0
-.end method
+    if-eqz v4, :cond_7
 
-.method public final onPostPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
-    .locals 4
+    goto :goto_2
 
-    invoke-static {p2}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
+    :cond_7
+    const-string v4, ","
 
-    move-result v0
+    invoke-virtual {v2, v4}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;
 
-    if-eqz v0, :cond_0
+    move-result-object v2
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
+    new-instance v5, Ljava/util/StringJoiner;
 
-    invoke-virtual {v0, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
+    invoke-direct {v5, v4}, Ljava/util/StringJoiner;-><init>(Ljava/lang/CharSequence;)V
 
-    move-result v0
+    invoke-virtual {v5, v3}, Ljava/util/StringJoiner;->add(Ljava/lang/CharSequence;)Ljava/util/StringJoiner;
 
-    if-nez v0, :cond_0
+    const/4 v3, 0x0
 
-    return-void
+    :goto_1
+    add-int/lit8 v4, v1, -0x1
 
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    if-ge v3, v4, :cond_8
 
-    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    array-length v4, v2
 
-    move-result-object v0
+    if-ge v3, v4, :cond_8
 
-    const-string/jumbo v1, "ppp_enroll_timestamp"
+    aget-object v4, v2, v3
 
-    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J
+    invoke-virtual {v5, v4}, Ljava/util/StringJoiner;->add(Ljava/lang/CharSequence;)Ljava/util/StringJoiner;
 
-    move-result-wide v2
+    add-int/lit8 v3, v3, 0x1
 
-    invoke-static {v0, v1, v2, v3, p2}, Landroid/provider/Settings$Secure;->putLongForUser(Landroid/content/ContentResolver;Ljava/lang/String;JI)Z
+    goto :goto_1
+
+    :cond_8
+    invoke-virtual {v5}, Ljava/util/StringJoiner;->toString()Ljava/lang/String;
+
+    move-result-object v3
 
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->updatePasswordHistory(Lcom/android/internal/widget/LockscreenCredential;I)V
+    :goto_2
+    invoke-virtual {p0, v0, v3, p2}, Lcom/android/server/locksettings/LockSettingsService;->setString(Ljava/lang/String;Ljava/lang/String;I)V
 
+    :goto_3
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
     const-class v1, Landroid/app/trust/TrustManager;
@@ -12342,11 +12331,11 @@
 
     move-result v0
 
-    if-eq p2, v0, :cond_1
+    if-eq p2, v0, :cond_9
 
-    goto :goto_0
+    goto :goto_4
 
-    :cond_1
+    :cond_9
     new-instance v0, Landroid/content/Intent;
 
     const-string/jumbo v1, "android.intent.action.MAIN_USER_LOCKSCREEN_KNOWLEDGE_FACTOR_CHANGED"
@@ -12361,7 +12350,7 @@
 
     invoke-virtual {p0, v0, v1, v2}, Lcom/android/server/locksettings/LockSettingsService;->sendBroadcast(Landroid/content/Intent;Landroid/os/UserHandle;Ljava/lang/String;)V
 
-    :goto_0
+    :goto_4
     invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->updateVerifier(Lcom/android/internal/widget/LockscreenCredential;I)V
 
     return-void
@@ -12885,7 +12874,7 @@
 
     if-eqz v0, :cond_0
 
-    goto :goto_0
+    return-void
 
     :cond_0
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
@@ -12904,67 +12893,15 @@
     invoke-virtual {v0, p1}, Landroid/util/SparseArray;->remove(I)V
 
     monitor-exit p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_2
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_1
-
-    sget-object p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mSecureModeCache:Landroid/util/SparseArray;
-
-    monitor-enter p0
-
-    :try_start_1
-    invoke-virtual {p0, p1}, Landroid/util/SparseArray;->delete(I)V
-
-    monitor-exit p0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    sget-object v0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mCredentialTypeCache:Landroid/util/SparseArray;
-
-    monitor-enter v0
-
-    :try_start_2
-    invoke-virtual {v0, p1}, Landroid/util/SparseArray;->delete(I)V
-
-    monitor-exit v0
 
     return-void
 
     :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :catchall_1
-    move-exception p1
-
-    :try_start_3
-    monitor-exit p0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    throw p1
-
-    :cond_1
-    :goto_0
-    return-void
-
-    :catchall_2
     move-exception p1
 
-    :try_start_4
     monitor-exit p0
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_2
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     throw p1
 .end method
@@ -13184,7 +13121,7 @@
 
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
-    move-result-wide v5
+    move-result-wide v6
 
     iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
@@ -13197,9 +13134,11 @@
     goto :goto_0
 
     :cond_0
-    const-string/jumbo p0, "pwd"
+    iget-object p0, v3, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {v3, p1, p0, v5, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    const-string/jumbo v4, "pwd"
+
+    invoke-virtual {p0, p1, v4, v6, v7}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object p0
 
@@ -13242,17 +13181,17 @@
 
     iput v2, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->pinLength:I
 
-    const-string/jumbo v7, "pwd"
+    const-string/jumbo v4, "pwd"
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->toBytes()[B
 
-    move-result-object v8
+    move-result-object v5
 
-    move v4, p1
+    move v8, p1
 
-    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
-    invoke-virtual {v3, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
+    invoke-virtual {v3, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
 
     :cond_4
     const/4 v2, 0x1
@@ -15548,34 +15487,12 @@
     return-void
 
     :cond_0
-    invoke-virtual {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->isSdpMdfppMode()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_1
-
-    iget-object v1, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    iget-object p2, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSdpToken:Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
-
-    iget p2, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;->secureMode:I
-
-    const-string v2, "ForFileSystem"
-
-    invoke-static {p2, v2, v1}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->personalize(ILjava/lang/String;[B)[B
-
-    move-result-object p2
-
-    goto :goto_0
-
-    :cond_1
     sget-object v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_FBE_KEY:[B
 
     invoke-virtual {p2, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
 
     move-result-object p2
 
-    :goto_0
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
     move-result-wide v1
@@ -15594,31 +15511,31 @@
 
     const/4 v5, 0x0
 
-    if-eqz v3, :cond_3
+    if-eqz v3, :cond_2
 
     :try_start_1
     invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
 
     move-result v3
 
-    if-eqz v3, :cond_2
+    if-eqz v3, :cond_1
 
     const-string v3, "Do not substitute outer-layer-key in case of DualDAR on DO!"
 
     invoke-static {v4, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_1
+    goto :goto_0
 
-    :cond_2
+    :cond_1
     const-string/jumbo v3, "need to get secret for DualDAR user"
 
     invoke-static {v4, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     const/4 v5, 0x1
 
-    :cond_3
-    :goto_1
-    if-eqz v5, :cond_4
+    :cond_2
+    :goto_0
+    if-eqz v5, :cond_3
 
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
 
@@ -15654,19 +15571,19 @@
 
     invoke-interface {p0, p1, p2}, Landroid/os/storage/IStorageManager;->setCeStorageProtection(I[B)V
 
-    goto :goto_2
+    goto :goto_1
 
     :catchall_0
     move-exception p0
 
-    goto :goto_4
+    goto :goto_3
 
     :catch_0
     move-exception p0
 
-    goto :goto_3
+    goto :goto_2
 
-    :cond_4
+    :cond_3
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorageManager:Landroid/os/storage/IStorageManager;
 
     invoke-interface {p0, p1, p2}, Landroid/os/storage/IStorageManager;->setCeStorageProtection(I[B)V
@@ -15674,12 +15591,12 @@
     .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :goto_2
+    :goto_1
     invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return-void
 
-    :goto_3
+    :goto_2
     :try_start_2
     new-instance p2, Ljava/lang/IllegalStateException;
 
@@ -15699,7 +15616,7 @@
     :try_end_2
     .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    :goto_4
+    :goto_3
     invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw p0
@@ -16008,15 +15925,15 @@
 
     invoke-virtual {v0, v15}, Lcom/android/server/locksettings/LockSettingsStorage;->removeUser(I)V
 
-    const-string/jumbo v0, "LockSettingsService.DarVirtualLock"
+    const-string/jumbo v0, "credential is NONE"
 
-    const-string/jumbo v1, "credential is NONE"
+    new-instance v1, Ljava/lang/Throwable;
 
-    new-instance v2, Ljava/lang/Throwable;
+    invoke-direct {v1}, Ljava/lang/Throwable;-><init>()V
 
-    invoke-direct {v2}, Ljava/lang/Throwable;-><init>()V
+    const-string/jumbo v2, "LockSettingsService.DarVirtualLock"
 
-    invoke-static {v0, v1, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
+    invoke-static {v2, v0, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
 
     return v9
 
@@ -16057,15 +15974,15 @@
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    const-string/jumbo v0, "LockSettingsService.DarVirtualLock"
+    const-string/jumbo v0, "progressing to set credential for virtual user"
 
-    const-string/jumbo v5, "progressing to set credential for virtual user"
+    new-instance v5, Ljava/lang/Throwable;
 
-    new-instance v6, Ljava/lang/Throwable;
+    invoke-direct {v5}, Ljava/lang/Throwable;-><init>()V
 
-    invoke-direct {v6}, Ljava/lang/Throwable;-><init>()V
+    const-string/jumbo v6, "LockSettingsService.DarVirtualLock"
 
-    invoke-static {v0, v5, v6}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
+    invoke-static {v6, v0, v5}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
 
     goto :goto_3
 
@@ -16503,34 +16420,11 @@
     invoke-virtual/range {v1 .. v7}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithSpLocked(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
 
     :goto_c
-    invoke-virtual {v2}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_11
-
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v0, v15, v6}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->prepareMasterKeyIfUnsecured(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-
-    :cond_11
     invoke-virtual {v1, v15, v8, v2}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnChangeIfRequired(IZLcom/android/internal/widget/LockscreenCredential;)V
 
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v0, v15, v6}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->initializeMasterKeyIfRequired(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-virtual {v2}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v3
-
-    invoke-virtual {v0, v3, v15}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->onCredentialChanged(II)V
-
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
 
-    invoke-virtual {v0, v15, v6}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->saveEscrowDataIfNeededLocked(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
+    invoke-virtual {v0, v15}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->saveEscrowDataIfNeededLocked(I)V
 
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
@@ -16542,7 +16436,7 @@
     :try_end_5
     .catchall {:try_start_5 .. :try_end_5} :catchall_2
 
-    if-eqz v0, :cond_12
+    if-eqz v0, :cond_11
 
     :try_start_6
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
@@ -16560,7 +16454,7 @@
     :try_start_7
     invoke-virtual {v0}, Landroid/os/RemoteException;->printStackTrace()V
 
-    :cond_12
+    :cond_11
     :goto_d
     monitor-exit v10
 
@@ -16767,8 +16661,15 @@
     move-result-object p2
 
     :cond_7
-    if-eqz v6, :cond_8
+    invoke-static {p3}, Lcom/samsung/android/knox/SemPersonaManager;->isSecureFolderId(I)Z
 
+    move-result v8
+
+    if-nez v8, :cond_8
+
+    if-eqz v6, :cond_9
+
+    :cond_8
     const-string/jumbo v6, "SEP-Lite User %d identified as SecureFolder user"
 
     invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
@@ -16799,55 +16700,21 @@
 
     const-string/jumbo p0, "sdp not supported : setSecureFolderLockCredential success"
 
-    invoke-static {v7, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return v2
-
-    :cond_8
-    :try_start_1
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUserId(I)Z
-
-    move-result v6
-
-    if-eqz v6, :cond_9
-
-    iget-object v6, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    invoke-static {v6, p1, p2, p3}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->-$$Nest$msetLockCredentialVariant(Lcom/android/server/locksettings/LockSettingsService$Injector$1;Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object v6
-
-    invoke-virtual {v6}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
-
-    move-result v6
-
-    if-eq v6, v2, :cond_9
-
-    const-string/jumbo p0, "sdp supported : setLockCredentialVariant success"
-
-    invoke-static {v7, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-
-    invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    invoke-static {v7, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return v2
 
     :cond_9
-    :try_start_2
+    :try_start_1
     iget-object v6, p0, Lcom/android/server/locksettings/LockSettingsService;->mSeparateChallengeLock:Ljava/lang/Object;
 
     monitor-enter v6
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
     if-eqz v3, :cond_a
 
@@ -16857,7 +16724,7 @@
     move v1, p3
 
     :goto_4
-    :try_start_3
+    :try_start_2
     invoke-virtual {p0, p1, p2, v1, v0}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialInternal(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
 
     move-result v1
@@ -16867,8 +16734,8 @@
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->scheduleGc()V
 
     monitor-exit v6
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_1
 
     invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
@@ -16880,7 +16747,7 @@
     goto :goto_6
 
     :cond_b
-    :try_start_4
+    :try_start_3
     invoke-virtual {p0, p3, v2, v7}, Lcom/android/server/locksettings/LockSettingsService;->setSeparateProfileChallengeEnabledLocked(IZLcom/android/internal/widget/LockscreenCredential;)V
 
     if-eqz p4, :cond_c
@@ -16898,10 +16765,10 @@
 
     :goto_5
     monitor-exit v6
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_1
 
-    :try_start_5
+    :try_start_4
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
 
     move-result p4
@@ -16945,23 +16812,23 @@
     invoke-static {p1, v2}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;Z)V
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->scheduleGc()V
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_0
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_0
 
     invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return v2
 
     :goto_6
-    :try_start_6
+    :try_start_5
     monitor-exit v6
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_1
+    :try_end_5
+    .catchall {:try_start_5 .. :try_end_5} :catchall_1
 
-    :try_start_7
+    :try_start_6
     throw p0
-    :try_end_7
-    .catchall {:try_start_7 .. :try_end_7} :catchall_0
+    :try_end_6
+    .catchall {:try_start_6 .. :try_end_6} :catchall_0
 
     :goto_7
     invoke-static {v4, v5}, Landroid/os/Binder;->restoreCallingIdentity(J)V
@@ -16970,39 +16837,39 @@
 .end method
 
 .method public final setLockCredentialWithSpLocked(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
-    .locals 19
+    .locals 21
 
     move-object/from16 v1, p0
 
-    move/from16 v3, p6
+    move/from16 v9, p6
 
     const-string/jumbo v0, "LockSettingsService"
 
     const-string v2, "Changing lockscreen credential of user %d; newCredentialType=%s\n"
 
-    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v4
+    move-result-object v3
 
     invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
-    move-result v5
+    move-result v4
 
-    invoke-static {v5}, Lcom/android/internal/widget/LockPatternUtils;->credentialTypeToString(I)Ljava/lang/String;
+    invoke-static {v4}, Lcom/android/internal/widget/LockPatternUtils;->credentialTypeToString(I)Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v4
 
-    filled-new-array {v4, v5}, [Ljava/lang/Object;
+    filled-new-array {v3, v4}, [Ljava/lang/Object;
 
-    move-result-object v4
+    move-result-object v3
 
-    invoke-static {v0, v2, v4}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v0, v2, v3}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    invoke-virtual {v1, v3}, Lcom/android/server/locksettings/LockSettingsService;->getCredentialTypeInternal(I)I
+    invoke-virtual {v1, v9}, Lcom/android/server/locksettings/LockSettingsService;->getCredentialTypeInternal(I)I
 
     move-result v10
 
-    invoke-virtual {v1, v3}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
+    invoke-virtual {v1, v9}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
     move-result-wide v11
 
@@ -17020,34 +16887,32 @@
 
     move-object/from16 v8, p5
 
-    move/from16 v9, p6
-
     invoke-virtual/range {v2 .. v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
 
     move-result-wide v13
 
-    move v3, v9
-
     invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v0
 
-    const-wide/16 v4, 0x0
+    const-wide/16 v2, 0x0
 
-    const/4 v15, 0x0
+    const/4 v4, 0x0
 
     if-nez v0, :cond_2
 
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    const-string/jumbo v2, "handle"
+    const-string/jumbo v5, "handle"
 
-    invoke-virtual {v0, v3, v2, v4, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasState(ILjava/lang/String;J)Z
+    invoke-virtual {v0, v9, v5, v2, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasState(ILjava/lang/String;J)Z
 
     move-result v0
 
     if-nez v0, :cond_1
 
+    move-wide v5, v2
+
     iget-object v2, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
@@ -17057,11 +16922,13 @@
     invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     :try_start_0
-    invoke-virtual {v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
+    sget-object v3, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_GK_AUTH:[B
 
-    move-result-object v6
+    invoke-virtual {v8, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
+
+    move-result-object v3
 
-    invoke-interface {v0, v3, v15, v15, v6}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
+    invoke-interface {v0, v9, v4, v4, v3}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
 
     move-result-object v0
     :try_end_0
@@ -17069,54 +16936,56 @@
 
     invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getResponseCode()I
 
-    move-result v6
+    move-result v3
 
-    if-nez v6, :cond_0
+    if-nez v3, :cond_0
 
-    invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getPayload()[B
+    move-object v3, v4
 
-    move-result-object v7
+    invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getPayload()[B
 
-    const-string/jumbo v6, "handle"
+    move-result-object v4
 
-    move-wide/from16 v16, v4
+    move-object v7, v3
 
-    const-wide/16 v4, 0x0
+    const-string/jumbo v3, "handle"
 
-    move/from16 v18, v10
+    move-wide/from16 v16, v5
 
-    move-wide/from16 v9, v16
+    const-wide/16 v5, 0x0
 
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    move v7, v9
 
-    invoke-virtual {v2, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
+    move-wide/from16 v19, v16
 
-    iget-object v2, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    move/from16 v16, v10
 
-    invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+    move-wide/from16 v9, v19
 
-    move-result-object v6
+    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
-    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v2, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
 
-    invoke-virtual {v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
+    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    move-result-object v7
+    invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    const-wide/16 v4, 0x0
+    move-result-object v2
 
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallengeInternal(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {v0, v2, v8, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallenge(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)Lcom/android/internal/widget/VerifyCredentialResponse;
 
     goto :goto_0
 
     :cond_0
+    move v7, v9
+
     new-instance v1, Ljava/lang/IllegalStateException;
 
     const-string v2, "Fail to create new SID for user "
 
-    const-string v4, " response: "
+    const-string v3, " response: "
 
-    invoke-static {v3, v2, v4}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-static {v7, v2, v3}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     move-result-object v2
 
@@ -17146,33 +17015,37 @@
     throw v1
 
     :cond_1
-    move/from16 v18, v10
+    move v7, v9
+
+    move/from16 v16, v10
 
-    move-wide v9, v4
+    move-wide v9, v2
 
     :goto_0
-    move-object v2, v15
+    const/4 v4, 0x0
 
     goto/16 :goto_5
 
     :cond_2
-    move/from16 v18, v10
+    move v7, v9
+
+    move/from16 v16, v10
 
-    move-wide v9, v4
+    move-wide v9, v2
 
-    invoke-static {v3}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    invoke-static {v7}, Landroid/os/UserManager;->isVirtualUserId(I)Z
 
     move-result v0
 
     if-eqz v0, :cond_3
 
     :goto_1
-    move-object v2, v15
+    const/4 v4, 0x0
 
     goto :goto_4
 
     :cond_3
-    invoke-virtual {v1, v3}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
+    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
 
     move-result v0
 
@@ -17181,45 +17054,45 @@
     goto :goto_1
 
     :cond_4
-    new-instance v2, Landroid/util/ArrayMap;
+    new-instance v4, Landroid/util/ArrayMap;
 
-    invoke-direct {v2}, Landroid/util/ArrayMap;-><init>()V
+    invoke-direct {v4}, Landroid/util/ArrayMap;-><init>()V
 
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
-    invoke-virtual {v0, v3}, Landroid/os/UserManager;->getProfiles(I)Ljava/util/List;
+    invoke-virtual {v0, v7}, Landroid/os/UserManager;->getProfiles(I)Ljava/util/List;
 
-    move-result-object v4
+    move-result-object v2
 
-    invoke-interface {v4}, Ljava/util/List;->size()I
+    invoke-interface {v2}, Ljava/util/List;->size()I
 
-    move-result v5
+    move-result v3
 
-    const/4 v6, 0x0
+    const/4 v5, 0x0
 
     :goto_2
-    if-ge v6, v5, :cond_7
+    if-ge v5, v3, :cond_7
 
-    invoke-interface {v4, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;
+    invoke-interface {v2, v5}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
     move-result-object v0
 
     check-cast v0, Landroid/content/pm/UserInfo;
 
-    iget v7, v0, Landroid/content/pm/UserInfo;->id:I
+    iget v6, v0, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
+    invoke-virtual {v1, v6}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
 
-    move-result v7
+    move-result v6
 
-    if-nez v7, :cond_5
+    if-nez v6, :cond_5
 
     goto :goto_3
 
     :cond_5
-    iget v7, v0, Landroid/content/pm/UserInfo;->id:I
+    iget v6, v0, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
+    invoke-virtual {v1, v6}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
 
     move-result v0
 
@@ -17229,15 +17102,15 @@
 
     :cond_6
     :try_start_1
-    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v0
 
-    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->getDecryptedPasswordForTiedProfile(I)Lcom/android/internal/widget/LockscreenCredential;
+    invoke-virtual {v1, v6}, Lcom/android/server/locksettings/LockSettingsService;->getDecryptedPasswordForTiedProfile(I)Lcom/android/internal/widget/LockscreenCredential;
 
     move-result-object v15
 
-    invoke-virtual {v2, v0, v15}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {v4, v0, v15}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     :try_end_1
     .catch Ljava/security/KeyStoreException; {:try_start_1 .. :try_end_1} :catch_1
     .catch Ljava/security/UnrecoverableKeyException; {:try_start_1 .. :try_end_1} :catch_1
@@ -17261,76 +17134,74 @@
 
     invoke-direct {v15, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v15, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v15, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v7
+    move-result-object v6
 
     const-string/jumbo v9, "LockSettingsService"
 
-    invoke-static {v9, v7, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    invoke-static {v9, v6, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
     :goto_3
-    add-int/lit8 v6, v6, 0x1
+    add-int/lit8 v5, v5, 0x1
 
     const-wide/16 v9, 0x0
 
-    const/4 v15, 0x0
-
     goto :goto_2
 
     :cond_7
     :goto_4
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    const-string/jumbo v4, "handle"
+    const-string/jumbo v2, "handle"
 
     const-wide/16 v9, 0x0
 
-    invoke-virtual {v0, v3, v4, v9, v10}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyState(ILjava/lang/String;J)V
+    invoke-virtual {v0, v7, v2, v9, v10}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyState(ILjava/lang/String;J)V
 
-    invoke-static {v3, v9, v10, v4}, Lcom/samsung/android/lock/SPBnRManager;->deleteBackup(IJLjava/lang/String;)Z
+    invoke-static {v7, v9, v10, v2}, Lcom/samsung/android/lock/SPBnRManager;->deleteBackup(IJLjava/lang/String;)Z
 
-    invoke-virtual {v1, v3}, Lcom/android/server/locksettings/LockSettingsService;->gateKeeperClearSecureUserId(I)V
+    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->gateKeeperClearSecureUserId(I)V
 
-    invoke-virtual {v1, v3, v8}, Lcom/android/server/locksettings/LockSettingsService;->unlockCeStorage(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
+    invoke-virtual {v1, v7, v8}, Lcom/android/server/locksettings/LockSettingsService;->unlockCeStorage(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
 
-    invoke-virtual {v1, v3, v8}, Lcom/android/server/locksettings/LockSettingsService;->unlockKeystore(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
+    invoke-virtual {v1, v7, v8}, Lcom/android/server/locksettings/LockSettingsService;->unlockKeystore(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
 
-    invoke-static {v3}, Landroid/security/AndroidKeyStoreMaintenance;->onUserLskfRemoved(I)I
+    invoke-static {v7}, Landroid/security/AndroidKeyStoreMaintenance;->onUserLskfRemoved(I)I
 
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;
+    new-instance v2, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;
 
-    const/4 v5, 0x0
+    const/4 v3, 0x0
 
-    invoke-direct {v4, v3, v5, v1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;-><init>(IILjava/lang/Object;)V
+    invoke-direct {v2, v7, v3, v1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;-><init>(IILjava/lang/Object;)V
 
-    invoke-virtual {v0, v4}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+    invoke-virtual {v0, v2}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
     :goto_5
-    invoke-virtual {v1, v3, v13, v14}, Lcom/android/server/locksettings/LockSettingsService;->setCurrentLskfBasedProtectorId(IJ)V
+    invoke-virtual {v1, v7, v13, v14}, Lcom/android/server/locksettings/LockSettingsService;->setCurrentLskfBasedProtectorId(IJ)V
 
     invoke-static {}, Lcom/android/internal/widget/LockPatternUtils;->invalidateCredentialTypeCache()V
 
-    invoke-static {v3}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    invoke-static {v7}, Landroid/os/UserManager;->isVirtualUserId(I)Z
 
     move-result v0
 
-    const/4 v4, 0x1
+    const/4 v2, 0x1
 
     if-eqz v0, :cond_9
 
     :cond_8
     :goto_6
-    move-object/from16 v7, p1
+    move-object/from16 v3, p1
 
     goto/16 :goto_a
 
     :cond_9
-    invoke-virtual {v1, v3}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
+    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialShareableWithParent(I)Z
 
     move-result v0
 
@@ -17339,62 +17210,62 @@
     goto :goto_6
 
     :cond_a
-    invoke-virtual {v1, v3}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
+    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
 
     move-result v0
 
-    iget-object v5, v1, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
+    iget-object v3, v1, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
-    invoke-virtual {v5, v3}, Landroid/os/UserManager;->getProfiles(I)Ljava/util/List;
+    invoke-virtual {v3, v7}, Landroid/os/UserManager;->getProfiles(I)Ljava/util/List;
 
-    move-result-object v5
+    move-result-object v3
 
-    invoke-interface {v5}, Ljava/util/List;->size()I
+    invoke-interface {v3}, Ljava/util/List;->size()I
 
-    move-result v6
+    move-result v5
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    new-instance v6, Ljava/lang/StringBuilder;
 
     const-string/jumbo v8, "Synchronize challenge along with user "
 
-    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v6, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v7
+    move-result-object v6
 
-    invoke-static {v7}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
+    invoke-static {v6}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v7
+    move-result-object v6
 
     invoke-static {v0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
 
     move-result-object v8
 
-    filled-new-array {v7, v8}, [Ljava/lang/Object;
+    filled-new-array {v6, v8}, [Ljava/lang/Object;
 
-    move-result-object v7
+    move-result-object v6
 
     const-string v8, "Feasible for profiles(%d) ? %b"
 
-    invoke-static {v8, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v8, v6}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v7
+    move-result-object v6
 
     const/4 v8, 0x0
 
-    invoke-static {v8, v7}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v8, v6}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    const/4 v7, 0x0
+    const/4 v6, 0x0
 
     :goto_7
-    if-ge v7, v6, :cond_8
+    if-ge v6, v5, :cond_8
 
-    invoke-interface {v5, v7}, Ljava/util/List;->get(I)Ljava/lang/Object;
+    invoke-interface {v3, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
     move-result-object v8
 
@@ -17434,13 +17305,13 @@
     :cond_d
     const-string/jumbo v9, "Profile("
 
-    if-eqz v2, :cond_e
+    if-eqz v4, :cond_e
 
     invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v10
 
-    invoke-virtual {v2, v10}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z
+    invoke-virtual {v4, v10}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z
 
     move-result v10
 
@@ -17472,13 +17343,13 @@
 
     move-result-object v10
 
-    invoke-virtual {v2, v10}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {v4, v10}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
 
     move-result-object v10
 
     check-cast v10, Lcom/android/internal/widget/LockscreenCredential;
 
-    invoke-virtual {v1, v9, v10, v8, v4}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialInternal(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
+    invoke-virtual {v1, v9, v10, v8, v2}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialInternal(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
 
     iget-object v9, v1, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
@@ -17518,20 +17389,20 @@
     invoke-static {v8, v9}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I
 
     :goto_9
-    add-int/lit8 v7, v7, 0x1
+    add-int/lit8 v6, v6, 0x1
 
     goto/16 :goto_7
 
     :goto_a
-    invoke-virtual {v1, v7, v3}, Lcom/android/server/locksettings/LockSettingsService;->setUserPasswordMetrics(Lcom/android/internal/widget/LockscreenCredential;I)V
+    invoke-virtual {v1, v3, v7}, Lcom/android/server/locksettings/LockSettingsService;->setUserPasswordMetrics(Lcom/android/internal/widget/LockscreenCredential;I)V
 
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mUnifiedProfilePasswordCache:Lcom/android/server/locksettings/UnifiedProfilePasswordCache;
 
-    invoke-virtual {v0, v3}, Lcom/android/server/locksettings/UnifiedProfilePasswordCache;->removePassword(I)V
+    invoke-virtual {v0, v7}, Lcom/android/server/locksettings/UnifiedProfilePasswordCache;->removePassword(I)V
 
     const/4 v0, -0x1
 
-    move/from16 v5, v18
+    move/from16 v5, v16
 
     if-eq v5, v0, :cond_10
 
@@ -17541,68 +17412,66 @@
 
     const-string/jumbo v9, "spblob"
 
-    invoke-virtual {v8, v3, v9}, Lcom/android/server/locksettings/LockSettingsStorage;->listSyntheticPasswordProtectorsForUser(ILjava/lang/String;)Ljava/util/List;
+    invoke-virtual {v8, v7, v9}, Lcom/android/server/locksettings/LockSettingsStorage;->listSyntheticPasswordProtectorsForUser(ILjava/lang/String;)Ljava/util/List;
 
-    move-result-object v8
+    move-result-object v10
 
-    check-cast v8, Ljava/util/ArrayList;
+    check-cast v10, Ljava/util/ArrayList;
 
-    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I
+    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I
 
-    move-result v10
+    move-result v15
 
-    const/4 v15, 0x0
+    const/4 v2, 0x0
 
     :goto_b
-    if-ge v15, v10, :cond_10
+    if-ge v2, v15, :cond_10
 
-    invoke-virtual {v8, v15}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    invoke-virtual {v10, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
-    move-result-object v18
+    move-result-object v16
 
-    add-int/lit8 v15, v15, 0x1
+    add-int/lit8 v2, v2, 0x1
 
-    check-cast v18, Ljava/lang/Long;
+    check-cast v16, Ljava/lang/Long;
 
-    invoke-virtual/range {v18 .. v18}, Ljava/lang/Long;->longValue()J
+    invoke-virtual/range {v16 .. v16}, Ljava/lang/Long;->longValue()J
 
     move-result-wide v0
 
-    invoke-virtual {v6, v3, v9, v0, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {v8, v7, v9, v0, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
-    move-result-object v18
+    move-result-object v16
 
-    invoke-static/range {v18 .. v18}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;
+    move/from16 v18, v2
 
-    move-result-object v4
+    invoke-static/range {v16 .. v16}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;
 
-    iget-byte v4, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
+    move-result-object v2
 
-    move-object/from16 p5, v2
+    iget-byte v2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
 
-    const/4 v2, 0x2
+    const/4 v3, 0x2
 
-    if-ne v4, v2, :cond_f
+    if-ne v2, v3, :cond_f
 
-    invoke-virtual {v6, v3, v0, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyTokenBasedProtector(IJ)V
+    invoke-virtual {v6, v7, v0, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyTokenBasedProtector(IJ)V
 
     :cond_f
-    move-object/from16 v2, p5
-
     const/4 v0, -0x1
 
-    const/4 v4, 0x1
-
     move-object/from16 v1, p0
 
+    move-object/from16 v3, p1
+
+    move/from16 v2, v18
+
     goto :goto_b
 
     :cond_10
-    move-object/from16 p5, v2
+    if-eqz v4, :cond_11
 
-    if-eqz p5, :cond_11
-
-    invoke-virtual/range {p5 .. p5}, Landroid/util/ArrayMap;->entrySet()Ljava/util/Set;
+    invoke-virtual {v4}, Landroid/util/ArrayMap;->entrySet()Ljava/util/Set;
 
     move-result-object v0
 
@@ -17644,27 +17513,27 @@
 
     if-eq v5, v0, :cond_12
 
-    invoke-virtual {v7}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
     move-result v1
 
     if-eq v1, v0, :cond_12
 
-    if-nez v3, :cond_12
+    if-nez v7, :cond_12
 
     move-object/from16 v1, p0
 
-    invoke-virtual {v1, v3}, Lcom/android/server/locksettings/LockSettingsService;->getBackupLskfBasedProtectorId(I)J
+    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->getBackupLskfBasedProtectorId(I)J
 
-    move-result-wide v4
+    move-result-wide v2
 
-    const-wide/16 v16, 0x0
+    const-wide/16 v9, 0x0
 
-    cmp-long v0, v4, v16
+    cmp-long v0, v2, v9
 
     if-nez v0, :cond_13
 
-    invoke-virtual {v1, v3, v11, v12}, Lcom/android/server/locksettings/LockSettingsService;->setBackupLskfBasedProtectorId(IJ)V
+    invoke-virtual {v1, v7, v11, v12}, Lcom/android/server/locksettings/LockSettingsService;->setBackupLskfBasedProtectorId(IJ)V
 
     goto :goto_d
 
@@ -17674,24 +17543,24 @@
     :cond_13
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {v0, v3, v11, v12}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyLskfBasedProtector(IJ)V
+    invoke-virtual {v0, v7, v11, v12}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyLskfBasedProtector(IJ)V
 
     :goto_d
     const-string/jumbo v0, "LockSettingsService"
 
     const-string/jumbo v2, "Successfully changed lockscreen credential of user %d"
 
-    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v4
+    move-result-object v3
 
-    filled-new-array {v4}, [Ljava/lang/Object;
+    filled-new-array {v3}, [Ljava/lang/Object;
 
-    move-result-object v4
+    move-result-object v3
 
-    invoke-static {v0, v2, v4}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v0, v2, v3}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    if-nez v3, :cond_17
+    if-nez v7, :cond_17
 
     invoke-virtual {v1, v13, v14}, Lcom/android/server/locksettings/LockSettingsService;->hasSecurityIntegrity(J)B
 
@@ -17710,9 +17579,9 @@
 
     const-string/jumbo v2, "SI Checker"
 
-    const/4 v4, 0x0
+    const/4 v3, 0x0
 
-    invoke-static {v4, v0, v2}, Lcom/samsung/android/lock/LsLog;->enrollRequest(IILjava/lang/String;)V
+    invoke-static {v3, v0, v2}, Lcom/samsung/android/lock/LsLog;->enrollRequest(IILjava/lang/String;)V
 
     iget-object v2, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
@@ -17723,21 +17592,21 @@
 
     move-result-object v0
 
-    invoke-virtual {v1, v4}, Lcom/android/server/locksettings/LockSettingsService;->getSICheckerId(I)J
+    invoke-virtual {v1, v3}, Lcom/android/server/locksettings/LockSettingsService;->getSICheckerId(I)J
 
-    move-result-wide v5
+    move-result-wide v4
 
-    iget-object v4, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v3, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {v4, v13, v14, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createSecurityIntegrity(JLcom/android/internal/widget/LockscreenCredential;)J
+    invoke-virtual {v3, v13, v14, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createSecurityIntegrity(JLcom/android/internal/widget/LockscreenCredential;)J
 
-    move-result-wide v7
+    move-result-wide v8
 
     invoke-virtual {v0}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
 
     const-wide/16 v16, 0x0
 
-    cmp-long v0, v7, v16
+    cmp-long v0, v8, v16
 
     if-nez v0, :cond_15
 
@@ -17751,7 +17620,7 @@
     goto :goto_f
 
     :cond_15
-    invoke-static {v7, v8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
     move-result-object v0
 
@@ -17759,47 +17628,47 @@
 
     move-result-object v0
 
-    const-string v4, "!@ setSecurityIntegrityIds : %016x"
+    const-string v3, "!@ setSecurityIntegrityIds : %016x"
 
-    invoke-static {v4, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v3, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
     move-result-object v0
 
-    const-string/jumbo v4, "LockSettingsService"
+    const-string/jumbo v3, "LockSettingsService"
 
-    invoke-static {v4, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v3, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
     const-string/jumbo v0, "locksettings_si_checker_id"
 
-    const/4 v4, 0x0
+    const/4 v3, 0x0
 
-    invoke-virtual {v1, v0, v7, v8, v4}, Lcom/android/server/locksettings/LockSettingsService;->setLong(Ljava/lang/String;JI)V
+    invoke-virtual {v1, v0, v8, v9, v3}, Lcom/android/server/locksettings/LockSettingsService;->setLong(Ljava/lang/String;JI)V
 
     const-string/jumbo v0, "locksettings_si_protector_id"
 
-    invoke-virtual {v1, v0, v13, v14, v4}, Lcom/android/server/locksettings/LockSettingsService;->setLong(Ljava/lang/String;JI)V
+    invoke-virtual {v1, v0, v13, v14, v3}, Lcom/android/server/locksettings/LockSettingsService;->setLong(Ljava/lang/String;JI)V
 
-    const-wide/16 v16, 0x0
+    const-wide/16 v9, 0x0
 
-    cmp-long v0, v5, v16
+    cmp-long v0, v4, v9
 
     if-eqz v0, :cond_16
 
     iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {v0, v4, v5, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyWeaverSlot(IJ)V
+    invoke-virtual {v0, v3, v4, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyWeaverSlot(IJ)V
 
     const-string/jumbo v0, "Remove SI Checker! ID=[%016x]"
 
-    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {v4, v5}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    move-result-object v4
+    move-result-object v3
 
-    filled-new-array {v4}, [Ljava/lang/Object;
+    filled-new-array {v3}, [Ljava/lang/Object;
 
-    move-result-object v4
+    move-result-object v3
 
-    invoke-static {v0, v4}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v0, v3}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
     move-result-object v0
 
@@ -17811,15 +17680,15 @@
     .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
     :goto_e
-    invoke-virtual {v1, v3}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
+    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
-    move-result-wide v4
+    move-result-wide v2
 
-    invoke-virtual {v1, v3}, Lcom/android/server/locksettings/LockSettingsService;->getSICheckerId(I)J
+    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/LockSettingsService;->getSICheckerId(I)J
 
     move-result-wide v0
 
-    invoke-static {v4, v5, v0, v1}, Lcom/samsung/android/lock/LsLog;->setCurIds(JJ)V
+    invoke-static {v2, v3, v0, v1}, Lcom/samsung/android/lock/LsLog;->setCurIds(JJ)V
 
     goto :goto_10
 
@@ -17966,22 +17835,6 @@
     return v9
 
     :cond_2
-    if-eqz p1, :cond_3
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_4
-
-    :cond_3
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
-
-    iget-object v3, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    invoke-virtual {v2, p5, v3}, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->prepareMasterKeyIfUnsecured(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-
-    :cond_4
     iget-object v2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
     invoke-virtual {p0, p5, v2, v9}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordKnown(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Z)V
@@ -19250,23 +19103,6 @@
 .method public final setUserPasswordMetrics(Lcom/android/internal/widget/LockscreenCredential;I)V
     .locals 1
 
-    invoke-static {p2}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {v0, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    return-void
-
-    :cond_0
     monitor-enter p0
 
     :try_start_0
@@ -20893,7 +20729,7 @@
 
     if-eqz v2, :cond_0
 
-    goto/16 :goto_5
+    goto/16 :goto_4
 
     :cond_0
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isCeStorageUnlocked(I)Z
@@ -20933,34 +20769,14 @@
     const-string/jumbo v2, "unsecured"
 
     :goto_0
-    invoke-virtual {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->isSdpMdfppMode()Z
-
-    move-result v4
-
-    if-eqz v4, :cond_3
-
-    iget-object v4, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    iget-object p2, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSdpToken:Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
-
-    iget p2, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;->secureMode:I
-
-    const-string v5, "ForFileSystem"
-
-    invoke-static {p2, v5, v4}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->personalize(ILjava/lang/String;[B)[B
-
-    move-result-object p2
-
-    goto :goto_1
+    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    :cond_3
     sget-object v4, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_FBE_KEY:[B
 
     invoke-virtual {p2, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
 
     move-result-object p2
 
-    :goto_1
     :try_start_0
     iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
 
@@ -20970,30 +20786,30 @@
 
     const/4 v5, 0x0
 
-    if-eqz v4, :cond_5
+    if-eqz v4, :cond_4
 
     invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
 
     move-result v4
 
-    if-eqz v4, :cond_4
+    if-eqz v4, :cond_3
 
     const-string v4, "Do not substitute outer-layer-key in case of DualDAR on DO!"
 
     invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_2
+    goto :goto_1
 
-    :cond_4
+    :cond_3
     const-string/jumbo v4, "need to get secret for DualDAR user"
 
     invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     const/4 v5, 0x1
 
-    :cond_5
-    :goto_2
-    if-eqz v5, :cond_6
+    :cond_4
+    :goto_1
+    if-eqz v5, :cond_5
 
     iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$Injector$1;
 
@@ -21029,24 +20845,24 @@
 
     invoke-interface {p0, p1, v4}, Landroid/os/storage/IStorageManager;->unlockCeStorage(I[B)V
 
-    goto :goto_3
+    goto :goto_2
 
     :catchall_0
     move-exception p0
 
-    goto :goto_6
+    goto :goto_5
 
     :catch_0
     move-exception p0
 
-    goto :goto_4
+    goto :goto_3
 
-    :cond_6
+    :cond_5
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorageManager:Landroid/os/storage/IStorageManager;
 
     invoke-interface {p0, p1, p2}, Landroid/os/storage/IStorageManager;->unlockCeStorage(I[B)V
 
-    :goto_3
+    :goto_2
     const-string p0, "!@Unlocked CE storage for %s user %d"
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
@@ -21082,7 +20898,7 @@
 
     return-void
 
-    :goto_4
+    :goto_3
     :try_start_1
     const-string v1, "Failed to unlock CE storage for %s user %d"
 
@@ -21112,10 +20928,10 @@
 
     invoke-static {p2}, Lcom/android/internal/widget/LockPatternUtils;->zeroize([B)V
 
-    :goto_5
+    :goto_4
     return-void
 
-    :goto_6
+    :goto_5
     invoke-static {p2}, Lcom/android/internal/widget/LockPatternUtils;->zeroize([B)V
 
     throw p0
@@ -21135,7 +20951,15 @@
     :cond_0
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mKeyStoreAuthorization:Landroid/security/KeyStoreAuthorization;
 
-    invoke-virtual {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveKeyStorePassword()[B
+    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    sget-object v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_KEY_STORE_PASSWORD:[B
+
+    invoke-virtual {p2, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
+
+    move-result-object p2
+
+    invoke-static {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->bytesToHex([B)[B
 
     move-result-object p2
 
@@ -22039,268 +21863,9 @@
     return-wide v5
 .end method
 
-.method public final updatePasswordHistory(Lcom/android/internal/widget/LockscreenCredential;I)V
-    .locals 10
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isPattern()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    :goto_0
-    return-void
-
-    :cond_1
-    const-string/jumbo v0, "lockscreen.passwordhistory"
-
-    const/4 v1, 0x0
-
-    invoke-virtual {p0, v0, v1, p2}, Lcom/android/server/locksettings/LockSettingsService;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
-
-    move-result-object v2
-
-    const-string v3, ""
-
-    if-nez v2, :cond_2
-
-    move-object v2, v3
-
-    :cond_2
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {v4, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_3
-
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {v4, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
-
-    move-result v4
-
-    goto :goto_1
-
-    :cond_3
-    move v4, p2
-
-    :goto_1
-    iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
-
-    invoke-virtual {v5}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
-
-    move-result-object v5
-
-    invoke-virtual {v5, v1, v4}, Landroid/app/admin/DevicePolicyManager;->getPasswordHistoryLength(Landroid/content/ComponentName;I)I
-
-    move-result v1
-
-    if-nez v1, :cond_4
-
-    goto :goto_3
-
-    :cond_4
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v3
-
-    filled-new-array {v3}, [Ljava/lang/Object;
-
-    move-result-object v3
-
-    const-string v4, "Adding new password to password history for user %d"
-
-    const-string/jumbo v5, "LockSettingsService"
-
-    invoke-static {v5, v4, v3}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->getHashFactor(Lcom/android/internal/widget/LockscreenCredential;I)[B
-
-    move-result-object v3
-
-    const-string/jumbo v4, "lockscreen.password_salt"
-
-    const-wide/16 v6, 0x0
-
-    invoke-virtual {p0, v4, v6, v7, p2}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
-
-    move-result-wide v8
-
-    cmp-long v6, v8, v6
-
-    if-nez v6, :cond_5
-
-    sget-object v6, Lcom/android/server/locksettings/SecureRandomUtils;->RNG:Ljava/security/SecureRandom;
-
-    invoke-virtual {v6}, Ljava/security/SecureRandom;->nextLong()J
-
-    move-result-wide v8
-
-    invoke-virtual {p0, v4, v8, v9, p2}, Lcom/android/server/locksettings/LockSettingsService;->setLong(Ljava/lang/String;JI)V
-
-    :cond_5
-    invoke-static {v8, v9}, Ljava/lang/Long;->toHexString(J)Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {v4}, Ljava/lang/String;->getBytes()[B
-
-    move-result-object v4
-
-    invoke-virtual {p1, v4, v3}, Lcom/android/internal/widget/LockscreenCredential;->passwordToHistoryHash([B[B)Ljava/lang/String;
-
-    move-result-object v3
-
-    if-nez v3, :cond_6
-
-    const-string p0, "Failed to compute password hash; password history won\'t be updated"
-
-    invoke-static {v5, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-
-    :cond_6
-    invoke-static {v2}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_7
-
-    goto :goto_3
-
-    :cond_7
-    const-string p1, ","
-
-    invoke-virtual {v2, p1}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;
-
-    move-result-object v2
-
-    new-instance v4, Ljava/util/StringJoiner;
-
-    invoke-direct {v4, p1}, Ljava/util/StringJoiner;-><init>(Ljava/lang/CharSequence;)V
-
-    invoke-virtual {v4, v3}, Ljava/util/StringJoiner;->add(Ljava/lang/CharSequence;)Ljava/util/StringJoiner;
-
-    const/4 p1, 0x0
-
-    :goto_2
-    add-int/lit8 v3, v1, -0x1
-
-    if-ge p1, v3, :cond_8
-
-    array-length v3, v2
-
-    if-ge p1, v3, :cond_8
-
-    aget-object v3, v2, p1
-
-    invoke-virtual {v4, v3}, Ljava/util/StringJoiner;->add(Ljava/lang/CharSequence;)Ljava/util/StringJoiner;
-
-    add-int/lit8 p1, p1, 0x1
-
-    goto :goto_2
-
-    :cond_8
-    invoke-virtual {v4}, Ljava/util/StringJoiner;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    :goto_3
-    invoke-virtual {p0, v0, v3, p2}, Lcom/android/server/locksettings/LockSettingsService;->setString(Ljava/lang/String;Ljava/lang/String;I)V
-
-    return-void
-.end method
-
 .method public final updateSdpMdfppForSystem(IJ)V
-    .locals 5
-
-    if-eqz p1, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->isWeaverSupported()Z
-
-    move-result v0
-
-    if-nez v0, :cond_2
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isDeviceOwner(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_2
-
-    const-wide/16 v0, 0x0
-
-    const/4 v2, 0x0
-
-    const-string/jumbo v3, "sdp-mdfppmode-for-system"
-
-    invoke-virtual {p0, v3, v0, v1, v2}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
-
-    move-result-wide v0
-
-    cmp-long v2, v0, p2
-
-    const/4 v4, 0x0
-
-    if-ltz v2, :cond_1
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p1, "Update SdpMdfpp for System for SdpMdfpp supported device. already set as : "
-
-    invoke-direct {p0, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, v0, v1}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v4, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :cond_1
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "Update SdpMdfpp for System for SdpMdfpp supported device. set : "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p2, p3}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v4, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p0, v3, p2, p3, p1}, Lcom/android/server/locksettings/LockSettingsService;->setLong(Ljava/lang/String;JI)V
+    .locals 0
 
-    :cond_2
-    :goto_0
     return-void
 .end method
 
@@ -22416,9 +21981,9 @@
 
     new-instance p1, Ljava/lang/Thread;
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
 
-    invoke-direct {v1, p0, v2, v3, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda20;-><init>(Lcom/android/server/locksettings/LockSettingsService;Landroid/content/Intent;Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;I)V
+    invoke-direct {v1, p0, v2, v3, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;-><init>(Lcom/android/server/locksettings/LockSettingsService;Landroid/content/Intent;Lcom/android/server/locksettings/LockSettingsService$UpdateVerifierServiceConnection;I)V
 
     const-string p0, "KMX_UPDATE_VERIFIER_SERVICE_CONNECTION"
 
@@ -23178,7 +22743,11 @@
 
     iget-object p0, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSdpMasterKey()[B
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    sget-object p1, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SDP_MASTER_KEY:[B
+
+    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
 
     move-result-object p0
 
diff --git a/smali/com/android/server/locksettings/LockSettingsStorage.smali b/smali/com/android/server/locksettings/LockSettingsStorage.smali
index 1542a569b..034a775e1 100644
--- a/smali/com/android/server/locksettings/LockSettingsStorage.smali
+++ b/smali/com/android/server/locksettings/LockSettingsStorage.smali
@@ -861,31 +861,6 @@
     return p0
 .end method
 
-.method public final getLong(Ljava/lang/String;JI)J
-    .locals 1
-
-    const/4 v0, 0x0
-
-    invoke-virtual {p0, p1, v0, p4}, Lcom/android/server/locksettings/LockSettingsStorage;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    return-wide p2
-
-    :cond_0
-    invoke-static {p0}, Ljava/lang/Long;->parseLong(Ljava/lang/String;)J
-
-    move-result-wide p0
-
-    return-wide p0
-.end method
-
 .method public final getOriginDbName()Ljava/lang/String;
     .locals 2
 
@@ -2203,6 +2178,20 @@
     return-object v0
 .end method
 
+.method public final readSyntheticPasswordState(ILjava/lang/String;J)[B
+    .locals 0
+
+    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/locksettings/LockSettingsStorage;->getSyntheticPasswordStateFileForUser(ILjava/lang/String;J)Ljava/io/File;
+
+    move-result-object p1
+
+    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->readFile(Ljava/io/File;)[B
+
+    move-result-object p0
+
+    return-object p0
+.end method
+
 .method public removeKey(Ljava/lang/String;I)V
     .locals 4
 
@@ -3014,11 +3003,7 @@
 
     const-string/jumbo v0, "spblob"
 
-    invoke-virtual {p0, v2, v0, p2, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->getSyntheticPasswordStateFileForUser(ILjava/lang/String;J)Ljava/io/File;
-
-    move-result-object p2
-
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->readFile(Ljava/io/File;)[B
+    invoke-virtual {p0, v2, v0, p2, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object p2
 
diff --git a/smali/com/android/server/locksettings/RebootEscrowManager.smali b/smali/com/android/server/locksettings/RebootEscrowManager.smali
index b32043c40..347b0bbc9 100644
--- a/smali/com/android/server/locksettings/RebootEscrowManager.smali
+++ b/smali/com/android/server/locksettings/RebootEscrowManager.smali
@@ -695,7 +695,7 @@
 .end method
 
 .method public final onEscrowRestoreComplete(ZILandroid/os/Handler;)V
-    .locals 17
+    .locals 18
 
     move-object/from16 v1, p0
 
@@ -731,13 +731,15 @@
 
     sub-int/2addr v4, v2
 
+    const/4 v11, 0x0
+
     if-nez v3, :cond_0
 
-    if-eq v2, v5, :cond_7
+    if-eq v2, v5, :cond_8
 
     const/4 v2, 0x5
 
-    if-gt v4, v2, :cond_7
+    if-gt v4, v2, :cond_8
 
     :cond_0
     iget-object v2, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mInjector:Lcom/android/server/locksettings/RebootEscrowManager$Injector;
@@ -768,31 +770,47 @@
 
     iget-object v8, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-wide/16 v11, -0x1
+    invoke-virtual {v8, v7, v11, v10}, Lcom/android/server/locksettings/LockSettingsStorage;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
+
+    move-result-object v7
+
+    invoke-static {v7}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
+
+    move-result v9
 
-    invoke-virtual {v8, v7, v11, v12, v10}, Lcom/android/server/locksettings/LockSettingsStorage;->getLong(Ljava/lang/String;JI)J
+    const-wide/16 v12, -0x1
 
-    move-result-wide v13
+    if-eqz v9, :cond_2
 
+    move-wide v14, v12
+
+    goto :goto_1
+
+    :cond_2
+    invoke-static {v7}, Ljava/lang/Long;->parseLong(Ljava/lang/String;)J
+
+    move-result-wide v14
+
+    :goto_1
     invoke-static {}, Ljava/lang/System;->currentTimeMillis()J
 
-    move-result-wide v15
+    move-result-wide v16
 
-    cmp-long v7, v13, v11
+    cmp-long v7, v14, v12
 
-    if-eqz v7, :cond_2
+    if-eqz v7, :cond_3
 
-    cmp-long v7, v15, v13
+    cmp-long v7, v16, v14
 
-    if-lez v7, :cond_2
+    if-lez v7, :cond_3
 
-    sub-long v11, v15, v13
+    sub-long v12, v16, v14
 
-    long-to-int v2, v11
+    long-to-int v2, v12
 
     div-int/lit16 v2, v2, 0x3e8
 
-    :cond_2
+    :cond_3
     move v7, v2
 
     const-string/jumbo v2, "ro.boot.vbmeta.digest"
@@ -803,64 +821,64 @@
 
     const-string/jumbo v9, "reboot_escrow_key_vbmeta_digest"
 
-    const-string v11, ""
+    const-string v12, ""
 
-    invoke-virtual {v8, v9, v11, v10}, Lcom/android/server/locksettings/LockSettingsStorage;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
+    invoke-virtual {v8, v9, v12, v10}, Lcom/android/server/locksettings/LockSettingsStorage;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
 
     move-result-object v9
 
-    const-string/jumbo v12, "reboot_escrow_key_other_vbmeta_digest"
+    const-string/jumbo v13, "reboot_escrow_key_other_vbmeta_digest"
 
-    invoke-virtual {v8, v12, v11, v10}, Lcom/android/server/locksettings/LockSettingsStorage;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
+    invoke-virtual {v8, v13, v12, v10}, Lcom/android/server/locksettings/LockSettingsStorage;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
 
     move-result-object v8
 
     invoke-virtual {v8}, Ljava/lang/String;->isEmpty()Z
 
-    move-result v11
+    move-result v12
 
-    if-eqz v11, :cond_4
+    if-eqz v12, :cond_5
 
     invoke-virtual {v2, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v2
 
-    if-eqz v2, :cond_3
+    if-eqz v2, :cond_4
 
-    :goto_1
+    :goto_2
     move v8, v10
 
-    goto :goto_2
+    goto :goto_3
 
-    :cond_3
+    :cond_4
     move v8, v4
 
-    goto :goto_2
+    goto :goto_3
 
-    :cond_4
+    :cond_5
     invoke-virtual {v2, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v8
 
-    if-eqz v8, :cond_5
+    if-eqz v8, :cond_6
 
-    goto :goto_1
+    goto :goto_2
 
-    :cond_5
+    :cond_6
     invoke-virtual {v2, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v2
 
-    if-eqz v2, :cond_3
+    if-eqz v2, :cond_4
 
     move v8, v6
 
-    :goto_2
-    if-nez v3, :cond_6
+    :goto_3
+    if-nez v3, :cond_7
 
     invoke-virtual {v1, v0, v10, v6}, Lcom/android/server/locksettings/RebootEscrowManager;->compareAndSetLoadEscrowDataErrorCode(Landroid/os/Handler;II)V
 
-    :cond_6
+    :cond_7
     const-string/jumbo v2, "Reporting RoR recovery metrics, success: "
 
     const-string v4, ", service type: "
@@ -889,7 +907,7 @@
 
     invoke-virtual {v1, v10, v0}, Lcom/android/server/locksettings/RebootEscrowManager;->setLoadEscrowDataErrorCode(ILandroid/os/Handler;)V
 
-    :cond_7
+    :cond_8
     iget-object v0, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mKeyStoreManager:Lcom/android/server/locksettings/RebootEscrowKeyStoreManager;
 
     iget-object v2, v0, Lcom/android/server/locksettings/RebootEscrowKeyStoreManager;->mKeyStoreLock:Ljava/lang/Object;
@@ -919,12 +937,12 @@
     .catch Ljava/security/GeneralSecurityException; {:try_start_0 .. :try_end_0} :catch_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    goto :goto_3
+    goto :goto_4
 
     :catchall_0
     move-exception v0
 
-    goto :goto_5
+    goto :goto_6
 
     :catch_0
     move-exception v0
@@ -936,22 +954,20 @@
 
     invoke-static {v3, v4, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    :goto_3
+    :goto_4
     monitor-exit v2
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
     iget-object v0, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mInjector:Lcom/android/server/locksettings/RebootEscrowManager$Injector;
 
-    const/4 v2, 0x0
-
-    iput-object v2, v0, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->mRebootEscrowProvider:Lcom/android/server/locksettings/RebootEscrowProviderInterface;
+    iput-object v11, v0, Lcom/android/server/locksettings/RebootEscrowManager$Injector;->mRebootEscrowProvider:Lcom/android/server/locksettings/RebootEscrowProviderInterface;
 
     invoke-virtual {v1}, Lcom/android/server/locksettings/RebootEscrowManager;->clearMetricsStorage()V
 
     iget-object v0, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mNetworkCallback:Lcom/android/server/locksettings/RebootEscrowManager$1;
 
-    if-eqz v0, :cond_9
+    if-eqz v0, :cond_a
 
     iget-object v2, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mInjector:Lcom/android/server/locksettings/RebootEscrowManager$Injector;
 
@@ -965,25 +981,25 @@
 
     check-cast v2, Landroid/net/ConnectivityManager;
 
-    if-nez v2, :cond_8
+    if-nez v2, :cond_9
 
-    goto :goto_4
+    goto :goto_5
 
-    :cond_8
+    :cond_9
     invoke-virtual {v2, v0}, Landroid/net/ConnectivityManager;->unregisterNetworkCallback(Landroid/net/ConnectivityManager$NetworkCallback;)V
 
-    :cond_9
-    :goto_4
+    :cond_a
+    :goto_5
     iget-object v0, v1, Lcom/android/server/locksettings/RebootEscrowManager;->mWakeLock:Landroid/os/PowerManager$WakeLock;
 
-    if-eqz v0, :cond_a
+    if-eqz v0, :cond_b
 
     invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->release()V
 
-    :cond_a
+    :cond_b
     return-void
 
-    :goto_5
+    :goto_6
     :try_start_2
     monitor-exit v2
     :try_end_2
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordCrypto.smali b/smali/com/android/server/locksettings/SyntheticPasswordCrypto.smali
index 11e7bf81c..8d60919ed 100644
--- a/smali/com/android/server/locksettings/SyntheticPasswordCrypto.smali
+++ b/smali/com/android/server/locksettings/SyntheticPasswordCrypto.smali
@@ -22,70 +22,6 @@
     return-void
 .end method
 
-.method public static varargs decrypt(Ljavax/crypto/SecretKey;[B[[B)[B
-    .locals 5
-
-    if-nez p1, :cond_0
-
-    const-string/jumbo p0, "add_decrypt, blob is null"
-
-    const/4 p1, 0x1
-
-    invoke-static {p0, p1}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
-
-    const/4 p0, 0x0
-
-    return-object p0
-
-    :cond_0
-    const/4 v0, 0x0
-
-    const/16 v1, 0xc
-
-    invoke-static {p1, v0, v1}, Ljava/util/Arrays;->copyOfRange([BII)[B
-
-    move-result-object v2
-
-    array-length v3, p1
-
-    invoke-static {p1, v1, v3}, Ljava/util/Arrays;->copyOfRange([BII)[B
-
-    move-result-object p1
-
-    const-string v1, "AES/GCM/NoPadding"
-
-    invoke-static {v1}, Ljavax/crypto/Cipher;->getInstance(Ljava/lang/String;)Ljavax/crypto/Cipher;
-
-    move-result-object v1
-
-    new-instance v3, Ljavax/crypto/spec/GCMParameterSpec;
-
-    const/16 v4, 0x80
-
-    invoke-direct {v3, v4, v2}, Ljavax/crypto/spec/GCMParameterSpec;-><init>(I[B)V
-
-    const/4 v2, 0x2
-
-    invoke-virtual {v1, v2, p0, v3}, Ljavax/crypto/Cipher;->init(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
-
-    invoke-static {p2}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$Utils;->hasAAD([[B)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_1
-
-    aget-object p0, p2, v0
-
-    invoke-virtual {v1, p0}, Ljavax/crypto/Cipher;->updateAAD([B)V
-
-    :cond_1
-    invoke-virtual {v1, p1}, Ljavax/crypto/Cipher;->doFinal([B)[B
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public static decrypt([BLjavax/crypto/SecretKey;)[B
     .locals 4
 
@@ -206,349 +142,6 @@
     return-object p0
 .end method
 
-.method public static varargs decrypt([B[B[B[[B)[B
-    .locals 8
-
-    invoke-static {p3}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$Utils;->hasAAD([[B)Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    const/4 v2, 0x1
-
-    const-string/jumbo v3, "add_decrypt, Failed to decrypt"
-
-    const-string v4, "Failed to decrypt"
-
-    const-string/jumbo v5, "SyntheticPasswordCrypto"
-
-    const-string v6, "AES"
-
-    const/16 v7, 0x20
-
-    if-eqz v0, :cond_0
-
-    new-instance p1, Ljavax/crypto/spec/SecretKeySpec;
-
-    invoke-static {p0, v7}, Ljava/util/Arrays;->copyOf([BI)[B
-
-    move-result-object p0
-
-    invoke-direct {p1, p0, v6}, Ljavax/crypto/spec/SecretKeySpec;-><init>([BLjava/lang/String;)V
-
-    :try_start_0
-    invoke-static {p1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decrypt(Ljavax/crypto/SecretKey;[B[[B)[B
-
-    move-result-object p0
-    :try_end_0
-    .catch Ljava/security/InvalidKeyException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljavax/crypto/NoSuchPaddingException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljavax/crypto/IllegalBlockSizeException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljavax/crypto/BadPaddingException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/security/InvalidAlgorithmParameterException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-object p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-static {v5, v4, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p0, v2}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
-
-    return-object v1
-
-    :cond_0
-    filled-new-array {p0}, [[B
-
-    move-result-object p0
-
-    invoke-static {p1, p0}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->personalizedHash([B[[B)[B
-
-    move-result-object p0
-
-    new-instance p1, Ljavax/crypto/spec/SecretKeySpec;
-
-    invoke-static {p0, v7}, Ljava/util/Arrays;->copyOf([BI)[B
-
-    move-result-object p0
-
-    invoke-direct {p1, p0, v6}, Ljavax/crypto/spec/SecretKeySpec;-><init>([BLjava/lang/String;)V
-
-    :try_start_1
-    invoke-static {p2, p1}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decrypt([BLjavax/crypto/SecretKey;)[B
-
-    move-result-object p0
-    :try_end_1
-    .catch Ljava/security/InvalidKeyException; {:try_start_1 .. :try_end_1} :catch_1
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_1 .. :try_end_1} :catch_1
-    .catch Ljavax/crypto/NoSuchPaddingException; {:try_start_1 .. :try_end_1} :catch_1
-    .catch Ljavax/crypto/IllegalBlockSizeException; {:try_start_1 .. :try_end_1} :catch_1
-    .catch Ljavax/crypto/BadPaddingException; {:try_start_1 .. :try_end_1} :catch_1
-    .catch Ljava/security/InvalidAlgorithmParameterException; {:try_start_1 .. :try_end_1} :catch_1
-
-    return-object p0
-
-    :catch_1
-    move-exception p0
-
-    invoke-static {v5, v4, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p0, v2}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
-
-    return-object v1
-.end method
-
-.method public static decryptBlobV1(Ljava/lang/String;[B[B)[B
-    .locals 5
-
-    const-string/jumbo v0, "SP protector key is missing: "
-
-    const-string/jumbo v1, "decryptBlobV1(), SP protector key is missing: "
-
-    const/4 v2, 0x1
-
-    :try_start_0
-    invoke-static {}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->getKeyStore()Ljava/security/KeyStore;
-
-    move-result-object v3
-
-    const/4 v4, 0x0
-
-    invoke-virtual {v3, p0, v4}, Ljava/security/KeyStore;->getKey(Ljava/lang/String;[C)Ljava/security/Key;
-
-    move-result-object v3
-
-    check-cast v3, Ljavax/crypto/SecretKey;
-
-    if-eqz v3, :cond_0
-
-    sget-object p0, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->PROTECTOR_SECRET_PERSONALIZATION:[B
-
-    invoke-static {p2, p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decrypt([B[B[B)[B
-
-    move-result-object p0
-
-    invoke-static {p0, v3}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decrypt([BLjavax/crypto/SecretKey;)[B
-
-    move-result-object p0
-
-    return-object p0
-
-    :catch_0
-    move-exception p0
-
-    goto :goto_0
-
-    :cond_0
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p1, v2}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
-
-    new-instance p1, Ljava/lang/IllegalStateException;
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p2, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-direct {p1, p0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
-
-    throw p1
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    :goto_0
-    const-string/jumbo p1, "SyntheticPasswordCrypto"
-
-    const-string p2, "Failed to decrypt V1 blob"
-
-    invoke-static {p1, p2, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo p2, "decryptBlobV1(), Failed to decrypt V1 blob "
-
-    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-static {p1, v2}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
-
-    new-instance p1, Ljava/lang/IllegalStateException;
-
-    const-string p2, "Failed to decrypt blob"
-
-    invoke-direct {p1, p2, p0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    throw p1
-.end method
-
-.method public static varargs encrypt(Ljavax/crypto/SecretKey;[B[[B)[B
-    .locals 2
-
-    const/4 v0, 0x1
-
-    if-nez p1, :cond_0
-
-    const-string/jumbo p0, "add_encrypt, blob is null"
-
-    invoke-static {p0, v0}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
-
-    const/4 p0, 0x0
-
-    return-object p0
-
-    :cond_0
-    const-string v1, "AES/GCM/NoPadding"
-
-    invoke-static {v1}, Ljavax/crypto/Cipher;->getInstance(Ljava/lang/String;)Ljavax/crypto/Cipher;
-
-    move-result-object v1
-
-    invoke-virtual {v1, v0, p0}, Ljavax/crypto/Cipher;->init(ILjava/security/Key;)V
-
-    invoke-static {p2}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$Utils;->hasAAD([[B)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_1
-
-    const/4 p0, 0x0
-
-    aget-object p0, p2, p0
-
-    invoke-virtual {v1, p0}, Ljavax/crypto/Cipher;->updateAAD([B)V
-
-    :cond_1
-    invoke-virtual {v1, p1}, Ljavax/crypto/Cipher;->doFinal([B)[B
-
-    move-result-object p0
-
-    invoke-virtual {v1}, Ljavax/crypto/Cipher;->getIV()[B
-
-    move-result-object p1
-
-    array-length p2, p1
-
-    const/16 v0, 0xc
-
-    if-ne p2, v0, :cond_3
-
-    invoke-virtual {v1}, Ljavax/crypto/Cipher;->getParameters()Ljava/security/AlgorithmParameters;
-
-    move-result-object p2
-
-    const-class v0, Ljavax/crypto/spec/GCMParameterSpec;
-
-    invoke-virtual {p2, v0}, Ljava/security/AlgorithmParameters;->getParameterSpec(Ljava/lang/Class;)Ljava/security/spec/AlgorithmParameterSpec;
-
-    move-result-object p2
-
-    check-cast p2, Ljavax/crypto/spec/GCMParameterSpec;
-
-    invoke-virtual {p2}, Ljavax/crypto/spec/GCMParameterSpec;->getTLen()I
-
-    move-result v0
-
-    const/16 v1, 0x80
-
-    if-ne v0, v1, :cond_2
-
-    filled-new-array {p1, p0}, [[B
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/internal/util/ArrayUtils;->concat([[B)[B
-
-    move-result-object p0
-
-    return-object p0
-
-    :cond_2
-    new-instance p0, Ljava/lang/IllegalArgumentException;
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string v0, "Invalid tag length: "
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p2}, Ljavax/crypto/spec/GCMParameterSpec;->getTLen()I
-
-    move-result p2
-
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    :cond_3
-    new-instance p0, Ljava/lang/IllegalArgumentException;
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    const-string v0, "Invalid iv length: "
-
-    invoke-direct {p2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    array-length p1, p1
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-.end method
-
 .method public static encrypt([BLjavax/crypto/SecretKey;)[B
     .locals 3
 
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken.smali b/smali/com/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken.smali
deleted file mode 100644
index 381e1cb95..000000000
--- a/smali/com/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken.smali
+++ /dev/null
@@ -1,7 +0,0 @@
-.class public final Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# instance fields
-.field public secureMode:I
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordManager$PasswordData.smali b/smali/com/android/server/locksettings/SyntheticPasswordManager$PasswordData.smali
index 712f601b0..4c47ca9ae 100644
--- a/smali/com/android/server/locksettings/SyntheticPasswordManager$PasswordData.smali
+++ b/smali/com/android/server/locksettings/SyntheticPasswordManager$PasswordData.smali
@@ -23,7 +23,7 @@
 
 # direct methods
 .method public static fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
-    .locals 5
+    .locals 4
 
     new-instance v0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
 
@@ -107,49 +107,16 @@
 
     new-instance p0, Ljava/lang/StringBuilder;
 
-    const-string v2, "Inside fromBytes() - result.pinLength : "
-
-    invoke-direct {p0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget v2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->pinLength:I
-
-    invoke-virtual {p0, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    const-string v1, "Inside fromBytes() - result.pinLength : "
 
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-direct {p0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    move-result-object p0
+    iget v1, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->pinLength:I
 
     const-string/jumbo v2, "SyntheticPasswordManager.SDP"
 
-    invoke-static {v2, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v1}, Ljava/nio/ByteBuffer;->remaining()I
-
-    move-result p0
-
-    const/4 v4, 0x4
-
-    if-lt p0, v4, :cond_1
-
-    invoke-virtual {v1}, Ljava/nio/ByteBuffer;->getInt()I
-
-    move-result p0
-
-    iput p0, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string v1, "1. result.secureMode : "
-
-    invoke-direct {p0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget v1, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
-
     invoke-static {p0, v1, v2}, Lcom/android/server/accessibility/GestureWakeup$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
 
-    return-object v0
-
-    :cond_1
     iput v3, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
 
     new-instance p0, Ljava/lang/StringBuilder;
@@ -192,7 +159,7 @@
     :goto_0
     add-int/2addr v0, v1
 
-    add-int/lit8 v0, v0, 0x8
+    add-int/lit8 v0, v0, 0x4
 
     invoke-static {v0}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
 
@@ -254,11 +221,7 @@
     invoke-virtual {v0, v2}, Ljava/nio/ByteBuffer;->putInt(I)Ljava/nio/ByteBuffer;
 
     :goto_1
-    iget v1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->pinLength:I
-
-    invoke-virtual {v0, v1}, Ljava/nio/ByteBuffer;->putInt(I)Ljava/nio/ByteBuffer;
-
-    iget p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
+    iget p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->pinLength:I
 
     invoke-virtual {v0, p0}, Ljava/nio/ByteBuffer;->putInt(I)Ljava/nio/ByteBuffer;
 
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda0.smali b/smali/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda0.smali
deleted file mode 100644
index 9d8fa1cf8..000000000
--- a/smali/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda0.smali
+++ /dev/null
@@ -1,50 +0,0 @@
-.class public final synthetic Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda0;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Consumer;
-
-
-# instance fields
-.field public final synthetic f$0:I
-
-
-# direct methods
-.method public synthetic constructor <init>(I)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput p1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda0;->f$0:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 3
-
-    iget p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda0;->f$0:I
-
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->checkSystemPermission()V
-
-    invoke-virtual {p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->getLockSettings()Ljava/util/Optional;
-
-    move-result-object p1
-
-    new-instance v0, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3;
-
-    const-wide/16 v1, 0x2
-
-    invoke-direct {v0, p0, v1, v2}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$$ExternalSyntheticLambda3;-><init>(IJ)V
-
-    invoke-virtual {p1, v0}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    return-void
-.end method
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1.smali b/smali/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1.smali
deleted file mode 100644
index 5f3ee6522..000000000
--- a/smali/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1.smali
+++ /dev/null
@@ -1,116 +0,0 @@
-.class public final synthetic Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:I
-
-
-# direct methods
-.method public synthetic constructor <init>(II)V
-    .locals 0
-
-    iput p2, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1;->$r8$classId:I
-
-    iput p1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1;->f$0:I
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 1
-
-    iget v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1;->$r8$classId:I
-
-    iget p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1;->f$0:I
-
-    packed-switch v0, :pswitch_data_0
-
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    if-nez p0, :cond_0
-
-    iget-object p0, p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {p0}, Lcom/android/internal/widget/LockPatternUtils;->isSdpMdfppModeEnabledForSystem()Z
-
-    move-result p0
-
-    if-eqz p0, :cond_1
-
-    const/4 p0, 0x1
-
-    goto :goto_0
-
-    :cond_0
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    :cond_1
-    const/4 p0, 0x0
-
-    :goto_0
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_0
-    check-cast p1, Lcom/android/internal/widget/LockSettingsInternal;
-
-    invoke-virtual {p1, p0}, Lcom/android/internal/widget/LockSettingsInternal;->getSecureMode(I)I
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_1
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    if-nez p0, :cond_2
-
-    iget-object p0, p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
-
-    invoke-virtual {p0}, Lcom/android/internal/widget/LockPatternUtils;->isNeedToEnableSdpMdfppModeForSystem()Z
-
-    move-result p0
-
-    if-eqz p0, :cond_3
-
-    const/4 p0, 0x1
-
-    goto :goto_1
-
-    :cond_2
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    :cond_3
-    const/4 p0, 0x0
-
-    :goto_1
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_1
-        :pswitch_0
-    .end packed-switch
-.end method
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager.smali b/smali/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager.smali
index bee1ad001..9d69810cc 100644
--- a/smali/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager.smali
+++ b/smali/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager.smali
@@ -4,1762 +4,194 @@
 
 
 # instance fields
-.field public final spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-.field public final synthetic this$0:Lcom/android/server/locksettings/SyntheticPasswordManager;
+.field public spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
 
 # direct methods
-.method public static -$$Nest$misSdpMdfppMode(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;I)Z
-    .locals 0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->getSecureMode(I)I
-
-    move-result p0
-
-    if-lez p0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public static -$$Nest$mpostReadOrWriteState(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;Ljava/lang/String;[BI)V
-    .locals 4
+.method public static -$$Nest$mgetSecureMode(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;I)I
+    .locals 5
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    if-eqz p2, :cond_5
-
-    array-length v0, p2
+    const/4 v0, -0x1
 
-    const/4 v1, 0x4
-
-    if-ge v0, v1, :cond_0
+    :try_start_0
+    invoke-static {p1}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->getSecureMode(I)I
 
-    goto/16 :goto_2
+    move-result v1
+    :try_end_0
+    .catch Lcom/android/server/locksettings/SyntheticPasswordMdfpp$EmptySlotException; {:try_start_0 .. :try_end_0} :catch_0
 
-    :cond_0
-    const-string/jumbo v0, "pwd"
+    goto :goto_1
 
-    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    :catch_0
+    move-exception v1
 
-    move-result p1
+    iget-object v2, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    if-eqz p1, :cond_5
+    invoke-virtual {v2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
 
-    sget-object p1, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
+    move-result-object v2
 
-    invoke-static {v1}, Ljava/nio/ByteBuffer;->allocate(I)Ljava/nio/ByteBuffer;
+    if-eqz v2, :cond_0
 
-    move-result-object p1
+    goto :goto_0
 
-    sget-object v0, Lcom/android/server/knox/dar/sdp/security/BytesUtil;->DEFAULT_BYTE_ORDER:Ljava/nio/ByteOrder;
+    :cond_0
+    sget-boolean v2, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEBUG:Z
 
-    invoke-virtual {p1, v0}, Ljava/nio/ByteBuffer;->order(Ljava/nio/ByteOrder;)Ljava/nio/ByteBuffer;
+    if-eqz v2, :cond_1
 
-    const/4 v0, 0x0
+    invoke-virtual {v1}, Ljava/lang/SecurityException;->printStackTrace()V
 
-    invoke-virtual {p1, p2, v0, v1}, Ljava/nio/ByteBuffer;->put([BII)Ljava/nio/ByteBuffer;
+    goto :goto_0
 
-    invoke-virtual {p1}, Ljava/nio/ByteBuffer;->flip()Ljava/nio/Buffer;
+    :cond_1
+    const-string/jumbo v2, "SyntheticPasswordManager.SDP"
 
-    invoke-virtual {p1}, Ljava/nio/ByteBuffer;->getInt()I
+    invoke-virtual {v1}, Ljava/lang/SecurityException;->getMessage()Ljava/lang/String;
 
-    move-result p1
+    move-result-object v1
 
-    const/4 p2, 0x2
+    invoke-static {v2, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/4 v0, 0x3
+    :goto_0
+    move v1, v0
 
-    if-ne p1, p2, :cond_2
+    :goto_1
+    if-ne v1, v0, :cond_3
 
     iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
-
-    const-string/jumbo p2, "lockscreen.password_type"
-
-    const-wide/16 v2, 0x0
-
-    invoke-virtual {p0, p2, v2, v3, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->getLong(Ljava/lang/String;JI)J
+    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
 
-    move-result-wide v2
-
-    long-to-int p0, v2
-
-    invoke-static {p0}, Lcom/android/internal/widget/LockPatternUtils;->isQualityAlphabeticPassword(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    move p1, v1
-
-    goto :goto_0
-
-    :cond_1
-    invoke-static {p0}, Lcom/android/internal/widget/LockPatternUtils;->isQualityNumericPin(I)Z
-
-    move-result p0
+    move-result-object p0
 
     if-eqz p0, :cond_2
 
-    move p1, v0
+    goto :goto_2
 
     :cond_2
-    :goto_0
-    sget-object p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mSecureModeCache:Landroid/util/SparseArray;
-
-    if-eq p1, v1, :cond_4
-
-    if-eq p1, v0, :cond_4
-
-    const/4 p0, 0x1
-
-    if-eq p1, p0, :cond_4
-
-    const/4 p0, -0x1
-
-    if-ne p1, p0, :cond_3
+    new-instance p0, Ljava/lang/StringBuilder;
 
-    goto :goto_1
+    const-string/jumbo v0, "user"
 
-    :cond_3
-    sget-object p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mCredentialTypeCache:Landroid/util/SparseArray;
+    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    monitor-enter p0
+    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    :try_start_0
-    invoke-virtual {p0, p3}, Landroid/util/SparseArray;->delete(I)V
+    const-string v0, " - isSpecificProcessRequired : false, is Sdp user? false"
 
-    monitor-exit p0
+    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    return-void
+    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    :catchall_0
-    move-exception p1
+    move-result-object p0
 
-    monitor-exit p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    throw p1
+    :goto_2
+    const/4 v1, 0x0
 
-    :cond_4
-    :goto_1
-    sget-object p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mCredentialTypeCache:Landroid/util/SparseArray;
+    :cond_3
+    sget-object p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mSecureModeCache:Landroid/util/SparseArray;
 
     monitor-enter p0
 
     :try_start_1
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object p2
+    move-result-object v0
 
-    invoke-virtual {p0, p3, p2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
+    invoke-virtual {p0, p1, v0}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
 
     monitor-exit p0
     :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    const-string/jumbo p0, "SyntheticPasswordManager.SDP"
-
-    const-string p2, "Credential type for user "
-
-    const-string v0, " : "
-
-    invoke-static {p3, p1, p2, v0, p0}, Lcom/android/server/asks/ASKSManagerService$$ExternalSyntheticOutline0;->m(IILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    return-void
-
-    :catchall_1
-    move-exception p1
-
-    :try_start_2
-    monitor-exit p0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    throw p1
-
-    :cond_5
-    :goto_2
-    return-void
-.end method
-
-.method public static -$$Nest$munwrapSyntheticPasswordBlobSpecific(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;JB[BJILcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-    .locals 17
-
-    move-object/from16 v1, p0
-
-    move-object/from16 v5, p4
-
-    move/from16 v7, p7
-
-    move-object/from16 v10, p8
-
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    sget-object v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEFAULT_PASSWORD:[B
-
-    iget-object v12, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    const-string/jumbo v0, "spblob"
-
-    move-wide/from16 v8, p1
-
-    invoke-virtual {v12, v7, v0, v8, v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
-
-    move-result-object v0
-
-    const/4 v2, 0x0
-
-    if-nez v0, :cond_0
-
-    return-object v2
-
-    :cond_0
-    const/4 v3, 0x0
-
-    aget-byte v4, v0, v3
-
-    const/4 v6, 0x1
-
-    if-lt v4, v6, :cond_14
-
-    const/4 v11, 0x3
-
-    if-gt v4, v11, :cond_14
-
-    move v13, v3
-
-    aget-byte v3, v0, v6
-
-    move/from16 v14, p3
-
-    if-ne v3, v14, :cond_13
-
-    const/4 v14, 0x2
-
-    aget-byte v15, v0, v14
-
-    new-instance v13, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v11, "unwrapSPBlob with "
-
-    invoke-direct {v13, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v13, v15}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v11, " for user "
-
-    invoke-virtual {v13, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v13, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v11
-
-    const-string/jumbo v13, "SyntheticPasswordManager"
-
-    invoke-static {v13, v11}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    iget-object v11, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->this$0:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    if-ne v4, v6, :cond_1
-
-    invoke-virtual {v11}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v8, v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getProtectorKeyAlias(J)Ljava/lang/String;
-
-    move-result-object v11
-
-    array-length v15, v0
-
-    invoke-static {v0, v14, v15}, Ljava/util/Arrays;->copyOfRange([BII)[B
-
-    move-result-object v0
-
-    invoke-static {v11, v0, v5}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decryptBlobV1(Ljava/lang/String;[B[B)[B
-
-    move-result-object v0
-
-    :goto_0
-    move-object v14, v0
-
-    goto/16 :goto_3
-
-    :cond_1
-    const-string/jumbo v2, "Make sure of input parameter"
-
-    const/16 v6, 0x13
-
-    if-ne v4, v14, :cond_3
-
-    invoke-virtual {v11}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {v8, v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getProtectorKeyAlias(J)Ljava/lang/String;
-
-    move-result-object v11
-
-    array-length v14, v0
-
-    invoke-static {v0, v6, v14}, Ljava/util/Arrays;->copyOfRange([BII)[B
-
-    move-result-object v0
-
-    const/4 v6, 0x1
-
-    if-ne v15, v6, :cond_2
-
-    invoke-static {v11, v0, v5}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decryptBlobV1(Ljava/lang/String;[B[B)[B
-
-    move-result-object v0
-
-    goto :goto_0
-
-    :cond_2
-    new-instance v0, Ljava/lang/SecurityException;
-
-    invoke-direct {v0, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
-
-    throw v0
-
-    :cond_3
-    invoke-virtual {v11}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    invoke-static {v8, v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getProtectorKeyAlias(J)Ljava/lang/String;
+    sget-boolean p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEBUG:Z
 
-    move-result-object v11
+    if-eqz p0, :cond_4
 
-    array-length v14, v0
+    const-string/jumbo v0, "SyntheticPasswordManager.SDP"
 
-    invoke-static {v0, v6, v14}, Ljava/util/Arrays;->copyOfRange([BII)[B
+    const-string v2, "Cache - [ Secure Mode : %d, UserId : %d ]"
 
-    move-result-object v0
+    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    iget-object v6, v10, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->authenticationData:[B
+    move-result-object v3
 
-    if-nez v6, :cond_4
+    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    iget-object v6, v10, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->pivot:[B
+    move-result-object v4
 
-    iget v14, v10, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->secureMode:I
+    filled-new-array {v3, v4}, [Ljava/lang/Object;
 
-    const-string v8, "ForAuthenticationData"
+    move-result-object v3
 
-    invoke-static {v14, v8, v6}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->personalize(ILjava/lang/String;[B)[B
+    invoke-static {v2, v3}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    move-result-object v6
+    move-result-object v2
 
-    iput-object v6, v10, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->authenticationData:[B
+    invoke-static {v0, v2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     :cond_4
-    iget-object v6, v10, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->authenticationData:[B
-
-    filled-new-array {v6}, [[B
-
-    move-result-object v6
-
-    const/4 v8, 0x1
+    if-eqz p0, :cond_5
 
-    if-ne v15, v8, :cond_12
-
-    const-string v2, "Failed to decrypt blob"
-
-    const-string/jumbo v8, "SP key is missing: "
-
-    const-string/jumbo v9, "add_decryptBlob, SP key is missing: "
-
-    :try_start_0
-    invoke-static {}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->getKeyStore()Ljava/security/KeyStore;
+    const-string/jumbo p0, "SyntheticPasswordManager.SDP"
 
-    move-result-object v14
+    const-string v0, "Get - [ Secure Mode : %d, UserId : %d ]"
 
-    const/4 v15, 0x0
+    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    invoke-virtual {v14, v11, v15}, Ljava/security/KeyStore;->getKey(Ljava/lang/String;[C)Ljava/security/Key;
+    move-result-object v2
 
-    move-result-object v14
+    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    check-cast v14, Ljavax/crypto/SecretKey;
-    :try_end_0
-    .catch Ljavax/crypto/AEADBadTagException; {:try_start_0 .. :try_end_0} :catch_1
-    .catch Ljava/security/cert/CertificateException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljavax/crypto/BadPaddingException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljavax/crypto/IllegalBlockSizeException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/security/KeyStoreException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljavax/crypto/NoSuchPaddingException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/security/InvalidKeyException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/security/UnrecoverableKeyException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/security/InvalidAlgorithmParameterException; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz v14, :cond_5
-
-    sget-object v8, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->PROTECTOR_SECRET_PERSONALIZATION:[B
+    move-result-object v3
 
-    :try_start_1
-    invoke-static {v14, v0, v6}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decrypt(Ljavax/crypto/SecretKey;[B[[B)[B
+    filled-new-array {v2, v3}, [Ljava/lang/Object;
 
-    move-result-object v0
+    move-result-object v2
 
-    invoke-static {v5, v8, v0, v6}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decrypt([B[B[B[[B)[B
+    invoke-static {v0, v2}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
     move-result-object v0
 
-    goto :goto_0
-
-    :catch_0
-    move-exception v0
-
-    goto :goto_1
-
-    :catch_1
-    move-exception v0
-
-    goto :goto_2
+    invoke-static {p0, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     :cond_5
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v9, 0x1
-
-    invoke-static {v0, v9}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
-
-    new-instance v0, Ljava/lang/IllegalStateException;
-
-    new-instance v9, Ljava/lang/StringBuilder;
-
-    invoke-direct {v9, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v9, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v8
-
-    invoke-direct {v0, v8}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
-
-    throw v0
-    :try_end_1
-    .catch Ljavax/crypto/AEADBadTagException; {:try_start_1 .. :try_end_1} :catch_1
-    .catch Ljava/security/cert/CertificateException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljavax/crypto/BadPaddingException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljavax/crypto/IllegalBlockSizeException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljava/security/KeyStoreException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljavax/crypto/NoSuchPaddingException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljava/security/InvalidKeyException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljava/security/UnrecoverableKeyException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljava/security/InvalidAlgorithmParameterException; {:try_start_1 .. :try_end_1} :catch_0
-
-    :goto_1
-    const-string/jumbo v1, "SyntheticPasswordCrypto"
-
-    invoke-static {v1, v2, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v3, "add_decryptBlob, Failed to decrypt blob"
-
-    invoke-direct {v1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    const/4 v8, 0x1
-
-    invoke-static {v1, v8}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
-
-    new-instance v1, Ljava/lang/IllegalStateException;
-
-    invoke-direct {v1, v2, v0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    throw v1
-
-    :goto_2
-    const-string/jumbo v8, "SyntheticPasswordCrypto.SDP"
-
-    const-string v9, "Authentication failed before decrypt blob"
-
-    invoke-static {v8, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v0}, Ljavax/crypto/AEADBadTagException;->printStackTrace()V
-
-    invoke-static {v6}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$Utils;->hasAAD([[B)Z
-
-    move-result v6
-
-    if-eqz v6, :cond_11
-
-    const-string/jumbo v0, "add_decryptBlob, decryptBlob is return null"
+    const-string/jumbo p0, "SyntheticPasswordManager.SDP"
 
-    const/4 v8, 0x1
+    const-string/jumbo v0, "Secure mode for user %d = %d"
 
-    invoke-static {v0, v8}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
+    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    const/4 v0, 0x0
+    move-result-object p1
 
-    goto/16 :goto_0
+    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    :goto_3
-    if-nez v14, :cond_6
+    move-result-object v2
 
-    const-string v0, "Fail to decrypt SP for user "
+    filled-new-array {p1, v2}, [Ljava/lang/Object;
 
-    invoke-static {v7, v0, v13}, Lcom/android/server/NandswapManager$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    move-result-object p1
 
-    :goto_4
-    const/4 v2, 0x0
+    invoke-static {v0, p1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    goto/16 :goto_b
+    move-result-object p1
 
-    :cond_6
-    iget v0, v10, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->secureMode:I
+    invoke-static {p0, p1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    if-nez v0, :cond_8
+    return v1
 
-    const/4 v2, 0x2
+    :catchall_0
+    move-exception p1
 
-    if-eq v4, v2, :cond_7
+    :try_start_2
+    monitor-exit p0
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    const/4 v2, 0x3
-
-    if-ne v4, v2, :cond_8
-
-    :cond_7
-    const/16 v16, 0x1
-
-    goto :goto_5
-
-    :cond_8
-    const/16 v16, 0x0
-
-    :goto_5
-    if-eqz v16, :cond_9
-
-    const/4 v4, 0x2
-
-    :cond_9
-    invoke-virtual {v1, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSdpMdfppModeForSystem(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_a
-
-    const-string/jumbo v2, "unwrapSyntheticPasswordBlobSpecific: SdpMdfppMode enabled for System when Sp has no secure mode."
-
-    const/4 v15, 0x0
-
-    invoke-static {v15, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    new-instance v2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    invoke-direct {v2, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;-><init>(B)V
-
-    :goto_6
-    const/4 v8, 0x1
-
-    goto :goto_7
-
-    :cond_a
-    const/4 v15, 0x0
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v6, "unwrapSyntheticPasswordBlobSpecific: secureMode : "
-
-    invoke-direct {v2, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v15, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    new-instance v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
-
-    invoke-direct {v2}, Ljava/lang/Object;-><init>()V
-
-    iput v0, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;->secureMode:I
-
-    new-instance v6, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    invoke-direct {v6, v4, v2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;-><init>(BLcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;)V
-
-    move-object v2, v6
-
-    goto :goto_6
-
-    :goto_7
-    if-eq v3, v8, :cond_c
-
-    const/4 v6, 0x2
-
-    if-ne v3, v6, :cond_b
-
-    goto :goto_8
-
-    :cond_b
-    array-length v6, v14
-
-    invoke-static {v14, v6}, Ljava/util/Arrays;->copyOf([BI)[B
-
-    move-result-object v6
-
-    iput-object v6, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    goto :goto_9
-
-    :cond_c
-    :goto_8
-    invoke-virtual {v2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->isSdpMdfppMode()Z
-
-    move-result v6
-
-    if-nez v6, :cond_d
-
-    invoke-virtual {v12, v7, v2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadEscrowData(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
-
-    move-result v6
-
-    if-nez v6, :cond_d
-
-    const-string/jumbo v0, "User is not escrowable: "
-
-    invoke-static {v7, v0, v13}, Lcom/android/server/NandswapManager$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_4
-
-    :cond_d
-    invoke-virtual {v2, v14}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->recreateFromEscrow([B)V
-
-    :goto_9
-    if-nez v0, :cond_f
-
-    if-eqz v16, :cond_e
-
-    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;
-
-    const-string/jumbo v0, "Revert to v2 SP original blob for user "
-
-    const-string v6, " [ protectorType : "
-
-    const-string v8, ", prev : "
-
-    invoke-static {v7, v3, v0, v6, v8}, Lcom/android/internal/util/jobs/ArrayUtils$$ExternalSyntheticOutline0;->m(IILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    move-result-object v0
-
-    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v4, " ]"
-
-    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v15, 0x0
-
-    invoke-static {v15, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    const/4 v11, 0x0
-
-    iget-object v6, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    const-string/jumbo v10, "spblob"
-
-    move-wide/from16 v8, p1
-
-    invoke-virtual/range {v6 .. v11}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
-
-    iget-object v0, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-wide/from16 v6, p5
-
-    move/from16 v8, p7
-
-    move-object v4, v2
-
-    move-wide/from16 v1, p1
-
-    invoke-virtual/range {v0 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createSyntheticPasswordBlob(JBLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;[BJI)V
-
-    move-object v5, v4
-
-    move v7, v8
-
-    invoke-virtual {v12, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
-
-    goto :goto_a
-
-    :cond_e
-    move-object v5, v2
-
-    goto :goto_a
-
-    :cond_f
-    move-object v5, v2
-
-    const/4 v2, 0x2
-
-    if-ne v4, v2, :cond_10
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "Upgrade v2 SP blob for user "
-
-    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v2, ", protectorType = "
-
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v13, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    move-object/from16 v6, p4
-
-    move v4, v3
-
-    move v9, v7
-
-    move-wide/from16 v2, p1
-
-    move-wide/from16 v7, p5
-
-    invoke-virtual/range {v1 .. v10}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->createSyntheticPasswordBlobSpecific(JBLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;[BJILcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;)V
-
-    move v7, v9
-
-    invoke-virtual {v12, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
-
-    :cond_10
-    :goto_a
-    invoke-static {v14}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    move-object v2, v5
-
-    :goto_b
-    return-object v2
-
-    :cond_11
-    new-instance v1, Ljava/lang/IllegalStateException;
-
-    invoke-direct {v1, v2, v0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    throw v1
-
-    :cond_12
-    new-instance v0, Ljava/lang/SecurityException;
-
-    invoke-direct {v0, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
-
-    throw v0
-
-    :cond_13
-    new-instance v0, Ljava/lang/RuntimeException;
-
-    const-string v1, "Invalid blob protectorType"
-
-    invoke-direct {v0, v1}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V
-
-    throw v0
-
-    :cond_14
-    new-instance v0, Ljava/lang/RuntimeException;
-
-    const-string/jumbo v1, "Unknown blob version"
-
-    invoke-direct {v0, v1}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V
-
-    throw v0
-.end method
-
-.method public constructor <init>(Lcom/android/server/locksettings/SyntheticPasswordManager;Lcom/android/server/locksettings/SyntheticPasswordManager;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->this$0:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    iput-object p2, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    return-void
-.end method
-
-.method public static cacheSecureMode(II)V
-    .locals 2
-
-    sget-object v0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mSecureModeCache:Landroid/util/SparseArray;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    invoke-virtual {v0, p0, v1}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    sget-boolean v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEBUG:Z
-
-    if-eqz v0, :cond_0
-
-    const-string/jumbo v0, "SyntheticPasswordManager.SDP"
-
-    const-string v1, "Cache - [ Secure Mode : %d, UserId : %d ]"
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    filled-new-array {p1, p0}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v0, p0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_0
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-
-# virtual methods
-.method public final createSyntheticPasswordBlobSpecific(JBLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;[BJILcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;)V
-    .locals 18
-
-    move-object/from16 v0, p0
-
-    move/from16 v1, p3
-
-    move-object/from16 v2, p4
-
-    move-object/from16 v3, p5
-
-    move-wide/from16 v4, p6
-
-    move-object/from16 v6, p9
-
-    const/4 v7, 0x2
-
-    const/4 v8, 0x1
-
-    if-eq v1, v8, :cond_1
-
-    if-ne v1, v7, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    iget-object v2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    goto :goto_1
-
-    :cond_1
-    :goto_0
-    invoke-virtual {v2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->isSdpMdfppMode()Z
-
-    move-result v9
-
-    if-eqz v9, :cond_2
-
-    iget-object v2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    goto :goto_1
-
-    :cond_2
-    iget-object v9, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEncryptedEscrowSplit0:[B
-
-    if-nez v9, :cond_3
-
-    const/4 v2, 0x0
-
-    goto :goto_1
-
-    :cond_3
-    iget-object v2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    sget-object v10, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_E0:[B
-
-    invoke-static {v2, v10, v9}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decrypt([B[B[B)[B
-
-    move-result-object v2
-
-    :goto_1
-    const-string/jumbo v9, "createSPBlob with TARGET_ANDROID_KEYSTORE for user "
-
-    const-string/jumbo v10, "SyntheticPasswordManager"
-
-    move/from16 v12, p8
-
-    invoke-static {v12, v9, v10}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    sget-object v9, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEFAULT_PASSWORD:[B
-
-    iget-object v9, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->this$0:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v9}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static/range {p1 .. p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getProtectorKeyAlias(J)Ljava/lang/String;
-
-    move-result-object v9
-
-    iget-object v10, v6, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->authenticationData:[B
-
-    if-nez v10, :cond_4
-
-    iget-object v10, v6, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->pivot:[B
-
-    iget v11, v6, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->secureMode:I
-
-    const-string v13, "ForAuthenticationData"
-
-    invoke-static {v11, v13, v10}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->personalize(ILjava/lang/String;[B)[B
-
-    move-result-object v10
-
-    iput-object v10, v6, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->authenticationData:[B
-
-    :cond_4
-    iget-object v6, v6, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->authenticationData:[B
-
-    filled-new-array {v6}, [[B
-
-    move-result-object v6
-
-    sget-object v10, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->PROTECTOR_SECRET_PERSONALIZATION:[B
-
-    const-string v10, "AES"
-
-    const-string/jumbo v11, "SyntheticPasswordCrypto"
-
-    :try_start_0
-    invoke-static {v10}, Ljavax/crypto/KeyGenerator;->getInstance(Ljava/lang/String;)Ljavax/crypto/KeyGenerator;
-
-    move-result-object v13
-
-    new-instance v14, Ljava/security/SecureRandom;
-
-    invoke-direct {v14}, Ljava/security/SecureRandom;-><init>()V
-
-    const/16 v15, 0x100
-
-    invoke-virtual {v13, v15, v14}, Ljavax/crypto/KeyGenerator;->init(ILjava/security/SecureRandom;)V
-
-    invoke-virtual {v13}, Ljavax/crypto/KeyGenerator;->generateKey()Ljavax/crypto/SecretKey;
-
-    move-result-object v13
-
-    invoke-static {}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->getKeyStore()Ljava/security/KeyStore;
-
-    move-result-object v14
-
-    new-instance v15, Landroid/security/keystore/KeyProtection$Builder;
-
-    invoke-direct {v15, v7}, Landroid/security/keystore/KeyProtection$Builder;-><init>(I)V
-
-    const-string v16, "GCM"
-
-    move/from16 v17, v7
-
-    filled-new-array/range {v16 .. v16}, [Ljava/lang/String;
-
-    move-result-object v7
-
-    invoke-virtual {v15, v7}, Landroid/security/keystore/KeyProtection$Builder;->setBlockModes([Ljava/lang/String;)Landroid/security/keystore/KeyProtection$Builder;
-
-    move-result-object v7
-
-    const-string/jumbo v15, "NoPadding"
-
-    filled-new-array {v15}, [Ljava/lang/String;
-
-    move-result-object v15
-
-    invoke-virtual {v7, v15}, Landroid/security/keystore/KeyProtection$Builder;->setEncryptionPaddings([Ljava/lang/String;)Landroid/security/keystore/KeyProtection$Builder;
-
-    move-result-object v7
-
-    invoke-virtual {v7, v8}, Landroid/security/keystore/KeyProtection$Builder;->setCriticalToDeviceEncryption(Z)Landroid/security/keystore/KeyProtection$Builder;
-
-    move-result-object v7
-
-    const-wide/16 v15, 0x0
-
-    cmp-long v15, v4, v15
-
-    if-eqz v15, :cond_5
-
-    invoke-virtual {v7, v8}, Landroid/security/keystore/KeyProtection$Builder;->setUserAuthenticationRequired(Z)Landroid/security/keystore/KeyProtection$Builder;
-
-    move-result-object v15
-
-    invoke-virtual {v15, v4, v5}, Landroid/security/keystore/KeyProtection$Builder;->setBoundToSpecificSecureUserId(J)Landroid/security/keystore/KeyProtection$Builder;
-
-    move-result-object v4
-
-    const/16 v5, 0xf
-
-    invoke-virtual {v4, v5}, Landroid/security/keystore/KeyProtection$Builder;->setUserAuthenticationValidityDurationSeconds(I)Landroid/security/keystore/KeyProtection$Builder;
-
-    goto :goto_2
-
-    :catch_0
-    move-exception v0
-
-    goto/16 :goto_5
-
-    :cond_5
-    :goto_2
-    invoke-virtual {v7}, Landroid/security/keystore/KeyProtection$Builder;->build()Landroid/security/keystore/KeyProtection;
-
-    move-result-object v4
-
-    invoke-virtual {v7, v8}, Landroid/security/keystore/KeyProtection$Builder;->setRollbackResistant(Z)Landroid/security/keystore/KeyProtection$Builder;
-
-    invoke-virtual {v7}, Landroid/security/keystore/KeyProtection$Builder;->build()Landroid/security/keystore/KeyProtection;
-
-    move-result-object v5
-
-    new-instance v7, Ljava/security/KeyStore$SecretKeyEntry;
-
-    invoke-direct {v7, v13}, Ljava/security/KeyStore$SecretKeyEntry;-><init>(Ljavax/crypto/SecretKey;)V
-    :try_end_0
-    .catch Ljava/security/cert/CertificateException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljavax/crypto/BadPaddingException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljavax/crypto/IllegalBlockSizeException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/security/KeyStoreException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljavax/crypto/NoSuchPaddingException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/security/InvalidKeyException; {:try_start_0 .. :try_end_0} :catch_0
-    .catch Ljava/security/spec/InvalidParameterSpecException; {:try_start_0 .. :try_end_0} :catch_0
-
-    :try_start_1
-    invoke-virtual {v14, v9, v7, v5}, Ljava/security/KeyStore;->setEntry(Ljava/lang/String;Ljava/security/KeyStore$Entry;Ljava/security/KeyStore$ProtectionParameter;)V
-
-    const-string/jumbo v5, "Using rollback-resistant key"
-
-    invoke-static {v11, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_1
-    .catch Ljava/security/KeyStoreException; {:try_start_1 .. :try_end_1} :catch_1
-    .catch Ljava/security/cert/CertificateException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljavax/crypto/BadPaddingException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljavax/crypto/IllegalBlockSizeException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljavax/crypto/NoSuchPaddingException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljava/security/InvalidKeyException; {:try_start_1 .. :try_end_1} :catch_0
-    .catch Ljava/security/spec/InvalidParameterSpecException; {:try_start_1 .. :try_end_1} :catch_0
-
-    goto :goto_3
-
-    :catch_1
-    :try_start_2
-    const-string/jumbo v5, "Rollback-resistant keys unavailable.  Falling back to non-rollback-resistant key"
-
-    invoke-static {v11, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v14, v9, v7, v4}, Ljava/security/KeyStore;->setEntry(Ljava/lang/String;Ljava/security/KeyStore$Entry;Ljava/security/KeyStore$ProtectionParameter;)V
-
-    :goto_3
-    invoke-static {v6}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$Utils;->hasAAD([[B)Z
-
-    move-result v4
-
-    const/4 v5, 0x0
-
-    if-eqz v4, :cond_6
-
-    new-instance v4, Ljavax/crypto/spec/SecretKeySpec;
-
-    const/16 v7, 0x20
-
-    invoke-static {v3, v7}, Ljava/util/Arrays;->copyOf([BI)[B
-
-    move-result-object v3
-
-    invoke-direct {v4, v3, v10}, Ljavax/crypto/spec/SecretKeySpec;-><init>([BLjava/lang/String;)V
-
-    aget-object v3, v6, v5
-
-    filled-new-array {v3}, [[B
-
-    move-result-object v3
-
-    invoke-static {v4, v2, v3}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->encrypt(Ljavax/crypto/SecretKey;[B[[B)[B
-
-    move-result-object v2
-
-    invoke-static {v13, v2, v6}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->encrypt(Ljavax/crypto/SecretKey;[B[[B)[B
-
-    move-result-object v2
-
-    goto :goto_4
-
-    :cond_6
-    sget-object v4, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->PROTECTOR_SECRET_PERSONALIZATION:[B
-
-    invoke-static {v3, v4, v2}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->encrypt([B[B[B)[B
-
-    move-result-object v2
-
-    invoke-static {v2, v13}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->encrypt([BLjavax/crypto/SecretKey;)[B
-
-    move-result-object v2
-    :try_end_2
-    .catch Ljava/security/cert/CertificateException; {:try_start_2 .. :try_end_2} :catch_0
-    .catch Ljava/io/IOException; {:try_start_2 .. :try_end_2} :catch_0
-    .catch Ljavax/crypto/BadPaddingException; {:try_start_2 .. :try_end_2} :catch_0
-    .catch Ljavax/crypto/IllegalBlockSizeException; {:try_start_2 .. :try_end_2} :catch_0
-    .catch Ljava/security/KeyStoreException; {:try_start_2 .. :try_end_2} :catch_0
-    .catch Ljavax/crypto/NoSuchPaddingException; {:try_start_2 .. :try_end_2} :catch_0
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_2 .. :try_end_2} :catch_0
-    .catch Ljava/security/InvalidKeyException; {:try_start_2 .. :try_end_2} :catch_0
-    .catch Ljava/security/spec/InvalidParameterSpecException; {:try_start_2 .. :try_end_2} :catch_0
-
-    :goto_4
-    if-eqz v2, :cond_7
-
-    array-length v3, v2
-
-    const/16 v4, 0x13
-
-    add-int/2addr v3, v4
-
-    new-array v3, v3, [B
-
-    const/4 v6, 0x3
-
-    aput-byte v6, v3, v5
-
-    aput-byte v1, v3, v8
-
-    aput-byte v8, v3, v17
-
-    invoke-static {v3, v6, v4, v5}, Ljava/util/Arrays;->fill([BIIB)V
-
-    array-length v1, v2
-
-    invoke-static {v2, v5, v3, v4, v1}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
-
-    aget-byte v1, v3, v5
-
-    aget-byte v1, v3, v8
-
-    iget-object v11, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    const-string/jumbo v15, "spblob"
-
-    move-wide/from16 v13, p1
-
-    move-object/from16 v16, v3
-
-    invoke-virtual/range {v11 .. v16}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
-
-    return-void
-
-    :cond_7
-    new-instance v0, Ljava/lang/SecurityException;
-
-    const-string/jumbo v1, "content is null"
-
-    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
-
-    throw v0
-
-    :goto_5
-    const-string v1, "Failed to create blob"
-
-    invoke-static {v11, v1, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "add_createBlob, Failed to create blob"
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v1, v8}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
-
-    new-instance v1, Ljava/lang/IllegalStateException;
-
-    const-string v2, "Failed to encrypt blob"
-
-    invoke-direct {v1, v2, v0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    throw v1
-.end method
-
-.method public final getSecureMode(I)I
-    .locals 7
-
-    const-string/jumbo v0, "SyntheticPasswordManager.SDP"
-
-    iget-object v1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    const/4 v2, -0x1
-
-    :try_start_0
-    invoke-static {p1}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->getSecureMode(I)I
-
-    move-result v3
-    :try_end_0
-    .catch Lcom/android/server/locksettings/SyntheticPasswordMdfpp$EmptySlotException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_1
-
-    :catch_0
-    move-exception v3
-
-    invoke-virtual {v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->isWeaverSupported()Z
-
-    move-result v4
-
-    if-nez v4, :cond_1
-
-    sget-boolean v4, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEBUG:Z
-
-    if-eqz v4, :cond_0
-
-    invoke-virtual {v3}, Ljava/lang/SecurityException;->printStackTrace()V
-
-    goto :goto_0
-
-    :cond_0
-    invoke-virtual {v3}, Ljava/lang/SecurityException;->getMessage()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-static {v0, v3}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_1
-    :goto_0
-    move v3, v2
-
-    :goto_1
-    if-ne v3, v2, :cond_8
-
-    invoke-virtual {v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->isWeaverSupported()Z
-
-    move-result v3
-
-    if-nez v3, :cond_7
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSpecificProcessRequired(I)Z
-
-    move-result v3
-
-    if-nez v3, :cond_2
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSdpMdfppModeEnabledForSystem(I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_7
-
-    :cond_2
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isNeedToEnableSdpMdfppModeForSystem(I)Z
-
-    move-result v3
-
-    const-string v4, " using AOSP SP"
-
-    const/4 v5, 0x0
-
-    if-eqz v3, :cond_3
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "Secure mode not set yet for System (Device owner) "
-
-    invoke-direct {p0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v5, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_2
-
-    :cond_3
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSdpMdfppModeEnabledForSystem(I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_4
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v6, "Secure mode was set for System (Device owner) "
-
-    invoke-direct {v3, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-static {v5, v3}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    :cond_4
-    iget-object v3, v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-    if-nez v3, :cond_5
-
-    const-class v3, Lcom/android/internal/widget/LockSettingsInternal;
-
-    invoke-static {v3}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/android/internal/widget/LockSettingsInternal;
-
-    iput-object v3, v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-    :cond_5
-    iget-object v1, v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
-    invoke-static {v1}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object v1
-
-    new-instance v3, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1;
-
-    const/4 v4, 0x1
-
-    invoke-direct {v3, p1, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1;-><init>(II)V
-
-    invoke-virtual {v1, v3}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object v1
-
-    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v3
-
-    invoke-virtual {v1, v3}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Ljava/lang/Integer;
-
-    invoke-virtual {v1}, Ljava/lang/Integer;->intValue()I
-
-    move-result v3
-
-    if-ne v3, v2, :cond_8
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isDualDarUser(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_6
-
-    const-string/jumbo p0, "Secure Mode doesn\'t support for initial DualDAR user anymore"
-
-    invoke-static {v5, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_3
-
-    :cond_6
-    const-string/jumbo p0, "No secure mode for user "
-
-    invoke-static {p1, p0, v5}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    const/4 v3, 0x2
-
-    goto :goto_3
-
-    :cond_7
-    :goto_2
-    const/4 v3, 0x0
-
-    :cond_8
-    :goto_3
-    invoke-static {p1, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->cacheSecureMode(II)V
-
-    sget-boolean p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEBUG:Z
-
-    if-eqz p0, :cond_9
-
-    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    filled-new-array {p0, v1}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string v1, "Get - [ Secure Mode : %d, UserId : %d ]"
-
-    invoke-static {v1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v0, p0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_9
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    filled-new-array {p0, p1}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string/jumbo p1, "Secure mode for user %d = %d"
-
-    invoke-static {p1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v0, p0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v3
-.end method
-
-.method public final isDualDarUser(I)Z
-    .locals 3
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->this$0:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    sget-object v2, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEFAULT_PASSWORD:[B
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-class p0, Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerInternal;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    iget p0, p0, Landroid/content/pm/UserInfo;->flags:I
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    const/high16 p1, 0x6000000
-
-    and-int/2addr p0, p1
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    const/4 p0, 0x0
-
-    :goto_0
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return p0
-
-    :goto_1
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
-.method public final isNeedToEnableSdpMdfppModeForSystem(I)Z
-    .locals 2
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->-$$Nest$mgetSdpManager(Lcom/android/server/locksettings/SyntheticPasswordManager;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1;
-
-    const/4 v1, 0x0
-
-    invoke-direct {v0, p1, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1;-><init>(II)V
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    sget-object p1, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {p0, p1}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Ljava/lang/Boolean;
-
-    invoke-virtual {p0}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result p0
-
-    return p0
-.end method
-
-.method public final isSdpMdfppModeEnabledForSystem(I)Z
-    .locals 2
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->-$$Nest$mgetSdpManager(Lcom/android/server/locksettings/SyntheticPasswordManager;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1;
-
-    const/4 v1, 0x2
-
-    invoke-direct {v0, p1, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda1;-><init>(II)V
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    sget-object p1, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    invoke-virtual {p0, p1}, Ljava/util/Optional;->orElse(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Ljava/lang/Boolean;
-
-    invoke-virtual {p0}, Ljava/lang/Boolean;->booleanValue()Z
-
-    move-result p0
-
-    return p0
-.end method
-
-.method public final isSdpMdfppModeForSystem(I)Z
-    .locals 1
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isNeedToEnableSdpMdfppModeForSystem(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSdpMdfppModeEnabledForSystem(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-
-    :cond_1
-    :goto_0
-    const/4 p0, 0x1
-
-    return p0
-.end method
-
-.method public final isSdpUser(I)Z
-    .locals 3
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->this$0:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    sget-object v2, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEFAULT_PASSWORD:[B
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-class p0, Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerInternal;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :cond_0
-    const/4 p0, 0x0
-
-    :goto_0
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return p0
-
-    :goto_1
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-.end method
-
-.method public final isSpecificProcessRequired(I)Z
-    .locals 4
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSdpUser(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 v0, 0x0
-
-    goto :goto_1
-
-    :cond_1
-    :goto_0
-    const/4 v0, 0x1
-
-    :goto_1
-    const-string/jumbo v1, "user"
-
-    const-string v2, " - isSpecificProcessRequired : "
-
-    const-string v3, ", is Sdp user? "
-
-    invoke-static {p1, v1, v2, v3, v0}, Lcom/android/server/audio/AudioService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)Ljava/lang/StringBuilder;
-
-    move-result-object v1
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSdpUser(I)Z
-
-    move-result p0
-
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    return v0
+    throw p1
 .end method
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword.smali b/smali/com/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword.smali
index 435e27e2d..97146b2e7 100644
--- a/smali/com/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword.smali
+++ b/smali/com/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword.smali
@@ -8,8 +8,6 @@
 
 .field public mEscrowSplit1:[B
 
-.field public final mSdpToken:Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
-
 .field public mSecureFolderAuthToken:Z
 
 .field public mSyntheticPassword:[B
@@ -19,36 +17,12 @@
 
 # direct methods
 .method public constructor <init>(B)V
-    .locals 1
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-byte p1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mVersion:B
-
-    new-instance p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
-
-    invoke-direct {p1}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSdpToken:Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
-
-    const/4 v0, 0x0
-
-    iput v0, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;->secureMode:I
-
-    iput-boolean v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSecureFolderAuthToken:Z
-
-    return-void
-.end method
-
-.method public constructor <init>(BLcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
     iput-byte p1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mVersion:B
 
-    iput-object p2, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSdpToken:Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
-
     const/4 p1, 0x0
 
     iput-boolean p1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSecureFolderAuthToken:Z
@@ -58,115 +32,6 @@
 
 
 # virtual methods
-.method public final deriveGkPassword()[B
-    .locals 2
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->isSdpMdfppMode()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSdpToken:Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
-
-    iget p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;->secureMode:I
-
-    const-string v1, "ForGateKeeper"
-
-    invoke-static {p0, v1, v0}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->personalize(ILjava/lang/String;[B)[B
-
-    move-result-object p0
-
-    return-object p0
-
-    :cond_0
-    sget-object v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_GK_AUTH:[B
-
-    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
-.method public final deriveKeyStorePassword()[B
-    .locals 2
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->isSdpMdfppMode()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSdpToken:Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
-
-    iget p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;->secureMode:I
-
-    const-string v1, "ForKeyStore"
-
-    invoke-static {p0, v1, v0}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->personalize(ILjava/lang/String;[B)[B
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->bytesToHex([B)[B
-
-    move-result-object v0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    return-object v0
-
-    :cond_0
-    sget-object v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_KEY_STORE_PASSWORD:[B
-
-    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->bytesToHex([B)[B
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
-.method public final deriveSdpMasterKey()[B
-    .locals 2
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->isSdpMdfppMode()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSdpToken:Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
-
-    iget p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;->secureMode:I
-
-    const-string v1, "ForSdpMasterKey"
-
-    invoke-static {p0, v1, v0}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->personalize(ILjava/lang/String;[B)[B
-
-    move-result-object p0
-
-    return-object p0
-
-    :cond_0
-    sget-object v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SDP_MASTER_KEY:[B
-
-    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public final deriveSubkey([B)[B
     .locals 2
 
@@ -203,93 +68,3 @@
 
     return-object p0
 .end method
-
-.method public final isSdpMdfppMode()Z
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSdpToken:Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
-
-    iget p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;->secureMode:I
-
-    if-lez p0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public final recreateFromEscrow([B)V
-    .locals 2
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->isSdpMdfppMode()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    new-instance v0, Ljava/lang/String;
-
-    sget-object v1, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;
-
-    invoke-direct {v0, p1, v1}, Ljava/lang/String;-><init>([BLjava/nio/charset/Charset;)V
-
-    invoke-virtual {v0}, Ljava/lang/String;->toCharArray()[C
-
-    move-result-object p1
-
-    const/4 v0, 0x1
-
-    invoke-static {p1, v0}, Llibcore/util/HexEncoding;->decode([CZ)[B
-
-    move-result-object p1
-
-    invoke-static {p1}, Llibcore/util/HexEncoding;->encode([B)[C
-
-    move-result-object p1
-
-    invoke-static {p1}, Ljava/lang/String;->valueOf([C)Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-virtual {p1, v1}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    return-void
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEscrowSplit1:[B
-
-    invoke-static {v0}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEncryptedEscrowSplit0:[B
-
-    invoke-static {v0}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEscrowSplit1:[B
-
-    sget-object v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_SPLIT:[B
-
-    filled-new-array {p1, v0}, [[B
-
-    move-result-object p1
-
-    invoke-static {v1, p1}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->personalizedHash([B[[B)[B
-
-    move-result-object p1
-
-    invoke-static {p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->bytesToHex([B)[B
-
-    move-result-object p1
-
-    iput-object p1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    return-void
-.end method
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordManager$TokenData.smali b/smali/com/android/server/locksettings/SyntheticPasswordManager$TokenData.smali
index c2859b29a..7d3a14281 100644
--- a/smali/com/android/server/locksettings/SyntheticPasswordManager$TokenData.smali
+++ b/smali/com/android/server/locksettings/SyntheticPasswordManager$TokenData.smali
@@ -6,8 +6,6 @@
 # instance fields
 .field public aggregatedSecret:[B
 
-.field public km:Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
-
 .field public mCallback:Lcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;
 
 .field public mType:I
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordManager.smali b/smali/com/android/server/locksettings/SyntheticPasswordManager.smali
index f4c9d31c9..bac355cf9 100644
--- a/smali/com/android/server/locksettings/SyntheticPasswordManager.smali
+++ b/smali/com/android/server/locksettings/SyntheticPasswordManager.smali
@@ -48,16 +48,10 @@
 # instance fields
 .field public final mContext:Landroid/content/Context;
 
-.field public mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
-
 .field public final mListeners:Landroid/os/RemoteCallbackList;
 
-.field public mLockSettingsInternal:Lcom/android/internal/widget/LockSettingsInternal;
-
 .field public final mPasswordSlotManager:Lcom/android/server/locksettings/PasswordSlotManager;
 
-.field public mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
 .field public final mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
 
 .field public final mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
@@ -76,46 +70,6 @@
 
 
 # direct methods
-.method public static -$$Nest$mgetSdpManager(Lcom/android/server/locksettings/SyntheticPasswordManager;)Ljava/util/Optional;
-    .locals 1
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    if-nez v0, :cond_1
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
-
-    if-nez v0, :cond_0
-
-    const-string/jumbo v0, "dar"
-
-    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/knox/dar/DarManagerService;
-
-    iput-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v0, :cond_1
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iput-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    :cond_1
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method static constructor <clinit>()V
     .locals 3
 
@@ -351,7 +305,9 @@
 
     new-instance p1, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
 
-    invoke-direct {p1, p0, p0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;-><init>(Lcom/android/server/locksettings/SyntheticPasswordManager;Lcom/android/server/locksettings/SyntheticPasswordManager;)V
+    invoke-direct {p1}, Ljava/lang/Object;-><init>()V
+
+    iput-object p0, p1, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     iput-object p1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
 
@@ -450,61 +406,57 @@
 
 # virtual methods
 .method public final addPendingToken([BIILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
-    .locals 8
-
-    const/4 v0, 0x0
-
-    const/4 v1, 0x1
+    .locals 5
 
-    sget-boolean v2, Lcom/android/server/locksettings/SyntheticPasswordManager;->SECURITY_UNPACK:Z
+    sget-boolean v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->SECURITY_UNPACK:Z
 
-    if-eqz v2, :cond_0
+    if-eqz v0, :cond_0
 
     sget-object p1, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEFAULT_TOKEN:[B
 
     :cond_0
-    sget-object v2, Lcom/android/server/locksettings/SecureRandomUtils;->RNG:Ljava/security/SecureRandom;
+    sget-object v0, Lcom/android/server/locksettings/SecureRandomUtils;->RNG:Ljava/security/SecureRandom;
 
-    invoke-virtual {v2}, Ljava/security/SecureRandom;->nextLong()J
+    invoke-virtual {v0}, Ljava/security/SecureRandom;->nextLong()J
 
-    move-result-wide v2
+    move-result-wide v0
 
-    const-wide/16 v4, 0x0
+    const-wide/16 v2, 0x0
 
-    cmp-long v4, v2, v4
+    cmp-long v2, v0, v2
 
-    if-eqz v4, :cond_0
+    if-eqz v2, :cond_0
 
-    iget-object v4, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
+    iget-object v2, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
 
     invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v5
+    move-result-object v3
 
-    invoke-virtual {v4, v5}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z
+    invoke-virtual {v2, v3}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z
 
-    move-result v4
+    move-result v2
 
-    if-nez v4, :cond_1
+    if-nez v2, :cond_1
 
-    iget-object v4, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
+    iget-object v2, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
 
     invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v5
+    move-result-object v3
 
-    new-instance v6, Landroid/util/ArrayMap;
+    new-instance v4, Landroid/util/ArrayMap;
 
-    invoke-direct {v6}, Landroid/util/ArrayMap;-><init>()V
+    invoke-direct {v4}, Landroid/util/ArrayMap;-><init>()V
 
-    invoke-virtual {v4, v5, v6}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {v2, v3, v4}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
 
     :cond_1
-    new-instance v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;
+    new-instance v2, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;
 
-    invoke-direct {v4}, Ljava/lang/Object;-><init>()V
+    invoke-direct {v2}, Ljava/lang/Object;-><init>()V
 
-    iput p2, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->mType:I
+    iput p2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->mType:I
 
     const/16 p2, 0x4000
 
@@ -514,121 +466,54 @@
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
 
-    move-result-object v5
-
-    const/4 v6, 0x0
+    move-result-object v3
 
-    if-eqz v5, :cond_2
+    if-eqz v3, :cond_2
 
-    iget-object v5, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mWeaverConfig:Landroid/hardware/weaver/WeaverConfig;
+    iget-object v3, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mWeaverConfig:Landroid/hardware/weaver/WeaverConfig;
 
-    iget v5, v5, Landroid/hardware/weaver/WeaverConfig;->valueSize:I
+    iget v3, v3, Landroid/hardware/weaver/WeaverConfig;->valueSize:I
 
-    invoke-static {v5}, Lcom/android/server/locksettings/SecureRandomUtils;->randomBytes(I)[B
+    invoke-static {v3}, Lcom/android/server/locksettings/SecureRandomUtils;->randomBytes(I)[B
 
-    move-result-object v5
+    move-result-object v3
 
-    iput-object v5, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->weaverSecret:[B
+    iput-object v3, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->weaverSecret:[B
 
-    sget-object v7, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_WEAVER_TOKEN:[B
+    sget-object v4, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_WEAVER_TOKEN:[B
 
-    invoke-static {v5, v7, p2}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->encrypt([B[B[B)[B
+    invoke-static {v3, v4, p2}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->encrypt([B[B[B)[B
 
-    move-result-object v5
+    move-result-object v3
 
-    iput-object v5, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->secdiscardableOnDisk:[B
+    iput-object v3, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->secdiscardableOnDisk:[B
 
     goto :goto_0
 
     :cond_2
-    iput-object p2, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->secdiscardableOnDisk:[B
+    iput-object p2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->secdiscardableOnDisk:[B
+
+    const/4 v3, 0x0
 
-    iput-object v6, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->weaverSecret:[B
+    iput-object v3, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->weaverSecret:[B
 
     :goto_0
     invoke-static {p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->transformUnderSecdiscardable([B[B)[B
 
-    move-result-object p2
-
-    iput-object p2, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->aggregatedSecret:[B
-
-    iput-object p4, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->mCallback:Lcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;
-
-    iget-object p2, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
-
-    invoke-virtual {p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->getSecureMode(I)I
-
-    move-result p4
-
-    invoke-virtual {p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->getSecureMode(I)I
-
-    move-result v5
-
-    if-lez v5, :cond_3
-
-    move v5, v1
-
-    goto :goto_1
-
-    :cond_3
-    move v5, v0
-
-    :goto_1
-    if-nez v5, :cond_4
-
-    invoke-virtual {p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSdpMdfppModeForSystem(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_4
-
-    const-string/jumbo p2, "addPendingToken for System. Need to enable SdpMdfppMode."
-
-    invoke-static {p2}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    const/4 p4, 0x2
-
-    move v5, v1
-
-    :cond_4
-    if-eqz v5, :cond_5
-
-    const-string/jumbo p2, "Sdp Mdfpp Mode. set KeyingMaterial"
-
-    invoke-static {p2}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    new-instance p2, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
-
-    invoke-direct {p2, p4, v0, p1}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;-><init>(II[B)V
-
-    iput-object p2, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->km:Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
-
-    invoke-virtual {p2}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->getAppId()[B
-
     move-result-object p1
 
-    iput-object p1, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->aggregatedSecret:[B
-
-    new-array p1, v1, [B
-
-    aput-byte v0, p1, v0
+    iput-object p1, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->aggregatedSecret:[B
 
-    iput-object p1, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->secdiscardableOnDisk:[B
+    iput-object p4, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->mCallback:Lcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;
 
-    iput-object v6, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->weaverSecret:[B
+    iget-object p1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
 
-    goto :goto_2
+    invoke-static {p1, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->-$$Nest$mgetSecureMode(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;I)I
 
-    :cond_5
     const-string/jumbo p1, "Not Sdp Mdfpp Mode. keyingMaterial null"
 
     invoke-static {p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    sget-object p1, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->NULL:Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
-
-    iput-object p1, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->km:Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
-
-    :goto_2
     iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
 
     invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
@@ -641,13 +526,13 @@
 
     check-cast p0, Landroid/util/ArrayMap;
 
-    invoke-static {v2, v3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {v0, v1}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
     move-result-object p1
 
-    invoke-virtual {p0, p1, v4}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {p0, p1, v2}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
 
-    return-wide v2
+    return-wide v0
 .end method
 
 .method public final checkSecurityIntegrity(JJLcom/android/internal/widget/LockscreenCredential;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
@@ -670,11 +555,13 @@
     goto/16 :goto_1
 
     :cond_0
-    const-string/jumbo v3, "pwd"
+    iget-object v3, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const/4 v4, 0x0
+    const-string/jumbo v4, "pwd"
 
-    invoke-virtual {p0, v4, v3, p3, p4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    const/4 v5, 0x0
+
+    invoke-virtual {v3, v5, v4, p3, p4}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object v3
 
@@ -719,7 +606,7 @@
     return-object v0
 
     :cond_2
-    invoke-static {v4}, Lcom/samsung/android/lock/LsLog;->verifyBegin(I)V
+    invoke-static {v5}, Lcom/samsung/android/lock/LsLog;->verifyBegin(I)V
 
     invoke-static {p3, p4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
@@ -745,17 +632,17 @@
 
     move-result-object p4
 
-    invoke-virtual {p0, v4, p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadWeaverSlot(IJ)I
+    invoke-virtual {p0, v5, p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadWeaverSlot(IJ)I
 
     move-result v3
 
-    const/4 v5, -0x1
+    const/4 v4, -0x1
 
     const-wide/16 v6, -0x1
 
     const/4 v8, 0x1
 
-    if-ne v3, v5, :cond_3
+    if-ne v3, v4, :cond_3
 
     sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
@@ -832,7 +719,7 @@
 
     move-result-object p0
 
-    invoke-static {v4, v1, v2, p0}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
+    invoke-static {v5, v1, v2, p0}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
 
     return-object v0
 
@@ -972,7 +859,7 @@
 .end method
 
 .method public final createLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
-    .locals 20
+    .locals 18
 
     move-object/from16 v0, p0
 
@@ -982,30 +869,30 @@
 
     move-wide/from16 v3, p3
 
-    move/from16 v8, p7
+    move/from16 v5, p7
 
     :cond_0
-    sget-object v5, Lcom/android/server/locksettings/SecureRandomUtils;->RNG:Ljava/security/SecureRandom;
+    sget-object v6, Lcom/android/server/locksettings/SecureRandomUtils;->RNG:Ljava/security/SecureRandom;
 
-    invoke-virtual {v5}, Ljava/security/SecureRandom;->nextLong()J
+    invoke-virtual {v6}, Ljava/security/SecureRandom;->nextLong()J
 
-    move-result-wide v5
+    move-result-wide v6
 
-    const-wide/16 v9, 0x0
+    const-wide/16 v8, 0x0
 
-    cmp-long v7, v5, v9
+    cmp-long v10, v6, v8
 
-    if-eqz v7, :cond_0
+    if-eqz v10, :cond_0
 
     invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->isAutoPinConfirmationFeatureAvailable()Z
 
-    move-result v7
+    move-result v10
 
-    if-eqz v7, :cond_1
+    if-eqz v10, :cond_1
 
     invoke-virtual/range {p5 .. p5}, Lcom/android/internal/widget/LockscreenCredential;->size()I
 
-    move-result v7
+    move-result v10
 
     invoke-virtual/range {p5 .. p5}, Lcom/android/internal/widget/LockscreenCredential;->isPin()Z
 
@@ -1015,7 +902,7 @@
 
     iget-object v12, v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {v12, v8}, Lcom/android/server/locksettings/LockSettingsStorage;->isAutoPinConfirmSettingEnabled(I)Z
+    invoke-virtual {v12, v5}, Lcom/android/server/locksettings/LockSettingsStorage;->isAutoPinConfirmSettingEnabled(I)Z
 
     move-result v12
 
@@ -1023,567 +910,371 @@
 
     const/4 v12, 0x6
 
-    if-ge v7, v12, :cond_2
+    if-ge v10, v12, :cond_2
 
     :cond_1
-    const/4 v7, -0x1
+    const/4 v10, -0x1
 
     :cond_2
     iget-object v12, v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
 
-    invoke-virtual {v12, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->getSecureMode(I)I
-
-    move-result v13
+    invoke-static {v12, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->-$$Nest$mgetSecureMode(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;I)I
 
-    invoke-virtual {v12, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->getSecureMode(I)I
+    move-result v12
 
-    move-result v14
+    new-instance v13, Ljava/lang/StringBuilder;
 
-    const/4 v15, 0x0
+    const-string/jumbo v14, "createLskfBasedProtector for user "
 
-    move-wide/from16 v16, v9
+    invoke-direct {v13, v14}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    const/4 v9, 0x1
+    invoke-virtual {v13, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    if-lez v14, :cond_3
+    const-string v14, " secureMode : "
 
-    move v10, v9
+    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    goto :goto_0
+    invoke-virtual {v13, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    :cond_3
-    move v10, v15
+    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    :goto_0
-    invoke-virtual {v12, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isNeedToEnableSdpMdfppModeForSystem(I)Z
+    move-result-object v12
 
-    move-result v14
+    invoke-static {v12}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    const/4 v11, 0x0
+    invoke-virtual/range {p5 .. p5}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    if-eqz v14, :cond_5
+    move-result v12
 
-    const-string/jumbo v10, "createLskfBasedProtector for System. Need to enable SdpMdfppMode."
+    const/4 v13, 0x1
 
-    invoke-static {v10}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
+    const/4 v14, 0x0
 
-    sget-object v14, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mSecureModeCache:Landroid/util/SparseArray;
+    const/4 v15, 0x0
 
-    monitor-enter v14
+    if-eqz v12, :cond_3
 
-    :try_start_0
-    invoke-virtual {v14, v8}, Landroid/util/SparseArray;->delete(I)V
+    move-wide/from16 v16, v8
 
-    monitor-exit v14
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
+    move-object v8, v15
 
-    sget-boolean v10, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEBUG:Z
+    :goto_0
+    move-object/from16 v9, p5
 
-    if-eqz v10, :cond_4
+    goto :goto_1
 
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    :cond_3
+    invoke-virtual/range {p5 .. p5}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
-    move-result-object v10
+    move-result v12
 
-    filled-new-array {v10}, [Ljava/lang/Object;
+    move-wide/from16 v16, v8
 
-    move-result-object v10
+    new-instance v8, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
 
-    const-string v13, "Delete - [ Secure Mode : X, UserId : %d ]"
+    invoke-direct {v8}, Ljava/lang/Object;-><init>()V
 
-    invoke-static {v13, v10}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    const/16 v9, 0xb
 
-    move-result-object v10
+    iput-byte v9, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->scryptLogN:B
 
-    const-string/jumbo v13, "SyntheticPasswordManager.SDP"
+    const/4 v9, 0x3
 
-    invoke-static {v13, v10}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+    iput-byte v9, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->scryptLogR:B
 
-    :cond_4
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
+    iput-byte v13, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->scryptLogP:B
 
-    move-result-wide v13
+    iput v12, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->credentialType:I
 
-    :try_start_1
-    iget-object v10, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iput v10, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->pinLength:I
 
-    invoke-static {v10}, Lcom/android/server/locksettings/SyntheticPasswordManager;->-$$Nest$mgetSdpManager(Lcom/android/server/locksettings/SyntheticPasswordManager;)Ljava/util/Optional;
+    const/16 v9, 0x10
 
-    move-result-object v10
+    invoke-static {v9}, Lcom/android/server/locksettings/SecureRandomUtils;->randomBytes(I)[B
 
-    new-instance v12, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda0;
+    move-result-object v9
 
-    invoke-direct {v12, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager$$ExternalSyntheticLambda0;-><init>(I)V
+    iput-object v9, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->salt:[B
 
-    invoke-virtual {v10, v12}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    iput v14, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
 
-    invoke-static {v13, v14}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    goto :goto_0
 
-    move v10, v9
+    :goto_1
+    invoke-virtual {v0, v9, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchLskf(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;)[B
 
-    const/4 v13, 0x2
+    move-result-object v10
 
-    goto :goto_2
+    invoke-static {v6, v7}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    :catchall_0
-    move-exception v0
+    move-result-object v12
 
-    goto :goto_1
+    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    :catch_0
-    move-exception v0
+    move-result-object v13
 
-    :try_start_2
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
+    filled-new-array {v12, v13}, [Ljava/lang/Object;
 
-    const-string/jumbo v1, "update SdpMdfppMode failed!"
+    move-result-object v12
 
-    invoke-static {v0, v11, v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/Exception;Ljava/lang/String;Ljava/lang/String;)V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+    const-string v13, "Creating LSKF-based protector %016x for user %d"
 
-    invoke-static {v13, v14}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    const-string/jumbo v11, "SyntheticPasswordManager"
 
-    new-instance v0, Ljava/lang/IllegalStateException;
+    invoke-static {v11, v13, v12}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    const-string v1, "Failed to update SdpMdfppMode for System"
+    invoke-static {v5}, Lcom/samsung/android/lock/LsLog;->enrollBegin(I)V
 
-    invoke-direct {v0, v1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
+    invoke-virtual {v9}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    throw v0
+    move-result v12
 
-    :goto_1
-    invoke-static {v13, v14}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    if-eqz v12, :cond_4
 
-    throw v0
+    iget-object v12, v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mContext:Landroid/content/Context;
 
-    :catchall_1
-    move-exception v0
+    invoke-virtual {v12}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    :try_start_3
-    monitor-exit v14
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    move-result-object v12
 
-    throw v0
+    const v13, 0x1110148
 
-    :cond_5
-    :goto_2
-    new-instance v12, Ljava/lang/StringBuilder;
+    invoke-virtual {v12, v13}, Landroid/content/res/Resources;->getBoolean(I)Z
 
-    const-string/jumbo v14, "createLskfBasedProtector for user "
+    move-result v12
 
-    invoke-direct {v12, v14}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    if-eqz v12, :cond_4
 
-    invoke-virtual {v12, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    const-string/jumbo v12, "Not using Weaver for unsecured user (disabled by config)"
 
-    const-string v14, " secureMode : "
+    invoke-static {v11, v12}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {v12, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    move-object v12, v15
 
-    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    goto :goto_2
 
-    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    :cond_4
+    invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
 
     move-result-object v12
 
-    invoke-static {v12}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
+    :goto_2
+    if-eqz v12, :cond_7
 
-    invoke-virtual/range {p5 .. p5}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getNextAvailableWeaverSlot()I
 
-    move-result v12
+    move-result v1
 
-    if-eqz v12, :cond_6
+    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-object v14, v11
+    move-result-object v2
 
-    :goto_3
-    move-object/from16 v7, p5
+    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    goto :goto_5
+    move-result-object v3
 
-    :cond_6
-    invoke-virtual/range {p5 .. p5}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    filled-new-array {v2, v3}, [Ljava/lang/Object;
 
-    move-result v12
+    move-result-object v2
 
-    new-instance v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
+    const-string v3, "Enrolling LSKF for user %d into Weaver slot %d"
 
-    invoke-direct {v14}, Ljava/lang/Object;-><init>()V
+    invoke-static {v11, v3, v2}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    const/16 v11, 0xb
+    invoke-virtual {v9}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
-    iput-byte v11, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->scryptLogN:B
+    move-result v2
 
-    const/4 v11, 0x3
+    if-eqz v8, :cond_5
 
-    iput-byte v11, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->scryptLogR:B
+    iget-object v3, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->salt:[B
 
-    iput-byte v9, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->scryptLogP:B
+    goto :goto_3
 
-    iput v12, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->credentialType:I
+    :cond_5
+    move-object v3, v15
 
-    iput v7, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->pinLength:I
+    :goto_3
+    invoke-static {v2, v1, v6, v7, v3}, Lcom/samsung/android/lock/LsLog;->enrollUpdate(IIJ[B)V
 
-    const/16 v7, 0x10
+    invoke-static {v14, v1, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->begin(III)V
 
-    invoke-static {v7}, Lcom/android/server/locksettings/SecureRandomUtils;->randomBytes(I)[B
+    invoke-virtual {v0, v10}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchedLskfToWeaverKey([B)[B
 
-    move-result-object v7
+    move-result-object v2
 
-    iput-object v7, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->salt:[B
+    invoke-virtual {v0, v12, v1, v2, v15}, Lcom/android/server/locksettings/SyntheticPasswordManager;->weaverEnroll(Landroid/hardware/weaver/IWeaver;I[B[B)[B
 
-    iput v15, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
+    move-result-object v2
 
-    if-ltz v13, :cond_8
+    invoke-static {v5}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->finish(I)V
 
-    const/4 v7, 0x2
+    if-eqz v2, :cond_6
 
-    if-le v13, v7, :cond_7
+    invoke-virtual {v0, v1, v5, v6, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveWeaverSlot(IIJ)V
 
-    goto :goto_4
+    iget-object v3, v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mPasswordSlotManager:Lcom/android/server/locksettings/PasswordSlotManager;
 
-    :cond_7
-    iput v13, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
+    invoke-virtual {v3, v1}, Lcom/android/server/locksettings/PasswordSlotManager;->markSlotInUse(I)V
 
-    goto :goto_3
+    invoke-virtual {v0, v8, v14, v5, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->synchronizeWeaverFrpPassword(Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;III)V
 
-    :cond_8
-    :goto_4
-    iput v15, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
+    sget-object v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_WEAVER_PASSWORD:[B
 
-    goto :goto_3
+    filled-new-array {v2}, [[B
 
-    :goto_5
-    invoke-virtual {v0, v7, v14}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchLskf(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;)[B
+    move-result-object v2
 
-    move-result-object v11
+    invoke-static {v1, v2}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->personalizedHash([B[[B)[B
 
-    if-eqz v10, :cond_9
+    move-result-object v1
 
-    new-instance v12, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
+    filled-new-array {v10, v1}, [[B
 
-    invoke-direct {v12, v13, v11}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;-><init>(I[B)V
+    move-result-object v1
 
-    goto :goto_6
+    invoke-static {v1}, Lcom/android/internal/util/ArrayUtils;->concat([[B)[B
 
-    :cond_9
-    sget-object v12, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->NULL:Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
+    move-result-object v1
 
-    :goto_6
-    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    move-wide v3, v6
 
-    move-result-object v13
+    :goto_4
+    move-object v6, v1
 
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    goto/16 :goto_c
 
-    move-result-object v9
+    :cond_6
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    filled-new-array {v13, v9}, [Ljava/lang/Object;
+    const-string v1, "Fail to enroll user password under waver "
 
-    move-result-object v9
+    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    const-string/jumbo v13, "SyntheticPasswordManager"
+    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v15, "Creating LSKF-based protector %016x for user %d"
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-static {v13, v15, v9}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    move-result-object v0
 
-    invoke-static {v8}, Lcom/samsung/android/lock/LsLog;->enrollBegin(I)V
+    invoke-static {v15, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    invoke-virtual {v7}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    new-instance v0, Ljava/lang/IllegalStateException;
 
-    move-result v9
+    const-string v1, "Fail to enroll user password under weaver "
 
-    if-eqz v9, :cond_a
+    invoke-static {v5, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
 
-    iget-object v9, v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v9}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v9
-
-    const v15, 0x1110148
-
-    invoke-virtual {v9, v15}, Landroid/content/res/Resources;->getBoolean(I)Z
-
-    move-result v9
-
-    if-eqz v9, :cond_a
-
-    const-string/jumbo v9, "Not using Weaver for unsecured user (disabled by config)"
-
-    invoke-static {v13, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 v9, 0x0
-
-    goto :goto_7
-
-    :cond_a
-    invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
-
-    move-result-object v9
-
-    :goto_7
-    if-eqz v9, :cond_d
-
-    invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getNextAvailableWeaverSlot()I
-
-    move-result v1
-
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v2
-
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v3
-
-    filled-new-array {v2, v3}, [Ljava/lang/Object;
-
-    move-result-object v2
-
-    const-string v3, "Enrolling LSKF for user %d into Weaver slot %d"
-
-    invoke-static {v13, v3, v2}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {v7}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v2
-
-    if-eqz v14, :cond_b
-
-    iget-object v3, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->salt:[B
-
-    goto :goto_8
-
-    :cond_b
-    const/4 v3, 0x0
-
-    :goto_8
-    invoke-static {v2, v1, v5, v6, v3}, Lcom/samsung/android/lock/LsLog;->enrollUpdate(IIJ[B)V
-
-    const/4 v2, 0x0
-
-    invoke-static {v2, v1, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->begin(III)V
-
-    invoke-virtual {v0, v11}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchedLskfToWeaverKey([B)[B
-
-    move-result-object v3
-
-    const/4 v4, 0x0
-
-    invoke-virtual {v0, v9, v1, v3, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->weaverEnroll(Landroid/hardware/weaver/IWeaver;I[B[B)[B
-
-    move-result-object v3
-
-    invoke-static {v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->finish(I)V
-
-    if-eqz v3, :cond_c
-
-    invoke-virtual {v0, v1, v8, v5, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveWeaverSlot(IIJ)V
-
-    iget-object v4, v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mPasswordSlotManager:Lcom/android/server/locksettings/PasswordSlotManager;
-
-    invoke-virtual {v4, v1}, Lcom/android/server/locksettings/PasswordSlotManager;->markSlotInUse(I)V
-
-    invoke-virtual {v0, v14, v2, v8, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->synchronizeWeaverFrpPassword(Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;III)V
-
-    sget-object v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_WEAVER_PASSWORD:[B
-
-    filled-new-array {v3}, [[B
-
-    move-result-object v2
-
-    invoke-static {v1, v2}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->personalizedHash([B[[B)[B
-
-    move-result-object v1
-
-    filled-new-array {v11, v1}, [[B
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/android/internal/util/ArrayUtils;->concat([[B)[B
-
-    move-result-object v1
-
-    move-wide/from16 v18, v5
-
-    move-object v6, v1
-
-    move-wide/from16 v1, v18
-
-    goto/16 :goto_12
-
-    :cond_c
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string v1, "Fail to enroll user password under waver "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v4, 0x0
-
-    invoke-static {v4, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    new-instance v0, Ljava/lang/IllegalStateException;
-
-    const-string v1, "Fail to enroll user password under weaver "
-
-    invoke-static {v8, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
+    move-result-object v1
 
     invoke-direct {v0, v1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
 
     throw v0
 
-    :cond_d
-    invoke-virtual {v7}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    :cond_7
+    invoke-virtual {v9}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
-    move-result v9
+    move-result v12
 
-    if-eqz v14, :cond_e
+    if-eqz v8, :cond_8
 
-    iget-object v15, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->salt:[B
+    iget-object v13, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->salt:[B
 
-    :goto_9
-    const/4 v7, -0x1
+    :goto_5
+    const/4 v14, -0x1
 
-    goto :goto_a
+    goto :goto_6
 
-    :cond_e
-    const/4 v15, 0x0
+    :cond_8
+    move-object v13, v15
 
-    goto :goto_9
+    goto :goto_5
 
-    :goto_a
-    invoke-static {v9, v7, v5, v6, v15}, Lcom/samsung/android/lock/LsLog;->enrollUpdate(IIJ[B)V
+    :goto_6
+    invoke-static {v12, v14, v6, v7, v13}, Lcom/samsung/android/lock/LsLog;->enrollUpdate(IIJ[B)V
 
-    invoke-virtual/range {p5 .. p5}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    invoke-virtual {v9}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    move-result v7
+    move-result v12
 
-    if-nez v7, :cond_15
+    if-nez v12, :cond_d
 
-    :try_start_4
-    invoke-static {v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
+    :try_start_0
+    invoke-static {v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
 
-    move-result v7
+    move-result v12
 
-    invoke-interface {v1, v7}, Landroid/service/gatekeeper/IGateKeeperService;->clearSecureUserId(I)V
-    :try_end_4
-    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_1
+    invoke-interface {v1, v12}, Landroid/service/gatekeeper/IGateKeeperService;->clearSecureUserId(I)V
+    :try_end_0
+    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
 
-    goto :goto_b
+    goto :goto_7
 
-    :catch_1
-    const-string v7, "Failed to clear SID from gatekeeper"
+    :catch_0
+    const-string v12, "Failed to clear SID from gatekeeper"
 
-    invoke-static {v13, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v11, v12}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_b
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    :goto_7
+    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v7
+    move-result-object v12
 
-    filled-new-array {v7}, [Ljava/lang/Object;
+    filled-new-array {v12}, [Ljava/lang/Object;
 
-    move-result-object v7
+    move-result-object v12
 
-    const-string v9, "Enrolling LSKF for user %d into Gatekeeper"
+    const-string v13, "Enrolling LSKF for user %d into Gatekeeper"
 
-    invoke-static {v13, v9, v7}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v11, v13, v12}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    const-string v7, "Failed to enroll LSKF for new SP protector for user "
+    const-string v11, "Failed to enroll LSKF for new SP protector for user "
 
-    if-eqz v10, :cond_10
+    if-eqz v2, :cond_b
 
-    :try_start_5
-    invoke-static {v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
+    :try_start_1
+    invoke-virtual {v2}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    move-result v2
+    move-result v12
 
-    iget-object v3, v12, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->gkInput:[B
+    if-nez v12, :cond_b
 
-    if-nez v3, :cond_f
+    cmp-long v12, v3, v16
 
-    iget-object v3, v12, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->pivot:[B
+    if-eqz v12, :cond_b
 
-    iget v4, v12, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->secureMode:I
+    const-string/jumbo v12, "pwd"
 
-    const-string v9, "ForUserAuthentication"
+    iget-object v13, v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-static {v4, v9, v3}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->personalize(ILjava/lang/String;[B)[B
+    invoke-virtual {v13, v5, v12, v3, v4}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object v3
 
-    iput-object v3, v12, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->gkInput:[B
-
-    :cond_f
-    iget-object v3, v12, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->gkInput:[B
-
-    const/4 v4, 0x0
-
-    invoke-interface {v1, v2, v4, v4, v3}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
-
-    move-result-object v1
+    if-eqz v3, :cond_9
 
-    goto :goto_d
-
-    :catch_2
-    move-exception v0
-
-    goto/16 :goto_e
-
-    :cond_10
-    if-eqz v2, :cond_13
-
-    invoke-virtual {v2}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v9
-
-    if-nez v9, :cond_13
-
-    cmp-long v9, v3, v16
-
-    if-eqz v9, :cond_13
-
-    const-string/jumbo v9, "pwd"
-
-    invoke-virtual {v0, v8, v9, v3, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-static {v3}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
 
     move-result-object v3
 
-    if-eqz v3, :cond_11
-
-    invoke-static {v3}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
+    goto :goto_8
 
-    move-result-object v3
+    :catch_1
+    move-exception v0
 
-    goto :goto_c
+    goto :goto_a
 
-    :cond_11
-    const/4 v3, 0x0
+    :cond_9
+    move-object v3, v15
 
-    :goto_c
-    if-eqz v3, :cond_12
+    :goto_8
+    if-eqz v3, :cond_a
 
     invoke-virtual {v0, v2, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchLskf(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;)[B
 
     move-result-object v2
 
-    invoke-static {v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
+    invoke-static {v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
 
     move-result v4
 
@@ -1593,66 +1284,62 @@
 
     move-result-object v2
 
-    invoke-static {v11}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchedLskfToGkPassword([B)[B
+    invoke-static {v10}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchedLskfToGkPassword([B)[B
 
-    move-result-object v9
+    move-result-object v12
 
-    invoke-interface {v1, v4, v3, v2, v9}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
+    invoke-interface {v1, v4, v3, v2, v12}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
 
     move-result-object v1
 
-    goto :goto_d
+    goto :goto_9
 
-    :cond_12
+    :cond_a
     const-string/jumbo v2, "previous pwd is null! N-1 is not set!"
 
     invoke-static {v2}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;)V
 
-    invoke-static {v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
+    invoke-static {v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
 
     move-result v2
 
-    invoke-static {v11}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchedLskfToGkPassword([B)[B
+    invoke-static {v10}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchedLskfToGkPassword([B)[B
 
     move-result-object v3
 
-    const/4 v4, 0x0
-
-    invoke-interface {v1, v2, v4, v4, v3}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
+    invoke-interface {v1, v2, v15, v15, v3}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
 
     move-result-object v1
 
-    goto :goto_d
+    goto :goto_9
 
-    :cond_13
-    invoke-static {v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
+    :cond_b
+    invoke-static {v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
 
     move-result v2
 
-    invoke-static {v11}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchedLskfToGkPassword([B)[B
+    invoke-static {v10}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchedLskfToGkPassword([B)[B
 
     move-result-object v3
 
-    const/4 v4, 0x0
-
-    invoke-interface {v1, v2, v4, v4, v3}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
+    invoke-interface {v1, v2, v15, v15, v3}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
 
     move-result-object v1
-    :try_end_5
-    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_5} :catch_2
+    :try_end_1
+    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1
 
-    :goto_d
+    :goto_9
     invoke-virtual {v1}, Landroid/service/gatekeeper/GateKeeperResponse;->getResponseCode()I
 
     move-result v2
 
-    if-nez v2, :cond_14
+    if-nez v2, :cond_c
 
     invoke-virtual {v1}, Landroid/service/gatekeeper/GateKeeperResponse;->getPayload()[B
 
     move-result-object v1
 
-    iput-object v1, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
+    iput-object v1, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
 
     invoke-virtual {v0, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->sidFromPasswordHandle([B)J
 
@@ -1660,9 +1347,9 @@
 
     move-wide/from16 v16, v1
 
-    goto :goto_f
+    goto :goto_b
 
-    :cond_14
+    :cond_c
     new-instance v0, Ljava/lang/StringBuilder;
 
     const-string v2, "Failed to enroll LSKF by response code "
@@ -1685,7 +1372,7 @@
 
     new-instance v0, Ljava/lang/IllegalStateException;
 
-    invoke-static {v8, v7}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
+    invoke-static {v5, v11}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
 
     move-result-object v1
 
@@ -1693,7 +1380,7 @@
 
     throw v0
 
-    :goto_e
+    :goto_a
     const-string v1, "Failed to enroll LSKF by RemoteException"
 
     const/4 v2, 0x1
@@ -1702,7 +1389,7 @@
 
     new-instance v1, Ljava/lang/IllegalStateException;
 
-    invoke-static {v8, v7}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
+    invoke-static {v5, v11}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;
 
     move-result-object v2
 
@@ -1710,138 +1397,81 @@
 
     throw v1
 
-    :cond_15
-    :goto_f
-    if-eqz v10, :cond_16
-
-    invoke-virtual {v12}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->getAppId()[B
-
-    move-result-object v1
-
-    move-object v3, v1
-
-    move-wide v1, v5
-
-    :goto_10
-    const/4 v4, 0x0
-
-    goto :goto_11
-
-    :cond_16
+    :cond_d
+    :goto_b
     const/16 v1, 0x4000
 
     invoke-static {v1}, Lcom/android/server/locksettings/SecureRandomUtils;->randomBytes(I)[B
 
-    move-result-object v1
-
-    const-string/jumbo v4, "secdis"
-
-    move-wide v2, v5
-
-    move-object v5, v1
-
-    move v1, v8
-
-    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
-
-    move-wide v1, v2
-
-    invoke-static {v11, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->transformUnderSecdiscardable([B[B)[B
-
-    move-result-object v3
+    move-result-object v2
 
-    goto :goto_10
+    const-string/jumbo v1, "secdis"
 
-    :goto_11
-    invoke-virtual {v0, v14, v4, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->synchronizeGatekeeperFrpPassword(Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;II)V
+    move-wide v3, v6
 
-    move-object v6, v3
+    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
-    :goto_12
-    invoke-virtual/range {p5 .. p5}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    invoke-static {v10, v2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->transformUnderSecdiscardable([B[B)[B
 
-    move-result v3
+    move-result-object v1
 
-    if-nez v3, :cond_17
+    const/4 v2, 0x0
 
-    const-string/jumbo v4, "pwd"
+    invoke-virtual {v0, v8, v2, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->synchronizeGatekeeperFrpPassword(Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;II)V
 
-    invoke-virtual {v14}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->toBytes()[B
+    goto/16 :goto_4
 
-    move-result-object v5
+    :goto_c
+    invoke-virtual {v9}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    move-wide v2, v1
+    move-result v1
 
-    move v1, v8
+    if-nez v1, :cond_e
 
-    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    const-string/jumbo v1, "pwd"
 
-    move v5, v1
+    invoke-virtual {v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->toBytes()[B
 
-    move-wide v3, v2
+    move-result-object v2
 
-    move-object/from16 v1, p5
+    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
     move-object/from16 v2, p6
 
+    move-object v1, v9
+
     invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->savePasswordMetrics(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;JI)V
 
+    :cond_e
     move-wide v1, v3
 
-    :cond_17
-    move-object v11, v0
-
-    if-eqz v10, :cond_18
-
-    iget-object v0, v11, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
-
     const/4 v3, 0x0
 
-    move-object/from16 v4, p6
-
-    move/from16 v8, p7
-
-    move-object v5, v6
-
-    move-object v9, v12
-
-    move-wide/from16 v6, v16
-
-    invoke-virtual/range {v0 .. v9}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->createSyntheticPasswordBlobSpecific(JBLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;[BJILcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;)V
+    move-object/from16 v0, p0
 
-    invoke-virtual {v9}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->destroy()V
+    move-object/from16 v4, p6
 
     move/from16 v8, p7
 
-    move-object v0, v11
-
-    goto :goto_13
-
-    :cond_18
     move-object v5, v6
 
     move-wide/from16 v6, v16
 
-    const/4 v3, 0x0
-
-    move-object/from16 v4, p6
-
-    move/from16 v8, p7
+    invoke-virtual/range {v0 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createSyntheticPasswordBlob(JBLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;[BJI)V
 
-    move-object v0, v11
+    move-wide v3, v1
 
-    invoke-virtual/range {v0 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createSyntheticPasswordBlob(JBLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;[BJI)V
+    move v5, v8
 
-    :goto_13
-    invoke-virtual {v0, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
+    invoke-virtual {v0, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
 
     const-string v0, "Enroll Success"
 
-    const/4 v4, 0x0
+    const/4 v2, 0x0
 
-    invoke-static {v4, v0}, Lcom/samsung/android/lock/LsLog;->enrollFinish(ILjava/lang/String;)V
+    invoke-static {v2, v0}, Lcom/samsung/android/lock/LsLog;->enrollFinish(ILjava/lang/String;)V
 
-    return-wide v1
+    return-wide v3
 .end method
 
 .method public final createSecurityIntegrity(JLcom/android/internal/widget/LockscreenCredential;)J
@@ -1862,17 +1492,19 @@
 
     if-eqz v5, :cond_4
 
-    const-string/jumbo v5, "pwd"
+    iget-object v5, v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const/4 v6, 0x0
+    const-string/jumbo v6, "pwd"
+
+    const/4 v7, 0x0
 
-    move-wide/from16 v7, p1
+    move-wide/from16 v8, p1
 
-    invoke-virtual {v0, v6, v5, v7, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {v5, v7, v6, v8, v9}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object v5
 
-    const/4 v9, 0x0
+    const/4 v6, 0x0
 
     if-eqz v5, :cond_0
 
@@ -1883,7 +1515,7 @@
     goto :goto_1
 
     :cond_0
-    move-object v5, v9
+    move-object v5, v6
 
     :goto_1
     if-nez v5, :cond_1
@@ -1914,13 +1546,13 @@
     return-wide v3
 
     :cond_2
-    invoke-static {v6}, Lcom/samsung/android/lock/LsLog;->enrollBegin(I)V
+    invoke-static {v7}, Lcom/samsung/android/lock/LsLog;->enrollBegin(I)V
 
     invoke-static {v1, v2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
     move-result-object v13
 
-    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v14
 
@@ -1938,7 +1570,7 @@
 
     move-result v13
 
-    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v14
 
@@ -1962,7 +1594,7 @@
 
     invoke-static {v3, v13, v1, v2, v11}, Lcom/samsung/android/lock/LsLog;->enrollUpdate(IIJ[B)V
 
-    invoke-static {v7, v8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
     move-result-object v3
 
@@ -1986,7 +1618,7 @@
 
     move-result-object v4
 
-    invoke-virtual {v0, v12, v13, v4, v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->weaverEnroll(Landroid/hardware/weaver/IWeaver;I[B[B)[B
+    invoke-virtual {v0, v12, v13, v4, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->weaverEnroll(Landroid/hardware/weaver/IWeaver;I[B[B)[B
 
     move-result-object v4
 
@@ -2005,7 +1637,7 @@
     return-wide v16
 
     :cond_3
-    invoke-virtual {v0, v13, v6, v1, v2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveWeaverSlot(IIJ)V
+    invoke-virtual {v0, v13, v7, v1, v2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveWeaverSlot(IIJ)V
 
     iget-object v4, v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mPasswordSlotManager:Lcom/android/server/locksettings/PasswordSlotManager;
 
@@ -2017,14 +1649,14 @@
 
     move-result-object v3
 
-    invoke-static {v6, v3}, Lcom/samsung/android/lock/LsLog;->enrollFinish(ILjava/lang/String;)V
+    invoke-static {v7, v3}, Lcom/samsung/android/lock/LsLog;->enrollFinish(ILjava/lang/String;)V
 
-    invoke-virtual {v0, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
+    invoke-virtual {v0, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
 
     return-wide v1
 
     :cond_4
-    move-wide/from16 v7, p1
+    move-wide/from16 v8, p1
 
     move-object/from16 v10, p3
 
@@ -2245,26 +1877,15 @@
 
     :cond_1
     :goto_1
-    invoke-virtual {p4}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->isSdpMdfppMode()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_2
-
-    iget-object v2, p4, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    goto :goto_0
-
-    :cond_2
     iget-object v2, p4, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEncryptedEscrowSplit0:[B
 
-    if-nez v2, :cond_3
+    if-nez v2, :cond_2
 
     const/4 v2, 0x0
 
     goto :goto_0
 
-    :cond_3
+    :cond_2
     iget-object v3, p4, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
 
     sget-object v4, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_E0:[B
@@ -2294,11 +1915,11 @@
 
     const/4 v3, 0x3
 
-    if-ne p4, v3, :cond_4
+    if-ne p4, v3, :cond_3
 
     goto :goto_3
 
-    :cond_4
+    :cond_3
     move v3, v0
 
     :goto_3
@@ -2306,27 +1927,27 @@
 
     add-int/2addr p4, v0
 
-    new-array v8, p4, [B
+    new-array v5, p4, [B
 
     const/4 p4, 0x0
 
-    aput-byte v3, v8, p4
+    aput-byte v3, v5, p4
 
-    aput-byte p3, v8, v1
+    aput-byte p3, v5, v1
 
     array-length p3, v2
 
-    invoke-static {v2, p4, v8, v0, p3}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
+    invoke-static {v2, p4, v5, v0, p3}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
 
-    const-string/jumbo v7, "spblob"
+    const-string/jumbo v4, "spblob"
 
     move-object v3, p0
 
-    move-wide v5, p1
+    move-wide v6, p1
 
-    move/from16 v4, p8
+    move/from16 v8, p8
 
-    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
     return-void
 .end method
@@ -2334,260 +1955,194 @@
 .method public final createTokenBasedProtector(IJLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
     .locals 12
 
-    move-wide v1, p2
-
     move-object/from16 v6, p4
 
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
+    iget-object v3, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v3
+    move-result-object v4
 
-    invoke-virtual {v0, v3}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z
+    invoke-virtual {v3, v4}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z
 
-    move-result v0
+    move-result v3
 
-    const/4 v3, 0x0
+    const/4 v4, 0x0
 
-    if-nez v0, :cond_0
+    if-nez v3, :cond_0
 
     goto :goto_0
 
     :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
+    iget-object v3, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v4
+    move-result-object v7
 
-    invoke-virtual {v0, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {v3, v7}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
 
-    move-result-object v0
+    move-result-object v3
 
-    check-cast v0, Landroid/util/ArrayMap;
+    check-cast v3, Landroid/util/ArrayMap;
 
     invoke-static {p2, p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    move-result-object v4
+    move-result-object v7
 
-    invoke-virtual {v0, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {v3, v7}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
 
-    move-result-object v0
+    move-result-object v3
 
-    move-object v10, v0
+    move-object v9, v3
 
-    check-cast v10, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;
+    check-cast v9, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;
 
-    if-nez v10, :cond_1
+    if-nez v9, :cond_1
 
     :goto_0
-    return v3
+    return v4
 
     :cond_1
-    invoke-virtual {v6}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->isSdpMdfppMode()Z
-
-    move-result v0
-
-    const-string/jumbo v4, "SyntheticPasswordManager"
-
-    if-nez v0, :cond_2
-
-    invoke-virtual {p0, p1, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadEscrowData(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_2
-
-    const-string/jumbo p0, "user is not escrowable"
-
-    invoke-static {v4, p0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v3
-
-    :cond_2
-    invoke-virtual {p0, p1, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadEscrowData(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_3
-
-    const-string/jumbo p0, "User is not escrowable"
-
-    invoke-static {v4, p0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v3
-
-    :cond_3
-    invoke-static {p2, p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v0
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v5
-
-    filled-new-array {v0, v5}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    const-string v5, "Creating token-based protector %016x for user %d"
-
-    invoke-static {v4, v5, v0}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
-
-    move-result-object v0
-
-    if-eqz v0, :cond_5
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getNextAvailableWeaverSlot()I
-
-    move-result v5
-
-    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v7
+    invoke-virtual {p0, p1, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadEscrowData(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
 
-    filled-new-array {v7}, [Ljava/lang/Object;
+    move-result v3
 
-    move-result-object v7
+    const-string/jumbo v7, "User is not escrowable"
 
-    const-string/jumbo v8, "Using Weaver slot %d for new token-based protector"
+    const-string/jumbo v8, "SyntheticPasswordManager"
 
-    invoke-static {v4, v8, v7}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    if-nez v3, :cond_2
 
-    invoke-static {v3, v5, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->begin(III)V
+    invoke-static {v8, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/4 v7, 0x0
+    return v4
 
-    iget-object v8, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->weaverSecret:[B
+    :cond_2
+    invoke-virtual {p0, p1, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadEscrowData(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
 
-    invoke-virtual {p0, v0, v5, v7, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->weaverEnroll(Landroid/hardware/weaver/IWeaver;I[B[B)[B
+    move-result v3
 
-    move-result-object v0
+    if-nez v3, :cond_3
 
-    if-nez v0, :cond_4
+    invoke-static {v8, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    const-string p0, "Failed to enroll weaver secret when activating token"
+    return v4
 
-    invoke-static {v4, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    :cond_3
+    invoke-static {p2, p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    new-instance p0, Ljava/lang/StringBuilder;
+    move-result-object v3
 
-    const-string v0, "Failed to enroll token for user "
+    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    invoke-direct {p0, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    move-result-object v7
 
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    filled-new-array {v3, v7}, [Ljava/lang/Object;
 
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    move-result-object v3
 
-    move-result-object p0
+    const-string v7, "Creating token-based protector %016x for user %d"
 
-    invoke-static {v5, p0}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->finishOff(ILjava/lang/String;)V
+    invoke-static {v8, v7, v3}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    return v3
+    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
 
-    :cond_4
-    invoke-static {p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->finish(I)V
+    move-result-object v3
 
-    invoke-virtual {p0, v5, p1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveWeaverSlot(IIJ)V
+    if-eqz v3, :cond_5
 
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mPasswordSlotManager:Lcom/android/server/locksettings/PasswordSlotManager;
+    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getNextAvailableWeaverSlot()I
 
-    invoke-virtual {v0, v5}, Lcom/android/server/locksettings/PasswordSlotManager;->markSlotInUse(I)V
+    move-result v7
 
-    :cond_5
-    iget-object v5, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->secdiscardableOnDisk:[B
+    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    const-string/jumbo v4, "secdis"
+    move-result-object v10
 
-    move-object v0, p0
+    filled-new-array {v10}, [Ljava/lang/Object;
 
-    move-wide v2, v1
+    move-result-object v10
 
-    move v1, p1
+    const-string/jumbo v11, "Using Weaver slot %d for new token-based protector"
 
-    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    invoke-static {v8, v11, v10}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
+    invoke-static {v4, v7, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->begin(III)V
 
-    invoke-static {v0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->-$$Nest$misSdpMdfppMode(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;I)Z
+    const/4 v10, 0x0
 
-    move-result v1
+    iget-object v11, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->weaverSecret:[B
 
-    const/4 v11, 0x1
+    invoke-virtual {p0, v3, v7, v10, v11}, Lcom/android/server/locksettings/SyntheticPasswordManager;->weaverEnroll(Landroid/hardware/weaver/IWeaver;I[B[B)[B
 
-    if-nez v1, :cond_6
+    move-result-object v3
 
-    invoke-virtual {v0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSdpMdfppModeForSystem(I)Z
+    if-nez v3, :cond_4
 
-    move-result v0
+    const-string v0, "Failed to enroll weaver secret when activating token"
 
-    if-eqz v0, :cond_6
+    invoke-static {v8, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    const-string/jumbo v0, "createTokenBasedProtector for System. Need to enable SdpMdfppMode."
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
+    const-string v1, "Failed to enroll token for user "
 
-    move v1, v11
+    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    :cond_6
-    const/4 v0, 0x2
+    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    if-eqz v1, :cond_8
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    iget v1, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->mType:I
+    move-result-object v0
 
-    if-eq v1, v11, :cond_7
+    invoke-static {v7, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->finishOff(ILjava/lang/String;)V
 
-    move v3, v11
+    return v4
 
-    goto :goto_1
+    :cond_4
+    invoke-static {p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->finish(I)V
 
-    :cond_7
-    move v3, v0
+    invoke-virtual {p0, v7, p1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveWeaverSlot(IIJ)V
 
-    :goto_1
-    iget-object v5, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->aggregatedSecret:[B
+    iget-object v3, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mPasswordSlotManager:Lcom/android/server/locksettings/PasswordSlotManager;
 
-    iget-object v9, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->km:Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
+    invoke-virtual {v3, v7}, Lcom/android/server/locksettings/PasswordSlotManager;->markSlotInUse(I)V
 
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
+    :cond_5
+    iget-object v2, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->secdiscardableOnDisk:[B
 
-    const-wide/16 v6, 0x0
+    const-string/jumbo v1, "secdis"
 
-    move v8, p1
+    move-object v0, p0
 
-    move-wide v1, p2
+    move v5, p1
 
-    move-object/from16 v4, p4
+    move-wide v3, p2
 
-    invoke-virtual/range {v0 .. v9}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->createSyntheticPasswordBlobSpecific(JBLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;[BJILcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;)V
+    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
-    iget-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->km:Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
+    iget-object v1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
 
-    invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->destroy()V
+    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    move-wide v1, p2
+    iget v1, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->mType:I
 
-    goto :goto_3
+    const/4 v10, 0x1
 
-    :cond_8
-    iget v1, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->mType:I
+    if-eq v1, v10, :cond_6
 
-    if-eq v1, v11, :cond_9
+    move v3, v10
 
-    move v3, v11
+    goto :goto_1
 
-    goto :goto_2
+    :cond_6
+    const/4 v1, 0x2
 
-    :cond_9
-    move v3, v0
+    move v3, v1
 
-    :goto_2
-    iget-object v5, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->aggregatedSecret:[B
+    :goto_1
+    iget-object v5, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->aggregatedSecret:[B
 
     const-wide/16 v6, 0x0
 
@@ -2601,35 +2156,34 @@
 
     invoke-virtual/range {v0 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createSyntheticPasswordBlob(JBLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;[BJI)V
 
-    :goto_3
     invoke-virtual/range {p0 .. p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
 
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
+    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v0
+    move-result-object v3
 
-    invoke-virtual {p0, v0}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {v0, v3}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
 
-    move-result-object p0
+    move-result-object v0
 
-    check-cast p0, Landroid/util/ArrayMap;
+    check-cast v0, Landroid/util/ArrayMap;
 
     invoke-static {p2, p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    move-result-object v0
+    move-result-object v3
 
-    invoke-virtual {p0, v0}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
+    invoke-virtual {v0, v3}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;
 
-    iget-object p0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->mCallback:Lcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;
+    iget-object v0, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->mCallback:Lcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;
 
-    if-eqz p0, :cond_a
+    if-eqz v0, :cond_7
 
-    invoke-interface {p0, p2, p3, p1}, Lcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;->onEscrowTokenActivated(JI)V
+    invoke-interface {v0, p2, p3, p1}, Lcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;->onEscrowTokenActivated(JI)V
 
-    :cond_a
-    return v11
+    :cond_7
+    return v10
 .end method
 
 .method public decryptSpBlob(Ljava/lang/String;[B[B)[B
@@ -2915,51 +2469,14 @@
     invoke-static {v0}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;)V
 
     :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
-
-    invoke-virtual {v0, p1, p2, p3, p4}, Lcom/android/server/locksettings/LockSettingsStorage;->getSyntheticPasswordStateFileForUser(ILjava/lang/String;J)Ljava/io/File;
-
-    move-result-object p3
-
-    invoke-virtual {v0, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->deleteFile(Ljava/io/File;)V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSdpUser(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_1
-
-    const-string/jumbo p0, "pwd"
-
-    invoke-virtual {p0, p2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_1
-
-    sget-object p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mCredentialTypeCache:Landroid/util/SparseArray;
-
-    monitor-enter p0
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Landroid/util/SparseArray;->delete(I)V
-
-    monitor-exit p0
-
-    return-void
+    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    :catchall_0
-    move-exception p1
+    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/locksettings/LockSettingsStorage;->getSyntheticPasswordStateFileForUser(ILjava/lang/String;J)Ljava/io/File;
 
-    monitor-exit p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    move-result-object p1
 
-    throw p1
+    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->deleteFile(Ljava/io/File;)V
 
-    :cond_1
     return-void
 .end method
 
@@ -2984,40 +2501,42 @@
 
     invoke-static {v2, v1, v0}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    const-string/jumbo v0, "spblob"
+    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {p0, p1, v0, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    const-string/jumbo v1, "spblob"
 
-    move-result-object v1
+    invoke-virtual {v0, p1, v1, p2, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
-    invoke-static {v1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;
+    move-result-object v0
 
-    move-result-object v1
+    invoke-static {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;
 
-    invoke-virtual {p0, p1, v0, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyState(ILjava/lang/String;J)V
+    move-result-object v0
+
+    invoke-virtual {p0, p1, v1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyState(ILjava/lang/String;J)V
 
     invoke-static {p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getProtectorKeyAlias(J)Ljava/lang/String;
 
-    move-result-object v0
+    move-result-object v1
 
-    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyProtectorKey(Ljava/lang/String;)V
+    invoke-virtual {p0, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyProtectorKey(Ljava/lang/String;)V
 
-    const-string/jumbo v0, "secdis"
+    const-string/jumbo v1, "secdis"
 
-    invoke-virtual {p0, p1, v0, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyState(ILjava/lang/String;J)V
+    invoke-virtual {p0, p1, v1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyState(ILjava/lang/String;J)V
 
-    const-string/jumbo v0, "weaver"
+    const-string/jumbo v1, "weaver"
 
-    invoke-virtual {p0, p1, v0, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasState(ILjava/lang/String;J)Z
+    invoke-virtual {p0, p1, v1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasState(ILjava/lang/String;J)Z
 
-    move-result v0
+    move-result v1
 
-    if-eqz v0, :cond_0
+    if-eqz v1, :cond_0
 
     invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyWeaverSlot(IJ)V
 
     :cond_0
-    iget-byte v0, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
+    iget-byte v0, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
 
     const/4 v1, 0x2
 
@@ -3253,31 +2772,6 @@
     return-void
 .end method
 
-.method public final getCredentialType(IJ)I
-    .locals 1
-
-    const-string/jumbo v0, "pwd"
-
-    invoke-virtual {p0, p1, v0, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
-
-    move-result-object p0
-
-    if-nez p0, :cond_0
-
-    const/4 p0, -0x1
-
-    return p0
-
-    :cond_0
-    invoke-static {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
-
-    move-result-object p0
-
-    iget p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->credentialType:I
-
-    return p0
-.end method
-
 .method public final getFailureCount(Landroid/service/gatekeeper/IGateKeeperService;JI)I
     .locals 5
 
@@ -3308,9 +2802,11 @@
     return v3
 
     :cond_0
+    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+
     const-string/jumbo v1, "pwd"
 
-    invoke-virtual {p0, p4, v1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {p0, p4, v1, p2, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object p0
 
@@ -3406,7 +2902,7 @@
 .end method
 
 .method public final getFailureCount(Lcom/samsung/android/service/HermesService/IHermesService;JI)I
-    .locals 5
+    .locals 6
 
     const-string/jumbo v0, "getFailureCount = "
 
@@ -3435,9 +2931,11 @@
     return v4
 
     :cond_0
-    const-string/jumbo v1, "pwd"
+    iget-object v1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+
+    const-string/jumbo v5, "pwd"
 
-    invoke-virtual {p0, p4, v1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {v1, p4, v5, p2, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object v1
 
@@ -3638,15 +3136,17 @@
 .method public final getPasswordMetrics(IJLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Landroid/app/admin/PasswordMetrics;
     .locals 17
 
-    const-string/jumbo v0, "metrics"
+    move-object/from16 v0, p0
 
-    move-object/from16 v1, p0
+    iget-object v0, v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+
+    const-string/jumbo v1, "metrics"
 
     move/from16 v2, p1
 
     move-wide/from16 v3, p2
 
-    invoke-virtual {v1, v2, v0, v3, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {v0, v2, v1, v3, v4}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object v0
 
@@ -4725,17 +4225,6 @@
 .method public final hasEscrowData(I)Z
     .locals 3
 
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
-
-    invoke-static {v0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->-$$Nest$misSdpMdfppMode(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
     const-string/jumbo v0, "e0"
 
     const-wide/16 v1, 0x0
@@ -4744,7 +4233,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_1
+    if-eqz v0, :cond_0
 
     const-string/jumbo v0, "p1"
 
@@ -4752,14 +4241,13 @@
 
     move-result p0
 
-    if-eqz p0, :cond_1
+    if-eqz p0, :cond_0
 
-    :goto_0
     const/4 p0, 0x1
 
     return p0
 
-    :cond_1
+    :cond_0
     const/4 p0, 0x0
 
     return p0
@@ -4792,7 +4280,9 @@
 .method public final hasState(ILjava/lang/String;J)Z
     .locals 0
 
-    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+
+    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object p0
 
@@ -4815,47 +4305,30 @@
     return p0
 .end method
 
-.method public final isWeaverSupported()Z
-    .locals 0
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
 .method public final loadEscrowData(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
     .locals 4
 
-    const-string/jumbo v0, "e0"
+    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-wide/16 v1, 0x0
+    const-wide/16 v0, 0x0
 
-    invoke-virtual {p0, p1, v0, v1, v2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    const-string/jumbo v2, "e0"
 
-    move-result-object v0
+    invoke-virtual {p0, p1, v2, v0, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
+
+    move-result-object v2
 
     const-string/jumbo v3, "p1"
 
-    invoke-virtual {p0, p1, v3, v1, v2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {p0, p1, v3, v0, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object p0
 
-    iput-object v0, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEncryptedEscrowSplit0:[B
+    iput-object v2, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEncryptedEscrowSplit0:[B
 
     iput-object p0, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEscrowSplit1:[B
 
-    if-eqz v0, :cond_0
+    if-eqz v2, :cond_0
 
     if-eqz p0, :cond_0
 
@@ -4866,52 +4339,17 @@
     :cond_0
     const/4 p0, 0x0
 
-    return p0
-.end method
-
-.method public final loadState(ILjava/lang/String;J)[B
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
-
-    invoke-virtual {v0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSdpUser(I)Z
-
-    move-result v1
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
-
-    if-eqz v1, :cond_0
-
-    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/locksettings/LockSettingsStorage;->getSyntheticPasswordStateFileForUser(ILjava/lang/String;J)Ljava/io/File;
-
-    move-result-object p3
-
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->readFile(Ljava/io/File;)[B
-
-    move-result-object p0
-
-    invoke-static {v0, p2, p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->-$$Nest$mpostReadOrWriteState(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;Ljava/lang/String;[BI)V
-
-    return-object p0
-
-    :cond_0
-    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/locksettings/LockSettingsStorage;->getSyntheticPasswordStateFileForUser(ILjava/lang/String;J)Ljava/io/File;
-
-    move-result-object p1
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->readFile(Ljava/io/File;)[B
-
-    move-result-object p0
-
-    return-object p0
+    return p0
 .end method
 
 .method public final loadWeaverSlot(IJ)I
     .locals 3
 
+    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+
     const-string/jumbo v0, "weaver"
 
-    invoke-virtual {p0, p1, v0, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {p0, p1, v0, p2, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object p0
 
@@ -4979,45 +4417,61 @@
 .end method
 
 .method public final migrateFrpPasswordLocked(JLandroid/content/pm/UserInfo;I)V
-    .locals 3
+    .locals 5
 
     iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
     invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsStorage;->getPersistentDataBlockManager()Lcom/android/server/pdb/PersistentDataBlockManagerInternal;
 
-    move-result-object v0
+    move-result-object v1
 
-    if-eqz v0, :cond_1
+    if-eqz v1, :cond_2
 
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mContext:Landroid/content/Context;
+    iget-object v1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mContext:Landroid/content/Context;
 
-    invoke-static {v0, p3}, Lcom/android/internal/widget/LockPatternUtils;->userOwnsFrpCredential(Landroid/content/Context;Landroid/content/pm/UserInfo;)Z
+    invoke-static {v1, p3}, Lcom/android/internal/widget/LockPatternUtils;->userOwnsFrpCredential(Landroid/content/Context;Landroid/content/pm/UserInfo;)Z
 
-    move-result v0
+    move-result v1
 
-    if-eqz v0, :cond_1
+    if-eqz v1, :cond_2
 
-    iget v0, p3, Landroid/content/pm/UserInfo;->id:I
+    iget v1, p3, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-virtual {p0, v0, p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getCredentialType(IJ)I
+    iget-object v2, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    move-result v0
+    const-string/jumbo v3, "pwd"
 
-    const/4 v1, -0x1
+    invoke-virtual {v2, v1, v3, p1, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
-    if-eq v0, v1, :cond_1
+    move-result-object v1
 
-    const-string/jumbo v0, "SyntheticPasswordManager"
+    const/4 v2, -0x1
 
-    const-string/jumbo v2, "Migrating FRP credential to persistent data block"
+    if-nez v1, :cond_0
 
-    invoke-static {v0, v2}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+    move v1, v2
 
-    const-string/jumbo v0, "pwd"
+    goto :goto_0
+
+    :cond_0
+    invoke-static {v1}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
+
+    move-result-object v1
+
+    iget v1, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->credentialType:I
+
+    :goto_0
+    if-eq v1, v2, :cond_2
+
+    const-string/jumbo v1, "SyntheticPasswordManager"
+
+    const-string/jumbo v4, "Migrating FRP credential to persistent data block"
 
-    iget v2, p3, Landroid/content/pm/UserInfo;->id:I
+    invoke-static {v1, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {p0, v2, v0, p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    iget v1, p3, Landroid/content/pm/UserInfo;->id:I
+
+    invoke-virtual {v0, v1, v3, p1, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object v0
 
@@ -5025,13 +4479,13 @@
 
     move-result-object v0
 
-    iget v2, p3, Landroid/content/pm/UserInfo;->id:I
+    iget v1, p3, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-virtual {p0, v2, p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadWeaverSlot(IJ)I
+    invoke-virtual {p0, v1, p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadWeaverSlot(IJ)I
 
     move-result p1
 
-    if-eq p1, v1, :cond_0
+    if-eq p1, v2, :cond_1
 
     iget p2, p3, Landroid/content/pm/UserInfo;->id:I
 
@@ -5039,12 +4493,12 @@
 
     return-void
 
-    :cond_0
+    :cond_1
     iget p1, p3, Landroid/content/pm/UserInfo;->id:I
 
     invoke-virtual {p0, v0, p4, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->synchronizeGatekeeperFrpPassword(Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;II)V
 
-    :cond_1
+    :cond_2
     return-void
 .end method
 
@@ -5128,11 +4582,13 @@
 .end method
 
 .method public final migratePwdDataForKnox(IJ)V
-    .locals 10
+    .locals 9
 
-    const-string/jumbo v0, "pwd"
+    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {p0, p1, v0, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    const-string/jumbo v1, "pwd"
+
+    invoke-virtual {v0, p1, v1, p2, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object v0
 
@@ -5219,351 +4675,177 @@
 
     move-result v0
 
-    const-string/jumbo v3, "SyntheticPasswordManager"
+    const-string/jumbo v2, "SyntheticPasswordManager"
 
     if-ltz v0, :cond_2
 
-    const/4 v5, 0x2
+    const/4 v3, 0x2
 
-    if-gt v0, v5, :cond_2
+    if-gt v0, v3, :cond_2
 
-    const/4 v2, -0x1
+    const/4 v3, -0x1
 
-    iput v2, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->pinLength:I
+    iput v3, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->pinLength:I
 
     iput v0, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
 
     new-instance v0, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v2, "Migration case - secureMode : "
+    const-string/jumbo v3, "Migration case - secureMode : "
 
-    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget v2, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
+    iget v3, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
 
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object v0
 
-    invoke-static {v3, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v2, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    goto :goto_2
+    goto :goto_1
 
     :cond_2
     iput v0, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->pinLength:I
 
-    invoke-virtual {v2}, Ljava/nio/ByteBuffer;->remaining()I
-
-    move-result v0
-
-    const/4 v5, 0x4
-
-    if-lt v0, v5, :cond_3
-
-    invoke-virtual {v2}, Ljava/nio/ByteBuffer;->getInt()I
-
-    move-result v0
-
-    iput v0, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
-
-    goto :goto_1
-
-    :cond_3
     iput v4, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
 
-    :goto_1
     new-instance v0, Ljava/lang/StringBuilder;
 
-    const-string v2, "Abnormal migration case - pinLength : "
+    const-string v3, "Abnormal migration case - pinLength : "
 
-    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget v2, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->pinLength:I
+    iget v3, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->pinLength:I
 
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v2, ", secureMode : "
+    const-string v3, ", secureMode : "
 
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget v2, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
+    iget v3, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
 
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object v0
 
-    invoke-static {v3, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v2, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    :goto_2
-    const-string/jumbo v8, "pwd"
+    :goto_1
+    const-string/jumbo v4, "pwd"
 
     invoke-virtual {v1}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->toBytes()[B
 
-    move-result-object v9
+    move-result-object v5
 
-    move-object v4, p0
+    move-object v3, p0
 
-    move v5, p1
+    move v8, p1
 
     move-wide v6, p2
 
-    invoke-virtual/range {v4 .. v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
-
-    invoke-virtual {v4, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
-
-    const-string/jumbo p0, "Migrated password data for user "
-
-    invoke-static {v5, p0, v3}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    return-void
-.end method
-
-.method public final newSyntheticPassword(I)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-    .locals 10
-
-    const/4 v3, 0x1
-
-    const/4 v4, 0x0
-
-    const-string/jumbo v0, "handle"
-
-    const-wide/16 v5, 0x0
-
-    invoke-virtual {p0, p1, v0, v5, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyState(ILjava/lang/String;J)V
-
-    invoke-static {p1, v5, v6, v0}, Lcom/samsung/android/lock/SPBnRManager;->deleteBackup(IJLjava/lang/String;)Z
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "newSyntheticPassword "
-
-    invoke-direct {v0, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-instance v5, Ljava/lang/Throwable;
-
-    invoke-direct {v5}, Ljava/lang/Throwable;-><init>()V
-
-    const-string/jumbo v6, "SyntheticPasswordManager"
-
-    invoke-static {v6, v0, v5}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
-
-    iget-object v5, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->spManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->isWeaverSupported()Z
-
-    move-result v5
-
-    const/4 v7, 0x0
-
-    if-nez v5, :cond_0
-
-    const-string/jumbo v5, "newSyntheticPassword: weaver not supported"
-
-    invoke-static {v7, v5}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSpecificProcessRequired(I)Z
-
-    move-result v5
-
-    if-eqz v5, :cond_0
-
-    invoke-virtual {v0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isDualDarUser(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    const/4 v0, 0x2
-
-    goto :goto_0
-
-    :cond_0
-    move v0, v4
+    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
-    :goto_0
-    new-instance v5, Ljava/lang/StringBuilder;
+    invoke-virtual {v3, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
 
-    const-string/jumbo v8, "newSyntheticPassword: sp for user "
+    new-instance p0, Ljava/lang/StringBuilder;
 
-    invoke-direct {v5, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    const-string/jumbo p1, "Migrated password data for user "
 
-    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-direct {p0, p1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    const-string v8, " Secure Mode : "
+    invoke-virtual {p0, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v5, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    move-result-object p0
 
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-static {v2, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    move-result-object v5
+    return-void
+.end method
 
-    invoke-static {v7, v5}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+.method public final newSyntheticPassword(I)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    .locals 7
 
-    invoke-static {p1, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->cacheSecureMode(II)V
+    const-string/jumbo v0, "handle"
 
-    new-instance v5, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;
+    const-wide/16 v1, 0x0
 
-    invoke-direct {v5}, Ljava/lang/Object;-><init>()V
+    invoke-virtual {p0, p1, v0, v1, v2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyState(ILjava/lang/String;J)V
 
-    iput v0, v5, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;->secureMode:I
+    invoke-static {p1, v1, v2, v0}, Lcom/samsung/android/lock/SPBnRManager;->deleteBackup(IJLjava/lang/String;)Z
 
-    new-instance v8, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    new-instance v6, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
     const/4 v0, 0x3
 
-    invoke-direct {v8, v0, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;-><init>(BLcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationSdpToken;)V
-
-    invoke-virtual {v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->isSdpMdfppMode()Z
-
-    move-result v5
-
-    const/16 v9, 0x20
-
-    if-eqz v5, :cond_2
-
-    const-string/jumbo v0, "createSdpMdfppMode : isSdpMdfppMode Enabled"
-
-    invoke-static {v6, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :try_start_0
-    invoke-static {v9}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->nativeRBG(I)[B
-
-    move-result-object v7
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception v0
-
-    invoke-virtual {v0}, Ljava/lang/Throwable;->printStackTrace()V
-
-    :goto_1
-    if-nez v7, :cond_1
-
-    const-string/jumbo v0, "SyntheticPasswordManager.SDP"
-
-    const-string/jumbo v5, "Unexpected failure while generate random sp"
-
-    invoke-static {v0, v5}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {v9}, Lcom/android/server/locksettings/SecureRandomUtils;->randomBytes(I)[B
-
-    move-result-object v7
-
-    :cond_1
-    invoke-static {v7}, Llibcore/util/HexEncoding;->encode([B)[C
-
-    move-result-object v0
-
-    invoke-static {v0}, Ljava/lang/String;->valueOf([C)Ljava/lang/String;
-
-    move-result-object v0
-
-    sget-object v5, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;
-
-    invoke-virtual {v0, v5}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B
-
-    move-result-object v0
-
-    iput-object v0, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
-
-    new-array v0, v3, [B
-
-    aput-byte v4, v0, v4
+    invoke-direct {v6, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;-><init>(B)V
 
-    new-array v3, v3, [B
-
-    aput-byte v4, v3, v4
-
-    iput-object v0, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEncryptedEscrowSplit0:[B
-
-    iput-object v3, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEscrowSplit1:[B
-
-    invoke-static {v7}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    goto :goto_2
+    const/16 v0, 0x20
 
-    :cond_2
-    new-instance v8, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    invoke-static {v0}, Lcom/android/server/locksettings/SecureRandomUtils;->randomBytes(I)[B
 
-    invoke-direct {v8, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;-><init>(B)V
+    move-result-object v1
 
-    invoke-static {v9}, Lcom/android/server/locksettings/SecureRandomUtils;->randomBytes(I)[B
+    invoke-static {v0}, Lcom/android/server/locksettings/SecureRandomUtils;->randomBytes(I)[B
 
     move-result-object v0
 
-    invoke-static {v9}, Lcom/android/server/locksettings/SecureRandomUtils;->randomBytes(I)[B
-
-    move-result-object v3
-
-    filled-new-array {v0, v3}, [[B
-
-    move-result-object v4
+    filled-new-array {v1, v0}, [[B
 
-    sget-object v5, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_SPLIT:[B
+    move-result-object v2
 
-    invoke-static {v5, v4}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->personalizedHash([B[[B)[B
+    sget-object v4, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_SPLIT:[B
 
-    move-result-object v4
+    invoke-static {v4, v2}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->personalizedHash([B[[B)[B
 
-    invoke-static {v4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->bytesToHex([B)[B
+    move-result-object v2
 
-    move-result-object v4
+    invoke-static {v2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->bytesToHex([B)[B
 
-    iput-object v4, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
+    move-result-object v2
 
-    sget-object v5, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_E0:[B
+    iput-object v2, v6, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
 
-    invoke-static {v4, v5, v0}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->encrypt([B[B[B)[B
+    sget-object v4, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_E0:[B
 
-    move-result-object v0
+    invoke-static {v2, v4, v1}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->encrypt([B[B[B)[B
 
-    iput-object v0, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEncryptedEscrowSplit0:[B
+    move-result-object v2
 
-    iput-object v3, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEscrowSplit1:[B
+    iput-object v2, v6, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEncryptedEscrowSplit0:[B
 
-    :goto_2
-    iget-object v6, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEncryptedEscrowSplit0:[B
+    iput-object v0, v6, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEscrowSplit1:[B
 
     const-wide/16 v3, 0x0
 
-    const-string/jumbo v5, "e0"
+    const-string/jumbo v1, "e0"
 
-    move-object v1, p0
+    move-object v0, p0
 
-    move v2, p1
+    move v5, p1
 
-    invoke-virtual/range {v1 .. v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
-    iget-object v6, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEscrowSplit1:[B
+    iget-object v2, v6, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEscrowSplit1:[B
 
     const-wide/16 v3, 0x0
 
-    const-string/jumbo v5, "p1"
+    const-string/jumbo v1, "p1"
 
-    move-object v1, p0
+    move-object v0, p0
 
-    move v2, p1
+    move v5, p1
 
-    invoke-virtual/range {v1 .. v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
-    return-object v8
+    return-object v6
 .end method
 
 .method public final removeUser(Landroid/service/gatekeeper/IGateKeeperService;I)V
@@ -5610,66 +4892,26 @@
 
     goto :goto_0
 
-    :cond_0
-    :try_start_0
-    invoke-static {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
-
-    move-result p0
-
-    invoke-interface {p1, p0}, Landroid/service/gatekeeper/IGateKeeperService;->clearSecureUserId(I)V
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_1
-
-    :catch_0
-    const-string/jumbo p0, "SyntheticPasswordManager"
-
-    const-string p1, "Failed to clear SID from gatekeeper"
-
-    invoke-static {p0, p1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_1
-    sget-object p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mSecureModeCache:Landroid/util/SparseArray;
-
-    monitor-enter p0
-
-    :try_start_1
-    invoke-virtual {p0, p2}, Landroid/util/SparseArray;->delete(I)V
-
-    monitor-exit p0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    sget-object p1, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mCredentialTypeCache:Landroid/util/SparseArray;
-
-    monitor-enter p1
+    :cond_0
+    :try_start_0
+    invoke-static {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
 
-    :try_start_2
-    invoke-virtual {p1, p2}, Landroid/util/SparseArray;->delete(I)V
+    move-result p0
 
-    monitor-exit p1
+    invoke-interface {p1, p0}, Landroid/service/gatekeeper/IGateKeeperService;->clearSecureUserId(I)V
+    :try_end_0
+    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
 
     return-void
 
-    :catchall_0
-    move-exception p0
-
-    monitor-exit p1
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
+    :catch_0
+    const-string/jumbo p0, "SyntheticPasswordManager"
 
-    :catchall_1
-    move-exception p1
+    const-string p1, "Failed to clear SID from gatekeeper"
 
-    :try_start_3
-    monitor-exit p0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
+    invoke-static {p0, p1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    throw p1
+    return-void
 .end method
 
 .method public final savePasswordMetrics(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;JI)V
@@ -5747,37 +4989,37 @@
 
     invoke-static {p2, v0, p1}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->encrypt([B[B[B)[B
 
-    move-result-object v6
+    move-result-object v3
 
-    const-string/jumbo v5, "metrics"
+    const-string/jumbo v2, "metrics"
 
     move-object v1, p0
 
-    move-wide v3, p3
+    move-wide v4, p3
 
-    move v2, p5
+    move v6, p5
 
-    invoke-virtual/range {v1 .. v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    invoke-virtual/range {v1 .. v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
     return-void
 .end method
 
-.method public final saveState(IJLjava/lang/String;[B)V
+.method public final saveState(Ljava/lang/String;[BJI)V
     .locals 4
 
     const-string/jumbo v0, "spblob"
 
-    invoke-virtual {v0, p4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v0
 
     if-eqz v0, :cond_0
 
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {p5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v0
 
-    invoke-static {p2, p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    invoke-static {p3, p4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
     move-result-object v1
 
@@ -5802,40 +5044,29 @@
     invoke-static {v0}, Lcom/samsung/android/lock/LsLog;->enroll(Ljava/lang/String;)V
 
     :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {v0, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->getSyntheticPasswordDirectoryForUser(I)Ljava/io/File;
+    invoke-virtual {p0, p5}, Lcom/android/server/locksettings/LockSettingsStorage;->getSyntheticPasswordDirectoryForUser(I)Ljava/io/File;
 
-    move-result-object v1
+    move-result-object v0
 
-    invoke-virtual {v1}, Ljava/io/File;->exists()Z
+    invoke-virtual {v0}, Ljava/io/File;->exists()Z
 
-    move-result v2
+    move-result v1
 
-    if-nez v2, :cond_1
+    if-nez v1, :cond_1
 
-    invoke-virtual {v1}, Ljava/io/File;->mkdir()Z
+    invoke-virtual {v0}, Ljava/io/File;->mkdir()Z
 
     :cond_1
-    invoke-virtual {v0, p1, p4, p2, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->getSyntheticPasswordStateFileForUser(ILjava/lang/String;J)Ljava/io/File;
+    invoke-virtual {p0, p5, p1, p3, p4}, Lcom/android/server/locksettings/LockSettingsStorage;->getSyntheticPasswordStateFileForUser(ILjava/lang/String;J)Ljava/io/File;
 
-    move-result-object p2
+    move-result-object p1
 
     const/4 p3, 0x0
 
-    invoke-virtual {v0, p2, p5, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->writeFile(Ljava/io/File;[BZ)V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSdpUser(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_2
+    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->writeFile(Ljava/io/File;[BZ)V
 
-    invoke-static {p0, p4, p5, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->-$$Nest$mpostReadOrWriteState(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;Ljava/lang/String;[BI)V
-
-    :cond_2
     return-void
 .end method
 
@@ -5854,19 +5085,19 @@
 
     invoke-virtual {v0, p1}, Ljava/nio/ByteBuffer;->putInt(I)Ljava/nio/ByteBuffer;
 
-    const-string/jumbo v6, "weaver"
+    const-string/jumbo v3, "weaver"
 
     invoke-virtual {v0}, Ljava/nio/ByteBuffer;->array()[B
 
-    move-result-object v7
+    move-result-object v4
 
     move-object v2, p0
 
-    move v3, p2
+    move v7, p2
 
-    move-wide v4, p3
+    move-wide v5, p3
 
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
     return-void
 .end method
@@ -5999,44 +5230,7 @@
     goto :goto_0
 
     :goto_2
-    const/16 v0, 0x20
-
-    if-eqz p2, :cond_2
-
-    iget v1, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->secureMode:I
-
-    if-lez v1, :cond_2
-
-    iget-object p1, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->salt:[B
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const/16 p0, 0x4000
-
-    :try_start_0
-    invoke-static {v2, p1, p0, v0}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->nativePBKDF2([B[BII)[B
-
-    move-result-object p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    return-object p0
-
-    :catchall_0
-    move-exception v0
-
-    move-object p0, v0
-
-    invoke-virtual {p0}, Ljava/lang/Throwable;->printStackTrace()V
-
-    const/4 p0, 0x0
-
-    return-object p0
-
-    :cond_2
-    if-nez p2, :cond_3
+    if-nez p2, :cond_2
 
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
@@ -6044,13 +5238,15 @@
 
     invoke-static {p0}, Lcom/android/internal/util/Preconditions;->checkArgument(Z)V
 
-    invoke-static {v2, v0}, Ljava/util/Arrays;->copyOf([BI)[B
+    const/16 p0, 0x20
+
+    invoke-static {v2, p0}, Ljava/util/Arrays;->copyOf([BI)[B
 
     move-result-object p0
 
     return-object p0
 
-    :cond_3
+    :cond_2
     iget-object v3, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->salt:[B
 
     iget-byte p1, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->scryptLogN:B
@@ -6270,25 +5466,25 @@
 
     move-object/from16 v1, p0
 
-    move-wide/from16 v2, p2
+    move-wide/from16 v8, p2
 
-    move-object/from16 v9, p4
+    move-object/from16 v10, p4
 
-    move/from16 v6, p5
+    move/from16 v11, p5
 
-    new-instance v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    new-instance v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
-    invoke-direct {v10}, Ljava/lang/Object;-><init>()V
+    invoke-direct {v12}, Ljava/lang/Object;-><init>()V
 
-    const-wide/16 v7, 0x0
+    const-wide/16 v13, 0x0
 
-    cmp-long v0, v2, v7
+    cmp-long v0, v8, v13
 
-    const-string/jumbo v11, "SyntheticPasswordManager"
+    const-string/jumbo v15, "SyntheticPasswordManager"
 
     if-nez v0, :cond_0
 
-    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v0
 
@@ -6298,11 +5494,11 @@
 
     const-string/jumbo v1, "Synthetic password not found for user %d"
 
-    invoke-static {v11, v1, v0}, Lcom/android/server/utils/Slogf;->wtf(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v15, v1, v0}, Lcom/android/server/utils/Slogf;->wtf(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iput-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iput-object v0, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
     new-instance v0, Ljava/lang/StringBuilder;
 
@@ -6310,7 +5506,7 @@
 
     invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
@@ -6318,16 +5514,20 @@
 
     invoke-static {v0}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
 
-    return-object v10
+    return-object v12
 
     :cond_0
-    const-string/jumbo v0, "pwd"
+    iget-object v0, v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+
+    const-string/jumbo v2, "pwd"
 
-    invoke-virtual {v1, v6, v0, v2, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {v0, v11, v2, v8, v9}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object v0
 
-    const/4 v12, -0x1
+    const/4 v2, 0x0
+
+    const/4 v3, -0x1
 
     if-eqz v0, :cond_1
 
@@ -6335,53 +5535,57 @@
 
     move-result-object v0
 
-    iget v5, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->credentialType:I
+    iget v4, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->credentialType:I
+
+    move/from16 v21, v4
 
-    move-object v13, v0
+    move-object v4, v0
+
+    move/from16 v0, v21
 
     goto :goto_0
 
     :cond_1
-    move v5, v12
+    move-object v4, v2
 
-    const/4 v13, 0x0
+    move v0, v3
 
     :goto_0
-    invoke-virtual {v9, v5}, Lcom/android/internal/widget/LockscreenCredential;->checkAgainstStoredType(I)Z
+    invoke-virtual {v10, v0}, Lcom/android/internal/widget/LockscreenCredential;->checkAgainstStoredType(I)Z
 
-    move-result v0
+    move-result v5
 
-    if-nez v0, :cond_2
+    if-nez v5, :cond_2
 
-    invoke-static {v5}, Lcom/android/internal/widget/LockPatternUtils;->credentialTypeToString(I)Ljava/lang/String;
+    invoke-static {v0}, Lcom/android/internal/widget/LockPatternUtils;->credentialTypeToString(I)Ljava/lang/String;
 
-    move-result-object v0
+    move-result-object v1
 
-    invoke-virtual {v9}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    invoke-virtual {v10}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
-    move-result v1
+    move-result v2
 
-    invoke-static {v1}, Lcom/android/internal/widget/LockPatternUtils;->credentialTypeToString(I)Ljava/lang/String;
+    invoke-static {v2}, Lcom/android/internal/widget/LockPatternUtils;->credentialTypeToString(I)Ljava/lang/String;
 
-    move-result-object v1
+    move-result-object v2
 
-    filled-new-array {v0, v1}, [Ljava/lang/Object;
+    filled-new-array {v1, v2}, [Ljava/lang/Object;
 
-    move-result-object v0
+    move-result-object v1
 
-    const-string v1, "Credential type mismatch: stored type is %s but provided type is %s"
+    const-string v2, "Credential type mismatch: stored type is %s but provided type is %s"
 
-    invoke-static {v11, v1, v0}, Lcom/android/server/utils/Slogf;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v15, v2, v1}, Lcom/android/server/utils/Slogf;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iput-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iput-object v1, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    invoke-static {v5}, Lcom/android/internal/widget/LockPatternUtils;->credentialTypeToString(I)Ljava/lang/String;
+    invoke-static {v0}, Lcom/android/internal/widget/LockPatternUtils;->credentialTypeToString(I)Ljava/lang/String;
 
     move-result-object v0
 
-    invoke-virtual {v9}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    invoke-virtual {v10}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
     move-result v1
 
@@ -6409,145 +5613,107 @@
 
     invoke-static {v0}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
 
-    return-object v10
+    return-object v12
 
     :cond_2
-    invoke-virtual {v1, v9, v13}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchLskf(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;)[B
+    invoke-virtual {v1, v10, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchLskf(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;)[B
 
-    move-result-object v14
+    move-result-object v5
 
     iget-object v0, v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
 
-    invoke-static {v0, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->-$$Nest$misSdpMdfppMode(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;I)Z
-
-    move-result v15
-
-    new-instance v5, Ljava/lang/StringBuilder;
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string/jumbo v7, "unlockLskfBasedProtector isSdpMdfppMode ? "
+    const-string/jumbo v0, "unlockLskfBasedProtector isSdpMdfppMode ? false"
 
-    invoke-direct {v5, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-static {v15, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    invoke-virtual {v5, v15}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-static {v11}, Lcom/samsung/android/lock/LsLog;->verifyBegin(I)V
 
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v1, v11, v8, v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadWeaverSlot(IJ)I
 
-    move-result-object v5
+    move-result v6
 
-    invoke-static {v11, v5}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    const-wide/16 v13, -0x1
 
-    if-eqz v15, :cond_3
+    const/4 v7, 0x1
 
-    new-instance v5, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
+    if-eq v6, v3, :cond_6
 
-    invoke-virtual {v0, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->getSecureMode(I)I
+    invoke-virtual {v10}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
     move-result v0
 
-    invoke-direct {v5, v0, v14}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;-><init>(I[B)V
-
-    :goto_1
-    move-object v8, v5
+    if-eqz v4, :cond_3
 
-    goto :goto_2
+    iget-object v2, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->salt:[B
 
     :cond_3
-    sget-object v5, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->NULL:Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
-
-    goto :goto_1
+    invoke-static {v0, v6, v8, v9, v2}, Lcom/samsung/android/lock/LsLog;->verifyUpdate(IIJ[B)V
 
-    :goto_2
-    invoke-static {v6}, Lcom/samsung/android/lock/LsLog;->verifyBegin(I)V
-
-    invoke-virtual {v1, v6, v2, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadWeaverSlot(IJ)I
-
-    move-result v7
-
-    const/4 v4, 0x1
-
-    if-eq v7, v12, :cond_7
-
-    invoke-virtual {v9}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v5
-
-    if-eqz v13, :cond_4
-
-    iget-object v0, v13, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->salt:[B
-
-    goto :goto_3
-
-    :cond_4
-    const/4 v0, 0x0
-
-    :goto_3
-    invoke-static {v5, v7, v2, v3, v0}, Lcom/samsung/android/lock/LsLog;->verifyUpdate(IIJ[B)V
-
-    iput-boolean v4, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->usedWeaver:Z
+    iput-boolean v7, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->usedWeaver:Z
 
     invoke-virtual {v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
 
     move-result-object v0
 
-    if-nez v0, :cond_5
+    if-nez v0, :cond_4
 
     const-string/jumbo v0, "Protector uses Weaver, but Weaver is unavailable"
 
-    invoke-static {v11, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v15, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
     sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iput-object v1, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iput-object v1, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    const-wide/16 v1, -0x1
+    invoke-static {v7, v13, v14, v0}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
 
-    invoke-static {v4, v1, v2, v0}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
+    return-object v12
 
-    return-object v10
-
-    :cond_5
-    invoke-static {v4, v7, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->begin(III)V
+    :cond_4
+    invoke-static {v7, v6, v11}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->begin(III)V
 
-    invoke-virtual {v1, v14}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchedLskfToWeaverKey([B)[B
+    invoke-virtual {v1, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchedLskfToWeaverKey([B)[B
 
-    move-result-object v4
+    move-result-object v2
 
-    invoke-virtual {v1, v0, v7, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->weaverVerify(Landroid/hardware/weaver/IWeaver;I[B)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {v1, v0, v6, v2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->weaverVerify(Landroid/hardware/weaver/IWeaver;I[B)Lcom/android/internal/widget/VerifyCredentialResponse;
 
     move-result-object v0
 
-    iput-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iput-object v0, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    invoke-static {v6}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->finish(I)V
+    invoke-static {v11}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->finish(I)V
 
-    iget-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iget-object v0, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
     invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
     move-result v0
 
-    if-eqz v0, :cond_6
+    if-eqz v0, :cond_5
 
-    goto/16 :goto_13
+    goto/16 :goto_c
 
-    :cond_6
-    iget-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    :cond_5
+    iget-object v0, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
     invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->getGatekeeperHAT()[B
 
     move-result-object v0
 
-    sget-object v4, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_WEAVER_PASSWORD:[B
+    sget-object v2, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_WEAVER_PASSWORD:[B
 
     filled-new-array {v0}, [[B
 
     move-result-object v0
 
-    invoke-static {v4, v0}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->personalizedHash([B[[B)[B
+    invoke-static {v2, v0}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->personalizedHash([B[[B)[B
 
     move-result-object v0
 
-    filled-new-array {v14, v0}, [[B
+    filled-new-array {v5, v0}, [[B
 
     move-result-object v0
 
@@ -6555,263 +5721,255 @@
 
     move-result-object v0
 
-    move-object v4, v0
-
-    const-wide/16 v5, 0x0
-
-    goto/16 :goto_e
-
-    :cond_7
-    invoke-virtual {v9}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    move-wide v4, v8
 
-    move-result v5
+    const/4 v13, 0x0
 
-    if-eqz v13, :cond_8
+    move v8, v6
 
-    iget-object v0, v13, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->salt:[B
+    const-wide/16 v6, 0x0
 
-    goto :goto_4
+    :goto_1
+    move-object v2, v0
 
-    :cond_8
-    const/4 v0, 0x0
+    goto/16 :goto_8
 
-    :goto_4
-    invoke-static {v5, v12, v2, v3, v0}, Lcom/samsung/android/lock/LsLog;->verifyUpdate(IIJ[B)V
+    :cond_6
+    invoke-virtual {v10}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
-    if-eqz v13, :cond_9
+    move-result v0
 
-    iget-object v0, v13, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
+    if-eqz v4, :cond_7
 
-    if-nez v0, :cond_a
+    iget-object v7, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->salt:[B
 
-    :cond_9
-    const-wide/16 v12, -0x1
+    goto :goto_2
 
-    goto/16 :goto_b
+    :cond_7
+    move-object v7, v2
 
-    :cond_a
-    if-eqz v15, :cond_c
+    :goto_2
+    invoke-static {v0, v3, v8, v9, v7}, Lcom/samsung/android/lock/LsLog;->verifyUpdate(IIJ[B)V
 
-    iget-object v0, v8, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->gkInput:[B
+    if-eqz v4, :cond_8
 
-    if-nez v0, :cond_b
+    iget-object v0, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
 
-    iget-object v0, v8, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->pivot:[B
+    if-nez v0, :cond_9
 
-    iget v5, v8, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->secureMode:I
+    :cond_8
+    move-object/from16 v7, p1
 
-    const-string v12, "ForUserAuthentication"
+    move-object/from16 v19, v5
 
-    invoke-static {v5, v12, v0}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->personalize(ILjava/lang/String;[B)[B
+    move/from16 v20, v6
 
-    move-result-object v0
+    move-wide v4, v8
 
-    iput-object v0, v8, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->gkInput:[B
+    move v6, v11
 
-    :cond_b
-    iget-object v0, v8, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->gkInput:[B
+    move-wide v8, v13
 
-    :goto_5
-    move-object/from16 v21, v0
+    const/4 v2, 0x1
 
-    goto :goto_6
+    const/4 v13, 0x0
 
-    :cond_c
-    invoke-static {v14}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchedLskfToGkPassword([B)[B
+    goto/16 :goto_6
 
-    move-result-object v0
+    :cond_9
+    invoke-static {v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->stretchedLskfToGkPassword([B)[B
 
-    goto :goto_5
+    move-result-object v7
 
-    :goto_6
-    invoke-static {v6}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    invoke-static {v11}, Landroid/os/UserManager;->isVirtualUserId(I)Z
 
     move-result v0
 
-    if-eqz v0, :cond_d
+    if-eqz v0, :cond_a
 
     invoke-virtual {v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
 
     move-result-object v0
 
-    if-eqz v0, :cond_d
+    if-eqz v0, :cond_a
 
-    iget-object v0, v13, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
+    iget-object v0, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
 
-    if-nez v0, :cond_d
+    if-nez v0, :cond_a
 
     new-instance v0, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v5, "Virtual User "
+    const-string/jumbo v3, "Virtual User "
 
-    invoke-direct {v0, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v5, " may lost weaver slot."
+    const-string v3, " may lost weaver slot."
 
-    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object v0
 
-    const/4 v5, 0x0
-
-    invoke-static {v5, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v2, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;Ljava/lang/String;)V
 
-    const/4 v5, 0x0
+    const/4 v2, 0x0
 
-    new-array v0, v5, [B
+    new-array v0, v2, [B
 
-    iput-object v0, v13, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
+    iput-object v0, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
 
-    goto :goto_7
+    goto :goto_3
 
-    :cond_d
-    const/4 v5, 0x0
+    :cond_a
+    const/4 v2, 0x0
 
-    :goto_7
+    :goto_3
     :try_start_0
-    invoke-static {v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
+    invoke-static {v11}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
+
+    move-result v3
+
+    move/from16 v16, v6
+
+    iget-object v6, v4, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
+
+    move-object/from16 v17, v4
+
+    move-object/from16 v18, v5
 
-    move-result v17
+    const-wide/16 v4, 0x0
+
+    move v13, v2
 
-    iget-object v0, v13, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
+    move/from16 v20, v16
 
-    const-wide/16 v18, 0x0
+    move-object/from16 v14, v17
 
-    move-object/from16 v16, p1
+    move-object/from16 v19, v18
 
-    move-object/from16 v20, v0
+    move-object/from16 v2, p1
 
-    invoke-interface/range {v16 .. v21}, Landroid/service/gatekeeper/IGateKeeperService;->verifyChallenge(IJ[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
+    invoke-interface/range {v2 .. v7}, Landroid/service/gatekeeper/IGateKeeperService;->verifyChallenge(IJ[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
 
     move-result-object v0
     :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_2
+    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_1
+
+    move-object/from16 v21, v7
 
-    move-object/from16 v12, v21
+    move-object v7, v2
+
+    move-object/from16 v2, v21
 
     invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getResponseCode()I
 
-    move-result v5
+    move-result v3
 
-    if-nez v5, :cond_10
+    if-nez v3, :cond_d
 
-    sget-object v4, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
+    sget-object v3, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iput-object v4, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iput-object v3, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
     invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getShouldReEnroll()Z
 
     move-result v0
 
-    if-eqz v0, :cond_f
+    if-eqz v0, :cond_c
 
     :try_start_1
-    invoke-static {v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
+    invoke-static {v11}, Lcom/android/server/locksettings/SyntheticPasswordManager;->fakeUserId(I)I
 
     move-result v0
 
-    iget-object v4, v13, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
-    :try_end_1
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1
-
-    move-object/from16 v5, p1
+    iget-object v3, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
 
-    :try_start_2
-    invoke-interface {v5, v0, v4, v12, v12}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
+    invoke-interface {v7, v0, v3, v2, v2}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
 
     move-result-object v0
-    :try_end_2
-    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0
+    :try_end_1
+    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0
 
-    goto :goto_9
+    goto :goto_4
 
     :catch_0
     move-exception v0
 
-    goto :goto_8
-
-    :catch_1
-    move-exception v0
-
-    move-object/from16 v5, p1
-
-    :goto_8
-    const-string v4, "Fail to invoke gatekeeper.enroll"
+    const-string v2, "Fail to invoke gatekeeper.enroll"
 
-    invoke-static {v11, v4, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    invoke-static {v15, v2, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
     sget-object v0, Landroid/service/gatekeeper/GateKeeperResponse;->ERROR:Landroid/service/gatekeeper/GateKeeperResponse;
 
-    :goto_9
+    :goto_4
     invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getResponseCode()I
 
-    move-result v4
+    move-result v2
 
-    if-nez v4, :cond_e
+    if-nez v2, :cond_b
 
     invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getPayload()[B
 
     move-result-object v0
 
-    iput-object v0, v13, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
+    iput-object v0, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
 
-    invoke-virtual {v9}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    invoke-virtual {v10}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
     move-result v0
 
-    iput v0, v13, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->credentialType:I
-
-    const-string/jumbo v5, "pwd"
-
-    invoke-virtual {v13}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->toBytes()[B
-
-    move-result-object v6
+    iput v0, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->credentialType:I
 
-    move-wide v3, v2
+    const-string/jumbo v2, "pwd"
 
-    const/4 v12, 0x0
+    invoke-virtual {v14}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->toBytes()[B
 
-    move/from16 v2, p5
+    move-result-object v3
 
-    invoke-virtual/range {v1 .. v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
+    move-wide v4, v8
 
-    move v6, v2
+    move v6, v11
 
-    move-wide v2, v3
+    invoke-virtual/range {v1 .. v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
     invoke-virtual {v1, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
 
-    invoke-virtual {v1, v13, v12, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->synchronizeGatekeeperFrpPassword(Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;II)V
+    invoke-virtual {v1, v14, v13, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->synchronizeGatekeeperFrpPassword(Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;II)V
 
-    goto :goto_a
+    goto :goto_5
+
+    :cond_b
+    move-wide v4, v8
 
-    :cond_e
-    const/4 v12, 0x0
+    move v6, v11
 
     const-string v0, "Fail to re-enroll user password for user "
 
-    invoke-static {v6, v0, v11}, Lcom/android/server/BinaryTransparencyService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {v6, v0, v15}, Lcom/android/server/BinaryTransparencyService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
 
-    goto :goto_a
+    goto :goto_5
 
-    :cond_f
-    const/4 v12, 0x0
+    :cond_c
+    move-wide v4, v8
 
-    :goto_a
-    iget-object v0, v13, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
+    move v6, v11
+
+    :goto_5
+    iget-object v0, v14, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->passwordHandle:[B
 
     invoke-virtual {v1, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->sidFromPasswordHandle([B)J
 
-    move-result-wide v4
+    move-result-wide v2
 
-    goto :goto_c
+    goto :goto_7
 
-    :cond_10
-    if-ne v5, v4, :cond_11
+    :cond_d
+    const/4 v2, 0x1
+
+    if-ne v3, v2, :cond_e
 
     invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getTimeout()I
 
@@ -6821,9 +5979,7 @@
 
     move-result-object v1
 
-    iput-object v1, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    invoke-virtual {v8}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->destroy()V
+    iput-object v1, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
     invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getTimeout()I
 
@@ -6837,18 +5993,16 @@
 
     invoke-static {v3, v0, v1, v2}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
 
-    return-object v10
+    return-object v12
 
-    :cond_11
+    :cond_e
     sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iput-object v1, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    invoke-virtual {v8}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->destroy()V
+    iput-object v1, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
     const/4 v1, -0x1
 
-    if-ne v5, v1, :cond_12
+    if-ne v3, v1, :cond_f
 
     invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getTimeout()I
 
@@ -6862,9 +6016,9 @@
 
     invoke-static {v3, v0, v1, v2}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
 
-    return-object v10
+    return-object v12
 
-    :cond_12
+    :cond_f
     invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getTimeout()I
 
     move-result v0
@@ -6873,234 +6027,186 @@
 
     const-string/jumbo v2, "gatekeeper FAILED"
 
-    invoke-static {v5, v0, v1, v2}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
+    invoke-static {v3, v0, v1, v2}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
 
-    return-object v10
+    return-object v12
 
-    :catch_2
+    :catch_1
     move-exception v0
 
+    const/4 v2, 0x1
+
     const-string/jumbo v1, "gatekeeper verify failed"
 
-    invoke-static {v11, v1, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    invoke-static {v15, v1, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
     sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iput-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iput-object v0, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    const-wide/16 v2, -0x1
+    const-wide/16 v8, -0x1
 
-    invoke-static {v4, v2, v3, v1}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
+    invoke-static {v2, v8, v9, v1}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
 
-    return-object v10
+    return-object v12
 
-    :goto_b
-    invoke-virtual {v9}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    :goto_6
+    invoke-virtual {v10}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v0
 
-    if-nez v0, :cond_13
+    if-nez v0, :cond_10
 
     const-string/jumbo v0, "Missing Gatekeeper password handle for nonempty LSKF"
 
-    invoke-static {v11, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v15, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
     sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iput-object v1, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    invoke-static {v4, v12, v13, v0}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
-
-    return-object v10
+    iput-object v1, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    :cond_13
-    const-wide/16 v4, 0x0
-
-    :goto_c
-    if-eqz v15, :cond_14
-
-    invoke-virtual {v8}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->getAppId()[B
-
-    move-result-object v0
-
-    :goto_d
-    move-wide v5, v4
+    invoke-static {v2, v8, v9, v0}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
 
-    const/4 v12, -0x1
+    return-object v12
 
-    move-object v4, v0
+    :cond_10
+    const-wide/16 v2, 0x0
 
-    goto :goto_e
+    :goto_7
+    iget-object v0, v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    :cond_14
-    const-string/jumbo v0, "secdis"
+    const-string/jumbo v8, "secdis"
 
-    invoke-virtual {v1, v6, v0, v2, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {v0, v6, v8, v4, v5}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object v0
 
-    if-nez v0, :cond_15
+    if-nez v0, :cond_11
 
     const-string/jumbo v0, "secdiscardable file not found"
 
-    invoke-static {v11, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v15, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
     sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iput-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iput-object v0, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    return-object v10
+    return-object v12
+
+    :cond_11
+    move-object/from16 v8, v19
 
-    :cond_15
-    invoke-static {v14, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->transformUnderSecdiscardable([B[B)[B
+    invoke-static {v8, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->transformUnderSecdiscardable([B[B)[B
 
     move-result-object v0
 
-    goto :goto_d
+    move-wide v6, v2
 
-    :goto_e
-    if-eq v7, v12, :cond_16
+    move/from16 v8, v20
 
-    const-string/jumbo v0, "weaver Success!"
+    const/4 v3, -0x1
 
-    :goto_f
-    const/4 v7, 0x0
+    goto/16 :goto_1
+
+    :goto_8
+    if-eq v8, v3, :cond_12
+
+    const-string/jumbo v0, "weaver Success!"
 
-    const-wide/16 v12, 0x0
+    :goto_9
+    const-wide/16 v8, 0x0
 
-    goto :goto_10
+    goto :goto_a
 
-    :cond_16
+    :cond_12
     const-string/jumbo v0, "gatekeeper Success!"
 
-    goto :goto_f
+    goto :goto_9
 
-    :goto_10
-    invoke-static {v7, v12, v13, v0}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
+    :goto_a
+    invoke-static {v13, v8, v9, v0}, Lcom/samsung/android/lock/LsLog;->verifyFinish(IJLjava/lang/String;)V
 
-    if-eqz p6, :cond_17
+    if-eqz p6, :cond_13
 
-    :try_start_3
+    :try_start_2
     invoke-interface/range {p6 .. p6}, Lcom/android/internal/widget/ICheckCredentialProgressCallback;->onCredentialVerified()V
-    :try_end_3
-    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_3
+    :try_end_2
+    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_2
 
-    goto :goto_11
+    goto :goto_b
 
-    :catch_3
+    :catch_2
     move-exception v0
 
-    const-string/jumbo v7, "progressCallback throws exception"
-
-    invoke-static {v11, v7, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    :cond_17
-    :goto_11
-    if-eqz v15, :cond_18
-
-    iget-object v0, v1, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
-
-    const/4 v3, 0x0
-
-    move-wide/from16 v1, p2
-
-    move/from16 v7, p5
-
-    invoke-static/range {v0 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->-$$Nest$munwrapSyntheticPasswordBlobSpecific(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;JB[BJILcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    move-result-object v0
-
-    iput-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    invoke-virtual {v8}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->destroy()V
-
-    move-wide/from16 v7, p2
-
-    goto :goto_12
+    const-string/jumbo v3, "progressCallback throws exception"
 
-    :cond_18
-    const/4 v0, 0x0
+    invoke-static {v15, v3, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    move-object/from16 v1, p0
+    :cond_13
+    :goto_b
+    const/4 v4, 0x0
 
-    move-wide/from16 v2, p2
+    move-object/from16 v9, p1
 
     move/from16 v8, p5
 
-    move-wide v6, v5
-
-    move-object v5, v4
+    move-object v5, v2
 
-    move v4, v0
+    move-wide/from16 v2, p2
 
     invoke-virtual/range {v1 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unwrapSyntheticPasswordBlob(JB[BJI)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
     move-result-object v0
 
-    move-wide v7, v2
-
-    iput-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    :goto_12
-    iget-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    const-wide/16 v3, 0x0
-
-    invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
-
-    move-result-object v6
+    move-wide v4, v2
 
-    move-object/from16 v1, p0
-
-    move-object/from16 v5, p1
+    move v6, v8
 
-    move/from16 v2, p5
+    iput-object v0, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    invoke-virtual/range {v1 .. v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallengeInternal(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {v1, v9, v0, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallenge(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)Lcom/android/internal/widget/VerifyCredentialResponse;
 
     move-result-object v0
 
-    move v6, v2
-
-    iput-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iput-object v0, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iget-object v0, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    iget-object v0, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    if-eqz v0, :cond_19
+    if-eqz v0, :cond_14
 
-    invoke-virtual {v9}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    invoke-virtual {v10}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v0
 
-    if-nez v0, :cond_19
+    if-nez v0, :cond_14
 
-    invoke-virtual {v1, v7, v8, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasPasswordMetrics(JI)Z
+    invoke-virtual {v1, v4, v5, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasPasswordMetrics(JI)Z
 
     move-result v0
 
-    if-nez v0, :cond_19
-
-    iget-object v3, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    if-nez v0, :cond_14
 
-    move-wide v4, v7
+    iget-object v3, v12, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    move-object v2, v9
+    move-object v2, v10
 
     invoke-virtual/range {v1 .. v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->savePasswordMetrics(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;JI)V
 
     invoke-virtual {v1, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
 
-    :cond_19
-    :goto_13
-    return-object v10
+    :cond_14
+    :goto_c
+    return-object v12
 .end method
 
 .method public final unlockTokenBasedProtector(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
     .locals 8
 
-    const-string/jumbo v0, "spblob"
+    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+
+    const-string/jumbo v1, "spblob"
 
-    invoke-virtual {p0, p1, v0, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {v0, p1, v1, p2, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object v0
 
@@ -7166,96 +6272,96 @@
 .end method
 
 .method public final unlockTokenBasedProtectorInternal(Landroid/service/gatekeeper/IGateKeeperService;JB[BI)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
-    .locals 10
+    .locals 9
 
-    move/from16 v7, p6
+    new-instance v8, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
-    new-instance v9, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    invoke-direct {v8}, Ljava/lang/Object;-><init>()V
 
-    invoke-direct {v9}, Ljava/lang/Object;-><init>()V
+    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
     const-string/jumbo v1, "secdis"
 
-    invoke-virtual {p0, v7, v1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    invoke-virtual {v0, p6, v1, p2, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
-    move-result-object v1
+    move-result-object v0
 
-    const-string/jumbo v2, "SyntheticPasswordManager"
+    const-string/jumbo v1, "SyntheticPasswordManager"
 
-    if-nez v1, :cond_0
+    if-nez v0, :cond_0
 
     const-string/jumbo p0, "secdiscardable file not found"
 
-    invoke-static {v2, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v1, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
     sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iput-object p0, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iput-object p0, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    return-object v9
+    return-object v8
 
     :cond_0
-    invoke-virtual {p0, v7, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadWeaverSlot(IJ)I
-
-    move-result v3
+    invoke-virtual {p0, p6, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadWeaverSlot(IJ)I
 
-    const/4 v4, -0x1
+    move-result v2
 
-    const/4 v5, 0x1
+    const/4 v3, -0x1
 
-    if-eq v3, v4, :cond_4
+    if-eq v2, v3, :cond_4
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getWeaverService()Landroid/hardware/weaver/IWeaver;
 
-    move-result-object v4
+    move-result-object v3
 
-    if-nez v4, :cond_1
+    if-nez v3, :cond_1
 
     const-string/jumbo p0, "Protector uses Weaver, but Weaver is unavailable"
 
-    invoke-static {v2, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v1, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
     sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iput-object p0, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iput-object p0, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    return-object v9
+    return-object v8
 
     :cond_1
-    invoke-static {v5, v3, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->begin(III)V
+    const/4 v4, 0x1
 
-    const/4 v6, 0x0
+    invoke-static {v4, v2, p6}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->begin(III)V
+
+    const/4 v4, 0x0
 
-    invoke-virtual {p0, v4, v3, v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->weaverVerify(Landroid/hardware/weaver/IWeaver;I[B)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {p0, v3, v2, v4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->weaverVerify(Landroid/hardware/weaver/IWeaver;I[B)Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    move-result-object v3
+    move-result-object v2
 
-    invoke-static {v7}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->finish(I)V
+    invoke-static {p6}, Lcom/android/server/locksettings/SyntheticPasswordManager$WeaverResult;->finish(I)V
 
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    invoke-virtual {v2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    move-result v4
+    move-result v3
 
-    if-nez v4, :cond_3
+    if-nez v3, :cond_3
 
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getGatekeeperHAT()[B
+    invoke-virtual {v2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getGatekeeperHAT()[B
 
-    move-result-object v4
+    move-result-object v3
 
-    if-nez v4, :cond_2
+    if-nez v3, :cond_2
 
     goto :goto_0
 
     :cond_2
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getGatekeeperHAT()[B
+    invoke-virtual {v2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getGatekeeperHAT()[B
 
-    move-result-object v2
+    move-result-object v1
 
-    sget-object v3, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_WEAVER_TOKEN:[B
+    sget-object v2, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_WEAVER_TOKEN:[B
 
-    invoke-static {v2, v3, v1}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decrypt([B[B[B)[B
+    invoke-static {v1, v2, v0}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decrypt([B[B[B)[B
 
-    move-result-object v1
+    move-result-object v0
 
     goto :goto_1
 
@@ -7263,276 +6369,275 @@
     :goto_0
     const-string p0, "Failed to retrieve Weaver secret when unlocking token-based protector"
 
-    invoke-static {v2, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v1, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
     sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iput-object p0, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iput-object p0, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    return-object v9
+    return-object v8
 
     :cond_4
     :goto_1
-    iget-object v2, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
+    iget-object v1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
 
-    invoke-virtual {v2, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->getSecureMode(I)I
+    invoke-static {v1, p6}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->-$$Nest$mgetSecureMode(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;I)I
 
-    move-result v3
+    invoke-static {p5, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->transformUnderSecdiscardable([B[B)[B
 
-    invoke-virtual {v2, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->getSecureMode(I)I
+    move-result-object v4
 
-    move-result v4
+    const-wide/16 v5, 0x0
 
-    const/4 v6, 0x0
+    move-object v0, p0
 
-    if-lez v4, :cond_5
+    move-wide v1, p2
 
-    move v4, v5
+    move v3, p4
 
-    goto :goto_2
+    move v7, p6
 
-    :cond_5
-    move v4, v6
+    invoke-virtual/range {v0 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unwrapSyntheticPasswordBlob(JB[BJI)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    :goto_2
-    if-nez v4, :cond_6
+    move-result-object p2
 
-    invoke-virtual {v2, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->isSdpMdfppModeForSystem(I)Z
+    iput-object p2, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    move-result v2
+    if-eqz p2, :cond_6
 
-    if-eqz v2, :cond_6
+    invoke-virtual {p0, p1, p2, p6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallenge(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    const-string/jumbo v2, "unlockTokenBasedProtector for System. Need to enable SdpMdfppMode."
+    move-result-object p0
 
-    invoke-static {v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
+    iput-object p0, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    const/4 v3, 0x2
+    if-nez p0, :cond_5
 
-    goto :goto_3
+    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    :cond_6
-    move v5, v4
+    iput-object p0, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    :goto_3
-    sget-object v2, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->NULL:Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
+    :cond_5
+    return-object v8
 
-    if-eqz v5, :cond_7
+    :cond_6
+    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    new-instance v2, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
+    iput-object p0, v8, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    invoke-direct {v2, v3, v6, p5}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;-><init>(II[B)V
+    return-object v8
+.end method
 
-    invoke-virtual {v2}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->getAppId()[B
+.method public final unwrapSyntheticPasswordBlob(JB[BJI)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    .locals 13
 
-    move-result-object v0
+    move-object/from16 v5, p4
 
-    :goto_4
-    move-object v4, v0
+    move/from16 v8, p7
 
-    move-object v8, v2
+    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    goto :goto_5
+    const-string/jumbo v1, "spblob"
 
-    :cond_7
-    invoke-static {p5, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->transformUnderSecdiscardable([B[B)[B
+    invoke-virtual {v0, v8, v1, p1, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
     move-result-object v0
 
-    goto :goto_4
+    const/4 v1, 0x0
 
-    :goto_5
-    if-eqz v5, :cond_8
+    if-nez v0, :cond_0
 
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mSdpSyntheticPasswordManager:Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;
+    invoke-static {p1, p2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    const-wide/16 v5, 0x0
+    move-result-object p0
 
-    move-wide v1, p2
+    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move v3, p4
+    move-result-object v0
 
-    invoke-static/range {v0 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->-$$Nest$munwrapSyntheticPasswordBlobSpecific(Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;JB[BJILcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    filled-new-array {p0, v0}, [Ljava/lang/Object;
 
-    move-result-object p2
+    move-result-object p0
 
-    iput-object p2, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    const-string v0, "Fail to load spblob for protector %016x for user %d"
 
-    invoke-virtual {v8}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->destroy()V
+    invoke-static {v0, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
-    goto :goto_6
+    move-result-object p0
 
-    :cond_8
-    const-wide/16 v5, 0x0
+    invoke-static {p0}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
 
-    move-object v0, p0
+    return-object v1
 
-    move-wide v1, p2
+    :cond_0
+    invoke-static {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;
 
-    move v3, p4
+    move-result-object v0
 
-    move/from16 v7, p6
+    iget-byte v4, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mVersion:B
 
-    invoke-virtual/range {v0 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unwrapSyntheticPasswordBlob(JB[BJI)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    const/4 v6, 0x3
 
-    move-result-object p2
+    const/4 v7, 0x2
 
-    iput-object p2, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    const/4 v9, 0x1
 
-    :goto_6
-    iget-object p2, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    if-eq v4, v6, :cond_2
 
-    if-eqz p2, :cond_a
+    if-eq v4, v7, :cond_2
 
-    const-wide/16 v2, 0x0
+    if-ne v4, v9, :cond_1
 
-    invoke-virtual {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
+    goto :goto_0
 
-    move-result-object v5
+    :cond_1
+    new-instance p0, Ljava/lang/IllegalArgumentException;
 
-    move-object v0, p0
+    new-instance v1, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v2, "Unknown blob version: "
 
-    move-object v4, p1
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    move/from16 v1, p6
+    iget-byte v0, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mVersion:B
 
-    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallengeInternal(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    move-result-object p0
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    iput-object p0, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    move-result-object v0
 
-    if-nez p0, :cond_9
+    invoke-direct {p0, v0}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
 
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
+    throw p0
 
-    iput-object p0, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    :cond_2
+    :goto_0
+    iget-byte v6, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
 
-    :cond_9
-    return-object v9
+    move/from16 v10, p3
 
-    :cond_a
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    if-ne v6, v10, :cond_a
 
-    iput-object p0, v9, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    if-ne v4, v9, :cond_4
 
-    return-object v9
-.end method
+    invoke-static {p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getProtectorKeyAlias(J)Ljava/lang/String;
 
-.method public final unwrapSyntheticPasswordBlob(JB[BJI)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-    .locals 10
+    move-result-object v4
 
-    move/from16 v8, p7
+    iget-object v6, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mContent:[B
 
-    const-string/jumbo v0, "spblob"
+    const-string/jumbo v10, "SP protector key is missing: "
 
-    invoke-virtual {p0, v8, v0, p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    const-string/jumbo v11, "decryptBlobV1(), SP protector key is missing: "
 
-    move-result-object v0
+    :try_start_0
+    invoke-static {}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->getKeyStore()Ljava/security/KeyStore;
 
-    const/4 v1, 0x0
+    move-result-object v12
 
-    if-nez v0, :cond_0
+    invoke-virtual {v12, v4, v1}, Ljava/security/KeyStore;->getKey(Ljava/lang/String;[C)Ljava/security/Key;
 
-    invoke-static {p1, p2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    move-result-object v12
 
-    move-result-object p0
+    check-cast v12, Ljavax/crypto/SecretKey;
 
-    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    if-eqz v12, :cond_3
 
-    move-result-object p1
+    sget-object v4, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->PROTECTOR_SECRET_PERSONALIZATION:[B
 
-    filled-new-array {p0, p1}, [Ljava/lang/Object;
+    invoke-static {v5, v4, v6}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decrypt([B[B[B)[B
 
-    move-result-object p0
+    move-result-object v4
 
-    const-string p1, "Fail to load spblob for protector %016x for user %d"
+    invoke-static {v4, v12}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decrypt([BLjavax/crypto/SecretKey;)[B
 
-    invoke-static {p1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    move-result-object v4
 
-    move-result-object p0
+    goto :goto_2
 
-    invoke-static {p0}, Lcom/samsung/android/lock/LsLog;->verify(Ljava/lang/String;)V
+    :catch_0
+    move-exception v0
 
-    return-object v1
+    move-object p0, v0
 
-    :cond_0
-    invoke-static {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;
+    goto :goto_1
 
-    move-result-object v0
+    :cond_3
+    new-instance p0, Ljava/lang/StringBuilder;
 
-    iget-byte v2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mVersion:B
+    invoke-direct {p0, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    const/4 v3, 0x3
+    invoke-virtual {p0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const/4 v4, 0x2
+    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    const/4 v6, 0x1
+    move-result-object p0
 
-    if-eq v2, v3, :cond_2
+    invoke-static {p0, v9}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
 
-    if-eq v2, v4, :cond_2
+    new-instance p0, Ljava/lang/IllegalStateException;
 
-    if-ne v2, v6, :cond_1
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    goto :goto_0
+    invoke-direct {v0, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    :cond_1
-    new-instance p0, Ljava/lang/IllegalArgumentException;
+    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    new-instance p1, Ljava/lang/StringBuilder;
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    const-string/jumbo p2, "Unknown blob version: "
+    move-result-object v0
 
-    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {p0, v0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
 
-    iget-byte p2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mVersion:B
+    throw p0
+    :try_end_0
+    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
 
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    :goto_1
+    const-string/jumbo v0, "SyntheticPasswordCrypto"
 
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    const-string v1, "Failed to decrypt V1 blob"
 
-    move-result-object p1
+    invoke-static {v0, v1, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    throw p0
+    const-string/jumbo v1, "decryptBlobV1(), Failed to decrypt V1 blob "
 
-    :cond_2
-    :goto_0
-    iget-byte v3, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
+    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    if-ne v3, p3, :cond_9
+    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
 
-    if-ne v2, v6, :cond_3
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-static {p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getProtectorKeyAlias(J)Ljava/lang/String;
+    move-result-object v0
 
-    move-result-object v2
+    invoke-static {v0, v9}, Lcom/samsung/android/lock/LsLog;->keyErr(Ljava/lang/String;Z)V
 
-    iget-object v3, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mContent:[B
+    new-instance v0, Ljava/lang/IllegalStateException;
 
-    invoke-static {v2, v3, p4}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->decryptBlobV1(Ljava/lang/String;[B[B)[B
+    const-string v1, "Failed to decrypt blob"
 
-    move-result-object v2
+    invoke-direct {v0, v1, p0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V
 
-    goto :goto_1
+    throw v0
 
-    :cond_3
+    :cond_4
     invoke-static {p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getProtectorKeyAlias(J)Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object v4
 
-    iget-object v3, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mContent:[B
+    iget-object v6, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mContent:[B
 
-    invoke-virtual {p0, v2, v3, p4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->decryptSpBlob(Ljava/lang/String;[B[B)[B
+    invoke-virtual {p0, v4, v6, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->decryptSpBlob(Ljava/lang/String;[B[B)[B
 
-    move-result-object v2
+    move-result-object v4
 
-    :goto_1
-    const-string/jumbo v3, "SyntheticPasswordManager"
+    :goto_2
+    const-string/jumbo v6, "SyntheticPasswordManager"
 
-    if-nez v2, :cond_4
+    if-nez v4, :cond_5
 
     new-instance p0, Ljava/lang/StringBuilder;
 
@@ -7546,7 +6651,7 @@
 
     move-result-object p0
 
-    invoke-static {v3, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v6, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-static {p1, p2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
@@ -7554,15 +6659,15 @@
 
     invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object p1
+    move-result-object v0
 
-    filled-new-array {p0, p1}, [Ljava/lang/Object;
+    filled-new-array {p0, v0}, [Ljava/lang/Object;
 
     move-result-object p0
 
-    const-string p1, "Fail to decrypt SP for protector %016x for user %d"
+    const-string v0, "Fail to decrypt SP for protector %016x for user %d"
 
-    invoke-static {p1, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
+    invoke-static {v0, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
 
     move-result-object p0
 
@@ -7570,65 +6675,89 @@
 
     return-object v1
 
-    :cond_4
-    new-instance v7, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    :cond_5
+    new-instance v10, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    iget-byte v9, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mVersion:B
+    iget-byte v11, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mVersion:B
 
-    invoke-direct {v7, v9}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;-><init>(B)V
+    invoke-direct {v10, v11}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;-><init>(B)V
 
-    iget-byte v9, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
+    iget-byte v11, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
 
-    if-eq v9, v6, :cond_6
+    if-eq v11, v9, :cond_7
 
-    if-ne v9, v4, :cond_5
+    if-ne v11, v7, :cond_6
 
-    goto :goto_2
+    goto :goto_3
 
-    :cond_5
-    array-length v1, v2
+    :cond_6
+    array-length v1, v4
 
-    invoke-static {v2, v1}, Ljava/util/Arrays;->copyOf([BI)[B
+    invoke-static {v4, v1}, Ljava/util/Arrays;->copyOf([BI)[B
 
     move-result-object v1
 
-    iput-object v1, v7, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
+    iput-object v1, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
 
-    goto :goto_3
+    goto :goto_4
 
-    :cond_6
-    :goto_2
-    invoke-virtual {p0, v8, v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadEscrowData(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
+    :cond_7
+    :goto_3
+    invoke-virtual {p0, v8, v10}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadEscrowData(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)Z
 
-    move-result v4
+    move-result v7
 
-    if-nez v4, :cond_7
+    if-nez v7, :cond_8
 
     const-string/jumbo p0, "User is not escrowable: "
 
-    invoke-static {v8, p0, v3}, Lcom/android/server/NandswapManager$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {v8, p0, v6}, Lcom/android/server/NandswapManager$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
 
     return-object v1
 
-    :cond_7
-    invoke-virtual {v7, v2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->recreateFromEscrow([B)V
+    :cond_8
+    iget-object v1, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEscrowSplit1:[B
 
-    :goto_3
+    invoke-static {v1}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;
+
+    iget-object v1, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEncryptedEscrowSplit0:[B
+
+    invoke-static {v1}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;
+
+    iget-object v1, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mEscrowSplit1:[B
+
+    filled-new-array {v4, v1}, [[B
+
+    move-result-object v1
+
+    sget-object v4, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_SPLIT:[B
+
+    invoke-static {v4, v1}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->personalizedHash([B[[B)[B
+
+    move-result-object v1
+
+    invoke-static {v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->bytesToHex([B)[B
+
+    move-result-object v1
+
+    iput-object v1, v10, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->mSyntheticPassword:[B
+
+    :goto_4
     iget-byte v1, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mVersion:B
 
-    if-ne v1, v6, :cond_8
+    if-ne v1, v9, :cond_9
 
     const-string/jumbo v1, "Upgrading v1 SP blob for user "
 
-    const-string v2, ", protectorType = "
+    const-string v4, ", protectorType = "
 
-    invoke-static {v8, v1, v2}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-static {v8, v1, v4}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     move-result-object v1
 
-    iget-byte v2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
+    iget-byte v4, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
 
-    invoke-static {v1, v2, v3}, Lcom/android/server/RescueParty$RescuePartyObserver$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
+    invoke-static {v1, v4, v6}, Lcom/android/server/RescueParty$RescuePartyObserver$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
 
     iget-byte v3, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
 
@@ -7636,11 +6765,9 @@
 
     move-wide v1, p1
 
-    move-object v5, p4
+    move-wide/from16 v6, p5
 
-    move-object v4, v7
-
-    move-wide v6, p5
+    move-object v4, v10
 
     invoke-virtual/range {v0 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createSyntheticPasswordBlob(JBLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;[BJI)V
 
@@ -7648,102 +6775,130 @@
 
     return-object v4
 
-    :cond_8
-    move-object v4, v7
+    :cond_9
+    move-object v4, v10
 
     return-object v4
 
-    :cond_9
+    :cond_a
     new-instance p0, Ljava/lang/IllegalArgumentException;
 
-    new-instance p1, Ljava/lang/StringBuilder;
+    new-instance v1, Ljava/lang/StringBuilder;
 
-    const-string p2, "Invalid protector type: "
+    const-string v2, "Invalid protector type: "
 
-    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget-byte p2, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
+    iget-byte v0, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPasswordBlob;->mProtectorType:B
 
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object p1
+    move-result-object v0
 
-    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
+    invoke-direct {p0, v0}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
 
     throw p0
 .end method
 
+.method public final verifyChallenge(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)Lcom/android/internal/widget/VerifyCredentialResponse;
+    .locals 7
+
+    invoke-virtual {p2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    sget-object v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->PERSONALIZATION_SP_GK_AUTH:[B
+
+    invoke-virtual {p2, v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveSubkey([B)[B
+
+    move-result-object v6
+
+    const-wide/16 v3, 0x0
+
+    move-object v1, p0
+
+    move-object v5, p1
+
+    move v2, p3
+
+    invoke-virtual/range {v1 .. v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallengeInternal(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/internal/widget/VerifyCredentialResponse;
+
+    move-result-object p0
+
+    return-object p0
+.end method
+
 .method public final verifyChallengeInternal(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 10
+    .locals 9
 
-    const-string/jumbo v1, "SyntheticPasswordManager"
+    const-string/jumbo v7, "SyntheticPasswordManager"
 
     const-string/jumbo v0, "handle"
 
-    const-wide/16 v2, 0x0
+    iget-object v1, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {p0, p1, v0, v2, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    const-wide/16 v3, 0x0
 
-    move-result-object v8
+    invoke-virtual {v1, p1, v0, v3, v4}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
-    if-nez v8, :cond_0
+    move-result-object v5
 
-    const/4 p0, 0x0
+    if-nez v5, :cond_0
 
-    return-object p0
+    const/4 v0, 0x0
+
+    return-object v0
 
     :cond_0
-    move v5, p1
+    move v2, p1
 
-    move-wide v6, p2
+    move-wide v3, p2
 
-    move-object v4, p4
+    move-object v1, p4
 
-    move-object v9, p5
+    move-object v6, p5
 
     :try_start_0
-    invoke-interface/range {v4 .. v9}, Landroid/service/gatekeeper/IGateKeeperService;->verifyChallenge(IJ[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
+    invoke-interface/range {v1 .. v6}, Landroid/service/gatekeeper/IGateKeeperService;->verifyChallenge(IJ[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
 
-    move-result-object p1
+    move-result-object v0
     :try_end_0
     .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_1
 
-    move v3, v5
+    invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getResponseCode()I
 
-    invoke-virtual {p1}, Landroid/service/gatekeeper/GateKeeperResponse;->getResponseCode()I
+    move-result v1
 
-    move-result p5
+    if-nez v1, :cond_3
 
-    if-nez p5, :cond_3
+    new-instance v1, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
 
-    new-instance p5, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
+    invoke-direct {v1}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;-><init>()V
 
-    invoke-direct {p5}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;-><init>()V
+    invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getPayload()[B
 
-    invoke-virtual {p1}, Landroid/service/gatekeeper/GateKeeperResponse;->getPayload()[B
+    move-result-object v3
 
-    move-result-object v0
+    invoke-virtual {v1, v3}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->setGatekeeperHAT([B)Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
 
-    invoke-virtual {p5, v0}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->setGatekeeperHAT([B)Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
+    move-result-object v1
 
-    move-result-object p5
+    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->build()Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    invoke-virtual {p5}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->build()Lcom/android/internal/widget/VerifyCredentialResponse;
+    move-result-object v1
 
-    move-result-object p5
+    invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getShouldReEnroll()Z
 
-    invoke-virtual {p1}, Landroid/service/gatekeeper/GateKeeperResponse;->getShouldReEnroll()Z
+    move-result v0
 
-    move-result p1
+    if-eqz v0, :cond_2
 
-    if-eqz p1, :cond_2
+    move-object v8, p5
 
     :try_start_1
-    invoke-interface {p4, v3, v8, v9, v9}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
+    invoke-interface {p4, p1, v5, p5, p5}, Landroid/service/gatekeeper/IGateKeeperService;->enroll(I[B[B[B)Landroid/service/gatekeeper/GateKeeperResponse;
 
-    move-result-object p1
+    move-result-object v0
     :try_end_1
     .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0
 
@@ -7752,107 +6907,97 @@
     :catch_0
     move-exception v0
 
-    move-object p1, v0
+    const-string v3, "Failed to invoke gatekeeper.enroll"
 
-    const-string v0, "Failed to invoke gatekeeper.enroll"
+    invoke-static {v7, v3, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    invoke-static {v1, v0, p1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    sget-object p1, Landroid/service/gatekeeper/GateKeeperResponse;->ERROR:Landroid/service/gatekeeper/GateKeeperResponse;
+    sget-object v0, Landroid/service/gatekeeper/GateKeeperResponse;->ERROR:Landroid/service/gatekeeper/GateKeeperResponse;
 
     :goto_0
-    invoke-virtual {p1}, Landroid/service/gatekeeper/GateKeeperResponse;->getResponseCode()I
+    invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getResponseCode()I
 
-    move-result v0
+    move-result v3
 
-    if-nez v0, :cond_1
+    if-nez v3, :cond_1
 
-    invoke-virtual {p1}, Landroid/service/gatekeeper/GateKeeperResponse;->getPayload()[B
+    invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getPayload()[B
 
-    move-result-object v7
+    move-result-object v3
 
-    const-string/jumbo v6, "handle"
+    const-string/jumbo v2, "handle"
 
     const-wide/16 v4, 0x0
 
-    move-object v2, p0
-
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(IJLjava/lang/String;[B)V
-
-    invoke-virtual {v2, v3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
+    move-object v1, p0
 
-    move-wide v4, p2
+    move v6, p1
 
-    move-object v6, p4
+    invoke-virtual/range {v1 .. v6}, Lcom/android/server/locksettings/SyntheticPasswordManager;->saveState(Ljava/lang/String;[BJI)V
 
-    move-object v7, v9
+    invoke-virtual/range {p0 .. p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->syncState(I)V
 
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallengeInternal(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual/range {p0 .. p5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallengeInternal(IJLandroid/service/gatekeeper/IGateKeeperService;[B)Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    move-result-object p0
+    move-result-object v0
 
-    return-object p0
+    return-object v0
 
     :cond_1
-    const-string p0, "Fail to re-enroll SP handle for user "
+    const-string v0, "Fail to re-enroll SP handle for user "
 
-    invoke-static {v3, p0, v1}, Lcom/android/server/BinaryTransparencyService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {p1, v0, v7}, Lcom/android/server/BinaryTransparencyService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
 
     :cond_2
-    return-object p5
+    return-object v1
 
     :cond_3
-    const/4 p0, 0x1
+    const/4 v2, 0x1
 
-    if-ne p5, p0, :cond_4
+    if-ne v1, v2, :cond_4
 
-    const-string p0, "Gatekeeper verification of synthetic password failed with RESPONSE_RETRY"
+    const-string v1, "Gatekeeper verification of synthetic password failed with RESPONSE_RETRY"
 
-    invoke-static {v1, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v7, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-virtual {p1}, Landroid/service/gatekeeper/GateKeeperResponse;->getTimeout()I
+    invoke-virtual {v0}, Landroid/service/gatekeeper/GateKeeperResponse;->getTimeout()I
 
-    move-result p0
+    move-result v0
 
-    invoke-static {p0}, Lcom/android/internal/widget/VerifyCredentialResponse;->fromTimeout(I)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-static {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->fromTimeout(I)Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    move-result-object p0
+    move-result-object v0
 
-    return-object p0
+    return-object v0
 
     :cond_4
-    const-string p0, "Gatekeeper verification of synthetic password failed with RESPONSE_ERROR"
+    const-string v0, "Gatekeeper verification of synthetic password failed with RESPONSE_ERROR"
 
-    invoke-static {v1, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v7, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    return-object p0
+    return-object v0
 
     :catch_1
     move-exception v0
 
-    move v3, v5
-
-    move-object p0, v0
-
-    new-instance p1, Ljava/lang/StringBuilder;
+    new-instance v1, Ljava/lang/StringBuilder;
 
-    const-string p2, "Fail to verify with gatekeeper "
+    const-string v3, "Fail to verify with gatekeeper "
 
-    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v1, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {p1, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object p1
+    move-result-object v1
 
-    invoke-static {v1, p1, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    invoke-static {v7, v1, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    return-object p0
+    return-object v0
 .end method
 
 .method public final verifySpecialUserCredential(ILandroid/service/gatekeeper/IGateKeeperService;Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/VerifyCredentialResponse;
@@ -8467,7 +7612,7 @@
 .end method
 
 .method public final writeRepairModeCredentialLocked(IJ)Z
-    .locals 6
+    .locals 7
 
     iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mUserManager:Landroid/os/UserManager;
 
@@ -8530,13 +7675,15 @@
     return v1
 
     :cond_2
-    const-string/jumbo v0, "pwd"
+    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {p0, p1, v0, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadState(ILjava/lang/String;J)[B
+    const-string/jumbo v3, "pwd"
 
-    move-result-object v0
+    invoke-virtual {v0, p1, v3, p2, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->readSyntheticPasswordState(ILjava/lang/String;J)[B
 
-    if-nez v0, :cond_3
+    move-result-object v3
+
+    if-nez v3, :cond_3
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -8553,15 +7700,15 @@
     return v1
 
     :cond_3
-    invoke-static {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
+    invoke-static {v3}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->fromBytes([B)Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;
 
-    move-result-object v0
+    move-result-object v3
 
-    iget v3, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->credentialType:I
+    iget v4, v3, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->credentialType:I
 
-    const/4 v4, -0x1
+    const/4 v5, -0x1
 
-    if-ne v3, v4, :cond_4
+    if-ne v4, v5, :cond_4
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -8580,58 +7727,56 @@
     :cond_4
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v3
+    move-result-object v4
 
-    filled-new-array {v3}, [Ljava/lang/Object;
+    filled-new-array {v4}, [Ljava/lang/Object;
 
-    move-result-object v3
+    move-result-object v4
 
-    const-string/jumbo v5, "Writing repair mode credential tied to user %d"
+    const-string/jumbo v6, "Writing repair mode credential tied to user %d"
 
-    invoke-static {v2, v5, v3}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v2, v6, v4}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->loadWeaverSlot(IJ)I
 
-    move-result p2
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    move-result p0
 
-    const/4 p3, 0x1
+    const/4 p2, 0x1
 
-    if-eq p2, v4, :cond_5
+    if-eq p0, v5, :cond_5
 
-    invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->toBytes()[B
+    invoke-virtual {v3}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->toBytes()[B
 
     move-result-object p1
 
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsStorage;->getRepairModePersistentDataFile()Ljava/io/File;
+    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsStorage;->getRepairModePersistentDataFile()Ljava/io/File;
 
-    move-result-object v0
+    move-result-object p3
 
     const/4 v2, 0x2
 
-    invoke-static {v2, p2, v1, p1}, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->toBytes(III[B)[B
+    invoke-static {v2, p0, v1, p1}, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->toBytes(III[B)[B
 
-    move-result-object p1
+    move-result-object p0
 
-    invoke-virtual {p0, v0, p1, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->writeFile(Ljava/io/File;[BZ)V
+    invoke-virtual {v0, p3, p0, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->writeFile(Ljava/io/File;[BZ)V
 
-    return p3
+    return p2
 
     :cond_5
-    invoke-virtual {v0}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->toBytes()[B
+    invoke-virtual {v3}, Lcom/android/server/locksettings/SyntheticPasswordManager$PasswordData;->toBytes()[B
 
-    move-result-object p2
+    move-result-object p0
 
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsStorage;->getRepairModePersistentDataFile()Ljava/io/File;
+    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsStorage;->getRepairModePersistentDataFile()Ljava/io/File;
 
-    move-result-object v0
+    move-result-object p3
 
-    invoke-static {p3, p1, v1, p2}, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->toBytes(III[B)[B
+    invoke-static {p2, p1, v1, p0}, Lcom/android/server/locksettings/LockSettingsStorage$PersistentData;->toBytes(III[B)[B
 
-    move-result-object p1
+    move-result-object p0
 
-    invoke-virtual {p0, v0, p1, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->writeFile(Ljava/io/File;[BZ)V
+    invoke-virtual {v0, p3, p0, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->writeFile(Ljava/io/File;[BZ)V
 
-    return p3
+    return p2
 .end method
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial.smali b/smali/com/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial.smali
deleted file mode 100644
index f75744c29..000000000
--- a/smali/com/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial.smali
+++ /dev/null
@@ -1,128 +0,0 @@
-.class public final Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# static fields
-.field public static final NULL:Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
-
-
-# instance fields
-.field public applicationId:[B
-
-.field public authenticationData:[B
-
-.field public gkInput:[B
-
-.field public final pivot:[B
-
-.field public final pivotSafe:Z
-
-.field public final secureMode:I
-
-
-# direct methods
-.method static constructor <clinit>()V
-    .locals 3
-
-    new-instance v0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
-
-    const/4 v1, 0x0
-
-    const/4 v2, -0x1
-
-    invoke-direct {v0, v2, v1}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;-><init>(I[B)V
-
-    sput-object v0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->NULL:Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;
-
-    return-void
-.end method
-
-.method public constructor <init>(II[B)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p3, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->pivot:[B
-
-    const/4 p2, 0x1
-
-    iput-boolean p2, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->pivotSafe:Z
-
-    iput p1, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->secureMode:I
-
-    return-void
-.end method
-
-.method public constructor <init>(I[B)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p2, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->pivot:[B
-
-    const/4 p2, 0x0
-
-    iput-boolean p2, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->pivotSafe:Z
-
-    iput p1, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->secureMode:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final destroy()V
-    .locals 3
-
-    iget-boolean v0, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->pivotSafe:Z
-
-    if-eqz v0, :cond_0
-
-    const/4 v0, 0x0
-
-    goto :goto_0
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->pivot:[B
-
-    :goto_0
-    iget-object v1, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->gkInput:[B
-
-    iget-object v2, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->applicationId:[B
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->authenticationData:[B
-
-    filled-new-array {v0, v1, v2, p0}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/SecureUtil;->clearAll([Ljava/lang/Object;)V
-
-    return-void
-.end method
-
-.method public final getAppId()[B
-    .locals 3
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->applicationId:[B
-
-    if-nez v0, :cond_0
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->pivot:[B
-
-    iget v1, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->secureMode:I
-
-    const-string v2, "ForApplicationId"
-
-    invoke-static {v1, v2, v0}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->personalize(ILjava/lang/String;[B)[B
-
-    move-result-object v0
-
-    iput-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->applicationId:[B
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$KeyingMaterial;->applicationId:[B
-
-    return-object p0
-.end method
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordMdfpp$Utils.smali b/smali/com/android/server/locksettings/SyntheticPasswordMdfpp$Utils.smali
deleted file mode 100644
index 40b325e67..000000000
--- a/smali/com/android/server/locksettings/SyntheticPasswordMdfpp$Utils.smali
+++ /dev/null
@@ -1,26 +0,0 @@
-.class public abstract Lcom/android/server/locksettings/SyntheticPasswordMdfpp$Utils;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-
-# direct methods
-.method public static varargs hasAAD([[B)Z
-    .locals 3
-
-    array-length v0, p0
-
-    const/4 v1, 0x0
-
-    const/4 v2, 0x1
-
-    if-lt v0, v2, :cond_0
-
-    aget-object p0, p0, v1
-
-    if-eqz p0, :cond_0
-
-    return v2
-
-    :cond_0
-    return v1
-.end method
diff --git a/smali/com/android/server/locksettings/SyntheticPasswordMdfpp.smali b/smali/com/android/server/locksettings/SyntheticPasswordMdfpp.smali
index 44822ca68..3f97e47c1 100644
--- a/smali/com/android/server/locksettings/SyntheticPasswordMdfpp.smali
+++ b/smali/com/android/server/locksettings/SyntheticPasswordMdfpp.smali
@@ -4,8 +4,6 @@
 
 
 # static fields
-.field public static final mCredentialTypeCache:Landroid/util/SparseArray;
-
 .field public static final mSecureModeCache:Landroid/util/SparseArray;
 
 
@@ -23,67 +21,9 @@
 
     invoke-direct {v0}, Landroid/util/SparseArray;-><init>()V
 
-    sput-object v0, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mCredentialTypeCache:Landroid/util/SparseArray;
-
     return-void
 .end method
 
-.method public static getCredentialType(I)I
-    .locals 4
-
-    const-string v0, "Empty credential type for user "
-
-    sget-object v1, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->mCredentialTypeCache:Landroid/util/SparseArray;
-
-    monitor-enter v1
-
-    :try_start_0
-    invoke-virtual {v1, p0}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Ljava/lang/Integer;
-
-    if-eqz v2, :cond_0
-
-    invoke-virtual {v2}, Ljava/lang/Integer;->intValue()I
-
-    move-result p0
-
-    monitor-exit v1
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_0
-
-    :cond_0
-    new-instance v2, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$EmptySlotException;
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v3, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-direct {v2, p0}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp$EmptySlotException;-><init>(Ljava/lang/String;)V
-
-    throw v2
-
-    :goto_0
-    monitor-exit v1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
 .method public static getSecureMode(I)I
     .locals 4
 
@@ -139,138 +79,3 @@
 
     throw p0
 .end method
-
-.method public static personalize(ILjava/lang/String;[B)[B
-    .locals 5
-
-    sget-object v0, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->PROTECTOR_SECRET_PERSONALIZATION:[B
-
-    if-eqz p2, :cond_5
-
-    const/4 v0, 0x1
-
-    if-lt p0, v0, :cond_4
-
-    const/4 v1, 0x2
-
-    if-gt p0, v1, :cond_4
-
-    const-string v1, "KeyEncryptionKey"
-
-    invoke-virtual {v1}, Ljava/lang/String;->getBytes()[B
-
-    move-result-object v1
-
-    invoke-virtual {p1}, Ljava/lang/String;->getBytes()[B
-
-    move-result-object p1
-
-    array-length v2, v1
-
-    const/16 v3, 0x20
-
-    if-gt v2, v3, :cond_3
-
-    array-length v2, p1
-
-    const/16 v4, 0x40
-
-    if-gt v2, v4, :cond_3
-
-    invoke-static {v1, v3}, Ljava/util/Arrays;->copyOf([BI)[B
-
-    move-result-object v1
-
-    invoke-static {p1, v4}, Ljava/util/Arrays;->copyOf([BI)[B
-
-    move-result-object p1
-
-    const/4 v2, 0x0
-
-    if-eq p0, v0, :cond_0
-
-    :try_start_0
-    invoke-static {p2, v1, p1, v3}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->nativeKBKDF([B[B[BI)[B
-
-    move-result-object v2
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Throwable;->printStackTrace()V
-
-    goto :goto_0
-
-    :cond_0
-    :try_start_1
-    invoke-static {p2, v1, p1, v3}, Lcom/android/server/locksettings/SyntheticPasswordCrypto;->nativeKDF([B[B[BI)[B
-
-    move-result-object v2
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_1
-
-    goto :goto_0
-
-    :catchall_1
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Throwable;->printStackTrace()V
-
-    :goto_0
-    if-eqz v2, :cond_2
-
-    array-length p0, v2
-
-    if-le p0, v3, :cond_1
-
-    invoke-static {v2, v3}, Ljava/util/Arrays;->copyOf([BI)[B
-
-    move-result-object p0
-
-    invoke-static {v2}, Lcom/android/server/knox/dar/SecureUtil;->clear([B)V
-
-    move-object v2, p0
-
-    :cond_1
-    return-object v2
-
-    :cond_2
-    new-instance p0, Ljava/lang/IllegalStateException;
-
-    const-string/jumbo p1, "Unexpected native error while personalization"
-
-    invoke-direct {p0, p1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    :cond_3
-    new-instance p0, Ljava/lang/IllegalStateException;
-
-    const-string/jumbo p1, "Personalization too long"
-
-    invoke-direct {p0, p1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    :cond_4
-    new-instance p0, Ljava/lang/IllegalStateException;
-
-    const-string p1, "Invalid secure mode for personalization"
-
-    invoke-direct {p0, p1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    :cond_5
-    new-instance p0, Ljava/lang/IllegalStateException;
-
-    const-string/jumbo p1, "Make sure of input parameter"
-
-    invoke-direct {p0, p1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-.end method
diff --git a/smali_classes2/com/android/server/pm/ComputerEngine.smali b/smali_classes2/com/android/server/pm/ComputerEngine.smali
index 2c141f297..dffa32888 100644
--- a/smali_classes2/com/android/server/pm/ComputerEngine.smali
+++ b/smali_classes2/com/android/server/pm/ComputerEngine.smali
@@ -17265,21 +17265,21 @@
 
     move-result-object p4
 
-    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;
+    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;
 
     const/4 v3, 0x2
 
-    invoke-direct {v1, p2, v3}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;-><init>(II)V
+    invoke-direct {v1, p2, v3}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;-><init>(II)V
 
     invoke-virtual {p4, v1}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
     move-result-object p4
 
-    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;
+    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;
 
     const/4 v3, 0x1
 
-    invoke-direct {v1, p2, v3}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;-><init>(II)V
+    invoke-direct {v1, p2, v3}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;-><init>(II)V
 
     invoke-virtual {p4, v1}, Ljava/util/Optional;->orElseGet(Ljava/util/function/Supplier;)Ljava/lang/Object;
 
diff --git a/smali_classes2/com/android/server/pm/PackageManagerService$IPackageManagerImpl.smali b/smali_classes2/com/android/server/pm/PackageManagerService$IPackageManagerImpl.smali
index 4b26f9b0e..6558cfb47 100644
--- a/smali_classes2/com/android/server/pm/PackageManagerService$IPackageManagerImpl.smali
+++ b/smali_classes2/com/android/server/pm/PackageManagerService$IPackageManagerImpl.smali
@@ -1880,95 +1880,11 @@
 .end method
 
 .method public final createEncAppData(Ljava/lang/String;I)Z
-    .locals 6
-
-    iget-object p0, p0, Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;->this$0:Lcom/android/server/pm/PackageManagerService;
-
-    invoke-virtual {p0}, Lcom/android/server/pm/PackageManagerService;->snapshotComputer()Lcom/android/server/pm/Computer;
-
-    move-result-object v0
-
-    const-wide/16 v3, 0x0
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v1
-
-    move-object v5, p1
-
-    move v2, p2
-
-    invoke-interface/range {v0 .. v5}, Lcom/android/server/pm/Computer;->getApplicationInfoInternal(IIJLjava/lang/String;)Landroid/content/pm/ApplicationInfo;
-
-    move-result-object p1
-
-    const/4 p2, 0x0
-
-    if-nez p1, :cond_0
-
-    const-string/jumbo p0, "No application info: "
-
-    const-string/jumbo p1, "PackageManager"
-
-    invoke-static {p0, v5, p1}, Lcom/android/server/StorageManagerService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
-
-    return p2
-
-    :cond_0
-    iget v0, p1, Landroid/content/pm/ApplicationInfo;->uid:I
-
-    invoke-static {v0}, Landroid/os/UserHandle;->getAppId(I)I
-
-    move-result v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;
-
-    iget p1, p1, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I
-
-    invoke-virtual {p0}, Lcom/android/server/pm/Installer;->checkBeforeRemote()Z
-
-    move-result v1
-    :try_end_0
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_0 .. :try_end_0} :catch_1
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-nez v1, :cond_1
-
-    goto :goto_0
-
-    :cond_1
-    :try_start_1
-    iget-object p0, p0, Lcom/android/server/pm/Installer;->mInstalld:Landroid/os/IInstalld;
-
-    invoke-interface {p0, v5, v2, v0, p1}, Landroid/os/IInstalld;->createEncAppData(Ljava/lang/String;III)Z
-
-    move-result p0
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    return p0
-
-    :catch_0
-    move-exception v0
-
-    move-object p0, v0
-
-    :try_start_2
-    invoke-static {p0}, Lcom/android/server/pm/Installer$InstallerException;->from(Ljava/lang/Exception;)V
+    .locals 0
 
     const/4 p0, 0x0
 
-    throw p0
-    :try_end_2
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    :catch_1
-    :catchall_0
-    :goto_0
-    return p2
+    return p0
 .end method
 
 .method public final currentToCanonicalPackageNames([Ljava/lang/String;)[Ljava/lang/String;
@@ -14621,88 +14537,17 @@
 .method public final removeEncPkgDir(ILjava/lang/String;)Z
     .locals 0
 
-    iget-object p0, p0, Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;->this$0:Lcom/android/server/pm/PackageManagerService;
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->removeEncPkgDir(ILjava/lang/String;)Z
-
-    move-result p0
+    const/4 p0, 0x0
 
     return p0
 .end method
 
 .method public final removeEncUserDir(I)Z
-    .locals 3
-
-    iget-object p0, p0, Lcom/android/server/pm/PackageManagerService$IPackageManagerImpl;->this$0:Lcom/android/server/pm/PackageManagerService;
-
-    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Lcom/android/server/pm/PackageManagerTracedLock;
-
-    monitor-enter v0
-
-    const/4 v1, 0x0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;
-
-    invoke-virtual {p0}, Lcom/android/server/pm/Installer;->checkBeforeRemote()Z
-
-    move-result v2
-    :try_end_0
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_0 .. :try_end_0} :catch_1
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-nez v2, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    :try_start_1
-    iget-object p0, p0, Lcom/android/server/pm/Installer;->mInstalld:Landroid/os/IInstalld;
-
-    invoke-interface {p0, p1}, Landroid/os/IInstalld;->removeEncUserDir(I)Z
-
-    move-result v1
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    :try_start_2
-    invoke-static {p0}, Lcom/android/server/pm/Installer$InstallerException;->from(Ljava/lang/Exception;)V
+    .locals 0
 
     const/4 p0, 0x0
 
-    throw p0
-    :try_end_2
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :catch_1
-    move-exception p0
-
-    :try_start_3
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :goto_0
-    monitor-exit v0
-
-    return v1
-
-    :goto_1
-    monitor-exit v0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    throw p0
+    return p0
 .end method
 
 .method public final removePermission(Ljava/lang/String;)V
diff --git a/smali_classes2/com/android/server/pm/PackageManagerService.smali b/smali_classes2/com/android/server/pm/PackageManagerService.smali
index e3a67ea21..42aaad74e 100644
--- a/smali_classes2/com/android/server/pm/PackageManagerService.smali
+++ b/smali_classes2/com/android/server/pm/PackageManagerService.smali
@@ -17047,79 +17047,6 @@
     return-void
 .end method
 
-.method public final removeEncPkgDir(ILjava/lang/String;)Z
-    .locals 3
-
-    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Lcom/android/server/pm/PackageManagerTracedLock;
-
-    monitor-enter v0
-
-    const/4 v1, 0x0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;
-
-    invoke-virtual {p0}, Lcom/android/server/pm/Installer;->checkBeforeRemote()Z
-
-    move-result v2
-    :try_end_0
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_0 .. :try_end_0} :catch_1
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-nez v2, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    :try_start_1
-    iget-object p0, p0, Lcom/android/server/pm/Installer;->mInstalld:Landroid/os/IInstalld;
-
-    invoke-interface {p0, p1, p2}, Landroid/os/IInstalld;->removeEncPkgDir(ILjava/lang/String;)Z
-
-    move-result v1
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    :try_start_2
-    invoke-static {p0}, Lcom/android/server/pm/Installer$InstallerException;->from(Ljava/lang/Exception;)V
-
-    const/4 p0, 0x0
-
-    throw p0
-    :try_end_2
-    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_1
-
-    :catch_1
-    move-exception p0
-
-    :try_start_3
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :goto_0
-    monitor-exit v0
-
-    return v1
-
-    :goto_1
-    monitor-exit v0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    throw p0
-.end method
-
 .method public final requestChecksumsInternal(Lcom/android/server/pm/Computer;Ljava/lang/String;ZIILjava/util/List;Landroid/content/pm/IOnChecksumsReadyListener;ILjava/util/concurrent/Executor;Landroid/os/Handler;)V
     .locals 13
 
diff --git a/smali_classes2/com/android/server/pm/PersonaManagerService$2.smali b/smali_classes2/com/android/server/pm/PersonaManagerService$2.smali
index dc955d3b4..aed628364 100644
--- a/smali_classes2/com/android/server/pm/PersonaManagerService$2.smali
+++ b/smali_classes2/com/android/server/pm/PersonaManagerService$2.smali
@@ -2554,14 +2554,14 @@
 
     iget-object p0, p0, Lcom/android/server/wm/ActivityTaskManagerService;->mExt:Lcom/android/server/wm/ActivityTaskManagerServiceExt;
 
-    const-string/jumbo p1, "Managed profile unavailable"
-
-    invoke-virtual {p0, v3, p1}, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->removeTaskByCmpName(ILjava/lang/String;)V
+    invoke-virtual {p0}, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->removeTaskByCmpName()V
 
     :cond_3c
     :goto_19
     return-void
 
+    nop
+
     :pswitch_data_0
     .packed-switch 0x0
         :pswitch_4
diff --git a/smali_classes2/com/android/server/pm/PersonaManagerService.smali b/smali_classes2/com/android/server/pm/PersonaManagerService.smali
index 98596ecb0..a48038495 100644
--- a/smali_classes2/com/android/server/pm/PersonaManagerService.smali
+++ b/smali_classes2/com/android/server/pm/PersonaManagerService.smali
@@ -5097,43 +5097,41 @@
 
     iput-object v1, p0, Lcom/android/server/pm/PersonaManagerService;->usageWatcher:Lcom/android/server/pm/PersonaManagerService$10;
 
-    iget-object v2, p1, Lcom/android/server/pm/PersonaManagerService$Injector;->mContext:Landroid/content/Context;
+    iget-object v1, p1, Lcom/android/server/pm/PersonaManagerService$Injector;->mContext:Landroid/content/Context;
 
-    iput-object v2, p0, Lcom/android/server/pm/PersonaManagerService;->mContext:Landroid/content/Context;
+    iput-object v1, p0, Lcom/android/server/pm/PersonaManagerService;->mContext:Landroid/content/Context;
 
     iput-object p1, p0, Lcom/android/server/pm/PersonaManagerService;->mInjector:Lcom/android/server/pm/PersonaManagerService$Injector;
 
-    iget-object v3, p1, Lcom/android/server/pm/PersonaManagerService$Injector;->mPm:Lcom/android/server/pm/PackageManagerService;
+    iget-object v2, p1, Lcom/android/server/pm/PersonaManagerService$Injector;->mPm:Lcom/android/server/pm/PackageManagerService;
 
-    iput-object v3, p0, Lcom/android/server/pm/PersonaManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
+    iput-object v2, p0, Lcom/android/server/pm/PersonaManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
 
     sput-object p0, Lcom/android/server/pm/PersonaManagerService;->sInstance:Lcom/android/server/pm/PersonaManagerService;
 
-    new-instance v3, Lcom/android/server/knox/KnoxAnalyticsContainer;
+    new-instance v2, Lcom/android/server/knox/KnoxAnalyticsContainer;
 
-    new-instance v4, Lcom/android/server/knox/IKnoxAnalyticsContainerImpl;
+    new-instance v3, Lcom/android/server/knox/IKnoxAnalyticsContainerImpl;
 
-    invoke-direct {v4, v2, p0}, Lcom/android/server/knox/IKnoxAnalyticsContainerImpl;-><init>(Landroid/content/Context;Lcom/android/server/pm/PersonaManagerService;)V
+    invoke-direct {v3, v1, p0}, Lcom/android/server/knox/IKnoxAnalyticsContainerImpl;-><init>(Landroid/content/Context;Lcom/android/server/pm/PersonaManagerService;)V
 
-    invoke-direct {v3, v2, v4}, Lcom/android/server/knox/KnoxAnalyticsContainer;-><init>(Landroid/content/Context;Lcom/android/server/knox/IKnoxAnalyticsContainerImpl;)V
+    invoke-direct {v2, v1, v3}, Lcom/android/server/knox/KnoxAnalyticsContainer;-><init>(Landroid/content/Context;Lcom/android/server/knox/IKnoxAnalyticsContainerImpl;)V
 
-    iput-object v3, p0, Lcom/android/server/pm/PersonaManagerService;->mKnoxAnalyticsContainer:Lcom/android/server/knox/KnoxAnalyticsContainer;
+    iput-object v2, p0, Lcom/android/server/pm/PersonaManagerService;->mKnoxAnalyticsContainer:Lcom/android/server/knox/KnoxAnalyticsContainer;
 
-    iget-object v2, p1, Lcom/android/server/pm/PersonaManagerService$Injector;->mContext:Landroid/content/Context;
+    iget-object v1, p1, Lcom/android/server/pm/PersonaManagerService$Injector;->mContext:Landroid/content/Context;
 
-    sget-object v3, Lcom/android/server/knox/ContainerDependencyWrapper;->sInstance:Lcom/android/server/knox/ContainerDependencyWrapper;
+    sget-object v2, Lcom/android/server/knox/ContainerDependencyWrapper;->sInstance:Lcom/android/server/knox/ContainerDependencyWrapper;
 
-    if-nez v3, :cond_0
-
-    new-instance v3, Lcom/android/server/knox/ContainerDependencyWrapper;
+    if-nez v2, :cond_0
 
-    invoke-direct {v3}, Ljava/lang/Object;-><init>()V
+    new-instance v2, Lcom/android/server/knox/ContainerDependencyWrapper;
 
-    iput-object v1, v3, Lcom/android/server/knox/ContainerDependencyWrapper;->mDarService:Lcom/android/server/knox/dar/DarManagerService;
+    invoke-direct {v2}, Ljava/lang/Object;-><init>()V
 
-    sput-object v2, Lcom/android/server/knox/ContainerDependencyWrapper;->context:Landroid/content/Context;
+    sput-object v1, Lcom/android/server/knox/ContainerDependencyWrapper;->context:Landroid/content/Context;
 
-    sput-object v3, Lcom/android/server/knox/ContainerDependencyWrapper;->sInstance:Lcom/android/server/knox/ContainerDependencyWrapper;
+    sput-object v2, Lcom/android/server/knox/ContainerDependencyWrapper;->sInstance:Lcom/android/server/knox/ContainerDependencyWrapper;
 
     :cond_0
     sget-object v1, Lcom/android/server/knox/ContainerDependencyWrapper;->sInstance:Lcom/android/server/knox/ContainerDependencyWrapper;
@@ -6212,7 +6210,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_3
+    if-eqz v0, :cond_1
 
     const-string/jumbo v0, "PersonaManagerService"
 
@@ -6245,7 +6243,7 @@
     goto :goto_0
 
     :catchall_0
-    move-exception v0
+    move-exception p1
 
     goto :goto_1
 
@@ -6258,16 +6256,16 @@
     :try_start_2
     monitor-exit p0
 
-    const/4 v1, 0x1
+    const/4 p0, 0x1
 
-    invoke-interface {v0, p1, v1}, Landroid/app/trust/ITrustManager;->setDeviceLockedForUser(IZ)V
+    invoke-interface {v0, p1, p0}, Landroid/app/trust/ITrustManager;->setDeviceLockedForUser(IZ)V
     :try_end_2
     .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0
 
     goto :goto_3
 
     :catch_0
-    move-exception v0
+    move-exception p0
 
     goto :goto_2
 
@@ -6278,78 +6276,15 @@
     .catchall {:try_start_3 .. :try_end_3} :catchall_0
 
     :try_start_4
-    throw v0
+    throw p1
     :try_end_4
     .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_0
 
     :goto_2
-    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
-
-    :goto_3
-    iget-object p0, p0, Lcom/android/server/pm/PersonaManagerService;->containerDependencyWrapper:Lcom/android/server/knox/ContainerDependencyWrapper;
-
-    if-eqz p0, :cond_3
-
-    iget-object v0, p0, Lcom/android/server/knox/ContainerDependencyWrapper;->mDarService:Lcom/android/server/knox/dar/DarManagerService;
-
-    if-nez v0, :cond_1
-
-    const-string/jumbo v0, "dar"
-
-    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/knox/dar/DarManagerService;
-
-    iput-object v0, p0, Lcom/android/server/knox/ContainerDependencyWrapper;->mDarService:Lcom/android/server/knox/dar/DarManagerService;
+    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
 
     :cond_1
-    iget-object p0, p0, Lcom/android/server/knox/ContainerDependencyWrapper;->mDarService:Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz p0, :cond_3
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->isSdpSupported()Z
-
-    move-result v0
-
-    if-nez v0, :cond_2
-
-    goto :goto_4
-
-    :cond_2
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string v1, "CMFA locked for user "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string v1, "DarManagerService_SDP"
-
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/DarManagerService;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->lockSdpIfRequired(I)V
-
-    :cond_3
-    :goto_4
+    :goto_3
     return-void
 .end method
 
diff --git a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0.smali b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0.smali
index 83fc2a93f..baad3c5ab 100644
--- a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0.smali
+++ b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0.smali
@@ -6,39 +6,164 @@
 .implements Ljava/util/function/Function;
 
 
+# instance fields
+.field public final synthetic $r8$classId:I
+
+.field public final synthetic f$0:I
+
+
+# direct methods
+.method public synthetic constructor <init>(II)V
+    .locals 0
+
+    iput p2, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;->$r8$classId:I
+
+    iput p1, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;->f$0:I
+
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+
+    return-void
+.end method
+
+
 # virtual methods
 .method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 2
+    .locals 3
+
+    const/4 v0, 0x0
+
+    iget v1, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;->$r8$classId:I
+
+    iget p0, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;->f$0:I
 
     check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
 
-    sget-object p0, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
+    packed-switch v1, :pswitch_data_0
+
+    sget-object v1, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
 
     :try_start_0
-    new-instance p0, Lcom/samsung/android/knox/ContextInfo;
+    new-instance v1, Lcom/samsung/android/knox/ContextInfo;
 
     invoke-static {}, Landroid/os/Binder;->getCallingUid()I
 
-    move-result v0
-
-    const/4 v1, 0x0
+    move-result v2
 
-    invoke-direct {p0, v0, v1}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
+    invoke-direct {v1, v2, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
 
-    invoke-interface {p1, p0}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
+    invoke-interface {p1, v1}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
 
-    move-result-object p0
+    move-result-object v0
     :try_end_0
     .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
 
-    return-object p0
+    goto :goto_0
 
     :catch_0
     move-exception p0
 
     invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
 
-    const/4 p0, 0x0
+    :goto_0
+    return-object v0
+
+    :pswitch_0
+    sget-object v1, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
+
+    :try_start_1
+    new-instance v1, Lcom/samsung/android/knox/ContextInfo;
+
+    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
+
+    move-result v2
+
+    invoke-direct {v1, v2, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
+
+    invoke-interface {p1, v1}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
+
+    move-result-object v0
+    :try_end_1
+    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1
+
+    goto :goto_1
+
+    :catch_1
+    move-exception p0
+
+    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
+
+    :goto_1
+    return-object v0
+
+    :pswitch_1
+    sget-object v1, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
+
+    :try_start_2
+    new-instance v1, Lcom/samsung/android/knox/ContextInfo;
 
+    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
+
+    move-result v2
+
+    invoke-direct {v1, v2, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
+
+    invoke-interface {p1, v1}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
+
+    move-result-object v0
+    :try_end_2
+    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_2
+
+    goto :goto_2
+
+    :catch_2
+    move-exception p0
+
+    new-instance p1, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v1, "isDERestrictionEnforced exception "
+
+    invoke-direct {p1, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {p0}, Landroid/os/RemoteException;->getMessage()Ljava/lang/String;
+
+    move-result-object p0
+
+    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object p0
+
+    const-string/jumbo p1, "PersonaServiceHelper"
+
+    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    :goto_2
+    if-eqz v0, :cond_0
+
+    const-string/jumbo p0, "dualdar-config-de-restriction"
+
+    const/4 p1, 0x1
+
+    invoke-virtual {v0, p0, p1}, Landroid/os/Bundle;->getBoolean(Ljava/lang/String;Z)Z
+
+    move-result p0
+
+    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+
+    move-result-object p0
+
+    goto :goto_3
+
+    :cond_0
+    sget-object p0, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
+
+    :goto_3
     return-object p0
+
+    :pswitch_data_0
+    .packed-switch 0x0
+        :pswitch_1
+        :pswitch_0
+    .end packed-switch
 .end method
diff --git a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1.smali b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1.smali
deleted file mode 100644
index fb4cdc53b..000000000
--- a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1.smali
+++ /dev/null
@@ -1,24 +0,0 @@
-.class public final synthetic Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Ljava/util/function/Supplier;
-
-
-# virtual methods
-.method public final get()Ljava/lang/Object;
-    .locals 1
-
-    sget-object p0, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
-
-    const-string/jumbo p0, "checkPackageStartable failed to acquire dualDARPolicy for user: 0"
-
-    const-string/jumbo v0, "PersonaServiceHelper"
-
-    invoke-static {v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
diff --git a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2.smali b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2.smali
index e65da2cba..be8f6e173 100644
--- a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2.smali
+++ b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2.smali
@@ -3,7 +3,7 @@
 .source "SourceFile"
 
 # interfaces
-.implements Ljava/util/function/Function;
+.implements Ljava/util/function/Supplier;
 
 
 # instance fields
@@ -27,143 +27,36 @@
 
 
 # virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 3
+.method public final get()Ljava/lang/Object;
+    .locals 4
 
     const/4 v0, 0x0
 
-    iget v1, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;->$r8$classId:I
+    const-string/jumbo v1, "PersonaServiceHelper"
 
-    iget p0, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;->f$0:I
-
-    check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    packed-switch v1, :pswitch_data_0
-
-    sget-object v1, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
-
-    :try_start_0
-    new-instance v1, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
+    const-string/jumbo v2, "checkPackageStartable failed to acquire dualDARPolicy for user: "
 
-    move-result v2
+    iget v3, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;->$r8$classId:I
 
-    invoke-direct {v1, v2, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
-
-    invoke-interface {p1, v1}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
-
-    move-result-object v0
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
+    iget p0, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;->f$0:I
 
-    goto :goto_0
+    packed-switch v3, :pswitch_data_0
 
-    :catch_0
-    move-exception p0
+    sget-object v3, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
 
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
+    invoke-static {p0, v2, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
 
-    :goto_0
     return-object v0
 
     :pswitch_0
-    sget-object v1, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
-
-    :try_start_1
-    new-instance v1, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v2
+    sget-object v3, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
 
-    invoke-direct {v1, v2, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
+    invoke-static {p0, v2, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
 
-    invoke-interface {p1, v1}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
-
-    move-result-object v0
-    :try_end_1
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1
-
-    goto :goto_1
-
-    :catch_1
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
-
-    :goto_1
     return-object v0
 
-    :pswitch_1
-    sget-object v1, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
-
-    :try_start_2
-    new-instance v1, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v2
-
-    invoke-direct {v1, v2, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
-
-    invoke-interface {p1, v1}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
-
-    move-result-object v0
-    :try_end_2
-    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_2
-
-    goto :goto_2
-
-    :catch_2
-    move-exception p0
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "isDERestrictionEnforced exception "
-
-    invoke-direct {p1, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->getMessage()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string/jumbo p1, "PersonaServiceHelper"
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_2
-    if-eqz v0, :cond_0
-
-    const-string/jumbo p0, "dualdar-config-de-restriction"
-
-    const/4 p1, 0x1
-
-    invoke-virtual {v0, p0, p1}, Landroid/os/Bundle;->getBoolean(Ljava/lang/String;Z)Z
-
-    move-result p0
-
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    goto :goto_3
-
-    :cond_0
-    sget-object p0, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;
-
-    :goto_3
-    return-object p0
-
     :pswitch_data_0
     .packed-switch 0x0
-        :pswitch_1
         :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3.smali b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3.smali
new file mode 100644
index 000000000..ab47c5e19
--- /dev/null
+++ b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3.smali
@@ -0,0 +1,44 @@
+.class public final synthetic Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3;
+.super Ljava/lang/Object;
+.source "SourceFile"
+
+# interfaces
+.implements Ljava/util/function/Function;
+
+
+# virtual methods
+.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
+    .locals 2
+
+    check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
+
+    sget-object p0, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
+
+    :try_start_0
+    new-instance p0, Lcom/samsung/android/knox/ContextInfo;
+
+    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
+
+    move-result v0
+
+    const/4 v1, 0x0
+
+    invoke-direct {p0, v0, v1}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
+
+    invoke-interface {p1, p0}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
+
+    move-result-object p0
+    :try_end_0
+    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
+
+    return-object p0
+
+    :catch_0
+    move-exception p0
+
+    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
+
+    const/4 p0, 0x0
+
+    return-object p0
+.end method
diff --git a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4.smali b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4.smali
index 979be6c47..ca737f39c 100644
--- a/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4.smali
+++ b/smali_classes2/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4.smali
@@ -6,57 +6,19 @@
 .implements Ljava/util/function/Supplier;
 
 
-# instance fields
-.field public final synthetic $r8$classId:I
-
-.field public final synthetic f$0:I
-
-
-# direct methods
-.method public synthetic constructor <init>(II)V
-    .locals 0
-
-    iput p2, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;->$r8$classId:I
-
-    iput p1, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;->f$0:I
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
 # virtual methods
 .method public final get()Ljava/lang/Object;
-    .locals 4
-
-    const/4 v0, 0x0
-
-    const-string/jumbo v1, "PersonaServiceHelper"
-
-    const-string/jumbo v2, "checkPackageStartable failed to acquire dualDARPolicy for user: "
-
-    iget v3, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;->$r8$classId:I
-
-    iget p0, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;->f$0:I
-
-    packed-switch v3, :pswitch_data_0
-
-    sget-object v3, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
+    .locals 1
 
-    invoke-static {p0, v2, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    sget-object p0, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
 
-    return-object v0
+    const-string/jumbo p0, "checkPackageStartable failed to acquire dualDARPolicy for user: 0"
 
-    :pswitch_0
-    sget-object v3, Lcom/android/server/pm/PersonaServiceHelper;->ALLOWED_BLUETOOTH_TARGET:Ljava/util/List;
+    const-string/jumbo v0, "PersonaServiceHelper"
 
-    invoke-static {p0, v2, v1}, Lcom/android/server/ExtendedEthernetServiceImpl$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+    invoke-static {v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    return-object v0
+    const/4 p0, 0x0
 
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
+    return-object p0
 .end method
diff --git a/smali_classes2/com/android/server/pm/PersonaServiceHelper.smali b/smali_classes2/com/android/server/pm/PersonaServiceHelper.smali
index 11a54387f..23bc06cbb 100644
--- a/smali_classes2/com/android/server/pm/PersonaServiceHelper.smali
+++ b/smali_classes2/com/android/server/pm/PersonaServiceHelper.smali
@@ -925,21 +925,21 @@
 
     move-result-object v0
 
-    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;
+    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;
 
     const/4 v2, 0x1
 
-    invoke-direct {v1, p2, v2}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;-><init>(II)V
+    invoke-direct {v1, p2, v2}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;-><init>(II)V
 
     invoke-virtual {v0, v1}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
     move-result-object v0
 
-    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;
+    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;
 
     const/4 v2, 0x0
 
-    invoke-direct {v1, p2, v2}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;-><init>(II)V
+    invoke-direct {v1, p2, v2}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;-><init>(II)V
 
     invoke-virtual {v0, v1}, Ljava/util/Optional;->orElseGet(Ljava/util/function/Supplier;)Ljava/lang/Object;
 
diff --git a/smali_classes2/com/android/server/pm/RemovePackageHelper.smali b/smali_classes2/com/android/server/pm/RemovePackageHelper.smali
index 32acb46cc..b05f26a9a 100644
--- a/smali_classes2/com/android/server/pm/RemovePackageHelper.smali
+++ b/smali_classes2/com/android/server/pm/RemovePackageHelper.smali
@@ -1342,99 +1342,7 @@
     invoke-virtual {p1}, Lcom/android/server/pm/SettingBase;->onChanged$2()V
 
     :cond_6
-    if-eqz p4, :cond_b
-
-    iget-boolean p2, p4, Lcom/android/server/pm/PackageRemovedInfo;->mIsUpdate:Z
-
-    const-string/jumbo p5, "PackageManager.SDP"
-
-    if-nez p2, :cond_7
-
-    iget-boolean p2, p4, Lcom/android/server/pm/PackageRemovedInfo;->mIsRemovedPackageSystemUpdate:Z
-
-    if-eqz p2, :cond_8
-
-    :cond_7
-    iget-boolean p2, p4, Lcom/android/server/pm/PackageRemovedInfo;->mDataRemoved:Z
-
-    if-nez p2, :cond_8
-
-    const-string/jumbo p2, "Skip removing package directory"
-
-    invoke-static {p5, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_4
-
-    :cond_8
-    const-string/jumbo p2, "Try removing package directory"
-
-    invoke-static {p5, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const-string/jumbo p2, "dar"
-
-    invoke-static {p2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object p2
-
-    check-cast p2, Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz p2, :cond_a
-
-    iget-object p2, p2, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    if-eqz p2, :cond_a
-
-    iget v3, p4, Lcom/android/server/pm/PackageRemovedInfo;->mUid:I
-
-    invoke-static {v3}, Landroid/os/UserHandle;->getUserId(I)I
-
-    move-result v3
-
-    iget-object v4, p4, Lcom/android/server/pm/PackageRemovedInfo;->mRemovedPackage:Ljava/lang/String;
-
-    invoke-virtual {p2, v3, v4}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isSdpPackage(ILjava/lang/String;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_a
-
-    iget p2, p4, Lcom/android/server/pm/PackageRemovedInfo;->mUid:I
-
-    invoke-static {p2}, Landroid/os/UserHandle;->getUserId(I)I
-
-    move-result p2
-
-    iget-object v3, p4, Lcom/android/server/pm/PackageRemovedInfo;->mRemovedPackage:Ljava/lang/String;
-
-    iget-object v4, p0, Lcom/android/server/pm/RemovePackageHelper;->mPm:Lcom/android/server/pm/PackageManagerService;
-
-    invoke-virtual {v4, p2, v3}, Lcom/android/server/pm/PackageManagerService;->removeEncPkgDir(ILjava/lang/String;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_9
-
-    const-string/jumbo p2, "Successfully removed Sdp package directory!"
-
-    invoke-static {p5, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_4
-
-    :cond_9
-    const-string p2, "Failed to removed Sdp package directory..."
-
-    invoke-static {p5, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_4
-
-    :cond_a
-    const-string/jumbo p2, "not Sdp package..."
-
-    invoke-static {p5, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_b
-    :goto_4
-    if-eqz v1, :cond_14
+    if-eqz v1, :cond_f
 
     new-instance p2, Landroid/util/SparseBooleanArray;
 
@@ -1471,7 +1379,7 @@
 
     move-result p5
 
-    if-nez p5, :cond_12
+    if-nez p5, :cond_d
 
     iget-object p5, p0, Lcom/android/server/pm/RemovePackageHelper;->mPm:Lcom/android/server/pm/PackageManagerService;
 
@@ -1481,30 +1389,30 @@
 
     move-result-object p5
 
-    if-eqz p5, :cond_c
+    if-eqz p5, :cond_7
 
     invoke-virtual {p5}, Lcom/android/server/pm/SharedUserSetting;->getPackages()Ljava/util/List;
 
     move-result-object v1
 
-    :goto_5
+    :goto_4
     move-object v6, v1
 
-    goto :goto_6
+    goto :goto_5
 
     :catchall_0
     move-exception v0
 
     move-object p0, v0
 
-    goto/16 :goto_a
+    goto/16 :goto_9
 
-    :cond_c
+    :cond_7
     sget-object v1, Ljava/util/Collections;->EMPTY_LIST:Ljava/util/List;
 
-    goto :goto_5
+    goto :goto_4
 
-    :goto_6
+    :goto_5
     iget-object v1, p0, Lcom/android/server/pm/RemovePackageHelper;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerService$PermissionManagerServiceInternalImpl;
 
     iget v3, p1, Lcom/android/server/pm/PackageSetting;->mAppId:I
@@ -1515,7 +1423,7 @@
 
     invoke-virtual/range {v1 .. v7}, Lcom/android/server/pm/permission/PermissionManagerService$PermissionManagerServiceInternalImpl;->onPackageUninstalled(Ljava/lang/String;ILcom/android/server/pm/PackageSetting;Lcom/android/server/pm/pkg/AndroidPackage;Ljava/util/List;I)V
 
-    if-eqz p5, :cond_13
+    if-eqz p5, :cond_e
 
     iget-object p1, p0, Lcom/android/server/pm/RemovePackageHelper;->mPm:Lcom/android/server/pm/PackageManagerService;
 
@@ -1531,15 +1439,15 @@
 
     move-result p1
 
-    if-eq p1, v0, :cond_e
+    if-eq p1, v0, :cond_9
 
-    :cond_d
-    :goto_7
+    :cond_8
+    :goto_6
     move p1, v8
 
-    goto :goto_8
+    goto :goto_7
 
-    :cond_e
+    :cond_9
     iget-object p1, p5, Lcom/android/server/pm/SharedUserSetting;->mDisabledPackages:Lcom/android/server/utils/WatchedArraySet;
 
     iget-object v1, p1, Lcom/android/server/utils/WatchedArraySet;->mStorage:Landroid/util/ArraySet;
@@ -1548,18 +1456,18 @@
 
     move-result v1
 
-    if-le v1, v0, :cond_f
+    if-le v1, v0, :cond_a
 
-    goto :goto_7
+    goto :goto_6
 
-    :cond_f
+    :cond_a
     iget-object v1, p1, Lcom/android/server/utils/WatchedArraySet;->mStorage:Landroid/util/ArraySet;
 
     invoke-virtual {v1}, Landroid/util/ArraySet;->size()I
 
     move-result v1
 
-    if-ne v1, v0, :cond_10
+    if-ne v1, v0, :cond_b
 
     iget-object p1, p1, Lcom/android/server/utils/WatchedArraySet;->mStorage:Landroid/util/ArraySet;
 
@@ -1571,23 +1479,23 @@
 
     iget-object p1, p1, Lcom/android/server/pm/PackageSetting;->pkg:Lcom/android/internal/pm/parsing/pkg/AndroidPackageInternal;
 
-    if-eqz p1, :cond_d
+    if-eqz p1, :cond_8
 
     invoke-interface {p1}, Lcom/android/server/pm/pkg/AndroidPackage;->isLeavingSharedUser()Z
 
     move-result p1
 
-    if-eqz p1, :cond_d
+    if-eqz p1, :cond_8
 
-    :cond_10
+    :cond_b
     move p1, v0
 
-    :goto_8
-    if-nez p1, :cond_11
+    :goto_7
+    if-nez p1, :cond_c
 
-    goto :goto_9
+    goto :goto_8
 
-    :cond_11
+    :cond_c
     iget-object p1, p5, Lcom/android/server/pm/SharedUserSetting;->mPackages:Lcom/android/server/utils/WatchedArraySet;
 
     iget-object p1, p1, Lcom/android/server/utils/WatchedArraySet;->mStorage:Landroid/util/ArraySet;
@@ -1600,17 +1508,17 @@
 
     iget-object p1, p1, Lcom/android/server/pm/PackageSetting;->pkg:Lcom/android/internal/pm/parsing/pkg/AndroidPackageInternal;
 
-    if-eqz p1, :cond_13
+    if-eqz p1, :cond_e
 
     invoke-interface {p1}, Lcom/android/server/pm/pkg/AndroidPackage;->isLeavingSharedUser()Z
 
-    goto :goto_9
+    goto :goto_8
 
-    :cond_12
+    :cond_d
     move-object v4, p1
 
-    :cond_13
-    :goto_9
+    :cond_e
+    :goto_8
     iget-object p1, p0, Lcom/android/server/pm/RemovePackageHelper;->mPm:Lcom/android/server/pm/PackageManagerService;
 
     iget-object p1, p1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;
@@ -1623,9 +1531,9 @@
 
     monitor-exit p2
 
-    goto/16 :goto_d
+    goto/16 :goto_c
 
-    :goto_a
+    :goto_9
     monitor-exit p2
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
@@ -1634,28 +1542,28 @@
 
     throw p0
 
-    :cond_14
+    :cond_f
     move-object v4, p1
 
     invoke-virtual {v4}, Lcom/android/server/pm/PackageSetting;->isSystem()Z
 
     move-result p1
 
-    if-nez p1, :cond_17
+    if-nez p1, :cond_12
 
     iget-boolean p1, p4, Lcom/android/server/pm/PackageRemovedInfo;->mIsUpdate:Z
 
-    if-nez p1, :cond_17
+    if-nez p1, :cond_12
 
     iget-object p1, p4, Lcom/android/server/pm/PackageRemovedInfo;->mRemovedUsers:[I
 
-    if-eqz p1, :cond_17
+    if-eqz p1, :cond_12
 
     invoke-virtual {v4}, Lcom/android/server/pm/PackageSetting;->isExternalStorage()Z
 
     move-result p1
 
-    if-nez p1, :cond_17
+    if-nez p1, :cond_12
 
     invoke-static {}, Ljava/lang/System;->currentTimeMillis()J
 
@@ -1674,8 +1582,8 @@
 
     move v1, v8
 
-    :goto_b
-    if-ge v1, p5, :cond_15
+    :goto_a
+    if-ge v1, p5, :cond_10
 
     aget v2, p2, v1
 
@@ -1683,23 +1591,23 @@
 
     add-int/2addr v1, v0
 
-    goto :goto_b
+    goto :goto_a
 
     :catchall_1
     move-exception v0
 
     move-object p0, v0
 
-    goto :goto_c
+    goto :goto_b
 
-    :cond_15
-    if-eqz v5, :cond_16
+    :cond_10
+    if-eqz v5, :cond_11
 
     invoke-interface {v5}, Lcom/android/server/pm/pkg/AndroidPackage;->getSplitNames()[Ljava/lang/String;
 
     move-result-object p2
 
-    if-eqz p2, :cond_16
+    if-eqz p2, :cond_11
 
     invoke-interface {v5}, Lcom/android/server/pm/pkg/AndroidPackage;->getSplitNames()[Ljava/lang/String;
 
@@ -1717,20 +1625,20 @@
 
     invoke-virtual {v4}, Lcom/android/server/pm/SettingBase;->onChanged$2()V
 
-    :cond_16
+    :cond_11
     monitor-exit p1
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_1
 
     sget-boolean p1, Lcom/android/server/pm/PackageManagerService;->DEBUG_COMPRESSION:Z
 
-    if-eqz v5, :cond_17
+    if-eqz v5, :cond_12
 
     invoke-interface {v5}, Lcom/android/server/pm/pkg/AndroidPackage;->getSplitNames()[Ljava/lang/String;
 
     move-result-object p1
 
-    if-eqz p1, :cond_17
+    if-eqz p1, :cond_12
 
     invoke-interface {v5}, Lcom/android/server/pm/pkg/AndroidPackage;->getSplitNames()[Ljava/lang/String;
 
@@ -1748,9 +1656,9 @@
 
     invoke-virtual {v4}, Lcom/android/server/pm/SettingBase;->onChanged$2()V
 
-    goto :goto_d
+    goto :goto_c
 
-    :goto_c
+    :goto_b
     :try_start_2
     monitor-exit p1
     :try_end_2
@@ -1760,17 +1668,17 @@
 
     throw p0
 
-    :cond_17
-    :goto_d
+    :cond_12
+    :goto_c
     iget-object p1, p4, Lcom/android/server/pm/PackageRemovedInfo;->mOrigUsers:[I
 
-    if-eqz p1, :cond_1b
+    if-eqz p1, :cond_16
 
     invoke-virtual {v4}, Lcom/android/server/pm/PackageSetting;->isSystem()Z
 
     move-result p1
 
-    if-eqz p1, :cond_1b
+    if-eqz p1, :cond_16
 
     iget-object p1, p0, Lcom/android/server/pm/RemovePackageHelper;->mPm:Lcom/android/server/pm/PackageManagerService;
 
@@ -1787,8 +1695,8 @@
 
     move v1, p5
 
-    :goto_e
-    if-ge p5, p2, :cond_1a
+    :goto_d
+    if-ge p5, p2, :cond_15
 
     aget v2, p3, p5
 
@@ -1802,42 +1710,42 @@
 
     move-result v5
 
-    if-eq v3, v5, :cond_18
+    if-eq v3, v5, :cond_13
 
     move v1, v0
 
-    :cond_18
+    :cond_13
     invoke-virtual {v4, v2, v3}, Lcom/android/server/pm/PackageSetting;->setInstalled(IZ)V
 
-    if-eqz v3, :cond_19
+    if-eqz v3, :cond_14
 
     invoke-virtual {v4, v8, v2}, Lcom/android/server/pm/PackageSetting;->setUninstallReason(II)V
 
-    goto :goto_f
+    goto :goto_e
 
     :catchall_2
     move-exception v0
 
     move-object p0, v0
 
-    goto :goto_10
+    goto :goto_f
 
-    :cond_19
-    :goto_f
+    :cond_14
+    :goto_e
     add-int/2addr p5, v0
 
-    goto :goto_e
+    goto :goto_d
 
-    :cond_1a
+    :cond_15
     monitor-exit p1
     :try_end_3
     .catchall {:try_start_3 .. :try_end_3} :catchall_2
 
     sget-boolean p1, Lcom/android/server/pm/PackageManagerService;->DEBUG_COMPRESSION:Z
 
-    goto :goto_11
+    goto :goto_10
 
-    :goto_10
+    :goto_f
     :try_start_4
     monitor-exit p1
     :try_end_4
@@ -1847,10 +1755,10 @@
 
     throw p0
 
-    :cond_1b
+    :cond_16
     move v1, v8
 
-    :goto_11
+    :goto_10
     iget-object p1, p0, Lcom/android/server/pm/RemovePackageHelper;->mPm:Lcom/android/server/pm/PackageManagerService;
 
     iget-object p1, p1, Lcom/android/server/pm/PackageManagerService;->mLock:Lcom/android/server/pm/PackageManagerTracedLock;
@@ -1859,25 +1767,25 @@
 
     monitor-enter p1
 
-    if-eqz p6, :cond_1c
+    if-eqz p6, :cond_17
 
     :try_start_5
     iget-object p2, p0, Lcom/android/server/pm/RemovePackageHelper;->mPm:Lcom/android/server/pm/PackageManagerService;
 
     invoke-virtual {p2, v8}, Lcom/android/server/pm/PackageManagerService;->writeSettingsLPrTEMP(Z)V
 
-    goto :goto_12
+    goto :goto_11
 
     :catchall_3
     move-exception v0
 
     move-object p0, v0
 
-    goto :goto_13
+    goto :goto_12
 
-    :cond_1c
-    :goto_12
-    if-eqz v1, :cond_1d
+    :cond_17
+    :goto_11
+    if-eqz v1, :cond_18
 
     iget-object p0, p0, Lcom/android/server/pm/RemovePackageHelper;->mPm:Lcom/android/server/pm/PackageManagerService;
 
@@ -1885,12 +1793,12 @@
 
     invoke-virtual {p0, v4}, Lcom/android/server/pm/Settings;->writeKernelMappingLPr(Lcom/android/server/pm/PackageSetting;)V
 
-    :cond_1d
+    :cond_18
     monitor-exit p1
 
     return-void
 
-    :goto_13
+    :goto_12
     monitor-exit p1
     :try_end_5
     .catchall {:try_start_5 .. :try_end_5} :catchall_3
diff --git a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda11.smali b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda11.smali
deleted file mode 100644
index 867f3be3e..000000000
--- a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda11.smali
+++ /dev/null
@@ -1,36 +0,0 @@
-.class public final synthetic Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda11;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Landroid/app/StatsManager$StatsPullAtomCallback;
-
-
-# instance fields
-.field public final synthetic f$0:Lcom/android/server/pm/UserManagerService;
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/pm/UserManagerService;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda11;->f$0:Lcom/android/server/pm/UserManagerService;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final onPullAtom(ILjava/util/List;)I
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda11;->f$0:Lcom/android/server/pm/UserManagerService;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/pm/UserManagerService;->$r8$lambda$yIybRUvnMFarqB2JHfYXkMUsauk(Lcom/android/server/pm/UserManagerService;ILjava/util/List;)I
-
-    move-result p0
-
-    return p0
-.end method
diff --git a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda2.smali b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda2.smali
index 8de3fa20e..b60e2ffc7 100644
--- a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda2.smali
+++ b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda2.smali
@@ -3,36 +3,88 @@
 .source "SourceFile"
 
 # interfaces
-.implements Ljava/util/function/Consumer;
+.implements Ljava/lang/Runnable;
 
 
 # instance fields
-.field public final synthetic f$0:I
+.field public final synthetic f$0:Ljava/lang/String;
+
+.field public final synthetic f$1:Z
+
+.field public final synthetic f$2:I
+
+.field public final synthetic f$3:I
+
+.field public final synthetic f$4:Ljava/lang/String;
 
 
 # direct methods
-.method public synthetic constructor <init>(I)V
+.method public synthetic constructor <init>(Ljava/lang/String;IZILjava/lang/String;)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;->f$0:I
+    iput-object p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;->f$0:Ljava/lang/String;
+
+    iput-boolean p3, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;->f$1:Z
+
+    iput p2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;->f$2:I
+
+    iput p4, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;->f$3:I
+
+    iput-object p5, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;->f$4:Ljava/lang/String;
 
     return-void
 .end method
 
 
 # virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 1
+.method public final run()V
+    .locals 6
+
+    iget-object v0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;->f$0:Ljava/lang/String;
+
+    iget-boolean v1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;->f$1:Z
+
+    iget v2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;->f$2:I
+
+    iget v3, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;->f$3:I
+
+    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;->f$4:Ljava/lang/String;
+
+    sget-object v4, Lcom/android/server/pm/UserManagerService;->USER_INFO_DIR:Ljava/lang/String;
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v5, "Updated restriction "
+
+    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    const-string v0, "("
+
+    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+
+    const-string v0, ") for User "
+
+    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    const-string v0, ", callingUid: "
+
+    const-string v1, ", stack: "
+
+    invoke-static {v2, v3, v0, v1, v4}, Lcom/android/server/ServiceKeeper$$ExternalSyntheticOutline0;->m(IILjava/lang/String;Ljava/lang/String;Ljava/lang/StringBuilder;)V
 
-    iget p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;->f$0:I
+    invoke-virtual {v4, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    sget-object v0, Lcom/android/server/pm/UserManagerService;->USER_INFO_DIR:Ljava/lang/String;
+    move-result-object p0
 
-    invoke-virtual {p1, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->welcomeNewUser(I)V
+    invoke-static {p0}, Lcom/samsung/android/server/pm/PmLog;->logDebugInfo(Ljava/lang/String;)V
 
     return-void
 .end method
diff --git a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda3.smali b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda3.smali
index 08f648840..7bc319938 100644
--- a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda3.smali
+++ b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda3.smali
@@ -3,88 +3,32 @@
 .source "SourceFile"
 
 # interfaces
-.implements Ljava/lang/Runnable;
+.implements Landroid/app/KeyguardManager$KeyguardLockedStateListener;
 
 
 # instance fields
-.field public final synthetic f$0:Ljava/lang/String;
-
-.field public final synthetic f$1:Z
-
-.field public final synthetic f$2:I
-
-.field public final synthetic f$3:I
-
-.field public final synthetic f$4:Ljava/lang/String;
+.field public final synthetic f$0:Lcom/android/server/pm/UserManagerService;
 
 
 # direct methods
-.method public synthetic constructor <init>(Ljava/lang/String;IZILjava/lang/String;)V
+.method public synthetic constructor <init>(Lcom/android/server/pm/UserManagerService;)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;->f$0:Ljava/lang/String;
-
-    iput-boolean p3, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;->f$1:Z
-
-    iput p2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;->f$2:I
-
-    iput p4, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;->f$3:I
-
-    iput-object p5, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;->f$4:Ljava/lang/String;
+    iput-object p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;->f$0:Lcom/android/server/pm/UserManagerService;
 
     return-void
 .end method
 
 
 # virtual methods
-.method public final run()V
-    .locals 6
-
-    iget-object v0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;->f$0:Ljava/lang/String;
-
-    iget-boolean v1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;->f$1:Z
-
-    iget v2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;->f$2:I
-
-    iget v3, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;->f$3:I
-
-    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;->f$4:Ljava/lang/String;
-
-    sget-object v4, Lcom/android/server/pm/UserManagerService;->USER_INFO_DIR:Ljava/lang/String;
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v5, "Updated restriction "
-
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v0, "("
-
-    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string v0, ") for User "
-
-    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v0, ", callingUid: "
-
-    const-string v1, ", stack: "
-
-    invoke-static {v2, v3, v0, v1, v4}, Lcom/android/server/ServiceKeeper$$ExternalSyntheticOutline0;->m(IILjava/lang/String;Ljava/lang/String;Ljava/lang/StringBuilder;)V
-
-    invoke-virtual {v4, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+.method public final onKeyguardLockedStateChanged(Z)V
+    .locals 0
 
-    move-result-object p0
+    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;->f$0:Lcom/android/server/pm/UserManagerService;
 
-    invoke-static {p0}, Lcom/samsung/android/server/pm/PmLog;->logDebugInfo(Ljava/lang/String;)V
+    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->tryAutoLockingPrivateSpaceOnKeyguardChanged(Z)V
 
     return-void
 .end method
diff --git a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda4.smali b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda4.smali
index f8ff8f37e..03f2fdb2e 100644
--- a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda4.smali
+++ b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda4.smali
@@ -3,32 +3,53 @@
 .source "SourceFile"
 
 # interfaces
-.implements Landroid/app/KeyguardManager$KeyguardLockedStateListener;
+.implements Lcom/android/server/pm/ResilientAtomicFile$ReadEventLogger;
 
 
 # instance fields
 .field public final synthetic f$0:Lcom/android/server/pm/UserManagerService;
 
+.field public final synthetic f$1:I
+
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/pm/UserManagerService;)V
+.method public synthetic constructor <init>(Lcom/android/server/pm/UserManagerService;I)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
     iput-object p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/pm/UserManagerService;
 
+    iput p2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;->f$1:I
+
     return-void
 .end method
 
 
 # virtual methods
-.method public final onKeyguardLockedStateChanged(Z)V
-    .locals 0
+.method public final logEvent(ILjava/lang/String;)V
+    .locals 1
+
+    sget-object p1, Lcom/android/server/pm/UserManagerService;->USER_INFO_DIR:Ljava/lang/String;
+
+    iget-object p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/pm/UserManagerService;
+
+    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    const-string/jumbo v0, "UserManagerService"
+
+    invoke-static {v0, p2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+
+    iget p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;->f$1:I
+
+    invoke-virtual {p1, p0}, Lcom/android/server/pm/UserManagerService;->getUserDataNoChecks(I)Lcom/android/server/pm/UserManagerService$UserData;
+
+    move-result-object p2
 
-    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/pm/UserManagerService;
+    if-eqz p2, :cond_0
 
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->tryAutoLockingPrivateSpaceOnKeyguardChanged(Z)V
+    invoke-virtual {p1, p0}, Lcom/android/server/pm/UserManagerService;->scheduleWriteUser(I)V
 
+    :cond_0
     return-void
 .end method
diff --git a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda5.smali b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda5.smali
index d0bbcd3a4..681bba185 100644
--- a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda5.smali
+++ b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda5.smali
@@ -3,7 +3,7 @@
 .source "SourceFile"
 
 # interfaces
-.implements Lcom/android/server/pm/ResilientAtomicFile$ReadEventLogger;
+.implements Ljava/lang/Runnable;
 
 
 # instance fields
@@ -11,9 +11,15 @@
 
 .field public final synthetic f$1:I
 
+.field public final synthetic f$2:Z
+
+.field public final synthetic f$3:Landroid/content/IntentSender;
+
+.field public final synthetic f$4:Ljava/lang/String;
+
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/pm/UserManagerService;I)V
+.method public synthetic constructor <init>(Lcom/android/server/pm/UserManagerService;IZLandroid/content/IntentSender;Ljava/lang/String;)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
@@ -22,34 +28,33 @@
 
     iput p2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;->f$1:I
 
-    return-void
-.end method
+    iput-boolean p3, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;->f$2:Z
 
+    iput-object p4, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;->f$3:Landroid/content/IntentSender;
 
-# virtual methods
-.method public final logEvent(ILjava/lang/String;)V
-    .locals 1
+    iput-object p5, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;->f$4:Ljava/lang/String;
 
-    sget-object p1, Lcom/android/server/pm/UserManagerService;->USER_INFO_DIR:Ljava/lang/String;
+    return-void
+.end method
 
-    iget-object p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;->f$0:Lcom/android/server/pm/UserManagerService;
 
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+# virtual methods
+.method public final run()V
+    .locals 5
 
-    const-string/jumbo v0, "UserManagerService"
+    iget-object v0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;->f$0:Lcom/android/server/pm/UserManagerService;
 
-    invoke-static {v0, p2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    iget v1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;->f$1:I
 
-    iget p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;->f$1:I
+    iget-boolean v2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;->f$2:Z
 
-    invoke-virtual {p1, p0}, Lcom/android/server/pm/UserManagerService;->getUserDataNoChecks(I)Lcom/android/server/pm/UserManagerService$UserData;
+    iget-object v3, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;->f$3:Landroid/content/IntentSender;
 
-    move-result-object p2
+    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;->f$4:Ljava/lang/String;
 
-    if-eqz p2, :cond_0
+    sget-object v4, Lcom/android/server/pm/UserManagerService;->USER_INFO_DIR:Ljava/lang/String;
 
-    invoke-virtual {p1, p0}, Lcom/android/server/pm/UserManagerService;->scheduleWriteUser(I)V
+    invoke-virtual {v0, v1, v2, v3, p0}, Lcom/android/server/pm/UserManagerService;->setQuietModeEnabled(IZLandroid/content/IntentSender;Ljava/lang/String;)V
 
-    :cond_0
     return-void
 .end method
diff --git a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda6.smali b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda6.smali
index 299dd9c08..cb5c00141 100644
--- a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda6.smali
+++ b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda6.smali
@@ -3,58 +3,82 @@
 .source "SourceFile"
 
 # interfaces
-.implements Ljava/lang/Runnable;
+.implements Lcom/android/internal/util/FunctionalUtils$ThrowingSupplier;
 
 
 # instance fields
 .field public final synthetic f$0:Lcom/android/server/pm/UserManagerService;
 
-.field public final synthetic f$1:I
+.field public final synthetic f$1:Landroid/accounts/Account;
 
-.field public final synthetic f$2:Z
+.field public final synthetic f$2:Ljava/lang/String;
 
-.field public final synthetic f$3:Landroid/content/IntentSender;
-
-.field public final synthetic f$4:Ljava/lang/String;
+.field public final synthetic f$3:Ljava/lang/String;
 
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/pm/UserManagerService;IZLandroid/content/IntentSender;Ljava/lang/String;)V
+.method public synthetic constructor <init>(Lcom/android/server/pm/UserManagerService;Landroid/accounts/Account;Ljava/lang/String;Ljava/lang/String;)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
     iput-object p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/pm/UserManagerService;
 
-    iput p2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$1:I
-
-    iput-boolean p3, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$2:Z
+    iput-object p2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$1:Landroid/accounts/Account;
 
-    iput-object p4, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$3:Landroid/content/IntentSender;
+    iput-object p3, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$2:Ljava/lang/String;
 
-    iput-object p5, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$4:Ljava/lang/String;
+    iput-object p4, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$3:Ljava/lang/String;
 
     return-void
 .end method
 
 
 # virtual methods
-.method public final run()V
-    .locals 5
+.method public final getOrThrow()Ljava/lang/Object;
+    .locals 4
 
     iget-object v0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/pm/UserManagerService;
 
-    iget v1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$1:I
+    iget-object v1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$1:Landroid/accounts/Account;
 
-    iget-boolean v2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$2:Z
+    iget-object v2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$2:Ljava/lang/String;
 
-    iget-object v3, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$3:Landroid/content/IntentSender;
+    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$3:Ljava/lang/String;
 
-    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;->f$4:Ljava/lang/String;
+    iget-object v3, v0, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
 
-    sget-object v4, Lcom/android/server/pm/UserManagerService;->USER_INFO_DIR:Ljava/lang/String;
+    invoke-static {v3}, Landroid/accounts/AccountManager;->get(Landroid/content/Context;)Landroid/accounts/AccountManager;
 
-    invoke-virtual {v0, v1, v2, v3, p0}, Lcom/android/server/pm/UserManagerService;->setQuietModeEnabled(IZLandroid/content/IntentSender;Ljava/lang/String;)V
+    move-result-object v3
 
-    return-void
+    invoke-virtual {v3, v1}, Landroid/accounts/AccountManager;->someUserHasAccount(Landroid/accounts/Account;)Z
+
+    move-result v1
+
+    if-nez v1, :cond_1
+
+    invoke-virtual {v0, v2, p0}, Lcom/android/server/pm/UserManagerService;->someUserHasSeedAccountNoChecks(Ljava/lang/String;Ljava/lang/String;)Z
+
+    move-result p0
+
+    if-eqz p0, :cond_0
+
+    goto :goto_0
+
+    :cond_0
+    const/4 p0, 0x0
+
+    goto :goto_1
+
+    :cond_1
+    :goto_0
+    const/4 p0, 0x1
+
+    :goto_1
+    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+
+    move-result-object p0
+
+    return-object p0
 .end method
diff --git a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda7.smali b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda7.smali
deleted file mode 100644
index a327f400c..000000000
--- a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda7.smali
+++ /dev/null
@@ -1,84 +0,0 @@
-.class public final synthetic Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda7;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Lcom/android/internal/util/FunctionalUtils$ThrowingSupplier;
-
-
-# instance fields
-.field public final synthetic f$0:Lcom/android/server/pm/UserManagerService;
-
-.field public final synthetic f$1:Landroid/accounts/Account;
-
-.field public final synthetic f$2:Ljava/lang/String;
-
-.field public final synthetic f$3:Ljava/lang/String;
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/pm/UserManagerService;Landroid/accounts/Account;Ljava/lang/String;Ljava/lang/String;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/pm/UserManagerService;
-
-    iput-object p2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda7;->f$1:Landroid/accounts/Account;
-
-    iput-object p3, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda7;->f$2:Ljava/lang/String;
-
-    iput-object p4, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda7;->f$3:Ljava/lang/String;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final getOrThrow()Ljava/lang/Object;
-    .locals 4
-
-    iget-object v0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/pm/UserManagerService;
-
-    iget-object v1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda7;->f$1:Landroid/accounts/Account;
-
-    iget-object v2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda7;->f$2:Ljava/lang/String;
-
-    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda7;->f$3:Ljava/lang/String;
-
-    iget-object v3, v0, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v3}, Landroid/accounts/AccountManager;->get(Landroid/content/Context;)Landroid/accounts/AccountManager;
-
-    move-result-object v3
-
-    invoke-virtual {v3, v1}, Landroid/accounts/AccountManager;->someUserHasAccount(Landroid/accounts/Account;)Z
-
-    move-result v1
-
-    if-nez v1, :cond_1
-
-    invoke-virtual {v0, v2, p0}, Lcom/android/server/pm/UserManagerService;->someUserHasSeedAccountNoChecks(Ljava/lang/String;Ljava/lang/String;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    goto :goto_1
-
-    :cond_1
-    :goto_0
-    const/4 p0, 0x1
-
-    :goto_1
-    invoke-static {p0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-.end method
diff --git a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda10.smali b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda8.smali
similarity index 82%
rename from smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda10.smali
rename to smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda8.smali
index 21bf724b1..b505391d1 100644
--- a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda10.smali
+++ b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda8.smali
@@ -1,4 +1,4 @@
-.class public final synthetic Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda10;
+.class public final synthetic Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda8;
 .super Ljava/lang/Object;
 .source "SourceFile"
 
@@ -20,11 +20,11 @@
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda10;->f$0:Lcom/android/server/pm/UserManagerService;
+    iput-object p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/pm/UserManagerService;
 
-    iput-object p2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda10;->f$1:Landroid/content/pm/UserInfo;
+    iput-object p2, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda8;->f$1:Landroid/content/pm/UserInfo;
 
-    iput-object p3, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda10;->f$2:Ljava/lang/Object;
+    iput-object p3, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda8;->f$2:Ljava/lang/Object;
 
     return-void
 .end method
@@ -34,11 +34,11 @@
 .method public final runOrThrow()V
     .locals 5
 
-    iget-object v0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda10;->f$0:Lcom/android/server/pm/UserManagerService;
+    iget-object v0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/pm/UserManagerService;
 
-    iget-object v1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda10;->f$1:Landroid/content/pm/UserInfo;
+    iget-object v1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda8;->f$1:Landroid/content/pm/UserInfo;
 
-    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda10;->f$2:Ljava/lang/Object;
+    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda8;->f$2:Ljava/lang/Object;
 
     iget-object v2, v0, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
 
diff --git a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda9.smali b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda9.smali
index 6b8f873b8..323349603 100644
--- a/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda9.smali
+++ b/smali_classes2/com/android/server/pm/UserManagerService$$ExternalSyntheticLambda9.smali
@@ -3,116 +3,34 @@
 .source "SourceFile"
 
 # interfaces
-.implements Ljava/util/function/Function;
+.implements Landroid/app/StatsManager$StatsPullAtomCallback;
 
 
 # instance fields
-.field public final synthetic f$0:I
+.field public final synthetic f$0:Lcom/android/server/pm/UserManagerService;
 
 
 # direct methods
-.method public synthetic constructor <init>(I)V
+.method public synthetic constructor <init>(Lcom/android/server/pm/UserManagerService;)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda9;->f$0:I
+    iput-object p1, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda9;->f$0:Lcom/android/server/pm/UserManagerService;
 
     return-void
 .end method
 
 
 # virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 2
-
-    iget p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda9;->f$0:I
-
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
-    sget-object v0, Lcom/android/server/pm/UserManagerService;->USER_INFO_DIR:Ljava/lang/String;
-
-    iget-object p1, p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;->this$0:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iget v0, p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mNeedToSetSdpPolicyForUser:I
-
-    const/4 v1, 0x1
-
-    if-eq p0, v0, :cond_0
-
-    goto :goto_1
-
-    :cond_0
-    const/16 v0, -0x2710
-
-    iput v0, p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mNeedToSetSdpPolicyForUser:I
-
-    invoke-virtual {p1, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->isUcmUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    const-string/jumbo p1, "Skip to set sdp policy for ucm user "
-
-    const/4 v0, 0x0
-
-    invoke-static {p0, p1, v0}, Lcom/android/server/enterprise/security/PasswordPolicy$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
-
-    goto :goto_1
-
-    :cond_1
-    iget-object p1, p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->mContext:Landroid/content/Context;
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/EnterprisePartitionManager;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/EnterprisePartitionManager;
-
-    move-result-object p1
-
-    iget-object p1, p1, Lcom/android/server/knox/dar/EnterprisePartitionManager;->mContext:Landroid/content/Context;
-
-    const-class v0, Landroid/os/storage/StorageManager;
-
-    invoke-virtual {p1, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Landroid/os/storage/StorageManager;
-
-    const/4 v0, 0x0
+.method public final onPullAtom(ILjava/util/List;)I
+    .locals 0
 
-    if-eqz p1, :cond_2
+    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda9;->f$0:Lcom/android/server/pm/UserManagerService;
 
-    invoke-virtual {p1, p0}, Landroid/os/storage/StorageManager;->setSdpPolicy(I)Z
+    invoke-static {p0, p1, p2}, Lcom/android/server/pm/UserManagerService;->$r8$lambda$yIybRUvnMFarqB2JHfYXkMUsauk(Lcom/android/server/pm/UserManagerService;ILjava/util/List;)I
 
     move-result p0
 
-    goto :goto_0
-
-    :cond_2
-    const-string p0, "EnterprisePartitionManager"
-
-    const-string/jumbo p1, "StorageManager instance is NULL"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    move p0, v0
-
-    :goto_0
-    if-nez p0, :cond_3
-
-    const-string/jumbo p0, "SdpManagerImpl"
-
-    const-string/jumbo p1, "setSdpPolicy failed!"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    move v1, v0
-
-    :cond_3
-    :goto_1
-    invoke-static {v1}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
+    return p0
 .end method
diff --git a/smali_classes2/com/android/server/pm/UserManagerService$LifeCycle.smali b/smali_classes2/com/android/server/pm/UserManagerService$LifeCycle.smali
index f8ba45c5d..795ca4924 100644
--- a/smali_classes2/com/android/server/pm/UserManagerService$LifeCycle.smali
+++ b/smali_classes2/com/android/server/pm/UserManagerService$LifeCycle.smali
@@ -347,9 +347,9 @@
 
     sget-object v0, Lcom/android/internal/util/ConcurrentUtils;->DIRECT_EXECUTOR:Ljava/util/concurrent/Executor;
 
-    new-instance v1, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda11;
+    new-instance v1, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda9;
 
-    invoke-direct {v1, p0}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda11;-><init>(Lcom/android/server/pm/UserManagerService;)V
+    invoke-direct {v1, p0}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/pm/UserManagerService;)V
 
     const/16 v2, 0x27a8
 
@@ -357,9 +357,9 @@
 
     invoke-virtual {p1, v2, v3, v0, v1}, Landroid/app/StatsManager;->setPullAtomCallback(ILandroid/app/StatsManager$PullAtomMetadata;Ljava/util/concurrent/Executor;Landroid/app/StatsManager$StatsPullAtomCallback;)V
 
-    new-instance v1, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda11;
+    new-instance v1, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda9;
 
-    invoke-direct {v1, p0}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda11;-><init>(Lcom/android/server/pm/UserManagerService;)V
+    invoke-direct {v1, p0}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/pm/UserManagerService;)V
 
     const/16 p0, 0x27b0
 
diff --git a/smali_classes2/com/android/server/pm/UserManagerService.smali b/smali_classes2/com/android/server/pm/UserManagerService.smali
index 0de93d74c..a92241e28 100644
--- a/smali_classes2/com/android/server/pm/UserManagerService.smali
+++ b/smali_classes2/com/android/server/pm/UserManagerService.smali
@@ -66,7 +66,7 @@
 
 .field public final mIsUserManaged:Landroid/util/SparseBooleanArray;
 
-.field public mKeyguardLockedStateListener:Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;
+.field public mKeyguardLockedStateListener:Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;
 
 .field public final mLastConfiguration:Landroid/content/res/Configuration;
 
@@ -96,10 +96,6 @@
 
 .field public final mRestrictionsLock:Ljava/lang/Object;
 
-.field public mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-.field public mSdpManagerInternal:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
 .field public final mSystemPackageInstaller:Lcom/android/server/pm/UserSystemPackageInstaller;
 
 .field public final mUpdatingSystemUserMode:Z
@@ -558,10 +554,6 @@
 
     iput-object v3, v0, Lcom/android/server/pm/UserManagerService;->mDarManagerService:Lcom/samsung/android/knox/dar/IDarManagerService;
 
-    iput-object v3, v0, Lcom/android/server/pm/UserManagerService;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iput-object v3, v0, Lcom/android/server/pm/UserManagerService;->mSdpManagerInternal:Lcom/android/server/knox/dar/sdp/SdpManagerImpl$SdpLocalService;
-
     new-instance v3, Ljava/util/concurrent/CountDownLatch;
 
     const/4 v5, 0x1
@@ -4644,9 +4636,9 @@
 
     invoke-virtual {p0}, Lcom/android/server/pm/UserManagerService;->updateUserIds()V
 
-    new-instance p1, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda10;
+    new-instance p1, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda8;
 
-    invoke-direct {p1, p0, v0, p2}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda10;-><init>(Lcom/android/server/pm/UserManagerService;Landroid/content/pm/UserInfo;Ljava/lang/Object;)V
+    invoke-direct {p1, p0, v0, p2}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/pm/UserManagerService;Landroid/content/pm/UserInfo;Ljava/lang/Object;)V
 
     invoke-static {p1}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V
 
@@ -5322,7 +5314,7 @@
 
     const/16 p1, 0x0
 
-    if-eqz v8, :cond_5b
+    if-eqz v8, :cond_59
 
     invoke-virtual {v0}, Ljava/lang/String;->intern()Ljava/lang/String;
 
@@ -5338,31 +5330,31 @@
 
     move-result v19
 
-    if-eqz v19, :cond_5a
+    if-eqz v19, :cond_58
 
     move-object/from16 v27, v10
 
     and-int/lit16 v10, v0, 0x800
 
-    if-nez v10, :cond_59
+    if-nez v10, :cond_57
 
     invoke-static {v8}, Lcom/android/server/pm/UserManagerService;->isUserTypeEnabled(Lcom/android/server/pm/UserTypeDetails;)Z
 
     move-result v10
 
-    if-eqz v10, :cond_58
+    move/from16 p2, v10
 
-    invoke-static {v9}, Lcom/samsung/android/core/pm/mm/MaintenanceModeUtils;->isUserTypeMaintenanceMode(Ljava/lang/String;)Z
+    if-eqz p2, :cond_56
 
-    move-result v10
+    invoke-static {v9}, Lcom/samsung/android/core/pm/mm/MaintenanceModeUtils;->isUserTypeMaintenanceMode(Ljava/lang/String;)Z
 
-    move/from16 p2, v10
+    move-result v28
 
     iget-object v10, v1, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
 
     monitor-enter v10
 
-    if-eqz p2, :cond_5
+    if-eqz v28, :cond_5
 
     :try_start_0
     iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
@@ -5373,7 +5365,7 @@
 
     move-result-object v4
 
-    move-object/from16 v28, v11
+    move-object/from16 v29, v11
 
     iget-boolean v11, v1, Lcom/android/server/pm/UserManagerService;->mForceEphemeralUsers:Z
 
@@ -5458,7 +5450,7 @@
     goto/16 :goto_38
 
     :cond_5
-    move-object/from16 v28, v11
+    move-object/from16 v29, v11
 
     move-object/from16 v19, v12
 
@@ -5568,7 +5560,7 @@
 
     if-nez v4, :cond_a
 
-    if-nez p2, :cond_a
+    if-nez v28, :cond_a
 
     invoke-virtual {v1, v0, v5, v9, v7}, Lcom/android/server/pm/UserManagerService;->convertPreCreatedUserIfPossible(ILjava/lang/Object;Ljava/lang/String;Ljava/lang/String;)Landroid/content/pm/UserInfo;
 
@@ -5592,7 +5584,7 @@
 
     move-result v4
 
-    if-nez v4, :cond_57
+    if-nez v4, :cond_55
 
     and-int/lit16 v4, v0, 0x4000
 
@@ -5626,7 +5618,7 @@
 
     invoke-static {v9}, Landroid/os/UserManager;->isUserTypeRestricted(Ljava/lang/String;)Z
 
-    move-result v29
+    move-result v30
 
     invoke-static {v9}, Landroid/os/UserManager;->isUserTypeDemo(Ljava/lang/String;)Z
 
@@ -5654,7 +5646,7 @@
     :goto_9
     invoke-static {v9}, Landroid/os/UserManager;->isUserTypeManagedProfile(Ljava/lang/String;)Z
 
-    move-result v30
+    move-result v31
 
     const/high16 v20, 0x20000
 
@@ -5686,7 +5678,7 @@
 
     move-result v0
 
-    move/from16 v31, v4
+    move/from16 v32, v4
 
     const/16 v4, 0x3e8
 
@@ -5699,7 +5691,7 @@
     :cond_10
     move/from16 v22, v0
 
-    move/from16 v31, v4
+    move/from16 v32, v4
 
     :cond_11
     const/4 v0, 0x0
@@ -5719,12 +5711,12 @@
 
     if-eqz v23, :cond_12
 
-    const/16 v32, 0x1
+    const/16 v33, 0x1
 
     goto :goto_c
 
     :cond_12
-    const/16 v32, 0x0
+    const/16 v33, 0x0
 
     :goto_c
     const/high16 v23, 0x2000000
@@ -5733,17 +5725,17 @@
 
     if-eqz v23, :cond_13
 
-    const/16 v33, 0x1
+    const/16 v34, 0x1
 
     goto :goto_d
 
     :cond_13
-    const/16 v33, 0x0
+    const/16 v34, 0x0
 
     :goto_d
-    if-nez v32, :cond_15
+    if-nez v33, :cond_15
 
-    if-eqz v33, :cond_14
+    if-eqz v34, :cond_14
 
     goto :goto_e
 
@@ -5757,7 +5749,7 @@
     const/16 v23, 0x1
 
     :goto_f
-    if-eqz v30, :cond_16
+    if-eqz v31, :cond_16
 
     if-eqz v10, :cond_17
 
@@ -5765,37 +5757,21 @@
     if-eqz v23, :cond_18
 
     :cond_17
-    const/16 v34, 0x1
+    const/16 v35, 0x1
 
     goto :goto_10
 
     :cond_18
-    const/16 v34, 0x0
-
-    :goto_10
-    if-eqz v30, :cond_19
-
-    if-nez v3, :cond_19
-
-    if-nez v23, :cond_19
-
-    if-nez v10, :cond_19
-
-    const/16 v35, 0x1
-
-    goto :goto_11
-
-    :cond_19
     const/16 v35, 0x0
 
-    :goto_11
-    if-eqz v3, :cond_1a
+    :goto_10
+    if-eqz v3, :cond_19
 
     const/high16 v23, 0x40000
 
     or-int v22, v22, v23
 
-    :cond_1a
+    :cond_19
     move/from16 v23, v4
 
     move/from16 v4, v22
@@ -5804,16 +5780,16 @@
 
     and-int v22, v4, v22
 
-    if-eqz v22, :cond_1b
+    if-eqz v22, :cond_1a
 
     const/16 v22, 0x1
 
-    goto :goto_12
+    goto :goto_11
 
-    :cond_1b
+    :cond_1a
     const/16 v22, 0x0
 
-    :goto_12
+    :goto_11
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
     move-result-wide v36
@@ -5831,7 +5807,7 @@
 
     const/16 v10, -0x2710
 
-    if-eq v2, v10, :cond_1d
+    if-eq v2, v10, :cond_1c
 
     :try_start_3
     iget-object v10, v1, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
@@ -5849,13 +5825,13 @@
     :try_end_4
     .catchall {:try_start_4 .. :try_end_4} :catchall_2
 
-    if-eqz v39, :cond_1c
+    if-eqz v39, :cond_1b
 
     move-object/from16 v6, v39
 
-    goto :goto_15
+    goto :goto_14
 
-    :cond_1c
+    :cond_1b
     :try_start_5
     new-instance v0, Ljava/lang/StringBuilder;
 
@@ -5875,10 +5851,10 @@
     :try_end_5
     .catchall {:try_start_5 .. :try_end_5} :catchall_1
 
-    :goto_13
+    :goto_12
     move-object/from16 v9, p1
 
-    :goto_14
+    :goto_13
     const/4 v12, 0x0
 
     goto/16 :goto_35
@@ -5886,7 +5862,7 @@
     :catchall_1
     move-exception v0
 
-    goto :goto_13
+    goto :goto_12
 
     :catchall_2
     move-exception v0
@@ -5899,11 +5875,11 @@
     :try_start_7
     throw v0
 
-    :cond_1d
+    :cond_1c
     move-object/from16 v6, p1
 
-    :goto_15
-    if-eqz v31, :cond_1f
+    :goto_14
+    if-eqz v32, :cond_1e
 
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getMainUserIdUnchecked()I
 
@@ -5913,11 +5889,11 @@
 
     const/16 v11, -0x2710
 
-    if-ne v10, v11, :cond_1e
+    if-ne v10, v11, :cond_1d
 
-    goto :goto_16
+    goto :goto_15
 
-    :cond_1e
+    :cond_1d
     const-string v0, "Cannot add user with FLAG_MAIN as main user already exists."
 
     const/4 v2, 0x6
@@ -5926,23 +5902,23 @@
 
     throw p1
 
-    :cond_1f
+    :cond_1e
     move/from16 v40, v11
 
-    :goto_16
-    if-nez p5, :cond_21
+    :goto_15
+    if-nez p5, :cond_20
 
     invoke-virtual {v1, v8}, Lcom/android/server/pm/UserManagerService;->canAddMoreUsersOfType(Lcom/android/server/pm/UserTypeDetails;)Z
 
     move-result v10
 
-    if-nez v10, :cond_21
+    if-nez v10, :cond_20
 
-    if-eqz p2, :cond_20
+    if-eqz v28, :cond_1f
 
-    goto :goto_17
+    goto :goto_16
 
-    :cond_20
+    :cond_1f
     new-instance v0, Ljava/lang/StringBuilder;
 
     invoke-direct {v0, v15}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
@@ -5963,33 +5939,33 @@
 
     throw p1
 
-    :cond_21
-    :goto_17
-    if-nez v12, :cond_23
+    :cond_20
+    :goto_16
+    if-nez v12, :cond_22
 
-    if-nez v30, :cond_23
+    if-nez v31, :cond_22
 
-    if-nez v21, :cond_23
+    if-nez v21, :cond_22
 
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->isUserLimitReached()Z
 
     move-result v10
 
-    if-eqz v10, :cond_23
+    if-eqz v10, :cond_22
 
-    if-nez p2, :cond_23
+    if-nez v28, :cond_22
 
-    if-nez v38, :cond_23
+    if-nez v38, :cond_22
 
-    if-nez v22, :cond_23
+    if-nez v22, :cond_22
 
-    if-nez p3, :cond_23
+    if-nez p3, :cond_22
 
-    if-eqz v0, :cond_22
+    if-eqz v0, :cond_21
 
-    goto :goto_18
+    goto :goto_17
 
-    :cond_22
+    :cond_21
     const-string v0, "Cannot add user. Maximum user limit is reached."
 
     const/4 v2, 0x6
@@ -5998,19 +5974,19 @@
 
     throw p1
 
-    :cond_23
-    :goto_18
-    if-eqz v23, :cond_25
+    :cond_22
+    :goto_17
+    if-eqz v23, :cond_24
 
     invoke-virtual {v1, v2, v4, v9}, Lcom/android/server/pm/UserManagerService;->canAddMoreProfilesToUser(IILjava/lang/String;)Z
 
     move-result v10
 
-    if-eqz v10, :cond_24
+    if-eqz v10, :cond_23
 
-    goto :goto_19
+    goto :goto_18
 
-    :cond_24
+    :cond_23
     new-instance v0, Ljava/lang/StringBuilder;
 
     invoke-direct {v0, v14}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
@@ -6033,19 +6009,19 @@
 
     throw p1
 
-    :cond_25
-    :goto_19
-    if-eqz p3, :cond_27
+    :cond_24
+    :goto_18
+    if-eqz p3, :cond_26
 
     invoke-virtual {v1, v2}, Lcom/android/server/pm/UserManagerService;->canAddPrivateProfile(I)Z
 
     move-result v10
 
-    if-eqz v10, :cond_26
+    if-eqz v10, :cond_25
 
-    goto :goto_1a
+    goto :goto_19
 
-    :cond_26
+    :cond_25
     new-instance v0, Ljava/lang/StringBuilder;
 
     invoke-direct {v0, v13}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
@@ -6068,11 +6044,11 @@
 
     throw p1
 
-    :cond_27
-    :goto_1a
-    if-eqz v20, :cond_2b
+    :cond_26
+    :goto_19
+    if-eqz v20, :cond_2a
 
-    if-eqz v38, :cond_2b
+    if-eqz v38, :cond_2a
 
     const/4 v10, 0x1
 
@@ -6088,8 +6064,8 @@
 
     const/4 v14, 0x0
 
-    :goto_1b
-    if-ge v14, v13, :cond_29
+    :goto_1a
+    if-ge v14, v13, :cond_28
 
     invoke-virtual {v11, v14}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
@@ -6105,24 +6081,24 @@
 
     move-result v15
 
-    if-eqz v15, :cond_28
+    if-eqz v15, :cond_27
 
-    goto :goto_1c
+    goto :goto_1b
 
-    :cond_28
+    :cond_27
     const/4 v10, 0x1
 
-    goto :goto_1b
+    goto :goto_1a
 
-    :cond_29
+    :cond_28
     move-object/from16 v10, p1
 
-    :goto_1c
-    if-nez v10, :cond_2a
+    :goto_1b
+    if-nez v10, :cond_29
 
-    goto :goto_1d
+    goto :goto_1c
 
-    :cond_2a
+    :cond_29
     const-string v0, "Cannot add Bmode user. There already exists one."
 
     const/4 v2, 0x6
@@ -6131,21 +6107,21 @@
 
     throw p1
 
-    :cond_2b
-    :goto_1d
-    if-eqz v29, :cond_2d
+    :cond_2a
+    :goto_1c
+    if-eqz v30, :cond_2c
 
-    if-eqz v2, :cond_2d
+    if-eqz v2, :cond_2c
 
     invoke-static {}, Lcom/android/server/pm/UserManagerService;->isCreationOverrideEnabled()Z
 
     move-result v10
 
-    if-eqz v10, :cond_2c
+    if-eqz v10, :cond_2b
 
-    goto :goto_1e
+    goto :goto_1d
 
-    :cond_2c
+    :cond_2b
     const-string v0, "Cannot add restricted profile - parent user must be system"
 
     const/4 v10, 0x1
@@ -6156,26 +6132,26 @@
     :try_end_7
     .catchall {:try_start_7 .. :try_end_7} :catchall_1
 
-    :cond_2d
-    :goto_1e
-    if-eqz p2, :cond_2e
+    :cond_2c
+    :goto_1d
+    if-eqz v28, :cond_2d
 
     const/16 v0, 0x4d
 
-    :goto_1f
+    :goto_1e
     move v10, v0
 
-    goto :goto_20
+    goto :goto_1f
 
-    :cond_2e
+    :cond_2d
     :try_start_8
     invoke-virtual {v1, v3, v0}, Lcom/android/server/pm/UserManagerService;->getNextAvailableId(ZZ)I
 
     move-result v0
 
-    goto :goto_1f
+    goto :goto_1e
 
-    :goto_20
+    :goto_1f
     const-string/jumbo v0, "UserManagerService"
 
     new-instance v11, Ljava/lang/StringBuilder;
@@ -6210,7 +6186,7 @@
     :try_end_8
     .catchall {:try_start_8 .. :try_end_8} :catchall_13
 
-    if-eqz v6, :cond_2f
+    if-eqz v6, :cond_2e
 
     :try_start_9
     iget-object v0, v6, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
@@ -6221,11 +6197,11 @@
     :try_end_9
     .catchall {:try_start_9 .. :try_end_9} :catchall_3
 
-    if-eqz v0, :cond_2f
+    if-eqz v0, :cond_2e
 
     or-int/lit16 v4, v4, 0x100
 
-    goto :goto_21
+    goto :goto_20
 
     :catchall_3
     move-exception v0
@@ -6236,20 +6212,20 @@
 
     goto/16 :goto_34
 
-    :cond_2f
-    :goto_21
-    if-eqz p5, :cond_30
+    :cond_2e
+    :goto_20
+    if-eqz p5, :cond_2f
 
     and-int/lit16 v4, v4, -0x101
 
-    :cond_30
+    :cond_2f
     and-int/lit16 v0, v4, 0x100
 
-    if-eqz v0, :cond_31
+    if-eqz v0, :cond_30
 
     or-int/lit16 v4, v4, 0x2000
 
-    :cond_31
+    :cond_30
     move/from16 v23, v4
 
     :try_start_a
@@ -6275,7 +6251,7 @@
 
     move-object/from16 v4, v24
 
-    if-eqz v40, :cond_32
+    if-eqz v40, :cond_31
 
     :try_start_b
     iput v9, v13, Landroid/content/pm/UserInfo;->serialNumber:I
@@ -6290,9 +6266,9 @@
     :try_end_b
     .catchall {:try_start_b .. :try_end_b} :catchall_3
 
-    goto :goto_22
+    goto :goto_21
 
-    :cond_32
+    :cond_31
     :try_start_c
     iget v0, v1, Lcom/android/server/pm/UserManagerService;->mNextSerialNumber:I
 
@@ -6304,7 +6280,7 @@
 
     iput v0, v13, Landroid/content/pm/UserInfo;->serialNumber:I
 
-    :goto_22
+    :goto_21
     invoke-static {}, Ljava/lang/System;->currentTimeMillis()J
 
     move-result-wide v14
@@ -6313,14 +6289,14 @@
 
     cmp-long v0, v14, v19
 
-    if-lez v0, :cond_33
+    if-lez v0, :cond_32
 
-    goto :goto_23
+    goto :goto_22
 
-    :cond_33
+    :cond_32
     const-wide/16 v14, 0x0
 
-    :goto_23
+    :goto_22
     iput-wide v14, v13, Landroid/content/pm/UserInfo;->creationTime:J
 
     const/4 v14, 0x1
@@ -6341,11 +6317,11 @@
     :try_end_c
     .catchall {:try_start_c .. :try_end_c} :catchall_10
 
-    if-eqz v0, :cond_34
+    if-eqz v0, :cond_33
 
     const/16 v0, -0x2710
 
-    if-eq v2, v0, :cond_34
+    if-eq v2, v0, :cond_33
 
     :try_start_d
     invoke-virtual {v1, v2, v4}, Lcom/android/server/pm/UserManagerService;->getFreeProfileBadgeLU(ILjava/lang/String;)I
@@ -6356,7 +6332,7 @@
     :try_end_d
     .catchall {:try_start_d .. :try_end_d} :catchall_3
 
-    :cond_34
+    :cond_33
     :try_start_e
     new-instance v15, Lcom/android/server/pm/UserManagerService$UserData;
 
@@ -6398,9 +6374,9 @@
     :try_end_10
     .catchall {:try_start_10 .. :try_end_10} :catchall_e
 
-    if-eqz v6, :cond_38
+    if-eqz v6, :cond_37
 
-    if-eqz v40, :cond_36
+    if-eqz v40, :cond_35
 
     :try_start_11
     iget-object v0, v6, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
@@ -6409,7 +6385,7 @@
 
     const/16 v11, -0x2710
 
-    if-ne v3, v11, :cond_35
+    if-ne v3, v11, :cond_34
 
     iget v3, v0, Landroid/content/pm/UserInfo;->id:I
 
@@ -6417,27 +6393,27 @@
 
     invoke-virtual {v1, v6}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    goto :goto_24
+    goto :goto_23
 
     :catchall_4
     move-exception v0
 
     move-object v9, v15
 
-    goto/16 :goto_14
+    goto/16 :goto_13
 
-    :cond_35
-    :goto_24
+    :cond_34
+    :goto_23
     iget-object v0, v6, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
     iget v0, v0, Landroid/content/pm/UserInfo;->profileGroupId:I
 
     iput v0, v13, Landroid/content/pm/UserInfo;->profileGroupId:I
 
-    goto :goto_25
+    goto :goto_24
 
-    :cond_36
-    if-eqz v29, :cond_38
+    :cond_35
+    if-eqz v30, :cond_37
 
     iget-object v0, v6, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
@@ -6445,7 +6421,7 @@
 
     const/16 v11, -0x2710
 
-    if-ne v3, v11, :cond_37
+    if-ne v3, v11, :cond_36
 
     iget v3, v0, Landroid/content/pm/UserInfo;->id:I
 
@@ -6453,7 +6429,7 @@
 
     invoke-virtual {v1, v6}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_37
+    :cond_36
     iget-object v0, v6, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
     iget v0, v0, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
@@ -6462,14 +6438,14 @@
     :try_end_11
     .catchall {:try_start_11 .. :try_end_11} :catchall_4
 
-    :cond_38
-    :goto_25
+    :cond_37
+    :goto_24
     :try_start_12
     monitor-exit v7
     :try_end_12
     .catchall {:try_start_12 .. :try_end_12} :catchall_e
 
-    if-eqz v34, :cond_45
+    if-eqz v35, :cond_45
 
     :try_start_13
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getDarManagerService()Lcom/samsung/android/knox/dar/IDarManagerService;
@@ -6480,7 +6456,7 @@
     :try_end_13
     .catchall {:try_start_13 .. :try_end_13} :catchall_5
 
-    if-eqz v0, :cond_39
+    if-eqz v0, :cond_38
 
     :try_start_14
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getDarManagerService()Lcom/samsung/android/knox/dar/IDarManagerService;
@@ -6494,7 +6470,7 @@
     .catch Landroid/os/RemoteException; {:try_start_14 .. :try_end_14} :catch_0
     .catchall {:try_start_14 .. :try_end_14} :catchall_5
 
-    goto :goto_27
+    goto :goto_26
 
     :catch_0
     move-exception v0
@@ -6514,20 +6490,20 @@
 
     invoke-static {v3, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_26
+    :goto_25
     const/4 v0, 0x0
 
-    goto :goto_27
+    goto :goto_26
 
-    :cond_39
+    :cond_38
     const-string/jumbo v0, "check Device Integrity - failed. cannot get DAR Service"
 
     invoke-static {v3, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_26
+    goto :goto_25
 
-    :goto_27
-    if-nez v0, :cond_3b
+    :goto_26
+    if-nez v0, :cond_3a
 
     const-string/jumbo v0, "UserManagerService"
 
@@ -6537,11 +6513,11 @@
     :try_end_15
     .catchall {:try_start_15 .. :try_end_15} :catchall_5
 
-    if-eqz p2, :cond_3a
+    if-eqz v28, :cond_39
 
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_3a
+    :cond_39
     invoke-static/range {v36 .. v37}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return-object p1
@@ -6555,7 +6531,7 @@
 
     goto/16 :goto_36
 
-    :cond_3b
+    :cond_3a
     :try_start_16
     const-string/jumbo v0, "ro.product.first_api_level"
 
@@ -6567,7 +6543,7 @@
 
     const/16 v3, 0x23
 
-    if-lt v0, v3, :cond_3c
+    if-lt v0, v3, :cond_3b
 
     const-string/jumbo v0, "UserManagerService"
 
@@ -6577,18 +6553,69 @@
 
     const/4 v0, 0x0
 
-    goto :goto_28
+    goto :goto_27
 
-    :cond_3c
+    :cond_3b
     const/4 v0, 0x1
 
-    :goto_28
+    :goto_27
     if-eqz v0, :cond_3e
 
-    invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->isDeviceRootKeyInstalled()Z
+    invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getDarManagerService()Lcom/samsung/android/knox/dar/IDarManagerService;
+
+    move-result-object v0
+
+    const-string/jumbo v3, "UserManagerService"
+    :try_end_16
+    .catchall {:try_start_16 .. :try_end_16} :catchall_5
+
+    if-eqz v0, :cond_3c
+
+    :try_start_17
+    invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getDarManagerService()Lcom/samsung/android/knox/dar/IDarManagerService;
+
+    move-result-object v0
+
+    invoke-interface {v0}, Lcom/samsung/android/knox/dar/IDarManagerService;->isDeviceRootKeyInstalled()Z
 
     move-result v0
+    :try_end_17
+    .catch Landroid/os/RemoteException; {:try_start_17 .. :try_end_17} :catch_1
+    .catchall {:try_start_17 .. :try_end_17} :catchall_5
+
+    goto :goto_29
+
+    :catch_1
+    move-exception v0
+
+    :try_start_18
+    new-instance v6, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v7, "check Device Root Key - Remote Exception : "
+
+    invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v0
+
+    invoke-static {v3, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+
+    :goto_28
+    const/4 v0, 0x0
+
+    goto :goto_29
 
+    :cond_3c
+    const-string/jumbo v0, "check Device Root Key - failed. cannot get DAR Service"
+
+    invoke-static {v3, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    goto :goto_28
+
+    :goto_29
     if-nez v0, :cond_3e
 
     const-string/jumbo v0, "UserManagerService"
@@ -6596,10 +6623,10 @@
     const-string v2, "Failed in (DRK)Device Root Key check"
 
     invoke-static {v0, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_16
-    .catchall {:try_start_16 .. :try_end_16} :catchall_5
+    :try_end_18
+    .catchall {:try_start_18 .. :try_end_18} :catchall_5
 
-    if-eqz p2, :cond_3d
+    if-eqz v28, :cond_3d
 
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
@@ -6609,19 +6636,23 @@
     return-object p1
 
     :cond_3e
-    :try_start_17
+    :try_start_19
     const-string v0, "KnoxTestKeyUMS"
-    :try_end_17
-    .catchall {:try_start_17 .. :try_end_17} :catchall_5
+    :try_end_19
+    .catchall {:try_start_19 .. :try_end_19} :catchall_5
 
-    :try_start_18
+    :try_start_1a
     new-instance v3, Lcom/samsung/android/security/keystore/AttestationUtils;
 
     invoke-direct {v3}, Lcom/samsung/android/security/keystore/AttestationUtils;-><init>()V
 
     new-instance v6, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;
 
-    invoke-static {}, Lcom/android/server/knox/dar/SecureUtil;->generateRandomBytes()[B
+    sget-object v7, Lcom/android/server/knox/dar/SecureUtil;->sSecureRandom:Ljava/security/SecureRandom;
+
+    const/16 v11, 0x8
+
+    invoke-virtual {v7, v11}, Ljava/security/SecureRandom;->generateSeed(I)[B
 
     move-result-object v7
 
@@ -6647,20 +6678,20 @@
 
     iget-boolean v11, v6, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;->mVerifiableIntegrity:Z
 
-    move-object/from16 v20, v0
+    move-object/from16 p2, v0
 
     iget-object v0, v6, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;->mSpec:Landroid/security/keystore/KeyGenParameterSpec;
 
     iget-object v6, v6, Lcom/samsung/android/security/keystore/AttestParameterSpec$Builder;->mChallenge:[B
-    :try_end_18
-    .catch Ljava/lang/Exception; {:try_start_18 .. :try_end_18} :catch_2
-    .catchall {:try_start_18 .. :try_end_18} :catchall_5
+    :try_end_1a
+    .catch Ljava/lang/Exception; {:try_start_1a .. :try_end_1a} :catch_3
+    .catchall {:try_start_1a .. :try_end_1a} :catchall_5
 
-    move/from16 v21, v12
+    move/from16 v20, v12
 
     const/4 v12, 0x0
 
-    :try_start_19
+    :try_start_1b
     invoke-direct {v7, v6, v11, v12, v0}, Lcom/samsung/android/security/keystore/AttestParameterSpec;-><init>([BZZLandroid/security/keystore/KeyGenParameterSpec;)V
 
     invoke-virtual {v3, v7}, Lcom/samsung/android/security/keystore/AttestationUtils;->generateKeyPair(Lcom/samsung/android/security/keystore/AttestParameterSpec;)Ljava/security/KeyPair;
@@ -6679,20 +6710,20 @@
 
     if-eqz v3, :cond_3f
 
-    invoke-static/range {v20 .. v20}, Lcom/samsung/android/security/keystore/AttestationUtils;->getCertificateChain(Ljava/lang/String;)[Ljava/security/cert/Certificate;
+    invoke-static/range {p2 .. p2}, Lcom/samsung/android/security/keystore/AttestationUtils;->getCertificateChain(Ljava/lang/String;)[Ljava/security/cert/Certificate;
 
     move-result-object v0
 
     if-eqz v0, :cond_3f
 
-    invoke-static/range {v20 .. v20}, Lcom/samsung/android/security/keystore/AttestationUtils;->deleteKey(Ljava/lang/String;)V
+    invoke-static/range {p2 .. p2}, Lcom/samsung/android/security/keystore/AttestationUtils;->deleteKey(Ljava/lang/String;)V
 
-    goto :goto_2c
+    goto :goto_2d
 
-    :catch_1
+    :catch_2
     move-exception v0
 
-    goto :goto_29
+    goto :goto_2a
 
     :cond_3f
     const-string/jumbo v0, "UserManagerService"
@@ -6700,11 +6731,11 @@
     const-string v3, "Failed in device integrity check"
 
     invoke-static {v0, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_19
-    .catch Ljava/lang/Exception; {:try_start_19 .. :try_end_19} :catch_1
-    .catchall {:try_start_19 .. :try_end_19} :catchall_5
+    :try_end_1b
+    .catch Ljava/lang/Exception; {:try_start_1b .. :try_end_1b} :catch_2
+    .catchall {:try_start_1b .. :try_end_1b} :catchall_5
 
-    if-eqz p2, :cond_40
+    if-eqz v28, :cond_40
 
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
@@ -6713,13 +6744,13 @@
 
     return-object p1
 
-    :catch_2
+    :catch_3
     move-exception v0
 
-    move/from16 v21, v12
+    move/from16 v20, v12
 
-    :goto_29
-    :try_start_1a
+    :goto_2a
+    :try_start_1c
     const-string/jumbo v3, "UserManagerService"
 
     const-string v6, "Device integrity status is abnormal."
@@ -6758,17 +6789,17 @@
 
     const/4 v0, 0x1
 
-    goto :goto_2a
+    goto :goto_2b
 
     :cond_41
     const/4 v0, 0x0
 
-    :goto_2a
+    :goto_2b
     const-string/jumbo v3, "UserManagerService"
 
     new-instance v6, Ljava/lang/StringBuilder;
 
-    move-object/from16 v7, v28
+    move-object/from16 v7, v29
 
     invoke-direct {v6, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
@@ -6780,12 +6811,12 @@
 
     invoke-static {v3, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_2b
+    goto :goto_2c
 
     :cond_42
     const/4 v0, 0x0
 
-    :goto_2b
+    :goto_2c
     if-eqz v0, :cond_43
 
     const-string/jumbo v0, "UserManagerService"
@@ -6793,13 +6824,13 @@
     const-string v3, "Device integrity status is abnormal. But, EM Token is allowed. Continue - "
 
     invoke-static {v0, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_1a
-    .catchall {:try_start_1a .. :try_end_1a} :catchall_5
+    :try_end_1c
+    .catchall {:try_start_1c .. :try_end_1c} :catchall_5
 
-    goto :goto_2c
+    goto :goto_2d
 
     :cond_43
-    if-eqz p2, :cond_44
+    if-eqz v28, :cond_44
 
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
@@ -6809,24 +6840,24 @@
     return-object p1
 
     :cond_45
-    move/from16 v21, v12
+    move/from16 v20, v12
 
-    :goto_2c
+    :goto_2d
     if-eqz v40, :cond_46
 
     if-nez v14, :cond_46
 
-    :try_start_1b
+    :try_start_1d
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->sPersonaManager:Lcom/android/server/pm/PersonaManagerService;
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     invoke-static {v9}, Lcom/android/server/pm/PersonaManagerService;->clearStorageForUser(I)V
-    :try_end_1b
-    .catchall {:try_start_1b .. :try_end_1b} :catchall_5
+    :try_end_1d
+    .catchall {:try_start_1d .. :try_end_1d} :catchall_5
 
     :cond_46
-    :try_start_1c
+    :try_start_1e
     const-string/jumbo v0, "createUserStorageKeys"
 
     move-object/from16 v3, p7
@@ -6862,17 +6893,17 @@
     invoke-virtual {v0, v11, v13}, Lcom/android/server/pm/UserDataPreparer;->prepareUserData(ILandroid/content/pm/UserInfo;)V
 
     invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
-    :try_end_1c
-    .catchall {:try_start_1c .. :try_end_1c} :catchall_9
+    :try_end_1e
+    .catchall {:try_start_1e .. :try_end_1e} :catchall_9
 
-    if-eqz v30, :cond_4a
+    if-eqz v31, :cond_4a
 
-    if-nez v32, :cond_47
+    if-nez v33, :cond_47
 
-    if-eqz v33, :cond_4a
+    if-eqz v34, :cond_4a
 
     :cond_47
-    :try_start_1d
+    :try_start_1f
     const-string/jumbo v0, "UserManagerService"
 
     new-instance v6, Ljava/lang/StringBuilder;
@@ -6906,10 +6937,10 @@
     const-string v2, "DualDAR Setup failed during workspace creation"
 
     invoke-static {v0, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_1d
-    .catchall {:try_start_1d .. :try_end_1d} :catchall_5
+    :try_end_1f
+    .catchall {:try_start_1f .. :try_end_1f} :catchall_5
 
-    if-eqz p2, :cond_48
+    if-eqz v28, :cond_48
 
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
@@ -6919,7 +6950,7 @@
     return-object p1
 
     :cond_49
-    :try_start_1e
+    :try_start_20
     sget-object v0, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_CREATED:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
 
     invoke-static {v9, v0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
@@ -6927,11 +6958,11 @@
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mLocalService:Lcom/android/server/pm/UserManagerService$LocalService;
 
     invoke-virtual {v0, v9, v10}, Lcom/android/server/pm/UserManagerService$LocalService;->setDualDarInfo(II)Z
-    :try_end_1e
-    .catchall {:try_start_1e .. :try_end_1e} :catchall_5
+    :try_end_20
+    .catchall {:try_start_20 .. :try_end_20} :catchall_5
 
     :cond_4a
-    :try_start_1f
+    :try_start_21
     const-string v0, "LSS.createNewUser"
 
     invoke-virtual {v3, v0}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
@@ -6965,50 +6996,50 @@
     new-instance v0, Landroid/os/Bundle;
 
     invoke-direct {v0}, Landroid/os/Bundle;-><init>()V
-    :try_end_1f
-    .catchall {:try_start_1f .. :try_end_1f} :catchall_9
+    :try_end_21
+    .catchall {:try_start_21 .. :try_end_21} :catchall_9
 
-    if-eqz v21, :cond_4b
+    if-eqz v20, :cond_4b
 
-    :try_start_20
+    :try_start_22
     iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mGuestRestrictions:Landroid/os/Bundle;
 
     monitor-enter v4
-    :try_end_20
-    .catchall {:try_start_20 .. :try_end_20} :catchall_5
+    :try_end_22
+    .catchall {:try_start_22 .. :try_end_22} :catchall_5
 
-    :try_start_21
+    :try_start_23
     iget-object v6, v1, Lcom/android/server/pm/UserManagerService;->mGuestRestrictions:Landroid/os/Bundle;
 
     invoke-virtual {v0, v6}, Landroid/os/Bundle;->putAll(Landroid/os/Bundle;)V
 
     monitor-exit v4
 
-    goto :goto_2d
+    goto :goto_2e
 
     :catchall_6
     move-exception v0
 
     monitor-exit v4
-    :try_end_21
-    .catchall {:try_start_21 .. :try_end_21} :catchall_6
+    :try_end_23
+    .catchall {:try_start_23 .. :try_end_23} :catchall_6
 
-    :try_start_22
+    :try_start_24
     throw v0
-    :try_end_22
-    .catchall {:try_start_22 .. :try_end_22} :catchall_5
+    :try_end_24
+    .catchall {:try_start_24 .. :try_end_24} :catchall_5
 
     :cond_4b
-    :try_start_23
+    :try_start_25
     iget-object v4, v8, Lcom/android/server/pm/UserTypeDetails;->mDefaultRestrictions:Landroid/os/Bundle;
 
     invoke-static {v0, v4}, Lcom/android/server/pm/UserRestrictionsUtils;->merge(Landroid/os/Bundle;Landroid/os/Bundle;)V
-    :try_end_23
-    .catchall {:try_start_23 .. :try_end_23} :catchall_9
+    :try_end_25
+    .catchall {:try_start_25 .. :try_end_25} :catchall_9
 
-    if-eqz v31, :cond_4c
+    if-eqz v32, :cond_4c
 
-    :try_start_24
+    :try_start_26
     const-string/jumbo v4, "no_outgoing_calls"
 
     invoke-virtual {v0, v4}, Landroid/os/Bundle;->remove(Ljava/lang/String;)V
@@ -7016,51 +7047,51 @@
     const-string/jumbo v4, "no_sms"
 
     invoke-virtual {v0, v4}, Landroid/os/Bundle;->remove(Ljava/lang/String;)V
-    :try_end_24
-    .catchall {:try_start_24 .. :try_end_24} :catchall_5
+    :try_end_26
+    .catchall {:try_start_26 .. :try_end_26} :catchall_5
 
     :cond_4c
-    :goto_2d
-    :try_start_25
+    :goto_2e
+    :try_start_27
     iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mRestrictionsLock:Ljava/lang/Object;
 
     monitor-enter v4
-    :try_end_25
-    .catchall {:try_start_25 .. :try_end_25} :catchall_9
+    :try_end_27
+    .catchall {:try_start_27 .. :try_end_27} :catchall_9
 
-    :try_start_26
+    :try_start_28
     iget-object v6, v1, Lcom/android/server/pm/UserManagerService;->mBaseUserRestrictions:Lcom/android/server/pm/RestrictionsSet;
 
     invoke-virtual {v6, v9, v0}, Lcom/android/server/pm/RestrictionsSet;->updateRestrictions(ILandroid/os/Bundle;)Z
 
     monitor-exit v4
-    :try_end_26
-    .catchall {:try_start_26 .. :try_end_26} :catchall_c
+    :try_end_28
+    .catchall {:try_start_28 .. :try_end_28} :catchall_c
 
     const/4 v12, 0x0
 
-    :try_start_27
+    :try_start_29
     iput-boolean v12, v13, Landroid/content/pm/UserInfo;->partial:Z
-    :try_end_27
-    .catchall {:try_start_27 .. :try_end_27} :catchall_8
+    :try_end_29
+    .catchall {:try_start_29 .. :try_end_29} :catchall_8
 
-    :try_start_28
+    :try_start_2a
     invoke-static {}, Landroid/os/UserManager;->invalidateCacheOnUserListChange()V
 
     iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mPackagesLock:Ljava/lang/Object;
 
     monitor-enter v4
-    :try_end_28
-    .catchall {:try_start_28 .. :try_end_28} :catchall_9
+    :try_end_2a
+    .catchall {:try_start_2a .. :try_end_2a} :catchall_9
 
-    :try_start_29
+    :try_start_2b
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
 
     monitor-exit v4
-    :try_end_29
-    .catchall {:try_start_29 .. :try_end_29} :catchall_a
+    :try_end_2b
+    .catchall {:try_start_2b .. :try_end_2b} :catchall_a
 
-    :try_start_2a
+    :try_start_2c
     invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->updateUserIds()V
 
     new-instance v4, Ljava/lang/StringBuilder;
@@ -7078,12 +7109,12 @@
     invoke-virtual {v3, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
     iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
-    :try_end_2a
-    .catchall {:try_start_2a .. :try_end_2a} :catchall_9
+    :try_end_2c
+    .catchall {:try_start_2c .. :try_end_2c} :catchall_9
 
     const/4 v12, 0x0
 
-    :try_start_2b
+    :try_start_2d
     invoke-virtual {v4, v9, v12}, Lcom/android/server/pm/PackageManagerService;->onNewUserCreated(IZ)V
 
     invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
@@ -7091,12 +7122,12 @@
     invoke-virtual {v1, v8, v9}, Lcom/android/server/pm/UserManagerService;->applyDefaultUserSettings(Lcom/android/server/pm/UserTypeDetails;I)V
 
     invoke-virtual {v1, v9, v8, v0, v2}, Lcom/android/server/pm/UserManagerService;->setDefaultCrossProfileIntentFilters(ILcom/android/server/pm/UserTypeDetails;Landroid/os/Bundle;I)V
-    :try_end_2b
-    .catchall {:try_start_2b .. :try_end_2b} :catchall_8
+    :try_end_2d
+    .catchall {:try_start_2d .. :try_end_2d} :catchall_8
 
     if-eqz v14, :cond_4d
 
-    :try_start_2c
+    :try_start_2e
     const-string/jumbo v0, "UserManagerService"
 
     new-instance v2, Ljava/lang/StringBuilder;
@@ -7120,31 +7151,30 @@
     invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;
 
     move-result-object v0
-    :try_end_2c
-    .catchall {:try_start_2c .. :try_end_2c} :catchall_7
+    :try_end_2e
+    .catchall {:try_start_2e .. :try_end_2e} :catchall_7
 
-    :try_start_2d
+    :try_start_2f
     invoke-interface {v0, v9}, Landroid/app/IActivityManager;->startUserInBackground(I)Z
-    :try_end_2d
-    .catch Landroid/os/RemoteException; {:try_start_2d .. :try_end_2d} :catch_3
-    .catchall {:try_start_2d .. :try_end_2d} :catchall_7
+    :try_end_2f
+    .catch Landroid/os/RemoteException; {:try_start_2f .. :try_end_2f} :catch_4
+    .catchall {:try_start_2f .. :try_end_2f} :catchall_7
 
     goto :goto_2f
 
     :catchall_7
     move-exception v0
 
-    move/from16 v4, p2
-
-    :goto_2e
     move-object v9, v15
 
+    move/from16 v4, v28
+
     goto/16 :goto_36
 
-    :catch_3
+    :catch_4
     move-exception v0
 
-    :try_start_2e
+    :try_start_30
     const-string/jumbo v2, "UserManagerService"
 
     new-instance v3, Ljava/lang/StringBuilder;
@@ -7167,12 +7197,12 @@
     invoke-virtual {v1, v13, v5}, Lcom/android/server/pm/UserManagerService;->dispatchUserAdded(Landroid/content/pm/UserInfo;Ljava/lang/Object;)V
 
     :goto_2f
-    if-nez v30, :cond_4e
+    if-nez v31, :cond_4e
 
-    if-eqz p3, :cond_52
+    if-eqz p3, :cond_50
 
     :cond_4e
-    if-nez v38, :cond_52
+    if-nez v38, :cond_50
 
     if-eqz v19, :cond_4f
 
@@ -7203,52 +7233,18 @@
     invoke-static {v0, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     :cond_4f
-    if-eqz v35, :cond_51
-
-    iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    if-nez v0, :cond_50
-
-    const-string/jumbo v0, "dar"
-
-    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v0, :cond_50
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iput-object v0, v1, Lcom/android/server/pm/UserManagerService;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    :cond_50
-    iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {v0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object v0
-
-    new-instance v2, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;
-
-    invoke-direct {v2, v9}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;-><init>(I)V
-
-    invoke-virtual {v0, v2}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    :cond_51
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->sPersonaManager:Lcom/android/server/pm/PersonaManagerService;
 
     invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     invoke-static {v13}, Lcom/android/server/pm/PersonaManagerService;->onNewUserCreated(Landroid/content/pm/UserInfo;)V
-    :try_end_2e
-    .catchall {:try_start_2e .. :try_end_2e} :catchall_7
+    :try_end_30
+    .catchall {:try_start_30 .. :try_end_30} :catchall_7
 
-    :cond_52
-    if-eqz p2, :cond_54
+    :cond_50
+    if-eqz v28, :cond_52
 
-    if-eqz p2, :cond_53
+    if-eqz v28, :cond_51
 
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
 
@@ -7262,10 +7258,10 @@
 
     goto :goto_30
 
-    :cond_53
+    :cond_51
     invoke-virtual {v1, v15}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_54
+    :cond_52
     :goto_30
     invoke-static/range {v36 .. v37}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
@@ -7277,7 +7273,9 @@
     :goto_31
     move v4, v12
 
-    goto/16 :goto_2e
+    move-object v9, v15
+
+    goto :goto_36
 
     :catchall_9
     move-exception v0
@@ -7292,15 +7290,15 @@
     const/4 v12, 0x0
 
     :goto_32
-    :try_start_2f
+    :try_start_31
     monitor-exit v4
-    :try_end_2f
-    .catchall {:try_start_2f .. :try_end_2f} :catchall_b
+    :try_end_31
+    .catchall {:try_start_31 .. :try_end_31} :catchall_b
 
-    :try_start_30
+    :try_start_32
     throw v0
-    :try_end_30
-    .catchall {:try_start_30 .. :try_end_30} :catchall_8
+    :try_end_32
+    .catchall {:try_start_32 .. :try_end_32} :catchall_8
 
     :catchall_b
     move-exception v0
@@ -7313,15 +7311,15 @@
     const/4 v12, 0x0
 
     :goto_33
-    :try_start_31
+    :try_start_33
     monitor-exit v4
-    :try_end_31
-    .catchall {:try_start_31 .. :try_end_31} :catchall_d
+    :try_end_33
+    .catchall {:try_start_33 .. :try_end_33} :catchall_d
 
-    :try_start_32
+    :try_start_34
     throw v0
-    :try_end_32
-    .catchall {:try_start_32 .. :try_end_32} :catchall_8
+    :try_end_34
+    .catchall {:try_start_34 .. :try_end_34} :catchall_8
 
     :catchall_d
     move-exception v0
@@ -7354,12 +7352,12 @@
     const/4 v9, 0x0
 
     :goto_34
-    :try_start_33
+    :try_start_35
     monitor-exit v11
-    :try_end_33
-    .catchall {:try_start_33 .. :try_end_33} :catchall_12
+    :try_end_35
+    .catchall {:try_start_35 .. :try_end_35} :catchall_12
 
-    :try_start_34
+    :try_start_36
     throw v0
 
     :catchall_11
@@ -7381,13 +7379,13 @@
 
     :goto_35
     monitor-exit v7
-    :try_end_34
-    .catchall {:try_start_34 .. :try_end_34} :catchall_11
+    :try_end_36
+    .catchall {:try_start_36 .. :try_end_36} :catchall_11
 
-    :try_start_35
+    :try_start_37
     throw v0
-    :try_end_35
-    .catchall {:try_start_35 .. :try_end_35} :catchall_14
+    :try_end_37
+    .catchall {:try_start_37 .. :try_end_37} :catchall_14
 
     :catchall_14
     move-exception v0
@@ -7406,9 +7404,9 @@
     const/4 v9, 0x0
 
     :goto_36
-    if-eqz p2, :cond_56
+    if-eqz v28, :cond_54
 
-    if-eqz v4, :cond_55
+    if-eqz v4, :cond_53
 
     iget-object v1, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
 
@@ -7422,16 +7420,16 @@
 
     goto :goto_37
 
-    :cond_55
+    :cond_53
     invoke-virtual {v1, v9}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_56
+    :cond_54
     :goto_37
     invoke-static/range {v36 .. v37}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw v0
 
-    :cond_57
+    :cond_55
     const-string v0, "Cannot add user. Not enough space on disk."
 
     const/4 v1, 0x5
@@ -7445,22 +7443,22 @@
     :catchall_16
     move-exception v0
 
-    :try_start_36
+    :try_start_38
     monitor-exit v3
-    :try_end_36
-    .catchall {:try_start_36 .. :try_end_36} :catchall_16
+    :try_end_38
+    .catchall {:try_start_38 .. :try_end_38} :catchall_16
 
     throw v0
 
     :goto_38
-    :try_start_37
+    :try_start_39
     monitor-exit v10
-    :try_end_37
-    .catchall {:try_start_37 .. :try_end_37} :catchall_0
+    :try_end_39
+    .catchall {:try_start_39 .. :try_end_39} :catchall_0
 
     throw v0
 
-    :cond_58
+    :cond_56
     move-object v4, v9
 
     new-instance v0, Ljava/lang/StringBuilder;
@@ -7479,15 +7477,15 @@
 
     move-result-object v0
 
-    const/16 v1, 0x8
+    const/16 v11, 0x8
 
-    invoke-static {v1, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
+    invoke-static {v11, v0}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(ILjava/lang/String;)V
 
     const/4 v2, 0x0
 
     throw v2
 
-    :cond_59
+    :cond_57
     move-object/from16 v2, p1
 
     new-instance v1, Ljava/lang/StringBuilder;
@@ -7516,7 +7514,7 @@
 
     throw v2
 
-    :cond_5a
+    :cond_58
     move-object v4, v9
 
     new-instance v1, Ljava/lang/StringBuilder;
@@ -7553,7 +7551,7 @@
 
     throw v2
 
-    :cond_5b
+    :cond_59
     move-object/from16 v2, p1
 
     const/4 v11, 0x1
@@ -14137,9 +14135,9 @@
 
     new-instance v0, Lcom/android/server/pm/ResilientAtomicFile;
 
-    new-instance v6, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;
+    new-instance v6, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;
 
-    invoke-direct {v6, p0, p1}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/pm/UserManagerService;I)V
+    invoke-direct {v6, p0, p1}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/pm/UserManagerService;I)V
 
     const/16 v4, 0x1f9
 
@@ -16536,49 +16534,6 @@
     throw p0
 .end method
 
-.method public final isDeviceRootKeyInstalled()Z
-    .locals 3
-
-    invoke-virtual {p0}, Lcom/android/server/pm/UserManagerService;->getDarManagerService()Lcom/samsung/android/knox/dar/IDarManagerService;
-
-    move-result-object v0
-
-    const/4 v1, 0x0
-
-    const-string/jumbo v2, "UserManagerService"
-
-    if-eqz v0, :cond_0
-
-    :try_start_0
-    invoke-virtual {p0}, Lcom/android/server/pm/UserManagerService;->getDarManagerService()Lcom/samsung/android/knox/dar/IDarManagerService;
-
-    move-result-object p0
-
-    invoke-interface {p0}, Lcom/samsung/android/knox/dar/IDarManagerService;->isDeviceRootKeyInstalled()Z
-
-    move-result p0
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return p0
-
-    :catch_0
-    move-exception p0
-
-    const-string/jumbo v0, "check Device Root Key - Remote Exception : "
-
-    invoke-static {v0, p0, v2}, Landroid/net/util/NetdService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Landroid/os/RemoteException;Ljava/lang/String;)V
-
-    return v1
-
-    :cond_0
-    const-string/jumbo p0, "check Device Root Key - failed. cannot get DAR Service"
-
-    invoke-static {v2, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-.end method
-
 .method public final isForegroundUserAdmin()Z
     .locals 4
 
@@ -18752,6 +18707,195 @@
     return-void
 .end method
 
+.method public final onBeforeUnlockUser(I)V
+    .locals 6
+
+    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->getUserInfo(I)Landroid/content/pm/UserInfo;
+
+    move-result-object v0
+
+    if-nez v0, :cond_0
+
+    return-void
+
+    :cond_0
+    sget-object v1, Landroid/content/pm/PackagePartitions;->FINGERPRINT:Ljava/lang/String;
+
+    iget-object v2, v0, Landroid/content/pm/UserInfo;->lastLoggedInFingerprint:Ljava/lang/String;
+
+    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v1
+
+    const/4 v2, 0x1
+
+    xor-int/2addr v1, v2
+
+    new-instance v3, Lcom/android/server/utils/TimingsTraceAndSlog;
+
+    invoke-direct {v3}, Lcom/android/server/utils/TimingsTraceAndSlog;-><init>()V
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v5, "prepareUserData-"
+
+    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual {v3, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+
+    iget-object v4, p0, Lcom/android/server/pm/UserManagerService;->mUserDataPreparer:Lcom/android/server/pm/UserDataPreparer;
+
+    const/4 v5, 0x2
+
+    invoke-virtual {v4, v5, v0}, Lcom/android/server/pm/UserDataPreparer;->prepareUserData(ILandroid/content/pm/UserInfo;)V
+
+    invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
+
+    invoke-virtual {v0}, Landroid/content/pm/UserInfo;->isManagedProfile()Z
+
+    move-result v4
+
+    if-eqz v4, :cond_2
+
+    iget v0, v0, Landroid/content/pm/UserInfo;->flags:I
+
+    const/high16 v4, 0x6000000
+
+    and-int/2addr v0, v4
+
+    if-lez v0, :cond_2
+
+    const-string/jumbo v0, "UserManagerService"
+
+    const-string v4, "Apply policies on CE storage for dualdar user "
+
+    invoke-static {p1, v4, v0}, Lcom/android/server/RCPManagerService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V
+
+    iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
+
+    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
+
+    move-result-object v0
+
+    invoke-virtual {v0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->handleBeforeUnlockUser(I)Z
+
+    move-result v0
+
+    if-nez v0, :cond_2
+
+    const-string/jumbo v0, "UserManagerService"
+
+    const-string/jumbo v1, "To set DualDAR Policy on CE storage was failed."
+
+    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+
+    iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mPackagesLock:Ljava/lang/Object;
+
+    monitor-enter v0
+
+    :try_start_0
+    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->getUserDataNoChecks(I)Lcom/android/server/pm/UserManagerService$UserData;
+
+    move-result-object v1
+
+    if-nez v1, :cond_1
+
+    const-string/jumbo p0, "UserManagerService"
+
+    const-string p1, "Failed to remove invalid enterprise user - Couldn\'t get UserData"
+
+    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+
+    monitor-exit v0
+
+    return-void
+
+    :catchall_0
+    move-exception p0
+
+    goto :goto_0
+
+    :cond_1
+    iget-object v3, v1, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
+
+    iput-boolean v2, v3, Landroid/content/pm/UserInfo;->partial:Z
+
+    iget v2, v3, Landroid/content/pm/UserInfo;->flags:I
+
+    or-int/lit8 v2, v2, 0x40
+
+    iput v2, v3, Landroid/content/pm/UserInfo;->flags:I
+
+    invoke-virtual {p0, v1}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
+
+    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->removeUser(I)Z
+
+    monitor-exit v0
+
+    return-void
+
+    :goto_0
+    monitor-exit v0
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+
+    throw p0
+
+    :cond_2
+    const-class v0, Landroid/os/storage/StorageManagerInternal;
+
+    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object v0
+
+    check-cast v0, Landroid/os/storage/StorageManagerInternal;
+
+    invoke-virtual {v0, p1}, Landroid/os/storage/StorageManagerInternal;->markCeStoragePrepared(I)V
+
+    new-instance v0, Ljava/lang/StringBuilder;
+
+    const-string/jumbo v2, "reconcileAppsData-"
+
+    invoke-direct {v0, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v0
+
+    invoke-virtual {v3, v0}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+
+    iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mPmInternal:Landroid/content/pm/PackageManagerInternal;
+
+    if-nez v0, :cond_3
+
+    const-class v0, Landroid/content/pm/PackageManagerInternal;
+
+    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object v0
+
+    check-cast v0, Landroid/content/pm/PackageManagerInternal;
+
+    iput-object v0, p0, Lcom/android/server/pm/UserManagerService;->mPmInternal:Landroid/content/pm/PackageManagerInternal;
+
+    :cond_3
+    iget-object p0, p0, Lcom/android/server/pm/UserManagerService;->mPmInternal:Landroid/content/pm/PackageManagerInternal;
+
+    invoke-virtual {p0, p1, v5, v1}, Landroid/content/pm/PackageManagerInternal;->reconcileAppsData(IIZ)V
+
+    invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
+
+    return-void
+.end method
+
 .method public final onShellCommand(Ljava/io/FileDescriptor;Ljava/io/FileDescriptor;Ljava/io/FileDescriptor;[Ljava/lang/String;Landroid/os/ShellCallback;Landroid/os/ResultReceiver;)V
     .locals 8
 
@@ -20861,64 +21005,6 @@
     return-void
 .end method
 
-.method public final removeInvalidEnterpriseUser(I)V
-    .locals 4
-
-    iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mPackagesLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->getUserDataNoChecks(I)Lcom/android/server/pm/UserManagerService$UserData;
-
-    move-result-object v1
-
-    if-nez v1, :cond_0
-
-    const-string/jumbo p0, "UserManagerService"
-
-    const-string p1, "Failed to remove invalid enterprise user - Couldn\'t get UserData"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_0
-
-    :cond_0
-    iget-object v2, v1, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
-
-    const/4 v3, 0x1
-
-    iput-boolean v3, v2, Landroid/content/pm/UserInfo;->partial:Z
-
-    iget v3, v2, Landroid/content/pm/UserInfo;->flags:I
-
-    or-int/lit8 v3, v3, 0x40
-
-    iput v3, v2, Landroid/content/pm/UserInfo;->flags:I
-
-    invoke-virtual {p0, v1}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
-
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->removeUser(I)Z
-
-    monitor-exit v0
-
-    return-void
-
-    :goto_0
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
 .method public final removeUser(I)Z
     .locals 6
 
@@ -24668,11 +24754,11 @@
     :goto_0
     if-nez p1, :cond_3
 
-    new-instance p1, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;
+    new-instance p1, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;
 
-    invoke-direct {p1, p0}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/pm/UserManagerService;)V
+    invoke-direct {p1, p0}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;-><init>(Lcom/android/server/pm/UserManagerService;)V
 
-    iput-object p1, p0, Lcom/android/server/pm/UserManagerService;->mKeyguardLockedStateListener:Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;
+    iput-object p1, p0, Lcom/android/server/pm/UserManagerService;->mKeyguardLockedStateListener:Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;
 
     :try_start_0
     iget-object p1, p0, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
@@ -24695,7 +24781,7 @@
 
     invoke-direct {v0, v1}, Landroid/os/HandlerExecutor;-><init>(Landroid/os/Handler;)V
 
-    iget-object p0, p0, Lcom/android/server/pm/UserManagerService;->mKeyguardLockedStateListener:Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;
+    iget-object p0, p0, Lcom/android/server/pm/UserManagerService;->mKeyguardLockedStateListener:Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;
 
     invoke-virtual {p1, v0, p0}, Landroid/app/KeyguardManager;->addKeyguardLockedStateListener(Ljava/util/concurrent/Executor;Landroid/app/KeyguardManager$KeyguardLockedStateListener;)V
     :try_end_0
@@ -24728,7 +24814,7 @@
 
     invoke-static {v2, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-object p0, p0, Lcom/android/server/pm/UserManagerService;->mKeyguardLockedStateListener:Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda4;
+    iget-object p0, p0, Lcom/android/server/pm/UserManagerService;->mKeyguardLockedStateListener:Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;
 
     invoke-virtual {p1, p0}, Landroid/app/KeyguardManager;->removeKeyguardLockedStateListener(Landroid/app/KeyguardManager$KeyguardLockedStateListener;)V
     :try_end_1
@@ -25137,7 +25223,7 @@
 
     iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mInternalExecutor:Ljava/util/concurrent/ThreadPoolExecutor;
 
-    new-instance v1, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;
+    new-instance v1, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;
 
     move-object v2, p0
 
@@ -25149,7 +25235,7 @@
 
     move-object v6, p4
 
-    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/pm/UserManagerService;IZLandroid/content/IntentSender;Ljava/lang/String;)V
+    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/pm/UserManagerService;IZLandroid/content/IntentSender;Ljava/lang/String;)V
 
     invoke-virtual {v0, v1}, Ljava/util/concurrent/ThreadPoolExecutor;->execute(Ljava/lang/Runnable;)V
 
@@ -26388,7 +26474,7 @@
 
     iget-object p0, p0, Lcom/android/server/pm/UserManagerService;->mHandler:Lcom/android/server/pm/UserManagerService$MainHandler;
 
-    new-instance v2, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;
+    new-instance v2, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;
 
     move-object v3, p1
 
@@ -26396,7 +26482,7 @@
 
     move v4, p3
 
-    invoke-direct/range {v2 .. v7}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda3;-><init>(Ljava/lang/String;IZILjava/lang/String;)V
+    invoke-direct/range {v2 .. v7}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda2;-><init>(Ljava/lang/String;IZILjava/lang/String;)V
 
     invoke-virtual {p0, v2}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
@@ -26749,9 +26835,9 @@
 
     invoke-direct {v0, p1, p2}, Landroid/accounts/Account;-><init>(Ljava/lang/String;Ljava/lang/String;)V
 
-    new-instance v1, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda7;
+    new-instance v1, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;
 
-    invoke-direct {v1, p0, v0, p1, p2}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/pm/UserManagerService;Landroid/accounts/Account;Ljava/lang/String;Ljava/lang/String;)V
+    invoke-direct {v1, p0, v0, p1, p2}, Lcom/android/server/pm/UserManagerService$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/pm/UserManagerService;Landroid/accounts/Account;Ljava/lang/String;Ljava/lang/String;)V
 
     invoke-static {v1}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingSupplier;)Ljava/lang/Object;
 
diff --git a/smali_classes2/com/android/server/trust/TrustAgentWrapper$3.smali b/smali_classes2/com/android/server/trust/TrustAgentWrapper$3.smali
index 4867d4b78..a1b7c595a 100644
--- a/smali_classes2/com/android/server/trust/TrustAgentWrapper$3.smali
+++ b/smali_classes2/com/android/server/trust/TrustAgentWrapper$3.smali
@@ -291,9 +291,9 @@
 
     iget-object v3, v2, Lcom/android/server/trust/TrustManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
-    new-instance v4, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda3;
+    new-instance v4, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2;
 
-    invoke-direct {v4, v2}, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda3;-><init>(Lcom/android/server/trust/TrustManagerService;)V
+    invoke-direct {v4, v2}, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/trust/TrustManagerService;)V
 
     invoke-virtual {v3, v0, v1, v4}, Lcom/android/internal/widget/LockPatternUtils;->addEscrowToken([BILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
 
diff --git a/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0.smali b/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0.smali
index 0da0623a5..78e0f5058 100644
--- a/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0.smali
+++ b/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0.smali
@@ -3,22 +3,18 @@
 .source "SourceFile"
 
 # interfaces
-.implements Ljava/util/function/Consumer;
+.implements Ljava/lang/Runnable;
 
 
 # instance fields
 .field public final synthetic $r8$classId:I
 
-.field public final synthetic f$0:I
-
 
 # direct methods
-.method public synthetic constructor <init>(II)V
+.method public synthetic constructor <init>(I)V
     .locals 0
 
-    iput p2, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;->$r8$classId:I
-
-    iput p1, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;->f$0:I
+    iput p1, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;->$r8$classId:I
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
@@ -27,30 +23,19 @@
 
 
 # virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 1
-
-    iget v0, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;->$r8$classId:I
-
-    iget p0, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;->f$0:I
+.method public final run()V
+    .locals 0
 
-    check-cast p1, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
+    iget p0, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;->$r8$classId:I
 
-    packed-switch v0, :pswitch_data_0
+    packed-switch p0, :pswitch_data_0
 
-    invoke-virtual {p1, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->onDeviceUnlocked(I)V
+    sget p0, Lcom/android/server/trust/TrustManagerService$3;->$r8$clinit:I
 
     return-void
 
     :pswitch_0
-    invoke-virtual {p1, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->onDeviceLocked(I)V
-
-    return-void
-
-    :pswitch_1
-    sget-object v0, Lcom/android/server/trust/TrustManagerService;->TRUST_AGENT_INTENT:Landroid/content/Intent;
-
-    invoke-virtual {p1, p0}, Lcom/android/server/knox/dar/sdp/SdpManagerImpl;->onDeviceLocked(I)V
+    sget-object p0, Lcom/android/server/trust/TrustManagerService;->TRUST_AGENT_INTENT:Landroid/content/Intent;
 
     return-void
 
@@ -58,7 +43,6 @@
 
     :pswitch_data_0
     .packed-switch 0x0
-        :pswitch_1
         :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1.smali b/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1.smali
index 4d7afb0ab..19fefeff3 100644
--- a/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1.smali
+++ b/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1.smali
@@ -3,46 +3,85 @@
 .source "SourceFile"
 
 # interfaces
-.implements Ljava/lang/Runnable;
+.implements Ljava/util/function/IntConsumer;
 
 
 # instance fields
-.field public final synthetic $r8$classId:I
+.field public final synthetic f$0:Lcom/android/server/trust/TrustManagerService;
+
+.field public final synthetic f$1:I
+
+.field public final synthetic f$2:Z
 
 
 # direct methods
-.method public synthetic constructor <init>(I)V
+.method public synthetic constructor <init>(Lcom/android/server/trust/TrustManagerService;IZ)V
     .locals 0
 
-    iput p1, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;->$r8$classId:I
-
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
+    iput-object p1, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/trust/TrustManagerService;
+
+    iput p2, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;->f$1:I
+
+    iput-boolean p3, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;->f$2:Z
+
     return-void
 .end method
 
 
 # virtual methods
-.method public final run()V
-    .locals 0
+.method public final accept(I)V
+    .locals 3
 
-    iget p0, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;->$r8$classId:I
+    iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/trust/TrustManagerService;
 
-    packed-switch p0, :pswitch_data_0
+    iget v1, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;->f$1:I
 
-    sget p0, Lcom/android/server/trust/TrustManagerService$3;->$r8$clinit:I
+    iget-boolean p0, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;->f$2:Z
 
-    return-void
+    sget-object v2, Lcom/android/server/trust/TrustManagerService;->TRUST_AGENT_INTENT:Landroid/content/Intent;
+
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+
+    :try_start_0
+    iget-object v2, v0, Lcom/android/server/trust/TrustManagerService;->mDeviceLockedStateListeners:Landroid/os/RemoteCallbackList;
+
+    invoke-virtual {v2, p1}, Landroid/os/RemoteCallbackList;->getBroadcastCookie(I)Ljava/lang/Object;
+
+    move-result-object v2
 
-    :pswitch_0
-    sget-object p0, Lcom/android/server/trust/TrustManagerService;->TRUST_AGENT_INTENT:Landroid/content/Intent;
+    check-cast v2, Ljava/lang/Integer;
+
+    invoke-virtual {v2}, Ljava/lang/Integer;->intValue()I
+
+    move-result v2
+
+    if-ne v1, v2, :cond_0
+
+    iget-object v0, v0, Lcom/android/server/trust/TrustManagerService;->mDeviceLockedStateListeners:Landroid/os/RemoteCallbackList;
+
+    invoke-virtual {v0, p1}, Landroid/os/RemoteCallbackList;->getBroadcastItem(I)Landroid/os/IInterface;
+
+    move-result-object p1
+
+    check-cast p1, Lcom/android/internal/policy/IDeviceLockedStateListener;
+
+    invoke-interface {p1, p0}, Lcom/android/internal/policy/IDeviceLockedStateListener;->onDeviceLockedStateChanged(Z)V
+    :try_end_0
+    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
 
     return-void
 
-    nop
+    :catch_0
+    move-exception p0
+
+    const-string/jumbo p1, "TrustManagerService"
 
-    :pswitch_data_0
-    .packed-switch 0x0
-        :pswitch_0
-    .end packed-switch
+    const-string/jumbo v0, "Service died"
+
+    invoke-static {p1, v0, p0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    :cond_0
+    return-void
 .end method
diff --git a/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2.smali b/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2.smali
index 30d1b7702..a5229375a 100644
--- a/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2.smali
+++ b/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2.smali
@@ -3,85 +3,80 @@
 .source "SourceFile"
 
 # interfaces
-.implements Ljava/util/function/IntConsumer;
+.implements Lcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;
 
 
 # instance fields
 .field public final synthetic f$0:Lcom/android/server/trust/TrustManagerService;
 
-.field public final synthetic f$1:I
-
-.field public final synthetic f$2:Z
-
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/trust/TrustManagerService;IZ)V
+.method public synthetic constructor <init>(Lcom/android/server/trust/TrustManagerService;)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
     iput-object p1, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2;->f$0:Lcom/android/server/trust/TrustManagerService;
 
-    iput p2, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2;->f$1:I
-
-    iput-boolean p3, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2;->f$2:Z
-
     return-void
 .end method
 
 
 # virtual methods
-.method public final accept(I)V
+.method public final onEscrowTokenActivated(JI)V
     .locals 3
 
-    iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2;->f$0:Lcom/android/server/trust/TrustManagerService;
+    iget-object p0, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2;->f$0:Lcom/android/server/trust/TrustManagerService;
 
-    iget v1, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2;->f$1:I
+    const/4 v0, 0x0
 
-    iget-boolean p0, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2;->f$2:Z
+    :goto_0
+    iget-object v1, p0, Lcom/android/server/trust/TrustManagerService;->mActiveAgents:Landroid/util/ArraySet;
 
-    sget-object v2, Lcom/android/server/trust/TrustManagerService;->TRUST_AGENT_INTENT:Landroid/content/Intent;
+    invoke-virtual {v1}, Landroid/util/ArraySet;->size()I
 
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    move-result v1
 
-    :try_start_0
-    iget-object v2, v0, Lcom/android/server/trust/TrustManagerService;->mDeviceLockedStateListeners:Landroid/os/RemoteCallbackList;
+    if-ge v0, v1, :cond_1
 
-    invoke-virtual {v2, p1}, Landroid/os/RemoteCallbackList;->getBroadcastCookie(I)Ljava/lang/Object;
+    iget-object v1, p0, Lcom/android/server/trust/TrustManagerService;->mActiveAgents:Landroid/util/ArraySet;
 
-    move-result-object v2
+    invoke-virtual {v1, v0}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;
 
-    check-cast v2, Ljava/lang/Integer;
+    move-result-object v1
 
-    invoke-virtual {v2}, Ljava/lang/Integer;->intValue()I
+    check-cast v1, Lcom/android/server/trust/TrustManagerService$AgentInfo;
 
-    move-result v2
+    iget v2, v1, Lcom/android/server/trust/TrustManagerService$AgentInfo;->userId:I
 
-    if-ne v1, v2, :cond_0
+    if-ne v2, p3, :cond_0
 
-    iget-object v0, v0, Lcom/android/server/trust/TrustManagerService;->mDeviceLockedStateListeners:Landroid/os/RemoteCallbackList;
+    iget-object v1, v1, Lcom/android/server/trust/TrustManagerService$AgentInfo;->agent:Lcom/android/server/trust/TrustAgentWrapper;
 
-    invoke-virtual {v0, p1}, Landroid/os/RemoteCallbackList;->getBroadcastItem(I)Landroid/os/IInterface;
+    iget-object v1, v1, Lcom/android/server/trust/TrustAgentWrapper;->mTrustAgentService:Landroid/service/trust/ITrustAgentService;
 
-    move-result-object p1
+    if-eqz v1, :cond_0
 
-    check-cast p1, Lcom/android/internal/policy/IDeviceLockedStateListener;
+    const/4 v2, 0x1
 
-    invoke-interface {p1, p0}, Lcom/android/internal/policy/IDeviceLockedStateListener;->onDeviceLockedStateChanged(Z)V
+    :try_start_0
+    invoke-interface {v1, p1, p2, v2}, Landroid/service/trust/ITrustAgentService;->onTokenStateReceived(JI)V
     :try_end_0
     .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
 
-    return-void
+    goto :goto_1
 
     :catch_0
-    move-exception p0
+    move-exception v1
 
-    const-string/jumbo p1, "TrustManagerService"
+    invoke-static {v1}, Lcom/android/server/trust/TrustAgentWrapper;->onError(Ljava/lang/Exception;)V
 
-    const-string/jumbo v0, "Service died"
+    :cond_0
+    :goto_1
+    add-int/lit8 v0, v0, 0x1
 
-    invoke-static {p1, v0, p0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    goto :goto_0
 
-    :cond_0
+    :cond_1
     return-void
 .end method
diff --git a/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda3.smali b/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda3.smali
deleted file mode 100644
index f0f1ec3b6..000000000
--- a/smali_classes2/com/android/server/trust/TrustManagerService$$ExternalSyntheticLambda3.smali
+++ /dev/null
@@ -1,82 +0,0 @@
-.class public final synthetic Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda3;
-.super Ljava/lang/Object;
-.source "SourceFile"
-
-# interfaces
-.implements Lcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;
-
-
-# instance fields
-.field public final synthetic f$0:Lcom/android/server/trust/TrustManagerService;
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/trust/TrustManagerService;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda3;->f$0:Lcom/android/server/trust/TrustManagerService;
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final onEscrowTokenActivated(JI)V
-    .locals 3
-
-    iget-object p0, p0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda3;->f$0:Lcom/android/server/trust/TrustManagerService;
-
-    const/4 v0, 0x0
-
-    :goto_0
-    iget-object v1, p0, Lcom/android/server/trust/TrustManagerService;->mActiveAgents:Landroid/util/ArraySet;
-
-    invoke-virtual {v1}, Landroid/util/ArraySet;->size()I
-
-    move-result v1
-
-    if-ge v0, v1, :cond_1
-
-    iget-object v1, p0, Lcom/android/server/trust/TrustManagerService;->mActiveAgents:Landroid/util/ArraySet;
-
-    invoke-virtual {v1, v0}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Lcom/android/server/trust/TrustManagerService$AgentInfo;
-
-    iget v2, v1, Lcom/android/server/trust/TrustManagerService$AgentInfo;->userId:I
-
-    if-ne v2, p3, :cond_0
-
-    iget-object v1, v1, Lcom/android/server/trust/TrustManagerService$AgentInfo;->agent:Lcom/android/server/trust/TrustAgentWrapper;
-
-    iget-object v1, v1, Lcom/android/server/trust/TrustAgentWrapper;->mTrustAgentService:Landroid/service/trust/ITrustAgentService;
-
-    if-eqz v1, :cond_0
-
-    const/4 v2, 0x1
-
-    :try_start_0
-    invoke-interface {v1, p1, p2, v2}, Landroid/service/trust/ITrustAgentService;->onTokenStateReceived(JI)V
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_1
-
-    :catch_0
-    move-exception v1
-
-    invoke-static {v1}, Lcom/android/server/trust/TrustAgentWrapper;->onError(Ljava/lang/Exception;)V
-
-    :cond_0
-    :goto_1
-    add-int/lit8 v0, v0, 0x1
-
-    goto :goto_0
-
-    :cond_1
-    return-void
-.end method
diff --git a/smali_classes2/com/android/server/trust/TrustManagerService$3.smali b/smali_classes2/com/android/server/trust/TrustManagerService$3.smali
index 3134e7fb0..d17d2f57e 100644
--- a/smali_classes2/com/android/server/trust/TrustManagerService$3.smali
+++ b/smali_classes2/com/android/server/trust/TrustManagerService$3.smali
@@ -569,11 +569,11 @@
 
     iget-object p0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
-    new-instance v0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;
+    new-instance v0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;
 
     const/4 v1, 0x1
 
-    invoke-direct {v0, v1}, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;-><init>(I)V
+    invoke-direct {v0, v1}, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;-><init>(I)V
 
     const-wide/16 v1, 0x0
 
@@ -849,7 +849,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_6
+    if-eqz v0, :cond_5
 
     iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
@@ -859,7 +859,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_6
+    if-eqz v0, :cond_5
 
     iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
@@ -896,9 +896,9 @@
     :try_start_7
     invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;
 
-    move-result-object v0
+    move-result-object p2
 
-    invoke-interface {v0, p1}, Landroid/app/IActivityManager;->notifyLockedProfile(I)V
+    invoke-interface {p2, p1}, Landroid/app/IActivityManager;->notifyLockedProfile(I)V
     :try_end_7
     .catch Landroid/os/RemoteException; {:try_start_7 .. :try_end_7} :catch_0
     .catchall {:try_start_7 .. :try_end_7} :catchall_0
@@ -906,84 +906,51 @@
     :catch_0
     :cond_3
     :try_start_8
-    new-instance v0, Landroid/content/Intent;
-
-    const-string/jumbo v1, "android.intent.action.DEVICE_LOCKED_CHANGED"
-
-    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V
-
-    const/high16 v1, 0x40000000    # 2.0f
-
-    invoke-virtual {v0, v1}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;
-
-    const-string/jumbo v1, "android.intent.extra.user_handle"
-
-    invoke-virtual {v0, v1, p1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
+    new-instance p2, Landroid/content/Intent;
 
-    iget-object v1, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
+    const-string/jumbo v0, "android.intent.action.DEVICE_LOCKED_CHANGED"
 
-    iget-object v1, v1, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
+    invoke-direct {p2, v0}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V
 
-    sget-object v4, Landroid/os/UserHandle;->SYSTEM:Landroid/os/UserHandle;
+    const/high16 v0, 0x40000000    # 2.0f
 
-    const-string/jumbo v5, "android.permission.TRUST_LISTENER"
+    invoke-virtual {p2, v0}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;
 
-    const/4 v6, 0x0
+    const-string/jumbo v0, "android.intent.extra.user_handle"
 
-    invoke-virtual {v1, v0, v4, v5, v6}, Landroid/content/Context;->sendBroadcastAsUser(Landroid/content/Intent;Landroid/os/UserHandle;Ljava/lang/String;Landroid/os/Bundle;)V
+    invoke-virtual {p2, v0, p1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
 
     iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
-    invoke-virtual {v0}, Lcom/android/server/trust/TrustManagerService;->getPersonaManagerInternal()Lcom/samsung/android/knox/PersonaManagerInternal;
+    iget-object v0, v0, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
 
-    move-result-object v0
+    sget-object v1, Landroid/os/UserHandle;->SYSTEM:Landroid/os/UserHandle;
 
-    if-eqz v0, :cond_5
+    const-string/jumbo v4, "android.permission.TRUST_LISTENER"
 
-    iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
+    const/4 v5, 0x0
 
-    invoke-virtual {v0}, Lcom/android/server/trust/TrustManagerService;->getPersonaManagerInternal()Lcom/samsung/android/knox/PersonaManagerInternal;
+    invoke-virtual {v0, p2, v1, v4, v5}, Landroid/content/Context;->sendBroadcastAsUser(Landroid/content/Intent;Landroid/os/UserHandle;Ljava/lang/String;Landroid/os/Bundle;)V
 
-    move-result-object v0
+    iget-object p2, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
-    invoke-virtual {v0, p1}, Lcom/samsung/android/knox/PersonaManagerInternal;->onDeviceLockedChanged(I)V
+    invoke-virtual {p2}, Lcom/android/server/trust/TrustManagerService;->getPersonaManagerInternal()Lcom/samsung/android/knox/PersonaManagerInternal;
+
+    move-result-object p2
 
     if-eqz p2, :cond_4
 
     iget-object p0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
 
-    invoke-virtual {p0}, Lcom/android/server/trust/TrustManagerService;->getSdpManager()Ljava/util/Optional;
+    invoke-virtual {p0}, Lcom/android/server/trust/TrustManagerService;->getPersonaManagerInternal()Lcom/samsung/android/knox/PersonaManagerInternal;
 
     move-result-object p0
 
-    new-instance p2, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;
-
-    const/4 v0, 0x1
-
-    invoke-direct {p2, p1, v0}, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;-><init>(II)V
-
-    invoke-virtual {p0, p2}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
+    invoke-virtual {p0, p1}, Lcom/samsung/android/knox/PersonaManagerInternal;->onDeviceLockedChanged(I)V
 
     goto :goto_2
 
     :cond_4
-    iget-object p0, p0, Lcom/android/server/trust/TrustManagerService$3;->this$0:Lcom/android/server/trust/TrustManagerService;
-
-    invoke-virtual {p0}, Lcom/android/server/trust/TrustManagerService;->getSdpManager()Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance p2, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;
-
-    const/4 v0, 0x2
-
-    invoke-direct {p2, p1, v0}, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;-><init>(II)V
-
-    invoke-virtual {p0, p2}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    goto :goto_2
-
-    :cond_5
     const-string/jumbo p0, "TrustManagerService"
 
     const-string/jumbo p1, "onDeviceLockedChanged() - Service is not yet ready..."
@@ -1007,7 +974,7 @@
     :try_end_a
     .catchall {:try_start_a .. :try_end_a} :catchall_0
 
-    :cond_6
+    :cond_5
     :goto_2
     invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
diff --git a/smali_classes2/com/android/server/trust/TrustManagerService.smali b/smali_classes2/com/android/server/trust/TrustManagerService.smali
index 25a85ea32..b2a3090e3 100644
--- a/smali_classes2/com/android/server/trust/TrustManagerService.smali
+++ b/smali_classes2/com/android/server/trust/TrustManagerService.smali
@@ -22,8 +22,6 @@
 
 .field public mCurrentUser:I
 
-.field public mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
-
 .field public final mDeviceLockedForUser:Landroid/util/SparseBooleanArray;
 
 .field public final mDeviceLockedStateListeners:Landroid/os/RemoteCallbackList;
@@ -52,8 +50,6 @@
 
 .field public final mReceiver:Lcom/android/server/trust/TrustManagerService$Receiver;
 
-.field public mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
 .field public final mService:Lcom/android/server/trust/TrustManagerService$3;
 
 .field public mSignificantPlaceServiceWatcher:Lcom/android/server/servicewatcher/ServiceWatcher;
@@ -909,46 +905,6 @@
     return-object p0
 .end method
 
-.method public final getSdpManager()Ljava/util/Optional;
-    .locals 1
-
-    iget-object v0, p0, Lcom/android/server/trust/TrustManagerService;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    if-nez v0, :cond_1
-
-    iget-object v0, p0, Lcom/android/server/trust/TrustManagerService;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
-
-    if-nez v0, :cond_0
-
-    const-string/jumbo v0, "dar"
-
-    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/knox/dar/DarManagerService;
-
-    iput-object v0, p0, Lcom/android/server/trust/TrustManagerService;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/trust/TrustManagerService;->mDarManagerService:Lcom/android/server/knox/dar/DarManagerService;
-
-    if-eqz v0, :cond_1
-
-    iget-object v0, v0, Lcom/android/server/knox/dar/DarManagerService;->mSdpManagerImpl:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    iput-object v0, p0, Lcom/android/server/trust/TrustManagerService;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    :cond_1
-    iget-object p0, p0, Lcom/android/server/trust/TrustManagerService;->mSdpManager:Lcom/android/server/knox/dar/sdp/SdpManagerImpl;
-
-    invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public final getUserTrustStateInner(I)Lcom/android/server/trust/TrustManagerService$TrustState;
     .locals 2
 
@@ -1533,9 +1489,9 @@
 
     move-result-object v1
 
-    new-instance v2, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2;
+    new-instance v2, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;
 
-    invoke-direct {v2, p0, p1, p2}, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/trust/TrustManagerService;IZ)V
+    invoke-direct {v2, p0, p1, p2}, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/trust/TrustManagerService;IZ)V
 
     invoke-interface {v1, v2}, Ljava/util/stream/IntStream;->forEach(Ljava/util/function/IntConsumer;)V
     :try_end_1
@@ -3635,18 +3591,6 @@
 
     invoke-virtual {v3, v4}, Lcom/samsung/android/knox/PersonaManagerInternal;->onDeviceLockedChanged(I)V
 
-    invoke-virtual {p0}, Lcom/android/server/trust/TrustManagerService;->getSdpManager()Ljava/util/Optional;
-
-    move-result-object v3
-
-    new-instance v5, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;
-
-    const/4 v6, 0x0
-
-    invoke-direct {v5, v4, v6}, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;-><init>(II)V
-
-    invoke-virtual {v3, v5}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
     goto :goto_7
 
     :cond_c
@@ -4974,11 +4918,11 @@
 .method public waitForIdle()V
     .locals 3
 
-    new-instance v0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;
+    new-instance v0, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;
 
     const/4 v1, 0x0
 
-    invoke-direct {v0, v1}, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda1;-><init>(I)V
+    invoke-direct {v0, v1}, Lcom/android/server/trust/TrustManagerService$$ExternalSyntheticLambda0;-><init>(I)V
 
     const-wide/16 v1, 0x0
 
diff --git a/smali_classes2/com/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5.smali b/smali_classes2/com/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5.smali
index 587fd390c..6637e3174 100644
--- a/smali_classes2/com/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5.smali
+++ b/smali_classes2/com/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5.smali
@@ -9,112 +9,106 @@
 # instance fields
 .field public final synthetic f$0:Lcom/android/server/wm/ActivityTaskManagerServiceExt;
 
-.field public final synthetic f$1:I
-
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/wm/ActivityTaskManagerServiceExt;I)V
+.method public synthetic constructor <init>(Lcom/android/server/wm/ActivityTaskManagerServiceExt;)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
     iput-object p1, p0, Lcom/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5;->f$0:Lcom/android/server/wm/ActivityTaskManagerServiceExt;
 
-    iput p2, p0, Lcom/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5;->f$1:I
-
     return-void
 .end method
 
 
 # virtual methods
 .method public final accept(Ljava/lang/Object;)V
-    .locals 13
-
-    iget-object v0, p0, Lcom/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5;->f$0:Lcom/android/server/wm/ActivityTaskManagerServiceExt;
+    .locals 12
 
-    iget p0, p0, Lcom/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5;->f$1:I
+    iget-object p0, p0, Lcom/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5;->f$0:Lcom/android/server/wm/ActivityTaskManagerServiceExt;
 
     check-cast p1, Lcom/android/server/wm/Task;
 
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     invoke-virtual {p1}, Lcom/android/server/wm/Task;->topRunningActivityLocked()Lcom/android/server/wm/ActivityRecord;
 
-    move-result-object v1
+    move-result-object v0
 
-    if-eqz v1, :cond_1
+    if-eqz v0, :cond_1
 
-    const-string/jumbo v1, "all"
+    const-string/jumbo v0, "all"
 
-    const/4 v2, -0x1
+    const/4 v1, -0x1
 
-    invoke-virtual {p1, v2, v1}, Lcom/android/server/wm/Task;->getDumpActivitiesLocked(ILjava/lang/String;)Ljava/util/ArrayList;
+    invoke-virtual {p1, v1, v0}, Lcom/android/server/wm/Task;->getDumpActivitiesLocked(ILjava/lang/String;)Ljava/util/ArrayList;
 
     move-result-object p1
 
     invoke-virtual {p1}, Ljava/util/ArrayList;->size()I
 
-    move-result v1
+    move-result v0
 
-    const/4 v4, 0x1
+    const/4 v3, 0x1
 
-    sub-int/2addr v1, v4
+    sub-int/2addr v0, v3
 
     :goto_0
-    if-ltz v1, :cond_1
+    if-ltz v0, :cond_1
 
-    invoke-virtual {p1, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
+    invoke-virtual {p1, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
-    move-result-object v2
+    move-result-object v1
 
-    check-cast v2, Lcom/android/server/wm/ActivityRecord;
+    check-cast v1, Lcom/android/server/wm/ActivityRecord;
 
-    if-eqz v2, :cond_0
+    if-eqz v1, :cond_0
 
-    iget-object v3, v2, Lcom/android/server/wm/ActivityRecord;->task:Lcom/android/server/wm/Task;
+    iget-object v2, v1, Lcom/android/server/wm/ActivityRecord;->task:Lcom/android/server/wm/Task;
 
-    if-eqz v3, :cond_0
+    if-eqz v2, :cond_0
 
-    iget v5, v3, Lcom/android/server/wm/Task;->mUserId:I
+    iget v4, v2, Lcom/android/server/wm/Task;->mUserId:I
 
-    if-ne v5, p0, :cond_0
+    if-nez v4, :cond_0
 
-    iget-object v2, v2, Lcom/android/server/wm/ActivityRecord;->shortComponentName:Ljava/lang/String;
+    iget-object v1, v1, Lcom/android/server/wm/ActivityRecord;->shortComponentName:Ljava/lang/String;
 
-    const-string/jumbo v5, "com.android.settings/.password.ChooseLockGeneric$InternalActivity"
+    const-string/jumbo v4, "com.android.settings/.password.ChooseLockGeneric$InternalActivity"
 
-    invoke-virtual {v5, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {v4, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    move-result v2
+    move-result v1
 
-    if-eqz v2, :cond_0
+    if-eqz v1, :cond_0
 
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v11
+    move-result-wide v10
 
     :try_start_0
-    iget-object v2, v0, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->mService:Lcom/android/server/wm/ActivityTaskManagerService;
+    iget-object v1, p0, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->mService:Lcom/android/server/wm/ActivityTaskManagerService;
 
-    iget-object v2, v2, Lcom/android/server/wm/ActivityTaskManagerService;->mTaskSupervisor:Lcom/android/server/wm/ActivityTaskSupervisor;
+    iget-object v1, v1, Lcom/android/server/wm/ActivityTaskManagerService;->mTaskSupervisor:Lcom/android/server/wm/ActivityTaskSupervisor;
 
-    const-string/jumbo v6, "remove-task-by-knox"
+    const-string/jumbo v5, "remove-task-by-knox"
 
-    const/4 v7, 0x0
+    const/4 v6, 0x0
 
-    const/16 v8, 0x3e8
+    const/16 v7, 0x3e8
 
-    const/4 v9, -0x1
+    const/4 v8, -0x1
 
-    const/4 v10, 0x0
+    const/4 v9, 0x0
 
-    move v5, v4
+    move v4, v3
 
-    invoke-virtual/range {v2 .. v10}, Lcom/android/server/wm/ActivityTaskSupervisor;->removeTask(Lcom/android/server/wm/Task;ZZLjava/lang/String;ZIILjava/lang/String;)V
+    invoke-virtual/range {v1 .. v9}, Lcom/android/server/wm/ActivityTaskSupervisor;->removeTask(Lcom/android/server/wm/Task;ZZLjava/lang/String;ZIILjava/lang/String;)V
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    invoke-static {v11, v12}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v10, v11}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     goto :goto_1
 
@@ -123,13 +117,13 @@
 
     move-object p0, v0
 
-    invoke-static {v11, v12}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    invoke-static {v10, v11}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw p0
 
     :cond_0
     :goto_1
-    add-int/lit8 v1, v1, -0x1
+    add-int/lit8 v0, v0, -0x1
 
     goto :goto_0
 
diff --git a/smali_classes2/com/android/server/wm/ActivityTaskManagerServiceExt.smali b/smali_classes2/com/android/server/wm/ActivityTaskManagerServiceExt.smali
index e0bfef375..12b13c854 100644
--- a/smali_classes2/com/android/server/wm/ActivityTaskManagerServiceExt.smali
+++ b/smali_classes2/com/android/server/wm/ActivityTaskManagerServiceExt.smali
@@ -750,8 +750,8 @@
     throw p0
 .end method
 
-.method public final removeTaskByCmpName(ILjava/lang/String;)V
-    .locals 5
+.method public final removeTaskByCmpName()V
+    .locals 4
 
     invoke-static {}, Landroid/os/Binder;->getCallingPid()I
 
@@ -765,68 +765,62 @@
 
     const-string p0, "ActivityTaskManagerServiceExt"
 
-    const-string/jumbo p1, "Pid "
+    const-string/jumbo v1, "Pid "
 
-    const-string p2, " cannot clear task!"
+    const-string v2, " cannot clear task!"
 
-    invoke-static {v0, p1, p2, p0}, Lcom/android/server/FileDescriptorWatcher$FileDescriptorLeakWatcher$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v0, v1, v2, p0}, Lcom/android/server/FileDescriptorWatcher$FileDescriptorLeakWatcher$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
 
     return-void
 
     :cond_0
     const-string v1, "ActivityTaskManagerServiceExt"
 
-    const-string/jumbo v2, "removeTaskByCmpName:com.android.settings/.password.ChooseLockGeneric$InternalActivity user:"
-
-    const-string v3, " callerPid:"
-
-    const-string v4, " reason:"
+    const-string/jumbo v2, "removeTaskByCmpName:com.android.settings/.password.ChooseLockGeneric$InternalActivity user:0 callerPid:"
 
-    invoke-static {p1, v0, v2, v3, v4}, Lcom/android/internal/util/jobs/ArrayUtils$$ExternalSyntheticOutline0;->m(IILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;
+    const-string v3, " reason:Managed profile unavailable"
 
-    move-result-object v0
-
-    invoke-static {v0, p2, v1}, Lcom/android/server/BootReceiver$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v0, v2, v3, v1}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
 
-    iget-object p2, p0, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->mService:Lcom/android/server/wm/ActivityTaskManagerService;
+    iget-object v0, p0, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->mService:Lcom/android/server/wm/ActivityTaskManagerService;
 
-    iget-object p2, p2, Lcom/android/server/wm/ActivityTaskManagerService;->mGlobalLock:Lcom/android/server/wm/WindowManagerGlobalLock;
+    iget-object v0, v0, Lcom/android/server/wm/ActivityTaskManagerService;->mGlobalLock:Lcom/android/server/wm/WindowManagerGlobalLock;
 
     invoke-static {}, Lcom/android/server/wm/WindowManagerService;->boostPriorityForLockedSection()V
 
-    monitor-enter p2
+    monitor-enter v0
 
     :try_start_0
-    iget-object v0, p0, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->mService:Lcom/android/server/wm/ActivityTaskManagerService;
+    iget-object v1, p0, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->mService:Lcom/android/server/wm/ActivityTaskManagerService;
 
-    iget-object v0, v0, Lcom/android/server/wm/ActivityTaskManagerService;->mRootWindowContainer:Lcom/android/server/wm/RootWindowContainer;
+    iget-object v1, v1, Lcom/android/server/wm/ActivityTaskManagerService;->mRootWindowContainer:Lcom/android/server/wm/RootWindowContainer;
 
-    invoke-virtual {v0}, Lcom/android/server/wm/WindowContainer;->getChildCount()I
+    invoke-virtual {v1}, Lcom/android/server/wm/WindowContainer;->getChildCount()I
 
-    move-result v0
+    move-result v1
 
-    add-int/lit8 v0, v0, -0x1
+    add-int/lit8 v1, v1, -0x1
 
     :goto_0
-    if-ltz v0, :cond_2
+    if-ltz v1, :cond_2
 
-    iget-object v1, p0, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->mService:Lcom/android/server/wm/ActivityTaskManagerService;
+    iget-object v2, p0, Lcom/android/server/wm/ActivityTaskManagerServiceExt;->mService:Lcom/android/server/wm/ActivityTaskManagerService;
 
-    iget-object v1, v1, Lcom/android/server/wm/ActivityTaskManagerService;->mRootWindowContainer:Lcom/android/server/wm/RootWindowContainer;
+    iget-object v2, v2, Lcom/android/server/wm/ActivityTaskManagerService;->mRootWindowContainer:Lcom/android/server/wm/RootWindowContainer;
 
-    invoke-virtual {v1, v0}, Lcom/android/server/wm/WindowContainer;->getChildAt(I)Lcom/android/server/wm/WindowContainer;
+    invoke-virtual {v2, v1}, Lcom/android/server/wm/WindowContainer;->getChildAt(I)Lcom/android/server/wm/WindowContainer;
 
-    move-result-object v1
+    move-result-object v2
 
-    check-cast v1, Lcom/android/server/wm/DisplayContent;
+    check-cast v2, Lcom/android/server/wm/DisplayContent;
     :try_end_0
     .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    if-nez v1, :cond_1
+    if-nez v2, :cond_1
 
     :try_start_1
-    monitor-exit p2
+    monitor-exit v0
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
@@ -841,16 +835,16 @@
 
     :cond_1
     :try_start_2
-    new-instance v2, Lcom/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5;
+    new-instance v3, Lcom/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5;
 
-    invoke-direct {v2, p0, p1}, Lcom/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/wm/ActivityTaskManagerServiceExt;I)V
+    invoke-direct {v3, p0}, Lcom/android/server/wm/ActivityTaskManagerServiceExt$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/wm/ActivityTaskManagerServiceExt;)V
 
-    invoke-virtual {v1, v2}, Lcom/android/server/wm/WindowContainer;->forAllRootTasks(Ljava/util/function/Consumer;)V
+    invoke-virtual {v2, v3}, Lcom/android/server/wm/WindowContainer;->forAllRootTasks(Ljava/util/function/Consumer;)V
     :try_end_2
     .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0
     .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    add-int/lit8 v0, v0, -0x1
+    add-int/lit8 v1, v1, -0x1
 
     goto :goto_0
 
@@ -861,7 +855,7 @@
     invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
 
     :cond_2
-    monitor-exit p2
+    monitor-exit v0
     :try_end_3
     .catchall {:try_start_3 .. :try_end_3} :catchall_0
 
@@ -871,7 +865,7 @@
 
     :goto_1
     :try_start_4
-    monitor-exit p2
+    monitor-exit v0
     :try_end_4
     .catchall {:try_start_4 .. :try_end_4} :catchall_0
 
-- 
2.51.1

