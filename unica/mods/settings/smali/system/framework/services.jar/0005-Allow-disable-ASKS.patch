From 28077a9d4676cde153a7b96daea8f3fc9038f7a7 Mon Sep 17 00:00:00 2001
From: Salvo Giangreco <giangrecosalvo9@gmail.com>
Date: Fri, 24 Oct 2025 16:07:43 +0200
Subject: [PATCH] Allow disable ASKS

---
 .../server/asks/ASKSManagerService.smali      | 20 ++++++++-----------
 1 file changed, 8 insertions(+), 12 deletions(-)

diff --git a/smali/com/android/server/asks/ASKSManagerService.smali b/smali/com/android/server/asks/ASKSManagerService.smali
index c8d0786d6..683b3628e 100644
--- a/smali/com/android/server/asks/ASKSManagerService.smali
+++ b/smali/com/android/server/asks/ASKSManagerService.smali
@@ -6478,16 +6478,14 @@
     move-object v6, v5
 
     :goto_0
-    const-string/jumbo v7, "ro.build.official.release"
+    const-string/jumbo v7, "persist.sys.unica.asks"
 
-    const-string/jumbo v8, "false"
+    const-string/jumbo v8, "true"
 
     invoke-static {v7, v8}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
 
     move-result-object v7
 
-    const-string/jumbo v8, "true"
-
     invoke-virtual {v8, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v7
@@ -24135,16 +24133,14 @@
     invoke-static {v3, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     :cond_6
-    const-string/jumbo v0, "ro.build.official.release"
+    const-string/jumbo v0, "persist.sys.unica.asks"
 
-    const-string/jumbo v2, "false"
+    const-string/jumbo v2, "true"
 
     invoke-static {v0, v2}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
 
     move-result-object v0
 
-    const-string/jumbo v2, "true"
-
     invoke-virtual {v2, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v0
@@ -25959,13 +25955,13 @@
 
     invoke-virtual {v12, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    const-string/jumbo v9, "ro.build.official.release"
+    const-string/jumbo v9, "persist.sys.unica.asks"
 
-    invoke-static {v9}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+    const-string/jumbo v12, "true"
 
-    move-result-object v9
+    invoke-static {v9, v12}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
 
-    const-string/jumbo v12, "true"
+    move-result-object v9
 
     invoke-virtual {v12, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-- 
2.51.1
