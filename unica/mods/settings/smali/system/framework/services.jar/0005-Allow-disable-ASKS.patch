From 9dcdbbc15b05e0054b99ee2dbe419f34d80aab1a Mon Sep 17 00:00:00 2001
From: Salvo Giangreco <giangrecosalvo9@gmail.com>
Date: Fri, 24 Oct 2025 16:07:43 +0200
Subject: [PATCH] Allow disable ASKS

---
 .../server/asks/ASKSManagerService.smali      | 20 ++++++++-----------
 1 file changed, 8 insertions(+), 12 deletions(-)

diff --git a/smali/com/android/server/asks/ASKSManagerService.smali b/smali/com/android/server/asks/ASKSManagerService.smali
index 5a0d7da1d..d76851993 100644
--- a/smali/com/android/server/asks/ASKSManagerService.smali
+++ b/smali/com/android/server/asks/ASKSManagerService.smali
@@ -6236,16 +6236,14 @@
     move-object v6, v5
 
     :goto_0
-    const-string/jumbo v7, "ro.build.official.release"
+    const-string/jumbo v7, "persist.sys.unica.asks"
 
-    const-string/jumbo v8, "false"
+    const-string/jumbo v8, "true"
 
     invoke-static {v7, v8}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
 
     move-result-object v7
 
-    const-string/jumbo v8, "true"
-
     invoke-virtual {v8, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v7
@@ -23686,16 +23684,14 @@
     invoke-static {v3, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     :cond_6
-    const-string/jumbo v0, "ro.build.official.release"
+    const-string/jumbo v0, "persist.sys.unica.asks"
 
-    const-string/jumbo v2, "false"
+    const-string/jumbo v2, "true"
 
     invoke-static {v0, v2}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
 
     move-result-object v0
 
-    const-string/jumbo v2, "true"
-
     invoke-virtual {v2, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v0
@@ -25271,13 +25267,13 @@
 
     invoke-virtual {v1, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    const-string/jumbo v1, "ro.build.official.release"
+    const-string/jumbo v1, "persist.sys.unica.asks"
 
-    invoke-static {v1}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;
+    const-string/jumbo v14, "true"
 
-    move-result-object v1
+    invoke-static {v1, v14}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
 
-    const-string/jumbo v14, "true"
+    move-result-object v1
 
     invoke-virtual {v14, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-- 
2.51.2
